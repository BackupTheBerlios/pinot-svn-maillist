<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Pinot-svn] r691 - in trunk: Search UI/GTK2 UI/GTK2/src po
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/pinot-svn/2007-January/index.html" >
   <LINK REL="made" HREF="mailto:pinot-svn%40lists.berlios.de?Subject=Re%3A%20%5BPinot-svn%5D%20r691%20-%20in%20trunk%3A%20Search%20UI/GTK2%20UI/GTK2/src%20po&In-Reply-To=%3C200701111535.l0BFZno8025079%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000684.html">
   <LINK REL="Next"  HREF="000686.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Pinot-svn] r691 - in trunk: Search UI/GTK2 UI/GTK2/src po</H1>
    <B>fabricecolin at BerliOS</B> 
    <A HREF="mailto:pinot-svn%40lists.berlios.de?Subject=Re%3A%20%5BPinot-svn%5D%20r691%20-%20in%20trunk%3A%20Search%20UI/GTK2%20UI/GTK2/src%20po&In-Reply-To=%3C200701111535.l0BFZno8025079%40sheep.berlios.de%3E"
       TITLE="[Pinot-svn] r691 - in trunk: Search UI/GTK2 UI/GTK2/src po">fabricecolin at mail.berlios.de
       </A><BR>
    <I>Thu Jan 11 16:35:49 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000684.html">[Pinot-svn] r690 - in trunk: UI/GTK2/src Utils
</A></li>
        <LI>Next message: <A HREF="000686.html">[Pinot-svn] r692 - in trunk: UI/GTK2/src Utils
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#685">[ date ]</a>
              <a href="thread.html#685">[ thread ]</a>
              <a href="subject.html#685">[ subject ]</a>
              <a href="author.html#685">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: fabricecolin
Date: 2007-01-11 16:35:47 +0100 (Thu, 11 Jan 2007)
New Revision: 691

Added:
   trunk/UI/GTK2/src/dateDialog.cc
   trunk/UI/GTK2/src/dateDialog.hh
   trunk/UI/GTK2/src/dateDialog_glade.cc
   trunk/UI/GTK2/src/dateDialog_glade.hh
Modified:
   trunk/Search/QueryProperties.cpp
   trunk/Search/QueryProperties.h
   trunk/UI/GTK2/metase-gtk2.glade
   trunk/UI/GTK2/src/Makefile.am
   trunk/UI/GTK2/src/PinotSettings.cpp
   trunk/UI/GTK2/src/queryDialog.cc
   trunk/UI/GTK2/src/queryDialog.hh
   trunk/UI/GTK2/src/queryDialog_glade.cc
   trunk/UI/GTK2/src/queryDialog_glade.hh
   trunk/po/POTFILES.in
Log:
Date range filtering, UI-only part.
Added dateDialog, a date picker box, and extended queryDialog.


Modified: trunk/Search/QueryProperties.cpp
===================================================================
--- trunk/Search/QueryProperties.cpp	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/Search/QueryProperties.cpp	2007-01-11 15:35:47 UTC (rev 691)
@@ -27,6 +27,14 @@
 
 QueryProperties::QueryProperties() :
 	m_resultsCount(10),
+	m_enableMinDate(false),
+	m_minDay(0),
+	m_minMonth(0),
+	m_minYear(0),
+	m_enableMaxDate(false),
+	m_maxDay(0),
+	m_maxMonth(0),
+	m_maxYear(0),
 	m_indexResults(false)
 {
 }
@@ -35,6 +43,14 @@
 	m_name(name),
 	m_freeQuery(freeQuery),
 	m_resultsCount(10),
+	m_enableMinDate(false),
+	m_minDay(0),
+	m_minMonth(0),
+	m_minYear(0),
+	m_enableMaxDate(false),
+	m_maxDay(0),
+	m_maxMonth(0),
+	m_maxYear(0),
 	m_indexResults(false)
 {
 	removeFilters();
@@ -48,6 +64,14 @@
 	m_hostFilter(other.m_hostFilter),
 	m_fileFilter(other.m_fileFilter),
 	m_resultsCount(other.m_resultsCount),
+	m_enableMinDate(other.m_enableMinDate),
+	m_minDay(other.m_minDay),
+	m_minMonth(other.m_minMonth),
+	m_minYear(other.m_minYear),
+	m_enableMaxDate(other.m_enableMaxDate),
+	m_maxDay(other.m_maxDay),
+	m_maxMonth(other.m_maxMonth),
+	m_maxYear(other.m_maxYear),
 	m_indexResults(other.m_indexResults),
 	m_labelName(other.m_labelName)
 {
@@ -68,6 +92,14 @@
 		m_hostFilter = other.m_hostFilter;
 		m_fileFilter = other.m_fileFilter;
 		m_resultsCount = other.m_resultsCount;
+		m_enableMinDate = other.m_enableMinDate;
+		m_minDay = other.m_minDay;
+		m_minMonth = other.m_minMonth;
+		m_minYear = other.m_minYear;
+		m_enableMaxDate = other.m_enableMaxDate;
+		m_maxDay = other.m_maxDay;
+		m_maxMonth = other.m_maxMonth;
+		m_maxYear = other.m_maxYear;
 		m_indexResults = other.m_indexResults;
 		m_labelName = other.m_labelName;
 	}
@@ -215,6 +247,44 @@
 	return m_resultsCount;
 }
 
+/// Sets the minimum date.
+void QueryProperties::setMinimumDate(bool enable, unsigned int day, unsigned int month, unsigned int year)
+{
+	m_enableMinDate = enable;
+	m_minDay = day;
+	m_minMonth = month;
+	m_minYear = year;
+}
+
+/// Gets the minimum date.
+bool QueryProperties::getMinimumDate(unsigned int &amp;day, unsigned int &amp;month, unsigned int &amp;year) const
+{
+	day = m_minDay;
+	month = m_minMonth;
+	year = m_minYear;
+
+	return m_enableMinDate;
+}
+
+/// Sets the maximum date.
+void QueryProperties::setMaximumDate(bool enable, unsigned int day, unsigned int month, unsigned int year)
+{
+	m_enableMaxDate = enable;
+	m_maxDay = day;
+	m_maxMonth = month;
+	m_maxYear = year;
+}
+
+/// Gets the maximum date.
+bool QueryProperties::getMaximumDate(unsigned int &amp;day, unsigned int &amp;month, unsigned int &amp;year) const
+{
+	day = m_maxDay;
+	month = m_maxMonth;
+	year = m_maxYear;
+
+	return m_enableMaxDate;
+}
+
 /// Sets whether results should be indexed.
 void QueryProperties::setIndexResults(bool index)
 {

Modified: trunk/Search/QueryProperties.h
===================================================================
--- trunk/Search/QueryProperties.h	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/Search/QueryProperties.h	2007-01-11 15:35:47 UTC (rev 691)
@@ -64,6 +64,16 @@
 		/// Gets the maximum number of results.
 		unsigned int getMaximumResultsCount(void) const;
 
+		/// Sets the minimum date.
+		void setMinimumDate(bool enable, unsigned int day, unsigned int month, unsigned int year);
+		/// Gets the minimum date.
+		bool getMinimumDate(unsigned int &amp;day, unsigned int &amp;month, unsigned int &amp;year) const;
+
+		/// Sets the maximum date.
+		void setMaximumDate(bool enable, unsigned int day, unsigned int month, unsigned int year);
+		/// Gets the maximum date.
+		bool getMaximumDate(unsigned int &amp;day, unsigned int &amp;month, unsigned int &amp;year) const;
+
 		/// Sets whether results should be indexed.
 		void setIndexResults(bool index);
 		/// Gets whether results should be indexed
@@ -85,6 +95,14 @@
 		string m_hostFilter;
 		string m_fileFilter;
 		unsigned int m_resultsCount;
+		bool m_enableMinDate;
+		unsigned int m_minDay;
+		unsigned int m_minMonth;
+		unsigned int m_minYear;
+		bool m_enableMaxDate;
+		unsigned int m_maxDay;
+		unsigned int m_maxMonth;
+		unsigned int m_maxYear;
 		bool m_indexResults;
 		string m_labelName;
 

Modified: trunk/UI/GTK2/metase-gtk2.glade
===================================================================
--- trunk/UI/GTK2/metase-gtk2.glade	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/metase-gtk2.glade	2007-01-11 15:35:47 UTC (rev 691)
@@ -2407,13 +2407,9 @@
 	  &lt;/child&gt;
 
 	  &lt;child&gt;
-	    &lt;placeholder/&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkTable&quot; id=&quot;tersmTable&quot;&gt;
+	    &lt;widget class=&quot;GtkTable&quot; id=&quot;actionsTable&quot;&gt;
 	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;n_rows&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;n_rows&quot;&gt;4&lt;/property&gt;
 	      &lt;property name=&quot;n_columns&quot;&gt;2&lt;/property&gt;
 	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
 	      &lt;property name=&quot;row_spacing&quot;&gt;0&lt;/property&gt;
@@ -2424,7 +2420,7 @@
 		  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
 		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Index all results with label&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Index results with label&lt;/property&gt;
 		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
 		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
 		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
@@ -2435,8 +2431,8 @@
 		&lt;packing&gt;
 		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
 		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
 		  &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
 		  &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
 		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
@@ -2454,8 +2450,8 @@
 		&lt;packing&gt;
 		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
 		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-		  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
-		  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
 		  &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
 		  &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
 		  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
@@ -2515,6 +2511,102 @@
 		  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
 		&lt;/packing&gt;
 	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkCheckButton&quot; id=&quot;fromCheckbutton&quot;&gt;
+		  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Start date:&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
+		  &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
+		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkCheckButton&quot; id=&quot;toCheckbutton&quot;&gt;
+		  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;End date:&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
+		  &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
+		  &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
+		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkButton&quot; id=&quot;fromButton&quot;&gt;
+		  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Date&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;on_fromButton_clicked&quot; last_modification_time=&quot;Thu, 11 Jan 2007 13:01:07 GMT&quot;/&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
+		  &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
+		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkButton&quot; id=&quot;toButton&quot;&gt;
+		  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Date&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;on_toButton_clicked&quot; last_modification_time=&quot;Thu, 11 Jan 2007 13:00:57 GMT&quot;/&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+		  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
+		  &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
+		  &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
+		  &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
+		  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+		  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
 	    &lt;/widget&gt;
 	    &lt;packing&gt;
 	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
@@ -3773,4 +3865,83 @@
   &lt;/child&gt;
 &lt;/widget&gt;
 
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;dateDialog&quot;&gt;
+  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Date&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;focus_on_map&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;urgency_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox10&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area10&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;cancelbutton4&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;okbutton2&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkCalendar&quot; id=&quot;dateCalendar&quot;&gt;
+	  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;display_options&quot;&gt;GTK_CALENDAR_SHOW_HEADING|GTK_CALENDAR_SHOW_DAY_NAMES|GTK_CALENDAR_SHOW_WEEK_NUMBERS&lt;/property&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
 &lt;/glade-interface&gt;

Modified: trunk/UI/GTK2/src/Makefile.am
===================================================================
--- trunk/UI/GTK2/src/Makefile.am	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/Makefile.am	2007-01-11 15:35:47 UTC (rev 691)
@@ -1,6 +1,8 @@
 # Process this file with automake to produce Makefile.in
 
 noinst_HEADERS = \
+	dateDialog_glade.hh \
+	dateDialog.hh \
 	importDialog_glade.hh \
 	importDialog.hh \
 	indexDialog_glade.hh \
@@ -33,6 +35,8 @@
 
 pinot_SOURCES = \
 	pinot.cc \
+	dateDialog_glade.cc \
+	dateDialog.cc \
 	importDialog_glade.cc \
 	importDialog.cc \
 	indexDialog_glade.cc \

Modified: trunk/UI/GTK2/src/PinotSettings.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.cpp	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/PinotSettings.cpp	2007-01-11 15:35:47 UTC (rev 691)
@@ -28,6 +28,7 @@
 #include &lt;iostream&gt;
 
 #include &lt;glibmm/convert.h&gt;
+#include &lt;glibmm/date.h&gt;
 #include &lt;libxml++/parsers/domparser.h&gt;
 #include &lt;libxml++/nodes/node.h&gt;
 #include &lt;libxml++/nodes/textnode.h&gt;
@@ -594,8 +595,13 @@
 	}
 
 	QueryProperties queryProps;
+	Date minDate, maxDate;
 	string backCompatString;
+	bool enableMinDate = false, enableMaxDate = false;
 
+	minDate.set_time_current();
+	maxDate.set_time_current();
+
 	// Load the query's properties
 	for (Node::NodeList::iterator iter = childNodes.begin(); iter != childNodes.end(); ++iter)
 	{
@@ -702,6 +708,32 @@
 			int count = atoi(nodeContent.c_str());
 			queryProps.setMaximumResultsCount((unsigned int)max(count, 10));
 		}
+		else if (nodeName == &quot;enablemindate&quot;)
+		{
+			if (nodeContent == &quot;YES&quot;)
+			{
+				enableMinDate = true;
+			}
+			queryProps.setMinimumDate(enableMinDate, minDate.get_day(), minDate.get_month(), minDate.get_year());
+		}
+		else if (nodeName == &quot;mindate&quot;)
+		{
+			minDate.set_parse(nodeContent);
+			queryProps.setMinimumDate(enableMinDate, minDate.get_day(), minDate.get_month(), minDate.get_year());
+		}
+		else if (nodeName == &quot;enablemaxdate&quot;)
+		{
+			if (nodeContent == &quot;YES&quot;)
+			{
+				enableMaxDate = true;
+			}
+			queryProps.setMaximumDate(enableMaxDate, maxDate.get_day(), maxDate.get_month(), maxDate.get_year());
+		}
+		else if (nodeName == &quot;maxdate&quot;)
+		{
+			maxDate.set_parse(nodeContent);
+			queryProps.setMaximumDate(enableMaxDate, maxDate.get_day(), maxDate.get_month(), maxDate.get_year());
+		}
 		else if (nodeName == &quot;index&quot;)
 		{
 			if (nodeContent == &quot;ALL&quot;)
@@ -1145,10 +1177,28 @@
 		{
 			return false;
 		}
+
+		Date aDate;
+		unsigned int day, month, year;
+
 		addChildElement(pElem, &quot;name&quot;, queryIter-&gt;first);
 		addChildElement(pElem, &quot;text&quot;, queryIter-&gt;second.getFreeQuery());
 		sprintf(numStr, &quot;%u&quot;, queryIter-&gt;second.getMaximumResultsCount());
 		addChildElement(pElem, &quot;maxresults&quot;, numStr);
+		bool enable = queryIter-&gt;second.getMinimumDate(day, month, year);
+		if (year &gt; 0)
+		{
+			addChildElement(pElem, &quot;enablemindate&quot;, (enable ? &quot;YES&quot; : &quot;NO&quot;));
+			aDate.set_dmy((Date::Day )day, (Date::Month )month, (Date::Year )year);
+			addChildElement(pElem, &quot;mindate&quot;, aDate.format_string(&quot;%F&quot;));
+		}
+		enable = queryIter-&gt;second.getMaximumDate(day, month, year);
+		if (year &gt; 0)
+		{
+			addChildElement(pElem, &quot;enablemaxdate&quot;, (enable ? &quot;YES&quot; : &quot;NO&quot;));
+			aDate.set_dmy((Date::Day )day, (Date::Month )month, (Date::Year )year);
+			addChildElement(pElem, &quot;maxdate&quot;, aDate.format_string(&quot;%F&quot;));
+		}
 		addChildElement(pElem, &quot;index&quot;, (queryIter-&gt;second.getIndexResults() ? &quot;ALL&quot; : &quot;NONE&quot;));
 		addChildElement(pElem, &quot;label&quot;, queryIter-&gt;second.getLabelName());
 	}
@@ -1508,7 +1558,7 @@
 		return false;
 	}
 
-	// Any pattern matches this the file name ?
+	// Any pattern matches this file name ?
 	for (set&lt;ustring&gt;::iterator patternIter = m_filePatternsBlackList.begin(); patternIter != m_filePatternsBlackList.end() ; ++patternIter)
 	{
 		if (fnmatch(patternIter-&gt;c_str(), fileName.c_str(), FNM_NOESCAPE) == 0)

Added: trunk/UI/GTK2/src/dateDialog.cc
===================================================================
--- trunk/UI/GTK2/src/dateDialog.cc	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/dateDialog.cc	2007-01-11 15:35:47 UTC (rev 691)
@@ -0,0 +1,61 @@
+/*
+ *  Copyright 2005,2006 Fabrice Colin
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU Library General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ */
+#include &lt;iostream&gt;
+#include &lt;utility&gt;
+#include &lt;string&gt;
+#include &lt;glibmm/ustring.h&gt;
+#include &lt;sigc++/slot.h&gt;
+
+#include &quot;config.h&quot;
+#include &quot;NLS.h&quot;
+#include &quot;PinotSettings.h&quot;
+#include &quot;PinotUtils.h&quot;
+#include &quot;dateDialog.hh&quot;
+
+using namespace std;
+using namespace Glib;
+using namespace Gtk;
+
+dateDialog::dateDialog(const ustring &amp;title, const Date &amp;date) :
+	dateDialog_glade()
+{
+	int month = (int )date.get_month();
+
+	set_title(title);
+
+	dateCalendar-&gt;select_month((guint )max(--month, 0), (guint )date.get_year());
+	dateCalendar-&gt;select_day((guint )date.get_day());
+}
+
+dateDialog::~dateDialog()
+{
+}
+
+void dateDialog::getChoice(Date &amp;chosenDate) const
+{
+	Date dateNow;
+	guint year, month, day;
+
+	dateNow.set_time_current();
+	dateCalendar-&gt;get_date(year, month, day);
+#ifdef DEBUG
+	cout &lt;&lt; &quot;dateDialog::getChoice: selected &quot; &lt;&lt; year &lt;&lt; &quot; &quot; &lt;&lt; month &lt;&lt; &quot; &quot; &lt;&lt; day &lt;&lt; endl;
+#endif
+	chosenDate.set_dmy((Date::Day )day, (Date::Month )++month, (Date::Year )year);
+}
+

Added: trunk/UI/GTK2/src/dateDialog.hh
===================================================================
--- trunk/UI/GTK2/src/dateDialog.hh	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/dateDialog.hh	2007-01-11 15:35:47 UTC (rev 691)
@@ -0,0 +1,36 @@
+/*
+ *  Copyright 2005,2006 Fabrice Colin
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU Library General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ */
+
+#ifndef _DATEDIALOG_HH
+#define _DATEDIALOG_HH
+
+#include &lt;glibmm/date.h&gt;
+#include &lt;glibmm/ustring.h&gt;
+
+#include &quot;dateDialog_glade.hh&quot;
+
+class dateDialog : public dateDialog_glade
+{
+public:
+	dateDialog(const Glib::ustring &amp;title, const Glib::Date &amp;date);
+	virtual ~dateDialog();
+
+	void getChoice(Glib::Date &amp;chosenDate) const;
+
+};
+#endif

Added: trunk/UI/GTK2/src/dateDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/dateDialog_glade.cc	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/dateDialog_glade.cc	2007-01-11 15:35:47 UTC (rev 691)
@@ -0,0 +1,92 @@
+// generated 2007/1/11 20:22:49 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
+// using glademm V2.12.1
+//
+// DO NOT EDIT THIS FILE ! It was created using
+// glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
+// for gtk 2.10.4 and gtkmm 2.10.5
+//
+// Please modify the corresponding derived classes in ./src/dateDialog.cc
+
+
+#if defined __GNUC__ &amp;&amp; __GNUC__ &lt; 3
+#error This program will crash if compiled with g++ 2.x
+// see the dynamic_cast bug in the gtkmm FAQ
+#endif //
+#include &quot;config.h&quot;
+/*
+ * Standard gettext macros.
+ */
+#ifdef ENABLE_NLS
+#  include &lt;libintl.h&gt;
+#  undef _
+#  define _(String) dgettext (GETTEXT_PACKAGE, String)
+#  ifdef gettext_noop
+#    define N_(String) gettext_noop (String)
+#  else
+#    define N_(String) (String)
+#  endif
+#endif
+#include &lt;gtkmmconfig.h&gt;
+#if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;2
+#include &lt;sigc++/compatibility.h&gt;
+#include &lt;sigc++/bind.h&gt;
+#define GMM_GTKMM_22_24(a,b) b
+#else //gtkmm 2.2
+#define GMM_GTKMM_22_24(a,b) a
+#endif //
+#include &quot;dateDialog_glade.hh&quot;
+#include &lt;gdk/gdkkeysyms.h&gt;
+#include &lt;gtkmm/accelgroup.h&gt;
+#include &lt;gtkmm/button.h&gt;
+#include &lt;gtkmm/buttonbox.h&gt;
+#include &lt;gtkmm/box.h&gt;
+#ifndef ENABLE_NLS
+#  define textdomain(String) (String)
+#  define gettext(String) (String)
+#  define dgettext(Domain,Message) (Message)
+#  define dcgettext(Domain,Message,Type) (Message)
+#  define bindtextdomain(Domain,Directory) (Domain)
+#  define _(String) (String)
+#  define N_(String) (String)
+#endif
+
+
+dateDialog_glade::dateDialog_glade(
+)
+{  
+   
+   Gtk::Dialog *dateDialog = this;
+   gmm_data = new GlademmData(get_accel_group());
+   
+   Gtk::Button *cancelbutton4 = Gtk::manage(new class Gtk::Button(Gtk::StockID(&quot;gtk-cancel&quot;)));
+   Gtk::Button *okbutton2 = Gtk::manage(new class Gtk::Button(Gtk::StockID(&quot;gtk-ok&quot;)));
+   dateCalendar = Gtk::manage(new class Gtk::Calendar());
+   cancelbutton4-&gt;set_flags(Gtk::CAN_FOCUS);
+   cancelbutton4-&gt;set_flags(Gtk::CAN_DEFAULT);
+   cancelbutton4-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   okbutton2-&gt;set_flags(Gtk::CAN_FOCUS);
+   okbutton2-&gt;set_flags(Gtk::CAN_DEFAULT);
+   okbutton2-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   dateDialog-&gt;get_action_area()-&gt;property_layout_style().set_value(Gtk::BUTTONBOX_END);
+   dateCalendar-&gt;set_flags(Gtk::CAN_FOCUS);
+   dateCalendar-&gt;display_options(Gtk::CALENDAR_SHOW_HEADING|Gtk::CALENDAR_SHOW_DAY_NAMES);
+   dateDialog-&gt;get_vbox()-&gt;set_homogeneous(false);
+   dateDialog-&gt;get_vbox()-&gt;set_spacing(0);
+   dateDialog-&gt;get_vbox()-&gt;pack_start(*dateCalendar);
+   dateDialog-&gt;set_title(_(&quot;Date&quot;));
+   dateDialog-&gt;set_modal(false);
+   dateDialog-&gt;property_window_position().set_value(Gtk::WIN_POS_NONE);
+   dateDialog-&gt;set_resizable(true);
+   dateDialog-&gt;property_destroy_with_parent().set_value(false);
+   dateDialog-&gt;set_has_separator(true);
+   dateDialog-&gt;add_action_widget(*cancelbutton4, -6);
+   dateDialog-&gt;add_action_widget(*okbutton2, -5);
+   cancelbutton4-&gt;show();
+   okbutton2-&gt;show();
+   dateCalendar-&gt;show();
+   dateDialog-&gt;show();
+}
+
+dateDialog_glade::~dateDialog_glade()
+{  delete gmm_data;
+}

Added: trunk/UI/GTK2/src/dateDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/dateDialog_glade.hh	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/dateDialog_glade.hh	2007-01-11 15:35:47 UTC (rev 691)
@@ -0,0 +1,48 @@
+// generated 2007/1/11 20:22:49 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
+// using glademm V2.12.1
+//
+// DO NOT EDIT THIS FILE ! It was created using
+// glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
+// for gtk 2.10.4 and gtkmm 2.10.5
+//
+// Please modify the corresponding derived classes in ./src/dateDialog.hh and./src/dateDialog.cc
+
+#ifndef _DATEDIALOG_GLADE_HH
+#  define _DATEDIALOG_GLADE_HH
+
+
+#if !defined(GLADEMM_DATA)
+#define GLADEMM_DATA 
+#include &lt;gtkmm/accelgroup.h&gt;
+
+class GlademmData
+{  
+        
+        Glib::RefPtr&lt;Gtk::AccelGroup&gt; accgrp;
+public:
+        
+        GlademmData(Glib::RefPtr&lt;Gtk::AccelGroup&gt; ag) : accgrp(ag)
+        {  
+        }
+        
+        Glib::RefPtr&lt;Gtk::AccelGroup&gt;  getAccelGroup()
+        {  return accgrp;
+        }
+};
+#endif //GLADEMM_DATA
+
+#include &lt;gtkmm/dialog.h&gt;
+#include &lt;gtkmm/calendar.h&gt;
+
+class dateDialog_glade : public Gtk::Dialog
+{  
+        
+        GlademmData *gmm_data;
+protected:
+        class Gtk::Calendar * dateCalendar;
+        
+        dateDialog_glade();
+        
+        ~dateDialog_glade();
+};
+#endif

Modified: trunk/UI/GTK2/src/queryDialog.cc
===================================================================
--- trunk/UI/GTK2/src/queryDialog.cc	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/queryDialog.cc	2007-01-11 15:35:47 UTC (rev 691)
@@ -24,8 +24,10 @@
 #include &quot;config.h&quot;
 #include &quot;Languages.h&quot;
 #include &quot;NLS.h&quot;
+#include &quot;TimeConverter.h&quot;
 #include &quot;PinotUtils.h&quot;
 #include &quot;queryDialog.hh&quot;
+#include &quot;dateDialog.hh&quot;
 
 using namespace std;
 using namespace Glib;
@@ -38,6 +40,8 @@
 	m_labels(PinotSettings::getInstance().getLabels()),
 	m_badName(true)
 {
+	unsigned int day, month, year;
+
 	// Name
 	string name(m_properties.getName());
 	if (name.empty() == true)
@@ -53,6 +57,29 @@
 	refBuffer-&gt;set_text(to_utf8(m_properties.getFreeQuery()));
 	// Maximum number of results
 	resultsCountSpinbutton-&gt;set_value((double)m_properties.getMaximumResultsCount());
+	// Date range
+	bool enable = m_properties.getMinimumDate(day, month, year);
+	if (year &gt; 0)
+	{
+		m_fromDate.set_dmy((Date::Day )day, (Date::Month )month, (Date::Year )year);
+	}
+	else
+	{
+		m_fromDate.set_time_current();
+	}
+	fromCheckbutton-&gt;set_active(enable);
+	fromButton-&gt;set_label(m_fromDate.format_string(&quot;%x&quot;));
+	enable = m_properties.getMaximumDate(day, month, year);
+	if (year &gt; 0)
+	{
+		m_toDate.set_dmy((Date::Day )day, (Date::Month )month, (Date::Year )year);
+	}
+	else
+	{
+		m_toDate.set_time_current();
+	}
+	toCheckbutton-&gt;set_active(enable);
+	toButton-&gt;set_label(m_toDate.format_string(&quot;%x&quot;));
 	// Index all results
 	indexCheckbutton-&gt;set_active(m_properties.getIndexResults());
 
@@ -160,6 +187,9 @@
 	m_properties.setFreeQuery(from_utf8(refBuffer-&gt;get_text()));
 	// Maximum number of results
 	m_properties.setMaximumResultsCount((unsigned int)resultsCountSpinbutton-&gt;get_value());
+	// Date range
+	m_properties.setMinimumDate(fromCheckbutton-&gt;get_active(), m_fromDate.get_day(), m_fromDate.get_month(), m_fromDate.get_year());
+	m_properties.setMaximumDate(toCheckbutton-&gt;get_active(), m_toDate.get_day(), m_toDate.get_month(), m_toDate.get_year());
 	// Index all results
 	m_properties.setIndexResults(indexCheckbutton-&gt;get_active());
 	// Index label
@@ -236,3 +266,33 @@
 	refBuffer-&gt;set_text(queryText);
 }
 
+void queryDialog::on_fromButton_clicked()
+{
+	dateDialog datePicker(_(&quot;Start date&quot;), m_fromDate);
+
+#ifdef DEBUG
+	cout &lt;&lt; &quot;queryDialog::on_fromButton_clicked: start date is &quot; &lt;&lt; m_fromDate.format_string(&quot;%x&quot;) &lt;&lt; endl;
+#endif
+	datePicker.show();
+	if (datePicker.run() == RESPONSE_OK)
+	{
+		datePicker.getChoice(m_fromDate);
+		fromButton-&gt;set_label(m_fromDate.format_string(&quot;%x&quot;));
+	}
+}
+
+void queryDialog::on_toButton_clicked()
+{
+	dateDialog datePicker(_(&quot;End date&quot;), m_toDate);
+
+#ifdef DEBUG
+	cout &lt;&lt; &quot;queryDialog::on_toButton_clicked: end date is &quot; &lt;&lt; m_toDate.format_string(&quot;%x&quot;) &lt;&lt; endl;
+#endif
+	datePicker.show();
+	if (datePicker.run() == RESPONSE_OK)
+	{
+		datePicker.getChoice(m_toDate);
+	        toButton-&gt;set_label(m_toDate.format_string(&quot;%x&quot;));
+	}
+}
+

Modified: trunk/UI/GTK2/src/queryDialog.hh
===================================================================
--- trunk/UI/GTK2/src/queryDialog.hh	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/queryDialog.hh	2007-01-11 15:35:47 UTC (rev 691)
@@ -21,6 +21,7 @@
 
 #include &lt;string&gt;
 #include &lt;set&gt;
+#include &lt;glibmm/date.h&gt;
 #include &lt;gtkmm/liststore.h&gt;
 
 #include &quot;QueryProperties.h&quot;
@@ -44,6 +45,8 @@
 	Glib::RefPtr&lt;Gtk::ListStore&gt; m_refLabelNameTree;
 	ComboModelColumns m_filterColumns;
 	Glib::RefPtr&lt;Gtk::ListStore&gt; m_refFilterTree;
+	Glib::Date m_fromDate;
+	Glib::Date m_toDate;
 	bool m_badName;
 
 	void populate_comboboxes();
@@ -51,6 +54,8 @@
 	virtual void on_queryOkbutton_clicked();
 	virtual void on_nameEntry_changed();
 	virtual void on_addFilterButton_clicked();
+        virtual void on_fromButton_clicked();
+        virtual void on_toButton_clicked();
 
 };
 #endif

Modified: trunk/UI/GTK2/src/queryDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/queryDialog_glade.cc	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/queryDialog_glade.cc	2007-01-11 15:35:47 UTC (rev 691)
@@ -1,4 +1,4 @@
-// generated 2006/12/31 19:10:59 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at thorgrim.dyndns.org.</A>(none)
+// generated 2007/1/11 21:02:42 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -80,14 +80,18 @@
    Gtk::Alignment *queryFrameAlignment = Gtk::manage(new class Gtk::Alignment(0.5, 0.5, 1, 1));
    Gtk::Label *queryFrameLabel = Gtk::manage(new class Gtk::Label(_(&quot;Query Text&quot;)));
    Gtk::Frame *queryFrame = Gtk::manage(new class Gtk::Frame());
-   indexCheckbutton = Gtk::manage(new class Gtk::CheckButton(_(&quot;Index all results with label&quot;)));
+   indexCheckbutton = Gtk::manage(new class Gtk::CheckButton(_(&quot;Index results with label&quot;)));
    labelNameCombobox = Gtk::manage(new class Gtk::ComboBox());
    
    Gtk::Label *resultsCountLabel = Gtk::manage(new class Gtk::Label(_(&quot;Number of results:&quot;)));
    Gtk::Adjustment *resultsCountSpinbutton_adj = Gtk::manage(new class Gtk::Adjustment(10, 10, 100, 10, 20, 20));
    resultsCountSpinbutton = Gtk::manage(new class Gtk::SpinButton(*resultsCountSpinbutton_adj, 1, 0));
+   fromCheckbutton = Gtk::manage(new class Gtk::CheckButton(_(&quot;Start date:&quot;)));
+   toCheckbutton = Gtk::manage(new class Gtk::CheckButton(_(&quot;End date:&quot;)));
+   fromButton = Gtk::manage(new class Gtk::Button(_(&quot;Date&quot;)));
+   toButton = Gtk::manage(new class Gtk::Button(_(&quot;Date&quot;)));
    
-   Gtk::Table *tersmTable = Gtk::manage(new class Gtk::Table(2, 2, false));
+   Gtk::Table *actionsTable = Gtk::manage(new class Gtk::Table(2, 2, false));
    Gtk::VBox *queryVbox = Gtk::manage(new class Gtk::VBox(false, 0));
    queryCancelbutton-&gt;set_flags(Gtk::CAN_FOCUS);
    queryCancelbutton-&gt;set_flags(Gtk::CAN_DEFAULT);
@@ -165,16 +169,32 @@
    resultsCountSpinbutton-&gt;set_numeric(false);
    resultsCountSpinbutton-&gt;set_digits(0);
    resultsCountSpinbutton-&gt;set_wrap(false);
-   tersmTable-&gt;set_row_spacings(0);
-   tersmTable-&gt;set_col_spacings(0);
-   tersmTable-&gt;attach(*indexCheckbutton, 0, 1, 1, 2, Gtk::FILL, Gtk::FILL, 4, 4);
-   tersmTable-&gt;attach(*labelNameCombobox, 1, 2, 1, 2, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
-   tersmTable-&gt;attach(*resultsCountLabel, 0, 1, 0, 1, Gtk::FILL, Gtk::FILL, 4, 4);
-   tersmTable-&gt;attach(*resultsCountSpinbutton, 1, 2, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   fromCheckbutton-&gt;set_flags(Gtk::CAN_FOCUS);
+   fromCheckbutton-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   fromCheckbutton-&gt;set_mode(true);
+   fromCheckbutton-&gt;set_active(false);
+   toCheckbutton-&gt;set_flags(Gtk::CAN_FOCUS);
+   toCheckbutton-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   toCheckbutton-&gt;set_mode(true);
+   toCheckbutton-&gt;set_active(false);
+   fromButton-&gt;set_flags(Gtk::CAN_FOCUS);
+   fromButton-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   toButton-&gt;set_flags(Gtk::CAN_FOCUS);
+   toButton-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   actionsTable-&gt;set_row_spacings(0);
+   actionsTable-&gt;set_col_spacings(0);
+   actionsTable-&gt;attach(*indexCheckbutton, 0, 1, 3, 4, Gtk::FILL, Gtk::FILL, 4, 4);
+   actionsTable-&gt;attach(*labelNameCombobox, 1, 2, 3, 4, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   actionsTable-&gt;attach(*resultsCountLabel, 0, 1, 0, 1, Gtk::FILL, Gtk::FILL, 4, 4);
+   actionsTable-&gt;attach(*resultsCountSpinbutton, 1, 2, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   actionsTable-&gt;attach(*fromCheckbutton, 0, 1, 1, 2, Gtk::FILL, Gtk::FILL, 4, 4);
+   actionsTable-&gt;attach(*toCheckbutton, 0, 1, 2, 3, Gtk::FILL, Gtk::FILL, 4, 4);
+   actionsTable-&gt;attach(*fromButton, 1, 2, 1, 2, Gtk::FILL, Gtk::FILL, 4, 4);
+   actionsTable-&gt;attach(*toButton, 1, 2, 2, 3, Gtk::FILL, Gtk::FILL, 4, 4);
    queryVbox-&gt;pack_start(*nameTable, Gtk::PACK_SHRINK, 0);
    queryVbox-&gt;pack_start(*queryHbox);
    queryVbox-&gt;pack_start(*queryFrame, Gtk::PACK_EXPAND_WIDGET, 4);
-   queryVbox-&gt;pack_start(*tersmTable);
+   queryVbox-&gt;pack_start(*actionsTable);
    queryDialog-&gt;get_vbox()-&gt;set_homogeneous(false);
    queryDialog-&gt;get_vbox()-&gt;set_spacing(0);
    queryDialog-&gt;get_vbox()-&gt;pack_start(*queryVbox);
@@ -204,12 +224,18 @@
    labelNameCombobox-&gt;show();
    resultsCountLabel-&gt;show();
    resultsCountSpinbutton-&gt;show();
-   tersmTable-&gt;show();
+   fromCheckbutton-&gt;show();
+   toCheckbutton-&gt;show();
+   fromButton-&gt;show();
+   toButton-&gt;show();
+   actionsTable-&gt;show();
    queryVbox-&gt;show();
    queryDialog-&gt;show();
    queryOkbutton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;queryDialog_glade::on_queryOkbutton_clicked), false);
    nameEntry-&gt;signal_changed().connect(SigC::slot(*this, &amp;queryDialog_glade::on_nameEntry_changed), false);
    addFilterButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;queryDialog_glade::on_addFilterButton_clicked), false);
+   fromButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;queryDialog_glade::on_fromButton_clicked), false);
+   toButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;queryDialog_glade::on_toButton_clicked), false);
 }
 
 queryDialog_glade::~queryDialog_glade()

Modified: trunk/UI/GTK2/src/queryDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/queryDialog_glade.hh	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/UI/GTK2/src/queryDialog_glade.hh	2007-01-11 15:35:47 UTC (rev 691)
@@ -1,9 +1,9 @@
-// generated 2006/10/14 9:28:11 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
+// generated 2007/1/11 21:02:42 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
 // glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
-// for gtk 2.8.20 and gtkmm 2.8.8
+// for gtk 2.10.4 and gtkmm 2.10.5
 //
 // Please modify the corresponding derived classes in ./src/queryDialog.hh and./src/queryDialog.cc
 
@@ -53,6 +53,10 @@
         class Gtk::CheckButton * indexCheckbutton;
         class Gtk::ComboBox * labelNameCombobox;
         class Gtk::SpinButton * resultsCountSpinbutton;
+        class Gtk::CheckButton * fromCheckbutton;
+        class Gtk::CheckButton * toCheckbutton;
+        class Gtk::Button * fromButton;
+        class Gtk::Button * toButton;
         
         queryDialog_glade();
         
@@ -61,5 +65,7 @@
         virtual void on_queryOkbutton_clicked() = 0;
         virtual void on_nameEntry_changed() = 0;
         virtual void on_addFilterButton_clicked() = 0;
+        virtual void on_fromButton_clicked() = 0;
+        virtual void on_toButton_clicked() = 0;
 };
 #endif

Modified: trunk/po/POTFILES.in
===================================================================
--- trunk/po/POTFILES.in	2007-01-09 23:57:14 UTC (rev 690)
+++ trunk/po/POTFILES.in	2007-01-11 15:35:47 UTC (rev 691)
@@ -1,6 +1,10 @@
 # List of source files containing translatable strings.
 UI/GTK2/src/DaemonState.cpp
 UI/GTK2/src/EnginesTree.cpp
+UI/GTK2/src/dateDialog.cc
+UI/GTK2/src/dateDialog_glade.cc
+UI/GTK2/src/indexDialog.cc
+UI/GTK2/src/indexDialog_glade.cc
 UI/GTK2/src/importDialog.cc
 UI/GTK2/src/importDialog_glade.cc
 UI/GTK2/src/indexDialog.cc


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000684.html">[Pinot-svn] r690 - in trunk: UI/GTK2/src Utils
</A></li>
	<LI>Next message: <A HREF="000686.html">[Pinot-svn] r692 - in trunk: UI/GTK2/src Utils
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#685">[ date ]</a>
              <a href="thread.html#685">[ thread ]</a>
              <a href="subject.html#685">[ subject ]</a>
              <a href="author.html#685">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/pinot-svn">More information about the Pinot-svn
mailing list</a><br>
</body></html>
