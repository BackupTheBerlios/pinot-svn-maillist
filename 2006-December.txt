From fabricecolin at mail.berlios.de  Fri Dec  1 12:08:16 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 1 Dec 2006 12:08:16 +0100
Subject: [Pinot-svn] r602 - trunk/Index
Message-ID: <200612011108.kB1B8Ghx032191@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-01 12:08:16 +0100 (Fri, 01 Dec 2006)
New Revision: 602

Modified:
   trunk/Index/XapianDatabase.cpp
   trunk/Index/XapianDatabase.h
Log:
Contrary to what I thought, simultaneous read accesses on the same Database
object are not safe ! Of course, it's only on SMP systems that weird problems
cropped up.


Modified: trunk/Index/XapianDatabase.cpp
===================================================================
--- trunk/Index/XapianDatabase.cpp	2006-11-27 14:25:46 UTC (rev 601)
+++ trunk/Index/XapianDatabase.cpp	2006-12-01 11:08:16 UTC (rev 602)
@@ -39,7 +39,7 @@
 	m_pFirst(NULL),
 	m_pSecond(NULL)
 {
-	pthread_rwlock_init(&m_rwLock, NULL);
+	pthread_mutex_init(&m_rwLock, NULL);
 	openDatabase();
 }
 
@@ -53,7 +53,7 @@
 	m_pFirst(pFirst),
 	m_pSecond(pSecond)
 {
-	pthread_rwlock_init(&m_rwLock, NULL);
+	pthread_mutex_init(&m_rwLock, NULL);
 }
 
 XapianDatabase::XapianDatabase(const XapianDatabase &other) :
@@ -65,7 +65,7 @@
 	m_pFirst(other.m_pFirst),
 	m_pSecond(other.m_pSecond)
 {
-	pthread_rwlock_init(&m_rwLock, NULL);
+	pthread_mutex_init(&m_rwLock, NULL);
 	if (other.m_pDatabase != NULL)
 	{
 		m_pDatabase = new Xapian::Database(*other.m_pDatabase);
@@ -78,7 +78,7 @@
 	{
 		delete m_pDatabase;
 	}
-	pthread_rwlock_destroy(&m_rwLock);
+	pthread_mutex_destroy(&m_rwLock);
 }
 
 XapianDatabase &XapianDatabase::operator=(const XapianDatabase &other)
@@ -215,8 +215,6 @@
 		cerr << "XapianDatabase::openDatabase: couldn't open database: "
 			<< error.get_msg() << endl;
 	}
-
-	return;
 }
 
 /// Returns false if the database couldn't be opened.
@@ -230,14 +228,14 @@
 {
 	// This is provided by Xapian::Database
 	// FIXME: get the write lock to make sure read operations are not in progress ?
-	if (pthread_rwlock_rdlock(&m_rwLock) == 0)
+	if (pthread_mutex_lock(&m_rwLock) == 0)
 	{
 		if (m_pDatabase != NULL)
 		{
 			m_pDatabase->reopen();
 		}
 
-		pthread_rwlock_unlock(&m_rwLock);
+		pthread_mutex_unlock(&m_rwLock);
 	}
 }
 
@@ -246,8 +244,11 @@
 {
 	if (m_merge == false)
 	{
-		if (pthread_rwlock_rdlock(&m_rwLock) == 0)
+		if (pthread_mutex_lock(&m_rwLock) == 0)
 		{
+#ifdef DEBUG
+			cout << "XapianDatabase::readLock: thread " << pthread_self() << endl;
+#endif
 			if (m_pDatabase == NULL)
 			{
 				// Try again
@@ -266,8 +267,11 @@
 			return NULL;
 		}
 
-		if (pthread_rwlock_rdlock(&m_rwLock) == 0)
+		if (pthread_mutex_lock(&m_rwLock) == 0)
 		{
+#ifdef DEBUG
+			cout << "XapianDatabase::readLock: thread " << pthread_self() << endl;
+#endif
 			// Reopen the second index
 			m_pSecond->reopen();
 
@@ -301,13 +305,16 @@
 		return NULL;
 	}
 
-	if (pthread_rwlock_wrlock(&m_rwLock) == 0)
+	if (pthread_mutex_lock(&m_rwLock) == 0)
 	{
 		if (m_pDatabase == NULL)
 		{
 			// Try again
 			openDatabase();
 		}
+#ifdef DEBUG
+		cout << "XapianDatabase::writeLock: thread " << pthread_self() << endl;
+#endif
 		return dynamic_cast<Xapian::WritableDatabase *>(m_pDatabase);
 	}
 
@@ -317,7 +324,10 @@
 /// Unlocks the database.
 void XapianDatabase::unlock(void)
 {
-	pthread_rwlock_unlock(&m_rwLock);
+#ifdef DEBUG
+	cout << "XapianDatabase::unlock: thread " << pthread_self() << endl;
+#endif
+	pthread_mutex_unlock(&m_rwLock);
 
 	if (m_merge == true)
 	{

Modified: trunk/Index/XapianDatabase.h
===================================================================
--- trunk/Index/XapianDatabase.h	2006-11-27 14:25:46 UTC (rev 601)
+++ trunk/Index/XapianDatabase.h	2006-12-01 11:08:16 UTC (rev 602)
@@ -57,7 +57,7 @@
 	protected:
 		std::string m_databaseName;
 		bool m_readOnly;
-		pthread_rwlock_t m_rwLock;
+		pthread_mutex_t m_rwLock;
 		Xapian::Database *m_pDatabase;
 		bool m_isOpen;
 		bool m_merge;



From fabricecolin at mail.berlios.de  Fri Dec  1 12:11:25 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 1 Dec 2006 12:11:25 +0100
Subject: [Pinot-svn] r603 - trunk/UI/GTK2/src
Message-ID: <200612011111.kB1BBPuh001174@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-01 12:11:25 +0100 (Fri, 01 Dec 2006)
New Revision: 603

Modified:
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/WorkerThreads.h
Log:
Glib::Dispatcher is supposed to allow multiple senders without locking, but
some people on the gtkmm mailing list think otherwise :-) Better safe than
sorry. I am adding a mutex in emitSignal().


Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-01 11:08:16 UTC (rev 602)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-01 11:11:25 UTC (rev 603)
@@ -87,6 +87,7 @@
 };
 
 Dispatcher WorkerThread::m_dispatcher;
+pthread_mutex_t WorkerThread::m_dispatcherMutex = PTHREAD_MUTEX_INITIALIZER;
 bool WorkerThread::m_immediateFlush = true;
 
 Dispatcher &WorkerThread::getDispatcher(void)
@@ -175,11 +176,19 @@
 
 void WorkerThread::emitSignal(void)
 {
+	m_done = true;
+	if (pthread_mutex_lock(&m_dispatcherMutex) == 0)
+	{
 #ifdef DEBUG
-	cout << "WorkerThread::emitSignal: end of thread " << m_id << endl;
+		cout << "WorkerThread::emitSignal: signaling end of thread " << m_id << endl;
 #endif
-	m_done = true;
-	m_dispatcher.emit();
+		m_dispatcher();
+#ifdef DEBUG
+		cout << "WorkerThread::emitSignal: signaled end of thread " << m_id << endl;
+#endif
+
+		pthread_mutex_unlock(&m_dispatcherMutex);
+	}
 }
 
 ThreadsManager::ThreadsManager(const string &defaultIndexLocation,
@@ -457,7 +466,7 @@
 	WorkerThread *pThread = get_thread();
 	while (pThread != NULL)
 	{
-		m_onThreadEndSignal.emit(pThread);
+		m_onThreadEndSignal(pThread);
 
 		// Next
 		pThread = get_thread();
@@ -493,7 +502,7 @@
 #endif
 		return;
 	}
-	m_onThreadEndSignal.emit(pThread);
+	m_onThreadEndSignal(pThread);
 }
 
 ustring ThreadsManager::queue_index(const DocumentInfo &docInfo)
@@ -1291,8 +1300,15 @@
 				// Update the document
 				if (pIndex->updateDocument(m_docId, *pTokens) == true)
 				{
+#ifdef DEBUG
+					cout << "IndexingThread::doWork: updated " << m_pDoc->getLocation()
+						<< " at " << m_docId << endl;
+#endif
 					success = true;
 				}
+#ifdef DEBUG
+				else cout << "IndexingThread::doWork: couldn't update " << m_pDoc->getLocation() << endl;
+#endif
 			}
 			else
 			{
@@ -1304,7 +1320,14 @@
 				if (success == true)
 				{
 					m_docId = docId;
+#ifdef DEBUG
+					cout << "IndexingThread::doWork: indexed " << m_pDoc->getLocation()
+						<< " to " << m_docId << endl;
+#endif
 				}
+#ifdef DEBUG
+				else cout << "IndexingThread::doWork: couldn't index " << m_pDoc->getLocation() << endl;
+#endif
 			}
 
 			if (success == false)
@@ -1405,9 +1428,15 @@
 			// we effectively delete the label from the index
 			if (pIndex->unindexDocuments(labelName) == true)
 			{
+#ifdef DEBUG
+				cout << "UnindexingThread::doWork: removed label " << labelName << endl;
+#endif
 				// OK
 				++m_docsCount;
 			}
+#ifdef DEBUG
+			else cout << "UnindexingThread::doWork: couldn't remove label " << labelName << endl;
+#endif
 		}
 
 		// Nothing to report
@@ -1421,6 +1450,9 @@
 
 			if (pIndex->unindexDocument(docId) == true)
 			{
+#ifdef DEBUG
+				cout << "UnindexingThread::doWork: removed " << docId << endl;
+#endif
 				// OK
 				++m_docsCount;
 			}
@@ -1575,7 +1607,7 @@
 		}
 	}
 	m_done = true;
-	write(m_ctrlWritePipe, "Stop", 4);
+	write(m_ctrlWritePipe, "X", 1);
 
 	return true;
 }

Modified: trunk/UI/GTK2/src/WorkerThreads.h
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.h	2006-12-01 11:08:16 UTC (rev 602)
+++ trunk/UI/GTK2/src/WorkerThreads.h	2006-12-01 11:11:25 UTC (rev 603)
@@ -74,6 +74,7 @@
 	protected:
 		/// Use a Dispatcher for thread safety
 		static Glib::Dispatcher m_dispatcher;
+		static pthread_mutex_t m_dispatcherMutex;
 		static bool m_immediateFlush;
 		bool m_joinable;
 		unsigned int m_id;



From fabricecolin at mail.berlios.de  Fri Dec  1 14:12:02 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 1 Dec 2006 14:12:02 +0100
Subject: [Pinot-svn] r604 - trunk
Message-ID: <200612011312.kB1DC2Qv001103@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-01 14:12:02 +0100 (Fri, 01 Dec 2006)
New Revision: 604

Modified:
   trunk/pinot.spec.in
Log:
Build with -O0 in debug mode.


Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-12-01 11:11:25 UTC (rev 603)
+++ trunk/pinot.spec.in	2006-12-01 13:12:02 UTC (rev 604)
@@ -72,7 +72,7 @@
 %setup -q
 
 %build
-%configure %{?_with_soap:--with-soap=yes} %{?_with_debug:CXXFLAGS="%{optflags} -g -DDEBUG"}
+%configure %{?_with_soap:--with-soap=yes} %{?_with_debug:CXXFLAGS="-g -O0 -DDEBUG %{optflags}"}
 make
 
 %install



From fabricecolin at mail.berlios.de  Fri Dec  1 14:14:06 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 1 Dec 2006 14:14:06 +0100
Subject: [Pinot-svn] r605 - trunk/Tokenize
Message-ID: <200612011314.kB1DE6ah001262@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-01 14:14:06 +0100 (Fri, 01 Dec 2006)
New Revision: 605

Modified:
   trunk/Tokenize/PdfTokenizer.cpp
   trunk/Tokenize/PdfTokenizer.h
Log:
Pass -htmlmeta to pdftotext so that document text is wrapped in html with
some useful metadata.


Modified: trunk/Tokenize/PdfTokenizer.cpp
===================================================================
--- trunk/Tokenize/PdfTokenizer.cpp	2006-12-01 13:12:02 UTC (rev 604)
+++ trunk/Tokenize/PdfTokenizer.cpp	2006-12-01 13:14:06 UTC (rev 605)
@@ -46,21 +46,29 @@
 }
 
 PdfTokenizer::PdfTokenizer(const Document *pDocument) :
-	Tokenizer(NULL),
-	m_pStrippedDocument(NULL)
+	HtmlTokenizer(NULL, false)
 {
-	m_pStrippedDocument = runHelperProgram(pDocument, "pdftotext", "-");
-	if (m_pStrippedDocument != NULL)
+	Document *pHtmlDocument = runHelperProgram(pDocument, "pdftotext -htmlmeta", "-");
+	if (pHtmlDocument != NULL)
 	{
-		// Pass the result to the parent class
-		setDocument(m_pStrippedDocument);
+		if (parseHTML(pHtmlDocument) == true)
+		{
+			// Pass the result to the parent class
+			m_pStrippedDocument = new Document(pHtmlDocument->getTitle(),
+				pHtmlDocument->getLocation(), pHtmlDocument->getType(),
+				pHtmlDocument->getLanguage());
+			m_pStrippedDocument->setData(m_state.m_text.c_str(), m_state.m_text.length());
+			m_pStrippedDocument->setTimestamp(pHtmlDocument->getTimestamp());
+			m_pStrippedDocument->setSize(pHtmlDocument->getSize());
+
+			setDocument(m_pStrippedDocument);
+		}
+
+		delete pHtmlDocument;
 	}
 }
 
 PdfTokenizer::~PdfTokenizer()
 {
-	if (m_pStrippedDocument != NULL)
-	{
-		delete m_pStrippedDocument;
-	}
+	// ~HtmlTokenizer will delete m_pStrippedDocument
 }

Modified: trunk/Tokenize/PdfTokenizer.h
===================================================================
--- trunk/Tokenize/PdfTokenizer.h	2006-12-01 13:12:02 UTC (rev 604)
+++ trunk/Tokenize/PdfTokenizer.h	2006-12-01 13:14:06 UTC (rev 605)
@@ -23,7 +23,7 @@
 #include <set>
 
 #include "Document.h"
-#include "Tokenizer.h"
+#include "HtmlTokenizer.h"
 
 /// This returns the MIME types supported by the library's tokenizer.
 bool getTokenizerTypes(std::set<std::string> &types);
@@ -32,15 +32,12 @@
 /// This returns a pointer to a Tokenizer, allocated with new.
 Tokenizer *getTokenizer(const Document *pDocument);
 
-class PdfTokenizer : public Tokenizer
+class PdfTokenizer : public HtmlTokenizer
 {
 	public:
 		PdfTokenizer(const Document *pDocument);
 		virtual ~PdfTokenizer();
 
-	protected:
-		Document *m_pStrippedDocument;
-
 	private:
 		PdfTokenizer(const PdfTokenizer &other);
 		PdfTokenizer& operator=(const PdfTokenizer& other);



From fabricecolin at mail.berlios.de  Fri Dec  1 16:48:47 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 1 Dec 2006 16:48:47 +0100
Subject: [Pinot-svn] r606 - trunk/Index
Message-ID: <200612011548.kB1FmlN9026866@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-01 16:48:46 +0100 (Fri, 01 Dec 2006)
New Revision: 606

Modified:
   trunk/Index/XapianIndex.cpp
Log:
The length of R-prefixed terms was not limited. This could raise "key too long"
exceptions and prevent some documents from being indexed.
Print the exception's errno when caught. Made DEBUG a bit more verbose.


Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-12-01 13:14:06 UTC (rev 605)
+++ trunk/Index/XapianIndex.cpp	2006-12-01 15:48:46 UTC (rev 606)
@@ -68,7 +68,7 @@
 		{
 			// This posting may have been removed already
 #ifdef DEBUG
-			cout << "XapianIndex::removeFirstPosting: " << error.get_msg() << endl;
+			cout << "XapianIndex::removeFirstPosting: " << error.get_errno() << " " << error.get_msg() << endl;
 #endif
 		}
 	}
@@ -193,7 +193,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't get document list: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't get document list: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -227,7 +227,7 @@
 		if (isupper((int)term[0]) != 0)
 		{
 			// R-prefix the raw term
-			doc.add_posting(string("R") + term, termPos);
+			doc.add_posting(limitTermLength(string("R") + term), termPos);
 		}
 		// Lower case the term
 		term = StringManip::toLowerCase(term);
@@ -530,7 +530,7 @@
 		}
 		catch (const Xapian::Error &error)
 		{
-			cerr << "XapianIndex::scanDocument: " << error.get_type() << ": " << error.get_msg() << endl;
+			cerr << "XapianIndex::scanDocument: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 			continue;
 		}
 
@@ -671,7 +671,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't get document properties: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't get document properties: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -719,7 +719,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't check document labels: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't check document labels: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -771,7 +771,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't get document's labels: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't get document's labels: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -817,7 +817,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't look for document: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't look for document: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -898,7 +898,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't get terms: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't get terms: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -931,7 +931,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't get last document ID: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't get last document ID: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -975,7 +975,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't count documents: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't count documents: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1056,9 +1056,6 @@
 		Xapian::Document doc;
 		Xapian::termcount termPos = 0;
 
-#ifdef DEBUG
-		cout << "XapianIndex::indexDocument: adding terms" << endl;
-#endif
 		// Add the tokenizer's terms to the Xapian document
 		addPostingsToDocument(tokens, doc, "", termPos, m_stemMode);
 		// Add labels
@@ -1082,7 +1079,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't index document: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't index document: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1165,7 +1162,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't update document: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't update document: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1213,7 +1210,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't update document properties: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't update document properties: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1278,7 +1275,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't update document's labels: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't update document's labels: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1311,6 +1308,9 @@
 		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
 		if (pIndex != NULL)
 		{
+#ifdef DEBUG
+			cout << "XapianIndex::unindexDocument: indexed " << docId << endl;
+#endif
 			// Delete the document from the index
 			pIndex->delete_document(docId);
 			unindexed = true;
@@ -1318,7 +1318,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't unindex document: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't unindex document: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1353,6 +1353,9 @@
 		{
 			string term = limitTermLength(string("U") + Url::canonicalizeUrl(location), true);
 
+#ifdef DEBUG
+			cout << "XapianIndex::unindexDocuments: indexed " << term << endl;
+#endif
 			// Only one document should have this term
 			pIndex->delete_document(term);
 			unindexed = true;
@@ -1360,7 +1363,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't unindex documents: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't unindex documents: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1395,6 +1398,9 @@
 		{
 			string term("XLABEL:");
 
+#ifdef DEBUG
+			cout << "XapianIndex::unindexDocuments: indexed " << labelName << endl;
+#endif
 			// Delete documents from the index
 			term += labelName;
 			pIndex->delete_document(term);
@@ -1403,7 +1409,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't unindex documents: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't unindex documents: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1455,7 +1461,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't delete label: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't delete label: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1504,7 +1510,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't delete label: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't delete label: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{
@@ -1538,7 +1544,7 @@
 	}
 	catch (const Xapian::Error &error)
 	{
-		cerr << "Couldn't flush database: " << error.get_type() << ": " << error.get_msg() << endl;
+		cerr << "Couldn't flush database: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
 	}
 	catch (...)
 	{



From fabricecolin at mail.berlios.de  Fri Dec  1 16:53:02 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 1 Dec 2006 16:53:02 +0100
Subject: [Pinot-svn] r607 - trunk
Message-ID: <200612011553.kB1Fr2iv027476@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-01 16:53:01 +0100 (Fri, 01 Dec 2006)
New Revision: 607

Modified:
   trunk/AUTHORS
   trunk/NEWS
   trunk/README
   trunk/TODO
Log:
Status update.


Modified: trunk/AUTHORS
===================================================================
--- trunk/AUTHORS	2006-12-01 15:48:46 UTC (rev 606)
+++ trunk/AUTHORS	2006-12-01 15:53:01 UTC (rev 607)
@@ -8,6 +8,7 @@
 	SuSE-friendly spec file - Marcus Rueckert <darix at web dot de>
 	Simplified UI - Manuel Breitfeld <manu_foren at gmx dot net>
 	Missing copyright notice - Gauvain Pocentek <gauvainpocentek at gmail dot com>
+	Desktop file installation - Oskar <???>
 
 The file Monitor/linux-inotify-syscalls.h is originally from libinotify
 (Copyright ? 2005 Ryan Lortie <desrt at desrt dot ca>).

Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2006-12-01 15:48:46 UTC (rev 606)
+++ trunk/NEWS	2006-12-01 15:53:01 UTC (rev 607)
@@ -1,3 +1,19 @@
+??? version_0_6_4
+Collect :
+ - don't needlessly load files that are going to be handled by an helper application
+Index :
+ - store documents size and file extension, if any
+ - fixed concurrency bug that could thrash the index on SMP systems
+ - very long capitalized terms could lead to document loss
+Search :
+ - regenerated the Google SOAP API stubs with gsoap 2.7.8c
+UI :
+ - added filter on file extension
+Daemon :
+ - set a lower scheduling priority
+ - queue events in the database, not in memory
+ - clean exit when signalled/stopped while crawling
+
 2006/11/18 version_0_6_3
 Collect :
  - watch out for NULL characters in data
@@ -2,3 +18,3 @@
 Tokenize :
- - fixed memory leak. Temporary documents were not deleted most of the time.
+ - fixed memory leak. Temporary documents were not deleted most of the time
 UI :

Modified: trunk/README
===================================================================
--- trunk/README	2006-12-01 15:48:46 UTC (rev 606)
+++ trunk/README	2006-12-01 15:53:01 UTC (rev 607)
@@ -236,14 +236,15 @@
        change (adding or removing a directory or mbox file) will take effect
        when the service is restarted.
      * when starting, the service will first crawl all configured locations
-       and (re)index new and modified files. This might be CPU intensive,
-       but not so much that it prevents you from doing anything else.
+       and (re)index new and modified files. Starting with 0.64, the daemon's
+       scheduling priority is set very low (15, can be adjusted with --priority)
+       so that you can still play UT2004 while it is indexing !
      * when finished crawling, the service will monitor these locations
        for changes and should consume little resources, unless a huge
        quantity of files needs its attention.
-     * any change detected by the monitor is immediately acted upon, ie the
-       daemon will reindex right away a file that was modified. Future
-       releases will queue events and act on them only when the system is idle.
+     * any change detected by the monitor is immediately queued and acted upon
+       as soon as possible, eg reindex a file that was modified. This and low
+       priority should make the daemon not very intrusive.
 
   If you have dbus-send installed, you can start the daemon manually by calling
   the GetStatistics method with
@@ -265,7 +266,7 @@
   Deskbar Applet provides an omnipresent versatile search interface for Gnome.
   Searching documents indexed by Pinot with the applet is possible. Users
   of RPM-based systems may install the pinot-desbar RPM. Otherwise, the
-  file UI/pinot-live.py can simply be copied into
+  file scripts/python/pinot-live.py can simply be copied into
   $PREFIX/lib/deskbar-applet/handlers (or, on 64 bit systems,
   $PREFIX/lib64/deskbar-applet/handlers) for use by all users, or into
   ~/.gnome2/deskbar-applet/handlers for use only by the current user.
@@ -298,6 +299,9 @@
 13. Dependencies
 
 
+  The version numbers indicate the minimum version Pinot has been tested
+  with; older versions may or may not work.
+
 ---------------------------------------------------------------
 Name							Version
 ---------------------------------------------------------------
@@ -315,7 +319,7 @@
 
 Google SOAP API (2)	Search/Google/googleapi		beta2
 
- GSOAP							2.7.6e
+ gSOAP							2.7.8c
  http://www.cs.fsu.edu/~engelen/soap.html
 
 gtkmm							2.6.2
@@ -386,9 +390,22 @@
     https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=178592
     The latest version seems to fix this issue.
 
+  * If the daemon crashes seemingly randomly while indexing, it may be because
+    SQLite wasn't built thread-safe. I have witnessed this mostly on dual CPU
+    machines, but others are not immune. Try rebuilding SQLite by passing
+    "--enable-threadsafe --enable-threads-override-locks" to configure.
+
   * If you have built Pinot from source, make sure you have done a "make install".
     Pinot will fail to start if it can't find stuff it needs, its icon for instance.
 
+  * If "make install" fails with an error about Categories in pinot.desktop
+    and you have desktop-file-utils 0.11, either downgrade to 0.10 or upgrade to 0.12
+    if possible, or edit the top-level Makefile and replace the line 
+     @desktop-file-install --vendor="" --dir=$(DESTDIR)$(datadir)/applications pinot.desktop
+    with
+     $(INSTALL_DATA) pinot.desktop $(DESTDIR)$(datadir)/applications/pinot.desktop
+    and run "make install" again.
+
   * The directory filter doesn't work as expected if the filter starts with a
     non alpha-numeric character
     This has been fixed in Xapian 0.9.8.

Modified: trunk/TODO
===================================================================
--- trunk/TODO	2006-12-01 15:48:46 UTC (rev 606)
+++ trunk/TODO	2006-12-01 15:53:01 UTC (rev 607)
@@ -4,7 +4,6 @@
 - Advertise service via Rendezvous
 - MIMEScanner should also return parent types so that we don't filter out types unnecessarily
 - Build a -devel package for those who want to write their own tokenizers
-- Allow building without inotify/the DBus daemon
 
 Tokenize
 - Allow to cache documents that had to be converted ? eg PDF, MS Word
@@ -14,6 +13,7 @@
 - Spin tokenizers into separate project, a la libextractor
 - Check whether pdftotext flattens text in PDF documents that have columns
 - HtmlTokenizer should skip htdig_noindex blocks (http://www.htdig.org/attrs.html#noindex_start)
+- HtmlTokenizer to look for META tags Author, Creator, Publisher and CreationDate
 
 Monitor
 - Implement support for Solaris FEM
@@ -33,7 +33,7 @@
 - Implement AutoDiscovery of OpenSearch Description files (http://opensearch.a9.com/spec/1.1/description/)
 - Make sure Description files' SyndicationRight is not private or closed
 - Support for Google Buttons
-- Export search results as OpenSearch Response
+- Export search results as OpenSearch Response or CSV
 
 Index
 - Get hold of stopwords lists for the languages supported by Xapian's stemmers and don't index stop words
@@ -47,6 +47,9 @@
 - Reopen connection to remote indexes when necessary; does Xapian throw a RemoteError ?
 - Allow to access remote Xapian indexes tunneled through ssh, using Xapian::Remote::open()
   defined in /usr/include/xapian/dbfactory.h
+- All indexes can be browsed with the new global posting list found in Xapian > 0.9.9, ie
+  Xapian::Database::postlist_begin("")
+- Store date as terms (D, M and Y prefixes), as done by omindex
 
 Mail
 - Find out what kind of locking scheme Mozilla uses (POSIX lock ?) and use that
@@ -58,7 +61,16 @@
     Date: Thu, 25 Aug 2005 11:04:49 +0800
   +0800 is basically same as SGT. At the moment the date is assumed to be GMT !
 - Keep track of attachments and avoid indexing the same file twice
+- Most mboxes are now correctly recognized as application/mbox so index their messages
 
+Daemon
+- Allow building without inotify/the DBus daemon
+- Clean up method names
+- Prefer ustring to string whenever possible
+- Make unique (http://guniqueapp.akl.lt/)
+- Queue unindexing too
+- Export Web searching over D-Bus
+
 UI
 - When sorting results by host name, give better score to results that appear several times
 - Show which threads are running, what they are doing, and allow to stop them selectively
@@ -69,11 +81,10 @@
 - Replace Combobox objects with ComboboxText's (glademm support required)
 - Replace glademm with libglademm ?
 - Filter documents by language, similarly to how labels are shown
-- Clean up method names
-- Prefer ustring to string whenever possible
 - Closing when threads are running gives the impression Pinot has crashed; how do we tell the user
   we are waiting for something to finish ?
 - Replace labels with tags (Leaftag, http://www.chipx86.com/wiki/Leaftag). Enable to import
   all the documents that match a specific tag
-- Make Pinot a unique app (http://guniqueapp.akl.lt/)
+- Either Live Query behaves like a live query (eg results list updated when new documents match)
+  or it is renamed to something else to avoid confusion
 



From fabricecolin at mail.berlios.de  Fri Dec  1 16:53:51 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 1 Dec 2006 16:53:51 +0100
Subject: [Pinot-svn] r608 - trunk
Message-ID: <200612011553.kB1FrpVH027554@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-01 16:53:51 +0100 (Fri, 01 Dec 2006)
New Revision: 608

Modified:
   trunk/Makefile.am
Log:
Distribute the enum-index script.


Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-12-01 15:53:01 UTC (rev 607)
+++ trunk/Makefile.am	2006-12-01 15:53:51 UTC (rev 608)
@@ -13,7 +13,7 @@
 	UI/GTK2/src/pinot-dbus-daemon.xml UI/GTK2/src/de.berlios.Pinot.service \
 	UI/GTK2/xapian-powered.png UI/GTK2/pinot.png \
 	UI/GTK2/metase-gtk2.glade UI/GTK2/metase-gtk2.gladep \
-	scripts/python/pinot-live.py
+	scripts/bash/pinot-enum-index.sh scripts/python/pinot-live.py
 
 man_MANS = Collect/pinot-collect.1 Index/pinot-index.1 Search/pinot-search.1 \
 	UI/GTK2/src/pinot.1 UI/GTK2/src/pinot-dbus-daemon.1



From fabricecolin at mail.berlios.de  Sat Dec  2 04:18:19 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 2 Dec 2006 04:18:19 +0100
Subject: [Pinot-svn] r609 - trunk/Collect
Message-ID: <200612020318.kB23IJ7A032568@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-02 04:18:18 +0100 (Sat, 02 Dec 2006)
New Revision: 609

Modified:
   trunk/Collect/NeonDownloader.cpp
Log:
Deserved dusting off.


Modified: trunk/Collect/NeonDownloader.cpp
===================================================================
--- trunk/Collect/NeonDownloader.cpp	2006-12-01 15:53:51 UTC (rev 608)
+++ trunk/Collect/NeonDownloader.cpp	2006-12-02 03:18:18 UTC (rev 609)
@@ -32,37 +32,6 @@
 
 using namespace std;
 
-static string g_locationHeaderValue;
-static string g_contentTypeHeaderValue;
-static void headerHandler(void *userdata, const char *value)
-{
-	long headerNum = (long)userdata;
-	if (headerNum == 1)
-	{
-		// Location
-		if (value == NULL)
-		{
-			g_locationHeaderValue.clear();
-		}
-		else
-		{
-			g_locationHeaderValue = value;
-		}
-	}
-	else if (headerNum == 2)
-	{
-		// Content-Type
-		if (value == NULL)
-		{
-			g_contentTypeHeaderValue.clear();
-		}
-		else
-		{
-			g_contentTypeHeaderValue = value;
-		}
-	}
-}
-
 unsigned int NeonDownloader::m_initialized = 0;
 
 NeonDownloader::NeonDownloader() :
@@ -100,7 +69,7 @@
 
 	Document doc;
 	doc.setData(pBody, length);
-	HtmlTokenizer tokens(&doc);
+	HtmlTokenizer tokens(&doc, false);
 
 	// Extract the link from the 3xx message
 	set<Link> linksSet = tokens.getLinks();
@@ -167,6 +136,8 @@
 	string location = urlObj.getLocation();
 	string file = urlObj.getFile();
 	string parameters = urlObj.getParameters();
+	string locationHeaderValue;
+	string contentTypeHeaderValue;
 
 	// Create a session
 	ne_session *pSession = ne_session_create(protocol.c_str(), hostName.c_str(), 80); // urlObj.getPort());
@@ -218,10 +189,8 @@
 	int requestStatus = NE_RETRY;
 	while (requestStatus == NE_RETRY)
 	{
-		// FIXME: this is apparently the only way to get the value of an HTTP header
-		g_locationHeaderValue.clear();
-		ne_add_response_header_handler(pRequest, "Location", headerHandler, (void*)1);
-		ne_add_response_header_handler(pRequest, "Content-Type", headerHandler, (void*)2);
+		locationHeaderValue.clear();
+		contentTypeHeaderValue.clear();
 
 		// Begin the request
 		requestStatus = ne_begin_request(pRequest);
@@ -256,6 +225,18 @@
 				contentLen += bytesRead;
 			}
 
+			// Get headers
+			const char *pValue = ne_get_response_header(pRequest, "Last-Modified");
+			if (pValue != NULL)
+			{
+				locationHeaderValue = pValue;
+			}
+			pValue = ne_get_response_header(pRequest, "Content-Type");
+			if (pValue != NULL)
+			{
+				contentTypeHeaderValue = pValue;
+			}
+
 			// Redirection ?
 			if ((statusCode >= 300) &&
 				(statusCode < 400) &&
@@ -269,7 +250,7 @@
 				if (documentUrl.empty() == true)
 				{
 					// Did we find a Location header ?
-					if (g_locationHeaderValue.empty() == true)
+					if (locationHeaderValue.empty() == true)
 					{
 						// Fail
 						free(pContent);
@@ -277,7 +258,7 @@
 						contentLen = 0;
 						break;
 					}
-					documentUrl = g_locationHeaderValue;
+					documentUrl = locationHeaderValue;
 				}
 
 #ifdef DEBUG
@@ -356,7 +337,7 @@
 			pDocument = new Document(docInfo);
 			pDocument->setData(pContent, contentLen);
 			pDocument->setLocation(url);
-			pDocument->setType(g_contentTypeHeaderValue);
+			pDocument->setType(contentTypeHeaderValue);
 #ifdef DEBUG
 			cout << "NeonDownloader::retrieveUrl: document size is " << contentLen << endl;
 #endif



From fabricecolin at mail.berlios.de  Sat Dec  2 04:45:42 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 2 Dec 2006 04:45:42 +0100
Subject: [Pinot-svn] r610 - in trunk: SQL Tokenize UI/GTK2/src
Message-ID: <200612020345.kB23jgJ4010108@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-02 04:45:41 +0100 (Sat, 02 Dec 2006)
New Revision: 610

Modified:
   trunk/SQL/SQLiteBase.cpp
   trunk/Tokenize/TagLibTokenizer.cpp
   trunk/UI/GTK2/src/DaemonState.cpp
   trunk/UI/GTK2/src/Notebook.cpp
Log:
Fixed minor warnings.


Modified: trunk/SQL/SQLiteBase.cpp
===================================================================
--- trunk/SQL/SQLiteBase.cpp	2006-12-02 03:18:18 UTC (rev 609)
+++ trunk/SQL/SQLiteBase.cpp	2006-12-02 03:45:41 UTC (rev 610)
@@ -70,7 +70,7 @@
 	if (nColumn < m_nColumns)
 	{
 		vector<string>::const_iterator colIter = m_columns.begin();
-		for (unsigned int i = 0; (i < m_nColumns) && (colIter != m_columns.end()); ++i)
+		for (int i = 0; (i < m_nColumns) && (colIter != m_columns.end()); ++i)
 		{
 			if (i == nColumn)
 			{
@@ -250,7 +250,6 @@
 SQLiteResults *SQLiteBase::executeStatement(const char *sqlFormat, ...) const
 {
 	SQLiteResults *pResults = NULL;
-	const char *pzTail = NULL;
 #ifdef _USE_VSNPRINTF
 	char stringBuff[2048];
 #endif

Modified: trunk/Tokenize/TagLibTokenizer.cpp
===================================================================
--- trunk/Tokenize/TagLibTokenizer.cpp	2006-12-02 03:18:18 UTC (rev 609)
+++ trunk/Tokenize/TagLibTokenizer.cpp	2006-12-02 03:45:41 UTC (rev 610)
@@ -60,7 +60,6 @@
 {
 	if (pDocument != NULL)
 	{
-		Document *pPseudoDocument = NULL;
 		Url urlObj(pDocument->getLocation());
 		string pseudoContent;
 

Modified: trunk/UI/GTK2/src/DaemonState.cpp
===================================================================
--- trunk/UI/GTK2/src/DaemonState.cpp	2006-12-02 03:18:18 UTC (rev 609)
+++ trunk/UI/GTK2/src/DaemonState.cpp	2006-12-02 03:45:41 UTC (rev 610)
@@ -71,7 +71,6 @@
 bool DaemonState::crawlLocation(const string &locationToCrawl, bool isSource, bool doMonitoring)
 {
 	DirectoryScannerThread *pScannerThread = NULL;
-	unsigned int sourceId = 0;
 
 	if (locationToCrawl.empty() == true)
 	{

Modified: trunk/UI/GTK2/src/Notebook.cpp
===================================================================
--- trunk/UI/GTK2/src/Notebook.cpp	2006-12-02 03:18:18 UTC (rev 609)
+++ trunk/UI/GTK2/src/Notebook.cpp	2006-12-02 03:45:41 UTC (rev 610)
@@ -102,11 +102,12 @@
 	m_tabEventBox(NULL)
 #endif
 {
+#if _USE_BUTTON_TAB
 	int width, height;
 
 	// Lookup the standard icon size
 	bool gotDimensions = IconSize::lookup(ICON_SIZE_MENU, width, height);
-
+#endif
 	m_tabLabel = manage(new Label(title));
 	m_tabImage = manage(new Image(StockID("gtk-close"), IconSize(ICON_SIZE_MENU)));
 #if _USE_BUTTON_TAB



From fabricecolin at mail.berlios.de  Sun Dec  3 16:02:11 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 3 Dec 2006 16:02:11 +0100
Subject: [Pinot-svn] r611 - in trunk: . Collect Index Search UI/GTK2/src
Message-ID: <200612031502.kB3F2BGl032123@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-03 16:02:10 +0100 (Sun, 03 Dec 2006)
New Revision: 611

Modified:
   trunk/Collect/pinot-collect.1
   trunk/Index/pinot-index.1
   trunk/Search/pinot-search.1
   trunk/UI/GTK2/src/pinot-dbus-daemon.1
   trunk/UI/GTK2/src/pinot.1
   trunk/configure.in
Log:
Updated man pages. Increased version number in preparation for release in
a few days time.


Modified: trunk/Collect/pinot-collect.1
===================================================================
--- trunk/Collect/pinot-collect.1	2006-12-02 03:45:41 UTC (rev 610)
+++ trunk/Collect/pinot-collect.1	2006-12-03 15:02:10 UTC (rev 611)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-COLLECT "1" "November 2006" "pinot-collect - pinot 0.63" "User Commands"
+.TH PINOT-COLLECT "1" "December 2006" "pinot-collect - pinot 0.64" "User Commands"
 .SH NAME
 pinot-collect \- Download an URL from the command-line
 .SH SYNOPSIS

Modified: trunk/Index/pinot-index.1
===================================================================
--- trunk/Index/pinot-index.1	2006-12-02 03:45:41 UTC (rev 610)
+++ trunk/Index/pinot-index.1	2006-12-03 15:02:10 UTC (rev 611)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-INDEX "1" "November 2006" "pinot-index - pinot 0.63" "User Commands"
+.TH PINOT-INDEX "1" "December 2006" "pinot-index - pinot 0.64" "User Commands"
 .SH NAME
 pinot-index \- Index documents from the command-line
 .SH SYNOPSIS

Modified: trunk/Search/pinot-search.1
===================================================================
--- trunk/Search/pinot-search.1	2006-12-02 03:45:41 UTC (rev 610)
+++ trunk/Search/pinot-search.1	2006-12-03 15:02:10 UTC (rev 611)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-SEARCH "1" "November 2006" "pinot-search - pinot 0.63" "User Commands"
+.TH PINOT-SEARCH "1" "December 2006" "pinot-search - pinot 0.64" "User Commands"
 .SH NAME
 pinot-search \- Query search engines from the command-line
 .SH SYNOPSIS

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.1
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.1	2006-12-02 03:45:41 UTC (rev 610)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.1	2006-12-03 15:02:10 UTC (rev 611)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-DBUS-DAEMON "1" "November 2006" "pinot-dbus-daemon - pinot 0.63" "User Commands"
+.TH PINOT-DBUS-DAEMON "1" "December 2006" "pinot-dbus-daemon - pinot 0.64" "User Commands"
 .SH NAME
 pinot-dbus-daemon \- D-Bus search and index daemon
 .SH SYNOPSIS
@@ -12,6 +12,9 @@
 \fB\-h\fR, \fB\-\-help\fR
 display this help and exit
 .TP
+\fB\-p\fR, \fB\-\-priority\fR
+set the daemon's priority (default 15)
+.TP
 \fB\-v\fR, \fB\-\-version\fR
 output version information and exit
 .SH "REPORTING BUGS"

Modified: trunk/UI/GTK2/src/pinot.1
===================================================================
--- trunk/UI/GTK2/src/pinot.1	2006-12-02 03:45:41 UTC (rev 610)
+++ trunk/UI/GTK2/src/pinot.1	2006-12-03 15:02:10 UTC (rev 611)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT "1" "November 2006" "pinot - pinot 0.63" "User Commands"
+.TH PINOT "1" "December 2006" "pinot - pinot 0.64" "User Commands"
 .SH NAME
 pinot \- A metasearch tool for the Free Desktop
 .SH SYNOPSIS

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-12-02 03:45:41 UTC (rev 610)
+++ trunk/configure.in	2006-12-03 15:02:10 UTC (rev 611)
@@ -2,7 +2,7 @@
 # using glademm V2.6.0
 
 AC_PREREQ(2.50)
-AC_INIT(pinot, 0.63,[fabricecolin at users.berlios.de])
+AC_INIT(pinot, 0.64,[fabricecolin at users.berlios.de])
 AM_INIT_AUTOMAKE
 AC_CONFIG_HEADERS(config.h)
 



From fabricecolin at mail.berlios.de  Sun Dec  3 16:31:44 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 3 Dec 2006 16:31:44 +0100
Subject: [Pinot-svn] r612 - trunk/po
Message-ID: <200612031531.kB3FViYR002468@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-03 16:31:43 +0100 (Sun, 03 Dec 2006)
New Revision: 612

Added:
   trunk/po/nl.po
Log:
Dutch translation by Tikkel, through Rosetta.


Added: trunk/po/nl.po
===================================================================
--- trunk/po/nl.po	2006-12-03 15:02:10 UTC (rev 611)
+++ trunk/po/nl.po	2006-12-03 15:31:43 UTC (rev 612)
@@ -0,0 +1,741 @@
+# Dutch translation for pinot
+# Copyright (c) 2006 Rosetta Contributors and Canonical Ltd 2006
+# This file is distributed under the same license as the pinot package.
+# FIRST AUTHOR <EMAIL at ADDRESS>, 2006.
+#
+#, fuzzy
+msgid ""
+msgstr ""
+"Project-Id-Version: pinot 0.64\n"
+"Report-Msgid-Bugs-To: \n"
+"POT-Creation-Date: 2006-11-29 21:01+0800\n"
+"PO-Revision-Date: 2006-12-03 15:13+0000\n"
+"Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
+"Language-Team: Dutch <nl at li.org>\n"
+"MIME-Version: 1.0\n"
+"Content-Type: text/plain; charset=UTF-8\n"
+"Content-Transfer-Encoding: 8bit\n"
+"X-Rosetta-Export-Date: 2006-12-03 15:18+0000\n"
+
+#: UI/GTK2/src/EnginesTree.cpp:70
+msgid "Search Engines"
+msgstr "Zoekmachines"
+
+#: UI/GTK2/src/EnginesTree.cpp:328
+msgid "Current User"
+msgstr "Huidige gebruiker"
+
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
+#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
+#: UI/GTK2/src/mainWindow.cc:1148 UI/GTK2/src/mainWindow.cc:1191
+#: UI/GTK2/src/mainWindow.cc:1211 UI/GTK2/src/mainWindow.cc:1242
+#: UI/GTK2/src/mainWindow.cc:1831 UI/GTK2/src/PinotSettings.cpp:235
+#: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
+msgid "My Web Pages"
+msgstr "Mijn webpagina's"
+
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:310
+#: UI/GTK2/src/mainWindow.cc:313 UI/GTK2/src/PinotSettings.cpp:236
+#: UI/GTK2/src/PinotSettings.cpp:1225 UI/GTK2/src/PinotSettings.cpp:1281
+msgid "My Documents"
+msgstr "Mijn documenten"
+
+#: UI/GTK2/src/importDialog.cc:83 UI/GTK2/src/queryDialog.cc:81
+msgid "None"
+msgstr "Geen"
+
+#: UI/GTK2/src/importDialog_glade.cc:67 UI/GTK2/src/indexDialog_glade.cc:68
+msgid "Location:"
+msgstr "Locatie"
+
+#: UI/GTK2/src/importDialog_glade.cc:68
+#: UI/GTK2/src/propertiesDialog_glade.cc:65
+msgid "Title:"
+msgstr "Titel"
+
+#: UI/GTK2/src/importDialog_glade.cc:71
+msgid "Apply label:"
+msgstr "Naam toepassen"
+
+#: UI/GTK2/src/importDialog_glade.cc:77
+msgid "Import"
+msgstr "Importeren"
+
+#: UI/GTK2/src/importDialog_glade.cc:148 UI/GTK2/src/mainWindow_glade.cc:213
+msgid "Import URL"
+msgstr "Importeren URL"
+
+#: UI/GTK2/src/indexDialog.cc:225
+msgid "Index location"
+msgstr "Index locatie"
+
+#: UI/GTK2/src/indexDialog_glade.cc:62 UI/GTK2/src/queryDialog_glade.cc:68
+msgid "Name:"
+msgstr "Naam:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:64
+msgid "..."
+msgstr "..."
+
+#: UI/GTK2/src/indexDialog_glade.cc:67
+msgid "Type:"
+msgstr "Type:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:69
+msgid "Port:"
+msgstr "Poort:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:143
+msgid "External index"
+msgstr "Externe index"
+
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:112
+#: UI/GTK2/src/ResultsTree.cpp:126
+msgid "Title"
+msgstr "Titel"
+
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:115
+#: UI/GTK2/src/ResultsTree.cpp:136
+msgid "URL"
+msgstr "URL"
+
+#: UI/GTK2/src/IndexTree.cpp:78
+msgid "Timestamp"
+msgstr "Tijdstip"
+
+#: UI/GTK2/src/IndexPage.cpp:51
+msgid "Show Previous"
+msgstr "Toon vorige"
+
+#: UI/GTK2/src/IndexPage.cpp:57
+msgid "Show Next"
+msgstr "Toon volgende"
+
+#: UI/GTK2/src/IndexPage.cpp:159 UI/GTK2/src/IndexPage.cpp:205
+msgid "All labels"
+msgstr "Alle namen"
+
+#: UI/GTK2/src/mainWindow.cc:138
+#, fuzzy
+msgid "Query Name"
+msgstr "Query naam"
+
+#: UI/GTK2/src/mainWindow.cc:143
+msgid "Last Run"
+msgstr "Laatst geopend"
+
+#: UI/GTK2/src/mainWindow.cc:148
+msgid "Summary"
+msgstr "Samenvatting"
+
+#: UI/GTK2/src/mainWindow.cc:181
+msgid "Show all search engines"
+msgstr "Toon alle zoekmachines"
+
+#: UI/GTK2/src/mainWindow.cc:182
+msgid "Add index"
+msgstr "Toevoegen index"
+
+#: UI/GTK2/src/mainWindow.cc:183
+msgid "Remove index"
+msgstr "Verwijderen index"
+
+#: UI/GTK2/src/mainWindow.cc:189
+msgid "Ready"
+msgstr "Gereed"
+
+#: UI/GTK2/src/mainWindow.cc:234
+msgid "N/A"
+msgstr "NVT"
+
+#: UI/GTK2/src/mainWindow.cc:249
+msgid "<undefined>"
+msgstr "<niet gedefinieerd>"
+
+#: UI/GTK2/src/mainWindow.cc:468
+msgid "Result location is"
+msgstr "Uitvoerlocatie is"
+
+#: UI/GTK2/src/mainWindow.cc:555
+msgid "Document location is"
+msgstr "Documentlocatie is"
+
+#: UI/GTK2/src/mainWindow.cc:873
+msgid "Showing"
+msgstr "Aan het tonen"
+
+#: UI/GTK2/src/mainWindow.cc:878
+msgid "of"
+msgstr "van"
+
+#: UI/GTK2/src/mainWindow.cc:883
+msgid "documents, starting at"
+msgstr "documenten, beginnend bij"
+
+#: UI/GTK2/src/mainWindow.cc:916
+msgid "Query"
+msgstr "Query"
+
+#: UI/GTK2/src/mainWindow.cc:920 UI/GTK2/src/mainWindow.cc:2890
+msgid "on"
+msgstr "op"
+
+#: UI/GTK2/src/mainWindow.cc:924
+msgid "ended"
+msgstr "Beeindigd"
+
+#: UI/GTK2/src/mainWindow.cc:1013
+msgid "More Like"
+msgstr "Meer zoals"
+
+#: UI/GTK2/src/mainWindow.cc:1074
+msgid "Updated label(s)"
+msgstr "Vernieuwde na(a)m(en)"
+
+#: UI/GTK2/src/mainWindow.cc:1158
+msgid "Updated document"
+msgstr "Vernieuwd document"
+
+#: UI/GTK2/src/mainWindow.cc:1171
+msgid "Indexed"
+msgstr "Geindexeerd"
+
+#: UI/GTK2/src/mainWindow.cc:1212
+msgid "Unindexed document(s)"
+msgstr "Niet geindexeerd(e) document(en)"
+
+#: UI/GTK2/src/mainWindow.cc:1253
+msgid "Updated document properties"
+msgstr "Vernieuwde documenteigenschappen"
+
+#: UI/GTK2/src/mainWindow.cc:1300
+msgid "Couldn't rename index, name"
+msgstr "Kon index niet hernoemen, naam"
+
+#: UI/GTK2/src/mainWindow.cc:1304 UI/GTK2/src/mainWindow.cc:2214
+#: UI/GTK2/src/mainWindow.cc:2725
+msgid "is already in use"
+msgstr "is reeds in gebruik"
+
+#: UI/GTK2/src/mainWindow.cc:1317
+msgid "Couldn't rename index"
+msgstr "Kon index niet hernoemen"
+
+#: UI/GTK2/src/mainWindow.cc:1330
+msgid "Edited index"
+msgstr "Bewerkte index"
+
+#: UI/GTK2/src/mainWindow.cc:1709 UI/GTK2/src/mainWindow.cc:2384
+msgid "Live query"
+msgstr "Rechtstreekse query"
+
+#: UI/GTK2/src/mainWindow.cc:1735
+msgid "Couldn't find query"
+msgstr "Kon query niet vinden"
+
+#: UI/GTK2/src/mainWindow.cc:1779 UI/GTK2/src/mainWindow.cc:1875
+msgid "Please set a location for the index first"
+msgstr "Geef aub eerst een bestemming voor de inhoudsopgave"
+
+#: UI/GTK2/src/mainWindow.cc:1954 UI/GTK2/src/WorkerThreads.cpp:680
+#: UI/GTK2/src/WorkerThreads.cpp:1499
+msgid "Index"
+msgstr "Inhoudsopgave"
+
+#: UI/GTK2/src/mainWindow.cc:1958 UI/GTK2/src/WorkerThreads.cpp:684
+#: UI/GTK2/src/WorkerThreads.cpp:1503
+msgid "doesn't exist"
+msgstr "bestaat niet"
+
+#: UI/GTK2/src/mainWindow.cc:2102
+msgid "Remove this document from the index ?"
+msgstr "Verwijder dit document uit de inhoudsopgave"
+
+#: UI/GTK2/src/mainWindow.cc:2121
+msgid "Remove these documents from the index ?"
+msgstr "Verwijder deze documenten uit de inhoudsopgave"
+
+#: UI/GTK2/src/mainWindow.cc:2165
+msgid "A metasearch tool for the Free Desktop"
+msgstr "Een metazoek tool voor de Free Desktop"
+
+#: UI/GTK2/src/mainWindow.cc:2166
+msgid "(C) 2005-2006 Fabrice Colin"
+msgstr "(C) 2005-2006 Fabrice Colin"
+
+#: UI/GTK2/src/mainWindow.cc:2210
+msgid "Index name"
+msgstr "Naam inhoudsopgave"
+
+#: UI/GTK2/src/mainWindow.cc:2225
+msgid "Couldn't add index"
+msgstr "Kon inhoudsopgave niet toevoegen"
+
+#: UI/GTK2/src/mainWindow.cc:2239
+msgid "Added new index"
+msgstr "Nieuwe inhoudsopgave toegevoegd"
+
+#: UI/GTK2/src/mainWindow.cc:2274
+msgid "Couldn't remove index"
+msgstr "Kon inhoudsopgave niet verwijderen"
+
+#: UI/GTK2/src/mainWindow.cc:2539
+msgid "At least one task hasn't completed yet. Quit now ?"
+msgstr "Tenminste een taak is nog niet gereed. Nu stoppen?"
+
+#: UI/GTK2/src/mainWindow.cc:2721
+msgid "Query name"
+msgstr "Naam query"
+
+#: UI/GTK2/src/mainWindow.cc:2748
+msgid "Couldn't update query"
+msgstr "Kon query niet actualiseren"
+
+#: UI/GTK2/src/mainWindow.cc:2756
+msgid "Edited query"
+msgstr "Bewerkte query"
+
+#: UI/GTK2/src/mainWindow.cc:2763
+msgid "Couldn't add query"
+msgstr "Kon query niet toevoegen"
+
+#: UI/GTK2/src/mainWindow.cc:2771
+msgid "Added new query"
+msgstr "Nieuwe query toegevoegd"
+
+#: UI/GTK2/src/mainWindow.cc:2784
+#, fuzzy
+msgid "Query is not set"
+msgstr "Query niet vastgelegd"
+
+#: UI/GTK2/src/mainWindow.cc:2795
+msgid "No search engine selected"
+msgstr "Geen zoekmachine geselecteerd"
+
+#: UI/GTK2/src/mainWindow.cc:2877
+msgid "Please set the Google API key first"
+msgstr "Geef eerst de Google API sleutel in"
+
+#: UI/GTK2/src/mainWindow.cc:2886
+msgid "Running query"
+msgstr "Lopende query"
+
+#: UI/GTK2/src/mainWindow.cc:3060
+msgid "No default application defined for type"
+msgstr "Geen standaard toepassing gedefinieerd voor het type"
+
+#: UI/GTK2/src/mainWindow_glade.cc:124
+msgid "Query:"
+msgstr "Query:"
+
+#: UI/GTK2/src/mainWindow_glade.cc:136
+msgid "Edit"
+msgstr "Bewerken"
+
+#: UI/GTK2/src/mainWindow_glade.cc:145
+msgid "Stored queries"
+msgstr "Opgeslagen queries"
+
+#: UI/GTK2/src/mainWindow_glade.cc:180
+msgid "Search Engine"
+msgstr "Zoekmachine"
+
+#: UI/GTK2/src/mainWindow_glade.cc:183
+msgid "Host Name"
+msgstr "Naam host"
+
+#: UI/GTK2/src/mainWindow_glade.cc:186
+msgid "Show Extract"
+msgstr "Toon uittreksel"
+
+#: UI/GTK2/src/mainWindow_glade.cc:189
+msgid "Group By"
+msgstr "Groeperen op"
+
+#: UI/GTK2/src/mainWindow_glade.cc:192
+msgid "Clear List"
+msgstr "Lijst opschonen"
+
+#: UI/GTK2/src/mainWindow_glade.cc:198
+msgid "Vie_w"
+msgstr "_Toon"
+
+#: UI/GTK2/src/mainWindow_glade.cc:201
+msgid "View Cache"
+msgstr "Toon cache"
+
+#: UI/GTK2/src/mainWindow_glade.cc:204
+msgid "More Like This"
+msgstr "Meer zoals deze"
+
+#: UI/GTK2/src/mainWindow_glade.cc:207 UI/GTK2/src/mainWindow_glade.cc:243
+msgid "_Index"
+msgstr "_Index"
+
+#: UI/GTK2/src/mainWindow_glade.cc:210
+msgid "List Contents Of"
+msgstr "Lijstinhoud van"
+
+#: UI/GTK2/src/mainWindow_glade.cc:219
+msgid "View"
+msgstr "Toon"
+
+#: UI/GTK2/src/mainWindow_glade.cc:222
+msgid "Update"
+msgstr "Verversen"
+
+#: UI/GTK2/src/mainWindow_glade.cc:225
+msgid "Unindex"
+msgstr "De-indexeren"
+
+#: UI/GTK2/src/mainWindow_glade.cc:228
+#: UI/GTK2/src/propertiesDialog_glade.cc:146
+msgid "Properties"
+msgstr "Eigenschappen"
+
+#: UI/GTK2/src/mainWindow_glade.cc:231
+msgid "_About"
+msgstr "_Over"
+
+#: UI/GTK2/src/mainWindow_glade.cc:234
+msgid "_Session"
+msgstr "_Sessie"
+
+#: UI/GTK2/src/mainWindow_glade.cc:237
+msgid "_Edit"
+msgstr "_Bewerken"
+
+#: UI/GTK2/src/mainWindow_glade.cc:240
+msgid "_Results"
+msgstr "_Resultaten"
+
+#: UI/GTK2/src/mainWindow_glade.cc:246
+msgid "_Help"
+msgstr "_Help"
+
+#: UI/GTK2/src/mainWindow_glade.cc:383
+msgid "Pinot"
+msgstr "Pinot"
+
+#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:699
+msgid "Unknown"
+msgstr "Niet bekend"
+
+#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:700
+msgid "Danish"
+msgstr "Deens"
+
+#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:701
+msgid "Dutch"
+msgstr "Nederlands"
+
+#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+msgid "English"
+msgstr "Engels"
+
+#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+msgid "Finnish"
+msgstr "Fins"
+
+#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+msgid "French"
+msgstr "Frans"
+
+#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+msgid "German"
+msgstr "Duits"
+
+#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+msgid "Italian"
+msgstr "Italiaans"
+
+#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+msgid "Norwegian"
+msgstr "Noors"
+
+#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+msgid "Portuguese"
+msgstr "Portugees"
+
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+msgid "Russian"
+msgstr "Russisch"
+
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+msgid "Spanish"
+msgstr "Spaans"
+
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+msgid "Swedish"
+msgstr "Zweeds"
+
+#: UI/GTK2/src/pinot.cc:206
+msgid "Couldn't open index"
+msgstr "Kan index niet openen"
+
+#: UI/GTK2/src/pinot.cc:222
+msgid "Couldn't create history database"
+msgstr "Kon historische database niet maken"
+
+#: UI/GTK2/src/PinotSettings.cpp:241
+msgid "Important"
+msgstr "Belangrijk"
+
+#: UI/GTK2/src/PinotSettings.cpp:242
+msgid "New"
+msgstr "Nieuw"
+
+#: UI/GTK2/src/PinotSettings.cpp:243
+msgid "Personal"
+msgstr "Persoonlijk"
+
+#: UI/GTK2/src/PinotSettings.cpp:1049
+msgid "Unclassified"
+msgstr "Niet geklassificeerd"
+
+#: UI/GTK2/src/prefsDialog.cc:67
+msgid "Name"
+msgstr "Naam"
+
+#: UI/GTK2/src/prefsDialog.cc:75
+#, fuzzy
+msgid "Monitor"
+msgstr "Abonneren"
+
+#: UI/GTK2/src/prefsDialog.cc:76 UI/GTK2/src/prefsDialog.cc:84
+msgid "Location"
+msgstr "Locatie"
+
+#: UI/GTK2/src/prefsDialog.cc:92
+msgid "Pattern"
+msgstr "Patroon"
+
+#: UI/GTK2/src/prefsDialog.cc:418
+msgid "New Label"
+msgstr "Nieuwe naam"
+
+#: UI/GTK2/src/prefsDialog.cc:459
+msgid "Directory to index"
+msgstr "Directory naar inhoudsopgave"
+
+#: UI/GTK2/src/prefsDialog.cc:517
+msgid "Mbox File Location"
+msgstr "Mbox bestandslocatie"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:65
+msgid "HTTP crawling:"
+msgstr "HTTP crawling:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:66
+msgid "Google API key:"
+msgstr "Google API sleutel:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:68
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "Negeer robots.txt en Robots META tag"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:70
+msgid "New results:"
+msgstr "Nieuwe resultaten:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:71
+msgid "Queries:"
+msgstr "Queries:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:72
+msgid "Enable search terms suggestion"
+msgstr "Zoektermsuggestie aanzetten"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:76
+msgid "General"
+msgstr "Algemeen"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
+msgid "Labels are used to classify indexed documents:"
+msgstr ""
+"Bijschriften worden gebruikt om geindexeerde documenten te klassificeren:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:82 UI/GTK2/src/prefsDialog_glade.cc:102
+#: UI/GTK2/src/prefsDialog_glade.cc:115 UI/GTK2/src/prefsDialog_glade.cc:128
+msgid "Add"
+msgstr "Toevoegen"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:88
+msgid "Remove"
+msgstr "Verwijderen"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:96
+msgid "Labels"
+msgstr "Bijschriften"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:97
+msgid ""
+"These directories will be indexed and optionally monitored for changes:"
+msgstr ""
+"Deze directories zullen geindexeerd worden en optioneel bijgewerkt worden "
+"bij veranderingen:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:110
+msgid "Mail boxes of type mbox can be monitored and indexed:"
+msgstr "Mailboxen van het type mbox kunnen worden bijgewerkt en geindexeerd:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:123
+msgid "Specify any file pattern you wish to exclude from indexing:"
+msgstr "Geef het bestandspatroon aan dat u van indexeren wilt uitsluiten:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:137
+msgid "Indexing"
+msgstr "Aan het indexeren"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:411
+msgid "Preferences"
+msgstr "Voorkeuren"
+
+#: UI/GTK2/src/propertiesDialog.cc:51 UI/GTK2/src/queryDialog.cc:127
+msgid "Label"
+msgstr "Bijschrift"
+
+#: UI/GTK2/src/propertiesDialog.cc:64
+msgid "Per document"
+msgstr "Per document"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:66
+msgid "Language:"
+msgstr "Taal:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:67
+msgid "MIME type:"
+msgstr "MIME type:"
+
+#: UI/GTK2/src/queryDialog.cc:103
+msgid "Host name"
+msgstr "Hostnaam"
+
+#: UI/GTK2/src/queryDialog.cc:106
+msgid "File name"
+msgstr "Bestandsnaam"
+
+#: UI/GTK2/src/queryDialog.cc:109
+#, fuzzy
+msgid "File extension"
+msgstr "Bestandssuffix"
+
+#: UI/GTK2/src/queryDialog.cc:118
+msgid "Directory"
+msgstr "Map"
+
+#: UI/GTK2/src/queryDialog.cc:121
+msgid "Language code"
+msgstr "Taal code"
+
+#: UI/GTK2/src/queryDialog.cc:124
+msgid "MIME type"
+msgstr "MIME type"
+
+#: UI/GTK2/src/queryDialog_glade.cc:72
+msgid "New filter:"
+msgstr "Nieuw filter:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:81
+msgid "Query Text"
+msgstr "Query tekst"
+
+#: UI/GTK2/src/queryDialog_glade.cc:83
+msgid "Index all results with label"
+msgstr "Indexeer alle resultaten met label"
+
+#: UI/GTK2/src/queryDialog_glade.cc:86
+msgid "Number of results:"
+msgstr "Aantal resultaten:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:182
+msgid "Query parameters"
+msgstr "Queryparameters"
+
+#: UI/GTK2/src/ResultsTree.cpp:116
+msgid "Score"
+msgstr "Score"
+
+#: UI/GTK2/src/ResultsTree.cpp:165
+msgid "Extract"
+msgstr "Uitpakken"
+
+#: UI/GTK2/src/WorkerThreads.cpp:318
+msgid "Can't index mail here"
+msgstr "Kan mail hier niet indexeren"
+
+#: UI/GTK2/src/WorkerThreads.cpp:339
+msgid "is already being indexed"
+msgstr "wordt al geindexeerd"
+
+#: UI/GTK2/src/WorkerThreads.cpp:349
+msgid "is blacklisted"
+msgstr "staat op blacklist"
+
+#: UI/GTK2/src/WorkerThreads.cpp:357 UI/GTK2/src/WorkerThreads.cpp:693
+#: UI/GTK2/src/WorkerThreads.cpp:968 UI/GTK2/src/WorkerThreads.cpp:977
+#: UI/GTK2/src/WorkerThreads.cpp:1146 UI/GTK2/src/WorkerThreads.cpp:1388
+#: UI/GTK2/src/WorkerThreads.cpp:1512
+msgid "Index error on"
+msgstr "Indexeringsfout op"
+
+#: UI/GTK2/src/WorkerThreads.cpp:812 UI/GTK2/src/WorkerThreads.cpp:912
+msgid "Couldn't create search engine"
+msgstr "Kon zoekmachine niet maken"
+
+#: UI/GTK2/src/WorkerThreads.cpp:824 UI/GTK2/src/WorkerThreads.cpp:926
+msgid "Couldn't run query on search engine"
+msgstr "Kon query niet uitvoeren op zoekmachine"
+
+#: UI/GTK2/src/WorkerThreads.cpp:840
+msgid "No title"
+msgstr "Geen titel"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1056
+msgid "Couldn't obtain downloader for protocol"
+msgstr "Kon geen downloader verkrijgen voor protocol"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1067
+msgid "Couldn't retrieve"
+msgstr "Kon niet opzoeken"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1170 UI/GTK2/src/WorkerThreads.cpp:1237
+msgid "Cannot index document type"
+msgstr "Kan documenttype niet indexeren"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1174 UI/GTK2/src/WorkerThreads.cpp:1241
+msgid "at"
+msgstr "bij"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1263
+#, fuzzy
+msgid "Couldn't tokenize"
+msgstr "Kon tokens niet toepassen"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1283
+msgid "Robots META tag forbids indexing"
+msgstr "Robots META taf verbiedt indexeren"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1318
+msgid "Couldn't index"
+msgstr "Kon niet indexeren"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1399
+msgid "Couldn't unindex document(s)"
+msgstr "Kan indexering van bestand(en) niet ongedaan maken"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1524
+msgid "Couldn't update document"
+msgstr "Kan document niet actualiseren"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1714
+msgid "No monitoring handler"
+msgstr "Geen monitoring handler"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1756
+msgid "Couldn't initialize file monitor"
+msgstr "Kan bestandsmonitor niet initialiseren"
+
+#: UI/GTK2/src/WorkerThreads.cpp:2060
+msgid "Couldn't open directory"
+msgstr "Kan map niet openen"



From fabricecolin at mail.berlios.de  Sun Dec  3 16:37:46 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 3 Dec 2006 16:37:46 +0100
Subject: [Pinot-svn] r613 - in trunk: UI/GTK2/src po
Message-ID: <200612031537.kB3FbkEI003007@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-03 16:37:44 +0100 (Sun, 03 Dec 2006)
New Revision: 613

Modified:
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/po/es.po
   trunk/po/fr.po
Log:
Minor corrections and new string in French and Spanish po files.


Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-03 15:31:43 UTC (rev 612)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-03 15:37:44 UTC (rev 613)
@@ -67,6 +67,7 @@
 #ifdef DEBUG
 		cout << "StopThreadFunc: stopped thread " << p.first->getId() << endl;
 #endif
+		Thread::yield();
 	}
 };
 

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-03 15:31:43 UTC (rev 612)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-03 15:37:44 UTC (rev 613)
@@ -859,9 +859,15 @@
 	}
 	else
 	{
-		// Don't close the connection to avoid ""Applications can not close shared connections.
+		// Don't close the connection to avoid "Applications can not close shared connections.
 		// Please fix this in your app. Ignoring close request and continuing."
-		dbus_connection_unref(pConnection);
+
+		// With dbus 1.0, unref() brings "The last reference on a connection was dropped without closing the connection.
+		// This is a bug in an application. See dbus_connection_unref() documentation for details.
+		// Most likely, the application called unref() too many times and removed a reference belonging to libdbus,
+		// since this is a shared connection." but of course shared connections cannot be closed !
+
+		//dbus_connection_unref(pConnection);
 	}
 	dbus_g_connection_unref(pBus);
 

Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2006-12-03 15:31:43 UTC (rev 612)
+++ trunk/po/es.po	2006-12-03 15:37:44 UTC (rev 613)
@@ -2,19 +2,20 @@
 # Copyright (C) 2006 Fabrice Colin, Jes?s Tramullas
 # This file is distributed under the same license as the pinot package.
 # Jes?s Tramullas <jesus at tramullas.com>, 2006.
-# 
+#
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.49\n"
+"Project-Id-Version: pinot 0.64\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-11-18 13:48+0800\n"
-"PO-Revision-Date: 2006-11-04 21:10+0800\n"
+"POT-Creation-Date: 2006-12-02 11:47+0800\n"
+"PO-Revision-Date: 2006-12-03 15:05+0000\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: es <fabricecolin at users.berlios.de>\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=utf-8\n"
 "Content-Transfer-Encoding: 8bit\n"
+"X-Rosetta-Export-Date: 2006-12-03 15:18+0000\n"
 
 #: UI/GTK2/src/EnginesTree.cpp:70
 msgid "Search Engines"
@@ -24,22 +25,17 @@
 msgid "Current User"
 msgstr "Usuario"
 
-#. Bind the callback's parameter to the index name
-#. Enable these menu items unless it is not the documents index
-#. Internal indices
-#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:318
-#: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:547
-#: UI/GTK2/src/mainWindow.cc:1150 UI/GTK2/src/mainWindow.cc:1192
-#: UI/GTK2/src/mainWindow.cc:1212 UI/GTK2/src/mainWindow.cc:1243
-#: UI/GTK2/src/mainWindow.cc:1832 UI/GTK2/src/PinotSettings.cpp:235
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
+#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
+#: UI/GTK2/src/mainWindow.cc:1148 UI/GTK2/src/mainWindow.cc:1191
+#: UI/GTK2/src/mainWindow.cc:1211 UI/GTK2/src/mainWindow.cc:1242
+#: UI/GTK2/src/mainWindow.cc:1831 UI/GTK2/src/PinotSettings.cpp:235
 #: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
 msgid "My Web Pages"
 msgstr "Mis Paginas Web"
 
-#. Populate the submenu
-#. Bind the callback's parameter to the index name
-#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:312
-#: UI/GTK2/src/mainWindow.cc:315 UI/GTK2/src/PinotSettings.cpp:236
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:310
+#: UI/GTK2/src/mainWindow.cc:313 UI/GTK2/src/PinotSettings.cpp:236
 #: UI/GTK2/src/PinotSettings.cpp:1225 UI/GTK2/src/PinotSettings.cpp:1281
 msgid "My Documents"
 msgstr "Mis documentos"
@@ -93,15 +89,12 @@
 msgid "External index"
 msgstr "?ndice externo"
 
-#. The score column is used for status icons
-#. This is the title column
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:109
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:112
 #: UI/GTK2/src/ResultsTree.cpp:126
 msgid "Title"
 msgstr "T?tulo"
 
-#. The last column is for the URL
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:112
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:115
 #: UI/GTK2/src/ResultsTree.cpp:136
 msgid "URL"
 msgstr "URL"
@@ -122,216 +115,210 @@
 msgid "All labels"
 msgstr "Todas las etiquetas"
 
-#: UI/GTK2/src/mainWindow.cc:140
+#: UI/GTK2/src/mainWindow.cc:138
 msgid "Query Name"
 msgstr "Nombre de la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:145
+#: UI/GTK2/src/mainWindow.cc:143
 msgid "Last Run"
 msgstr "?ltima ejecuci?n"
 
-#: UI/GTK2/src/mainWindow.cc:150
+#: UI/GTK2/src/mainWindow.cc:148
 msgid "Summary"
 msgstr "Sumario"
 
-#. Set tooltips
-#: UI/GTK2/src/mainWindow.cc:183
+#: UI/GTK2/src/mainWindow.cc:181
 msgid "Show all search engines"
 msgstr "Mostrar todos los motores de b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:184
+#: UI/GTK2/src/mainWindow.cc:182
 msgid "Add index"
 msgstr "A?adir ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:185
+#: UI/GTK2/src/mainWindow.cc:183
 msgid "Remove index"
 msgstr "Borrar ?ndice"
 
-#. Now we are ready
-#: UI/GTK2/src/mainWindow.cc:191
+#: UI/GTK2/src/mainWindow.cc:189
 msgid "Ready"
 msgstr "Listo"
 
-#: UI/GTK2/src/mainWindow.cc:236
+#: UI/GTK2/src/mainWindow.cc:234
 msgid "N/A"
 msgstr "Desconocido"
 
-#: UI/GTK2/src/mainWindow.cc:251
+#: UI/GTK2/src/mainWindow.cc:249
 msgid "<undefined>"
 msgstr "<indefinido>"
 
-#. Show the URL of the first result in the status bar
-#: UI/GTK2/src/mainWindow.cc:470
+#: UI/GTK2/src/mainWindow.cc:468
 msgid "Result location is"
 msgstr "La localizaci?n del resultado es"
 
-#. Show the URL in the status bar
-#: UI/GTK2/src/mainWindow.cc:557
+#: UI/GTK2/src/mainWindow.cc:555
 msgid "Document location is"
 msgstr "La localizaci?n del documento es"
 
-#: UI/GTK2/src/mainWindow.cc:875
+#: UI/GTK2/src/mainWindow.cc:873
 msgid "Showing"
 msgstr "Mostrando"
 
-#: UI/GTK2/src/mainWindow.cc:880
+#: UI/GTK2/src/mainWindow.cc:878
 msgid "of"
 msgstr "documentos"
 
-#: UI/GTK2/src/mainWindow.cc:885
+#: UI/GTK2/src/mainWindow.cc:883
 msgid "documents, starting at"
 msgstr "documentos comenzando en"
 
-#: UI/GTK2/src/mainWindow.cc:918
+#: UI/GTK2/src/mainWindow.cc:916
 msgid "Query"
 msgstr "B?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:922 UI/GTK2/src/mainWindow.cc:2889
+#: UI/GTK2/src/mainWindow.cc:920 UI/GTK2/src/mainWindow.cc:2890
 msgid "on"
 msgstr "en"
 
-#: UI/GTK2/src/mainWindow.cc:926
+#: UI/GTK2/src/mainWindow.cc:924
 msgid "ended"
 msgstr "finalizado"
 
-#: UI/GTK2/src/mainWindow.cc:1015
+#: UI/GTK2/src/mainWindow.cc:1013
 msgid "More Like"
 msgstr "M?s como"
 
-#: UI/GTK2/src/mainWindow.cc:1076
+#: UI/GTK2/src/mainWindow.cc:1074
 msgid "Updated label(s)"
 msgstr "Etiqueta(s) actualizada(s)"
 
-#. Yes, it did
-#: UI/GTK2/src/mainWindow.cc:1160
+#: UI/GTK2/src/mainWindow.cc:1158
 msgid "Updated document"
 msgstr "Documento actualizado"
 
-#: UI/GTK2/src/mainWindow.cc:1173
+#: UI/GTK2/src/mainWindow.cc:1171
 msgid "Indexed"
 msgstr "Indizado"
 
-#: UI/GTK2/src/mainWindow.cc:1213
+#: UI/GTK2/src/mainWindow.cc:1212
 msgid "Unindexed document(s)"
 msgstr "Documento(s) no indizado(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1254
+#: UI/GTK2/src/mainWindow.cc:1253
 msgid "Updated document properties"
 msgstr "Propiedades del documento actualizadas"
 
-#: UI/GTK2/src/mainWindow.cc:1301
+#: UI/GTK2/src/mainWindow.cc:1300
 msgid "Couldn't rename index, name"
 msgstr "No se pudo renombrar ?ndice, nombre"
 
-#: UI/GTK2/src/mainWindow.cc:1305 UI/GTK2/src/mainWindow.cc:2213
-#: UI/GTK2/src/mainWindow.cc:2724
+#: UI/GTK2/src/mainWindow.cc:1304 UI/GTK2/src/mainWindow.cc:2214
+#: UI/GTK2/src/mainWindow.cc:2725
 msgid "is already in use"
 msgstr "ya est? en uso"
 
-#: UI/GTK2/src/mainWindow.cc:1318
+#: UI/GTK2/src/mainWindow.cc:1317
 msgid "Couldn't rename index"
 msgstr "No se pudo renombrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1331
+#: UI/GTK2/src/mainWindow.cc:1330
 msgid "Edited index"
 msgstr "?ndice editado"
 
-#. Find this query
-#: UI/GTK2/src/mainWindow.cc:1710 UI/GTK2/src/mainWindow.cc:2383
+#: UI/GTK2/src/mainWindow.cc:1709 UI/GTK2/src/mainWindow.cc:2384
 msgid "Live query"
 msgstr "B?squeda activa"
 
-#: UI/GTK2/src/mainWindow.cc:1736
+#: UI/GTK2/src/mainWindow.cc:1735
 msgid "Couldn't find query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:1780 UI/GTK2/src/mainWindow.cc:1876
+#: UI/GTK2/src/mainWindow.cc:1779 UI/GTK2/src/mainWindow.cc:1875
 msgid "Please set a location for the index first"
 msgstr "Por favor, primero fije una localizaci?n para el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1953 UI/GTK2/src/WorkerThreads.cpp:639
-#: UI/GTK2/src/WorkerThreads.cpp:1414
+#: UI/GTK2/src/mainWindow.cc:1954 UI/GTK2/src/WorkerThreads.cpp:684
+#: UI/GTK2/src/WorkerThreads.cpp:1526
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1957 UI/GTK2/src/WorkerThreads.cpp:643
-#: UI/GTK2/src/WorkerThreads.cpp:1418
+#: UI/GTK2/src/mainWindow.cc:1958 UI/GTK2/src/WorkerThreads.cpp:688
+#: UI/GTK2/src/WorkerThreads.cpp:1530
 msgid "doesn't exist"
 msgstr "no existe"
 
-#: UI/GTK2/src/mainWindow.cc:2101
+#: UI/GTK2/src/mainWindow.cc:2102
 msgid "Remove this document from the index ?"
 msgstr "?Borrar este documento del ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2120
+#: UI/GTK2/src/mainWindow.cc:2121
 msgid "Remove these documents from the index ?"
 msgstr "?Borrar este documento del ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2164
+#: UI/GTK2/src/mainWindow.cc:2165
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Una herramienta metabuscador para el escritorio libre"
 
-#: UI/GTK2/src/mainWindow.cc:2165
+#: UI/GTK2/src/mainWindow.cc:2166
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2209
+#: UI/GTK2/src/mainWindow.cc:2210
 msgid "Index name"
 msgstr "Nombre del ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2224
+#: UI/GTK2/src/mainWindow.cc:2225
 msgid "Couldn't add index"
 msgstr "No se pudo a?adir el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2238
+#: UI/GTK2/src/mainWindow.cc:2239
 msgid "Added new index"
 msgstr "A?adido un nuevo ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2273
+#: UI/GTK2/src/mainWindow.cc:2274
 msgid "Couldn't remove index"
 msgstr "No se pudo borrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2538
+#: UI/GTK2/src/mainWindow.cc:2539
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Al menos una tarea no ha finalizado. ?Parar ahora?"
 
-#: UI/GTK2/src/mainWindow.cc:2720
+#: UI/GTK2/src/mainWindow.cc:2721
 msgid "Query name"
 msgstr "Nombre la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2747
+#: UI/GTK2/src/mainWindow.cc:2748
 msgid "Couldn't update query"
 msgstr "No se pudo actualizar la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:2756
 msgid "Edited query"
 msgstr "B?squeda editada"
 
-#: UI/GTK2/src/mainWindow.cc:2762
+#: UI/GTK2/src/mainWindow.cc:2763
 msgid "Couldn't add query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2770
+#: UI/GTK2/src/mainWindow.cc:2771
 msgid "Added new query"
 msgstr "A?adida una nueva b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2783
+#: UI/GTK2/src/mainWindow.cc:2784
 msgid "Query is not set"
 msgstr "B?squeda no definida"
 
-#: UI/GTK2/src/mainWindow.cc:2794
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "No search engine selected"
 msgstr "Motor de b?squeda no seleccionado"
 
-#: UI/GTK2/src/mainWindow.cc:2876
+#: UI/GTK2/src/mainWindow.cc:2877
 msgid "Please set the Google API key first"
 msgstr "Por favor, primero configure el API de Google"
 
-#: UI/GTK2/src/mainWindow.cc:2885
+#: UI/GTK2/src/mainWindow.cc:2886
 msgid "Running query"
 msgstr "Ejecutando la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:3059
+#: UI/GTK2/src/mainWindow.cc:3060
 msgid "No default application defined for type"
 msgstr "No hay aplicaci?n predefinida para el tipo"
 
@@ -428,68 +415,66 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#. Localize language names
-#: UI/GTK2/src/pinot.cc:167 UI/GTK2/src/pinot-dbus-daemon.cc:680
+#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:699
 msgid "Unknown"
 msgstr "Desconocido"
 
-#: UI/GTK2/src/pinot.cc:168 UI/GTK2/src/pinot-dbus-daemon.cc:681
+#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:700
 msgid "Danish"
 msgstr "Dan?s"
 
-#: UI/GTK2/src/pinot.cc:169 UI/GTK2/src/pinot-dbus-daemon.cc:682
+#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:701
 msgid "Dutch"
 msgstr "Holand?s"
 
-#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:683
+#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
 msgid "English"
 msgstr "Ingl?s"
 
-#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:684
+#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
 msgid "Finnish"
 msgstr "Finland?s"
 
-#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:685
+#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
 msgid "French"
 msgstr "Franc?s"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:686
+#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
 msgid "German"
 msgstr "Alem?n"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:687
+#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
 msgid "Italian"
 msgstr "Italiano"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:688
+#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
 msgid "Norwegian"
 msgstr "Noruego"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:689
+#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:690
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
 msgid "Russian"
 msgstr "Ruso"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:691
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
 msgid "Spanish"
 msgstr "Espa?ol"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:692
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
 msgid "Swedish"
 msgstr "Sueco"
 
-#: UI/GTK2/src/pinot.cc:203
+#: UI/GTK2/src/pinot.cc:206
 msgid "Couldn't open index"
 msgstr "No se pudo abrir el ?ndice"
 
-#: UI/GTK2/src/pinot.cc:218
+#: UI/GTK2/src/pinot.cc:222
 msgid "Couldn't create history database"
 msgstr "No se pudo crear la base de datos del hist?rico"
 
-#. Add default labels
 #: UI/GTK2/src/PinotSettings.cpp:241
 msgid "Important"
 msgstr "Importante"
@@ -599,7 +584,7 @@
 msgid "Preferences"
 msgstr "Preferencias"
 
-#: UI/GTK2/src/propertiesDialog.cc:51 UI/GTK2/src/queryDialog.cc:124
+#: UI/GTK2/src/propertiesDialog.cc:51 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "Etiqueta"
 
@@ -621,17 +606,21 @@
 
 #: UI/GTK2/src/queryDialog.cc:106
 msgid "File name"
-msgstr "Nombre de fichero"
+msgstr "Nombre de archivo"
 
-#: UI/GTK2/src/queryDialog.cc:115
+#: UI/GTK2/src/queryDialog.cc:109
+msgid "File extension"
+msgstr "Extensi?n del archivo"
+
+#: UI/GTK2/src/queryDialog.cc:118
 msgid "Directory"
 msgstr "Carpeta"
 
-#: UI/GTK2/src/queryDialog.cc:118
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "Language code"
 msgstr "Codigo de idioma"
 
-#: UI/GTK2/src/queryDialog.cc:121
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "MIME type"
 msgstr "Tipo MIME"
 
@@ -655,7 +644,6 @@
 msgid "Query parameters"
 msgstr "Par?metros de b?squeda"
 
-#. This is the score column
 #: UI/GTK2/src/ResultsTree.cpp:116
 msgid "Score"
 msgstr "Cuenta"
@@ -664,82 +652,81 @@
 msgid "Extract"
 msgstr "Extra?dos"
 
-#: UI/GTK2/src/WorkerThreads.cpp:302
+#: UI/GTK2/src/WorkerThreads.cpp:322
 msgid "Can't index mail here"
 msgstr "No se pudo indizar el buzon de correo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:323
+#: UI/GTK2/src/WorkerThreads.cpp:343
 msgid "is already being indexed"
 msgstr "ya est? indizado"
 
-#: UI/GTK2/src/WorkerThreads.cpp:333
+#: UI/GTK2/src/WorkerThreads.cpp:353
 msgid "is blacklisted"
 msgstr "ya excluido"
 
-#: UI/GTK2/src/WorkerThreads.cpp:341 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:927 UI/GTK2/src/WorkerThreads.cpp:936
-#: UI/GTK2/src/WorkerThreads.cpp:1102 UI/GTK2/src/WorkerThreads.cpp:1303
-#: UI/GTK2/src/WorkerThreads.cpp:1427
+#: UI/GTK2/src/WorkerThreads.cpp:361 UI/GTK2/src/WorkerThreads.cpp:697
+#: UI/GTK2/src/WorkerThreads.cpp:972 UI/GTK2/src/WorkerThreads.cpp:981
+#: UI/GTK2/src/WorkerThreads.cpp:1150 UI/GTK2/src/WorkerThreads.cpp:1406
+#: UI/GTK2/src/WorkerThreads.cpp:1539
 msgid "Index error on"
 msgstr "Error en el ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:771 UI/GTK2/src/WorkerThreads.cpp:871
+#: UI/GTK2/src/WorkerThreads.cpp:816 UI/GTK2/src/WorkerThreads.cpp:916
 msgid "Couldn't create search engine"
 msgstr "No se pudo crear el motor de b?squeda"
 
-#: UI/GTK2/src/WorkerThreads.cpp:783 UI/GTK2/src/WorkerThreads.cpp:885
+#: UI/GTK2/src/WorkerThreads.cpp:828 UI/GTK2/src/WorkerThreads.cpp:930
 msgid "Couldn't run query on search engine"
 msgstr "No se pudo ejecutar la b?squeda contra el motor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:799
+#: UI/GTK2/src/WorkerThreads.cpp:844
 msgid "No title"
 msgstr "Sin t?tulo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1015
+#: UI/GTK2/src/WorkerThreads.cpp:1060
 msgid "Couldn't obtain downloader for protocol"
 msgstr "No se pudo usar un recuperador para el protocolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1026
+#: UI/GTK2/src/WorkerThreads.cpp:1071
 msgid "Couldn't retrieve"
 msgstr "No se pudo descargar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1152
+#: UI/GTK2/src/WorkerThreads.cpp:1174 UI/GTK2/src/WorkerThreads.cpp:1241
 msgid "Cannot index document type"
 msgstr "No se pudo indizar el tipo de documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1156
+#: UI/GTK2/src/WorkerThreads.cpp:1178 UI/GTK2/src/WorkerThreads.cpp:1245
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1178
+#: UI/GTK2/src/WorkerThreads.cpp:1267
 msgid "Couldn't tokenize"
 msgstr "No se pudo extraer cadenas"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1198
+#: UI/GTK2/src/WorkerThreads.cpp:1287
 msgid "Robots META tag forbids indexing"
 msgstr "La etiqueta META Robots proh?be la indizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1233
+#: UI/GTK2/src/WorkerThreads.cpp:1336
 msgid "Couldn't index"
 msgstr "No se pudo indizar"
 
-#. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1314
+#: UI/GTK2/src/WorkerThreads.cpp:1417
 msgid "Couldn't unindex document(s)"
 msgstr "No se pudo des-indizar lo(s) documento(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1439
+#: UI/GTK2/src/WorkerThreads.cpp:1551
 msgid "Couldn't update document"
 msgstr "No se pudo actualizar el documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1615
+#: UI/GTK2/src/WorkerThreads.cpp:1741
 msgid "No monitoring handler"
 msgstr "No hay monitorizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1657
+#: UI/GTK2/src/WorkerThreads.cpp:1783
 msgid "Couldn't initialize file monitor"
 msgstr "No se puede inicializar el monitor de archivo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1939
+#: UI/GTK2/src/WorkerThreads.cpp:2087
 msgid "Couldn't open directory"
 msgstr "No se pudo abrir el directorio"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2006-12-03 15:31:43 UTC (rev 612)
+++ trunk/po/fr.po	2006-12-03 15:37:44 UTC (rev 613)
@@ -6,15 +6,16 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.49\n"
+"Project-Id-Version: pinot 0.64\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-11-18 13:48+0800\n"
-"PO-Revision-Date: 2006-11-04 21:10+0800\n"
+"POT-Creation-Date: 2006-12-02 11:47+0800\n"
+"PO-Revision-Date: 2006-11-29 15:09+0000\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: fr <fabricecolin at users.berlios.de>\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=utf-8\n"
 "Content-Transfer-Encoding: 8bit\n"
+"X-Rosetta-Export-Date: 2006-12-03 15:18+0000\n"
 
 #: UI/GTK2/src/EnginesTree.cpp:70
 msgid "Search Engines"
@@ -24,22 +25,17 @@
 msgid "Current User"
 msgstr "Utilisateur"
 
-#. Bind the callback's parameter to the index name
-#. Enable these menu items unless it is not the documents index
-#. Internal indices
-#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:318
-#: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:547
-#: UI/GTK2/src/mainWindow.cc:1150 UI/GTK2/src/mainWindow.cc:1192
-#: UI/GTK2/src/mainWindow.cc:1212 UI/GTK2/src/mainWindow.cc:1243
-#: UI/GTK2/src/mainWindow.cc:1832 UI/GTK2/src/PinotSettings.cpp:235
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
+#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
+#: UI/GTK2/src/mainWindow.cc:1148 UI/GTK2/src/mainWindow.cc:1191
+#: UI/GTK2/src/mainWindow.cc:1211 UI/GTK2/src/mainWindow.cc:1242
+#: UI/GTK2/src/mainWindow.cc:1831 UI/GTK2/src/PinotSettings.cpp:235
 #: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
 msgid "My Web Pages"
 msgstr "Mes Pages Web"
 
-#. Populate the submenu
-#. Bind the callback's parameter to the index name
-#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:312
-#: UI/GTK2/src/mainWindow.cc:315 UI/GTK2/src/PinotSettings.cpp:236
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:310
+#: UI/GTK2/src/mainWindow.cc:313 UI/GTK2/src/PinotSettings.cpp:236
 #: UI/GTK2/src/PinotSettings.cpp:1225 UI/GTK2/src/PinotSettings.cpp:1281
 msgid "My Documents"
 msgstr "Mes Documents"
@@ -93,15 +89,12 @@
 msgid "External index"
 msgstr "Index externe"
 
-#. The score column is used for status icons
-#. This is the title column
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:109
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:112
 #: UI/GTK2/src/ResultsTree.cpp:126
 msgid "Title"
 msgstr "Titre"
 
-#. The last column is for the URL
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:112
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:115
 #: UI/GTK2/src/ResultsTree.cpp:136
 msgid "URL"
 msgstr "URL"
@@ -122,216 +115,210 @@
 msgid "All labels"
 msgstr "Toutes les etiquettes"
 
-#: UI/GTK2/src/mainWindow.cc:140
+#: UI/GTK2/src/mainWindow.cc:138
 msgid "Query Name"
 msgstr "Nom de la Recherche"
 
-#: UI/GTK2/src/mainWindow.cc:145
+#: UI/GTK2/src/mainWindow.cc:143
 msgid "Last Run"
 msgstr "Derniere Utilisation"
 
-#: UI/GTK2/src/mainWindow.cc:150
+#: UI/GTK2/src/mainWindow.cc:148
 msgid "Summary"
 msgstr "Sommaire"
 
-#. Set tooltips
-#: UI/GTK2/src/mainWindow.cc:183
+#: UI/GTK2/src/mainWindow.cc:181
 msgid "Show all search engines"
 msgstr "Montrer tous les moteurs"
 
-#: UI/GTK2/src/mainWindow.cc:184
+#: UI/GTK2/src/mainWindow.cc:182
 msgid "Add index"
 msgstr "Ajouter un index"
 
-#: UI/GTK2/src/mainWindow.cc:185
+#: UI/GTK2/src/mainWindow.cc:183
 msgid "Remove index"
 msgstr "Enlever un index"
 
-#. Now we are ready
-#: UI/GTK2/src/mainWindow.cc:191
+#: UI/GTK2/src/mainWindow.cc:189
 msgid "Ready"
 msgstr "Pret"
 
-#: UI/GTK2/src/mainWindow.cc:236
+#: UI/GTK2/src/mainWindow.cc:234
 msgid "N/A"
 msgstr "Inconnue"
 
-#: UI/GTK2/src/mainWindow.cc:251
+#: UI/GTK2/src/mainWindow.cc:249
 msgid "<undefined>"
 msgstr "<inconnu>"
 
-#. Show the URL of the first result in the status bar
-#: UI/GTK2/src/mainWindow.cc:470
+#: UI/GTK2/src/mainWindow.cc:468
 msgid "Result location is"
 msgstr "Le chemin du resultat est"
 
-#. Show the URL in the status bar
-#: UI/GTK2/src/mainWindow.cc:557
+#: UI/GTK2/src/mainWindow.cc:555
 msgid "Document location is"
 msgstr "Le chemin du document is"
 
-#: UI/GTK2/src/mainWindow.cc:875
+#: UI/GTK2/src/mainWindow.cc:873
 msgid "Showing"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:880
+#: UI/GTK2/src/mainWindow.cc:878
 msgid "of"
 msgstr "documents,"
 
-#: UI/GTK2/src/mainWindow.cc:885
+#: UI/GTK2/src/mainWindow.cc:883
 msgid "documents, starting at"
 msgstr "au total, a partir de"
 
-#: UI/GTK2/src/mainWindow.cc:918
+#: UI/GTK2/src/mainWindow.cc:916
 msgid "Query"
 msgstr "La recherche"
 
-#: UI/GTK2/src/mainWindow.cc:922 UI/GTK2/src/mainWindow.cc:2889
+#: UI/GTK2/src/mainWindow.cc:920 UI/GTK2/src/mainWindow.cc:2890
 msgid "on"
 msgstr "sur"
 
-#: UI/GTK2/src/mainWindow.cc:926
+#: UI/GTK2/src/mainWindow.cc:924
 msgid "ended"
 msgstr "est terminee"
 
-#: UI/GTK2/src/mainWindow.cc:1015
+#: UI/GTK2/src/mainWindow.cc:1013
 msgid "More Like"
 msgstr "Similaire a"
 
-#: UI/GTK2/src/mainWindow.cc:1076
+#: UI/GTK2/src/mainWindow.cc:1074
 msgid "Updated label(s)"
 msgstr "Mis a jour l(es) etiquette(s)"
 
-#. Yes, it did
-#: UI/GTK2/src/mainWindow.cc:1160
+#: UI/GTK2/src/mainWindow.cc:1158
 msgid "Updated document"
 msgstr "Mis a jour le document"
 
-#: UI/GTK2/src/mainWindow.cc:1173
+#: UI/GTK2/src/mainWindow.cc:1171
 msgid "Indexed"
 msgstr "Indexe"
 
-#: UI/GTK2/src/mainWindow.cc:1213
+#: UI/GTK2/src/mainWindow.cc:1212
 msgid "Unindexed document(s)"
 msgstr "Desindexe le(s) document(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1254
+#: UI/GTK2/src/mainWindow.cc:1253
 msgid "Updated document properties"
 msgstr "Mis a jour les proprietes du document"
 
-#: UI/GTK2/src/mainWindow.cc:1301
+#: UI/GTK2/src/mainWindow.cc:1300
 msgid "Couldn't rename index, name"
 msgstr "N'a pas pu renommer l'index, le nom"
 
-#: UI/GTK2/src/mainWindow.cc:1305 UI/GTK2/src/mainWindow.cc:2213
-#: UI/GTK2/src/mainWindow.cc:2724
+#: UI/GTK2/src/mainWindow.cc:1304 UI/GTK2/src/mainWindow.cc:2214
+#: UI/GTK2/src/mainWindow.cc:2725
 msgid "is already in use"
 msgstr "est deja utilise"
 
-#: UI/GTK2/src/mainWindow.cc:1318
+#: UI/GTK2/src/mainWindow.cc:1317
 msgid "Couldn't rename index"
 msgstr "N'a pas pu renommer l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1331
+#: UI/GTK2/src/mainWindow.cc:1330
 msgid "Edited index"
 msgstr "Edite l'index"
 
-#. Find this query
-#: UI/GTK2/src/mainWindow.cc:1710 UI/GTK2/src/mainWindow.cc:2383
+#: UI/GTK2/src/mainWindow.cc:1709 UI/GTK2/src/mainWindow.cc:2384
 msgid "Live query"
 msgstr "Recherche"
 
-#: UI/GTK2/src/mainWindow.cc:1736
+#: UI/GTK2/src/mainWindow.cc:1735
 msgid "Couldn't find query"
 msgstr "N'a pas pu trouver"
 
-#: UI/GTK2/src/mainWindow.cc:1780 UI/GTK2/src/mainWindow.cc:1876
+#: UI/GTK2/src/mainWindow.cc:1779 UI/GTK2/src/mainWindow.cc:1875
 msgid "Please set a location for the index first"
 msgstr "Donnez un chemin a l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1953 UI/GTK2/src/WorkerThreads.cpp:639
-#: UI/GTK2/src/WorkerThreads.cpp:1414
+#: UI/GTK2/src/mainWindow.cc:1954 UI/GTK2/src/WorkerThreads.cpp:684
+#: UI/GTK2/src/WorkerThreads.cpp:1526
 msgid "Index"
 msgstr "L'index"
 
-#: UI/GTK2/src/mainWindow.cc:1957 UI/GTK2/src/WorkerThreads.cpp:643
-#: UI/GTK2/src/WorkerThreads.cpp:1418
+#: UI/GTK2/src/mainWindow.cc:1958 UI/GTK2/src/WorkerThreads.cpp:688
+#: UI/GTK2/src/WorkerThreads.cpp:1530
 msgid "doesn't exist"
 msgstr "n'existe pas"
 
-#: UI/GTK2/src/mainWindow.cc:2101
+#: UI/GTK2/src/mainWindow.cc:2102
 msgid "Remove this document from the index ?"
 msgstr "Enlever ce document de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2120
+#: UI/GTK2/src/mainWindow.cc:2121
 msgid "Remove these documents from the index ?"
 msgstr "Enlever ces documents de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2164
+#: UI/GTK2/src/mainWindow.cc:2165
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Un outil de recherche pour le Bureau Libre"
 
-#: UI/GTK2/src/mainWindow.cc:2165
+#: UI/GTK2/src/mainWindow.cc:2166
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2209
+#: UI/GTK2/src/mainWindow.cc:2210
 msgid "Index name"
 msgstr "Nom de l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2224
+#: UI/GTK2/src/mainWindow.cc:2225
 msgid "Couldn't add index"
 msgstr "N'a pas pu ajouter l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2238
+#: UI/GTK2/src/mainWindow.cc:2239
 msgid "Added new index"
 msgstr "Ajoute un nouvel index"
 
-#: UI/GTK2/src/mainWindow.cc:2273
+#: UI/GTK2/src/mainWindow.cc:2274
 msgid "Couldn't remove index"
 msgstr "N'a pas pu enlever l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2538
+#: UI/GTK2/src/mainWindow.cc:2539
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Au moins une tache n'est pas terminee. Quitter maintenant ?"
 
-#: UI/GTK2/src/mainWindow.cc:2720
+#: UI/GTK2/src/mainWindow.cc:2721
 msgid "Query name"
 msgstr "Nom de la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2747
+#: UI/GTK2/src/mainWindow.cc:2748
 msgid "Couldn't update query"
 msgstr "N'a pas pu mettre a jour la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:2756
 msgid "Edited query"
 msgstr "Edite la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2762
+#: UI/GTK2/src/mainWindow.cc:2763
 msgid "Couldn't add query"
 msgstr "N'a pas pu ajouter la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2770
+#: UI/GTK2/src/mainWindow.cc:2771
 msgid "Added new query"
 msgstr "Ajoute une nouvelle recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2783
+#: UI/GTK2/src/mainWindow.cc:2784
 msgid "Query is not set"
 msgstr "Recherche indefinie"
 
-#: UI/GTK2/src/mainWindow.cc:2794
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "No search engine selected"
 msgstr "Pas de moteur selectionne"
 
-#: UI/GTK2/src/mainWindow.cc:2876
+#: UI/GTK2/src/mainWindow.cc:2877
 msgid "Please set the Google API key first"
 msgstr "Configurez la clef de l'API Google"
 
-#: UI/GTK2/src/mainWindow.cc:2885
+#: UI/GTK2/src/mainWindow.cc:2886
 msgid "Running query"
 msgstr "Recherche en cours"
 
-#: UI/GTK2/src/mainWindow.cc:3059
+#: UI/GTK2/src/mainWindow.cc:3060
 msgid "No default application defined for type"
 msgstr "Pas d'application definie pour le type"
 
@@ -428,68 +415,66 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#. Localize language names
-#: UI/GTK2/src/pinot.cc:167 UI/GTK2/src/pinot-dbus-daemon.cc:680
+#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:699
 msgid "Unknown"
 msgstr "Inconnu"
 
-#: UI/GTK2/src/pinot.cc:168 UI/GTK2/src/pinot-dbus-daemon.cc:681
+#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:700
 msgid "Danish"
 msgstr "Danois"
 
-#: UI/GTK2/src/pinot.cc:169 UI/GTK2/src/pinot-dbus-daemon.cc:682
+#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:701
 msgid "Dutch"
 msgstr "Hollandais"
 
-#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:683
+#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
 msgid "English"
 msgstr "Anglais"
 
-#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:684
+#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
 msgid "Finnish"
 msgstr "Finlandais"
 
-#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:685
+#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
 msgid "French"
 msgstr "Francais"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:686
+#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
 msgid "German"
 msgstr "Allemand"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:687
+#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
 msgid "Italian"
 msgstr "Italien"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:688
+#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
 msgid "Norwegian"
 msgstr "Norvegien"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:689
+#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
 msgid "Portuguese"
 msgstr "Portugais"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:690
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
 msgid "Russian"
 msgstr "Russe"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:691
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
 msgid "Spanish"
 msgstr "Espagnol"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:692
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
 msgid "Swedish"
 msgstr "Suedois"
 
-#: UI/GTK2/src/pinot.cc:203
+#: UI/GTK2/src/pinot.cc:206
 msgid "Couldn't open index"
 msgstr "N'a pas pu ouvrir l'index"
 
-#: UI/GTK2/src/pinot.cc:218
+#: UI/GTK2/src/pinot.cc:222
 msgid "Couldn't create history database"
 msgstr "N'a pas pu creer la base d'historiques"
 
-#. Add default labels
 #: UI/GTK2/src/PinotSettings.cpp:241
 msgid "Important"
 msgstr "Important"
@@ -599,7 +584,7 @@
 msgid "Preferences"
 msgstr "Preferences"
 
-#: UI/GTK2/src/propertiesDialog.cc:51 UI/GTK2/src/queryDialog.cc:124
+#: UI/GTK2/src/propertiesDialog.cc:51 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "L'etiquette"
 
@@ -621,17 +606,21 @@
 
 #: UI/GTK2/src/queryDialog.cc:106
 msgid "File name"
-msgstr "Nom de ficher"
+msgstr "Nom de fichier"
 
-#: UI/GTK2/src/queryDialog.cc:115
+#: UI/GTK2/src/queryDialog.cc:109
+msgid "File extension"
+msgstr "Extension de fichier"
+
+#: UI/GTK2/src/queryDialog.cc:118
 msgid "Directory"
 msgstr "Repertoire"
 
-#: UI/GTK2/src/queryDialog.cc:118
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "Language code"
 msgstr "Code langue"
 
-#: UI/GTK2/src/queryDialog.cc:121
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "MIME type"
 msgstr "Type MIME"
 
@@ -655,7 +644,6 @@
 msgid "Query parameters"
 msgstr "Parametres de la recherche"
 
-#. This is the score column
 #: UI/GTK2/src/ResultsTree.cpp:116
 msgid "Score"
 msgstr "Score"
@@ -664,82 +652,81 @@
 msgid "Extract"
 msgstr "Extrait"
 
-#: UI/GTK2/src/WorkerThreads.cpp:302
+#: UI/GTK2/src/WorkerThreads.cpp:322
 msgid "Can't index mail here"
 msgstr "Ne peut pas indexer le courrier ici"
 
-#: UI/GTK2/src/WorkerThreads.cpp:323
+#: UI/GTK2/src/WorkerThreads.cpp:343
 msgid "is already being indexed"
 msgstr "est deja indexe"
 
-#: UI/GTK2/src/WorkerThreads.cpp:333
+#: UI/GTK2/src/WorkerThreads.cpp:353
 msgid "is blacklisted"
 msgstr "est exclus"
 
-#: UI/GTK2/src/WorkerThreads.cpp:341 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:927 UI/GTK2/src/WorkerThreads.cpp:936
-#: UI/GTK2/src/WorkerThreads.cpp:1102 UI/GTK2/src/WorkerThreads.cpp:1303
-#: UI/GTK2/src/WorkerThreads.cpp:1427
+#: UI/GTK2/src/WorkerThreads.cpp:361 UI/GTK2/src/WorkerThreads.cpp:697
+#: UI/GTK2/src/WorkerThreads.cpp:972 UI/GTK2/src/WorkerThreads.cpp:981
+#: UI/GTK2/src/WorkerThreads.cpp:1150 UI/GTK2/src/WorkerThreads.cpp:1406
+#: UI/GTK2/src/WorkerThreads.cpp:1539
 msgid "Index error on"
 msgstr "Erreur sur l'index"
 
-#: UI/GTK2/src/WorkerThreads.cpp:771 UI/GTK2/src/WorkerThreads.cpp:871
+#: UI/GTK2/src/WorkerThreads.cpp:816 UI/GTK2/src/WorkerThreads.cpp:916
 msgid "Couldn't create search engine"
 msgstr "N'a pas pu creer le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:783 UI/GTK2/src/WorkerThreads.cpp:885
+#: UI/GTK2/src/WorkerThreads.cpp:828 UI/GTK2/src/WorkerThreads.cpp:930
 msgid "Couldn't run query on search engine"
 msgstr "N'a pas pu lancer la recherche sur le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:799
+#: UI/GTK2/src/WorkerThreads.cpp:844
 msgid "No title"
 msgstr "Pas de titre"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1015
+#: UI/GTK2/src/WorkerThreads.cpp:1060
 msgid "Couldn't obtain downloader for protocol"
 msgstr "N'a pas pu obtenir un brouteur pour"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1026
+#: UI/GTK2/src/WorkerThreads.cpp:1071
 msgid "Couldn't retrieve"
 msgstr "N'a pas pu telecharger"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1152
+#: UI/GTK2/src/WorkerThreads.cpp:1174 UI/GTK2/src/WorkerThreads.cpp:1241
 msgid "Cannot index document type"
 msgstr "Impossible d'indexer ce type de documents"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1156
+#: UI/GTK2/src/WorkerThreads.cpp:1178 UI/GTK2/src/WorkerThreads.cpp:1245
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1178
+#: UI/GTK2/src/WorkerThreads.cpp:1267
 msgid "Couldn't tokenize"
 msgstr "N'a pas pu extraire les termes de"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1198
+#: UI/GTK2/src/WorkerThreads.cpp:1287
 msgid "Robots META tag forbids indexing"
 msgstr "Le META tag Robots interdit d'indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1233
+#: UI/GTK2/src/WorkerThreads.cpp:1336
 msgid "Couldn't index"
 msgstr "N'a pas pu indexer"
 
-#. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1314
+#: UI/GTK2/src/WorkerThreads.cpp:1417
 msgid "Couldn't unindex document(s)"
 msgstr "N'a pas pu desindexer le(s) document(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1439
+#: UI/GTK2/src/WorkerThreads.cpp:1551
 msgid "Couldn't update document"
 msgstr "N'a pas pu mettre a jour le document"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1615
+#: UI/GTK2/src/WorkerThreads.cpp:1741
 msgid "No monitoring handler"
 msgstr "Pas de moniteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1657
+#: UI/GTK2/src/WorkerThreads.cpp:1783
 msgid "Couldn't initialize file monitor"
 msgstr "N'a pas pu initializer le moniteur de fichiers"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1939
+#: UI/GTK2/src/WorkerThreads.cpp:2087
 msgid "Couldn't open directory"
 msgstr "N'a pas pu ouvrir le repertoire"



From fabricecolin at mail.berlios.de  Mon Dec  4 01:00:57 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 4 Dec 2006 01:00:57 +0100
Subject: [Pinot-svn] r614 - trunk/po
Message-ID: <200612040000.kB400vFA013981@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-04 01:00:56 +0100 (Mon, 04 Dec 2006)
New Revision: 614

Added:
   trunk/po/sv.po
Log:
Swedish translation by Daniel Nylander.


Added: trunk/po/sv.po
===================================================================
--- trunk/po/sv.po	2006-12-03 15:37:44 UTC (rev 613)
+++ trunk/po/sv.po	2006-12-04 00:00:56 UTC (rev 614)
@@ -0,0 +1,735 @@
+# Swedish translation for pinot
+# Copyright (c) 2006 Rosetta Contributors and Canonical Ltd 2006
+# This file is distributed under the same license as the pinot package.
+# FIRST AUTHOR <EMAIL at ADDRESS>, 2006.
+#
+#, fuzzy
+msgid ""
+msgstr ""
+"Project-Id-Version: pinot\n"
+"Report-Msgid-Bugs-To: FULL NAME <EMAIL at ADDRESS>\n"
+"POT-Creation-Date: 2006-11-29 21:01+0800\n"
+"PO-Revision-Date: 2006-12-03 16:44+0000\n"
+"Last-Translator: Daniel Nylander <po at danielnylander.se>\n"
+"Language-Team: Swedish <sv at li.org>\n"
+"MIME-Version: 1.0\n"
+"Content-Type: text/plain; charset=UTF-8\n"
+"Content-Transfer-Encoding: 8bit\n"
+"X-Rosetta-Export-Date: 2006-12-03 23:58+0000\n"
+
+#: UI/GTK2/src/EnginesTree.cpp:70
+msgid "Search Engines"
+msgstr "S?kmotorer"
+
+#: UI/GTK2/src/EnginesTree.cpp:328
+msgid "Current User"
+msgstr "Aktuell anv?ndare"
+
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
+#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
+#: UI/GTK2/src/mainWindow.cc:1148 UI/GTK2/src/mainWindow.cc:1191
+#: UI/GTK2/src/mainWindow.cc:1211 UI/GTK2/src/mainWindow.cc:1242
+#: UI/GTK2/src/mainWindow.cc:1831 UI/GTK2/src/PinotSettings.cpp:235
+#: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
+msgid "My Web Pages"
+msgstr "Mina webbsidor"
+
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:310
+#: UI/GTK2/src/mainWindow.cc:313 UI/GTK2/src/PinotSettings.cpp:236
+#: UI/GTK2/src/PinotSettings.cpp:1225 UI/GTK2/src/PinotSettings.cpp:1281
+msgid "My Documents"
+msgstr "Mina dokument"
+
+#: UI/GTK2/src/importDialog.cc:83 UI/GTK2/src/queryDialog.cc:81
+msgid "None"
+msgstr "Ingen"
+
+#: UI/GTK2/src/importDialog_glade.cc:67 UI/GTK2/src/indexDialog_glade.cc:68
+msgid "Location:"
+msgstr "Plats:"
+
+#: UI/GTK2/src/importDialog_glade.cc:68
+#: UI/GTK2/src/propertiesDialog_glade.cc:65
+msgid "Title:"
+msgstr "Titel:"
+
+#: UI/GTK2/src/importDialog_glade.cc:71
+msgid "Apply label:"
+msgstr "L?gg p? etikett:"
+
+#: UI/GTK2/src/importDialog_glade.cc:77
+msgid "Import"
+msgstr "Importera"
+
+#: UI/GTK2/src/importDialog_glade.cc:148 UI/GTK2/src/mainWindow_glade.cc:213
+msgid "Import URL"
+msgstr "Importera url"
+
+#: UI/GTK2/src/indexDialog.cc:225
+msgid "Index location"
+msgstr "Indexplats"
+
+#: UI/GTK2/src/indexDialog_glade.cc:62 UI/GTK2/src/queryDialog_glade.cc:68
+msgid "Name:"
+msgstr "Namn:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:64
+msgid "..."
+msgstr "..."
+
+#: UI/GTK2/src/indexDialog_glade.cc:67
+msgid "Type:"
+msgstr "Typ:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:69
+msgid "Port:"
+msgstr "Port:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:143
+msgid "External index"
+msgstr "Externt index"
+
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:112
+#: UI/GTK2/src/ResultsTree.cpp:126
+msgid "Title"
+msgstr "Titel"
+
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:115
+#: UI/GTK2/src/ResultsTree.cpp:136
+msgid "URL"
+msgstr "Url"
+
+#: UI/GTK2/src/IndexTree.cpp:78
+msgid "Timestamp"
+msgstr "Tidsst?mpel"
+
+#: UI/GTK2/src/IndexPage.cpp:51
+msgid "Show Previous"
+msgstr "Visa f?reg?ende"
+
+#: UI/GTK2/src/IndexPage.cpp:57
+msgid "Show Next"
+msgstr "Visa n?sta"
+
+#: UI/GTK2/src/IndexPage.cpp:159 UI/GTK2/src/IndexPage.cpp:205
+msgid "All labels"
+msgstr "Alla etiketter"
+
+#: UI/GTK2/src/mainWindow.cc:138
+msgid "Query Name"
+msgstr "Fr?genamn"
+
+#: UI/GTK2/src/mainWindow.cc:143
+msgid "Last Run"
+msgstr "Senaste k?rning"
+
+#: UI/GTK2/src/mainWindow.cc:148
+msgid "Summary"
+msgstr "Sammandrag"
+
+#: UI/GTK2/src/mainWindow.cc:181
+msgid "Show all search engines"
+msgstr "Visa alla s?kmotorer"
+
+#: UI/GTK2/src/mainWindow.cc:182
+msgid "Add index"
+msgstr "L?gg till index"
+
+#: UI/GTK2/src/mainWindow.cc:183
+msgid "Remove index"
+msgstr "Ta bort index"
+
+#: UI/GTK2/src/mainWindow.cc:189
+msgid "Ready"
+msgstr "Redo"
+
+#: UI/GTK2/src/mainWindow.cc:234
+msgid "N/A"
+msgstr "-"
+
+#: UI/GTK2/src/mainWindow.cc:249
+msgid "<undefined>"
+msgstr "<odefinierad>"
+
+#: UI/GTK2/src/mainWindow.cc:468
+msgid "Result location is"
+msgstr "Resultatplatsen ?r"
+
+#: UI/GTK2/src/mainWindow.cc:555
+msgid "Document location is"
+msgstr "Dokumentplatsen ?r"
+
+#: UI/GTK2/src/mainWindow.cc:873
+msgid "Showing"
+msgstr "Visar"
+
+#: UI/GTK2/src/mainWindow.cc:878
+msgid "of"
+msgstr "av"
+
+#: UI/GTK2/src/mainWindow.cc:883
+msgid "documents, starting at"
+msgstr "dokument, b?rjar med"
+
+#: UI/GTK2/src/mainWindow.cc:916
+msgid "Query"
+msgstr "Fr?ga"
+
+#: UI/GTK2/src/mainWindow.cc:920 UI/GTK2/src/mainWindow.cc:2890
+msgid "on"
+msgstr "p?"
+
+#: UI/GTK2/src/mainWindow.cc:924
+msgid "ended"
+msgstr "slutade"
+
+#: UI/GTK2/src/mainWindow.cc:1013
+msgid "More Like"
+msgstr "Kanske mer som"
+
+#: UI/GTK2/src/mainWindow.cc:1074
+msgid "Updated label(s)"
+msgstr "Uppdaterade etikett(er)"
+
+#: UI/GTK2/src/mainWindow.cc:1158
+msgid "Updated document"
+msgstr "Uppdaterade dokument"
+
+#: UI/GTK2/src/mainWindow.cc:1171
+msgid "Indexed"
+msgstr "Indexerade"
+
+#: UI/GTK2/src/mainWindow.cc:1212
+msgid "Unindexed document(s)"
+msgstr "Ej indexerade dokument"
+
+#: UI/GTK2/src/mainWindow.cc:1253
+msgid "Updated document properties"
+msgstr "Egenskaper f?r uppdaterade dokument"
+
+#: UI/GTK2/src/mainWindow.cc:1300
+msgid "Couldn't rename index, name"
+msgstr "Kunde inte byta namn p? index, namn"
+
+#: UI/GTK2/src/mainWindow.cc:1304 UI/GTK2/src/mainWindow.cc:2214
+#: UI/GTK2/src/mainWindow.cc:2725
+msgid "is already in use"
+msgstr "anv?nds redan"
+
+#: UI/GTK2/src/mainWindow.cc:1317
+msgid "Couldn't rename index"
+msgstr "Kunde inte byta namn p? index"
+
+#: UI/GTK2/src/mainWindow.cc:1330
+msgid "Edited index"
+msgstr "Redigerade index"
+
+#: UI/GTK2/src/mainWindow.cc:1709 UI/GTK2/src/mainWindow.cc:2384
+msgid "Live query"
+msgstr "Levande fr?ga"
+
+#: UI/GTK2/src/mainWindow.cc:1735
+msgid "Couldn't find query"
+msgstr "Kunde inte hitta fr?ga"
+
+#: UI/GTK2/src/mainWindow.cc:1779 UI/GTK2/src/mainWindow.cc:1875
+msgid "Please set a location for the index first"
+msgstr "St?ll in en plats f?r indexet f?rst"
+
+#: UI/GTK2/src/mainWindow.cc:1954 UI/GTK2/src/WorkerThreads.cpp:680
+#: UI/GTK2/src/WorkerThreads.cpp:1499
+msgid "Index"
+msgstr "Index"
+
+#: UI/GTK2/src/mainWindow.cc:1958 UI/GTK2/src/WorkerThreads.cpp:684
+#: UI/GTK2/src/WorkerThreads.cpp:1503
+msgid "doesn't exist"
+msgstr "finns inte"
+
+#: UI/GTK2/src/mainWindow.cc:2102
+msgid "Remove this document from the index ?"
+msgstr "Ta bort detta dokument fr?n indexet?"
+
+#: UI/GTK2/src/mainWindow.cc:2121
+msgid "Remove these documents from the index ?"
+msgstr "Ta bort dessa dokument fr?n indexet?"
+
+#: UI/GTK2/src/mainWindow.cc:2165
+msgid "A metasearch tool for the Free Desktop"
+msgstr "Ett metas?kningsverktyg f?r Free Desktop"
+
+#: UI/GTK2/src/mainWindow.cc:2166
+msgid "(C) 2005-2006 Fabrice Colin"
+msgstr "? 2005-2006 Fabrice Colin"
+
+#: UI/GTK2/src/mainWindow.cc:2210
+msgid "Index name"
+msgstr "Indexnamn"
+
+#: UI/GTK2/src/mainWindow.cc:2225
+msgid "Couldn't add index"
+msgstr "Kunde inte l?gga till index"
+
+#: UI/GTK2/src/mainWindow.cc:2239
+msgid "Added new index"
+msgstr "Lade till nytt index"
+
+#: UI/GTK2/src/mainWindow.cc:2274
+msgid "Couldn't remove index"
+msgstr "Kunde inte ta bort index"
+
+#: UI/GTK2/src/mainWindow.cc:2539
+msgid "At least one task hasn't completed yet. Quit now ?"
+msgstr "?tminstone en uppgift har inte f?rdigst?llts ?n. Avsluta nu?"
+
+#: UI/GTK2/src/mainWindow.cc:2721
+msgid "Query name"
+msgstr "Fr?genamn"
+
+#: UI/GTK2/src/mainWindow.cc:2748
+msgid "Couldn't update query"
+msgstr "Kunde inte uppdatera fr?ga"
+
+#: UI/GTK2/src/mainWindow.cc:2756
+msgid "Edited query"
+msgstr "Redigerade fr?ga"
+
+#: UI/GTK2/src/mainWindow.cc:2763
+msgid "Couldn't add query"
+msgstr "Kunde inte l?gga till fr?ga"
+
+#: UI/GTK2/src/mainWindow.cc:2771
+msgid "Added new query"
+msgstr "Lade till ny fr?ga"
+
+#: UI/GTK2/src/mainWindow.cc:2784
+msgid "Query is not set"
+msgstr "Fr?gan ?r inte inst?lld"
+
+#: UI/GTK2/src/mainWindow.cc:2795
+msgid "No search engine selected"
+msgstr "Ingen s?kmotor vald"
+
+#: UI/GTK2/src/mainWindow.cc:2877
+msgid "Please set the Google API key first"
+msgstr "St?ll in Google API-nyckeln f?rst"
+
+#: UI/GTK2/src/mainWindow.cc:2886
+msgid "Running query"
+msgstr "K?r fr?ga"
+
+#: UI/GTK2/src/mainWindow.cc:3060
+msgid "No default application defined for type"
+msgstr "Inget standardprogram definierat f?r typen"
+
+#: UI/GTK2/src/mainWindow_glade.cc:124
+msgid "Query:"
+msgstr "Fr?ga:"
+
+#: UI/GTK2/src/mainWindow_glade.cc:136
+msgid "Edit"
+msgstr "Redigera"
+
+#: UI/GTK2/src/mainWindow_glade.cc:145
+msgid "Stored queries"
+msgstr "Lagrade fr?gor"
+
+#: UI/GTK2/src/mainWindow_glade.cc:180
+msgid "Search Engine"
+msgstr "S?kmotor"
+
+#: UI/GTK2/src/mainWindow_glade.cc:183
+msgid "Host Name"
+msgstr "V?rdnamn"
+
+#: UI/GTK2/src/mainWindow_glade.cc:186
+msgid "Show Extract"
+msgstr "Visa utdrag"
+
+#: UI/GTK2/src/mainWindow_glade.cc:189
+msgid "Group By"
+msgstr "Gruppera efter"
+
+#: UI/GTK2/src/mainWindow_glade.cc:192
+msgid "Clear List"
+msgstr "T?m lista"
+
+#: UI/GTK2/src/mainWindow_glade.cc:198
+msgid "Vie_w"
+msgstr "Vi_sa"
+
+#: UI/GTK2/src/mainWindow_glade.cc:201
+msgid "View Cache"
+msgstr "Visa cache"
+
+#: UI/GTK2/src/mainWindow_glade.cc:204
+msgid "More Like This"
+msgstr "Mer som det h?r"
+
+#: UI/GTK2/src/mainWindow_glade.cc:207 UI/GTK2/src/mainWindow_glade.cc:243
+msgid "_Index"
+msgstr "_Index"
+
+#: UI/GTK2/src/mainWindow_glade.cc:210
+msgid "List Contents Of"
+msgstr "Lista inneh?ll f?r"
+
+#: UI/GTK2/src/mainWindow_glade.cc:219
+msgid "View"
+msgstr "Visa"
+
+#: UI/GTK2/src/mainWindow_glade.cc:222
+msgid "Update"
+msgstr "Uppdatera"
+
+#: UI/GTK2/src/mainWindow_glade.cc:225
+msgid "Unindex"
+msgstr "Avindexera"
+
+#: UI/GTK2/src/mainWindow_glade.cc:228
+#: UI/GTK2/src/propertiesDialog_glade.cc:146
+msgid "Properties"
+msgstr "Egenskaper"
+
+#: UI/GTK2/src/mainWindow_glade.cc:231
+msgid "_About"
+msgstr "_Om"
+
+#: UI/GTK2/src/mainWindow_glade.cc:234
+msgid "_Session"
+msgstr "_Session"
+
+#: UI/GTK2/src/mainWindow_glade.cc:237
+msgid "_Edit"
+msgstr "R_edigera"
+
+#: UI/GTK2/src/mainWindow_glade.cc:240
+msgid "_Results"
+msgstr "_Resultat"
+
+#: UI/GTK2/src/mainWindow_glade.cc:246
+msgid "_Help"
+msgstr "_Hj?lp"
+
+#: UI/GTK2/src/mainWindow_glade.cc:383
+msgid "Pinot"
+msgstr "Pinot"
+
+#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:699
+msgid "Unknown"
+msgstr "Ok?nd"
+
+#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:700
+msgid "Danish"
+msgstr "Danska"
+
+#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:701
+msgid "Dutch"
+msgstr "Nederl?ndska"
+
+#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+msgid "English"
+msgstr "Engelska"
+
+#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+msgid "Finnish"
+msgstr "Finska"
+
+#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+msgid "French"
+msgstr "Franska"
+
+#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+msgid "German"
+msgstr "Tyska"
+
+#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+msgid "Italian"
+msgstr "Italienska"
+
+#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+msgid "Norwegian"
+msgstr "Norska"
+
+#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+msgid "Portuguese"
+msgstr "Portugisiska"
+
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+msgid "Russian"
+msgstr "Ryska"
+
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+msgid "Spanish"
+msgstr "Spanska"
+
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+msgid "Swedish"
+msgstr "Svenska"
+
+#: UI/GTK2/src/pinot.cc:206
+msgid "Couldn't open index"
+msgstr "Kunde inte ?ppna index"
+
+#: UI/GTK2/src/pinot.cc:222
+msgid "Couldn't create history database"
+msgstr "Kunde inte skapa historikdatabas"
+
+#: UI/GTK2/src/PinotSettings.cpp:241
+msgid "Important"
+msgstr "Viktigt"
+
+#: UI/GTK2/src/PinotSettings.cpp:242
+msgid "New"
+msgstr "Ny"
+
+#: UI/GTK2/src/PinotSettings.cpp:243
+msgid "Personal"
+msgstr "Personlig"
+
+#: UI/GTK2/src/PinotSettings.cpp:1049
+msgid "Unclassified"
+msgstr "Oklassificerad"
+
+#: UI/GTK2/src/prefsDialog.cc:67
+msgid "Name"
+msgstr "Namn"
+
+#: UI/GTK2/src/prefsDialog.cc:75
+msgid "Monitor"
+msgstr "?vervaka"
+
+#: UI/GTK2/src/prefsDialog.cc:76 UI/GTK2/src/prefsDialog.cc:84
+msgid "Location"
+msgstr "Plats"
+
+#: UI/GTK2/src/prefsDialog.cc:92
+msgid "Pattern"
+msgstr "M?nster"
+
+#: UI/GTK2/src/prefsDialog.cc:418
+msgid "New Label"
+msgstr "Ny etikett"
+
+#: UI/GTK2/src/prefsDialog.cc:459
+msgid "Directory to index"
+msgstr "Katalog f?r index"
+
+#: UI/GTK2/src/prefsDialog.cc:517
+msgid "Mbox File Location"
+msgstr "Plats f?r mbox-fil"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:65
+msgid "HTTP crawling:"
+msgstr "HTTP-crawling:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:66
+msgid "Google API key:"
+msgstr "Google API-nyckel:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:68
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "Ignorera robots.txt och Robots META-tagg"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:70
+msgid "New results:"
+msgstr "Nya resultat:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:71
+msgid "Queries:"
+msgstr "Fr?gor:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:72
+msgid "Enable search terms suggestion"
+msgstr "Aktivera s?kf?rslag"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:76
+msgid "General"
+msgstr "Allm?nt"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
+msgid "Labels are used to classify indexed documents:"
+msgstr "Etiketter som anv?nds f?r att klassificera indexerade dokument:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:82 UI/GTK2/src/prefsDialog_glade.cc:102
+#: UI/GTK2/src/prefsDialog_glade.cc:115 UI/GTK2/src/prefsDialog_glade.cc:128
+msgid "Add"
+msgstr "L?gg till"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:88
+msgid "Remove"
+msgstr "Ta bort"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:96
+msgid "Labels"
+msgstr "Etiketter"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:97
+msgid ""
+"These directories will be indexed and optionally monitored for changes:"
+msgstr ""
+"Dessa kataloger kommer att bli indexerade och ?vervakade f?r ?ndringar "
+"(valfritt):"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:110
+msgid "Mail boxes of type mbox can be monitored and indexed:"
+msgstr "Postl?dor av typen mbox kan ?vervakas och indexeras:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:123
+msgid "Specify any file pattern you wish to exclude from indexing:"
+msgstr "Ange de film?nster som du ?nskar undanta fr?n indexering:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:137
+msgid "Indexing"
+msgstr "Indexerar"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:411
+msgid "Preferences"
+msgstr "Inst?llningar"
+
+#: UI/GTK2/src/propertiesDialog.cc:51 UI/GTK2/src/queryDialog.cc:127
+msgid "Label"
+msgstr "Etikett"
+
+#: UI/GTK2/src/propertiesDialog.cc:64
+msgid "Per document"
+msgstr "Per dokument"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:66
+msgid "Language:"
+msgstr "Spr?k:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:67
+msgid "MIME type:"
+msgstr "MIME-typ:"
+
+#: UI/GTK2/src/queryDialog.cc:103
+msgid "Host name"
+msgstr "V?rdnamn"
+
+#: UI/GTK2/src/queryDialog.cc:106
+msgid "File name"
+msgstr "Filnamn"
+
+#: UI/GTK2/src/queryDialog.cc:109
+msgid "File extension"
+msgstr "Fil?ndelse"
+
+#: UI/GTK2/src/queryDialog.cc:118
+msgid "Directory"
+msgstr "Katalog"
+
+#: UI/GTK2/src/queryDialog.cc:121
+msgid "Language code"
+msgstr "Spr?kkod"
+
+#: UI/GTK2/src/queryDialog.cc:124
+msgid "MIME type"
+msgstr "MIME-typ"
+
+#: UI/GTK2/src/queryDialog_glade.cc:72
+msgid "New filter:"
+msgstr "Nytt filter:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:81
+msgid "Query Text"
+msgstr "Fr?getext"
+
+#: UI/GTK2/src/queryDialog_glade.cc:83
+msgid "Index all results with label"
+msgstr "Indexera alla resultat med etiketten"
+
+#: UI/GTK2/src/queryDialog_glade.cc:86
+msgid "Number of results:"
+msgstr "Antal resultat:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:182
+msgid "Query parameters"
+msgstr "Fr?geparametrar"
+
+#: UI/GTK2/src/ResultsTree.cpp:116
+msgid "Score"
+msgstr "Betyg"
+
+#: UI/GTK2/src/ResultsTree.cpp:165
+msgid "Extract"
+msgstr "Utdrag"
+
+#: UI/GTK2/src/WorkerThreads.cpp:318
+msgid "Can't index mail here"
+msgstr "Kan inte indexera post h?r"
+
+#: UI/GTK2/src/WorkerThreads.cpp:339
+msgid "is already being indexed"
+msgstr "h?ller redan p? att bli indexerad"
+
+#: UI/GTK2/src/WorkerThreads.cpp:349
+msgid "is blacklisted"
+msgstr "?r svartlistad"
+
+#: UI/GTK2/src/WorkerThreads.cpp:357 UI/GTK2/src/WorkerThreads.cpp:693
+#: UI/GTK2/src/WorkerThreads.cpp:968 UI/GTK2/src/WorkerThreads.cpp:977
+#: UI/GTK2/src/WorkerThreads.cpp:1146 UI/GTK2/src/WorkerThreads.cpp:1388
+#: UI/GTK2/src/WorkerThreads.cpp:1512
+msgid "Index error on"
+msgstr "Indexfel p?"
+
+#: UI/GTK2/src/WorkerThreads.cpp:812 UI/GTK2/src/WorkerThreads.cpp:912
+msgid "Couldn't create search engine"
+msgstr "Kunde inte skapa s?kmotor"
+
+#: UI/GTK2/src/WorkerThreads.cpp:824 UI/GTK2/src/WorkerThreads.cpp:926
+msgid "Couldn't run query on search engine"
+msgstr "Kunde inte k?ra fr?ga p? s?kmotor"
+
+#: UI/GTK2/src/WorkerThreads.cpp:840
+msgid "No title"
+msgstr "Ingen titel"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1056
+msgid "Couldn't obtain downloader for protocol"
+msgstr "Kunde inte f? protokollh?mtare"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1067
+msgid "Couldn't retrieve"
+msgstr "Kunde inte h?mta"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1170 UI/GTK2/src/WorkerThreads.cpp:1237
+msgid "Cannot index document type"
+msgstr "Kan inte indexera dokumenttyp"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1174 UI/GTK2/src/WorkerThreads.cpp:1241
+msgid "at"
+msgstr "p?"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1263
+msgid "Couldn't tokenize"
+msgstr "Kunde inte g?ra token"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1283
+msgid "Robots META tag forbids indexing"
+msgstr "Robots META-tagg f?rbjuder indexering"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1318
+msgid "Couldn't index"
+msgstr "Kunde inte indexera"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1399
+msgid "Couldn't unindex document(s)"
+msgstr "Kunde inte avindexera dokument"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1524
+msgid "Couldn't update document"
+msgstr "Kunde inte uppdatera dokument"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1714
+msgid "No monitoring handler"
+msgstr "Ingen ?vervakningshanterare"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1756
+msgid "Couldn't initialize file monitor"
+msgstr "Kunde inte initiera fil?vervakare"
+
+#: UI/GTK2/src/WorkerThreads.cpp:2060
+msgid "Couldn't open directory"
+msgstr "Kunde inte ?ppna katalog"
\ No newline at end of file



From fabricecolin at mail.berlios.de  Mon Dec  4 11:30:40 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 4 Dec 2006 11:30:40 +0100
Subject: [Pinot-svn] r615 - trunk/Index
Message-ID: <200612041030.kB4AUekO007422@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-04 11:30:40 +0100 (Mon, 04 Dec 2006)
New Revision: 615

Modified:
   trunk/Index/XapianIndex.cpp
Log:
The file name shouldn't be lower-cased.


Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-12-04 00:00:56 UTC (rev 614)
+++ trunk/Index/XapianIndex.cpp	2006-12-04 10:30:40 UTC (rev 615)
@@ -383,7 +383,7 @@
 	{
 		string extension;
 
-		doc.add_term(limitTermLength(string("P") + StringManip::toLowerCase(fileName), true));
+		doc.add_term(limitTermLength(string("P") + fileName, true));
 
 		// Does it have an extension ?
 		string::size_type extPos = fileName.rfind('.');
@@ -489,7 +489,7 @@
 	{
 		string extension;
 
-		doc.remove_term(limitTermLength(string("P") + StringManip::toLowerCase(fileName), true));
+		doc.remove_term(limitTermLength(string("P") + fileName, true));
 
 		// Does it have an extension ?
 		string::size_type extPos = fileName.rfind('.');



From fabricecolin at mail.berlios.de  Mon Dec  4 11:31:41 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 4 Dec 2006 11:31:41 +0100
Subject: [Pinot-svn] r616 - trunk/UI/GTK2/src
Message-ID: <200612041031.kB4AVfYS008091@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-04 11:31:41 +0100 (Mon, 04 Dec 2006)
New Revision: 616

Modified:
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/UI/GTK2/src/pinot.cc
Log:
Check whether Glib threads subsystem is initialized before calling init().


Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-04 10:30:40 UTC (rev 615)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-04 10:31:41 UTC (rev 616)
@@ -673,7 +673,10 @@
 	MIMEScanner::initialize();
 	HtmlTokenizer::initialize();
 	DownloaderInterface::initialize();
-	Glib::thread_init();
+	if (Glib::thread_supported() == false)
+	{
+		Glib::thread_init();
+	}
 	g_refMainLoop = Glib::MainLoop::create();
 	Glib::set_application_name("Pinot DBus Daemon");
 

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2006-12-04 10:30:40 UTC (rev 615)
+++ trunk/UI/GTK2/src/pinot.cc	2006-12-04 10:31:41 UTC (rev 616)
@@ -144,7 +144,10 @@
 	MIMEScanner::initialize();
 	HtmlTokenizer::initialize();
 	DownloaderInterface::initialize();
-	Glib::thread_init();
+	if (Glib::thread_supported() == false)
+	{
+		Glib::thread_init();
+	}
 	Gtk::Main m(&argc, &argv);
 	Glib::set_application_name("Pinot GTK2 UI");
 



From fabricecolin at mail.berlios.de  Mon Dec  4 11:38:13 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 4 Dec 2006 11:38:13 +0100
Subject: [Pinot-svn] r617 - trunk/UI/GTK2/src
Message-ID: <200612041038.kB4AcDfq011448@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-04 11:38:12 +0100 (Mon, 04 Dec 2006)
New Revision: 617

Modified:
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/WorkerThreads.h
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/mainWindow.hh
Log:
Don't update the index list incrementally, do it when IndexBrowser returns. This
fixes a crash on SMP systems due to calls to GTK by the UI and a worker thread.


Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-04 10:31:41 UTC (rev 616)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-04 10:38:12 UTC (rev 617)
@@ -158,6 +158,9 @@
 
 void WorkerThread::threadHandler(void)
 {
+#ifdef DEBUG
+	cout << "WorkerThread::threadHandler: thread " << m_id << " " << pthread_self() << endl;
+#endif
 	try
 	{
 		doWork();
@@ -648,29 +651,17 @@
 	return m_indexDocsCount;
 }
 
+const vector<IndexedDocument> &IndexBrowserThread::getDocuments(void) const
+{
+	return m_documentsList;
+}
+
 bool IndexBrowserThread::stop(void)
 {
-	// Disconnect the signal
-	Signal3<void, IndexedDocument, unsigned int, string>::slot_list_type slotsList = m_signalUpdate.slots();
-	Signal3<void, IndexedDocument, unsigned int, string>::slot_list_type::iterator slotIter = slotsList.begin();
-	if (slotIter != slotsList.end())
-	{
-		if (slotIter->empty() == false)
-		{
-			slotIter->block();
-			slotIter->disconnect();
-		}
-	}
 	m_done = true;
-
 	return true;
 }
 
-SigC::Signal3<void, IndexedDocument, unsigned int, string>& IndexBrowserThread::getUpdateSignal(void)
-{
-	return m_signalUpdate;
-}
-
 void IndexBrowserThread::doWork(void)
 {
 	set<unsigned int> docIDList;
@@ -725,6 +716,8 @@
 	{
 		pIndex->listDocumentsWithLabel(m_labelName, docIDList, m_maxDocsCount, m_startDoc);
 	}
+
+	m_documentsList.reserve(m_maxDocsCount);
 	for (set<unsigned int>::iterator iter = docIDList.begin(); iter != docIDList.end(); ++iter)
 	{
 		if (m_done == true)
@@ -751,8 +744,8 @@
 			indexedDoc.setTimestamp(docInfo.getTimestamp());
 			indexedDoc.setSize(docInfo.getSize());
 
-			// Signal
-			m_signalUpdate(indexedDoc, docId, m_indexName);
+			// Insert that document
+			m_documentsList.push_back(indexedDoc);
 			++numDocs;
 		}
 #ifdef DEBUG

Modified: trunk/UI/GTK2/src/WorkerThreads.h
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.h	2006-12-04 10:31:41 UTC (rev 616)
+++ trunk/UI/GTK2/src/WorkerThreads.h	2006-12-04 10:38:12 UTC (rev 617)
@@ -167,17 +167,17 @@
 
 		unsigned int getDocumentsCount(void) const;
 
+		const std::vector<IndexedDocument> &getDocuments(void) const;
+
 		virtual bool stop(void);
 
-		SigC::Signal3<void, IndexedDocument, unsigned int, std::string>& getUpdateSignal(void);
-
 	protected:
 		std::string m_indexName;
 		std::string m_labelName;
 		unsigned int m_indexDocsCount;
 		unsigned int m_maxDocsCount;
 		unsigned int m_startDoc;
-		SigC::Signal3<void, IndexedDocument, unsigned int, std::string> m_signalUpdate;
+		std::vector<IndexedDocument> m_documentsList;
 
 		virtual void doWork(void);
 

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-12-04 10:31:41 UTC (rev 616)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-12-04 10:38:12 UTC (rev 617)
@@ -867,6 +867,11 @@
 			pIndexTree = pIndexPage->getTree();
 			if (pIndexTree != NULL)
 			{
+				const vector<IndexedDocument> &docsList = pBrowseThread->getDocuments();
+
+				// Add the documents to the tree
+				pIndexTree->addDocuments(docsList);
+
 				pIndexPage->setDocumentsCount(pBrowseThread->getDocumentsCount());
 				pIndexPage->updateButtonsState(m_maxDocsCount);
 
@@ -1331,25 +1336,6 @@
 }
 
 //
-// Message reception from IndexBrowserThread
-//
-void mainWindow::on_message_indexupdate(IndexedDocument docInfo, unsigned int docId, string indexName)
-{
-	// Find the page for this index
-	IndexPage *pIndexPage = dynamic_cast<IndexPage*>(get_page(to_utf8(indexName), NotebookPageBox::INDEX_PAGE));
-	if (pIndexPage == NULL)
-	{
-		// It's probably been closed by the user
-#ifdef DEBUG
-		cout << "mainWindow::on_message_indexupdate: " << indexName << " not being shown" << endl;
-#endif
-		return;
-	}
-
-	append_document(pIndexPage, to_utf8(indexName), docInfo);
-}
-
-//
 // Session > Configure menu selected
 //
 void mainWindow::on_configure_activate()
@@ -2932,8 +2918,6 @@
 	// Spawn a new thread to browse the index
 	IndexBrowserThread *pBrowseThread = new IndexBrowserThread(
 		from_utf8(indexName), labelName, m_maxDocsCount, startDoc);
-	pBrowseThread->getUpdateSignal().connect(SigC::slot(*this,
-		&mainWindow::on_message_indexupdate));
 	start_thread(pBrowseThread);
 }
 

Modified: trunk/UI/GTK2/src/mainWindow.hh
===================================================================
--- trunk/UI/GTK2/src/mainWindow.hh	2006-12-04 10:31:41 UTC (rev 616)
+++ trunk/UI/GTK2/src/mainWindow.hh	2006-12-04 10:38:12 UTC (rev 617)
@@ -74,7 +74,6 @@
 	void on_close_page(Glib::ustring title, NotebookPageBox::PageType type);
 	void on_thread_end(WorkerThread *pThread);
 	void on_editindex(Glib::ustring indexName, Glib::ustring location);
-	void on_message_indexupdate(IndexedDocument docInfo, unsigned int docId, std::string indexName);
 
 	// Handlers inherited from the base class
 	virtual void on_configure_activate();



From fabricecolin at mail.berlios.de  Mon Dec  4 11:42:18 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 4 Dec 2006 11:42:18 +0100
Subject: [Pinot-svn] r618 - trunk/UI/GTK2/src
Message-ID: <200612041042.kB4AgIqq012632@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-04 11:42:17 +0100 (Mon, 04 Dec 2006)
New Revision: 618

Modified:
   trunk/UI/GTK2/src/ResultsTree.cpp
Log:
Only return actual documents in getSelection().


Modified: trunk/UI/GTK2/src/ResultsTree.cpp
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.cpp	2006-12-04 10:38:12 UTC (rev 617)
+++ trunk/UI/GTK2/src/ResultsTree.cpp	2006-12-04 10:42:17 UTC (rev 618)
@@ -805,8 +805,11 @@
 		TreeModel::iterator iter = m_refStore->get_iter(*itemPath);
 		TreeModel::Row row = *iter;
 
-		resultsList.push_back(DocumentInfo(from_utf8(row[m_resultsColumns.m_text]),
-			from_utf8(row[m_resultsColumns.m_url]), "", ""));
+		if (row[m_resultsColumns.m_type] == ResultsModelColumns::RESULT_TITLE)
+		{
+			resultsList.push_back(DocumentInfo(from_utf8(row[m_resultsColumns.m_text]),
+				from_utf8(row[m_resultsColumns.m_url]), "", ""));
+		}
 	}
 #ifdef DEBUG
 	cout << "ResultsTree::getSelection: " << resultsList.size() << " results selected" << endl;



From fabricecolin at mail.berlios.de  Mon Dec  4 14:15:29 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 4 Dec 2006 14:15:29 +0100
Subject: [Pinot-svn] r619 - trunk/UI/GTK2/src
Message-ID: <200612041315.kB4DFTUW007416@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-04 14:15:28 +0100 (Mon, 04 Dec 2006)
New Revision: 619

Modified:
   trunk/UI/GTK2/src/WorkerThreads.cpp
Log:
Fixed deadlock, reported by Thierry Thomas <thierry at freebsd dot org>.


Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-04 10:42:17 UTC (rev 618)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-04 13:15:28 UTC (rev 619)
@@ -575,6 +575,8 @@
 			}
 		}
 
+		unlock_lists();
+
 		// Get an item ?
 		if (getItem == true)
 		{
@@ -597,8 +599,6 @@
 				}
 			}
 		}
-
-		unlock_lists();
 	}
 
 	return foundItem;



From fabricecolin at mail.berlios.de  Mon Dec  4 15:55:57 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 4 Dec 2006 15:55:57 +0100
Subject: [Pinot-svn] r620 - trunk
Message-ID: <200612041455.kB4Etv7Q022097@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-04 15:55:56 +0100 (Mon, 04 Dec 2006)
New Revision: 620

Modified:
   trunk/Makefile.am
   trunk/configure.in
   trunk/pinot.spec.in
Log:
Added nl and sv to list of languages.
Changed how tokenizers are installed and packaged.


Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-12-04 13:15:28 UTC (rev 619)
+++ trunk/Makefile.am	2006-12-04 14:55:56 UTC (rev 620)
@@ -33,8 +33,8 @@
 	@mv $(DESTDIR)$(datadir)/pinot/engines/AmazonAPI.src $(DESTDIR)$(datadir)/pinot/
 	$(INSTALL_DATA) Search/Plugins/*.xml $(DESTDIR)$(datadir)/pinot/engines/
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/pinot/tokenizers
-	@rm -f $(DESTDIR)$(libdir)/lib*tokenizer.*
-	$(INSTALL_DATA) Tokenize/.libs/*.so $(DESTDIR)$(datadir)/pinot/tokenizers/
+	@rm $(DESTDIR)$(libdir)/lib*tokenizer.a $(DESTDIR)$(libdir)/lib*tokenizer.la
+	@mv $(DESTDIR)$(libdir)/lib*tokenizer* $(DESTDIR)$(datadir)/pinot/tokenizers/
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/
 	$(INSTALL_DATA) UI/GTK2/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/pinot.png
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/applications

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-12-04 13:15:28 UTC (rev 619)
+++ trunk/configure.in	2006-12-04 14:55:56 UTC (rev 620)
@@ -25,7 +25,7 @@
 		[the gettext domain])
 
 dnl Add the languages which your application supports here.
-ALL_LINGUAS="fr es"
+ALL_LINGUAS="fr es nl sv"
 #AM_GNU_GETTEXT([external]) 
 AM_GLIB_GNU_GETTEXT
 

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-12-04 13:15:28 UTC (rev 619)
+++ trunk/pinot.spec.in	2006-12-04 14:55:56 UTC (rev 620)
@@ -100,10 +100,10 @@
 %{_datadir}/pinot/pinot-dbus-daemon.xml
 %{_datadir}/pinot/textcat_conf.txt
 %{_datadir}/pinot/textcat3_conf.txt
-%{_datadir}/pinot/tokenizers/libopendocumenttokenizer.so
-%{_datadir}/pinot/tokenizers/libpdftokenizer.so
-%{_datadir}/pinot/tokenizers/librtftokenizer.so
-%{_datadir}/pinot/tokenizers/libwordtokenizer.so
+%{_datadir}/pinot/tokenizers/libopendocumenttokenizer.so*
+%{_datadir}/pinot/tokenizers/libpdftokenizer.so*
+%{_datadir}/pinot/tokenizers/librtftokenizer.so*
+%{_datadir}/pinot/tokenizers/libwordtokenizer.so*
 %{_datadir}/dbus-1/services/de.berlios.Pinot.service
 %{_datadir}/pinot/*.src
 %dir %{_datadir}/pinot/engines/
@@ -128,6 +128,8 @@
 %config(noreplace) %{_datadir}/pinot/engines/KodersDescription.xml
 %{_datadir}/locale/fr/LC_MESSAGES/pinot.mo
 %{_datadir}/locale/es/LC_MESSAGES/pinot.mo
+%{_datadir}/locale/nl/LC_MESSAGES/pinot.mo
+%{_datadir}/locale/sv/LC_MESSAGES/pinot.mo
 %{_datadir}/icons/hicolor/48x48/apps/pinot.png
 %{_sysconfdir}/xdg/autostart/*.desktop
 %{_datadir}/applications/*.desktop
@@ -139,7 +141,7 @@
 
 %files audio-docs 
 %defattr(-, root, root, -)
-%{_datadir}/pinot/tokenizers/libtaglibtokenizer.so
+%{_datadir}/pinot/tokenizers/libtaglibtokenizer.so*
 
 %files omega
 %defattr(-, root, root, -)



From fabricecolin at mail.berlios.de  Tue Dec  5 11:33:24 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 5 Dec 2006 11:33:24 +0100
Subject: [Pinot-svn] r621 - trunk/Index
Message-ID: <200612051033.kB5AXO8U022550@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-05 11:33:24 +0100 (Tue, 05 Dec 2006)
New Revision: 621

Modified:
   trunk/Index/XapianDatabase.cpp
   trunk/Index/XapianIndex.cpp
Log:
Less DEBUG messages.


Modified: trunk/Index/XapianDatabase.cpp
===================================================================
--- trunk/Index/XapianDatabase.cpp	2006-12-04 14:55:56 UTC (rev 620)
+++ trunk/Index/XapianDatabase.cpp	2006-12-05 10:33:24 UTC (rev 621)
@@ -246,9 +246,6 @@
 	{
 		if (pthread_mutex_lock(&m_rwLock) == 0)
 		{
-#ifdef DEBUG
-			cout << "XapianDatabase::readLock: thread " << pthread_self() << endl;
-#endif
 			if (m_pDatabase == NULL)
 			{
 				// Try again
@@ -269,9 +266,6 @@
 
 		if (pthread_mutex_lock(&m_rwLock) == 0)
 		{
-#ifdef DEBUG
-			cout << "XapianDatabase::readLock: thread " << pthread_self() << endl;
-#endif
 			// Reopen the second index
 			m_pSecond->reopen();
 
@@ -312,9 +306,7 @@
 			// Try again
 			openDatabase();
 		}
-#ifdef DEBUG
-		cout << "XapianDatabase::writeLock: thread " << pthread_self() << endl;
-#endif
+
 		return dynamic_cast<Xapian::WritableDatabase *>(m_pDatabase);
 	}
 
@@ -324,9 +316,6 @@
 /// Unlocks the database.
 void XapianDatabase::unlock(void)
 {
-#ifdef DEBUG
-	cout << "XapianDatabase::unlock: thread " << pthread_self() << endl;
-#endif
 	pthread_mutex_unlock(&m_rwLock);
 
 	if (m_merge == true)

Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-12-04 14:55:56 UTC (rev 620)
+++ trunk/Index/XapianIndex.cpp	2006-12-05 10:33:24 UTC (rev 621)
@@ -1308,9 +1308,6 @@
 		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
 		if (pIndex != NULL)
 		{
-#ifdef DEBUG
-			cout << "XapianIndex::unindexDocument: indexed " << docId << endl;
-#endif
 			// Delete the document from the index
 			pIndex->delete_document(docId);
 			unindexed = true;
@@ -1353,9 +1350,6 @@
 		{
 			string term = limitTermLength(string("U") + Url::canonicalizeUrl(location), true);
 
-#ifdef DEBUG
-			cout << "XapianIndex::unindexDocuments: indexed " << term << endl;
-#endif
 			// Only one document should have this term
 			pIndex->delete_document(term);
 			unindexed = true;
@@ -1398,9 +1392,6 @@
 		{
 			string term("XLABEL:");
 
-#ifdef DEBUG
-			cout << "XapianIndex::unindexDocuments: indexed " << labelName << endl;
-#endif
 			// Delete documents from the index
 			term += labelName;
 			pIndex->delete_document(term);



From fabricecolin at mail.berlios.de  Tue Dec  5 11:44:07 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 5 Dec 2006 11:44:07 +0100
Subject: [Pinot-svn] r623 - trunk
Message-ID: <200612051044.kB5Ai7Oh026117@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-05 11:44:07 +0100 (Tue, 05 Dec 2006)
New Revision: 623

Modified:
   trunk/AUTHORS
   trunk/NEWS
Log:
Updated with these few days changes. Set release date to today.


Modified: trunk/AUTHORS
===================================================================
--- trunk/AUTHORS	2006-12-05 10:42:17 UTC (rev 622)
+++ trunk/AUTHORS	2006-12-05 10:44:07 UTC (rev 623)
@@ -9,6 +9,7 @@
 	Simplified UI - Manuel Breitfeld <manu_foren at gmx dot net>
 	Missing copyright notice - Gauvain Pocentek <gauvainpocentek at gmail dot com>
 	Desktop file installation - Oskar <???>
+	Search-and-index UI deadlock - Thierry Thomas <thierry at freebsd dot org>
 
 The file Monitor/linux-inotify-syscalls.h is originally from libinotify
 (Copyright ? 2005 Ryan Lortie <desrt at desrt dot ca>).
@@ -21,5 +22,8 @@
 
 Translations provided by :
 
+	Dutch - Tikkel <???>
+	French - Nicolas Velin <nsv at fr dot st>
 	Spanish - Jes?s Tramullas <jesus at tramullas dot com>
-	French (Rosetta) - Nicolas Velin <nsv at fr dot st>
+	Swedish - Daniel Nylander <po at danielnylander dot se>
+

Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2006-12-05 10:42:17 UTC (rev 622)
+++ trunk/NEWS	2006-12-05 10:44:07 UTC (rev 623)
@@ -1,14 +1,20 @@
-??? version_0_6_4
+2006/12/05 version_0_6_4
 Collect :
  - don't needlessly load files that are going to be handled by an helper application
 Index :
  - store documents size and file extension, if any
  - fixed concurrency bug that could thrash the index on SMP systems
  - very long capitalized terms could lead to document loss
+ - file names were always lower-cased
 Search :
  - regenerated the Google SOAP API stubs with gsoap 2.7.8c
 UI :
  - added filter on file extension
+ - fixed crash on SMP systems when listing an index
+ - fixed deadlock when indexing a query's results. Oddly enough, it seems it
+  happened only on FreeBSD !
+ - Dutch translation by Tikkel
+ - Swedish translation by Daniel Nylander
 Daemon :
  - set a lower scheduling priority
  - queue events in the database, not in memory



From fabricecolin at mail.berlios.de  Tue Dec  5 11:42:21 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 5 Dec 2006 11:42:21 +0100
Subject: [Pinot-svn] r622 - trunk/po
Message-ID: <200612051042.kB5AgLHf025882@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-05 11:42:17 +0100 (Tue, 05 Dec 2006)
New Revision: 622

Modified:
   trunk/po/es.po
   trunk/po/fr.po
   trunk/po/nl.po
   trunk/po/sv.po
Log:
Synced po's with source.


Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2006-12-05 10:33:24 UTC (rev 621)
+++ trunk/po/es.po	2006-12-05 10:42:17 UTC (rev 622)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.64\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-12-02 11:47+0800\n"
+"POT-Creation-Date: 2006-12-04 22:28+0800\n"
 "PO-Revision-Date: 2006-12-03 15:05+0000\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: es <fabricecolin at users.berlios.de>\n"
@@ -27,9 +27,9 @@
 
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
 #: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
-#: UI/GTK2/src/mainWindow.cc:1148 UI/GTK2/src/mainWindow.cc:1191
-#: UI/GTK2/src/mainWindow.cc:1211 UI/GTK2/src/mainWindow.cc:1242
-#: UI/GTK2/src/mainWindow.cc:1831 UI/GTK2/src/PinotSettings.cpp:235
+#: UI/GTK2/src/mainWindow.cc:1153 UI/GTK2/src/mainWindow.cc:1196
+#: UI/GTK2/src/mainWindow.cc:1216 UI/GTK2/src/mainWindow.cc:1247
+#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/PinotSettings.cpp:235
 #: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
 msgid "My Web Pages"
 msgstr "Mis Paginas Web"
@@ -159,166 +159,166 @@
 msgid "Document location is"
 msgstr "La localizaci?n del documento es"
 
-#: UI/GTK2/src/mainWindow.cc:873
+#: UI/GTK2/src/mainWindow.cc:878
 msgid "Showing"
 msgstr "Mostrando"
 
-#: UI/GTK2/src/mainWindow.cc:878
+#: UI/GTK2/src/mainWindow.cc:883
 msgid "of"
 msgstr "documentos"
 
-#: UI/GTK2/src/mainWindow.cc:883
+#: UI/GTK2/src/mainWindow.cc:888
 msgid "documents, starting at"
 msgstr "documentos comenzando en"
 
-#: UI/GTK2/src/mainWindow.cc:916
+#: UI/GTK2/src/mainWindow.cc:921
 msgid "Query"
 msgstr "B?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:920 UI/GTK2/src/mainWindow.cc:2890
+#: UI/GTK2/src/mainWindow.cc:925 UI/GTK2/src/mainWindow.cc:2876
 msgid "on"
 msgstr "en"
 
-#: UI/GTK2/src/mainWindow.cc:924
+#: UI/GTK2/src/mainWindow.cc:929
 msgid "ended"
 msgstr "finalizado"
 
-#: UI/GTK2/src/mainWindow.cc:1013
+#: UI/GTK2/src/mainWindow.cc:1018
 msgid "More Like"
 msgstr "M?s como"
 
-#: UI/GTK2/src/mainWindow.cc:1074
+#: UI/GTK2/src/mainWindow.cc:1079
 msgid "Updated label(s)"
 msgstr "Etiqueta(s) actualizada(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1158
+#: UI/GTK2/src/mainWindow.cc:1163
 msgid "Updated document"
 msgstr "Documento actualizado"
 
-#: UI/GTK2/src/mainWindow.cc:1171
+#: UI/GTK2/src/mainWindow.cc:1176
 msgid "Indexed"
 msgstr "Indizado"
 
-#: UI/GTK2/src/mainWindow.cc:1212
+#: UI/GTK2/src/mainWindow.cc:1217
 msgid "Unindexed document(s)"
 msgstr "Documento(s) no indizado(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1258
 msgid "Updated document properties"
 msgstr "Propiedades del documento actualizadas"
 
-#: UI/GTK2/src/mainWindow.cc:1300
+#: UI/GTK2/src/mainWindow.cc:1305
 msgid "Couldn't rename index, name"
 msgstr "No se pudo renombrar ?ndice, nombre"
 
-#: UI/GTK2/src/mainWindow.cc:1304 UI/GTK2/src/mainWindow.cc:2214
-#: UI/GTK2/src/mainWindow.cc:2725
+#: UI/GTK2/src/mainWindow.cc:1309 UI/GTK2/src/mainWindow.cc:2200
+#: UI/GTK2/src/mainWindow.cc:2711
 msgid "is already in use"
 msgstr "ya est? en uso"
 
-#: UI/GTK2/src/mainWindow.cc:1317
+#: UI/GTK2/src/mainWindow.cc:1322
 msgid "Couldn't rename index"
 msgstr "No se pudo renombrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1330
+#: UI/GTK2/src/mainWindow.cc:1335
 msgid "Edited index"
 msgstr "?ndice editado"
 
-#: UI/GTK2/src/mainWindow.cc:1709 UI/GTK2/src/mainWindow.cc:2384
+#: UI/GTK2/src/mainWindow.cc:1695 UI/GTK2/src/mainWindow.cc:2370
 msgid "Live query"
 msgstr "B?squeda activa"
 
-#: UI/GTK2/src/mainWindow.cc:1735
+#: UI/GTK2/src/mainWindow.cc:1721
 msgid "Couldn't find query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:1779 UI/GTK2/src/mainWindow.cc:1875
+#: UI/GTK2/src/mainWindow.cc:1765 UI/GTK2/src/mainWindow.cc:1861
 msgid "Please set a location for the index first"
 msgstr "Por favor, primero fije una localizaci?n para el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1954 UI/GTK2/src/WorkerThreads.cpp:684
-#: UI/GTK2/src/WorkerThreads.cpp:1526
+#: UI/GTK2/src/mainWindow.cc:1940 UI/GTK2/src/WorkerThreads.cpp:675
+#: UI/GTK2/src/WorkerThreads.cpp:1519
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1958 UI/GTK2/src/WorkerThreads.cpp:688
-#: UI/GTK2/src/WorkerThreads.cpp:1530
+#: UI/GTK2/src/mainWindow.cc:1944 UI/GTK2/src/WorkerThreads.cpp:679
+#: UI/GTK2/src/WorkerThreads.cpp:1523
 msgid "doesn't exist"
 msgstr "no existe"
 
-#: UI/GTK2/src/mainWindow.cc:2102
+#: UI/GTK2/src/mainWindow.cc:2088
 msgid "Remove this document from the index ?"
 msgstr "?Borrar este documento del ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2121
+#: UI/GTK2/src/mainWindow.cc:2107
 msgid "Remove these documents from the index ?"
 msgstr "?Borrar este documento del ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2165
+#: UI/GTK2/src/mainWindow.cc:2151
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Una herramienta metabuscador para el escritorio libre"
 
-#: UI/GTK2/src/mainWindow.cc:2166
+#: UI/GTK2/src/mainWindow.cc:2152
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2210
+#: UI/GTK2/src/mainWindow.cc:2196
 msgid "Index name"
 msgstr "Nombre del ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2225
+#: UI/GTK2/src/mainWindow.cc:2211
 msgid "Couldn't add index"
 msgstr "No se pudo a?adir el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2239
+#: UI/GTK2/src/mainWindow.cc:2225
 msgid "Added new index"
 msgstr "A?adido un nuevo ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2274
+#: UI/GTK2/src/mainWindow.cc:2260
 msgid "Couldn't remove index"
 msgstr "No se pudo borrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2539
+#: UI/GTK2/src/mainWindow.cc:2525
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Al menos una tarea no ha finalizado. ?Parar ahora?"
 
-#: UI/GTK2/src/mainWindow.cc:2721
+#: UI/GTK2/src/mainWindow.cc:2707
 msgid "Query name"
 msgstr "Nombre la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2748
+#: UI/GTK2/src/mainWindow.cc:2734
 msgid "Couldn't update query"
 msgstr "No se pudo actualizar la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2756
+#: UI/GTK2/src/mainWindow.cc:2742
 msgid "Edited query"
 msgstr "B?squeda editada"
 
-#: UI/GTK2/src/mainWindow.cc:2763
+#: UI/GTK2/src/mainWindow.cc:2749
 msgid "Couldn't add query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2771
+#: UI/GTK2/src/mainWindow.cc:2757
 msgid "Added new query"
 msgstr "A?adida una nueva b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2784
+#: UI/GTK2/src/mainWindow.cc:2770
 msgid "Query is not set"
 msgstr "B?squeda no definida"
 
-#: UI/GTK2/src/mainWindow.cc:2795
+#: UI/GTK2/src/mainWindow.cc:2781
 msgid "No search engine selected"
 msgstr "Motor de b?squeda no seleccionado"
 
-#: UI/GTK2/src/mainWindow.cc:2877
+#: UI/GTK2/src/mainWindow.cc:2863
 msgid "Please set the Google API key first"
 msgstr "Por favor, primero configure el API de Google"
 
-#: UI/GTK2/src/mainWindow.cc:2886
+#: UI/GTK2/src/mainWindow.cc:2872
 msgid "Running query"
 msgstr "Ejecutando la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:3060
+#: UI/GTK2/src/mainWindow.cc:3044
 msgid "No default application defined for type"
 msgstr "No hay aplicaci?n predefinida para el tipo"
 
@@ -415,63 +415,63 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:699
+#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
 msgid "Unknown"
 msgstr "Desconocido"
 
-#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:700
+#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
 msgid "Danish"
 msgstr "Dan?s"
 
-#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:701
+#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
 msgid "Dutch"
 msgstr "Holand?s"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
 msgid "English"
 msgstr "Ingl?s"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
 msgid "Finnish"
 msgstr "Finland?s"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
 msgid "French"
 msgstr "Franc?s"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
 msgid "German"
 msgstr "Alem?n"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
 msgid "Italian"
 msgstr "Italiano"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
 msgid "Norwegian"
 msgstr "Noruego"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:712
 msgid "Russian"
 msgstr "Ruso"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:713
 msgid "Spanish"
 msgstr "Espa?ol"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:714
 msgid "Swedish"
 msgstr "Sueco"
 
-#: UI/GTK2/src/pinot.cc:206
+#: UI/GTK2/src/pinot.cc:209
 msgid "Couldn't open index"
 msgstr "No se pudo abrir el ?ndice"
 
-#: UI/GTK2/src/pinot.cc:222
+#: UI/GTK2/src/pinot.cc:225
 msgid "Couldn't create history database"
 msgstr "No se pudo crear la base de datos del hist?rico"
 
@@ -652,81 +652,81 @@
 msgid "Extract"
 msgstr "Extra?dos"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322
+#: UI/GTK2/src/WorkerThreads.cpp:325
 msgid "Can't index mail here"
 msgstr "No se pudo indizar el buzon de correo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:343
+#: UI/GTK2/src/WorkerThreads.cpp:346
 msgid "is already being indexed"
 msgstr "ya est? indizado"
 
-#: UI/GTK2/src/WorkerThreads.cpp:353
+#: UI/GTK2/src/WorkerThreads.cpp:356
 msgid "is blacklisted"
 msgstr "ya excluido"
 
-#: UI/GTK2/src/WorkerThreads.cpp:361 UI/GTK2/src/WorkerThreads.cpp:697
-#: UI/GTK2/src/WorkerThreads.cpp:972 UI/GTK2/src/WorkerThreads.cpp:981
-#: UI/GTK2/src/WorkerThreads.cpp:1150 UI/GTK2/src/WorkerThreads.cpp:1406
-#: UI/GTK2/src/WorkerThreads.cpp:1539
+#: UI/GTK2/src/WorkerThreads.cpp:364 UI/GTK2/src/WorkerThreads.cpp:688
+#: UI/GTK2/src/WorkerThreads.cpp:965 UI/GTK2/src/WorkerThreads.cpp:974
+#: UI/GTK2/src/WorkerThreads.cpp:1143 UI/GTK2/src/WorkerThreads.cpp:1399
+#: UI/GTK2/src/WorkerThreads.cpp:1532
 msgid "Index error on"
 msgstr "Error en el ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816 UI/GTK2/src/WorkerThreads.cpp:916
+#: UI/GTK2/src/WorkerThreads.cpp:809 UI/GTK2/src/WorkerThreads.cpp:909
 msgid "Couldn't create search engine"
 msgstr "No se pudo crear el motor de b?squeda"
 
-#: UI/GTK2/src/WorkerThreads.cpp:828 UI/GTK2/src/WorkerThreads.cpp:930
+#: UI/GTK2/src/WorkerThreads.cpp:821 UI/GTK2/src/WorkerThreads.cpp:923
 msgid "Couldn't run query on search engine"
 msgstr "No se pudo ejecutar la b?squeda contra el motor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:844
+#: UI/GTK2/src/WorkerThreads.cpp:837
 msgid "No title"
 msgstr "Sin t?tulo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1060
+#: UI/GTK2/src/WorkerThreads.cpp:1053
 msgid "Couldn't obtain downloader for protocol"
 msgstr "No se pudo usar un recuperador para el protocolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1071
+#: UI/GTK2/src/WorkerThreads.cpp:1064
 msgid "Couldn't retrieve"
 msgstr "No se pudo descargar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1174 UI/GTK2/src/WorkerThreads.cpp:1241
+#: UI/GTK2/src/WorkerThreads.cpp:1167 UI/GTK2/src/WorkerThreads.cpp:1234
 msgid "Cannot index document type"
 msgstr "No se pudo indizar el tipo de documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1178 UI/GTK2/src/WorkerThreads.cpp:1245
+#: UI/GTK2/src/WorkerThreads.cpp:1171 UI/GTK2/src/WorkerThreads.cpp:1238
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1267
+#: UI/GTK2/src/WorkerThreads.cpp:1260
 msgid "Couldn't tokenize"
 msgstr "No se pudo extraer cadenas"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1287
+#: UI/GTK2/src/WorkerThreads.cpp:1280
 msgid "Robots META tag forbids indexing"
 msgstr "La etiqueta META Robots proh?be la indizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1336
+#: UI/GTK2/src/WorkerThreads.cpp:1329
 msgid "Couldn't index"
 msgstr "No se pudo indizar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1417
+#: UI/GTK2/src/WorkerThreads.cpp:1410
 msgid "Couldn't unindex document(s)"
 msgstr "No se pudo des-indizar lo(s) documento(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1551
+#: UI/GTK2/src/WorkerThreads.cpp:1544
 msgid "Couldn't update document"
 msgstr "No se pudo actualizar el documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1741
+#: UI/GTK2/src/WorkerThreads.cpp:1734
 msgid "No monitoring handler"
 msgstr "No hay monitorizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1783
+#: UI/GTK2/src/WorkerThreads.cpp:1776
 msgid "Couldn't initialize file monitor"
 msgstr "No se puede inicializar el monitor de archivo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:2087
+#: UI/GTK2/src/WorkerThreads.cpp:2080
 msgid "Couldn't open directory"
 msgstr "No se pudo abrir el directorio"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2006-12-05 10:33:24 UTC (rev 621)
+++ trunk/po/fr.po	2006-12-05 10:42:17 UTC (rev 622)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.64\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-12-02 11:47+0800\n"
+"POT-Creation-Date: 2006-12-04 22:28+0800\n"
 "PO-Revision-Date: 2006-11-29 15:09+0000\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: fr <fabricecolin at users.berlios.de>\n"
@@ -27,9 +27,9 @@
 
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
 #: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
-#: UI/GTK2/src/mainWindow.cc:1148 UI/GTK2/src/mainWindow.cc:1191
-#: UI/GTK2/src/mainWindow.cc:1211 UI/GTK2/src/mainWindow.cc:1242
-#: UI/GTK2/src/mainWindow.cc:1831 UI/GTK2/src/PinotSettings.cpp:235
+#: UI/GTK2/src/mainWindow.cc:1153 UI/GTK2/src/mainWindow.cc:1196
+#: UI/GTK2/src/mainWindow.cc:1216 UI/GTK2/src/mainWindow.cc:1247
+#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/PinotSettings.cpp:235
 #: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
 msgid "My Web Pages"
 msgstr "Mes Pages Web"
@@ -159,166 +159,166 @@
 msgid "Document location is"
 msgstr "Le chemin du document is"
 
-#: UI/GTK2/src/mainWindow.cc:873
+#: UI/GTK2/src/mainWindow.cc:878
 msgid "Showing"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:878
+#: UI/GTK2/src/mainWindow.cc:883
 msgid "of"
 msgstr "documents,"
 
-#: UI/GTK2/src/mainWindow.cc:883
+#: UI/GTK2/src/mainWindow.cc:888
 msgid "documents, starting at"
 msgstr "au total, a partir de"
 
-#: UI/GTK2/src/mainWindow.cc:916
+#: UI/GTK2/src/mainWindow.cc:921
 msgid "Query"
 msgstr "La recherche"
 
-#: UI/GTK2/src/mainWindow.cc:920 UI/GTK2/src/mainWindow.cc:2890
+#: UI/GTK2/src/mainWindow.cc:925 UI/GTK2/src/mainWindow.cc:2876
 msgid "on"
 msgstr "sur"
 
-#: UI/GTK2/src/mainWindow.cc:924
+#: UI/GTK2/src/mainWindow.cc:929
 msgid "ended"
 msgstr "est terminee"
 
-#: UI/GTK2/src/mainWindow.cc:1013
+#: UI/GTK2/src/mainWindow.cc:1018
 msgid "More Like"
 msgstr "Similaire a"
 
-#: UI/GTK2/src/mainWindow.cc:1074
+#: UI/GTK2/src/mainWindow.cc:1079
 msgid "Updated label(s)"
 msgstr "Mis a jour l(es) etiquette(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1158
+#: UI/GTK2/src/mainWindow.cc:1163
 msgid "Updated document"
 msgstr "Mis a jour le document"
 
-#: UI/GTK2/src/mainWindow.cc:1171
+#: UI/GTK2/src/mainWindow.cc:1176
 msgid "Indexed"
 msgstr "Indexe"
 
-#: UI/GTK2/src/mainWindow.cc:1212
+#: UI/GTK2/src/mainWindow.cc:1217
 msgid "Unindexed document(s)"
 msgstr "Desindexe le(s) document(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1258
 msgid "Updated document properties"
 msgstr "Mis a jour les proprietes du document"
 
-#: UI/GTK2/src/mainWindow.cc:1300
+#: UI/GTK2/src/mainWindow.cc:1305
 msgid "Couldn't rename index, name"
 msgstr "N'a pas pu renommer l'index, le nom"
 
-#: UI/GTK2/src/mainWindow.cc:1304 UI/GTK2/src/mainWindow.cc:2214
-#: UI/GTK2/src/mainWindow.cc:2725
+#: UI/GTK2/src/mainWindow.cc:1309 UI/GTK2/src/mainWindow.cc:2200
+#: UI/GTK2/src/mainWindow.cc:2711
 msgid "is already in use"
 msgstr "est deja utilise"
 
-#: UI/GTK2/src/mainWindow.cc:1317
+#: UI/GTK2/src/mainWindow.cc:1322
 msgid "Couldn't rename index"
 msgstr "N'a pas pu renommer l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1330
+#: UI/GTK2/src/mainWindow.cc:1335
 msgid "Edited index"
 msgstr "Edite l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1709 UI/GTK2/src/mainWindow.cc:2384
+#: UI/GTK2/src/mainWindow.cc:1695 UI/GTK2/src/mainWindow.cc:2370
 msgid "Live query"
 msgstr "Recherche"
 
-#: UI/GTK2/src/mainWindow.cc:1735
+#: UI/GTK2/src/mainWindow.cc:1721
 msgid "Couldn't find query"
 msgstr "N'a pas pu trouver"
 
-#: UI/GTK2/src/mainWindow.cc:1779 UI/GTK2/src/mainWindow.cc:1875
+#: UI/GTK2/src/mainWindow.cc:1765 UI/GTK2/src/mainWindow.cc:1861
 msgid "Please set a location for the index first"
 msgstr "Donnez un chemin a l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1954 UI/GTK2/src/WorkerThreads.cpp:684
-#: UI/GTK2/src/WorkerThreads.cpp:1526
+#: UI/GTK2/src/mainWindow.cc:1940 UI/GTK2/src/WorkerThreads.cpp:675
+#: UI/GTK2/src/WorkerThreads.cpp:1519
 msgid "Index"
 msgstr "L'index"
 
-#: UI/GTK2/src/mainWindow.cc:1958 UI/GTK2/src/WorkerThreads.cpp:688
-#: UI/GTK2/src/WorkerThreads.cpp:1530
+#: UI/GTK2/src/mainWindow.cc:1944 UI/GTK2/src/WorkerThreads.cpp:679
+#: UI/GTK2/src/WorkerThreads.cpp:1523
 msgid "doesn't exist"
 msgstr "n'existe pas"
 
-#: UI/GTK2/src/mainWindow.cc:2102
+#: UI/GTK2/src/mainWindow.cc:2088
 msgid "Remove this document from the index ?"
 msgstr "Enlever ce document de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2121
+#: UI/GTK2/src/mainWindow.cc:2107
 msgid "Remove these documents from the index ?"
 msgstr "Enlever ces documents de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2165
+#: UI/GTK2/src/mainWindow.cc:2151
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Un outil de recherche pour le Bureau Libre"
 
-#: UI/GTK2/src/mainWindow.cc:2166
+#: UI/GTK2/src/mainWindow.cc:2152
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2210
+#: UI/GTK2/src/mainWindow.cc:2196
 msgid "Index name"
 msgstr "Nom de l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2225
+#: UI/GTK2/src/mainWindow.cc:2211
 msgid "Couldn't add index"
 msgstr "N'a pas pu ajouter l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2239
+#: UI/GTK2/src/mainWindow.cc:2225
 msgid "Added new index"
 msgstr "Ajoute un nouvel index"
 
-#: UI/GTK2/src/mainWindow.cc:2274
+#: UI/GTK2/src/mainWindow.cc:2260
 msgid "Couldn't remove index"
 msgstr "N'a pas pu enlever l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2539
+#: UI/GTK2/src/mainWindow.cc:2525
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Au moins une tache n'est pas terminee. Quitter maintenant ?"
 
-#: UI/GTK2/src/mainWindow.cc:2721
+#: UI/GTK2/src/mainWindow.cc:2707
 msgid "Query name"
 msgstr "Nom de la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2748
+#: UI/GTK2/src/mainWindow.cc:2734
 msgid "Couldn't update query"
 msgstr "N'a pas pu mettre a jour la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2756
+#: UI/GTK2/src/mainWindow.cc:2742
 msgid "Edited query"
 msgstr "Edite la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2763
+#: UI/GTK2/src/mainWindow.cc:2749
 msgid "Couldn't add query"
 msgstr "N'a pas pu ajouter la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2771
+#: UI/GTK2/src/mainWindow.cc:2757
 msgid "Added new query"
 msgstr "Ajoute une nouvelle recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2784
+#: UI/GTK2/src/mainWindow.cc:2770
 msgid "Query is not set"
 msgstr "Recherche indefinie"
 
-#: UI/GTK2/src/mainWindow.cc:2795
+#: UI/GTK2/src/mainWindow.cc:2781
 msgid "No search engine selected"
 msgstr "Pas de moteur selectionne"
 
-#: UI/GTK2/src/mainWindow.cc:2877
+#: UI/GTK2/src/mainWindow.cc:2863
 msgid "Please set the Google API key first"
 msgstr "Configurez la clef de l'API Google"
 
-#: UI/GTK2/src/mainWindow.cc:2886
+#: UI/GTK2/src/mainWindow.cc:2872
 msgid "Running query"
 msgstr "Recherche en cours"
 
-#: UI/GTK2/src/mainWindow.cc:3060
+#: UI/GTK2/src/mainWindow.cc:3044
 msgid "No default application defined for type"
 msgstr "Pas d'application definie pour le type"
 
@@ -415,63 +415,63 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:699
+#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
 msgid "Unknown"
 msgstr "Inconnu"
 
-#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:700
+#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
 msgid "Danish"
 msgstr "Danois"
 
-#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:701
+#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
 msgid "Dutch"
 msgstr "Hollandais"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
 msgid "English"
 msgstr "Anglais"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
 msgid "Finnish"
 msgstr "Finlandais"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
 msgid "French"
 msgstr "Francais"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
 msgid "German"
 msgstr "Allemand"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
 msgid "Italian"
 msgstr "Italien"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
 msgid "Norwegian"
 msgstr "Norvegien"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
 msgid "Portuguese"
 msgstr "Portugais"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:712
 msgid "Russian"
 msgstr "Russe"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:713
 msgid "Spanish"
 msgstr "Espagnol"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:714
 msgid "Swedish"
 msgstr "Suedois"
 
-#: UI/GTK2/src/pinot.cc:206
+#: UI/GTK2/src/pinot.cc:209
 msgid "Couldn't open index"
 msgstr "N'a pas pu ouvrir l'index"
 
-#: UI/GTK2/src/pinot.cc:222
+#: UI/GTK2/src/pinot.cc:225
 msgid "Couldn't create history database"
 msgstr "N'a pas pu creer la base d'historiques"
 
@@ -652,81 +652,81 @@
 msgid "Extract"
 msgstr "Extrait"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322
+#: UI/GTK2/src/WorkerThreads.cpp:325
 msgid "Can't index mail here"
 msgstr "Ne peut pas indexer le courrier ici"
 
-#: UI/GTK2/src/WorkerThreads.cpp:343
+#: UI/GTK2/src/WorkerThreads.cpp:346
 msgid "is already being indexed"
 msgstr "est deja indexe"
 
-#: UI/GTK2/src/WorkerThreads.cpp:353
+#: UI/GTK2/src/WorkerThreads.cpp:356
 msgid "is blacklisted"
 msgstr "est exclus"
 
-#: UI/GTK2/src/WorkerThreads.cpp:361 UI/GTK2/src/WorkerThreads.cpp:697
-#: UI/GTK2/src/WorkerThreads.cpp:972 UI/GTK2/src/WorkerThreads.cpp:981
-#: UI/GTK2/src/WorkerThreads.cpp:1150 UI/GTK2/src/WorkerThreads.cpp:1406
-#: UI/GTK2/src/WorkerThreads.cpp:1539
+#: UI/GTK2/src/WorkerThreads.cpp:364 UI/GTK2/src/WorkerThreads.cpp:688
+#: UI/GTK2/src/WorkerThreads.cpp:965 UI/GTK2/src/WorkerThreads.cpp:974
+#: UI/GTK2/src/WorkerThreads.cpp:1143 UI/GTK2/src/WorkerThreads.cpp:1399
+#: UI/GTK2/src/WorkerThreads.cpp:1532
 msgid "Index error on"
 msgstr "Erreur sur l'index"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816 UI/GTK2/src/WorkerThreads.cpp:916
+#: UI/GTK2/src/WorkerThreads.cpp:809 UI/GTK2/src/WorkerThreads.cpp:909
 msgid "Couldn't create search engine"
 msgstr "N'a pas pu creer le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:828 UI/GTK2/src/WorkerThreads.cpp:930
+#: UI/GTK2/src/WorkerThreads.cpp:821 UI/GTK2/src/WorkerThreads.cpp:923
 msgid "Couldn't run query on search engine"
 msgstr "N'a pas pu lancer la recherche sur le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:844
+#: UI/GTK2/src/WorkerThreads.cpp:837
 msgid "No title"
 msgstr "Pas de titre"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1060
+#: UI/GTK2/src/WorkerThreads.cpp:1053
 msgid "Couldn't obtain downloader for protocol"
 msgstr "N'a pas pu obtenir un brouteur pour"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1071
+#: UI/GTK2/src/WorkerThreads.cpp:1064
 msgid "Couldn't retrieve"
 msgstr "N'a pas pu telecharger"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1174 UI/GTK2/src/WorkerThreads.cpp:1241
+#: UI/GTK2/src/WorkerThreads.cpp:1167 UI/GTK2/src/WorkerThreads.cpp:1234
 msgid "Cannot index document type"
 msgstr "Impossible d'indexer ce type de documents"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1178 UI/GTK2/src/WorkerThreads.cpp:1245
+#: UI/GTK2/src/WorkerThreads.cpp:1171 UI/GTK2/src/WorkerThreads.cpp:1238
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1267
+#: UI/GTK2/src/WorkerThreads.cpp:1260
 msgid "Couldn't tokenize"
 msgstr "N'a pas pu extraire les termes de"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1287
+#: UI/GTK2/src/WorkerThreads.cpp:1280
 msgid "Robots META tag forbids indexing"
 msgstr "Le META tag Robots interdit d'indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1336
+#: UI/GTK2/src/WorkerThreads.cpp:1329
 msgid "Couldn't index"
 msgstr "N'a pas pu indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1417
+#: UI/GTK2/src/WorkerThreads.cpp:1410
 msgid "Couldn't unindex document(s)"
 msgstr "N'a pas pu desindexer le(s) document(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1551
+#: UI/GTK2/src/WorkerThreads.cpp:1544
 msgid "Couldn't update document"
 msgstr "N'a pas pu mettre a jour le document"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1741
+#: UI/GTK2/src/WorkerThreads.cpp:1734
 msgid "No monitoring handler"
 msgstr "Pas de moniteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1783
+#: UI/GTK2/src/WorkerThreads.cpp:1776
 msgid "Couldn't initialize file monitor"
 msgstr "N'a pas pu initializer le moniteur de fichiers"
 
-#: UI/GTK2/src/WorkerThreads.cpp:2087
+#: UI/GTK2/src/WorkerThreads.cpp:2080
 msgid "Couldn't open directory"
 msgstr "N'a pas pu ouvrir le repertoire"

Modified: trunk/po/nl.po
===================================================================
--- trunk/po/nl.po	2006-12-05 10:33:24 UTC (rev 621)
+++ trunk/po/nl.po	2006-12-05 10:42:17 UTC (rev 622)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.64\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-11-29 21:01+0800\n"
+"POT-Creation-Date: 2006-12-04 22:28+0800\n"
 "PO-Revision-Date: 2006-12-03 15:13+0000\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: Dutch <nl at li.org>\n"
@@ -27,9 +27,9 @@
 
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
 #: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
-#: UI/GTK2/src/mainWindow.cc:1148 UI/GTK2/src/mainWindow.cc:1191
-#: UI/GTK2/src/mainWindow.cc:1211 UI/GTK2/src/mainWindow.cc:1242
-#: UI/GTK2/src/mainWindow.cc:1831 UI/GTK2/src/PinotSettings.cpp:235
+#: UI/GTK2/src/mainWindow.cc:1153 UI/GTK2/src/mainWindow.cc:1196
+#: UI/GTK2/src/mainWindow.cc:1216 UI/GTK2/src/mainWindow.cc:1247
+#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/PinotSettings.cpp:235
 #: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
 msgid "My Web Pages"
 msgstr "Mijn webpagina's"
@@ -160,167 +160,167 @@
 msgid "Document location is"
 msgstr "Documentlocatie is"
 
-#: UI/GTK2/src/mainWindow.cc:873
+#: UI/GTK2/src/mainWindow.cc:878
 msgid "Showing"
 msgstr "Aan het tonen"
 
-#: UI/GTK2/src/mainWindow.cc:878
+#: UI/GTK2/src/mainWindow.cc:883
 msgid "of"
 msgstr "van"
 
-#: UI/GTK2/src/mainWindow.cc:883
+#: UI/GTK2/src/mainWindow.cc:888
 msgid "documents, starting at"
 msgstr "documenten, beginnend bij"
 
-#: UI/GTK2/src/mainWindow.cc:916
+#: UI/GTK2/src/mainWindow.cc:921
 msgid "Query"
 msgstr "Query"
 
-#: UI/GTK2/src/mainWindow.cc:920 UI/GTK2/src/mainWindow.cc:2890
+#: UI/GTK2/src/mainWindow.cc:925 UI/GTK2/src/mainWindow.cc:2876
 msgid "on"
 msgstr "op"
 
-#: UI/GTK2/src/mainWindow.cc:924
+#: UI/GTK2/src/mainWindow.cc:929
 msgid "ended"
 msgstr "Beeindigd"
 
-#: UI/GTK2/src/mainWindow.cc:1013
+#: UI/GTK2/src/mainWindow.cc:1018
 msgid "More Like"
 msgstr "Meer zoals"
 
-#: UI/GTK2/src/mainWindow.cc:1074
+#: UI/GTK2/src/mainWindow.cc:1079
 msgid "Updated label(s)"
 msgstr "Vernieuwde na(a)m(en)"
 
-#: UI/GTK2/src/mainWindow.cc:1158
+#: UI/GTK2/src/mainWindow.cc:1163
 msgid "Updated document"
 msgstr "Vernieuwd document"
 
-#: UI/GTK2/src/mainWindow.cc:1171
+#: UI/GTK2/src/mainWindow.cc:1176
 msgid "Indexed"
 msgstr "Geindexeerd"
 
-#: UI/GTK2/src/mainWindow.cc:1212
+#: UI/GTK2/src/mainWindow.cc:1217
 msgid "Unindexed document(s)"
 msgstr "Niet geindexeerd(e) document(en)"
 
-#: UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1258
 msgid "Updated document properties"
 msgstr "Vernieuwde documenteigenschappen"
 
-#: UI/GTK2/src/mainWindow.cc:1300
+#: UI/GTK2/src/mainWindow.cc:1305
 msgid "Couldn't rename index, name"
 msgstr "Kon index niet hernoemen, naam"
 
-#: UI/GTK2/src/mainWindow.cc:1304 UI/GTK2/src/mainWindow.cc:2214
-#: UI/GTK2/src/mainWindow.cc:2725
+#: UI/GTK2/src/mainWindow.cc:1309 UI/GTK2/src/mainWindow.cc:2200
+#: UI/GTK2/src/mainWindow.cc:2711
 msgid "is already in use"
 msgstr "is reeds in gebruik"
 
-#: UI/GTK2/src/mainWindow.cc:1317
+#: UI/GTK2/src/mainWindow.cc:1322
 msgid "Couldn't rename index"
 msgstr "Kon index niet hernoemen"
 
-#: UI/GTK2/src/mainWindow.cc:1330
+#: UI/GTK2/src/mainWindow.cc:1335
 msgid "Edited index"
 msgstr "Bewerkte index"
 
-#: UI/GTK2/src/mainWindow.cc:1709 UI/GTK2/src/mainWindow.cc:2384
+#: UI/GTK2/src/mainWindow.cc:1695 UI/GTK2/src/mainWindow.cc:2370
 msgid "Live query"
 msgstr "Rechtstreekse query"
 
-#: UI/GTK2/src/mainWindow.cc:1735
+#: UI/GTK2/src/mainWindow.cc:1721
 msgid "Couldn't find query"
 msgstr "Kon query niet vinden"
 
-#: UI/GTK2/src/mainWindow.cc:1779 UI/GTK2/src/mainWindow.cc:1875
+#: UI/GTK2/src/mainWindow.cc:1765 UI/GTK2/src/mainWindow.cc:1861
 msgid "Please set a location for the index first"
 msgstr "Geef aub eerst een bestemming voor de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:1954 UI/GTK2/src/WorkerThreads.cpp:680
-#: UI/GTK2/src/WorkerThreads.cpp:1499
+#: UI/GTK2/src/mainWindow.cc:1940 UI/GTK2/src/WorkerThreads.cpp:675
+#: UI/GTK2/src/WorkerThreads.cpp:1519
 msgid "Index"
 msgstr "Inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:1958 UI/GTK2/src/WorkerThreads.cpp:684
-#: UI/GTK2/src/WorkerThreads.cpp:1503
+#: UI/GTK2/src/mainWindow.cc:1944 UI/GTK2/src/WorkerThreads.cpp:679
+#: UI/GTK2/src/WorkerThreads.cpp:1523
 msgid "doesn't exist"
 msgstr "bestaat niet"
 
-#: UI/GTK2/src/mainWindow.cc:2102
+#: UI/GTK2/src/mainWindow.cc:2088
 msgid "Remove this document from the index ?"
 msgstr "Verwijder dit document uit de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2121
+#: UI/GTK2/src/mainWindow.cc:2107
 msgid "Remove these documents from the index ?"
 msgstr "Verwijder deze documenten uit de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2165
+#: UI/GTK2/src/mainWindow.cc:2151
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Een metazoek tool voor de Free Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2166
+#: UI/GTK2/src/mainWindow.cc:2152
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2210
+#: UI/GTK2/src/mainWindow.cc:2196
 msgid "Index name"
 msgstr "Naam inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2225
+#: UI/GTK2/src/mainWindow.cc:2211
 msgid "Couldn't add index"
 msgstr "Kon inhoudsopgave niet toevoegen"
 
-#: UI/GTK2/src/mainWindow.cc:2239
+#: UI/GTK2/src/mainWindow.cc:2225
 msgid "Added new index"
 msgstr "Nieuwe inhoudsopgave toegevoegd"
 
-#: UI/GTK2/src/mainWindow.cc:2274
+#: UI/GTK2/src/mainWindow.cc:2260
 msgid "Couldn't remove index"
 msgstr "Kon inhoudsopgave niet verwijderen"
 
-#: UI/GTK2/src/mainWindow.cc:2539
+#: UI/GTK2/src/mainWindow.cc:2525
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Tenminste een taak is nog niet gereed. Nu stoppen?"
 
-#: UI/GTK2/src/mainWindow.cc:2721
+#: UI/GTK2/src/mainWindow.cc:2707
 msgid "Query name"
 msgstr "Naam query"
 
-#: UI/GTK2/src/mainWindow.cc:2748
+#: UI/GTK2/src/mainWindow.cc:2734
 msgid "Couldn't update query"
 msgstr "Kon query niet actualiseren"
 
-#: UI/GTK2/src/mainWindow.cc:2756
+#: UI/GTK2/src/mainWindow.cc:2742
 msgid "Edited query"
 msgstr "Bewerkte query"
 
-#: UI/GTK2/src/mainWindow.cc:2763
+#: UI/GTK2/src/mainWindow.cc:2749
 msgid "Couldn't add query"
 msgstr "Kon query niet toevoegen"
 
-#: UI/GTK2/src/mainWindow.cc:2771
+#: UI/GTK2/src/mainWindow.cc:2757
 msgid "Added new query"
 msgstr "Nieuwe query toegevoegd"
 
-#: UI/GTK2/src/mainWindow.cc:2784
+#: UI/GTK2/src/mainWindow.cc:2770
 #, fuzzy
 msgid "Query is not set"
 msgstr "Query niet vastgelegd"
 
-#: UI/GTK2/src/mainWindow.cc:2795
+#: UI/GTK2/src/mainWindow.cc:2781
 msgid "No search engine selected"
 msgstr "Geen zoekmachine geselecteerd"
 
-#: UI/GTK2/src/mainWindow.cc:2877
+#: UI/GTK2/src/mainWindow.cc:2863
 msgid "Please set the Google API key first"
 msgstr "Geef eerst de Google API sleutel in"
 
-#: UI/GTK2/src/mainWindow.cc:2886
+#: UI/GTK2/src/mainWindow.cc:2872
 msgid "Running query"
 msgstr "Lopende query"
 
-#: UI/GTK2/src/mainWindow.cc:3060
+#: UI/GTK2/src/mainWindow.cc:3044
 msgid "No default application defined for type"
 msgstr "Geen standaard toepassing gedefinieerd voor het type"
 
@@ -417,63 +417,63 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:699
+#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
 msgid "Unknown"
 msgstr "Niet bekend"
 
-#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:700
+#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
 msgid "Danish"
 msgstr "Deens"
 
-#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:701
+#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
 msgid "Dutch"
 msgstr "Nederlands"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
 msgid "English"
 msgstr "Engels"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
 msgid "Finnish"
 msgstr "Fins"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
 msgid "French"
 msgstr "Frans"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
 msgid "German"
 msgstr "Duits"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
 msgid "Italian"
 msgstr "Italiaans"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
 msgid "Norwegian"
 msgstr "Noors"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
 msgid "Portuguese"
 msgstr "Portugees"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:712
 msgid "Russian"
 msgstr "Russisch"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:713
 msgid "Spanish"
 msgstr "Spaans"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:714
 msgid "Swedish"
 msgstr "Zweeds"
 
-#: UI/GTK2/src/pinot.cc:206
+#: UI/GTK2/src/pinot.cc:209
 msgid "Couldn't open index"
 msgstr "Kan index niet openen"
 
-#: UI/GTK2/src/pinot.cc:222
+#: UI/GTK2/src/pinot.cc:225
 msgid "Couldn't create history database"
 msgstr "Kon historische database niet maken"
 
@@ -552,8 +552,7 @@
 
 #: UI/GTK2/src/prefsDialog_glade.cc:77
 msgid "Labels are used to classify indexed documents:"
-msgstr ""
-"Bijschriften worden gebruikt om geindexeerde documenten te klassificeren:"
+msgstr "Bijschriften worden gebruikt om geindexeerde documenten te klassificeren:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:82 UI/GTK2/src/prefsDialog_glade.cc:102
 #: UI/GTK2/src/prefsDialog_glade.cc:115 UI/GTK2/src/prefsDialog_glade.cc:128
@@ -569,8 +568,7 @@
 msgstr "Bijschriften"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:97
-msgid ""
-"These directories will be indexed and optionally monitored for changes:"
+msgid "These directories will be indexed and optionally monitored for changes:"
 msgstr ""
 "Deze directories zullen geindexeerd worden en optioneel bijgewerkt worden "
 "bij veranderingen:"
@@ -660,82 +658,82 @@
 msgid "Extract"
 msgstr "Uitpakken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:318
+#: UI/GTK2/src/WorkerThreads.cpp:325
 msgid "Can't index mail here"
 msgstr "Kan mail hier niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:339
+#: UI/GTK2/src/WorkerThreads.cpp:346
 msgid "is already being indexed"
 msgstr "wordt al geindexeerd"
 
-#: UI/GTK2/src/WorkerThreads.cpp:349
+#: UI/GTK2/src/WorkerThreads.cpp:356
 msgid "is blacklisted"
 msgstr "staat op blacklist"
 
-#: UI/GTK2/src/WorkerThreads.cpp:357 UI/GTK2/src/WorkerThreads.cpp:693
-#: UI/GTK2/src/WorkerThreads.cpp:968 UI/GTK2/src/WorkerThreads.cpp:977
-#: UI/GTK2/src/WorkerThreads.cpp:1146 UI/GTK2/src/WorkerThreads.cpp:1388
-#: UI/GTK2/src/WorkerThreads.cpp:1512
+#: UI/GTK2/src/WorkerThreads.cpp:364 UI/GTK2/src/WorkerThreads.cpp:688
+#: UI/GTK2/src/WorkerThreads.cpp:965 UI/GTK2/src/WorkerThreads.cpp:974
+#: UI/GTK2/src/WorkerThreads.cpp:1143 UI/GTK2/src/WorkerThreads.cpp:1399
+#: UI/GTK2/src/WorkerThreads.cpp:1532
 msgid "Index error on"
 msgstr "Indexeringsfout op"
 
-#: UI/GTK2/src/WorkerThreads.cpp:812 UI/GTK2/src/WorkerThreads.cpp:912
+#: UI/GTK2/src/WorkerThreads.cpp:809 UI/GTK2/src/WorkerThreads.cpp:909
 msgid "Couldn't create search engine"
 msgstr "Kon zoekmachine niet maken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:824 UI/GTK2/src/WorkerThreads.cpp:926
+#: UI/GTK2/src/WorkerThreads.cpp:821 UI/GTK2/src/WorkerThreads.cpp:923
 msgid "Couldn't run query on search engine"
 msgstr "Kon query niet uitvoeren op zoekmachine"
 
-#: UI/GTK2/src/WorkerThreads.cpp:840
+#: UI/GTK2/src/WorkerThreads.cpp:837
 msgid "No title"
 msgstr "Geen titel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1056
+#: UI/GTK2/src/WorkerThreads.cpp:1053
 msgid "Couldn't obtain downloader for protocol"
 msgstr "Kon geen downloader verkrijgen voor protocol"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1067
+#: UI/GTK2/src/WorkerThreads.cpp:1064
 msgid "Couldn't retrieve"
 msgstr "Kon niet opzoeken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1170 UI/GTK2/src/WorkerThreads.cpp:1237
+#: UI/GTK2/src/WorkerThreads.cpp:1167 UI/GTK2/src/WorkerThreads.cpp:1234
 msgid "Cannot index document type"
 msgstr "Kan documenttype niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1174 UI/GTK2/src/WorkerThreads.cpp:1241
+#: UI/GTK2/src/WorkerThreads.cpp:1171 UI/GTK2/src/WorkerThreads.cpp:1238
 msgid "at"
 msgstr "bij"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1263
+#: UI/GTK2/src/WorkerThreads.cpp:1260
 #, fuzzy
 msgid "Couldn't tokenize"
 msgstr "Kon tokens niet toepassen"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1283
+#: UI/GTK2/src/WorkerThreads.cpp:1280
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META taf verbiedt indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1318
+#: UI/GTK2/src/WorkerThreads.cpp:1329
 msgid "Couldn't index"
 msgstr "Kon niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1399
+#: UI/GTK2/src/WorkerThreads.cpp:1410
 msgid "Couldn't unindex document(s)"
 msgstr "Kan indexering van bestand(en) niet ongedaan maken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1524
+#: UI/GTK2/src/WorkerThreads.cpp:1544
 msgid "Couldn't update document"
 msgstr "Kan document niet actualiseren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1714
+#: UI/GTK2/src/WorkerThreads.cpp:1734
 msgid "No monitoring handler"
 msgstr "Geen monitoring handler"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1756
+#: UI/GTK2/src/WorkerThreads.cpp:1776
 msgid "Couldn't initialize file monitor"
 msgstr "Kan bestandsmonitor niet initialiseren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:2060
+#: UI/GTK2/src/WorkerThreads.cpp:2080
 msgid "Couldn't open directory"
 msgstr "Kan map niet openen"

Modified: trunk/po/sv.po
===================================================================
--- trunk/po/sv.po	2006-12-05 10:33:24 UTC (rev 621)
+++ trunk/po/sv.po	2006-12-05 10:42:17 UTC (rev 622)
@@ -7,8 +7,8 @@
 msgid ""
 msgstr ""
 "Project-Id-Version: pinot\n"
-"Report-Msgid-Bugs-To: FULL NAME <EMAIL at ADDRESS>\n"
-"POT-Creation-Date: 2006-11-29 21:01+0800\n"
+"Report-Msgid-Bugs-To: \n"
+"POT-Creation-Date: 2006-12-04 22:28+0800\n"
 "PO-Revision-Date: 2006-12-03 16:44+0000\n"
 "Last-Translator: Daniel Nylander <po at danielnylander.se>\n"
 "Language-Team: Swedish <sv at li.org>\n"
@@ -27,9 +27,9 @@
 
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
 #: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
-#: UI/GTK2/src/mainWindow.cc:1148 UI/GTK2/src/mainWindow.cc:1191
-#: UI/GTK2/src/mainWindow.cc:1211 UI/GTK2/src/mainWindow.cc:1242
-#: UI/GTK2/src/mainWindow.cc:1831 UI/GTK2/src/PinotSettings.cpp:235
+#: UI/GTK2/src/mainWindow.cc:1153 UI/GTK2/src/mainWindow.cc:1196
+#: UI/GTK2/src/mainWindow.cc:1216 UI/GTK2/src/mainWindow.cc:1247
+#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/PinotSettings.cpp:235
 #: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
 msgid "My Web Pages"
 msgstr "Mina webbsidor"
@@ -159,166 +159,166 @@
 msgid "Document location is"
 msgstr "Dokumentplatsen ?r"
 
-#: UI/GTK2/src/mainWindow.cc:873
+#: UI/GTK2/src/mainWindow.cc:878
 msgid "Showing"
 msgstr "Visar"
 
-#: UI/GTK2/src/mainWindow.cc:878
+#: UI/GTK2/src/mainWindow.cc:883
 msgid "of"
 msgstr "av"
 
-#: UI/GTK2/src/mainWindow.cc:883
+#: UI/GTK2/src/mainWindow.cc:888
 msgid "documents, starting at"
 msgstr "dokument, b?rjar med"
 
-#: UI/GTK2/src/mainWindow.cc:916
+#: UI/GTK2/src/mainWindow.cc:921
 msgid "Query"
 msgstr "Fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:920 UI/GTK2/src/mainWindow.cc:2890
+#: UI/GTK2/src/mainWindow.cc:925 UI/GTK2/src/mainWindow.cc:2876
 msgid "on"
 msgstr "p?"
 
-#: UI/GTK2/src/mainWindow.cc:924
+#: UI/GTK2/src/mainWindow.cc:929
 msgid "ended"
 msgstr "slutade"
 
-#: UI/GTK2/src/mainWindow.cc:1013
+#: UI/GTK2/src/mainWindow.cc:1018
 msgid "More Like"
 msgstr "Kanske mer som"
 
-#: UI/GTK2/src/mainWindow.cc:1074
+#: UI/GTK2/src/mainWindow.cc:1079
 msgid "Updated label(s)"
 msgstr "Uppdaterade etikett(er)"
 
-#: UI/GTK2/src/mainWindow.cc:1158
+#: UI/GTK2/src/mainWindow.cc:1163
 msgid "Updated document"
 msgstr "Uppdaterade dokument"
 
-#: UI/GTK2/src/mainWindow.cc:1171
+#: UI/GTK2/src/mainWindow.cc:1176
 msgid "Indexed"
 msgstr "Indexerade"
 
-#: UI/GTK2/src/mainWindow.cc:1212
+#: UI/GTK2/src/mainWindow.cc:1217
 msgid "Unindexed document(s)"
 msgstr "Ej indexerade dokument"
 
-#: UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1258
 msgid "Updated document properties"
 msgstr "Egenskaper f?r uppdaterade dokument"
 
-#: UI/GTK2/src/mainWindow.cc:1300
+#: UI/GTK2/src/mainWindow.cc:1305
 msgid "Couldn't rename index, name"
 msgstr "Kunde inte byta namn p? index, namn"
 
-#: UI/GTK2/src/mainWindow.cc:1304 UI/GTK2/src/mainWindow.cc:2214
-#: UI/GTK2/src/mainWindow.cc:2725
+#: UI/GTK2/src/mainWindow.cc:1309 UI/GTK2/src/mainWindow.cc:2200
+#: UI/GTK2/src/mainWindow.cc:2711
 msgid "is already in use"
 msgstr "anv?nds redan"
 
-#: UI/GTK2/src/mainWindow.cc:1317
+#: UI/GTK2/src/mainWindow.cc:1322
 msgid "Couldn't rename index"
 msgstr "Kunde inte byta namn p? index"
 
-#: UI/GTK2/src/mainWindow.cc:1330
+#: UI/GTK2/src/mainWindow.cc:1335
 msgid "Edited index"
 msgstr "Redigerade index"
 
-#: UI/GTK2/src/mainWindow.cc:1709 UI/GTK2/src/mainWindow.cc:2384
+#: UI/GTK2/src/mainWindow.cc:1695 UI/GTK2/src/mainWindow.cc:2370
 msgid "Live query"
 msgstr "Levande fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:1735
+#: UI/GTK2/src/mainWindow.cc:1721
 msgid "Couldn't find query"
 msgstr "Kunde inte hitta fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:1779 UI/GTK2/src/mainWindow.cc:1875
+#: UI/GTK2/src/mainWindow.cc:1765 UI/GTK2/src/mainWindow.cc:1861
 msgid "Please set a location for the index first"
 msgstr "St?ll in en plats f?r indexet f?rst"
 
-#: UI/GTK2/src/mainWindow.cc:1954 UI/GTK2/src/WorkerThreads.cpp:680
-#: UI/GTK2/src/WorkerThreads.cpp:1499
+#: UI/GTK2/src/mainWindow.cc:1940 UI/GTK2/src/WorkerThreads.cpp:675
+#: UI/GTK2/src/WorkerThreads.cpp:1519
 msgid "Index"
 msgstr "Index"
 
-#: UI/GTK2/src/mainWindow.cc:1958 UI/GTK2/src/WorkerThreads.cpp:684
-#: UI/GTK2/src/WorkerThreads.cpp:1503
+#: UI/GTK2/src/mainWindow.cc:1944 UI/GTK2/src/WorkerThreads.cpp:679
+#: UI/GTK2/src/WorkerThreads.cpp:1523
 msgid "doesn't exist"
 msgstr "finns inte"
 
-#: UI/GTK2/src/mainWindow.cc:2102
+#: UI/GTK2/src/mainWindow.cc:2088
 msgid "Remove this document from the index ?"
 msgstr "Ta bort detta dokument fr?n indexet?"
 
-#: UI/GTK2/src/mainWindow.cc:2121
+#: UI/GTK2/src/mainWindow.cc:2107
 msgid "Remove these documents from the index ?"
 msgstr "Ta bort dessa dokument fr?n indexet?"
 
-#: UI/GTK2/src/mainWindow.cc:2165
+#: UI/GTK2/src/mainWindow.cc:2151
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Ett metas?kningsverktyg f?r Free Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2166
+#: UI/GTK2/src/mainWindow.cc:2152
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "? 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2210
+#: UI/GTK2/src/mainWindow.cc:2196
 msgid "Index name"
 msgstr "Indexnamn"
 
-#: UI/GTK2/src/mainWindow.cc:2225
+#: UI/GTK2/src/mainWindow.cc:2211
 msgid "Couldn't add index"
 msgstr "Kunde inte l?gga till index"
 
-#: UI/GTK2/src/mainWindow.cc:2239
+#: UI/GTK2/src/mainWindow.cc:2225
 msgid "Added new index"
 msgstr "Lade till nytt index"
 
-#: UI/GTK2/src/mainWindow.cc:2274
+#: UI/GTK2/src/mainWindow.cc:2260
 msgid "Couldn't remove index"
 msgstr "Kunde inte ta bort index"
 
-#: UI/GTK2/src/mainWindow.cc:2539
+#: UI/GTK2/src/mainWindow.cc:2525
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "?tminstone en uppgift har inte f?rdigst?llts ?n. Avsluta nu?"
 
-#: UI/GTK2/src/mainWindow.cc:2721
+#: UI/GTK2/src/mainWindow.cc:2707
 msgid "Query name"
 msgstr "Fr?genamn"
 
-#: UI/GTK2/src/mainWindow.cc:2748
+#: UI/GTK2/src/mainWindow.cc:2734
 msgid "Couldn't update query"
 msgstr "Kunde inte uppdatera fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2756
+#: UI/GTK2/src/mainWindow.cc:2742
 msgid "Edited query"
 msgstr "Redigerade fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2763
+#: UI/GTK2/src/mainWindow.cc:2749
 msgid "Couldn't add query"
 msgstr "Kunde inte l?gga till fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2771
+#: UI/GTK2/src/mainWindow.cc:2757
 msgid "Added new query"
 msgstr "Lade till ny fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2784
+#: UI/GTK2/src/mainWindow.cc:2770
 msgid "Query is not set"
 msgstr "Fr?gan ?r inte inst?lld"
 
-#: UI/GTK2/src/mainWindow.cc:2795
+#: UI/GTK2/src/mainWindow.cc:2781
 msgid "No search engine selected"
 msgstr "Ingen s?kmotor vald"
 
-#: UI/GTK2/src/mainWindow.cc:2877
+#: UI/GTK2/src/mainWindow.cc:2863
 msgid "Please set the Google API key first"
 msgstr "St?ll in Google API-nyckeln f?rst"
 
-#: UI/GTK2/src/mainWindow.cc:2886
+#: UI/GTK2/src/mainWindow.cc:2872
 msgid "Running query"
 msgstr "K?r fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:3060
+#: UI/GTK2/src/mainWindow.cc:3044
 msgid "No default application defined for type"
 msgstr "Inget standardprogram definierat f?r typen"
 
@@ -415,63 +415,63 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:170 UI/GTK2/src/pinot-dbus-daemon.cc:699
+#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
 msgid "Unknown"
 msgstr "Ok?nd"
 
-#: UI/GTK2/src/pinot.cc:171 UI/GTK2/src/pinot-dbus-daemon.cc:700
+#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
 msgid "Danish"
 msgstr "Danska"
 
-#: UI/GTK2/src/pinot.cc:172 UI/GTK2/src/pinot-dbus-daemon.cc:701
+#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
 msgid "Dutch"
 msgstr "Nederl?ndska"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
 msgid "English"
 msgstr "Engelska"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
 msgid "Finnish"
 msgstr "Finska"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
 msgid "French"
 msgstr "Franska"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
 msgid "German"
 msgstr "Tyska"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
 msgid "Italian"
 msgstr "Italienska"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
 msgid "Norwegian"
 msgstr "Norska"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
 msgid "Portuguese"
 msgstr "Portugisiska"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:712
 msgid "Russian"
 msgstr "Ryska"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:713
 msgid "Spanish"
 msgstr "Spanska"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:714
 msgid "Swedish"
 msgstr "Svenska"
 
-#: UI/GTK2/src/pinot.cc:206
+#: UI/GTK2/src/pinot.cc:209
 msgid "Couldn't open index"
 msgstr "Kunde inte ?ppna index"
 
-#: UI/GTK2/src/pinot.cc:222
+#: UI/GTK2/src/pinot.cc:225
 msgid "Couldn't create history database"
 msgstr "Kunde inte skapa historikdatabas"
 
@@ -565,8 +565,7 @@
 msgstr "Etiketter"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:97
-msgid ""
-"These directories will be indexed and optionally monitored for changes:"
+msgid "These directories will be indexed and optionally monitored for changes:"
 msgstr ""
 "Dessa kataloger kommer att bli indexerade och ?vervakade f?r ?ndringar "
 "(valfritt):"
@@ -655,81 +654,81 @@
 msgid "Extract"
 msgstr "Utdrag"
 
-#: UI/GTK2/src/WorkerThreads.cpp:318
+#: UI/GTK2/src/WorkerThreads.cpp:325
 msgid "Can't index mail here"
 msgstr "Kan inte indexera post h?r"
 
-#: UI/GTK2/src/WorkerThreads.cpp:339
+#: UI/GTK2/src/WorkerThreads.cpp:346
 msgid "is already being indexed"
 msgstr "h?ller redan p? att bli indexerad"
 
-#: UI/GTK2/src/WorkerThreads.cpp:349
+#: UI/GTK2/src/WorkerThreads.cpp:356
 msgid "is blacklisted"
 msgstr "?r svartlistad"
 
-#: UI/GTK2/src/WorkerThreads.cpp:357 UI/GTK2/src/WorkerThreads.cpp:693
-#: UI/GTK2/src/WorkerThreads.cpp:968 UI/GTK2/src/WorkerThreads.cpp:977
-#: UI/GTK2/src/WorkerThreads.cpp:1146 UI/GTK2/src/WorkerThreads.cpp:1388
-#: UI/GTK2/src/WorkerThreads.cpp:1512
+#: UI/GTK2/src/WorkerThreads.cpp:364 UI/GTK2/src/WorkerThreads.cpp:688
+#: UI/GTK2/src/WorkerThreads.cpp:965 UI/GTK2/src/WorkerThreads.cpp:974
+#: UI/GTK2/src/WorkerThreads.cpp:1143 UI/GTK2/src/WorkerThreads.cpp:1399
+#: UI/GTK2/src/WorkerThreads.cpp:1532
 msgid "Index error on"
 msgstr "Indexfel p?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:812 UI/GTK2/src/WorkerThreads.cpp:912
+#: UI/GTK2/src/WorkerThreads.cpp:809 UI/GTK2/src/WorkerThreads.cpp:909
 msgid "Couldn't create search engine"
 msgstr "Kunde inte skapa s?kmotor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:824 UI/GTK2/src/WorkerThreads.cpp:926
+#: UI/GTK2/src/WorkerThreads.cpp:821 UI/GTK2/src/WorkerThreads.cpp:923
 msgid "Couldn't run query on search engine"
 msgstr "Kunde inte k?ra fr?ga p? s?kmotor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:840
+#: UI/GTK2/src/WorkerThreads.cpp:837
 msgid "No title"
 msgstr "Ingen titel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1056
+#: UI/GTK2/src/WorkerThreads.cpp:1053
 msgid "Couldn't obtain downloader for protocol"
 msgstr "Kunde inte f? protokollh?mtare"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1067
+#: UI/GTK2/src/WorkerThreads.cpp:1064
 msgid "Couldn't retrieve"
 msgstr "Kunde inte h?mta"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1170 UI/GTK2/src/WorkerThreads.cpp:1237
+#: UI/GTK2/src/WorkerThreads.cpp:1167 UI/GTK2/src/WorkerThreads.cpp:1234
 msgid "Cannot index document type"
 msgstr "Kan inte indexera dokumenttyp"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1174 UI/GTK2/src/WorkerThreads.cpp:1241
+#: UI/GTK2/src/WorkerThreads.cpp:1171 UI/GTK2/src/WorkerThreads.cpp:1238
 msgid "at"
 msgstr "p?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1263
+#: UI/GTK2/src/WorkerThreads.cpp:1260
 msgid "Couldn't tokenize"
 msgstr "Kunde inte g?ra token"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1283
+#: UI/GTK2/src/WorkerThreads.cpp:1280
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META-tagg f?rbjuder indexering"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1318
+#: UI/GTK2/src/WorkerThreads.cpp:1329
 msgid "Couldn't index"
 msgstr "Kunde inte indexera"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1399
+#: UI/GTK2/src/WorkerThreads.cpp:1410
 msgid "Couldn't unindex document(s)"
 msgstr "Kunde inte avindexera dokument"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1524
+#: UI/GTK2/src/WorkerThreads.cpp:1544
 msgid "Couldn't update document"
 msgstr "Kunde inte uppdatera dokument"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1714
+#: UI/GTK2/src/WorkerThreads.cpp:1734
 msgid "No monitoring handler"
 msgstr "Ingen ?vervakningshanterare"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1756
+#: UI/GTK2/src/WorkerThreads.cpp:1776
 msgid "Couldn't initialize file monitor"
 msgstr "Kunde inte initiera fil?vervakare"
 
-#: UI/GTK2/src/WorkerThreads.cpp:2060
+#: UI/GTK2/src/WorkerThreads.cpp:2080
 msgid "Couldn't open directory"
-msgstr "Kunde inte ?ppna katalog"
\ No newline at end of file
+msgstr "Kunde inte ?ppna katalog"



From fabricecolin at mail.berlios.de  Wed Dec  6 11:44:10 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 6 Dec 2006 11:44:10 +0100
Subject: [Pinot-svn] r624 - tags
Message-ID: <200612061044.kB6AiANq016364@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-06 11:44:10 +0100 (Wed, 06 Dec 2006)
New Revision: 624

Added:
   tags/version_0_6_4/
Log:
Tagging 0.64.


Copied: tags/version_0_6_4 (from rev 623, trunk)



From fabricecolin at mail.berlios.de  Wed Dec  6 15:35:02 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 6 Dec 2006 15:35:02 +0100
Subject: [Pinot-svn] r625 - in trunk: Collect Index Monitor Search
	Search/Google Tokenize UI/GTK2/src Utils
Message-ID: <200612061435.kB6EZ2VV017390@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-06 15:35:01 +0100 (Wed, 06 Dec 2006)
New Revision: 625

Modified:
   trunk/Collect/CurlDownloader.h
   trunk/Collect/DownloaderFactory.cpp
   trunk/Collect/DownloaderFactory.h
   trunk/Collect/DownloaderInterface.cpp
   trunk/Collect/DownloaderInterface.h
   trunk/Collect/NeonDownloader.cpp
   trunk/Collect/NeonDownloader.h
   trunk/Collect/XapianCollector.cpp
   trunk/Collect/XapianCollector.h
   trunk/Collect/pinot-collect.cpp
   trunk/Index/DBusXapianIndex.cpp
   trunk/Index/DBusXapianIndex.h
   trunk/Index/IndexFactory.cpp
   trunk/Index/IndexFactory.h
   trunk/Index/IndexInterface.h
   trunk/Index/XapianDatabase.cpp
   trunk/Index/XapianDatabase.h
   trunk/Index/XapianDatabaseFactory.cpp
   trunk/Index/XapianDatabaseFactory.h
   trunk/Index/XapianIndex.cpp
   trunk/Index/XapianIndex.h
   trunk/Index/pinot-index.cpp
   trunk/Monitor/INotifyMonitor.cpp
   trunk/Monitor/INotifyMonitor.h
   trunk/Monitor/MonitorFactory.cpp
   trunk/Monitor/MonitorFactory.h
   trunk/Monitor/MonitorInterface.h
   trunk/Search/Google/GoogleAPIEngine.cpp
   trunk/Search/Google/GoogleAPIEngine.h
   trunk/Search/Google/GoogleSearch.h
   trunk/Search/SearchEngineFactory.cpp
   trunk/Search/SearchEngineFactory.h
   trunk/Search/SearchEngineInterface.cpp
   trunk/Search/SearchEngineInterface.h
   trunk/Search/XapianEngine.cpp
   trunk/Search/XapianEngine.h
   trunk/Search/pinot-search.cpp
   trunk/Search/plugintest.cpp
   trunk/Tokenize/HtmlTokenizer.cpp
   trunk/Tokenize/HtmlTokenizer.h
   trunk/Tokenize/Tokenizer.cpp
   trunk/Tokenize/Tokenizer.h
   trunk/Tokenize/TokenizerFactory.cpp
   trunk/Tokenize/TokenizerFactory.h
   trunk/Tokenize/UnknownTypeTokenizer.cpp
   trunk/Tokenize/UnknownTypeTokenizer.h
   trunk/Tokenize/XmlTokenizer.cpp
   trunk/Tokenize/XmlTokenizer.h
   trunk/Tokenize/tokenizertest.cpp
   trunk/UI/GTK2/src/PinotSettings.cpp
   trunk/UI/GTK2/src/PinotSettings.h
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/mainWindow.hh
   trunk/UI/GTK2/src/mainWindow_glade.cc
   trunk/UI/GTK2/src/mainWindow_glade.hh
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/UI/GTK2/src/pinot.cc
   trunk/UI/GTK2/src/prefsDialog.cc
   trunk/UI/GTK2/src/prefsDialog.hh
   trunk/UI/GTK2/src/prefsDialog_glade.cc
   trunk/UI/GTK2/src/prefsDialog_glade.hh
   trunk/Utils/Languages.cpp
   trunk/Utils/Languages.h
   trunk/Utils/MboxParser.cpp
   trunk/Utils/MboxParser.h
   trunk/Utils/Result.cpp
   trunk/Utils/Result.h
   trunk/Utils/Timer.cpp
   trunk/Utils/Timer.h
Log:
Reset executable bit on source files.



Property changes on: trunk/Collect/CurlDownloader.h
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Collect/DownloaderFactory.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Collect/DownloaderFactory.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Collect/DownloaderInterface.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Collect/DownloaderInterface.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Collect/NeonDownloader.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Collect/NeonDownloader.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Collect/XapianCollector.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Collect/XapianCollector.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Collect/pinot-collect.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Index/DBusXapianIndex.cpp
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Index/DBusXapianIndex.h
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Index/IndexFactory.cpp
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Index/IndexFactory.h
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Index/IndexInterface.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Index/XapianDatabase.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Index/XapianDatabase.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Index/XapianDatabaseFactory.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Index/XapianDatabaseFactory.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Index/XapianIndex.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Index/XapianIndex.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Index/pinot-index.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Monitor/INotifyMonitor.cpp
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Monitor/INotifyMonitor.h
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Monitor/MonitorFactory.cpp
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Monitor/MonitorFactory.h
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Monitor/MonitorInterface.h
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Search/Google/GoogleAPIEngine.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/Google/GoogleAPIEngine.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/Google/GoogleSearch.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/SearchEngineFactory.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/SearchEngineFactory.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/SearchEngineInterface.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/SearchEngineInterface.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/XapianEngine.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/XapianEngine.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/pinot-search.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Search/plugintest.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Tokenize/HtmlTokenizer.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Tokenize/HtmlTokenizer.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Tokenize/Tokenizer.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Tokenize/Tokenizer.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Tokenize/TokenizerFactory.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Tokenize/TokenizerFactory.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Tokenize/UnknownTypeTokenizer.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Tokenize/UnknownTypeTokenizer.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Tokenize/XmlTokenizer.cpp
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Tokenize/XmlTokenizer.h
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/Tokenize/tokenizertest.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/PinotSettings.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/PinotSettings.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/mainWindow.cc
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/mainWindow.hh
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/mainWindow_glade.cc
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/mainWindow_glade.hh
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
___________________________________________________________________
Name: svn:executable
   - *


Property changes on: trunk/UI/GTK2/src/pinot.cc
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/prefsDialog.cc
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/prefsDialog.hh
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/prefsDialog_glade.cc
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/UI/GTK2/src/prefsDialog_glade.hh
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Utils/Languages.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Utils/Languages.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Utils/MboxParser.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Utils/MboxParser.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Utils/Result.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Utils/Result.h
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Utils/Timer.cpp
___________________________________________________________________
Name: svn:executable
   - 


Property changes on: trunk/Utils/Timer.h
___________________________________________________________________
Name: svn:executable
   - 



From fabricecolin at mail.berlios.de  Thu Dec  7 12:26:49 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 7 Dec 2006 12:26:49 +0100
Subject: [Pinot-svn] r626 - trunk
Message-ID: <200612071126.kB7BQnw4015721@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-07 12:26:49 +0100 (Thu, 07 Dec 2006)
New Revision: 626

Modified:
   trunk/pinot.spec.in
Log:
Require gsoap > 2.7.8c.


Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-12-06 14:35:01 UTC (rev 625)
+++ trunk/pinot.spec.in	2006-12-07 11:26:49 UTC (rev 626)
@@ -33,7 +33,7 @@
 BuildRequires: taglib-devel >= 1.4
 BuildRequires: gcc-c++
 %if 0%{?_with_soap:1}
-BuildRequires: gsoap
+BuildRequires: gsoap >= 2.7.8c
 %endif
 
 %description



From fabricecolin at mail.berlios.de  Thu Dec  7 14:12:25 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 7 Dec 2006 14:12:25 +0100
Subject: [Pinot-svn] r627 - trunk
Message-ID: <200612071312.kB7DCPko004070@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-07 14:12:25 +0100 (Thu, 07 Dec 2006)
New Revision: 627

Modified:
   trunk/configure.in
Log:

From fabricecolin at mail.berlios.de  Fri Dec  8 12:11:00 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 8 Dec 2006 12:11:00 +0100
Subject: [Pinot-svn] r628 - trunk/Utils
Message-ID: <200612081111.kB8BB0iL020958@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-08 12:11:00 +0100 (Fri, 08 Dec 2006)
New Revision: 628

Modified:
   trunk/Utils/CommandLine.cpp
Log:
Expand %f, %d and %n correctly. When there is no suitable parameter, or none at
all, the command line wasn't correct either.


Modified: trunk/Utils/CommandLine.cpp
===================================================================
--- trunk/Utils/CommandLine.cpp	2006-12-07 13:12:25 UTC (rev 627)
+++ trunk/Utils/CommandLine.cpp	2006-12-08 11:11:00 UTC (rev 628)
@@ -90,12 +90,13 @@
 		bool oneArgumentOnly = true;
 
 		// Expand parameters
+		// See http://standards.freedesktop.org/desktop-entry-spec/latest/
 		// We assume that all arguments are full-blown URLs
 		string::size_type paramPos = commandLine.find('%');
 		while ((paramPos != string::npos) &&
 				(paramPos + 1 < commandLine.length()))
 		{
-			string replacement;
+			string shellReplacement, replacement;
 
 			foundParam = true;
 			switch (commandLine[paramPos + 1])
@@ -106,7 +107,7 @@
 					noArgument = false;
 					break;
 				case 'f':
-					if (firstUrl.getProtocol() != "file")
+					if (firstUrl.getProtocol() == "file")
 					{
 						replacement = firstUrl.getLocation();
 						replacement += "/";
@@ -115,14 +116,14 @@
 					noArgument = false;
 					break;
 				case 'd':
-					if (firstUrl.getProtocol() != "file")
+					if (firstUrl.getProtocol() == "file")
 					{
 						replacement = firstUrl.getLocation();
 					}
 					noArgument = false;
 					break;
 				case 'n':
-					if (firstUrl.getProtocol() != "file")
+					if (firstUrl.getProtocol() == "file")
 					{
 						replacement = firstUrl.getFile();
 					}
@@ -208,7 +209,10 @@
 					break;
 			}
 
-			string shellReplacement(Glib::shell_quote(replacement));
+			if (replacement.empty() == false)
+			{
+				shellReplacement = Glib::shell_quote(replacement);
+			}
 			commandLine.replace(paramPos, 2, shellReplacement);
 
 			// Next
@@ -218,8 +222,9 @@
 		if (foundParam == false)
 		{
 			// If no parameter was found, assume %f
-			if (firstUrl.getProtocol() != "file")
+			if (firstUrl.getProtocol() == "file")
 			{
+				commandLine += " ";
 				commandLine += firstUrl.getLocation();
 				commandLine += "/";
 				commandLine += firstUrl.getFile();



From fabricecolin at mail.berlios.de  Fri Dec  8 12:11:44 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 8 Dec 2006 12:11:44 +0100
Subject: [Pinot-svn] r629 - trunk/Index
Message-ID: <200612081111.kB8BBiKH021032@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-08 12:11:44 +0100 (Fri, 08 Dec 2006)
New Revision: 629

Modified:
   trunk/Index/XapianIndex.cpp
Log:
Fixed extraction of language and size from the document data.


Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-12-08 11:11:00 UTC (rev 628)
+++ trunk/Index/XapianIndex.cpp	2006-12-08 11:11:44 UTC (rev 629)
@@ -416,7 +416,7 @@
 		return;
 	}
 
-	string language(StringManip::extractField(record, "language=", ""));
+	string language(StringManip::extractField(record, "language=", "\n"));
 	string timestamp(StringManip::extractField(record, "timestamp=", "\n"));
 
 	docInfo = DocumentInfo(StringManip::extractField(record, "caption=", "\n"),
@@ -434,7 +434,7 @@
 		}
 	}
 	docInfo.setTimestamp(timestamp);
-	string bytesSize(StringManip::extractField(record, "size=", "\n"));
+	string bytesSize(StringManip::extractField(record, "size=", ""));
 	if (bytesSize.empty() == false)
 	{
 		docInfo.setSize((off_t )atol(bytesSize.c_str()));
@@ -641,7 +641,7 @@
 			string record = doc.get_data();
 			if (record.empty() == false)
 			{
-				string language(Languages::toLocale(StringManip::extractField(record, "language=", "")));
+				string language(Languages::toLocale(StringManip::extractField(record, "language=", "\n")));
 				// We used to use timestamp prior to 0.60
 				string timestamp(StringManip::extractField(record, "timestamp=", "\n"));
 
@@ -660,7 +660,7 @@
 					}
 				}
 				docInfo.setTimestamp(timestamp);
-				string bytesSize(StringManip::extractField(record, "size=", "\n"));
+				string bytesSize(StringManip::extractField(record, "size=", ""));
 				if (bytesSize.empty() == false)
 				{
 					docInfo.setSize((off_t )atol(bytesSize.c_str()));



From fabricecolin at mail.berlios.de  Fri Dec  8 12:12:48 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 8 Dec 2006 12:12:48 +0100
Subject: [Pinot-svn] r630 - trunk/UI/GTK2/src
Message-ID: <200612081112.kB8BCm1r021199@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-08 12:12:48 +0100 (Fri, 08 Dec 2006)
New Revision: 630

Modified:
   trunk/UI/GTK2/src/pinot.cc
Log:
Better initialize D-Bus in the UI too. Not sure why this wasn't a problem
earlier.


Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2006-12-08 11:11:44 UTC (rev 629)
+++ trunk/UI/GTK2/src/pinot.cc	2006-12-08 11:12:48 UTC (rev 630)
@@ -28,6 +28,13 @@
 #include <glibmm/ustring.h>
 #include <glibmm/miscutils.h>
 #include <glibmm/convert.h>
+extern "C"
+{
+#define DBUS_API_SUBJECT_TO_CHANGE
+#include <dbus/dbus.h>
+#include <dbus/dbus-glib.h>
+#include <dbus/dbus-glib-lowlevel.h>
+}
 #include <gtkmm/main.h>
 
 #include "TokenizerFactory.h"
@@ -242,6 +249,10 @@
 
 	atexit(closeAll);
 
+	// Initialize the GType and the D-Bus thread system
+	g_type_init();
+	dbus_g_thread_init();
+
 	try
 	{
 		// Set an icon for all windows



From fabricecolin at mail.berlios.de  Fri Dec  8 12:18:00 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 8 Dec 2006 12:18:00 +0100
Subject: [Pinot-svn] r631 - trunk/UI/GTK2/src
Message-ID: <200612081118.kB8BI0xS021694@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-08 12:17:59 +0100 (Fri, 08 Dec 2006)
New Revision: 631

Modified:
   trunk/UI/GTK2/src/mainWindow.cc
Log:
Don't call setDocumentLabels() if there were and still are no labels.


Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-12-08 11:12:48 UTC (rev 630)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-12-08 11:17:59 UTC (rev 631)
@@ -2029,11 +2029,15 @@
 #endif
 
 	// Now apply these labels to all the documents
-	for (vector<IndexedDocument>::iterator docIter = documentsList.begin();
-		docIter != documentsList.end(); ++docIter)
+	if ((docLabels.empty() == false) ||
+		(labels.empty() == false))
 	{
-		// Set the document's labels list
-		pIndex->setDocumentLabels(docIter->getID(), labels);
+		for (vector<IndexedDocument>::iterator docIter = documentsList.begin();
+			docIter != documentsList.end(); ++docIter)
+		{
+			// Set the document's labels list
+			pIndex->setDocumentLabels(docIter->getID(), labels);
+		}
 	}
 
 	if ((documentsList.size() == 1) &&



From fabricecolin at mail.berlios.de  Fri Dec  8 12:30:27 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 8 Dec 2006 12:30:27 +0100
Subject: [Pinot-svn] r632 - trunk
Message-ID: <200612081130.kB8BURn4023622@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-08 12:30:24 +0100 (Fri, 08 Dec 2006)
New Revision: 632

Modified:
   trunk/configure.in
Log:
Complain bitterly if textcat.h is not found.


Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-12-08 11:17:59 UTC (rev 631)
+++ trunk/configure.in	2006-12-08 11:30:24 UTC (rev 632)
@@ -152,15 +152,16 @@
 dnl boost Spirit 
 AM_CONDITIONAL(HAVE_BOOST_SPIRIT, false)
 AC_CHECK_HEADERS([boost/spirit/core.hpp],
-    [AM_CONDITIONAL(HAVE_BOOST_SPIRIT, true)
-    ])
+   [AM_CONDITIONAL(HAVE_BOOST_SPIRIT, true)
+   ])
 
 dnl TextCat
-AC_CHECK_HEADERS([textcat.h])
+AC_CHECK_HEADERS([textcat.h],,
+   [AC_MSG_ERROR([Can't find textcat.h.])])
 AC_CHECK_LIB(textcat, textcat_Cat,
-    [AM_CONDITIONAL(HAVE_TEXTCAT_CAT, true)],
-    [AM_CONDITIONAL(HAVE_TEXTCAT_CAT, false)]
-    )
+   [AM_CONDITIONAL(HAVE_TEXTCAT_CAT, true)],
+   [AM_CONDITIONAL(HAVE_TEXTCAT_CAT, false)]
+   )
 
 dnl pthreads
 pthreadlib=""



From fabricecolin at mail.berlios.de  Fri Dec  8 15:59:02 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 8 Dec 2006 15:59:02 +0100
Subject: [Pinot-svn] r633 - in trunk: . Index UI/GTK2/src
Message-ID: <200612081459.kB8Ex2Zs025805@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-08 15:59:01 +0100 (Fri, 08 Dec 2006)
New Revision: 633

Modified:
   trunk/Index/LanguageDetector.cpp
   trunk/Makefile.am
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/UI/GTK2/src/pinot.cc
   trunk/configure.in
   trunk/pinot.spec.in
Log:
Install configuration files under $sysconfdir/pinot, tokenizers under
$libdir/pinot/tokenizers. Search plugins are not configuration files so can stay
under $datadir.
Some other tweaks to the spec file suggested by Neal Becker.


Modified: trunk/Index/LanguageDetector.cpp
===================================================================
--- trunk/Index/LanguageDetector.cpp	2006-12-08 11:30:24 UTC (rev 632)
+++ trunk/Index/LanguageDetector.cpp	2006-12-08 14:59:01 UTC (rev 633)
@@ -55,7 +55,7 @@
 void LanguageDetector::guessLanguage(const char *pData, unsigned int dataLength,
 			std::vector<std::string> &candidates)
 {
-	string confFile(PREFIX);
+	string confFile(SYSCONFDIR);
 #ifdef HAVE_TEXTCAT_CAT
 	const char *catResults[10];
 #endif
@@ -63,7 +63,7 @@
 	candidates.clear();
 
 	// What configuration file should we use ?
-	confFile += "/share/pinot/";
+	confFile += "/pinot/";
 	if (strncasecmp(textcat_Version(), "TextCat 3", 9) == 0)
 	{
 #ifdef DEBUG

Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-12-08 11:30:24 UTC (rev 632)
+++ trunk/Makefile.am	2006-12-08 14:59:01 UTC (rev 633)
@@ -5,8 +5,8 @@
 	Search Monitor UI/GTK2/src
 
 EXTRA_DIST = ChangeLog NEWS README TODO mkinstalldirs \
+	globalconfig.xml textcat_conf.txt textcat3_conf.txt \
 	pinot.desktop pinot-dbus-daemon.desktop pinot.spec \
-	textcat_conf.txt textcat3_conf.txt globalconfig.xml \
 	Search/Plugins/*src Search/Plugins/*.xml \
 	Collect/pinot-collect.1 Index/pinot-index.1 Search/pinot-search.1 \
 	UI/GTK2/src/pinot.1 UI/GTK2/src/pinot-dbus-daemon.1 \
@@ -19,22 +19,23 @@
 	UI/GTK2/src/pinot.1 UI/GTK2/src/pinot-dbus-daemon.1
 
 install-data-local:
+	$(mkinstalldirs) $(DESTDIR)$(sysconfdir)/pinot
+	$(INSTALL_DATA) globalconfig.xml $(DESTDIR)$(sysconfdir)/pinot/globalconfig.xml
+	$(INSTALL_DATA) textcat_conf.txt $(DESTDIR)$(sysconfdir)/pinot/textcat_conf.txt
+	$(INSTALL_DATA) textcat3_conf.txt $(DESTDIR)$(sysconfdir)/pinot/textcat3_conf.txt
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/pinot $(DESTDIR)$(datadir)/dbus-1/services
-	$(INSTALL_DATA) globalconfig.xml $(DESTDIR)$(datadir)/pinot/globalconfig.xml
 	$(INSTALL_DATA) UI/GTK2/xapian-powered.png $(DESTDIR)$(datadir)/pinot/xapian-powered.png
 	$(INSTALL_DATA) UI/GTK2/metase-gtk2.glade $(DESTDIR)$(datadir)/pinot/metase-gtk2.glade
 	$(INSTALL_DATA) UI/GTK2/metase-gtk2.gladep $(DESTDIR)$(datadir)/pinot/metase-gtk2.gladep
 	$(INSTALL_DATA) UI/GTK2/src/pinot-dbus-daemon.xml $(DESTDIR)$(datadir)/pinot/pinot-dbus-daemon.xml
 	$(INSTALL_DATA) UI/GTK2/src/de.berlios.Pinot.service $(DESTDIR)$(datadir)/dbus-1/services/de.berlios.Pinot.service
-	$(INSTALL_DATA) textcat_conf.txt $(DESTDIR)$(datadir)/pinot/textcat_conf.txt
-	$(INSTALL_DATA) textcat3_conf.txt $(DESTDIR)$(datadir)/pinot/textcat3_conf.txt
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/pinot/engines
 	$(INSTALL_DATA) Search/Plugins/*.src $(DESTDIR)$(datadir)/pinot/engines/
 	@mv $(DESTDIR)$(datadir)/pinot/engines/AmazonAPI.src $(DESTDIR)$(datadir)/pinot/
 	$(INSTALL_DATA) Search/Plugins/*.xml $(DESTDIR)$(datadir)/pinot/engines/
-	$(mkinstalldirs) $(DESTDIR)$(datadir)/pinot/tokenizers
+	$(mkinstalldirs) $(DESTDIR)$(libdir)/pinot/tokenizers
 	@rm $(DESTDIR)$(libdir)/lib*tokenizer.a $(DESTDIR)$(libdir)/lib*tokenizer.la
-	@mv $(DESTDIR)$(libdir)/lib*tokenizer* $(DESTDIR)$(datadir)/pinot/tokenizers/
+	@mv $(DESTDIR)$(libdir)/lib*tokenizer* $(DESTDIR)$(libdir)/pinot/tokenizers/
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/
 	$(INSTALL_DATA) UI/GTK2/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/pinot.png
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/applications

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-08 11:30:24 UTC (rev 632)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-08 14:59:01 UTC (rev 633)
@@ -717,10 +717,10 @@
 	settings.loadSearchEngines(prefixDir + string("/share/pinot/engines"));
 	settings.loadSearchEngines(confDirectory + string("/engines"));
 	// Load tokenizer libraries, if any
-	TokenizerFactory::loadTokenizers(prefixDir + string("/share/pinot/tokenizers"));
+	TokenizerFactory::loadTokenizers(string(LIBDIR) + string("/pinot/tokenizers"));
 	TokenizerFactory::loadTokenizers(confDirectory + string("/tokenizers"));
 	// Load the settings
-	settings.loadGlobal(prefixDir + string("/share/pinot/globalconfig.xml"));
+	settings.loadGlobal(string(SYSCONFDIR) + string("/pinot/globalconfig.xml"));
 	settings.load();
 
 	// Catch interrupts

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2006-12-08 11:30:24 UTC (rev 632)
+++ trunk/UI/GTK2/src/pinot.cc	2006-12-08 14:59:01 UTC (rev 633)
@@ -195,10 +195,10 @@
 	settings.loadSearchEngines(prefixDir + string("/share/pinot/engines"));
 	settings.loadSearchEngines(confDirectory + string("/engines"));
 	// Load tokenizer libraries, if any
-	TokenizerFactory::loadTokenizers(prefixDir + string("/share/pinot/tokenizers"));
+	TokenizerFactory::loadTokenizers(string(LIBDIR) + string("/pinot/tokenizers"));
 	TokenizerFactory::loadTokenizers(confDirectory + string("/tokenizers"));
 	// Load the settings
-	settings.loadGlobal(prefixDir + string("/share/pinot/globalconfig.xml"));
+	settings.loadGlobal(string(SYSCONFDIR) + string("/pinot/globalconfig.xml"));
 	settings.load();
 
 	// Catch interrupts

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-12-08 11:30:24 UTC (rev 632)
+++ trunk/configure.in	2006-12-08 14:59:01 UTC (rev 633)
@@ -48,7 +48,14 @@
 
 AS_AC_EXPAND(DATADIR, $datadir)
 AS_AC_EXPAND(BINDIR, $bindir)
+
+dnl Location of system directories
 AS_AC_EXPAND(SYSCONFDIR, $sysconfdir)
+AC_DEFINE_UNQUOTED(SYSCONFDIR, "$SYSCONFDIR",
+		[Define to the system configuration directory.])
+AS_AC_EXPAND(LIBDIR, $libdir)
+AC_DEFINE_UNQUOTED(LIBDIR, "$LIBDIR",
+		[Define to the libraries directory.])
 
 dnl Set DBUS_SERVICES_DIR in de.berlios.Pinot.service.
 DBUS_SERVICES_DIR="$DATADIR/dbus-1/services"

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-12-08 11:30:24 UTC (rev 632)
+++ trunk/pinot.spec.in	2006-12-08 14:59:01 UTC (rev 633)
@@ -27,7 +27,6 @@
 Requires: xapian-core-libs >= 0.9.7, libtextcat >= 2.2, sqlite >= 3.1.2, curl >= 7.13, gmime >= 2.1
 Requires: gtkmm24 >= 2.6, libxml++ >= 2.12, %{dbus_pkg} >= 0.60, shared-mime-info
 Requires: unzip, antiword, unrtf, %{pftotext_pkg}
-Obsoletes: pinot-pdf, pinot-word, pinot-text-docs
 BuildRequires: xapian-core-devel >= 0.9.7, libtextcat-devel >= 2.2, sqlite-devel >= 3.1.2, curl-devel >= 7.13, gmime-devel >= 2.1, boost-devel >= 1.32
 BuildRequires: gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, %{dbus_dev_pkg} >= 0.60, gettext-devel, desktop-file-utils
 BuildRequires: taglib-devel >= 1.4
@@ -88,44 +87,44 @@
 %files
 %defattr(-, root, root, -)
 %doc ChangeLog COPYING NEWS README TODO
+%{_sysconfdir}/pinot/globalconfig.xml
+%{_sysconfdir}/pinot/textcat_conf.txt
+%{_sysconfdir}/pinot/textcat3_conf.txt
 %{_bindir}/pinot
 %ghost %{_bindir}/pinot-collect
 %{_bindir}/pinot-dbus-daemon
 %{_bindir}/pinot-index
 %{_bindir}/pinot-search
-%{_datadir}/pinot/globalconfig.xml
+%{_libdir}/pinot/tokenizers/libopendocumenttokenizer.so*
+%{_libdir}/pinot/tokenizers/libpdftokenizer.so*
+%{_libdir}/pinot/tokenizers/librtftokenizer.so*
+%{_libdir}/pinot/tokenizers/libwordtokenizer.so*
 %{_datadir}/pinot/xapian-powered.png
 %{_datadir}/pinot/metase-gtk2.glade
 %{_datadir}/pinot/metase-gtk2.gladep
 %{_datadir}/pinot/pinot-dbus-daemon.xml
-%{_datadir}/pinot/textcat_conf.txt
-%{_datadir}/pinot/textcat3_conf.txt
-%{_datadir}/pinot/tokenizers/libopendocumenttokenizer.so*
-%{_datadir}/pinot/tokenizers/libpdftokenizer.so*
-%{_datadir}/pinot/tokenizers/librtftokenizer.so*
-%{_datadir}/pinot/tokenizers/libwordtokenizer.so*
 %{_datadir}/dbus-1/services/de.berlios.Pinot.service
 %{_datadir}/pinot/*.src
 %dir %{_datadir}/pinot/engines/
-%config(noreplace) %{_datadir}/pinot/engines/A9.src
-%config(noreplace) %{_datadir}/pinot/engines/Accoona.src
-%config(noreplace) %{_datadir}/pinot/engines/Ask.src
-%config(noreplace) %{_datadir}/pinot/engines/BitTorrent.src
-%config(noreplace) %{_datadir}/pinot/engines/Clusty.src
-%config(noreplace) %{_datadir}/pinot/engines/CreativeCommons.src
-%config(noreplace) %{_datadir}/pinot/engines/Exalead.src
-%config(noreplace) %{_datadir}/pinot/engines/Freshmeat.src
-%config(noreplace) %{_datadir}/pinot/engines/Google.src
-%config(noreplace) %{_datadir}/pinot/engines/GoogleCodeSearch.src
-%config(noreplace) %{_datadir}/pinot/engines/MozDexDescription.xml
-%config(noreplace) %{_datadir}/pinot/engines/MSN.src
-%config(noreplace) %{_datadir}/pinot/engines/RollYOTopNews.src
-%config(noreplace) %{_datadir}/pinot/engines/Topix.src
-%config(noreplace) %{_datadir}/pinot/engines/WiseNut.src
-%config(noreplace) %{_datadir}/pinot/engines/Yahoo.src
-%config(noreplace) %{_datadir}/pinot/engines/YahooAPI.src
-%config(noreplace) %{_datadir}/pinot/engines/Wikipedia.src
-%config(noreplace) %{_datadir}/pinot/engines/KodersDescription.xml
+%{_datadir}/pinot/engines/A9.src
+%{_datadir}/pinot/engines/Accoona.src
+%{_datadir}/pinot/engines/Ask.src
+%{_datadir}/pinot/engines/BitTorrent.src
+%{_datadir}/pinot/engines/Clusty.src
+%{_datadir}/pinot/engines/CreativeCommons.src
+%{_datadir}/pinot/engines/Exalead.src
+%{_datadir}/pinot/engines/Freshmeat.src
+%{_datadir}/pinot/engines/Google.src
+%{_datadir}/pinot/engines/GoogleCodeSearch.src
+%{_datadir}/pinot/engines/MozDexDescription.xml
+%{_datadir}/pinot/engines/MSN.src
+%{_datadir}/pinot/engines/RollYOTopNews.src
+%{_datadir}/pinot/engines/Topix.src
+%{_datadir}/pinot/engines/WiseNut.src
+%{_datadir}/pinot/engines/Yahoo.src
+%{_datadir}/pinot/engines/YahooAPI.src
+%{_datadir}/pinot/engines/Wikipedia.src
+%{_datadir}/pinot/engines/KodersDescription.xml
 %{_datadir}/locale/fr/LC_MESSAGES/pinot.mo
 %{_datadir}/locale/es/LC_MESSAGES/pinot.mo
 %{_datadir}/locale/nl/LC_MESSAGES/pinot.mo
@@ -141,14 +140,15 @@
 
 %files audio-docs 
 %defattr(-, root, root, -)
-%{_datadir}/pinot/tokenizers/libtaglibtokenizer.so*
+%{_libdir}/pinot/tokenizers/libtaglibtokenizer.so*
 
 %files omega
 %defattr(-, root, root, -)
-%config(noreplace) %{_datadir}/pinot/engines/OmegaDescription.xml
+%{_datadir}/pinot/engines/OmegaDescription.xml
 
 %files deskbar
 %defattr(-, root, root, -)
 %{_libdir}/deskbar-applet/handlers/pinot-live.py*
 
 %changelog
+



From fabricecolin at mail.berlios.de  Sat Dec  9 03:20:41 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 9 Dec 2006 03:20:41 +0100
Subject: [Pinot-svn] r634 - trunk/UI/GTK2/src
Message-ID: <200612090220.kB92KfnN023898@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-09 03:20:37 +0100 (Sat, 09 Dec 2006)
New Revision: 634

Modified:
   trunk/UI/GTK2/src/PinotSettings.cpp
   trunk/UI/GTK2/src/PinotSettings.h
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/prefsDialog.cc
Log:
First time Pinot is launched, open the preferences and show the Indexing tab.


Modified: trunk/UI/GTK2/src/PinotSettings.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.cpp	2006-12-08 14:59:01 UTC (rev 633)
+++ trunk/UI/GTK2/src/PinotSettings.cpp	2006-12-09 02:20:37 UTC (rev 634)
@@ -196,6 +196,11 @@
 	return "";
 }
 
+bool PinotSettings::isFirstRun(void) const
+{
+	return m_firstRun;
+}
+
 void PinotSettings::clear(void)
 {
 	// Clear lists

Modified: trunk/UI/GTK2/src/PinotSettings.h
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.h	2006-12-08 14:59:01 UTC (rev 633)
+++ trunk/UI/GTK2/src/PinotSettings.h	2006-12-09 02:20:37 UTC (rev 634)
@@ -46,6 +46,8 @@
 
 		static std::string getCurrentUserName(void);
 
+		bool isFirstRun(void) const;
+
 		void clear(void);
 
 		bool loadGlobal(const std::string &fileName);

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-12-08 14:59:01 UTC (rev 633)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-12-09 02:20:37 UTC (rev 634)
@@ -190,6 +190,12 @@
 	m_pNotebook->show();
 	show();
 	liveQueryEntry->grab_focus();
+
+	// Open the preferences on first run
+	if (m_settings.isFirstRun() == true)
+	{
+		on_configure_activate();
+	}
 }
 
 //

Modified: trunk/UI/GTK2/src/prefsDialog.cc
===================================================================
--- trunk/UI/GTK2/src/prefsDialog.cc	2006-12-08 14:59:01 UTC (rev 633)
+++ trunk/UI/GTK2/src/prefsDialog.cc	2006-12-09 02:20:37 UTC (rev 634)
@@ -100,6 +100,14 @@
 		apiKeyLabel->hide();
 		apiKeyEntry->hide();
 	}
+
+	// Show The Indexing tab on first run
+	if ((m_settings.isFirstRun() == true) &&
+		(prefsNotebook != NULL) &&
+		(prefsNotebook->get_n_pages() > 2))
+	{
+		prefsNotebook->set_current_page(2);
+	}
 }
 
 prefsDialog::~prefsDialog()



From fabricecolin at mail.berlios.de  Sat Dec  9 04:19:34 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 9 Dec 2006 04:19:34 +0100
Subject: [Pinot-svn] r635 - trunk
Message-ID: <200612090319.kB93JYYZ029913@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-09 04:19:34 +0100 (Sat, 09 Dec 2006)
New Revision: 635

Modified:
   trunk/TODO
Log:
More stuff to do...


Modified: trunk/TODO
===================================================================
--- trunk/TODO	2006-12-09 02:20:37 UTC (rev 634)
+++ trunk/TODO	2006-12-09 03:19:34 UTC (rev 635)
@@ -4,6 +4,9 @@
 - Advertise service via Rendezvous
 - MIMEScanner should also return parent types so that we don't filter out types unnecessarily
 - Build a -devel package for those who want to write their own tokenizers
+- Generate doxygen documentation
+- Load desktop files from /usr/share/applications/kde ?
+- Build with -DNDEBUG in non-DEBUG mode
 
 Tokenize
 - Allow to cache documents that had to be converted ? eg PDF, MS Word
@@ -14,6 +17,7 @@
 - Check whether pdftotext flattens text in PDF documents that have columns
 - HtmlTokenizer should skip htdig_noindex blocks (http://www.htdig.org/attrs.html#noindex_start)
 - HtmlTokenizer to look for META tags Author, Creator, Publisher and CreationDate
+- Don't load documents' content for unsupported types
 
 Monitor
 - Implement support for Solaris FEM
@@ -34,6 +38,7 @@
 - Make sure Description files' SyndicationRight is not private or closed
 - Support for Google Buttons
 - Export search results as OpenSearch Response or CSV
+- Nested queries
 
 Index
 - Get hold of stopwords lists for the languages supported by Xapian's stemmers and don't index stop words
@@ -46,10 +51,12 @@
 - Think about indexing archives (parent documents) and their contents (child documents)
 - Reopen connection to remote indexes when necessary; does Xapian throw a RemoteError ?
 - Allow to access remote Xapian indexes tunneled through ssh, using Xapian::Remote::open()
-  defined in /usr/include/xapian/dbfactory.h
+  defined in /usr/include/xapian/dbfactory.h (xapian-progsrv backend)
 - All indexes can be browsed with the new global posting list found in Xapian > 0.9.9, ie
   Xapian::Database::postlist_begin("")
 - Store date as terms (D, M and Y prefixes), as done by omindex
+- Index xattrs if any
+- pinot-index doesn't initialize tokenizers
 
 Mail
 - Find out what kind of locking scheme Mozilla uses (POSIX lock ?) and use that
@@ -70,6 +77,11 @@
 - Make unique (http://guniqueapp.akl.lt/)
 - Queue unindexing too
 - Export Web searching over D-Bus
+- Labels should be managed by the daemon, and not saved to the configuration file
+- Make sure labels are alpha-numeric characters exclusively
+- DBus SetDocumentLabels should create labels if necessary
+- Reintroduce Index method in D-Bus interface
+- Actions stemming from DBus messages should be handled by a separate thread that posts replies
 
 UI
 - When sorting results by host name, give better score to results that appear several times
@@ -87,4 +99,7 @@
   all the documents that match a specific tag
 - Either Live Query behaves like a live query (eg results list updated when new documents match)
   or it is renamed to something else to avoid confusion
+- Labels should be set by a separate thread
+- When viewing a result, all rows for that same URL should be updated with the Viewed icon
+- Prompt users for a command-line if the type of the document to open has no application
 



From fabricecolin at mail.berlios.de  Sat Dec  9 04:36:12 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 9 Dec 2006 04:36:12 +0100
Subject: [Pinot-svn] r636 - trunk/UI/GTK2/src
Message-ID: <200612090336.kB93aCKR031376@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-09 04:36:11 +0100 (Sat, 09 Dec 2006)
New Revision: 636

Modified:
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/pinot-dbus-daemon.xml
Log:
When a query returns, only relabel documents that are already indexed.
Fixed description of GetDocumentLabels method.


Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-12-09 03:19:34 UTC (rev 635)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-12-09 03:36:11 UTC (rev 636)
@@ -991,22 +991,56 @@
 		if ((queryProps.getIndexResults() == true) &&
 			(resultsList.empty() == false))
 		{
-			string labelName = queryProps.getLabelName();
+			IndexInterface *pDocsIndex = m_settings.getIndex(m_settings.m_docsIndexLocation);
+			IndexInterface *pDaemonIndex = m_settings.getIndex(m_settings.m_daemonIndexLocation);
+			set<string> labels;
+			string labelName(queryProps.getLabelName());
 
+			if (labelName.empty() == false)
+			{
+				// Queue this
+				labels.insert(labelName);
+			}
+
 #ifdef DEBUG
 			cout << "mainWindow::on_thread_end: indexing results, with label " << labelName << endl;
 #endif
 			for (vector<Result>::const_iterator resultIter = resultsList.begin();
 				resultIter != resultsList.end(); ++resultIter)
 			{
-				set<string> labels;
-				DocumentInfo docInfo(resultIter->getTitle(), resultIter->getLocation(),
-					resultIter->getType(), resultIter->getLanguage());
+				unsigned int docId = 0;
 
-				// Queue this
-				labels.insert(labelName);
-				docInfo.setLabels(labels);
-				m_state.queue_index(docInfo);
+				if ((pDocsIndex != NULL) &&
+					(pDocsIndex->isGood() == true) &&
+					((docId = pDocsIndex->hasDocument(resultIter->getLocation())) > 0))
+				{
+					if (labelName.empty() == false)
+					{
+						// Only apply the new label to the document
+						pDocsIndex->setDocumentLabels(docId, labels, false);
+					}
+				}
+				// Is this a document the daemon indexed ?
+				else if ((pDaemonIndex != NULL) &&
+					(pDaemonIndex->isGood() == true) &&
+					((docId = pDaemonIndex->hasDocument(resultIter->getLocation())) > 0))
+				{
+					if (labelName.empty() == false)
+					{
+						// Only apply the new label to the document
+						pDaemonIndex->setDocumentLabels(docId, labels, false);
+					}
+				}
+				else
+				{
+					DocumentInfo docInfo(resultIter->getTitle(), resultIter->getLocation(),
+						resultIter->getType(), resultIter->getLanguage());
+
+					docInfo.setLabels(labels);
+
+					// No, this is a new document not found in either index
+					m_state.queue_index(docInfo);
+				}
 			}
 		}
 	}

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.xml
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.xml	2006-12-09 03:19:34 UTC (rev 635)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.xml	2006-12-09 03:36:11 UTC (rev 636)
@@ -30,7 +30,7 @@
     <!--
 	Retrieves a document's labels.
 	 docId: the document's ID
-	 labels: array of labels to apply to the document
+	 labels: array of labels applied to the document
 	-->
     <method name="GetDocumentLabels">
       <annotation name="de.berlios.Pinot.GetDocumentLabels" value="pinotDBus"/>



From fabricecolin at mail.berlios.de  Sat Dec  9 06:46:04 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 9 Dec 2006 06:46:04 +0100
Subject: [Pinot-svn] r637 - trunk
Message-ID: <200612090546.kB95k4dd011126@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-09 06:46:02 +0100 (Sat, 09 Dec 2006)
New Revision: 637

Modified:
   trunk/pinot.spec.in
Log:
Mark files in sysconfdir with %config(noreplace).


Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-12-09 03:36:11 UTC (rev 636)
+++ trunk/pinot.spec.in	2006-12-09 05:46:02 UTC (rev 637)
@@ -87,9 +87,9 @@
 %files
 %defattr(-, root, root, -)
 %doc ChangeLog COPYING NEWS README TODO
-%{_sysconfdir}/pinot/globalconfig.xml
-%{_sysconfdir}/pinot/textcat_conf.txt
-%{_sysconfdir}/pinot/textcat3_conf.txt
+%config(noreplace) %{_sysconfdir}/pinot/globalconfig.xml
+%config(noreplace) %{_sysconfdir}/pinot/textcat_conf.txt
+%config(noreplace) %{_sysconfdir}/pinot/textcat3_conf.txt
 %{_bindir}/pinot
 %ghost %{_bindir}/pinot-collect
 %{_bindir}/pinot-dbus-daemon



From fabricecolin at mail.berlios.de  Sun Dec 10 08:09:09 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 10 Dec 2006 08:09:09 +0100
Subject: [Pinot-svn] r638 - trunk/Tokenize
Message-ID: <200612100709.kBA7994u016258@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-10 08:09:09 +0100 (Sun, 10 Dec 2006)
New Revision: 638

Modified:
   trunk/Tokenize/Tokenizer.h
   trunk/Tokenize/TokenizerFactory.cpp
Log:
Don't request any data for unknown types.


Modified: trunk/Tokenize/Tokenizer.h
===================================================================
--- trunk/Tokenize/Tokenizer.h	2006-12-09 05:46:02 UTC (rev 637)
+++ trunk/Tokenize/Tokenizer.h	2006-12-10 07:09:09 UTC (rev 638)
@@ -29,7 +29,7 @@
 		Tokenizer(const Document *pDocument);
 		virtual ~Tokenizer();
 
-		typedef enum { ALL_DOCUMENTS = 0, ALL_BUT_FILES } DataNeeds;
+		typedef enum { ALL_DOCUMENTS = 0, ALL_BUT_FILES, NO_DOCUMENTS } DataNeeds;
 
 		/// Converts a document using an helper program.
 		static Document *runHelperProgram(const Document *pDocument,

Modified: trunk/Tokenize/TokenizerFactory.cpp
===================================================================
--- trunk/Tokenize/TokenizerFactory.cpp	2006-12-09 05:46:02 UTC (rev 637)
+++ trunk/Tokenize/TokenizerFactory.cpp	2006-12-10 07:09:09 UTC (rev 638)
@@ -347,5 +347,8 @@
 		return true;
 	}
 
+	// This type is not supported, so don't bother loading anything
+	dataNeeds = Tokenizer::NO_DOCUMENTS;
+
 	return false;
 }



From fabricecolin at mail.berlios.de  Sun Dec 10 08:18:24 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 10 Dec 2006 08:18:24 +0100
Subject: [Pinot-svn] r639 - trunk/UI/GTK2/src
Message-ID: <200612100718.kBA7IOjk017075@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-10 08:18:22 +0100 (Sun, 10 Dec 2006)
New Revision: 639

Added:
   trunk/UI/GTK2/src/ServerThreads.cpp
   trunk/UI/GTK2/src/ServerThreads.h
Modified:
   trunk/UI/GTK2/src/DaemonState.cpp
   trunk/UI/GTK2/src/DaemonState.h
   trunk/UI/GTK2/src/Makefile.am
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/WorkerThreads.h
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
Log:
Let D-Bus message be processed and replied to by DBusServletThread.
Moved Monitor and DirectoryScannerThread to ServerThreads.


Modified: trunk/UI/GTK2/src/DaemonState.cpp
===================================================================
--- trunk/UI/GTK2/src/DaemonState.cpp	2006-12-10 07:09:09 UTC (rev 638)
+++ trunk/UI/GTK2/src/DaemonState.cpp	2006-12-10 07:18:22 UTC (rev 639)
@@ -33,7 +33,7 @@
 #include "OnDiskHandler.h"
 #include "PinotSettings.h"
 #include "PinotUtils.h"
-#include "WorkerThreads.h"
+#include "ServerThreads.h"
 
 using namespace std;
 using namespace Glib;
@@ -196,20 +196,27 @@
 	}
 	else if (type == "UnindexingThread")
 	{
-		UnindexingThread *pUnindexThread = dynamic_cast<UnindexingThread *>(pThread);
-		if (pUnindexThread == NULL)
-		{
-			delete pThread;
-			return;
-		}
-
 		// FIXME: anything to do ?
 	}
 	else if (type == "MonitorThread")
 	{
 		// FIXME: do something about this
 	}
+	else if (type == "DBusServletThread")
+	{
+		DBusServletThread *pDBusThread = dynamic_cast<DBusServletThread *>(pThread);
+		if (pDBusThread == NULL)
+		{
+			delete pThread;
+			return;
+		}
 
+		if (pDBusThread->mustQuit() == true)
+		{
+			m_signalQuit(0);
+		}
+	}
+
 	// Delete the thread
 	delete pThread;
 
@@ -241,3 +248,8 @@
 	}
 }
 
+SigC::Signal1<void, int>& DaemonState::getQuitSignal(void)
+{
+	return m_signalQuit;
+}
+

Modified: trunk/UI/GTK2/src/DaemonState.h
===================================================================
--- trunk/UI/GTK2/src/DaemonState.h	2006-12-10 07:09:09 UTC (rev 638)
+++ trunk/UI/GTK2/src/DaemonState.h	2006-12-10 07:18:22 UTC (rev 639)
@@ -23,8 +23,9 @@
 #include <queue>
 #include <set>
 
+#include "IndexedDocument.h"
 #include "MonitorInterface.h"
-#include "IndexedDocument.h"
+#include "MonitorHandler.h"
 #include "WorkerThreads.h"
 
 class DaemonState : public ThreadsManager
@@ -42,12 +43,15 @@
 		void on_message_filefound(const DocumentInfo &docInfo, const std::string &sourceLabel,
 			bool isDirectory);
 
+		SigC::Signal1<void, int>& getQuitSignal(void);
+
 	protected:
 		MonitorInterface *m_pMailMonitor;
 		MonitorInterface *m_pDiskMonitor;
 		MonitorHandler *m_pMailHandler;
 		MonitorHandler *m_pDiskHandler;
 		std::string m_locationBeingCrawled;
+		SigC::Signal1<void, int> m_signalQuit;
 
 		bool crawlLocation(const std::string &locationToCrawl, bool isSource, bool doMonitoring);
 

Modified: trunk/UI/GTK2/src/Makefile.am
===================================================================
--- trunk/UI/GTK2/src/Makefile.am	2006-12-10 07:09:09 UTC (rev 638)
+++ trunk/UI/GTK2/src/Makefile.am	2006-12-10 07:18:22 UTC (rev 639)
@@ -24,6 +24,7 @@
 	PinotSettings.h \
 	PinotUtils.h \
 	ResultsTree.h \
+	ServerThreads.h \
 	WorkerThreads.h
 
 pinot_SOURCES = \
@@ -57,6 +58,7 @@
 	MboxHandler.cpp \
 	OnDiskHandler.cpp \
 	PinotSettings.cpp \
+	ServerThreads.cpp \
 	WorkerThreads.cpp
 
 bin_PROGRAMS = pinot pinot-dbus-daemon

Added: trunk/UI/GTK2/src/ServerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.cpp	2006-12-10 07:09:09 UTC (rev 638)
+++ trunk/UI/GTK2/src/ServerThreads.cpp	2006-12-10 07:18:22 UTC (rev 639)
@@ -0,0 +1,1099 @@
+/*
+ *  Copyright 2005,2006 Fabrice Colin
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU Library General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ */
+
+#include <sys/types.h>
+#include <dirent.h>
+#include <sys/stat.h>
+#include <unistd.h>
+#include <stdlib.h>
+#include <fcntl.h>
+#include <string.h>
+#include <signal.h>
+#include <errno.h>
+#include <exception>
+#include <iostream>
+#include <sigc++/class_slot.h>
+#include <sigc++/compatibility.h>
+#include <sigc++/slot.h>
+#include <glibmm/miscutils.h>
+
+#include "Languages.h"
+#include "TimeConverter.h"
+#include "Url.h"
+#include "CrawlHistory.h"
+#include "XapianIndex.h"
+#include "XapianEngine.h"
+#include "config.h"
+#include "NLS.h"
+#include "DaemonState.h"
+#include "PinotSettings.h"
+#include "ServerThreads.h"
+
+using namespace SigC;
+using namespace Glib;
+using namespace std;
+
+static DBusMessage *newDBusReply(DBusMessage *pMessage)
+{
+        if (pMessage == NULL) 
+        {
+                return NULL;
+        }
+
+        DBusMessage *pReply = dbus_message_new_method_return(pMessage);
+        if (pReply != NULL)
+        {
+                return pReply;
+        }
+
+        return NULL;
+}
+
+MonitorThread::MonitorThread(MonitorInterface *pMonitor, MonitorHandler *pHandler) :
+	WorkerThread(),
+	m_ctrlReadPipe(-1),
+	m_ctrlWritePipe(-1),
+	m_pMonitor(pMonitor),
+	m_pHandler(pHandler)
+{
+	int pipeFds[2];
+
+	if (pipe(pipeFds) == 0)
+	{
+		// This pipe will allow to stop select()
+		m_ctrlReadPipe = pipeFds[0];
+		m_ctrlWritePipe = pipeFds[1];
+	}
+}
+
+MonitorThread::~MonitorThread()
+{
+	close(m_ctrlReadPipe);
+	close(m_ctrlWritePipe);
+}
+
+string MonitorThread::getType(void) const
+{
+	return "MonitorThread";
+}
+
+bool MonitorThread::stop(void)
+{
+	// Disconnect the signal
+	Signal3<void, const DocumentInfo&, const std::string&, bool>::slot_list_type slotsList = m_signalDirectoryFound.slots();
+	Signal3<void, const DocumentInfo&, const std::string&, bool>::slot_list_type::iterator slotIter = slotsList.begin();
+	if (slotIter != slotsList.end())
+	{
+		if (slotIter->empty() == false)
+		{
+			slotIter->block();
+			slotIter->disconnect();
+		}
+	}
+	m_done = true;
+	write(m_ctrlWritePipe, "X", 1);
+
+	return true;
+}
+
+Signal3<void, const DocumentInfo&, const std::string&, bool>& MonitorThread::getDirectoryFoundSignal(void)
+{
+	return m_signalDirectoryFound;
+}
+
+void MonitorThread::processEvents(void)
+{
+	CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
+	queue<MonitorEvent> events;
+
+#ifdef DEBUG
+	cout << "MonitorThread::processEvents: checking for events" << endl;
+#endif
+	if ((m_pMonitor == NULL) ||
+		(m_pMonitor->retrievePendingEvents(events) == false))
+	{
+#ifdef DEBUG
+		cout << "MonitorThread::processEvents: failed to retrieve pending events" << endl;
+#endif
+		return;
+	}
+#ifdef DEBUG
+	cout << "MonitorThread::processEvents: retrieved " << events.size() << " events" << endl;
+#endif
+
+	while ((events.empty() == false) &&
+		(m_done == false))
+	{
+		MonitorEvent &event = events.front();
+
+		if ((event.m_location.empty() == true) ||
+			(event.m_type == MonitorEvent::UNKNOWN))
+		{
+			// Next
+			events.pop();
+			continue;
+		}
+#ifdef DEBUG
+		cout << "MonitorThread::processEvents: event " << event.m_type << " on "
+			<< event.m_location << " " << event.m_isDirectory << endl;
+#endif
+
+		// What's the event code ?
+		if (event.m_type == MonitorEvent::EXISTS)
+		{
+			if (event.m_isDirectory == false)
+			{
+				m_pHandler->fileExists(event.m_location);
+			}
+		}
+		else if (event.m_type == MonitorEvent::CREATED)
+		{
+			if (event.m_isDirectory == false)
+			{
+				m_pHandler->fileCreated(event.m_location);
+			}
+			else
+			{
+				DocumentInfo docInfo("", string("file://") + event.m_location, "", "");
+
+				// Report this directory so that it is crawled
+				m_signalDirectoryFound(docInfo, "", true);
+			}
+		}
+		else if (event.m_type == MonitorEvent::WRITE_CLOSED)
+		{
+			if (event.m_isDirectory == false)
+			{
+				CrawlHistory::CrawlStatus status = CrawlHistory::UNKNOWN;
+				struct stat fileStat;
+				time_t itemDate;
+
+				if (history.hasItem("file://" + event.m_location, status, itemDate) == true)
+				{
+					// Was the file actually modified ?
+					if ((stat(event.m_location.c_str(), &fileStat) == 0) &&
+						(itemDate < fileStat.st_mtime))
+					{
+						m_pHandler->fileModified(event.m_location);
+					}
+#ifdef DEBUG
+					else cout << "MonitorThread::processEvents: file wasn't modified" << endl;
+#endif
+				}
+#ifdef DEBUG
+				else cout << "MonitorThread::processEvents: file wasn't crawled" << endl;
+#endif
+			}
+		}
+		else if (event.m_type == MonitorEvent::MOVED)
+		{
+			if (event.m_isDirectory == false)
+			{
+				m_pHandler->fileMoved(event.m_location, event.m_previousLocation);
+			}
+			else
+			{
+				// We should receive this only if the destination directory is monitored too
+				m_pHandler->directoryMoved(event.m_location, event.m_previousLocation);
+			}
+		}
+		else if (event.m_type == MonitorEvent::DELETED)
+		{
+			if (event.m_isDirectory == false)
+			{
+				m_pHandler->fileDeleted(event.m_location);
+			}
+			else
+			{
+				// The monitor should have stopped monitoring this
+				// In practice, events for the files in this directory will already have been received 
+				m_pHandler->directoryDeleted(event.m_location);
+			}
+		}
+
+		// Next
+		events.pop();
+	}
+}
+
+void MonitorThread::doWork(void)
+{
+	if ((m_pHandler == NULL) ||
+		(m_pMonitor == NULL))
+	{
+		m_status = _("No monitoring handler");
+		return;
+	}
+
+	// Initialize the handler
+	m_pHandler->initialize();
+
+	// Get the list of files to monitor
+	const set<string> &fileNames = m_pHandler->getFileNames();
+	for (set<string>::const_iterator fileIter = fileNames.begin();
+		fileIter != fileNames.end(); ++fileIter)
+	{
+		m_pMonitor->addLocation(*fileIter, false);
+	}
+	// Directories, if any, are set elsewhere
+	// In the case of OnDiskHandler, they are set by DirectoryScannerThread
+
+	// There might already be events that need processing
+	processEvents();
+
+	// Wait for something to happen
+	while (m_done == false)
+	{
+		struct timeval selectTimeout;
+		fd_set listenSet;
+
+		selectTimeout.tv_sec = 60;
+		selectTimeout.tv_usec = 0;
+
+		FD_ZERO(&listenSet);
+		if (m_ctrlReadPipe >= 0)
+		{
+			FD_SET(m_ctrlReadPipe, &listenSet);
+		}
+
+		m_pHandler->flushIndex();
+
+		// The file descriptor may change over time
+		int monitorFd = m_pMonitor->getFileDescriptor();
+		FD_SET(monitorFd, &listenSet);
+		if (monitorFd < 0)
+		{
+			m_status = _("Couldn't initialize file monitor");
+			return;
+		}
+
+		int fdCount = select(max(monitorFd, m_ctrlReadPipe) + 1, &listenSet, NULL, NULL, &selectTimeout);
+		if ((fdCount < 0) &&
+			(errno != EINTR))
+		{
+#ifdef DEBUG
+			cout << "MonitorThread::doWork: select() failed" << endl;
+#endif
+			break;
+		}
+		else if (FD_ISSET(monitorFd, &listenSet))
+		{
+			processEvents();
+		}
+	}
+}
+
+DirectoryScannerThread::DirectoryScannerThread(const string &dirName, bool isSource,
+	unsigned int maxLevel, bool followSymLinks,
+	MonitorInterface *pMonitor, MonitorHandler *pHandler) :
+	WorkerThread(),
+	m_dirName(dirName),
+	m_maxLevel(maxLevel),
+	m_followSymLinks(followSymLinks),
+	m_pMonitor(pMonitor),
+	m_pHandler(pHandler),
+	m_currentLevel(0),
+	m_sourceId(0)
+{
+	if (m_dirName.empty() == false)
+	{
+		CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
+
+		if (isSource == true)
+		{
+			// Does this source exist ?
+			if (history.hasSource("file://" + m_dirName, m_sourceId) == false)
+			{
+				// Create it
+				m_sourceId = history.insertSource("file://" + m_dirName);
+			}
+		}
+		else
+		{
+			map<unsigned int, string> fileSources;
+
+			// What source does this belong to ?
+			for(map<unsigned int, string>::const_iterator sourceIter = fileSources.begin();
+				sourceIter != fileSources.end(); ++sourceIter)
+			{
+				if (sourceIter->second.length() < m_dirName.length())
+				{
+					// Skip
+					continue;
+				}
+
+				if (sourceIter->second.substr(0, m_dirName.length()) == m_dirName)
+				{
+					// That's the one
+					m_sourceId = sourceIter->first;
+					break;
+				}
+			}
+		}
+	}
+}
+
+DirectoryScannerThread::~DirectoryScannerThread()
+{
+}
+
+string DirectoryScannerThread::getType(void) const
+{
+	return "DirectoryScannerThread";
+}
+
+string DirectoryScannerThread::getDirectory(void) const
+{
+	return m_dirName;
+}
+
+bool DirectoryScannerThread::stop(void)
+{
+	// Disconnect the signal
+	Signal3<void, const DocumentInfo&, const std::string&, bool>::slot_list_type slotsList = m_signalFileFound.slots();
+	Signal3<void, const DocumentInfo&, const std::string&, bool>::slot_list_type::iterator slotIter = slotsList.begin();
+	if (slotIter != slotsList.end())
+	{
+		if (slotIter->empty() == false)
+		{
+			slotIter->block();
+			slotIter->disconnect();
+		}
+	}
+	m_done = true;
+
+	return true;
+}
+
+Signal3<void, const DocumentInfo&, const std::string&, bool>& DirectoryScannerThread::getFileFoundSignal(void)
+{
+	return m_signalFileFound;
+}
+
+void DirectoryScannerThread::foundFile(const DocumentInfo &docInfo)
+{
+	char labelStr[64];
+
+	if ((docInfo.getLocation().empty() == true) ||
+		(m_done == true))
+	{
+		return;
+	}
+
+	// This identifies the source
+	snprintf(labelStr, 64, "SOURCE%u", m_sourceId);
+
+	m_signalFileFound(docInfo, labelStr, false);
+}
+
+bool DirectoryScannerThread::scanEntry(const string &entryName)
+{
+	CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
+	CrawlHistory::CrawlStatus status = CrawlHistory::UNKNOWN;
+	time_t itemDate;
+	struct stat fileStat;
+	int statSuccess = 0;
+
+	if (entryName.empty() == true)
+	{
+		return false;
+	}
+
+	// Skip . .. and dotfiles
+	Url urlObj("file://" + entryName);
+	if (urlObj.getFile()[0] == '.')
+	{
+		return false;
+	}
+
+	if (m_followSymLinks == false)
+	{
+		statSuccess = lstat(entryName.c_str(), &fileStat);
+	}
+	else
+	{
+		// Stat the files pointed to by symlinks
+		statSuccess = stat(entryName.c_str(), &fileStat);
+	}
+
+	if (statSuccess == -1)
+	{
+		return false;
+	}
+
+	bool itemExists = history.hasItem("file://" + entryName, status, itemDate);
+
+	// Is it a file or a directory ?
+	if (S_ISLNK(fileStat.st_mode))
+	{
+		// This won't happen when m_followSymLinks is true
+		return false;
+	}
+	else if (S_ISREG(fileStat.st_mode))
+	{
+		DocumentInfo docInfo;
+		bool reportFile = false;
+
+		docInfo.setLocation("file://" + entryName);
+
+		// Is this file blacklisted ?
+		// We have to check early so that if necessary the file's status stays at CRAWLING 
+		// and it is removed from the index at the end of this crawl
+		if (PinotSettings::getInstance().isBlackListed(entryName) == false)
+		{
+			if (itemExists == false)
+			{
+				// Record it
+				history.insertItem(docInfo.getLocation(), CrawlHistory::CRAWLED, m_sourceId, fileStat.st_mtime);
+#ifdef DEBUG
+				cout << "DirectoryScannerThread::scanEntry: reporting new file " << entryName << endl;
+#endif
+				reportFile = true;
+			}
+			else
+			{
+				// Update the record
+				history.updateItem(docInfo.getLocation(), CrawlHistory::CRAWLED, fileStat.st_mtime);
+
+				// Was it last crawled after it was modified ?
+				if (itemDate < fileStat.st_mtime)
+				{
+#ifdef DEBUG
+					cout << "DirectoryScannerThread::scanEntry: reporting modified file " << entryName << endl;
+#endif
+					// No, crawl and index it again
+					reportFile = true;
+				}
+			}
+		}
+
+		if (reportFile == true)
+		{
+			Url urlObj(docInfo.getLocation());
+
+			docInfo.setTitle(urlObj.getFile());
+			docInfo.setTimestamp(TimeConverter::toTimestamp(fileStat.st_mtime));
+			docInfo.setSize(fileStat.st_size);
+
+			foundFile(docInfo);
+		}
+	}
+	else if (S_ISDIR(fileStat.st_mode))
+	{
+		// Can we scan this directory ?
+		if (((m_maxLevel == 0) ||
+			(m_currentLevel < m_maxLevel)) &&
+			(PinotSettings::getInstance().isBlackListed(entryName) == false))
+		{
+			++m_currentLevel;
+
+			// Open the directory
+			DIR *pDir = opendir(entryName.c_str());
+			if (pDir == NULL)
+			{
+				return false;
+			}
+#ifdef DEBUG
+			cout << "DirectoryScannerThread::scanEntry: entering " << entryName << endl;
+#endif
+
+			if (m_pMonitor != NULL)
+			{
+				// Monitor first so that we don't miss events
+				m_pMonitor->addLocation(entryName, true);
+			}
+
+			// Iterate through this directory's entries
+			struct dirent *pDirEntry = readdir(pDir);
+			while ((m_done == false) &&
+				(pDirEntry != NULL))
+			{
+				char *pEntryName = pDirEntry->d_name;
+
+				// Skip . .. and dotfiles
+				if ((pEntryName != NULL) &&
+					(pEntryName[0] != '.'))
+				{
+					string subEntryName(entryName);
+
+					if (entryName[entryName.length() - 1] != '/')
+					{
+						subEntryName += "/";
+					}
+					subEntryName += pEntryName;
+
+					// Scan this entry
+					if (scanEntry(subEntryName) == false)
+					{
+#ifdef DEBUG
+						cout << "DirectoryScannerThread::scanEntry: failed to open "
+							<< subEntryName << endl;
+#endif
+					}
+				}
+
+				// Next entry
+				pDirEntry = readdir(pDir);
+			}
+#ifdef DEBUG
+			cout << "DirectoryScannerThread::scanEntry: done with " << entryName << endl;
+#endif
+
+			// Close the directory
+			closedir(pDir);
+			--m_currentLevel;
+		}
+	}
+	else
+	{
+		return false;
+	}
+
+	return true;
+}
+
+void DirectoryScannerThread::doWork(void)
+{
+	CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
+	set<string> deletedFiles;
+
+	if (m_dirName.empty() == true)
+	{
+		return;
+	}
+
+	// Update this source's items status
+	history.updateItemsStatus(m_sourceId, CrawlHistory::CRAWLED, CrawlHistory::CRAWLING);
+
+	if (scanEntry(m_dirName) == false)
+	{
+		m_status = _("Couldn't open directory");
+		m_status += " ";
+		m_status += m_dirName;
+	}
+
+	if (m_done == true)
+	{
+#ifdef DEBUG
+		cout << "DirectoryScannerThread::doWork: leaving cleanup until next crawl" << endl;
+#endif
+		return;
+	}
+
+	// All files with status set to CRAWLING were not found in this crawl
+	// Chances are they were removed after the previous crawl
+	if ((m_pHandler != NULL) &&
+		(history.getSourceItems(m_sourceId, CrawlHistory::CRAWLING, deletedFiles) > 0))
+	{
+#ifdef DEBUG
+		cout << "DirectoryScannerThread::doWork: " << deletedFiles.size() << " files were deleted" << endl;
+#endif
+		for(set<string>::const_iterator fileIter = deletedFiles.begin();
+			fileIter != deletedFiles.end(); ++fileIter)
+		{
+			// Inform the MonitorHandler
+			if (m_pHandler->fileDeleted(fileIter->substr(7)) == true)
+			{
+				// Delete this item
+				history.deleteItem(*fileIter);
+			}
+		}
+	}
+#ifdef DEBUG
+	cout << "DirectoryScannerThread::doWork: done crawling " << m_dirName << endl;
+#endif
+}
+
+DBusServletThread::DBusServletThread(DaemonState *pServer, DBusConnection *pConnection, DBusMessage *pRequest) :
+	WorkerThread(),
+	m_pServer(pServer),
+	m_pConnection(pConnection),
+	m_pRequest(pRequest),
+	m_pReply(NULL),
+	m_pArray(NULL),
+	m_mustQuit(false)
+{
+}
+
+DBusServletThread::~DBusServletThread()
+{
+	if (m_pArray != NULL)
+	{
+		// Free the array
+		g_ptr_array_free(m_pArray, TRUE);
+	}
+	if (m_pRequest != NULL)
+	{
+		dbus_message_ref(m_pRequest);
+	}
+	if (m_pConnection != NULL)
+	{
+		dbus_connection_ref(m_pConnection);
+	}
+}
+
+string DBusServletThread::getType(void) const
+{
+	return "DBusServletThread";
+}
+
+bool DBusServletThread::stop(void)
+{
+	m_done = true;
+	return true;
+}
+
+DBusConnection *DBusServletThread::getConnection(void) const
+{
+	return m_pConnection;
+}
+
+DBusMessage *DBusServletThread::getReply(void) const
+{
+	return m_pReply;
+}
+
+bool DBusServletThread::mustQuit(void) const
+{
+	return m_mustQuit;
+}
+
+void DBusServletThread::doWork(void)
+{
+	XapianIndex index(PinotSettings::getInstance().m_daemonIndexLocation);
+	DBusError error;
+	const char *pSender = dbus_message_get_sender(m_pRequest);
+	bool processedMessage = true, flushIndex = false;
+
+	if ((m_pServer == NULL) ||
+		(m_pConnection == NULL) ||
+		(m_pRequest == NULL))
+	{
+		return;
+	}
+
+	dbus_error_init(&error);
+
+#ifdef DEBUG
+	if (pSender != NULL)
+	{
+		cout << "DBusServletThread::doWork: called by " << pSender << endl;
+	}
+	else
+	{
+		cout << "DBusServletThread::doWork: called by unknown sender" << endl;
+	}
+#endif
+
+	if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "DeleteLabel") == TRUE)
+	{
+		char *pLabel = NULL;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_STRING, &pLabel,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received DeleteLabel " << pLabel << endl;
+#endif
+			// Delete the label
+			flushIndex = index.deleteLabel(pLabel);
+
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
+			{
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_STRING, &pLabel,
+					DBUS_TYPE_INVALID);
+			}
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "GetDocumentInfo") == TRUE)
+	{
+		unsigned int docId = 0;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_UINT32, &docId,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+			DocumentInfo docInfo;
+
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received GetDocumentInfo " << docId << endl;
+#endif
+			if (index.getDocumentInfo(docId, docInfo) == true)
+			{
+				// Prepare the reply
+				m_pReply = newDBusReply(m_pRequest);
+				if (m_pReply != NULL)
+				{
+					string language(Languages::toEnglish(docInfo.getLanguage()));
+					const char *pTitle = docInfo.getTitle().c_str();
+					const char *pLocation = docInfo.getLocation().c_str();
+					const char *pType = docInfo.getType().c_str();
+					const char *pLanguage = language.c_str();
+
+					dbus_message_append_args(m_pReply,
+						DBUS_TYPE_STRING, &pTitle,
+						DBUS_TYPE_STRING, &pLocation,
+						DBUS_TYPE_STRING, &pType,
+						DBUS_TYPE_STRING, &pLanguage,
+						DBUS_TYPE_INVALID);
+				}
+			}
+			else
+			{
+				m_pReply = dbus_message_new_error(m_pRequest,
+					"de.berlios.Pinot.GetDocumentInfo",
+					"Unknown document");
+			}
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "GetDocumentLabels") == TRUE)
+	{
+		unsigned int docId = 0;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_UINT32, &docId,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+			set<string> labels;
+
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received GetDocumentLabels " << docId << endl;
+#endif
+			if (index.getDocumentLabels(docId, labels) == true)
+			{
+				m_pArray = g_ptr_array_new();
+
+				for (set<string>::const_iterator labelIter = labels.begin();
+					labelIter != labels.end(); ++labelIter)
+				{
+					string labelName(*labelIter);
+
+					g_ptr_array_add(m_pArray, const_cast<char*>(labelName.c_str()));
+#ifdef DEBUG
+					cout << "DBusServletThread::doWork: adding label " << m_pArray->len << " " << labelName << endl;
+#endif
+				}
+
+				// Prepare the reply
+				m_pReply = newDBusReply(m_pRequest);
+				if (m_pReply != NULL)
+				{
+					dbus_message_append_args(m_pReply,
+						DBUS_TYPE_ARRAY, DBUS_TYPE_STRING, &m_pArray->pdata, m_pArray->len,
+						DBUS_TYPE_INVALID);
+				}
+			}
+			else
+			{
+				m_pReply = dbus_message_new_error(m_pRequest,
+					"de.berlios.Pinot.GetDocumentLabels",
+					" failed");
+			}
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "GetStatistics") == TRUE)
+	{
+		CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
+		unsigned int crawledFilesCount = history.getItemsCount();
+		unsigned int docsCount = index.getDocumentsCount();
+
+#ifdef DEBUG
+		cout << "DBusServletThread::doWork: received GetStatistics" << endl;
+#endif
+		// Prepare the reply
+		m_pReply = newDBusReply(m_pRequest);
+		if (m_pReply != NULL)
+		{
+			dbus_message_append_args(m_pReply,
+				DBUS_TYPE_UINT32, &crawledFilesCount,
+				DBUS_TYPE_UINT32, &docsCount,
+				DBUS_TYPE_INVALID);
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "RenameLabel") == TRUE)
+	{
+		char *pOldLabel = NULL;
+		char *pNewLabel = NULL;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_STRING, &pOldLabel,
+			DBUS_TYPE_STRING, &pNewLabel,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received RenameLabel " << pOldLabel << ", " << pNewLabel << endl;
+#endif
+			// Rename the label
+			flushIndex = index.renameLabel(pOldLabel, pNewLabel);
+
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
+			{
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_STRING, &pNewLabel,
+					DBUS_TYPE_INVALID);
+			}
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "SetDocumentInfo") == TRUE)
+	{
+		char *pTitle = NULL;
+		char *pLocation = NULL;
+		char *pType = NULL;
+		char *pLanguage = NULL;
+		unsigned int docId = 0;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_UINT32, &docId,
+			DBUS_TYPE_STRING, &pTitle,
+			DBUS_TYPE_STRING, &pLocation,
+			DBUS_TYPE_STRING, &pType,
+			DBUS_TYPE_STRING, &pLanguage,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+			DocumentInfo docInfo(pTitle, pLocation, pType,
+				((pLanguage != NULL) ? Languages::toLocale(pLanguage) : ""));
+
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received SetDocumentInfo " << docId << ", " << pTitle
+				<< ", " << pLocation << ", " << pType << ", " << pLanguage << endl;
+#endif
+
+			// Update the document info
+			flushIndex = index.updateDocumentInfo(docId, docInfo);
+
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
+			{
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_UINT32, &docId,
+					DBUS_TYPE_INVALID);
+			}
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "SetDocumentLabels") == TRUE)
+	{
+		char **ppLabels = NULL;
+		dbus_uint32_t labelsCount = 0;
+		unsigned int docId = 0;
+		gboolean resetLabels = TRUE;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_UINT32, &docId,
+			DBUS_TYPE_ARRAY, DBUS_TYPE_STRING, &ppLabels, &labelsCount,
+			DBUS_TYPE_BOOLEAN, &resetLabels,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+			set<string> labels;
+
+			for (dbus_uint32_t labelIndex = 0; labelIndex < labelsCount; ++labelIndex)
+			{
+				if (ppLabels[labelIndex] == NULL)
+				{
+					break;
+				}
+				labels.insert(ppLabels[labelIndex]);
+			}
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received SetDocumentLabels " << docId << ", " << resetLabels
+				<< " with " << labelsCount << " labels" << endl;
+#endif
+			// Set labels
+			flushIndex = index.setDocumentLabels(docId, labels, ((resetLabels == TRUE) ? true : false));
+
+			// Free container types
+			g_strfreev(ppLabels);
+
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
+			{
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_UINT32, &docId,
+					DBUS_TYPE_INVALID);
+			}
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "SimpleQuery") == TRUE)
+	{
+		char *pSearchText = NULL;
+		dbus_uint32_t maxHits = 0;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_STRING, &pSearchText,
+			DBUS_TYPE_UINT32, &maxHits,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+			XapianEngine engine(PinotSettings::getInstance().m_daemonIndexLocation);
+			bool replyWithError = true;
+
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received SimpleQuery " << pSearchText << ", " << maxHits << endl;
+#endif
+			if (pSearchText != NULL)
+			{
+				QueryProperties queryProps("DBUS", pSearchText);
+
+				// Run the query
+				engine.setMaxResultsCount(maxHits);
+				if (engine.runQuery(queryProps) == true)
+				{
+					const vector<Result> &resultsList = engine.getResults();
+					vector<string> docIds;
+					m_pArray = g_ptr_array_new();
+
+					for (vector<Result>::const_iterator resultIter = resultsList.begin();
+						resultIter != resultsList.end(); ++resultIter)
+					{
+						// We only need the document ID
+						unsigned int docId = index.hasDocument(resultIter->getLocation());
+						if (docId > 0)
+						{
+							char docIdStr[64];
+							snprintf(docIdStr, 64, "%u", docId);
+							docIds.push_back(docIdStr);
+						}
+					}
+
+					for (vector<string>::const_iterator docIter = docIds.begin();
+						docIter != docIds.end(); ++docIter)
+					{
+#ifdef DEBUG
+						cout << "DBusServletThread::doWork: adding result " << m_pArray->len << " " << *docIter << endl;
+#endif
+						g_ptr_array_add(m_pArray, const_cast<char*>(docIter->c_str()));
+					}
+
+					// Prepare the reply
+					m_pReply = newDBusReply(m_pRequest);
+					if (m_pReply != NULL)
+					{
+						dbus_message_append_args(m_pReply,
+							DBUS_TYPE_ARRAY, DBUS_TYPE_STRING, &m_pArray->pdata, m_pArray->len,
+							DBUS_TYPE_INVALID);
+
+						replyWithError = false;
+					}
+				}
+			}
+
+			if (replyWithError == true)
+			{
+				m_pReply = dbus_message_new_error(m_pRequest,
+					"de.berlios.Pinot.SimpleQuery",
+					"Query failed");
+			}
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "Stop") == TRUE)
+	{
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+			int exitStatus = EXIT_SUCCESS;
+
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received Stop" << endl;
+#endif
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
+			{
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_INT32, &exitStatus,
+					DBUS_TYPE_INVALID);
+			}
+
+			m_mustQuit = true;
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "UpdateDocument") == TRUE)
+	{
+		unsigned int docId = 0;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_UINT32, &docId,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+			DocumentInfo docInfo;
+
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received UpdateDocument " << docId << endl;
+#endif
+			if (index.getDocumentInfo(docId, docInfo) == true)
+			{
+				// Update document
+				m_pServer->queue_index(docInfo);
+			}
+
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
+			{
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_UINT32, &docId,
+					DBUS_TYPE_INVALID);
+			}
+		}
+	}
+	else
+	{
+#ifdef DEBUG
+		cout << "DBusServletThread::doWork: foreign message for/from " << dbus_message_get_interface(m_pRequest)
+			<< " " << dbus_message_get_member(m_pRequest) << endl;
+#endif
+		processedMessage = false;
+	}
+
+	// Did an error occur ?
+	if (error.message != NULL)
+	{
+#ifdef DEBUG
+		cout << "DBusServletThread::doWork: error occured: " << error.message << endl;
+#endif
+		// Use the error message as reply
+		m_pReply = dbus_message_new_error(m_pRequest, error.name, error.message);
+	}
+
+	dbus_error_free(&error);
+
+	if (flushIndex == true)
+	{
+		// Flush now for the sake of the client application
+		index.flush();
+	}
+
+	// Send a reply ?
+	if ((m_pConnection != NULL) &&
+		(m_pReply != NULL))
+	{
+		dbus_connection_send(m_pConnection, m_pReply, NULL);
+		dbus_connection_flush(m_pConnection);
+#ifdef DEBUG
+		cout << "DBusServletThread::doWork: sent reply" << endl;
+#endif
+		dbus_message_unref(m_pReply);
+	}
+}
+

Added: trunk/UI/GTK2/src/ServerThreads.h
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.h	2006-12-10 07:09:09 UTC (rev 638)
+++ trunk/UI/GTK2/src/ServerThreads.h	2006-12-10 07:18:22 UTC (rev 639)
@@ -0,0 +1,136 @@
+/*
+ *  Copyright 2005,2006 Fabrice Colin
+ *
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU Library General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ */
+
+#ifndef _SERVERTHREADS_HH
+#define _SERVERTHREADS_HH
+
+#include <string>
+extern "C"
+{
+#define DBUS_API_SUBJECT_TO_CHANGE
+#include <dbus/dbus.h>
+#include <dbus/dbus-glib.h>
+#include <dbus/dbus-glib-lowlevel.h>
+}
+#include <sigc++/object.h>
+#include <sigc++/slot.h>
+#include <sigc++/connection.h>
+#include <glibmm/ustring.h>
+
+#include "DocumentInfo.h"
+#include "MonitorInterface.h"
+#include "MonitorHandler.h"
+#include "WorkerThreads.h"
+
+class MonitorThread : public WorkerThread
+{
+	public:
+		MonitorThread(MonitorInterface *pMonitor, MonitorHandler *pHandler);
+		virtual ~MonitorThread();
+
+		virtual std::string getType(void) const;
+
+		virtual bool stop(void);
+
+		SigC::Signal3<void, const DocumentInfo&, const std::string&, bool>& getDirectoryFoundSignal(void);
+
+	protected:
+		int m_ctrlReadPipe;
+		int m_ctrlWritePipe;
+		MonitorInterface *m_pMonitor;
+		MonitorHandler *m_pHandler;
+		SigC::Signal3<void, const DocumentInfo&, const std::string&, bool> m_signalDirectoryFound;
+
+		void processEvents(void);
+		virtual void doWork(void);
+
+	private:
+		MonitorThread(const MonitorThread &other);
+		MonitorThread &operator=(const MonitorThread &other);
+
+};
+
+class DirectoryScannerThread : public WorkerThread
+{
+	public:
+		DirectoryScannerThread(const std::string &dirName, bool isSource,
+			unsigned int maxLevel, bool followSymLinks,
+			MonitorInterface *pMonitor, MonitorHandler *pHandler);
+		virtual ~DirectoryScannerThread();
+
+		virtual std::string getType(void) const;
+
+		virtual std::string getDirectory(void) const;
+
+		virtual bool stop(void);
+
+		SigC::Signal3<void, const DocumentInfo&, const std::string&, bool>& getFileFoundSignal(void);
+
+	protected:
+		std::string m_dirName;
+		unsigned int m_maxLevel;
+		bool m_followSymLinks;
+		MonitorInterface *m_pMonitor;
+		MonitorHandler *m_pHandler;
+		unsigned int m_currentLevel;
+		unsigned int m_sourceId;
+		SigC::Signal3<void, const DocumentInfo&, const std::string&, bool> m_signalFileFound;
+
+		void foundFile(const DocumentInfo &docInfo);
+		bool scanEntry(const std::string &entryName);
+		virtual void doWork(void);
+
+	private:
+		DirectoryScannerThread(const DirectoryScannerThread &other);
+		DirectoryScannerThread &operator=(const DirectoryScannerThread &other);
+
+};
+
+class DBusServletThread : public WorkerThread
+{
+	public:
+		DBusServletThread(DaemonState *pServer, DBusConnection *pConnection, DBusMessage *pRequest);
+		virtual ~DBusServletThread();
+
+		virtual std::string getType(void) const;
+
+		virtual bool stop(void);
+
+		DBusConnection *getConnection(void) const;
+
+		DBusMessage *getReply(void) const;
+
+		bool mustQuit(void) const;
+
+	protected:
+		DaemonState *m_pServer;
+		DBusConnection *m_pConnection;
+		DBusMessage *m_pRequest;
+		DBusMessage *m_pReply;
+		GPtrArray *m_pArray;
+		bool m_mustQuit;
+
+		virtual void doWork(void);
+
+	private:
+		DBusServletThread(const DBusServletThread &other);
+		DBusServletThread &operator=(const DBusServletThread &other);
+
+};
+
+#endif // _SERVERTHREADS_HH

Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-10 07:09:09 UTC (rev 638)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-12-10 07:18:22 UTC (rev 639)
@@ -16,9 +16,6 @@
  *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
  */
 
-#include <sys/types.h>
-#include <dirent.h>
-#include <sys/stat.h>
 #include <unistd.h>
 #include <stdlib.h>
 #include <fcntl.h>
@@ -42,7 +39,6 @@
 #include "Url.h"
 #include "XapianDatabase.h"
 #include "ActionQueue.h"
-#include "CrawlHistory.h"
 #include "QueryHistory.h"
 #include "IndexedDocument.h"
 #include "DownloaderFactory.h"
@@ -1151,35 +1147,38 @@
 	}
 
 	// We may not have to download the document
-	if (thisUrl.getProtocol() == "file")
+	// If coming from a crawl, this will be empty
+	if (m_docInfo.getType().empty() == true)
 	{
-		// If coming from a crawl, this will be empty
-		if (m_docInfo.getType().empty() == true)
-		{
-			m_docInfo.setType(MIMEScanner::scanFile(m_docInfo.getLocation()));
-		}
+		m_docInfo.setType(MIMEScanner::scanFile(m_docInfo.getLocation()));
+	}
 
-		if (TokenizerFactory::isSupportedType(m_docInfo.getType(), dataNeeds) == false)
+	if (TokenizerFactory::isSupportedType(m_docInfo.getType(), dataNeeds) == false)
+	{
+		// Skip unsupported types ?
+		if (m_allowAllMIMETypes == false)
 		{
-			// Skip unsupported types ?
-			if (m_allowAllMIMETypes == false)
-			{
-				m_status = _("Cannot index document type");
-				m_status += " ";
-				m_status += m_docInfo.getType();
-				m_status += " ";
-				m_status += _("at");
-				m_status += " ";
-				m_status += m_docInfo.getLocation();
-				return;
-			}
+			m_status = _("Cannot index document type");
+			m_status += " ";
+			m_status += m_docInfo.getType();
+			m_status += " ";
+			m_status += _("at");
+			m_status += " ";
+			m_status += m_docInfo.getLocation();
+			return;
 		}
-		else if (dataNeeds == Tokenizer::ALL_BUT_FILES)
-		{
-			doDownload = false;
-		}
 	}
 
+	if ((dataNeeds == Tokenizer::ALL_BUT_FILES) &&
+		(thisUrl.getProtocol() == "file"))
+	{
+		doDownload = false;
+	}
+	else if (dataNeeds == Tokenizer::NO_DOCUMENTS)
+	{
+		doDownload = false;
+	}
+
 	if (doDownload == true)
 	{
 		DownloadingThread::doWork();
@@ -1559,558 +1558,3 @@
 	}
 }
 
-MonitorThread::MonitorThread(MonitorInterface *pMonitor, MonitorHandler *pHandler) :
-	WorkerThread(),
-	m_ctrlReadPipe(-1),
-	m_ctrlWritePipe(-1),
-	m_pMonitor(pMonitor),
-	m_pHandler(pHandler)
-{
-	int pipeFds[2];
-
-	if (pipe(pipeFds) == 0)
-	{
-		// This pipe will allow to stop select()
-		m_ctrlReadPipe = pipeFds[0];
-		m_ctrlWritePipe = pipeFds[1];
-	}
-}
-
-MonitorThread::~MonitorThread()
-{
-	close(m_ctrlReadPipe);
-	close(m_ctrlWritePipe);
-}
-
-string MonitorThread::getType(void) const
-{
-	return "MonitorThread";
-}
-
-bool MonitorThread::stop(void)
-{
-	// Disconnect the signal
-	Signal3<void, const DocumentInfo&, const std::string&, bool>::slot_list_type slotsList = m_signalDirectoryFound.slots();
-	Signal3<void, const DocumentInfo&, const std::string&, bool>::slot_list_type::iterator slotIter = slotsList.begin();
-	if (slotIter != slotsList.end())
-	{
-		if (slotIter->empty() == false)
-		{
-			slotIter->block();
-			slotIter->disconnect();
-		}
-	}
-	m_done = true;
-	write(m_ctrlWritePipe, "X", 1);
-
-	return true;
-}
-
-Signal3<void, const DocumentInfo&, const std::string&, bool>& MonitorThread::getDirectoryFoundSignal(void)
-{
-	return m_signalDirectoryFound;
-}
-
-void MonitorThread::processEvents(void)
-{
-	CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
-	queue<MonitorEvent> events;
-
-#ifdef DEBUG
-	cout << "MonitorThread::processEvents: checking for events" << endl;
-#endif
-	if ((m_pMonitor == NULL) ||
-		(m_pMonitor->retrievePendingEvents(events) == false))
-	{
-#ifdef DEBUG
-		cout << "MonitorThread::processEvents: failed to retrieve pending events" << endl;
-#endif
-		return;
-	}
-#ifdef DEBUG
-	cout << "MonitorThread::processEvents: retrieved " << events.size() << " events" << endl;
-#endif
-
-	while ((events.empty() == false) &&
-		(m_done == false))
-	{
-		MonitorEvent &event = events.front();
-
-		if ((event.m_location.empty() == true) ||
-			(event.m_type == MonitorEvent::UNKNOWN))
-		{
-			// Next
-			events.pop();
-			continue;
-		}
-#ifdef DEBUG
-		cout << "MonitorThread::processEvents: event " << event.m_type << " on "
-			<< event.m_location << " " << event.m_isDirectory << endl;
-#endif
-
-		// What's the event code ?
-		if (event.m_type == MonitorEvent::EXISTS)
-		{
-			if (event.m_isDirectory == false)
-			{
-				m_pHandler->fileExists(event.m_location);
-			}
-		}
-		else if (event.m_type == MonitorEvent::CREATED)
-		{
-			if (event.m_isDirectory == false)
-			{
-				m_pHandler->fileCreated(event.m_location);
-			}
-			else
-			{
-				DocumentInfo docInfo("", string("file://") + event.m_location, "", "");
-
-				// Report this directory so that it is crawled
-				m_signalDirectoryFound(docInfo, "", true);
-			}
-		}
-		else if (event.m_type == MonitorEvent::WRITE_CLOSED)
-		{
-			if (event.m_isDirectory == false)
-			{
-				CrawlHistory::CrawlStatus status = CrawlHistory::UNKNOWN;
-				struct stat fileStat;
-				time_t itemDate;
-
-				if (history.hasItem("file://" + event.m_location, status, itemDate) == true)
-				{
-					// Was the file actually modified ?
-					if ((stat(event.m_location.c_str(), &fileStat) == 0) &&
-						(itemDate < fileStat.st_mtime))
-					{
-						m_pHandler->fileModified(event.m_location);
-					}
-#ifdef DEBUG
-					else cout << "MonitorThread::processEvents: file wasn't modified" << endl;
-#endif
-				}
-#ifdef DEBUG
-				else cout << "MonitorThread::processEvents: file wasn't crawled" << endl;
-#endif
-			}
-		}
-		else if (event.m_type == MonitorEvent::MOVED)
-		{
-			if (event.m_isDirectory == false)
-			{
-				m_pHandler->fileMoved(event.m_location, event.m_previousLocation);
-			}
-			else
-			{
-				// We should receive this only if the destination directory is monitored too
-				m_pHandler->directoryMoved(event.m_location, event.m_previousLocation);
-			}
-		}
-		else if (event.m_type == MonitorEvent::DELETED)
-		{
-			if (event.m_isDirectory == false)
-			{
-				m_pHandler->fileDeleted(event.m_location);
-			}
-			else
-			{
-				// The monitor should have stopped monitoring this
-				// In practice, events for the files in this directory will already have been received 
-				m_pHandler->directoryDeleted(event.m_location);
-			}
-		}
-
-		// Next
-		events.pop();
-	}
-}
-
-void MonitorThread::doWork(void)
-{
-	if ((m_pHandler == NULL) ||
-		(m_pMonitor == NULL))
-	{
-		m_status = _("No monitoring handler");
-		return;
-	}
-
-	// Initialize the handler
-	m_pHandler->initialize();
-
-	// Get the list of files to monitor
-	const set<string> &fileNames = m_pHandler->getFileNames();
-	for (set<string>::const_iterator fileIter = fileNames.begin();
-		fileIter != fileNames.end(); ++fileIter)
-	{
-		m_pMonitor->addLocation(*fileIter, false);
-	}
-	// Directories, if any, are set elsewhere
-	// In the case of OnDiskHandler, they are set by DirectoryScannerThread
-
-	// There might already be events that need processing
-	processEvents();
-
-	// Wait for something to happen
-	while (m_done == false)
-	{
-		struct timeval selectTimeout;
-		fd_set listenSet;
-
-		selectTimeout.tv_sec = 60;
-		selectTimeout.tv_usec = 0;
-
-		FD_ZERO(&listenSet);
-		if (m_ctrlReadPipe >= 0)
-		{
-			FD_SET(m_ctrlReadPipe, &listenSet);
-		}
-
-		m_pHandler->flushIndex();
-
-		// The file descriptor may change over time
-		int monitorFd = m_pMonitor->getFileDescriptor();
-		FD_SET(monitorFd, &listenSet);
-		if (monitorFd < 0)
-		{
-			m_status = _("Couldn't initialize file monitor");
-			return;
-		}
-
-		int fdCount = select(max(monitorFd, m_ctrlReadPipe) + 1, &listenSet, NULL, NULL, &selectTimeout);
-		if ((fdCount < 0) &&
-			(errno != EINTR))
-		{
-#ifdef DEBUG
-			cout << "MonitorThread::doWork: select() failed" << endl;
-#endif
-			break;
-		}
-		else if (FD_ISSET(monitorFd, &listenSet))
-		{
-			processEvents();
-		}
-	}
-}
-
-DirectoryScannerThread::DirectoryScannerThread(const string &dirName, bool isSource,
-	unsigned int maxLevel, bool followSymLinks,
-	MonitorInterface *pMonitor, MonitorHandler *pHandler) :
-	WorkerThread(),
-	m_dirName(dirName),
-	m_maxLevel(maxLevel),
-	m_followSymLinks(followSymLinks),
-	m_pMonitor(pMonitor),
-	m_pHandler(pHandler),
-	m_currentLevel(0),
-	m_sourceId(0)
-{
-	if (m_dirName.empty() == false)
-	{
-		CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
-
-		if (isSource == true)
-		{
-			// Does this source exist ?
-			if (history.hasSource("file://" + m_dirName, m_sourceId) == false)
-			{
-				// Create it
-				m_sourceId = history.insertSource("file://" + m_dirName);
-			}
-		}
-		else
-		{
-			map<unsigned int, string> fileSources;
-
-			// What source does this belong to ?
-			for(map<unsigned int, string>::const_iterator sourceIter = fileSources.begin();
-				sourceIter != fileSources.end(); ++sourceIter)
-			{
-				if (sourceIter->second.length() < m_dirName.length())
-				{
-					// Skip
-					continue;
-				}
-
-				if (sourceIter->second.substr(0, m_dirName.length()) == m_dirName)
-				{
-					// That's the one
-					m_sourceId = sourceIter->first;
-					break;
-				}
-			}
-		}
-	}
-}
-
-DirectoryScannerThread::~DirectoryScannerThread()
-{
-}
-
-string DirectoryScannerThread::getType(void) const
-{
-	return "DirectoryScannerThread";
-}
-
-string DirectoryScannerThread::getDirectory(void) const
-{
-	return m_dirName;
-}
-
-bool DirectoryScannerThread::stop(void)
-{
-	// Disconnect the signal
-	Signal3<void, const DocumentInfo&, const std::string&, bool>::slot_list_type slotsList = m_signalFileFound.slots();
-	Signal3<void, const DocumentInfo&, const std::string&, bool>::slot_list_type::iterator slotIter = slotsList.begin();
-	if (slotIter != slotsList.end())
-	{
-		if (slotIter->empty() == false)
-		{
-			slotIter->block();
-			slotIter->disconnect();
-		}
-	}
-	m_done = true;
-
-	return true;
-}
-
-Signal3<void, const DocumentInfo&, const std::string&, bool>& DirectoryScannerThread::getFileFoundSignal(void)
-{
-	return m_signalFileFound;
-}
-
-void DirectoryScannerThread::foundFile(const DocumentInfo &docInfo)
-{
-	char labelStr[64];
-
-	if ((docInfo.getLocation().empty() == true) ||
-		(m_done == true))
-	{
-		return;
-	}
-
-	// This identifies the source
-	snprintf(labelStr, 64, "SOURCE%u", m_sourceId);
-
-	m_signalFileFound(docInfo, labelStr, false);
-}
-
-bool DirectoryScannerThread::scanEntry(const string &entryName)
-{
-	CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
-	CrawlHistory::CrawlStatus status = CrawlHistory::UNKNOWN;
-	time_t itemDate;
-	struct stat fileStat;
-	int statSuccess = 0;
-
-	if (entryName.empty() == true)
-	{
-		return false;
-	}
-
-	// Skip . .. and dotfiles
-	Url urlObj("file://" + entryName);
-	if (urlObj.getFile()[0] == '.')
-	{
-		return false;
-	}
-
-	if (m_followSymLinks == false)
-	{
-		statSuccess = lstat(entryName.c_str(), &fileStat);
-	}
-	else
-	{
-		// Stat the files pointed to by symlinks
-		statSuccess = stat(entryName.c_str(), &fileStat);
-	}
-
-	if (statSuccess == -1)
-	{
-		return false;
-	}
-
-	bool itemExists = history.hasItem("file://" + entryName, status, itemDate);
-
-	// Is it a file or a directory ?
-	if (S_ISLNK(fileStat.st_mode))
-	{
-		// This won't happen when m_followSymLinks is true
-		return false;
-	}
-	else if (S_ISREG(fileStat.st_mode))
-	{
-		DocumentInfo docInfo;
-		bool reportFile = false;
-
-		docInfo.setLocation("file://" + entryName);
-
-		// Is this file blacklisted ?
-		// We have to check early so that if necessary the file's status stays at CRAWLING 
-		// and it is removed from the index at the end of this crawl
-		if (PinotSettings::getInstance().isBlackListed(entryName) == false)
-		{
-			if (itemExists == false)
-			{
-				// Record it
-				history.insertItem(docInfo.getLocation(), CrawlHistory::CRAWLED, m_sourceId, fileStat.st_mtime);
-#ifdef DEBUG
-				cout << "DirectoryScannerThread::scanEntry: reporting new file " << entryName << endl;
-#endif
-				reportFile = true;
-			}
-			else
-			{
-				// Update the record
-				history.updateItem(docInfo.getLocation(), CrawlHistory::CRAWLED, fileStat.st_mtime);
-
-				// Was it last crawled after it was modified ?
-				if (itemDate < fileStat.st_mtime)
-				{
-#ifdef DEBUG
-					cout << "DirectoryScannerThread::scanEntry: reporting modified file " << entryName << endl;
-#endif
-					// No, crawl and index it again
-					reportFile = true;
-				}
-			}
-		}
-
-		if (reportFile == true)
-		{
-			Url urlObj(docInfo.getLocation());
-
-			docInfo.setTitle(urlObj.getFile());
-			docInfo.setTimestamp(TimeConverter::toTimestamp(fileStat.st_mtime));
-			docInfo.setSize(fileStat.st_size);
-
-			foundFile(docInfo);
-		}
-	}
-	else if (S_ISDIR(fileStat.st_mode))
-	{
-		// Can we scan this directory ?
-		if (((m_maxLevel == 0) ||
-			(m_currentLevel < m_maxLevel)) &&
-			(PinotSettings::getInstance().isBlackListed(entryName) == false))
-		{
-			++m_currentLevel;
-
-			// Open the directory
-			DIR *pDir = opendir(entryName.c_str());
-			if (pDir == NULL)
-			{
-				return false;
-			}
-#ifdef DEBUG
-			cout << "DirectoryScannerThread::scanEntry: entering " << entryName << endl;
-#endif
-
-			if (m_pMonitor != NULL)
-			{
-				// Monitor first so that we don't miss events
-				m_pMonitor->addLocation(entryName, true);
-			}
-
-			// Iterate through this directory's entries
-			struct dirent *pDirEntry = readdir(pDir);
-			while ((m_done == false) &&
-				(pDirEntry != NULL))
-			{
-				char *pEntryName = pDirEntry->d_name;
-
-				// Skip . .. and dotfiles
-				if ((pEntryName != NULL) &&
-					(pEntryName[0] != '.'))
-				{
-					string subEntryName(entryName);
-
-					if (entryName[entryName.length() - 1] != '/')
-					{
-						subEntryName += "/";
-					}
-					subEntryName += pEntryName;
-
-					// Scan this entry
-					if (scanEntry(subEntryName) == false)
-					{
-#ifdef DEBUG
-						cout << "DirectoryScannerThread::scanEntry: failed to open "
-							<< subEntryName << endl;
-#endif
-					}
-				}
-
-				// Next entry
-				pDirEntry = readdir(pDir);
-			}
-#ifdef DEBUG
-			cout << "DirectoryScannerThread::scanEntry: done with " << entryName << endl;
-#endif
-
-			// Close the directory
-			closedir(pDir);
-			--m_currentLevel;
-		}
-	}
-	else
-	{
-		return false;
-	}
-
-	return true;
-}
-
-void DirectoryScannerThread::doWork(void)
-{
-	CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
-	set<string> deletedFiles;
-
-	if (m_dirName.empty() == true)
-	{
-		return;
-	}
-
-	// Update this source's items status
-	history.updateItemsStatus(m_sourceId, CrawlHistory::CRAWLED, CrawlHistory::CRAWLING);
-
-	if (scanEntry(m_dirName) == false)
-	{
-		m_status = _("Couldn't open directory");
-		m_status += " ";
-		m_status += m_dirName;
-	}
-
-	if (m_done == true)
-	{
-#ifdef DEBUG
-		cout << "DirectoryScannerThread::doWork: leaving cleanup until next crawl" << endl;
-#endif
-		return;
-	}
-
-	// All files with status set to CRAWLING were not found in this crawl
-	// Chances are they were removed after the previous crawl
-	if ((m_pHandler != NULL) &&
-		(history.getSourceItems(m_sourceId, CrawlHistory::CRAWLING, deletedFiles) > 0))
-	{
-#ifdef DEBUG
-		cout << "DirectoryScannerThread::doWork: " << deletedFiles.size() << " files were deleted" << endl;
-#endif
-		for(set<string>::const_iterator fileIter = deletedFiles.begin();
-			fileIter != deletedFiles.end(); ++fileIter)
-		{
-			// Inform the MonitorHandler
-			if (m_pHandler->fileDeleted(fileIter->substr(7)) == true)
-			{
-				// Delete this item
-				history.deleteItem(*fileIter);
-			}
-		}
-	}
-#ifdef DEBUG
-	cout << "DirectoryScannerThread::doWork: done crawling " << m_dirName << endl;
-#endif
-}
-

Modified: trunk/UI/GTK2/src/WorkerThreads.h
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.h	2006-12-10 07:09:09 UTC (rev 638)
+++ trunk/UI/GTK2/src/WorkerThreads.h	2006-12-10 07:18:22 UTC (rev 639)
@@ -34,12 +34,10 @@
 #include <glibmm/ustring.h>
 
 #include "Document.h"
-#include "MonitorInterface.h"
 #include "IndexedDocument.h"
 #include "DownloaderInterface.h"
 #include "QueryProperties.h"
 #include "Result.h"
-#include "MonitorHandler.h"
 
 class WorkerThread
 {
@@ -394,68 +392,4 @@
 
 };
 
-class MonitorThread : public WorkerThread
-{
-	public:
-		MonitorThread(MonitorInterface *pMonitor, MonitorHandler *pHandler);
-		virtual ~MonitorThread();
-
-		virtual std::string getType(void) const;
-
-		virtual bool stop(void);
-
-		SigC::Signal3<void, const DocumentInfo&, const std::string&, bool>& getDirectoryFoundSignal(void);
-
-	protected:
-		int m_ctrlReadPipe;
-		int m_ctrlWritePipe;
-		MonitorInterface *m_pMonitor;
-		MonitorHandler *m_pHandler;
-		SigC::Signal3<void, const DocumentInfo&, const std::string&, bool> m_signalDirectoryFound;
-
-		void processEvents(void);
-		virtual void doWork(void);
-
-	private:
-		MonitorThread(const MonitorThread &other);
-		MonitorThread &operator=(const MonitorThread &other);
-
-};
-
-class DirectoryScannerThread : public WorkerThread
-{
-	public:
-		DirectoryScannerThread(const std::string &dirName, bool isSource,
-			unsigned int maxLevel, bool followSymLinks,
-			MonitorInterface *pMonitor, MonitorHandler *pHandler);
-		virtual ~DirectoryScannerThread();
-
-		virtual std::string getType(void) const;
-
-		virtual std::string getDirectory(void) const;
-
-		virtual bool stop(void);
-
-		SigC::Signal3<void, const DocumentInfo&, const std::string&, bool>& getFileFoundSignal(void);
-
-	protected:
-		std::string m_dirName;
-		unsigned int m_maxLevel;
-		bool m_followSymLinks;
-		MonitorInterface *m_pMonitor;
-		MonitorHandler *m_pHandler;
-		unsigned int m_currentLevel;
-		unsigned int m_sourceId;
-		SigC::Signal3<void, const DocumentInfo&, const std::string&, bool> m_signalFileFound;
-
-		void foundFile(const DocumentInfo &docInfo);
-		bool scanEntry(const std::string &entryName);
-		virtual void doWork(void);
-
-	private:
-		DirectoryScannerThread(const DirectoryScannerThread &other);
-		DirectoryScannerThread &operator=(const DirectoryScannerThread &other);
-
-};
-
 #endif // _WORKERTHREADS_HH

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-10 07:09:09 UTC (rev 638)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-10 07:18:22 UTC (rev 639)
@@ -31,13 +31,6 @@
 #include <glibmm/miscutils.h>
 #include <glibmm/convert.h>
 #include <glibmm/object.h>
-extern "C"
-{
-#define DBUS_API_SUBJECT_TO_CHANGE
-#include <dbus/dbus.h>
-#include <dbus/dbus-glib.h>
-#include <dbus/dbus-glib-lowlevel.h>
-}
 #include <glibmm/main.h>
 
 #include "TokenizerFactory.h"
@@ -57,6 +50,7 @@
 #include "NLS.h"
 #include "DaemonState.h"
 #include "PinotSettings.h"
+#include "ServerThreads.h"
 
 using namespace std;
 
@@ -116,22 +110,6 @@
 	}
 }
 
-static DBusMessage *newDBusReply(DBusMessage *pMessage)
-{
-	if (pMessage == NULL)
-	{
-		return NULL;
-	}
-
-	DBusMessage *pReply = dbus_message_new_method_return(pMessage);
-	if (pReply != NULL)
-	{
-		return pReply;
-	}
-
-	return NULL;
-}
-
 static DBusHandlerResult filterHandler(DBusConnection *pConnection, DBusMessage *pMessage, void *pData)
 {
 #ifdef DEBUG
@@ -164,454 +142,23 @@
 
 static DBusHandlerResult messageHandler(DBusConnection *pConnection, DBusMessage *pMessage, void *pData)
 {
-	XapianIndex index(PinotSettings::getInstance().m_daemonIndexLocation);
 	DaemonState *pServer = NULL;
-	DBusMessage *pReply = NULL;
-	DBusError error;
-	const char *pSender = dbus_message_get_sender(pMessage);
-	bool processedMessage = true, flushIndex = false, quitLoop = false;
 
 	if (pData != NULL)
 	{
 		pServer = (DaemonState *)pData;
 	}
 
-	dbus_error_init(&error);
-
-#ifdef DEBUG
-	if (pSender != NULL)
+	if ((pConnection != NULL) &&
+		(pMessage != NULL))
 	{
-		cout << "messageHandler: called by " << pSender << endl;
-	}
-	else
-	{
-		cout << "messageHandler: called by unknown sender" << endl;
-	}
-#endif
+		dbus_connection_ref(pConnection);
+		dbus_message_ref(pMessage);
 
-	if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "DeleteLabel") == TRUE)
-	{
-		char *pLabel = NULL;
-
-		if (dbus_message_get_args(pMessage, &error,
-			DBUS_TYPE_STRING, &pLabel,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-#ifdef DEBUG
-			cout << "messageHandler: received DeleteLabel " << pLabel << endl;
-#endif
-			// Delete the label
-			flushIndex = index.deleteLabel(pLabel);
-
-			// Prepare the reply
-			pReply = newDBusReply(pMessage);
-			if (pReply != NULL)
-			{
-				dbus_message_append_args(pReply,
-					DBUS_TYPE_STRING, &pLabel,
-					DBUS_TYPE_INVALID);
-			}
-		}
+		pServer->start_thread(new DBusServletThread(pServer, pConnection, pMessage));
 	}
-	else if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "GetDocumentInfo") == TRUE)
-	{
-		unsigned int docId = 0;
 
-		if (dbus_message_get_args(pMessage, &error,
-			DBUS_TYPE_UINT32, &docId,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-			DocumentInfo docInfo;
-
-#ifdef DEBUG
-			cout << "messageHandler: received GetDocumentInfo " << docId << endl;
-#endif
-			if (index.getDocumentInfo(docId, docInfo) == true)
-			{
-				// Prepare the reply
-				pReply = newDBusReply(pMessage);
-				if (pReply != NULL)
-				{
-					string language(Languages::toEnglish(docInfo.getLanguage()));
-					const char *pTitle = docInfo.getTitle().c_str();
-					const char *pLocation = docInfo.getLocation().c_str();
-					const char *pType = docInfo.getType().c_str();
-					const char *pLanguage = language.c_str();
-
-					dbus_message_append_args(pReply,
-						DBUS_TYPE_STRING, &pTitle,
-						DBUS_TYPE_STRING, &pLocation,
-						DBUS_TYPE_STRING, &pType,
-						DBUS_TYPE_STRING, &pLanguage,
-						DBUS_TYPE_INVALID);
-				}
-			}
-			else
-			{
-				pReply = dbus_message_new_error(pMessage,
-					"de.berlios.Pinot.GetDocumentInfo",
-					"Unknown document");
-			}
-		}
-	}
-	else if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "GetDocumentLabels") == TRUE)
-	{
-		unsigned int docId = 0;
-
-		if (dbus_message_get_args(pMessage, &error,
-			DBUS_TYPE_UINT32, &docId,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-			set<string> labels;
-
-#ifdef DEBUG
-			cout << "messageHandler: received GetDocumentLabels " << docId << endl;
-#endif
-			if (index.getDocumentLabels(docId, labels) == true)
-			{
-				GPtrArray *pLabels = g_ptr_array_new();
-
-				for (set<string>::const_iterator labelIter = labels.begin();
-					labelIter != labels.end(); ++labelIter)
-				{
-					string labelName(*labelIter);
-
-					g_ptr_array_add(pLabels, const_cast<char*>(labelName.c_str()));
-#ifdef DEBUG
-					cout << "messageHandler: adding label " << pLabels->len << " " << labelName << endl;
-#endif
-				}
-
-				// Prepare the reply
-				pReply = newDBusReply(pMessage);
-				if (pReply != NULL)
-				{
-					dbus_message_append_args(pReply,
-						DBUS_TYPE_ARRAY, DBUS_TYPE_STRING, &pLabels->pdata, pLabels->len,
-						DBUS_TYPE_INVALID);
-
-					// Send the reply here
-					dbus_connection_send(pConnection, pReply, NULL);
-					dbus_message_unref(pReply);
-
-					pReply = NULL;
-				}
-
-				// Free the array
-				g_ptr_array_free(pLabels, TRUE);
-			}
-			else
-			{
-				pReply = dbus_message_new_error(pMessage,
-					"de.berlios.Pinot.GetDocumentLabels",
-					" failed");
-			}
-		}
-	}
-	else if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "GetStatistics") == TRUE)
-	{
-		CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
-		unsigned int crawledFilesCount = history.getItemsCount();
-		unsigned int docsCount = index.getDocumentsCount();
-
-#ifdef DEBUG
-		cout << "messageHandler: received GetStatistics" << endl;
-#endif
-		// Prepare the reply
-		pReply = newDBusReply(pMessage);
-		if (pReply != NULL)
-		{
-			dbus_message_append_args(pReply,
-				DBUS_TYPE_UINT32, &crawledFilesCount,
-				DBUS_TYPE_UINT32, &docsCount,
-				DBUS_TYPE_INVALID);
-		}
-	}
-	else if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "RenameLabel") == TRUE)
-	{
-		char *pOldLabel = NULL;
-		char *pNewLabel = NULL;
-
-		if (dbus_message_get_args(pMessage, &error,
-			DBUS_TYPE_STRING, &pOldLabel,
-			DBUS_TYPE_STRING, &pNewLabel,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-#ifdef DEBUG
-			cout << "messageHandler: received RenameLabel " << pOldLabel << ", " << pNewLabel << endl;
-#endif
-			// Rename the label
-			flushIndex = index.renameLabel(pOldLabel, pNewLabel);
-
-			// Prepare the reply
-			pReply = newDBusReply(pMessage);
-			if (pReply != NULL)
-			{
-				dbus_message_append_args(pReply,
-					DBUS_TYPE_STRING, &pNewLabel,
-					DBUS_TYPE_INVALID);
-			}
-		}
-	}
-	else if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "SetDocumentInfo") == TRUE)
-	{
-		char *pTitle = NULL;
-		char *pLocation = NULL;
-		char *pType = NULL;
-		char *pLanguage = NULL;
-		unsigned int docId = 0;
-
-		if (dbus_message_get_args(pMessage, &error,
-			DBUS_TYPE_UINT32, &docId,
-			DBUS_TYPE_STRING, &pTitle,
-			DBUS_TYPE_STRING, &pLocation,
-			DBUS_TYPE_STRING, &pType,
-			DBUS_TYPE_STRING, &pLanguage,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-			DocumentInfo docInfo(pTitle, pLocation, pType,
-				((pLanguage != NULL) ? Languages::toLocale(pLanguage) : ""));
-
-#ifdef DEBUG
-			cout << "messageHandler: received SetDocumentInfo " << docId << ", " << pTitle
-				<< ", " << pLocation << ", " << pType << ", " << pLanguage << endl;
-#endif
-
-			// Update the document info
-			flushIndex = index.updateDocumentInfo(docId, docInfo);
-
-			// Prepare the reply
-			pReply = newDBusReply(pMessage);
-			if (pReply != NULL)
-			{
-				dbus_message_append_args(pReply,
-					DBUS_TYPE_UINT32, &docId,
-					DBUS_TYPE_INVALID);
-			}
-		}
-	}
-	else if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "SetDocumentLabels") == TRUE)
-	{
-		char **ppLabels = NULL;
-		dbus_uint32_t labelsCount = 0;
-		unsigned int docId = 0;
-		gboolean resetLabels = TRUE;
-
-		if (dbus_message_get_args(pMessage, &error,
-			DBUS_TYPE_UINT32, &docId,
-			DBUS_TYPE_ARRAY, DBUS_TYPE_STRING, &ppLabels, &labelsCount,
-			DBUS_TYPE_BOOLEAN, &resetLabels,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-			set<string> labels;
-
-			for (dbus_uint32_t labelIndex = 0; labelIndex < labelsCount; ++labelIndex)
-			{
-				if (ppLabels[labelIndex] == NULL)
-				{
-					break;
-				}
-				labels.insert(ppLabels[labelIndex]);
-			}
-#ifdef DEBUG
-			cout << "messageHandler: received SetDocumentLabels " << docId << ", " << resetLabels
-				<< " with " << labelsCount << " labels" << endl;
-#endif
-			// Set labels
-			flushIndex = index.setDocumentLabels(docId, labels, ((resetLabels == TRUE) ? true : false));
-
-			// Free container types
-			g_strfreev(ppLabels);
-
-			// Prepare the reply
-			pReply = newDBusReply(pMessage);
-			if (pReply != NULL)
-			{
-				dbus_message_append_args(pReply,
-					DBUS_TYPE_UINT32, &docId,
-					DBUS_TYPE_INVALID);
-			}
-		}
-	}
-	else if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "SimpleQuery") == TRUE)
-	{
-		char *pSearchText = NULL;
-		dbus_uint32_t maxHits = 0;
-
-		if (dbus_message_get_args(pMessage, &error,
-			DBUS_TYPE_STRING, &pSearchText,
-			DBUS_TYPE_UINT32, &maxHits,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-			XapianEngine engine(PinotSettings::getInstance().m_daemonIndexLocation);
-			bool replyWithError = true;
-
-#ifdef DEBUG
-			cout << "messageHandler: received SimpleQuery " << pSearchText << ", " << maxHits << endl;
-#endif
-			if (pSearchText != NULL)
-			{
-				QueryProperties queryProps("DBUS", pSearchText);
-
-				// Run the query
-				engine.setMaxResultsCount(maxHits);
-				if (engine.runQuery(queryProps) == true)
-				{
-					const vector<Result> &resultsList = engine.getResults();
-					vector<string> docIds;
-					GPtrArray *pDocIds = g_ptr_array_new();
-
-					for (vector<Result>::const_iterator resultIter = resultsList.begin();
-						resultIter != resultsList.end(); ++resultIter)
-					{
-						// We only need the document ID
-						unsigned int docId = index.hasDocument(resultIter->getLocation());
-						if (docId > 0)
-						{
-							char docIdStr[64];
-							snprintf(docIdStr, 64, "%u", docId);
-							docIds.push_back(docIdStr);
-						}
-					}
-
-					for (vector<string>::const_iterator docIter = docIds.begin();
-						docIter != docIds.end(); ++docIter)
-					{
-#ifdef DEBUG
-						cout << "messageHandler: adding result " << pDocIds->len << " " << *docIter << endl;
-#endif
-						g_ptr_array_add(pDocIds, const_cast<char*>(docIter->c_str()));
-					}
-
-					// Prepare the reply
-					pReply = newDBusReply(pMessage);
-					if (pReply != NULL)
-					{
-						dbus_message_append_args(pReply,
-							DBUS_TYPE_ARRAY, DBUS_TYPE_STRING, &pDocIds->pdata, pDocIds->len,
-							DBUS_TYPE_INVALID);
-
-						// Send the reply here
-						dbus_connection_send(pConnection, pReply, NULL);
-						dbus_message_unref(pReply);
-
-						pReply = NULL;
-						replyWithError = false;
-					}
-
-					// Free the array
-					g_ptr_array_free(pDocIds, TRUE);
-				}
-			}
-
-			if (replyWithError == true)
-			{
-				pReply = dbus_message_new_error(pMessage,
-					"de.berlios.Pinot.SimpleQuery",
-					"Query failed");
-			}
-		}
-	}
-	else if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "Stop") == TRUE)
-	{
-		if (dbus_message_get_args(pMessage, &error,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-			int exitStatus = EXIT_SUCCESS;
-
-#ifdef DEBUG
-			cout << "messageHandler: received Stop" << endl;
-#endif
-			// Prepare the reply
-			pReply = newDBusReply(pMessage);
-			if (pReply != NULL)
-			{
-				dbus_message_append_args(pReply,
-					DBUS_TYPE_INT32, &exitStatus,
-					DBUS_TYPE_INVALID);
-			}
-
-			quitLoop = true;
-		}
-	}
-	else if (dbus_message_is_method_call(pMessage, g_pinotDBusService, "UpdateDocument") == TRUE)
-	{
-		unsigned int docId = 0;
-
-		if (dbus_message_get_args(pMessage, &error,
-			DBUS_TYPE_UINT32, &docId,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-			DocumentInfo docInfo;
-
-#ifdef DEBUG
-			cout << "messageHandler: received UpdateDocument " << docId << endl;
-#endif
-			if (index.getDocumentInfo(docId, docInfo) == true)
-			{
-				// Update document
-				pServer->queue_index(docInfo);
-			}
-
-			// Prepare the reply
-			pReply = newDBusReply(pMessage);
-			if (pReply != NULL)
-			{
-				dbus_message_append_args(pReply,
-					DBUS_TYPE_UINT32, &docId,
-					DBUS_TYPE_INVALID);
-			}
-		}
-	}
-	else
-	{
-#ifdef DEBUG
-		cout << "messageHandler: foreign message for/from " << dbus_message_get_interface(pMessage)
-			<< " " << dbus_message_get_member(pMessage) << endl;
-#endif
-		processedMessage = false;
-	}
-
-	// Did an error occur ?
-	if (error.message != NULL)
-	{
-#ifdef DEBUG
-		cout << "messageHandler: error occured: " << error.message << endl;
-#endif
-		// Use the error message as reply
-		pReply = dbus_message_new_error(pMessage, error.name, error.message);
-	}
-
-	dbus_error_free(&error);
-
-	if (flushIndex == true)
-	{
-		// Flush now for the sake of the client application
-		index.flush();
-	}
-
-	// Send a reply ?
-	if (pReply != NULL)
-	{
-		dbus_connection_send(pConnection, pReply, NULL);
-		dbus_connection_flush(pConnection);
-#ifdef DEBUG
-		cout << "messageHandler: sent reply" << endl;
-#endif
-		dbus_message_unref(pReply);
-	}
-
-	if (quitLoop == true)
-	{
-		quitAll(0);
-	}
-
-	if (processedMessage == true)
-	{
-		return DBUS_HANDLER_RESULT_HANDLED;
-	}
-
-	return DBUS_HANDLER_RESULT_NOT_YET_HANDLED;
+	return DBUS_HANDLER_RESULT_HANDLED;
 }
 
 int main(int argc, char **argv)
@@ -814,6 +361,7 @@
 
 		try
 		{
+			server.getQuitSignal().connect(SigC::slot(&quitAll));
 
 			// Connect to threads' finished signal
 			server.connect();



From fabricecolin at mail.berlios.de  Sun Dec 10 15:02:32 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 10 Dec 2006 15:02:32 +0100
Subject: [Pinot-svn] r640 - trunk/scripts/bash
Message-ID: <200612101402.kBAE2WrO031901@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-10 15:02:31 +0100 (Sun, 10 Dec 2006)
New Revision: 640

Modified:
   trunk/scripts/bash/pinot-enum-index.sh
Log:
Delve might be called xapian-delve, so check for that.
Run bash not sh.


Modified: trunk/scripts/bash/pinot-enum-index.sh
===================================================================
--- trunk/scripts/bash/pinot-enum-index.sh	2006-12-10 07:18:22 UTC (rev 639)
+++ trunk/scripts/bash/pinot-enum-index.sh	2006-12-10 14:02:31 UTC (rev 640)
@@ -1,4 +1,4 @@
-#!/bin/sh
+#!/bin/bash
 # A script that enumerates files in an index created by Pinot
 # and gives an estimate of how much disk space those take.
 
@@ -7,11 +7,19 @@
   exit 1
 fi
 
+# delve might be called something else
+DELVE="delve"
+
 # Check programs we need are available
 WHICH_DELVE=`which delve`
 if [ $? != 0 ]; then
-  echo "Couldn't find delve. Is the xapian-core package installed ?"
-  exit 1
+  WHICH_DELVE=`which xapian-delve`
+  if [ $? != 0 ]; then
+    echo "Couldn't find delve. Is the xapian-core package installed ?"
+    exit 1
+  else
+    DELVE="xapian-delve"
+  fi
 fi
 WHICH_DU=`which du`
 if [ $? != 0 ]; then
@@ -33,7 +41,7 @@
 rm -f "$1/urls.txt" "$1/filesizes.txt"
 
 # Get a list of documents
-DOCIDS=`delve -t X-MetaSE-Doc "$1"`
+DOCIDS=`$DELVE -t X-MetaSE-Doc "$1"`
 if [ $? != 0 ]; then
   echo "Couldn't query database at $1"
 fi
@@ -42,7 +50,7 @@
 echo "0" >> "$1/filesizes.txt"
 for DOCID in `echo $DOCIDS | sed -e "s/[^0-9 ]//g"` ;
 do
-  FILENAME=`delve -d -r $DOCID "$1" | grep "url=file" | sed -e "s/url=\(.*\):\/\///g"`
+  FILENAME=`$DELVE -d -r $DOCID "$1" | grep "url=file" | sed -e "s/url=\(.*\):\/\///g"`
   if [ $? != 0 ] || [ -z "$FILENAME" ]; then
     echo "Skipping document $DOCID, it doesn't look like a file"
   else



From fabricecolin at mail.berlios.de  Sun Dec 10 15:34:24 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 10 Dec 2006 15:34:24 +0100
Subject: [Pinot-svn] r641 - in trunk: Collect Index Monitor SQL Search
	Search/Google Tokenize Utils
Message-ID: <200612101434.kBAEYO8a003948@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-10 15:34:22 +0100 (Sun, 10 Dec 2006)
New Revision: 641

Modified:
   trunk/Collect/CurlDownloader.h
   trunk/Collect/DownloaderFactory.h
   trunk/Collect/FileCollector.h
   trunk/Collect/MboxCollector.h
   trunk/Collect/NeonDownloader.h
   trunk/Collect/XapianCollector.h
   trunk/Index/DBusXapianIndex.h
   trunk/Index/IndexFactory.h
   trunk/Index/LanguageDetector.h
   trunk/Index/XapianDatabase.h
   trunk/Index/XapianDatabaseFactory.h
   trunk/Index/XapianIndex.h
   trunk/Monitor/INotifyMonitor.h
   trunk/Monitor/MonitorEvent.h
   trunk/Monitor/MonitorFactory.h
   trunk/Monitor/MonitorHandler.h
   trunk/Monitor/MonitorInterface.h
   trunk/SQL/ActionQueue.h
   trunk/SQL/CrawlHistory.h
   trunk/SQL/QueryHistory.h
   trunk/SQL/SQLiteBase.h
   trunk/SQL/ViewHistory.h
   trunk/Search/AbstractGenerator.h
   trunk/Search/Google/GoogleAPIEngine.h
   trunk/Search/OpenSearchParser.h
   trunk/Search/PluginParsers.h
   trunk/Search/QueryProperties.h
   trunk/Search/SearchEngineFactory.h
   trunk/Search/SearchEngineInterface.h
   trunk/Search/SearchPluginProperties.h
   trunk/Search/SherlockParser.h
   trunk/Search/WebEngine.h
   trunk/Search/XapianEngine.h
   trunk/Tokenize/HtmlTokenizer.h
   trunk/Tokenize/OpenDocumentTokenizer.h
   trunk/Tokenize/PdfTokenizer.h
   trunk/Tokenize/RtfTokenizer.h
   trunk/Tokenize/TagLibTokenizer.h
   trunk/Tokenize/Tokenizer.h
   trunk/Tokenize/TokenizerFactory.h
   trunk/Tokenize/UnknownTypeTokenizer.h
   trunk/Tokenize/WordTokenizer.h
   trunk/Tokenize/XmlTokenizer.h
   trunk/Utils/CommandLine.h
   trunk/Utils/Document.h
   trunk/Utils/DocumentInfo.h
   trunk/Utils/IndexedDocument.h
   trunk/Utils/Languages.h
   trunk/Utils/MIMEScanner.h
   trunk/Utils/MboxParser.h
   trunk/Utils/Result.h
   trunk/Utils/StringManip.h
   trunk/Utils/TimeConverter.h
   trunk/Utils/Timer.h
   trunk/Utils/Url.h
Log:
Minimal class documentation.


Modified: trunk/Collect/CurlDownloader.h
===================================================================
--- trunk/Collect/CurlDownloader.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Collect/CurlDownloader.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 
 #include "DownloaderInterface.h"
 
+/// Wrapper around the curl API.
 class CurlDownloader : public DownloaderInterface
 {
 	public:

Modified: trunk/Collect/DownloaderFactory.h
===================================================================
--- trunk/Collect/DownloaderFactory.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Collect/DownloaderFactory.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,7 +23,7 @@
 
 #include "DownloaderInterface.h"
 
-// Downloader factory class.
+/// Downloader factory class.
 class DownloaderFactory
 {
 	public:

Modified: trunk/Collect/FileCollector.h
===================================================================
--- trunk/Collect/FileCollector.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Collect/FileCollector.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 
 #include "DownloaderInterface.h"
 
+/// Simple downloader for files.
 class FileCollector : public DownloaderInterface
 {
 	public:

Modified: trunk/Collect/MboxCollector.h
===================================================================
--- trunk/Collect/MboxCollector.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Collect/MboxCollector.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 
 #include "DownloaderInterface.h"
 
+/// Pseudo-downloader for messages in mbox files.
 class MboxCollector : public DownloaderInterface
 {
 	public:

Modified: trunk/Collect/NeonDownloader.h
===================================================================
--- trunk/Collect/NeonDownloader.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Collect/NeonDownloader.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 
 #include "DownloaderInterface.h"
 
+/// Wrapper around the neon API. 
 class NeonDownloader : public DownloaderInterface
 {
 	public:

Modified: trunk/Collect/XapianCollector.h
===================================================================
--- trunk/Collect/XapianCollector.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Collect/XapianCollector.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -25,6 +25,7 @@
 
 #include "DownloaderInterface.h"
 
+/// Downloader for documents in a Xapian index.
 class XapianCollector : public DownloaderInterface
 {
 	public:

Modified: trunk/Index/DBusXapianIndex.h
===================================================================
--- trunk/Index/DBusXapianIndex.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Index/DBusXapianIndex.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -24,6 +24,7 @@
 
 #include "XapianIndex.h"
 
+/// Allows to write to the daemon index via D-Bus. 
 class DBusXapianIndex : public XapianIndex
 {
 	public:

Modified: trunk/Index/IndexFactory.h
===================================================================
--- trunk/Index/IndexFactory.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Index/IndexFactory.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 
 #include "IndexInterface.h"
 
+/// Factory for indexes.
 class IndexFactory
 {
 	public:

Modified: trunk/Index/LanguageDetector.h
===================================================================
--- trunk/Index/LanguageDetector.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Index/LanguageDetector.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -22,6 +22,7 @@
 #include <string>
 #include <vector>
 
+/// Detects a document's language with libextcat.
 class LanguageDetector
 {
 	public:

Modified: trunk/Index/XapianDatabase.h
===================================================================
--- trunk/Index/XapianDatabase.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Index/XapianDatabase.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -25,6 +25,7 @@
 
 #include <xapian.h>
 
+/// Lockable Xapian database.
 class XapianDatabase
 {
 	public:

Modified: trunk/Index/XapianDatabaseFactory.h
===================================================================
--- trunk/Index/XapianDatabaseFactory.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Index/XapianDatabaseFactory.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -25,6 +25,7 @@
 
 #include "XapianDatabase.h"
 
+/// Factory for Xapian database objects.
 class XapianDatabaseFactory
 {
 	public:

Modified: trunk/Index/XapianIndex.h
===================================================================
--- trunk/Index/XapianIndex.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Index/XapianIndex.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -25,6 +25,7 @@
 #include "XapianDatabase.h"
 #include "IndexInterface.h"
 
+/// A Xapian-based index.
 class XapianIndex : public IndexInterface
 {
 	public:

Modified: trunk/Monitor/INotifyMonitor.h
===================================================================
--- trunk/Monitor/INotifyMonitor.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Monitor/INotifyMonitor.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -26,6 +26,7 @@
 
 #include "MonitorInterface.h"
 
+/// Linux inotify monitor.
 class INotifyMonitor : public MonitorInterface
 {
 	public:

Modified: trunk/Monitor/MonitorEvent.h
===================================================================
--- trunk/Monitor/MonitorEvent.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Monitor/MonitorEvent.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -21,6 +21,7 @@
 
 #include <string>
 
+/// An event generated by a monitor.
 class MonitorEvent
 {
 	public:

Modified: trunk/Monitor/MonitorFactory.h
===================================================================
--- trunk/Monitor/MonitorFactory.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Monitor/MonitorFactory.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -21,6 +21,7 @@
 
 #include "MonitorInterface.h"
 
+/// Factory for monitors.
 class MonitorFactory
 {
 	public:

Modified: trunk/Monitor/MonitorHandler.h
===================================================================
--- trunk/Monitor/MonitorHandler.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Monitor/MonitorHandler.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -26,6 +26,7 @@
 #include "IndexedDocument.h"
 #include "MonitorInterface.h"
 
+/// Handles events generated by a monitor.
 class MonitorHandler
 {
 	public:

Modified: trunk/Monitor/MonitorInterface.h
===================================================================
--- trunk/Monitor/MonitorInterface.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Monitor/MonitorInterface.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -25,6 +25,7 @@
 
 #include "MonitorEvent.h"
 
+/// Interface implemented by all monitors.
 class MonitorInterface
 {
 	public:

Modified: trunk/SQL/ActionQueue.h
===================================================================
--- trunk/SQL/ActionQueue.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/SQL/ActionQueue.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -25,6 +25,7 @@
 #include "DocumentInfo.h"
 #include "SQLiteBase.h"
 
+/// Handles the ActionQueue table.
 class ActionQueue : public SQLiteBase
 {
 	public:

Modified: trunk/SQL/CrawlHistory.h
===================================================================
--- trunk/SQL/CrawlHistory.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/SQL/CrawlHistory.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -28,6 +28,7 @@
 
 using namespace std;
 
+/// Manages crawl history.
 class CrawlHistory : public SQLiteBase
 {
 	public:

Modified: trunk/SQL/QueryHistory.h
===================================================================
--- trunk/SQL/QueryHistory.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/SQL/QueryHistory.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -27,6 +27,7 @@
 
 using namespace std;
 
+/// Manages query history.
 class QueryHistory : public SQLiteBase
 {
 	public:

Modified: trunk/SQL/SQLiteBase.h
===================================================================
--- trunk/SQL/SQLiteBase.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/SQL/SQLiteBase.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -26,6 +26,7 @@
 
 using namespace std;
 
+/// A row in a SQLite table.
 class SQLiteRow
 {
 	public:
@@ -42,6 +43,7 @@
 
 };
 
+/// Results extracted from a SQLite table.
 class SQLiteResults
 {
 	public:
@@ -68,6 +70,7 @@
 
 };
 
+/// Simple C++ wrapper around the SQLite API.
 class SQLiteBase
 {
 	public:

Modified: trunk/SQL/ViewHistory.h
===================================================================
--- trunk/SQL/ViewHistory.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/SQL/ViewHistory.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -26,6 +26,7 @@
 
 using namespace std;
 
+/// Manages view history.
 class ViewHistory : public SQLiteBase
 {
 	public:

Modified: trunk/Search/AbstractGenerator.h
===================================================================
--- trunk/Search/AbstractGenerator.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/AbstractGenerator.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -24,6 +24,7 @@
 
 #include <xapian.h>
 
+/// Generates abstracts for indexed documents.
 class AbstractGenerator
 {
 	public:

Modified: trunk/Search/Google/GoogleAPIEngine.h
===================================================================
--- trunk/Search/Google/GoogleAPIEngine.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/Google/GoogleAPIEngine.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -26,6 +26,7 @@
 
 using namespace std;
 
+/// Engine that makes use of Google's SOAP API.
 class GoogleAPIEngine : public WebEngine
 {
 	public:

Modified: trunk/Search/OpenSearchParser.h
===================================================================
--- trunk/Search/OpenSearchParser.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/OpenSearchParser.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -24,6 +24,7 @@
 #include "Document.h"
 #include "PluginParsers.h"
 
+/// Parses OpenSearch Response.
 class OpenSearchResponseParser : public ResponseParserInterface
 {
 	public:
@@ -43,8 +44,7 @@
 
 };
 
-/**
-  * A parser for OpenSearch Description and Query Syntax, version 1.1.
+/** A parser for OpenSearch Description and Query Syntax, version 1.1.
   * See http://opensearch.a9.com/spec/1.1/description/
   * and http://opensearch.a9.com/spec/1.1/querysyntax/
   * It can also parse MozSearch plugins.

Modified: trunk/Search/PluginParsers.h
===================================================================
--- trunk/Search/PluginParsers.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/PluginParsers.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -26,9 +26,7 @@
 #include "Result.h"
 #include "SearchPluginProperties.h"
 
-/**
-  * Interface implemented by response parsers.
-  */
+/// Interface implemented by response parsers.
 class ResponseParserInterface
 {
 	public:
@@ -47,9 +45,7 @@
 		
 };
 	
-/**
-  * Interface implemented by plugin parsers.
-  */
+/// Interface implemented by plugin parsers.
 class PluginParserInterface
 {
 	public:

Modified: trunk/Search/QueryProperties.h
===================================================================
--- trunk/Search/QueryProperties.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/QueryProperties.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -26,6 +26,7 @@
 
 using namespace std;
 
+/// This represents a query.
 class QueryProperties
 {
 	public:

Modified: trunk/Search/SearchEngineFactory.h
===================================================================
--- trunk/Search/SearchEngineFactory.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/SearchEngineFactory.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -29,6 +29,7 @@
 using std::map;
 using std::set;
 
+/// Factory for search engines.
 class SearchEngineFactory
 {
 	public:

Modified: trunk/Search/SearchEngineInterface.h
===================================================================
--- trunk/Search/SearchEngineInterface.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/SearchEngineInterface.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -29,9 +29,7 @@
 
 using namespace std;
 
-/**
-  * Interface implemented by search engines.
-  */
+/// Interface implemented by search engines.
 class SearchEngineInterface
 {
 	public:

Modified: trunk/Search/SearchPluginProperties.h
===================================================================
--- trunk/Search/SearchPluginProperties.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/SearchPluginProperties.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 #include <map>
 #include <set>
 
+/// Properties of a search plugin.
 class SearchPluginProperties
 {
 	public:

Modified: trunk/Search/SherlockParser.h
===================================================================
--- trunk/Search/SherlockParser.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/SherlockParser.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -25,6 +25,7 @@
 #include "Document.h"
 #include "PluginParsers.h"
 
+/// Parses output of Sherlock-based search engines.
 class SherlockResponseParser : public ResponseParserInterface
 {
 	public:
@@ -53,8 +54,7 @@
 
 };
 
-/**
-  * A parser for Sherlock plugin files.
+/** A parser for Sherlock plugin files.
   * See http://developer.apple.com/technotes/tn/tn1141.html
   * and http://mycroft.mozdev.org/deepdocs/deepdocs.html
   */

Modified: trunk/Search/WebEngine.h
===================================================================
--- trunk/Search/WebEngine.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/WebEngine.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -26,6 +26,7 @@
 #include "QueryProperties.h"
 #include "SearchEngineInterface.h"
 
+/// Base class for all Web search engines.
 class WebEngine : public SearchEngineInterface
 {
 	public:

Modified: trunk/Search/XapianEngine.h
===================================================================
--- trunk/Search/XapianEngine.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Search/XapianEngine.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -28,6 +28,7 @@
 #include "SearchEngineInterface.h"
 #include "DownloaderFactory.h"
 
+/// Wraps Xapian's search funtionality.
 class XapianEngine : public SearchEngineInterface
 {
 	public:

Modified: trunk/Tokenize/HtmlTokenizer.h
===================================================================
--- trunk/Tokenize/HtmlTokenizer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/HtmlTokenizer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -27,6 +27,7 @@
 #include "Document.h"
 #include "Tokenizer.h"
 
+/// A link in an HTML page.
 class Link
 {
 	public:
@@ -46,6 +47,7 @@
 
 };
 
+/// Tokenizer for HTML.
 class HtmlTokenizer : public Tokenizer
 {
 	public:

Modified: trunk/Tokenize/OpenDocumentTokenizer.h
===================================================================
--- trunk/Tokenize/OpenDocumentTokenizer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/OpenDocumentTokenizer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -32,6 +32,7 @@
 /// This returns a pointer to a Tokenizer, allocated with new.
 Tokenizer *getTokenizer(const Document *pDocument);
 
+/// A tokenizer for OpenDocument and other OpenOffice.org file formats.
 class OpenDocumentTokenizer : public XmlTokenizer
 {
 	public:

Modified: trunk/Tokenize/PdfTokenizer.h
===================================================================
--- trunk/Tokenize/PdfTokenizer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/PdfTokenizer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -32,6 +32,7 @@
 /// This returns a pointer to a Tokenizer, allocated with new.
 Tokenizer *getTokenizer(const Document *pDocument);
 
+/// PDF tokenizer.
 class PdfTokenizer : public HtmlTokenizer
 {
 	public:

Modified: trunk/Tokenize/RtfTokenizer.h
===================================================================
--- trunk/Tokenize/RtfTokenizer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/RtfTokenizer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -32,6 +32,7 @@
 /// This returns a pointer to a Tokenizer, allocated with new.
 Tokenizer *getTokenizer(const Document *pDocument);
 
+/// Rich Text Format tokenizer.
 class RtfTokenizer : public HtmlTokenizer
 {
 	public:

Modified: trunk/Tokenize/TagLibTokenizer.h
===================================================================
--- trunk/Tokenize/TagLibTokenizer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/TagLibTokenizer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -32,6 +32,7 @@
 /// This returns a pointer to a Tokenizer, allocated with new.
 Tokenizer *getTokenizer(const Document *pDocument);
 
+/// Taglib-based tokenizer for MP3, OOgg Vorbis etc...
 class TagLibTokenizer : public Tokenizer
 {
 	public:

Modified: trunk/Tokenize/Tokenizer.h
===================================================================
--- trunk/Tokenize/Tokenizer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/Tokenizer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,9 @@
 
 #include "Document.h"
 
+/** Basic text-only tokenizer.
+  * Its role it to split documents into individual tokens or terms.
+  */
 class Tokenizer
 {
 	public:

Modified: trunk/Tokenize/TokenizerFactory.h
===================================================================
--- trunk/Tokenize/TokenizerFactory.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/TokenizerFactory.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -25,6 +25,7 @@
 
 #include "Tokenizer.h"
 
+/// Factory for tokenizers with related utility methods.
 class TokenizerFactory
 {
 	public:

Modified: trunk/Tokenize/UnknownTypeTokenizer.h
===================================================================
--- trunk/Tokenize/UnknownTypeTokenizer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/UnknownTypeTokenizer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -22,6 +22,7 @@
 #include "Document.h"
 #include "Tokenizer.h"
 
+/// Tokenizer for unknown types.
 class UnknownTypeTokenizer : public Tokenizer
 {
 	public:

Modified: trunk/Tokenize/WordTokenizer.h
===================================================================
--- trunk/Tokenize/WordTokenizer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/WordTokenizer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -32,6 +32,7 @@
 /// This returns a pointer to a Tokenizer, allocated with new.
 Tokenizer *getTokenizer(const Document *pDocument);
 
+/// Tokenizer for MS Word documents.
 class WordTokenizer : public Tokenizer
 {
 	public:

Modified: trunk/Tokenize/XmlTokenizer.h
===================================================================
--- trunk/Tokenize/XmlTokenizer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Tokenize/XmlTokenizer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -24,6 +24,7 @@
 #include "Document.h"
 #include "Tokenizer.h"
 
+/// XML tokenizer that strips all tags and only preserves text.
 class XmlTokenizer : public Tokenizer
 {
 	public:

Modified: trunk/Utils/CommandLine.h
===================================================================
--- trunk/Utils/CommandLine.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/CommandLine.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -24,6 +24,7 @@
 
 #include "MIMEScanner.h"
 
+/// Utilities for running commands.
 class CommandLine
 {
 	public:

Modified: trunk/Utils/Document.h
===================================================================
--- trunk/Utils/Document.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/Document.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 
 #include "DocumentInfo.h"
 
+/// Document wraps a document's properties and data.
 class Document : public DocumentInfo
 {
 	public:

Modified: trunk/Utils/DocumentInfo.h
===================================================================
--- trunk/Utils/DocumentInfo.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/DocumentInfo.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -22,6 +22,7 @@
 #include <string>
 #include <set>
 
+/// This represents all the properties of a document.
 class DocumentInfo
 {
 	public:

Modified: trunk/Utils/IndexedDocument.h
===================================================================
--- trunk/Utils/IndexedDocument.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/IndexedDocument.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 
 #include "Document.h"
 
+/// An entry in the index.
 class IndexedDocument : public Document
 {
 	public:

Modified: trunk/Utils/Languages.h
===================================================================
--- trunk/Utils/Languages.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/Languages.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -22,6 +22,7 @@
 #include <string>
 #include <map>
 
+/// Utility class for manipulating languages.
 class Languages
 {
 	public:

Modified: trunk/Utils/MIMEScanner.h
===================================================================
--- trunk/Utils/MIMEScanner.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/MIMEScanner.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -25,6 +25,10 @@
 
 #include "Url.h"
 
+/** MIMEAction stores useful information extracted from desktop files.
+  * The desktop files format is defined by
+  * http://standards.freedesktop.org/desktop-entry-spec/latest/
+  */
 class MIMEAction
 {
 	public:
@@ -45,6 +49,9 @@
 
 };
 
+/**
+  * Utility class to get a file's MIME type and the default application associated with it.
+  */
 class MIMEScanner
 {
 	public:

Modified: trunk/Utils/MboxParser.h
===================================================================
--- trunk/Utils/MboxParser.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/MboxParser.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -32,8 +32,7 @@
 
 using namespace std;
 
-/**
-  * A parser for mbox files. Each message is extracted and
+/** A parser for mbox files. Each message is extracted and
   * returned in a separate document by getDocument(). The value
   * returned by getDocumentIncrement() enables to determine a new
   * message has been extracted and is ready to be tokenized.

Modified: trunk/Utils/Result.h
===================================================================
--- trunk/Utils/Result.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/Result.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 
 #include "DocumentInfo.h"
 
+/// A document returned by a search engine.
 class Result : public DocumentInfo
 {
 	public:

Modified: trunk/Utils/StringManip.h
===================================================================
--- trunk/Utils/StringManip.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/StringManip.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -21,6 +21,7 @@
 
 #include <string>
 
+/// Utility class for string manipulation.
 class StringManip
 {
 	public:

Modified: trunk/Utils/TimeConverter.h
===================================================================
--- trunk/Utils/TimeConverter.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/TimeConverter.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -23,6 +23,7 @@
 
 using namespace std;
 
+/// This class handles time conversions.
 class TimeConverter
 {
 	public:

Modified: trunk/Utils/Timer.h
===================================================================
--- trunk/Utils/Timer.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/Timer.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -22,6 +22,7 @@
 #include <time.h>
 #include <sys/time.h>
 
+/// A timer with microseconds precision.
 class Timer
 {
 	public:

Modified: trunk/Utils/Url.h
===================================================================
--- trunk/Utils/Url.h	2006-12-10 14:02:31 UTC (rev 640)
+++ trunk/Utils/Url.h	2006-12-10 14:34:22 UTC (rev 641)
@@ -21,6 +21,7 @@
 
 #include <string>
 
+/// This dissects and manipulates URLs returned by search engines.
 class Url
 {
 	public:
@@ -45,13 +46,28 @@
 		/// Unescapes an URL.
 		static std::string unescapeUrl(const std::string &escapedUrl);
 
+		/// Returns the protocol, eg "file".
 		std::string getProtocol(void) const;
+
+		/// Returns the user name if any.
 		std::string getUser(void) const;
+
+		/// Returns the password if any.
 		std::string getPassword(void) const;
+
+		/// Returns the host name.
 		std::string getHost(void) const;
+
+		/// Returns the directory that leads to the file.
 		std::string getLocation(void) const;
+
+		/// Returns the file name.
 		std::string getFile(void) const;
+
+		/// Returns parameters that may follow the file name.
 		std::string getParameters(void) const;
+
+		/// Returns whether the Url points to a local file.
 		bool isLocal(void) const ;
 
 	protected:



From fabricecolin at mail.berlios.de  Mon Dec 11 14:24:50 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 11 Dec 2006 14:24:50 +0100
Subject: [Pinot-svn] r642 - trunk/Index
Message-ID: <200612111324.kBBDOopk032373@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-11 14:24:50 +0100 (Mon, 11 Dec 2006)
New Revision: 642

Modified:
   trunk/Index/XapianIndex.cpp
Log:
Additional check on document's data before calling scanDocument().
In updateDocument(), if the document has no data, don't return with an error.


Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-12-10 14:34:22 UTC (rev 641)
+++ trunk/Index/XapianIndex.cpp	2006-12-11 13:24:50 UTC (rev 642)
@@ -1048,7 +1048,8 @@
 		docInfo.setLocation(Url::canonicalizeUrl(docInfo.getLocation()));
 
 		const char *pData = pDocument->getData(dataLength);
-		if (pData != NULL)
+		if ((pData != NULL) &&
+			(dataLength > 0))
 		{
 			m_stemLanguage = scanDocument(pData, dataLength, docInfo);
 		}
@@ -1093,7 +1094,6 @@
 /// Updates the given document; true if success.
 bool XapianIndex::updateDocument(unsigned int docId, Tokenizer &tokens)
 {
-	unsigned int dataLength = 0;
 	bool updated = false;
 
 	const Document *pDocument = tokens.getDocument();
@@ -1109,12 +1109,6 @@
 		return false;
 	}
 
-	const char *pData = pDocument->getData(dataLength);
-	if (pData == NULL)
-	{
-		return false;
-	}
-
 	// Cache the document's properties
 	DocumentInfo docInfo(pDocument->getTitle(), pDocument->getLocation(),
 		pDocument->getType(), pDocument->getLanguage());
@@ -1126,7 +1120,14 @@
 	m_stemLanguage = Languages::toEnglish(pDocument->getLanguage());
 	if (m_stemLanguage.empty() == true)
 	{
-		m_stemLanguage = scanDocument(pData, dataLength, docInfo);
+		unsigned int dataLength = 0;
+		const char *pData = pDocument->getData(dataLength);
+
+		if ((pData != NULL) &&
+			(dataLength > 0))
+		{
+			m_stemLanguage = scanDocument(pData, dataLength, docInfo);
+		}
 	}
 
 	try



From fabricecolin at mail.berlios.de  Mon Dec 11 14:29:09 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 11 Dec 2006 14:29:09 +0100
Subject: [Pinot-svn] r643 - trunk/scripts/bash
Message-ID: <200612111329.kBBDT9j2000616@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-11 14:29:09 +0100 (Mon, 11 Dec 2006)
New Revision: 643

Modified:
   trunk/scripts/bash/pinot-enum-index.sh
Log:
Skip non-files silently.


Modified: trunk/scripts/bash/pinot-enum-index.sh
===================================================================
--- trunk/scripts/bash/pinot-enum-index.sh	2006-12-11 13:24:50 UTC (rev 642)
+++ trunk/scripts/bash/pinot-enum-index.sh	2006-12-11 13:29:09 UTC (rev 643)
@@ -50,10 +50,9 @@
 echo "0" >> "$1/filesizes.txt"
 for DOCID in `echo $DOCIDS | sed -e "s/[^0-9 ]//g"` ;
 do
+  # Skip documents with a scheme other than file
   FILENAME=`$DELVE -d -r $DOCID "$1" | grep "url=file" | sed -e "s/url=\(.*\):\/\///g"`
-  if [ $? != 0 ] || [ -z "$FILENAME" ]; then
-    echo "Skipping document $DOCID, it doesn't look like a file"
-  else
+  if [ $? == 0 ] && [ ! -z "$FILENAME" ]; then
     FILESIZE=`du -b "$FILENAME" | sed -e "s/\([0-9]*\)\(.*\)/\1/g"`
     if [ ! -z "$FILESIZE" ]; then
       echo $FILENAME >> "$1/urls.txt"



From fabricecolin at mail.berlios.de  Mon Dec 11 15:49:47 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 11 Dec 2006 15:49:47 +0100
Subject: [Pinot-svn] r644 - trunk/UI/GTK2/src
Message-ID: <200612111449.kBBEnlvw009601@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-11 15:49:46 +0100 (Mon, 11 Dec 2006)
New Revision: 644

Modified:
   trunk/UI/GTK2/src/ResultsTree.cpp
   trunk/UI/GTK2/src/ResultsTree.h
Log:
Removed unused member.


Modified: trunk/UI/GTK2/src/ResultsTree.cpp
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.cpp	2006-12-11 13:29:09 UTC (rev 643)
+++ trunk/UI/GTK2/src/ResultsTree.cpp	2006-12-11 14:49:46 UTC (rev 644)
@@ -450,9 +450,6 @@
 	ResultsModelColumns::ResultType rootType;
 	unsigned int count = 0;
 
-	// Get this query's terms
-	queryProps.getTerms(m_queryTerms);
-
 	// What's the grouping criteria ?
 	if (groupBySearchEngine == true)
 	{

Modified: trunk/UI/GTK2/src/ResultsTree.h
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.h	2006-12-11 13:29:09 UTC (rev 643)
+++ trunk/UI/GTK2/src/ResultsTree.h	2006-12-11 14:49:46 UTC (rev 644)
@@ -121,7 +121,6 @@
 		std::set<std::string> m_indexNames;
 		bool m_showExtract;
 		bool m_groupBySearchEngine;
-		std::set<std::string> m_queryTerms;
 
 		void renderViewStatus(Gtk::CellRenderer *pRenderer, const Gtk::TreeModel::iterator &iter);
 



From fabricecolin at mail.berlios.de  Mon Dec 11 15:52:26 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 11 Dec 2006 15:52:26 +0100
Subject: [Pinot-svn] r645 - trunk
Message-ID: <200612111452.kBBEqQbr009825@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-11 15:52:25 +0100 (Mon, 11 Dec 2006)
New Revision: 645

Modified:
   trunk/configure.in
Log:
Make sure all binaries are linked against pthreads, not just the UI.


Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-12-11 14:49:46 UTC (rev 644)
+++ trunk/configure.in	2006-12-11 14:52:25 UTC (rev 645)
@@ -203,7 +203,7 @@
 fi
 
 dnl Other libraries
-MISC_LIBS="-lcrypt"
+MISC_LIBS="-lcrypt $PTHREAD_LIBS"
 AC_SUBST(MISC_LIBS)
 AC_CHECK_HEADERS([netinet/in.h arpa/inet.h])
 PKG_CHECK_MODULES(MIMEINFO, shared-mime-info )
@@ -243,7 +243,6 @@
 AC_SUBST(GLIBMM_CFLAGS)
 AC_SUBST(GLIBMM_LIBS)
 PKG_CHECK_MODULES(UI, gtkmm-2.4 >= 2.6 )
-UI_LIBS="$PTHREAD_LIBS $UI_LIBS"
 AC_SUBST(UI_CFLAGS)
 AC_SUBST(UI_LIBS)
 



From fabricecolin at mail.berlios.de  Tue Dec 12 14:38:15 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 12 Dec 2006 14:38:15 +0100
Subject: [Pinot-svn] r646 - trunk/Search
Message-ID: <200612121338.kBCDcFu0008502@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-12 14:38:15 +0100 (Tue, 12 Dec 2006)
New Revision: 646

Modified:
   trunk/Search/AbstractGenerator.cpp
   trunk/Search/WebEngine.cpp
Log:
Convert strings to UTF-8 before escaping them for markup. This prevents a crash
when the locale is not UTF-8.


Modified: trunk/Search/AbstractGenerator.cpp
===================================================================
--- trunk/Search/AbstractGenerator.cpp	2006-12-11 14:52:25 UTC (rev 645)
+++ trunk/Search/AbstractGenerator.cpp	2006-12-12 13:38:15 UTC (rev 646)
@@ -216,10 +216,19 @@
 	for (map<Xapian::termpos, string>::iterator wordIter = wordsBuffer.begin();
 		wordIter != wordsBuffer.end(); ++wordIter)
 	{
-		char *pEscWord = g_markup_escape_text(wordIter->second.c_str(), -1);
+		gchar *pEscToken = NULL;
+		gchar *pUTF8Token = NULL;
+		gsize bytesWritten = 0;
 
-		if (pEscWord == NULL)
+		pUTF8Token = g_locale_to_utf8(wordIter->second.c_str(), wordIter->second.length(),
+			NULL, &bytesWritten, NULL);
+		if (pUTF8Token != NULL)
 		{
+			pEscToken = g_markup_escape_text(pUTF8Token, -1);
+			g_free(pUTF8Token);
+		}
+		if (pEscToken == NULL)
+		{
 			continue;
 		}
 
@@ -227,16 +236,16 @@
 		if (find(seedTerms.begin(), seedTerms.end(), wordIter->second) != seedTerms.end())
 		{
 			summary += "<b>";
-			summary += pEscWord;
+			summary += pEscToken;
 			summary += "</b>";
 		}
 		else
 		{
-			summary += pEscWord;
+			summary += pEscToken;
 		}
 		summary += " ";
 
-		g_free(pEscWord);
+		g_free(pEscToken);
 	}
 #ifdef DEBUG
 	cout << "AbstractGenerator::generateAbstract: summarized document "

Modified: trunk/Search/WebEngine.cpp
===================================================================
--- trunk/Search/WebEngine.cpp	2006-12-11 14:52:25 UTC (rev 645)
+++ trunk/Search/WebEngine.cpp	2006-12-12 13:38:15 UTC (rev 646)
@@ -222,7 +222,17 @@
 	string token;
 	while (tokens.nextToken(token) == true)
 	{
-		char *pEscToken = g_markup_escape_text(token.c_str(), -1);
+		gchar *pEscToken = NULL;
+		gchar *pUTF8Token = NULL;
+		gsize bytesWritten = 0;
+
+		pUTF8Token = g_locale_to_utf8(token.c_str(), token.length(),
+			NULL, &bytesWritten, NULL);
+		if (pUTF8Token != NULL)
+		{
+			pEscToken = g_markup_escape_text(pUTF8Token, -1);
+			g_free(pUTF8Token);
+		}
 		if (pEscToken == NULL)
 		{
 			continue;



From fabricecolin at mail.berlios.de  Tue Dec 12 14:40:01 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 12 Dec 2006 14:40:01 +0100
Subject: [Pinot-svn] r647 - trunk/SQL
Message-ID: <200612121340.kBCDe1S3008670@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-12 14:40:00 +0100 (Tue, 12 Dec 2006)
New Revision: 647

Modified:
   trunk/SQL/QueryHistory.cpp
   trunk/SQL/QueryHistory.h
Log:
Store the result's charset in the so far unused Language column.
I ought to rename the column now...


Modified: trunk/SQL/QueryHistory.cpp
===================================================================
--- trunk/SQL/QueryHistory.cpp	2006-12-12 13:38:15 UTC (rev 646)
+++ trunk/SQL/QueryHistory.cpp	2006-12-12 13:40:00 UTC (rev 647)
@@ -68,7 +68,7 @@
 
 /// Inserts an URL.
 bool QueryHistory::insertItem(const string &queryName, const string &engineName, const string &url,
-	const string &title, const string &extract, const string &language, float score)
+	const string &title, const string &extract, const string &charset, float score)
 {
 	Url urlObj(url);
 	string hostName = urlObj.getHost();
@@ -78,7 +78,7 @@
 	SQLiteResults *results = executeStatement("INSERT INTO QueryHistory \
 		VALUES('%q', '%q', '%q', '%q', '%q', '%q', '%q', '%f', '0.0', '%d');",
 		queryName.c_str(), engineName.c_str(), hostName.c_str(),
-		escapedUrl.c_str(), title.c_str(), extract.c_str(), language.c_str(),
+		escapedUrl.c_str(), title.c_str(), extract.c_str(), charset.c_str(),
 		score, time(NULL));
 	if (results != NULL)
 	{
@@ -117,14 +117,14 @@
 
 /// Updates an URL's details.
 bool QueryHistory::updateItem(const string &queryName, const string &engineName, const string &url,
-	const string &title, const string &extract, const string &language, float score)
+	const string &title, const string &extract, const string &charset, float score)
 {
 	bool success = false;
 
 	SQLiteResults *results = executeStatement("UPDATE QueryHistory SET PrevScore=Score, \
 		Score=%f, Date='%d', Title='%q', Extract='%q', Language='%q' \
 		WHERE QueryName='%q' AND EngineName='%q' AND Url='%q';",
-		score, time(NULL), title.c_str(), extract.c_str(), language.c_str(),
+		score, time(NULL), title.c_str(), extract.c_str(), charset.c_str(),
 		queryName.c_str(), engineName.c_str(), Url::escapeUrl(url).c_str());
 	if (results != NULL)
 	{
@@ -172,11 +172,12 @@
 }
 
 /// Gets an item's extract.
-string QueryHistory::getItemExtract(const string &queryName, const string &engineName, const string &url) const
+string QueryHistory::getItemExtract(const string &queryName, const string &engineName,
+	const string &url, string &charset) const
 {
 	string extract;
 
-	SQLiteResults *results = executeStatement("SELECT Extract FROM QueryHistory \
+	SQLiteResults *results = executeStatement("SELECT Extract, Language FROM QueryHistory \
 		WHERE QueryName='%q' AND EngineName='%q' AND Url='%q';",
 		queryName.c_str(), engineName.c_str(), Url::escapeUrl(url).c_str());
 	if (results != NULL)
@@ -185,6 +186,7 @@
 		if (row != NULL)
 		{
 			extract = row->getColumn(0);
+			charset = row->getColumn(1);
 
 			delete row;
 		}

Modified: trunk/SQL/QueryHistory.h
===================================================================
--- trunk/SQL/QueryHistory.h	2006-12-12 13:38:15 UTC (rev 646)
+++ trunk/SQL/QueryHistory.h	2006-12-12 13:40:00 UTC (rev 647)
@@ -39,7 +39,7 @@
 
 		/// Inserts an URL.
 		bool insertItem(const string &queryName, const string &engineName, const string &url,
-			const string &title, const string &extract, const string &language, float score);
+			const string &title, const string &extract, const string &charset, float score);
 
 		/**
 		  * Checks if an URL is in the query's history.
@@ -50,14 +50,15 @@
 
 		/// Updates an URL's details.
 		bool updateItem(const string &queryName, const string &engineName, const string &url,
-			const string &title, const string &extract, const string &language, float score);
+			const string &title, const string &extract, const string &charset, float score);
 
 		/// Gets the first max items for the given query, engine pair.
 		bool getItems(const string &queryName, const string &engineName,
 			unsigned int max, vector<Result> &resultsList) const;
 
 		/// Gets an item's extract.
-		string getItemExtract(const string &queryName, const string &engineName, const string &url) const;
+		string getItemExtract(const string &queryName, const string &engineName,
+			const string &url, string &charset) const;
 
 		/// Gets a query's last run time.
 		string getLastRun(const string &queryName, const string &engineName = "") const;



From fabricecolin at mail.berlios.de  Tue Dec 12 14:42:20 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 12 Dec 2006 14:42:20 +0100
Subject: [Pinot-svn] r648 - trunk/UI/GTK2/src
Message-ID: <200612121342.kBCDgK10009143@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-12 14:42:19 +0100 (Tue, 12 Dec 2006)
New Revision: 648

Modified:
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/UI/GTK2/src/pinot.cc
Log:
Replaced setenv() with Glib::setenv().


Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-12 13:40:00 UTC (rev 647)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-12 13:42:19 UTC (rev 648)
@@ -215,7 +215,7 @@
 #endif //ENABLE_NLS
 
 	// This should make Xapian use Flint rather than Quartz
-	setenv("XAPIAN_PREFER_FLINT", "1", 1);
+	Glib::setenv("XAPIAN_PREFER_FLINT", "1");
 
 	MIMEScanner::initialize();
 	HtmlTokenizer::initialize();

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2006-12-12 13:40:00 UTC (rev 647)
+++ trunk/UI/GTK2/src/pinot.cc	2006-12-12 13:42:19 UTC (rev 648)
@@ -146,7 +146,7 @@
 #endif //ENABLE_NLS
 
 	// This should make Xapian use Flint rather than Quartz
-	setenv("XAPIAN_PREFER_FLINT", "1", 1);
+	Glib::setenv("XAPIAN_PREFER_FLINT", "1");
 
 	MIMEScanner::initialize();
 	HtmlTokenizer::initialize();



From fabricecolin at mail.berlios.de  Tue Dec 12 14:44:34 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 12 Dec 2006 14:44:34 +0100
Subject: [Pinot-svn] r649 - trunk/UI/GTK2/src
Message-ID: <200612121344.kBCDiYJv009331@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-12 14:44:34 +0100 (Tue, 12 Dec 2006)
New Revision: 649

Modified:
   trunk/UI/GTK2/src/ResultsTree.cpp
   trunk/UI/GTK2/src/ResultsTree.h
Log:
Store the charset in QueryHistory, convert the extract to UTF-8 before display
and catch (conversion) exceptions in updateRow().


Modified: trunk/UI/GTK2/src/ResultsTree.cpp
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.cpp	2006-12-12 13:42:19 UTC (rev 648)
+++ trunk/UI/GTK2/src/ResultsTree.cpp	2006-12-12 13:44:34 UTC (rev 649)
@@ -353,7 +353,7 @@
 }
 
 bool ResultsTree::onSelectionSelect(const RefPtr<TreeModel>& model,
-		const TreeModel::Path& path, bool path_currently_selected)
+	const TreeModel::Path& path, bool path_currently_selected)
 {
 	const TreeModel::iterator iter = model->get_iter(path);
 	const TreeModel::Row row = *iter;
@@ -533,14 +533,14 @@
 			{
 				// Update this result whatever the current and previous rankings were
 				history.updateItem(m_queryName, engineName, location,
-					title, extract, "", currentScore);
+					title, extract, charset, currentScore);
 				rankDiff = (int)(currentScore - previousScore);
 			}
 			else
 			{
 				// No, this is a new result
 				history.insertItem(m_queryName, engineName, location,
-					resultIter->getTitle(), extract, "", currentScore);
+					resultIter->getTitle(), extract, charset, currentScore);
 				// New results are displayed as such only if the query has already been run on the engine
 				if (isNewQuery == false)
 				{
@@ -1090,9 +1090,6 @@
 						row[m_resultsColumns.m_engines] = row[m_resultsColumns.m_engines] | engineId;
 						// ...and the indexes column too
 						row[m_resultsColumns.m_indexes] = row[m_resultsColumns.m_indexes] | engineId;
-#ifdef DEBUG
-						cout << "ResultsTree::appendResult: merged " << text << " " << engineId << " (" << row[m_resultsColumns.m_engines] << "," << row[m_resultsColumns.m_indexes] << ")" << endl;
-#endif
 
 						newRowIter = childIter;
 						return true;
@@ -1102,10 +1099,6 @@
 		}
 
 		newRowIter = m_refStore->append(parentRow->children());
-#ifdef DEBUG
-		cout << "ResultsTree::appendResult: added " << text << ", " << score << " to "
-			<< (*parentRow)[m_resultsColumns.m_text] << endl;
-#endif
 	}
 
 	IndexInterface *pIndex = m_settings.getIndex("MERGED");
@@ -1220,28 +1213,39 @@
 	const ustring &url, int score, unsigned int engineId,  unsigned int indexId,
 	ResultsModelColumns::ResultType type, bool indexed, bool viewed, int rankDiff)
 {
-	row[m_resultsColumns.m_text] = text;
-	row[m_resultsColumns.m_url] = url;
-	row[m_resultsColumns.m_score] = score;
-	row[m_resultsColumns.m_scoreText] = "";
-	row[m_resultsColumns.m_engines] = engineId;
-	row[m_resultsColumns.m_indexes] = indexId;
-	row[m_resultsColumns.m_type] = type;
+	try
+	{
+		row[m_resultsColumns.m_text] = text;
+		row[m_resultsColumns.m_url] = url;
+		row[m_resultsColumns.m_score] = score;
+		row[m_resultsColumns.m_scoreText] = "";
+		row[m_resultsColumns.m_engines] = engineId;
+		row[m_resultsColumns.m_indexes] = indexId;
+		row[m_resultsColumns.m_type] = type;
 
-	row[m_resultsColumns.m_indexed] = indexed;
-	row[m_resultsColumns.m_viewed] = viewed;
-	row[m_resultsColumns.m_rankDiff] = rankDiff;
+		row[m_resultsColumns.m_indexed] = indexed;
+		row[m_resultsColumns.m_viewed] = viewed;
+		row[m_resultsColumns.m_rankDiff] = rankDiff;
+	}
+	catch (Error &error)
+	{
+		cerr << "ResultsTree::updateRow: " << error.what() << endl;
+	}
+	catch (...)
+	{
+		cerr << "ResultsTree::updateRow: caught unknown exception" << endl;
+	}
 }
 
 //
 // Retrieves the extract to show for the given row.
 //
-string ResultsTree::findResultsExtract(const Gtk::TreeModel::Row &row)
+ustring ResultsTree::findResultsExtract(const Gtk::TreeModel::Row &row)
 {
 	QueryHistory history(m_settings.m_historyDatabase);
 	set<string> engineNames, indexNames;
 	string url(from_utf8(row[m_resultsColumns.m_url]));
-	string extract;
+	string extract, charset;
 	unsigned int engineIds = row[m_resultsColumns.m_engines];
 	unsigned int indexIds = row[m_resultsColumns.m_indexes];
 
@@ -1275,8 +1279,8 @@
 #ifdef DEBUG
 		cout << "ResultsTree::findResultsExtract: first engine for " << url << " was " << engineName << endl;
 #endif
-		extract = history.getItemExtract(from_utf8(m_queryName), engineName, url);
+		extract = history.getItemExtract(from_utf8(m_queryName), engineName, url, charset);
 	}
 
-	return extract;
+	return to_utf8(extract, charset);
 }

Modified: trunk/UI/GTK2/src/ResultsTree.h
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.h	2006-12-12 13:42:19 UTC (rev 648)
+++ trunk/UI/GTK2/src/ResultsTree.h	2006-12-12 13:44:34 UTC (rev 649)
@@ -161,7 +161,7 @@
 			ResultsModelColumns::ResultType type, bool indexed, bool viewed, int rankDiff);
 
 		/// Retrieves the extract to show for the given row.
-		std::string findResultsExtract(const Gtk::TreeModel::Row &row);
+		Glib::ustring findResultsExtract(const Gtk::TreeModel::Row &row);
 
 	private:
 		ResultsTree(const ResultsTree &other);



From fabricecolin at mail.berlios.de  Tue Dec 12 14:45:38 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 12 Dec 2006 14:45:38 +0100
Subject: [Pinot-svn] r650 - trunk/Index
Message-ID: <200612121345.kBCDjcuK009437@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-12 14:45:38 +0100 (Tue, 12 Dec 2006)
New Revision: 650

Modified:
   trunk/Index/pinot-index.cpp
Log:
Load and unload tokenizers !!!


Modified: trunk/Index/pinot-index.cpp
===================================================================
--- trunk/Index/pinot-index.cpp	2006-12-12 13:44:34 UTC (rev 649)
+++ trunk/Index/pinot-index.cpp	2006-12-12 13:45:38 UTC (rev 650)
@@ -119,6 +119,7 @@
 	MIMEScanner::initialize();
 	HtmlTokenizer::initialize();
 	DownloaderInterface::initialize();
+	TokenizerFactory::loadTokenizers(string(LIBDIR) + string("/pinot/tokenizers"));
 
 	// Make sure the index is open in the correct mode
 	XapianDatabase *pDb = XapianDatabaseFactory::getDatabase(argv[optind + 1], (indexDocument ? false : true));
@@ -252,6 +253,7 @@
 	delete pIndex;
 
 	XapianDatabaseFactory::closeAll();
+	TokenizerFactory::unloadTokenizers();
 	DownloaderInterface::shutdown();
 	HtmlTokenizer::shutdown();
 	MIMEScanner::shutdown();



From fabricecolin at mail.berlios.de  Tue Dec 12 14:46:55 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 12 Dec 2006 14:46:55 +0100
Subject: [Pinot-svn] r651 - trunk/Utils
Message-ID: <200612121346.kBCDkt2j009551@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-12 14:46:55 +0100 (Tue, 12 Dec 2006)
New Revision: 651

Modified:
   trunk/Utils/Document.cpp
Log:
In setDataFromFile(), set the document's timestamp and size.


Modified: trunk/Utils/Document.cpp
===================================================================
--- trunk/Utils/Document.cpp	2006-12-12 13:45:38 UTC (rev 650)
+++ trunk/Utils/Document.cpp	2006-12-12 13:46:55 UTC (rev 651)
@@ -27,6 +27,7 @@
 #include <iostream>
 
 #include "Document.h"
+#include "TimeConverter.h"
 
 using std::cout;
 using std::cerr;
@@ -191,6 +192,8 @@
 	{
 		m_pData = (char*)mapSpace;
 		m_dataLength = fileStat.st_size;
+		setTimestamp(TimeConverter::toTimestamp(fileStat.st_mtime));
+		setSize(fileStat.st_size);
 		m_isMapped = true;
 	}
 	else



From fabricecolin at mail.berlios.de  Tue Dec 12 14:47:50 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 12 Dec 2006 14:47:50 +0100
Subject: [Pinot-svn] r652 - trunk/UI/GTK2/src
Message-ID: <200612121347.kBCDloJq009652@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-12 14:47:49 +0100 (Tue, 12 Dec 2006)
New Revision: 652

Modified:
   trunk/UI/GTK2/src/PinotSettings.cpp
Log:
Activate the firstRun flag if the configuration file couldn't be found.


Modified: trunk/UI/GTK2/src/PinotSettings.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.cpp	2006-12-12 13:46:55 UTC (rev 651)
+++ trunk/UI/GTK2/src/PinotSettings.cpp	2006-12-12 13:47:49 UTC (rev 652)
@@ -289,7 +289,8 @@
 	if ((stat(fileName.c_str(), &fileStat) != 0) ||
 		(!S_ISREG(fileStat.st_mode)))
 	{
-		cerr << "Couldn' open configuration file " << fileName << endl;
+		cerr << "Couldn't open configuration file " << fileName << endl;
+		m_firstRun = true;
 		return false;
 	}
 



From fabricecolin at mail.berlios.de  Wed Dec 13 13:49:56 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 13 Dec 2006 13:49:56 +0100
Subject: [Pinot-svn] r653 - in trunk: Index UI/GTK2/src
Message-ID: <200612131249.kBDCnuhP004459@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-13 13:49:55 +0100 (Wed, 13 Dec 2006)
New Revision: 653

Modified:
   trunk/Index/DBusXapianIndex.cpp
   trunk/Index/DBusXapianIndex.h
   trunk/Index/IndexInterface.h
   trunk/Index/XapianIndex.cpp
   trunk/Index/XapianIndex.h
   trunk/UI/GTK2/src/ServerThreads.cpp
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/pinot-dbus-daemon.xml
Log:
Added method setDocumentsLabels() to IndexInterface. DBusXapianIndex's version
maps to a DBus method.
This is definitely faster than calling SetDocumentLabels on each document.
Note that DBusXapianIndex works around a problem with dbus_g_proxy_call(), which
modifies the first argument's pointer.


Modified: trunk/Index/DBusXapianIndex.cpp
===================================================================
--- trunk/Index/DBusXapianIndex.cpp	2006-12-12 13:47:49 UTC (rev 652)
+++ trunk/Index/DBusXapianIndex.cpp	2006-12-13 12:49:55 UTC (rev 653)
@@ -412,6 +412,95 @@
 	return updatedLabels;
 }
 
+/// Sets documents' labels.
+bool DBusXapianIndex::setDocumentsLabels(const set<unsigned int> &docIds,
+	const set<string> &labels, bool resetLabels)
+{
+	bool updatedLabels = false;
+
+	DBusGConnection *pBus = getBusConnection();
+	if (pBus == NULL)
+	{
+		return false;
+	}
+
+	DBusGProxy *pBusProxy = getBusProxy(pBus);
+	if (pBusProxy == NULL)
+	{
+		cerr << "DBusXapianIndex::setDocumentsLabels: couldn't get bus proxy" << endl;
+		return false;
+	}
+
+	GError *pError = NULL;
+	dbus_uint32_t idsCount = docIds.size();
+	dbus_uint32_t labelsCount = labels.size();
+	char *pDocIds[idsCount + 1];
+	char *pLabels[labelsCount + 1];
+	unsigned int idIndex = 0, labelIndex = 0;
+
+	for (set<unsigned int>::const_iterator idIter = docIds.begin();
+		idIter != docIds.end(); ++idIter)
+	{
+		pDocIds[idIndex] = g_strdup_printf("%u", *idIter); 
+#ifdef DEBUG
+		cout << "DBusXapianIndex::setDocumentsLabels: document " << pDocIds[idIndex] << endl;
+#endif
+		++idIndex;
+	}
+	pDocIds[idIndex] = NULL;
+
+	for (set<string>::const_iterator labelIter = labels.begin();
+		labelIter != labels.end(); ++labelIter)
+	{
+		pLabels[labelIndex] = g_strdup(labelIter->c_str());
+#ifdef DEBUG
+		cout << "DBusXapianIndex::setDocumentsLabels: label " << pLabels[labelIndex] << endl;
+#endif
+		++labelIndex;
+	}
+	pLabels[labelIndex] = NULL;
+
+	// FIXME: for some reason the call to dbus_g_proxy_call() changes pDocIds ! Why !?
+	char **pOrigDocIds = pDocIds;
+	// G_TYPE_STRV is the GLib equivalent of DBUS_TYPE_ARRAY, DBUS_TYPE_STRING
+	if (dbus_g_proxy_call(pBusProxy, "SetDocumentsLabels", &pError,
+		G_TYPE_STRV, pDocIds,
+		G_TYPE_STRV, pLabels,
+		G_TYPE_BOOLEAN, resetLabels,
+		G_TYPE_INVALID,
+		G_TYPE_BOOLEAN, &updatedLabels,
+		G_TYPE_INVALID) == FALSE)
+	{
+		if (pError != NULL)
+		{
+			cerr << "DBusXapianIndex::setDocumentsLabels: " << pError->message << endl;
+			g_error_free(pError);
+		}
+		updatedLabels = false;
+	}
+
+	// Free the arrays
+	if (idsCount > 0)
+	{
+		for (unsigned int idNum = 0; idNum < idIndex; ++idNum)
+		{
+			g_free(pOrigDocIds[idNum]);
+		}
+	}
+	if (labelsCount > 0)
+	{
+		for (unsigned int labelNum = 0; labelNum < labelIndex; ++labelNum)
+		{
+			g_free(pLabels[labelNum]);
+		}
+	}
+
+	g_object_unref(pBusProxy);
+	// FIXME: don't we have to call dbus_g_connection_unref(pBus); ?
+
+	return updatedLabels;
+}
+
 /// Unindexes the given document; true if success.
 bool DBusXapianIndex::unindexDocument(unsigned int docId)
 {

Modified: trunk/Index/DBusXapianIndex.h
===================================================================
--- trunk/Index/DBusXapianIndex.h	2006-12-12 13:47:49 UTC (rev 652)
+++ trunk/Index/DBusXapianIndex.h	2006-12-13 12:49:55 UTC (rev 653)
@@ -90,6 +90,10 @@
 		virtual bool setDocumentLabels(unsigned int docId, const std::set<std::string> &labels,
 			bool resetLabels = true);
 
+		/// Sets documents' labels.
+		virtual bool setDocumentsLabels(const std::set<unsigned int> &docIds,
+			const std::set<std::string> &labels, bool resetLabels = true);
+
 		/// Unindexes the given document.
 		virtual bool unindexDocument(unsigned int docId);
 

Modified: trunk/Index/IndexInterface.h
===================================================================
--- trunk/Index/IndexInterface.h	2006-12-12 13:47:49 UTC (rev 652)
+++ trunk/Index/IndexInterface.h	2006-12-13 12:49:55 UTC (rev 653)
@@ -97,6 +97,10 @@
 		virtual bool setDocumentLabels(unsigned int docId, const std::set<std::string> &labels,
 			bool resetLabels = true) = 0;
 
+		/// Sets documents' labels.
+		virtual bool setDocumentsLabels(const std::set<unsigned int> &docIds,
+			const std::set<std::string> &labels, bool resetLabels = true) = 0;
+
 		/// Unindexes the given document.
 		virtual bool unindexDocument(unsigned int docId) = 0;
 

Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-12-12 13:47:49 UTC (rev 652)
+++ trunk/Index/XapianIndex.cpp	2006-12-13 12:49:55 UTC (rev 653)
@@ -1226,6 +1226,16 @@
 bool XapianIndex::setDocumentLabels(unsigned int docId, const set<string> &labels,
 	bool resetLabels)
 {
+	set<unsigned int> docIds;
+
+	docIds.insert(docId);
+	return setDocumentsLabels(docIds, labels, resetLabels);
+}
+
+/// Sets documents' labels.
+bool XapianIndex::setDocumentsLabels(const set<unsigned int> &docIds,
+	const set<string> &labels, bool resetLabels)
+{
 	bool updatedLabels = false;
 
 	XapianDatabase *pDatabase = XapianDatabaseFactory::getDatabase(m_databaseName, false);
@@ -1235,11 +1245,18 @@
 		return false;
 	}
 
-	try
+	for (set<unsigned int>::const_iterator docIter = docIds.begin();
+		docIter != docIds.end(); ++docIter)
 	{
-		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
-		if (pIndex != NULL)
+		try
 		{
+			Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
+			if (pIndex == NULL)
+			{
+				break;
+			}
+
+			unsigned int docId = (*docIter);
 			Xapian::Document doc = pIndex->get_document(docId);
 
 			// Reset existing labels ?
@@ -1273,16 +1290,17 @@
 			pIndex->replace_document(docId, doc);
 			updatedLabels = true;
 		}
+		catch (const Xapian::Error &error)
+		{
+			cerr << "Couldn't update document's labels: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
+		}
+		catch (...)
+		{
+			cerr << "Couldn't update document's labels, unknown exception occured" << endl;
+		}
+
+		pDatabase->unlock();
 	}
-	catch (const Xapian::Error &error)
-	{
-		cerr << "Couldn't update document's labels: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
-	}
-	catch (...)
-	{
-		cerr << "Couldn't update document's labels, unknown exception occured" << endl;
-	}
-	pDatabase->unlock();
 
 	return updatedLabels;
 }

Modified: trunk/Index/XapianIndex.h
===================================================================
--- trunk/Index/XapianIndex.h	2006-12-12 13:47:49 UTC (rev 652)
+++ trunk/Index/XapianIndex.h	2006-12-13 12:49:55 UTC (rev 653)
@@ -88,6 +88,10 @@
 		virtual bool setDocumentLabels(unsigned int docId, const std::set<std::string> &labels,
 			bool resetLabels = true);
 
+		/// Sets documents' labels.
+		virtual bool setDocumentsLabels(const std::set<unsigned int> &docIds,
+			const std::set<std::string> &labels, bool resetLabels = true);
+
 		/// Unindexes the given document.
 		virtual bool unindexDocument(unsigned int docId);
 

Modified: trunk/UI/GTK2/src/ServerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.cpp	2006-12-12 13:47:49 UTC (rev 652)
+++ trunk/UI/GTK2/src/ServerThreads.cpp	2006-12-13 12:49:55 UTC (rev 653)
@@ -916,8 +916,8 @@
 				labels.insert(ppLabels[labelIndex]);
 			}
 #ifdef DEBUG
-			cout << "DBusServletThread::doWork: received SetDocumentLabels " << docId << ", " << resetLabels
-				<< " with " << labelsCount << " labels" << endl;
+			cout << "DBusServletThread::doWork: received SetDocumentLabels on ID " << docId
+				<< ", " << labelsCount << " labels" << ", " << resetLabels << endl;
 #endif
 			// Set labels
 			flushIndex = index.setDocumentLabels(docId, labels, ((resetLabels == TRUE) ? true : false));
@@ -935,6 +935,60 @@
 			}
 		}
 	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "SetDocumentsLabels") == TRUE)
+	{
+		char **ppDocIds = NULL;
+		char **ppLabels = NULL;
+		dbus_uint32_t idsCount = 0;
+		dbus_uint32_t labelsCount = 0;
+		gboolean resetLabels = TRUE;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_ARRAY, DBUS_TYPE_STRING, &ppDocIds, &idsCount,
+			DBUS_TYPE_ARRAY, DBUS_TYPE_STRING, &ppLabels, &labelsCount,
+			DBUS_TYPE_BOOLEAN, &resetLabels,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+			set<unsigned int> docIds;
+			set<string> labels;
+
+			for (dbus_uint32_t idIndex = 0; idIndex < idsCount; ++idIndex)
+			{
+				if (ppDocIds[idIndex] == NULL)
+				{
+					break;
+				}
+				docIds.insert((unsigned int)atoi(ppDocIds[idIndex]));
+			}
+			for (dbus_uint32_t labelIndex = 0; labelIndex < labelsCount; ++labelIndex)
+			{
+				if (ppLabels[labelIndex] == NULL)
+				{
+					break;
+				}
+				labels.insert(ppLabels[labelIndex]);
+			}
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received SetDocumentLabels on " << docIds.size()
+				<< " IDs, " << labelsCount << " labels" << ", " << resetLabels << endl;
+#endif
+			// Set labels
+			flushIndex = index.setDocumentsLabels(docIds, labels, ((resetLabels == TRUE) ? true : false));
+
+			// Free container types
+			g_strfreev(ppDocIds);
+			g_strfreev(ppLabels);
+
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
+			{
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_BOOLEAN, &flushIndex,
+					DBUS_TYPE_INVALID);
+			}
+		}
+	}
 	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "SimpleQuery") == TRUE)
 	{
 		char *pSearchText = NULL;

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-12-12 13:47:49 UTC (rev 652)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-12-13 12:49:55 UTC (rev 653)
@@ -994,6 +994,7 @@
 			IndexInterface *pDocsIndex = m_settings.getIndex(m_settings.m_docsIndexLocation);
 			IndexInterface *pDaemonIndex = m_settings.getIndex(m_settings.m_daemonIndexLocation);
 			set<string> labels;
+			set<unsigned int> docsIds, daemonIds;
 			string labelName(queryProps.getLabelName());
 
 			if (labelName.empty() == false)
@@ -1016,8 +1017,7 @@
 				{
 					if (labelName.empty() == false)
 					{
-						// Only apply the new label to the document
-						pDocsIndex->setDocumentLabels(docId, labels, false);
+						docsIds.insert(docId);
 					}
 				}
 				// Is this a document the daemon indexed ?
@@ -1027,8 +1027,7 @@
 				{
 					if (labelName.empty() == false)
 					{
-						// Only apply the new label to the document
-						pDaemonIndex->setDocumentLabels(docId, labels, false);
+						daemonIds.insert(docId);
 					}
 				}
 				else
@@ -1042,6 +1041,19 @@
 					m_state.queue_index(docInfo);
 				}
 			}
+
+			// Apply the new label to existing documents
+			if (labelName.empty() == false)
+			{
+				if (pDocsIndex != NULL)
+				{
+					pDocsIndex->setDocumentsLabels(docsIds, labels, false);
+				}
+				if (pDaemonIndex != NULL)
+				{
+					pDaemonIndex->setDocumentsLabels(daemonIds, labels, false);
+				}
+			}
 		}
 	}
 	else if (type == "ExpandQueryThread")
@@ -2070,14 +2082,19 @@
 
 	// Now apply these labels to all the documents
 	if ((docLabels.empty() == false) ||
-		(labels.empty() == false))
+		(labels.empty() == false) ||
+		(documentsList.size() > 1))
 	{
+		set<unsigned int> docIds;
+
 		for (vector<IndexedDocument>::iterator docIter = documentsList.begin();
 			docIter != documentsList.end(); ++docIter)
 		{
-			// Set the document's labels list
-			pIndex->setDocumentLabels(docIter->getID(), labels);
+			docIds.insert(docIter->getID());
 		}
+
+		// Set the document's labels list
+		pIndex->setDocumentsLabels(docIds, labels);
 	}
 
 	if ((documentsList.size() == 1) &&

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.xml
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.xml	2006-12-12 13:47:49 UTC (rev 652)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.xml	2006-12-13 12:49:55 UTC (rev 653)
@@ -89,6 +89,19 @@
       <arg type="u" name="docId" direction="out"/>
     </method>
     <!--
+	Sets a group of documents' labels.
+	 docIds: array of document IDs
+	 labels: array of labels to apply to the documents
+	 resetLabels: TRUE if existing labels should be unset
+	-->
+    <method name="SetDocumentLabels">
+      <annotation name="de.berlios.Pinot.SetDocumentLabels" value="pinotDBus"/>
+      <arg type="as" name="docIds" direction="in"/>
+      <arg type="as" name="labels" direction="in"/>
+      <arg type="b" name="resetLabels" direction="in"/>
+      <arg type="b" name="status" direction="out"/>
+    </method>
+    <!--
 	Queries the index.
 	 searchText : search text, as would be entered in Pinot's live query field
 	 maxHits: the maximum number of hits desired



From fabricecolin at mail.berlios.de  Wed Dec 13 14:24:20 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 13 Dec 2006 14:24:20 +0100
Subject: [Pinot-svn] r654 - trunk/Index
Message-ID: <200612131324.kBDDOKdW008431@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-13 14:24:19 +0100 (Wed, 13 Dec 2006)
New Revision: 654

Modified:
   trunk/Index/pinot-index.cpp
Log:
Unload tokenizers on exit.


Modified: trunk/Index/pinot-index.cpp
===================================================================
--- trunk/Index/pinot-index.cpp	2006-12-13 12:49:55 UTC (rev 653)
+++ trunk/Index/pinot-index.cpp	2006-12-13 13:24:19 UTC (rev 654)
@@ -141,6 +141,7 @@
 		cerr << "Couldn't obtain index of type " << argv[optind] << endl;
 
 		XapianDatabaseFactory::closeAll();
+		TokenizerFactory::unloadTokenizers();
 		DownloaderInterface::shutdown();
 		HtmlTokenizer::shutdown();
 		MIMEScanner::shutdown();
@@ -171,6 +172,7 @@
 			cerr << "Couldn't obtain downloader for protocol " << thisUrl.getProtocol() << endl;
 
 			XapianDatabaseFactory::closeAll();
+			TokenizerFactory::unloadTokenizers();
 			DownloaderInterface::shutdown();
 			HtmlTokenizer::shutdown();
 			MIMEScanner::shutdown();



From fabricecolin at mail.berlios.de  Thu Dec 14 12:18:58 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 14 Dec 2006 12:18:58 +0100
Subject: [Pinot-svn] r655 - trunk
Message-ID: <200612141118.kBEBIwgK032204@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-14 12:18:57 +0100 (Thu, 14 Dec 2006)
New Revision: 655

Modified:
   trunk/configure.in
   trunk/pinot.spec.in
Log:
New option --enable-debug. Renamed --with-soap to --enable-soap.


Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-12-13 13:24:19 UTC (rev 654)
+++ trunk/configure.in	2006-12-14 11:18:57 UTC (rev 655)
@@ -69,33 +69,39 @@
 AC_PATH_PROG(PKG_CONFIG, pkg-config, no)
 AC_PATH_PROG(DESKTOP_INSTALL, desktop-file-install, no)
 
+dnl DEBUG mode
+AC_MSG_CHECKING(whether to enable DEBUG mode)
+AC_ARG_ENABLE(debug, [  --enable-debug Enable debug],,[enable_debug=no])
+if test "x$enable_debug" = "xyes"; then
+   if test "x$GCC" = "xyes"; then
+      CXXFLAGS="$CXXFLAGS -ggdb3 -O0 -DDEBUG"
+   fi
+else
+   CXXFLAGS="$CXXFLAGS -DNDEBUG"
+   enable_debug="no"
+fi
+AC_MSG_RESULT($enable_debug)
+
 dnl SOAP API support
 AC_MSG_CHECKING(whether to enable SOAP support)
-AC_ARG_WITH(soap, AS_HELP_STRING(--with-soap@<:@=yes|no@:>@,
-   whether to enable SOAP support (default: no)))
-soapsupport=$with_soap
-if test "x$soapsupport" = "x"; then
-   soapsupport="no"
+AC_ARG_ENABLE(soap, [ --enable-soap Enable SOAP support],,[enable_soap=no])
+if test "x$enable_soap" != "xyes"; then
+   SOAP_CFLAGS=""
+   SOAP_LIBS=""
+   SOAP_SUBDIRS=""
+   SEARCH_LTLIBRARIES="libSearch.la"
+   SEARCH_LIBS="-lSearch"
+   enable_soap=no
 fi
-AC_MSG_RESULT($soapsupport)
-
-case "$soapsupport" in
-yes)
-PKG_CHECK_MODULES(SOAP, gsoap)
-SOAP_CFLAGS="-DHAVE_GOOGLEAPI $SOAP_CFLAGS"
-SOAP_LIBS="$SOAP_LIBS -lSearchSOAP"
-SOAP_SUBDIRS="Search/Google"
-SEARCH_LTLIBRARIES="libSearch.la libSearchSOAP.la"
-SEARCH_LIBS="-lSearch -lSearchGoogle"
-;;
-no)
-SOAP_CFLAGS=""
-SOAP_LIBS=""
-SOAP_SUBDIRS=""
-SEARCH_LTLIBRARIES="libSearch.la"
-SEARCH_LIBS="-lSearch"
-;;
-esac
+AC_MSG_RESULT($enable_soap)
+if test "x$enable_soap" = "xyes"; then
+   PKG_CHECK_MODULES(SOAP, gsoap)
+   SOAP_CFLAGS="-DHAVE_GOOGLEAPI $SOAP_CFLAGS"
+   SOAP_LIBS="$SOAP_LIBS -lSearchSOAP"
+   SOAP_SUBDIRS="Search/Google"
+   SEARCH_LTLIBRARIES="libSearch.la libSearchSOAP.la"
+   SEARCH_LIBS="-lSearch -lSearchGoogle"
+fi
 AC_SUBST(SOAP_CFLAGS)
 AC_SUBST(SOAP_LIBS)
 AC_SUBST(SOAP_SUBDIRS)

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-12-13 13:24:19 UTC (rev 654)
+++ trunk/pinot.spec.in	2006-12-14 11:18:57 UTC (rev 655)
@@ -71,7 +71,7 @@
 %setup -q
 
 %build
-%configure %{?_with_soap:--with-soap=yes} %{?_with_debug:CXXFLAGS="-g -O0 -DDEBUG %{optflags}"}
+%configure %{?_with_soap:--enable-soap=yes} %{?_with_debug:--enable-debug=yes}
 make
 
 %install



From fabricecolin at mail.berlios.de  Thu Dec 14 12:26:16 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 14 Dec 2006 12:26:16 +0100
Subject: [Pinot-svn] r656 - trunk
Message-ID: <200612141126.kBEBQGFg000364@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-14 12:26:16 +0100 (Thu, 14 Dec 2006)
New Revision: 656

Modified:
   trunk/README
Log:
Document which filters apply to all engines.


Modified: trunk/README
===================================================================
--- trunk/README	2006-12-14 11:18:57 UTC (rev 655)
+++ trunk/README	2006-12-14 11:26:16 UTC (rev 656)
@@ -98,17 +98,20 @@
   for HTML files in English that mention TCP/IP. 
 
   Supported filters are :
-	"site" for host name, eg "site:pinot.berlios.de"
-	"file" for file name, eg "file:index.html"
-	"title" for title, eg "title:Session"
-	"url" for URL, eg "url:http://pinot.berlios.de/"
-	"dir" for directory, eg "dir:/home/fabrice/test.txt"
-	"lang" for ISO language code, eg "lang:en"
-	"type" for MIME type, eg "type:text/html"
-	"label" for label, eg "label:Important"
-  Languages detected by this version are "da", "nl", "en", "fi", "fr", "de", "it",
-  "nn", "pt", "ru", "es" and "sv".
+    * filters that apply to all engines
+      "site" for host name, eg "site:pinot.berlios.de"
+      "file" for file name, eg "file:index.html"
+    * filters that only apply to Current User engines
+      "title" for title, eg "title:Session"
+      "url" for URL, eg "url:http://pinot.berlios.de/"
+      "dir" for directory, eg "dir:/home/fabrice/test.txt"
+      "lang" for ISO language code, eg "lang:en"
+      "type" for MIME type, eg "type:text/html"
+      "label" for label, eg "label:Important"
 
+  Allowed language codes are "da", "nl", "en", "fi", "fr", "de", "it", "nn", "pt",
+  "ru", "es" and "sv".
+
   For more information about the query syntax, you may want to have a look at the
   documentation for Xapian's QueryParser at http://www.xapian.org/docs/queryparser.html
 



From fabricecolin at mail.berlios.de  Thu Dec 14 13:20:19 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 14 Dec 2006 13:20:19 +0100
Subject: [Pinot-svn] r657 - in trunk: Index Utils
Message-ID: <200612141220.kBECKJRB017763@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-14 13:20:18 +0100 (Thu, 14 Dec 2006)
New Revision: 657

Modified:
   trunk/Index/XapianIndex.cpp
   trunk/Utils/TimeConverter.cpp
   trunk/Utils/TimeConverter.h
Log:
Date terms Dyyyymmdd, Myyyymm and Yyyyy.


Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-12-14 11:26:16 UTC (rev 656)
+++ trunk/Index/XapianIndex.cpp	2006-12-14 12:20:18 UTC (rev 657)
@@ -394,6 +394,16 @@
 		}
 		doc.add_term(limitTermLength(string("XEXT:") + extension));
 	}
+	// Add the date terms D, M and Y
+	time_t timeT = TimeConverter::fromTimestamp(info.getTimestamp());
+	struct tm *tm = localtime(&timeT);
+	string yyyymmdd = TimeConverter::toTimestamp(tm->tm_year + 1900, tm->tm_mon + 1, tm->tm_mday);
+	if (yyyymmdd.length() == 8)
+	{
+		doc.add_term(string("D") + yyyymmdd);
+		doc.add_term(string("M") + yyyymmdd.substr(0, 6));
+		doc.add_term(string("Y") + yyyymmdd.substr(0, 4));
+	}
 	// Finally, add the language code with prefix L
 	doc.add_term(string("L") + Languages::toCode(m_stemLanguage));
 	// ...and the MIME type with prefix T
@@ -500,6 +510,16 @@
 		}
 		doc.remove_term(limitTermLength(string("XEXT:") + extension));
 	}
+	// Date terms
+	time_t timeT = TimeConverter::fromTimestamp(docInfo.getTimestamp());
+	struct tm *tm = localtime(&timeT);
+	string yyyymmdd = TimeConverter::toTimestamp(tm->tm_year + 1900, tm->tm_mon + 1, tm->tm_mday);
+	if (yyyymmdd.length() == 8)
+	{
+		doc.remove_term(string("D") + yyyymmdd);
+		doc.remove_term(string("M") + yyyymmdd.substr(0, 6));
+		doc.remove_term(string("Y") + yyyymmdd.substr(0, 4));
+	}
 	// Language code
 	doc.remove_term(string("L") + Languages::toCode(language));
 	// MIME type

Modified: trunk/Utils/TimeConverter.cpp
===================================================================
--- trunk/Utils/TimeConverter.cpp	2006-12-14 11:26:16 UTC (rev 656)
+++ trunk/Utils/TimeConverter.cpp	2006-12-14 12:20:18 UTC (rev 657)
@@ -238,3 +238,41 @@
 
 	return 0;
 }
+
+/// Converts into a YYYYMMDD timestamp.
+string TimeConverter::toTimestamp(int year, int month, int day)
+{
+	char timeStr[64];
+
+	if (year < 0)
+	{
+		year = 0;
+	}
+	else if (year > 9999)
+	{
+		year = 9999;
+	}
+	if (month < 1)
+	{
+		month = 1;
+	}
+	else if (month > 12)
+	{
+		month = 12;
+	}
+	if (day < 1)
+	{
+		day = 1;
+	}
+	else if (day > 31)
+	{
+		day = 31;
+	}
+
+	if (snprintf(timeStr, 63, "%04d%02d%02d", year, month, day) > 0)
+	{
+		return timeStr;
+	}
+
+	return "";
+}

Modified: trunk/Utils/TimeConverter.h
===================================================================
--- trunk/Utils/TimeConverter.h	2006-12-14 11:26:16 UTC (rev 656)
+++ trunk/Utils/TimeConverter.h	2006-12-14 12:20:18 UTC (rev 657)
@@ -32,7 +32,10 @@
 
 		/// Converts from a RFC 822 timestamp.
 		static time_t fromTimestamp(const string &timestamp, bool inGMTime = false);
-	
+
+		/// Converts into a YYYYMMDD timestamp.
+		static string toTimestamp(int year, int month, int day);
+
 	protected:
 		TimeConverter();
 



From fabricecolin at mail.berlios.de  Thu Dec 14 13:21:23 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 14 Dec 2006 13:21:23 +0100
Subject: [Pinot-svn] r658 - trunk
Message-ID: <200612141221.kBECLNlb017926@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-14 13:21:23 +0100 (Thu, 14 Dec 2006)
New Revision: 658

Modified:
   trunk/AUTHORS
Log:
Removed specifics of who suggested what, I can't keep track :-)


Modified: trunk/AUTHORS
===================================================================
--- trunk/AUTHORS	2006-12-14 12:20:18 UTC (rev 657)
+++ trunk/AUTHORS	2006-12-14 12:21:23 UTC (rev 658)
@@ -4,12 +4,14 @@
 
 Patches, bug reports and helpful comments :
 
-	Building with CygWin - Reini Urban <rurban at x-ray dot at>
-	SuSE-friendly spec file - Marcus Rueckert <darix at web dot de>
-	Simplified UI - Manuel Breitfeld <manu_foren at gmx dot net>
-	Missing copyright notice - Gauvain Pocentek <gauvainpocentek at gmail dot com>
-	Desktop file installation - Oskar <???>
-	Search-and-index UI deadlock - Thierry Thomas <thierry at freebsd dot org>
+	Reini Urban <rurban at x-ray dot at>
+	Marcus Rueckert <darix at web dot de>
+	Manuel Breitfeld <manu_foren at gmx dot net>
+	Gauvain Pocentek <gauvainpocentek at gmail dot com>
+	Oskar <???>
+	Thierry Thomas <thierry at freebsd dot org>
+	Neal Becker <ndbecker2 at gmail dot com>
+	Gabriel C <nix dot or dot die at googlemail dot com> 
 
 The file Monitor/linux-inotify-syscalls.h is originally from libinotify
 (Copyright ? 2005 Ryan Lortie <desrt at desrt dot ca>).



From fabricecolin at mail.berlios.de  Fri Dec 15 12:35:29 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 15 Dec 2006 12:35:29 +0100
Subject: [Pinot-svn] r659 - trunk/UI/GTK2/src
Message-ID: <200612151135.kBFBZTfr028302@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-15 12:35:28 +0100 (Fri, 15 Dec 2006)
New Revision: 659

Modified:
   trunk/UI/GTK2/src/mainWindow.cc
Log:
When documents are relabeled, call browse_index() so that the list is cleared
if necessary.


Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-12-14 12:21:23 UTC (rev 658)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-12-15 11:35:28 UTC (rev 659)
@@ -2133,7 +2133,7 @@
 		{
 			// The current label may have been applied to or removed from
 			// one or more of the selected documents, so refresh the list
-			start_thread(new IndexBrowserThread(indexName, labelName, 0, 0));
+			browse_index(indexName, labelName, 0, 0);
 		}
 	}
 



From fabricecolin at mail.berlios.de  Fri Dec 15 12:39:00 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 15 Dec 2006 12:39:00 +0100
Subject: [Pinot-svn] r660 - trunk/Index
Message-ID: <200612151139.kBFBd0iB005495@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-15 12:38:56 +0100 (Fri, 15 Dec 2006)
New Revision: 660

Modified:
   trunk/Index/DBusXapianIndex.cpp
Log:
Labelling methods allocate arrays on the heap.


Modified: trunk/Index/DBusXapianIndex.cpp
===================================================================
--- trunk/Index/DBusXapianIndex.cpp	2006-12-15 11:35:28 UTC (rev 659)
+++ trunk/Index/DBusXapianIndex.cpp	2006-12-15 11:38:56 UTC (rev 660)
@@ -316,7 +316,8 @@
 	const char *pTitle = docInfo.getTitle().c_str();
 	const char *pLocation = docInfo.getLocation().c_str();
 	const char *pType = docInfo.getType().c_str();
-	const char *pLanguage = Languages::toEnglish(docInfo.getLanguage()).c_str();
+	string language(Languages::toEnglish(docInfo.getLanguage()));
+	const char *pLanguage = language.c_str();
 
 	if (dbus_g_proxy_call(pBusProxy, "SetDocumentInfo", &pError,
 		G_TYPE_UINT, docId,
@@ -366,9 +367,10 @@
 
 	GError *pError = NULL;
 	dbus_uint32_t labelsCount = labels.size();
-	char *pLabels[labelsCount + 1];
+	char **pLabels;
 	unsigned int labelIndex = 0;
 
+	pLabels = g_new(char *, labelsCount + 1);
 	for (set<string>::const_iterator labelIter = labels.begin();
 		labelIter != labels.end(); ++labelIter)
 	{
@@ -397,14 +399,8 @@
 		}
 	}
 
-	if (labelsCount > 0)
-	{
-		// Free the array
-		for (unsigned int labelNum = 0; labelNum < labelIndex; ++labelNum)
-		{
-			g_free(pLabels[labelNum]);
-		}
-	}
+	// Free the array
+	g_strfreev(pLabels);
 
 	g_object_unref(pBusProxy);
 	// FIXME: don't we have to call dbus_g_connection_unref(pBus); ?
@@ -434,10 +430,12 @@
 	GError *pError = NULL;
 	dbus_uint32_t idsCount = docIds.size();
 	dbus_uint32_t labelsCount = labels.size();
-	char *pDocIds[idsCount + 1];
-	char *pLabels[labelsCount + 1];
+	char **pDocIds;
+	char **pLabels;
 	unsigned int idIndex = 0, labelIndex = 0;
 
+	pDocIds = g_new(char *, idsCount + 1);
+	pLabels = g_new(char *, labelsCount + 1);
 	for (set<unsigned int>::const_iterator idIter = docIds.begin();
 		idIter != docIds.end(); ++idIter)
 	{
@@ -448,7 +446,6 @@
 		++idIndex;
 	}
 	pDocIds[idIndex] = NULL;
-
 	for (set<string>::const_iterator labelIter = labels.begin();
 		labelIter != labels.end(); ++labelIter)
 	{
@@ -460,8 +457,6 @@
 	}
 	pLabels[labelIndex] = NULL;
 
-	// FIXME: for some reason the call to dbus_g_proxy_call() changes pDocIds ! Why !?
-	char **pOrigDocIds = pDocIds;
 	// G_TYPE_STRV is the GLib equivalent of DBUS_TYPE_ARRAY, DBUS_TYPE_STRING
 	if (dbus_g_proxy_call(pBusProxy, "SetDocumentsLabels", &pError,
 		G_TYPE_STRV, pDocIds,
@@ -480,20 +475,8 @@
 	}
 
 	// Free the arrays
-	if (idsCount > 0)
-	{
-		for (unsigned int idNum = 0; idNum < idIndex; ++idNum)
-		{
-			g_free(pOrigDocIds[idNum]);
-		}
-	}
-	if (labelsCount > 0)
-	{
-		for (unsigned int labelNum = 0; labelNum < labelIndex; ++labelNum)
-		{
-			g_free(pLabels[labelNum]);
-		}
-	}
+	g_strfreev(pDocIds);
+	g_strfreev(pLabels);
 
 	g_object_unref(pBusProxy);
 	// FIXME: don't we have to call dbus_g_connection_unref(pBus); ?



From fabricecolin at mail.berlios.de  Sat Dec 16 03:59:37 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 16 Dec 2006 03:59:37 +0100
Subject: [Pinot-svn] r661 - trunk/Index
Message-ID: <200612160259.kBG2xbra010711@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-16 03:59:34 +0100 (Sat, 16 Dec 2006)
New Revision: 661

Modified:
   trunk/Index/pinot-index.cpp
Log:
Fixed argument count checking.


Modified: trunk/Index/pinot-index.cpp
===================================================================
--- trunk/Index/pinot-index.cpp	2006-12-15 11:38:56 UTC (rev 660)
+++ trunk/Index/pinot-index.cpp	2006-12-16 02:59:34 UTC (rev 661)
@@ -109,7 +109,7 @@
 
 	if ((argc < 3) ||
 		(optind >= argc) ||
-		(optind + 2 < argc) ||
+		(optind + 2 != argc) ||
 		((indexDocument == false) && (checkDocument == false)))
 	{
 		cerr << "Incorrect parameters" << endl;



From fabricecolin at mail.berlios.de  Sat Dec 16 05:03:19 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 16 Dec 2006 05:03:19 +0100
Subject: [Pinot-svn] r662 - trunk/Tokenize
Message-ID: <200612160403.kBG43JKe016185@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-16 05:03:18 +0100 (Sat, 16 Dec 2006)
New Revision: 662

Modified:
   trunk/Tokenize/TagLibTokenizer.cpp
Log:
Save the document's content to a temporary file if necessary.
Don't request all documents.


Modified: trunk/Tokenize/TagLibTokenizer.cpp
===================================================================
--- trunk/Tokenize/TagLibTokenizer.cpp	2006-12-16 02:59:34 UTC (rev 661)
+++ trunk/Tokenize/TagLibTokenizer.cpp	2006-12-16 04:03:18 UTC (rev 662)
@@ -45,7 +45,7 @@
 /// This returns the data needs of the provided Tokenizer(s).
 int getTokenizerDataNeeds(void)
 {
-	return Tokenizer::ALL_DOCUMENTS;
+	return Tokenizer::ALL_BUT_FILES;
 }
 
 /// This returns a pointer to a Tokenizer, allocated with new.
@@ -61,18 +61,41 @@
 	if (pDocument != NULL)
 	{
 		Url urlObj(pDocument->getLocation());
-		string pseudoContent;
+		string location;
+		unsigned int dataLength = 0;
+		const char *pData = pDocument->getData(dataLength);
+		char inTemplate[15] = "/tmp/tokXXXXXX";
+		bool deleteInFile = false;
 
-		if ((urlObj.isLocal() == true) &&
+		// Is this a file ?
+		if ((urlObj.getProtocol() == "file") &&
 			(urlObj.getFile().empty() == false))
 		{
-			string location(urlObj.getLocation());
-			string trackTitle;
-
+			location = urlObj.getLocation();
 			location += "/";
 			location += urlObj.getFile();
+		}
+		else
+		{
+			int inFd = mkstemp(inTemplate);
+			if (inFd != -1)
+			{
+				// Save the data into a temporary file
+				if (write(inFd, (const void*)pData, dataLength) != -1)
+				{
+					location = inTemplate;
+				}
 
+				deleteInFile = true;
+				close(inFd);
+			}
+		}
+
+		if (location.empty() == false)
+		{
 			TagLib::FileRef fileRef(location.c_str(), false);
+			string trackTitle, pseudoContent;
+
 			if (fileRef.isNull() == false)
 			{
 				TagLib::Tag *pTag = fileRef.tag();
@@ -110,6 +133,12 @@
 			// Give the result to the parent class
 			setDocument(m_pTagDocument);
 		}
+
+		// Delete the temporary file ?
+		if (deleteInFile == true)
+		{
+			unlink(inTemplate);
+		}
 	}
 }
 



From fabricecolin at mail.berlios.de  Mon Dec 18 11:52:31 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 18 Dec 2006 11:52:31 +0100
Subject: [Pinot-svn] r663 - trunk
Message-ID: <200612181052.kBIAqVfj013068@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-18 11:52:30 +0100 (Mon, 18 Dec 2006)
New Revision: 663

Modified:
   trunk/README
   trunk/TODO
Log:
Minus 9 items, plus 3.


Modified: trunk/README
===================================================================
--- trunk/README	2006-12-16 04:03:18 UTC (rev 662)
+++ trunk/README	2006-12-18 10:52:30 UTC (rev 663)
@@ -1,6 +1,6 @@
 Pinot
+Copyright 2005 Fabrice Colin <fabricecolin at users dot berlios dot de>
 http://pinot.berlios.de/
-Fabrice Colin <fabricecolin at users dot berlios dot de>
 
 
 1. What is Pinot

Modified: trunk/TODO
===================================================================
--- trunk/TODO	2006-12-16 04:03:18 UTC (rev 662)
+++ trunk/TODO	2006-12-18 10:52:30 UTC (rev 663)
@@ -3,21 +3,17 @@
 - Get rid of dead code/classes/methods...
 - Advertise service via Rendezvous
 - MIMEScanner should also return parent types so that we don't filter out types unnecessarily
-- Build a -devel package for those who want to write their own tokenizers
-- Generate doxygen documentation
 - Load desktop files from /usr/share/applications/kde ?
-- Build with -DNDEBUG in non-DEBUG mode
+- DBUS_API_SUBJECT_TO_CHANGE only needed for DBus < 1.0
 
 Tokenize
 - Allow to cache documents that had to be converted ? eg PDF, MS Word
 - PDF tokenizer with poppler
 - WordPerfect tokenizer with libwpd
 - Office tokenizer with libgst
-- Spin tokenizers into separate project, a la libextractor
 - Check whether pdftotext flattens text in PDF documents that have columns
 - HtmlTokenizer should skip htdig_noindex blocks (http://www.htdig.org/attrs.html#noindex_start)
 - HtmlTokenizer to look for META tags Author, Creator, Publisher and CreationDate
-- Don't load documents' content for unsupported types
 
 Monitor
 - Implement support for Solaris FEM
@@ -28,6 +24,7 @@
 - Make User-Agent string configurable
 - Make download timeout configurable
 - Support for HTML frames
+- Curl and Neon must support a proxy, so allow to configure that
 
 Search
 - With engines that provide a redirection URL for results (eg Acoona), it looks like
@@ -54,9 +51,7 @@
   defined in /usr/include/xapian/dbfactory.h (xapian-progsrv backend)
 - All indexes can be browsed with the new global posting list found in Xapian > 0.9.9, ie
   Xapian::Database::postlist_begin("")
-- Store date as terms (D, M and Y prefixes), as done by omindex
 - Index xattrs if any
-- pinot-index doesn't initialize tokenizers
 
 Mail
 - Find out what kind of locking scheme Mozilla uses (POSIX lock ?) and use that
@@ -79,9 +74,9 @@
 - Export Web searching over D-Bus
 - Labels should be managed by the daemon, and not saved to the configuration file
 - Make sure labels are alpha-numeric characters exclusively
-- DBus SetDocumentLabels should create labels if necessary
+- DBus SetDocument[s]Labels should create labels if necessary
 - Reintroduce Index method in D-Bus interface
-- Actions stemming from DBus messages should be handled by a separate thread that posts replies
+- Allow notifications when new locations need crawling !
 
 UI
 - When sorting results by host name, give better score to results that appear several times
@@ -93,13 +88,13 @@
 - Replace Combobox objects with ComboboxText's (glademm support required)
 - Replace glademm with libglademm ?
 - Filter documents by language, similarly to how labels are shown
-- Closing when threads are running gives the impression Pinot has crashed; how do we tell the user
-  we are waiting for something to finish ?
 - Replace labels with tags (Leaftag, http://www.chipx86.com/wiki/Leaftag). Enable to import
   all the documents that match a specific tag
 - Either Live Query behaves like a live query (eg results list updated when new documents match)
   or it is renamed to something else to avoid confusion
 - Labels should be set by a separate thread
 - When viewing a result, all rows for that same URL should be updated with the Viewed icon
-- Prompt users for a command-line if the type of the document to open has no application
+- Prompt users for a command-line if the type of the document to open has no application,
+  with default to xdg-open if it's available
 
+



From fabricecolin at mail.berlios.de  Mon Dec 18 11:53:11 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 18 Dec 2006 11:53:11 +0100
Subject: [Pinot-svn] r664 - trunk/Tokenize
Message-ID: <200612181053.kBIArB0G013114@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-18 11:53:10 +0100 (Mon, 18 Dec 2006)
New Revision: 664

Modified:
   trunk/Tokenize/TagLibTokenizer.h
Log:
Corrected define typo.


Modified: trunk/Tokenize/TagLibTokenizer.h
===================================================================
--- trunk/Tokenize/TagLibTokenizer.h	2006-12-18 10:52:30 UTC (rev 663)
+++ trunk/Tokenize/TagLibTokenizer.h	2006-12-18 10:53:10 UTC (rev 664)
@@ -16,8 +16,8 @@
  *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
  */
 
-#ifndef _WORD_TOKENIZER_H
-#define _WORD_TOKENIZER_H
+#ifndef _TAGLIB_TOKENIZER_H
+#define _TAGLIB_TOKENIZER_H
 
 #include <string>
 #include <set>
@@ -48,4 +48,4 @@
 
 };
 
-#endif // _WORD_TOKENIZER_H
+#endif // _TAGLIB_TOKENIZER_H



From fabricecolin at mail.berlios.de  Tue Dec 19 12:08:20 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 19 Dec 2006 12:08:20 +0100
Subject: [Pinot-svn] r665 - trunk/UI/GTK2/src
Message-ID: <200612191108.kBJB8Kw1007335@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-19 12:08:19 +0100 (Tue, 19 Dec 2006)
New Revision: 665

Modified:
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
Log:
The daemon doesn't have load engine plugins.


Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-18 10:53:10 UTC (rev 664)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-19 11:08:19 UTC (rev 665)
@@ -260,9 +260,6 @@
 	Languages::setIntlName(11, _("Spanish"));
 	Languages::setIntlName(12, _("Swedish"));
 
-	// Load search engines
-	settings.loadSearchEngines(prefixDir + string("/share/pinot/engines"));
-	settings.loadSearchEngines(confDirectory + string("/engines"));
 	// Load tokenizer libraries, if any
 	TokenizerFactory::loadTokenizers(string(LIBDIR) + string("/pinot/tokenizers"));
 	TokenizerFactory::loadTokenizers(confDirectory + string("/tokenizers"));



From fabricecolin at mail.berlios.de  Tue Dec 19 12:10:30 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 19 Dec 2006 12:10:30 +0100
Subject: [Pinot-svn] r666 - trunk/Index
Message-ID: <200612191110.kBJBAU0O007608@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-19 12:10:30 +0100 (Tue, 19 Dec 2006)
New Revision: 666

Modified:
   trunk/Index/XapianIndex.cpp
   trunk/Index/XapianIndex.h
Log:
In removeCommonTerms(), be prepared for some terms to not be present in the
document, eg if the document was indexed with a previous version that didn't
create the same terms.
Changed addCommonTerms() prototype.


Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-12-19 11:08:19 UTC (rev 665)
+++ trunk/Index/XapianIndex.cpp	2006-12-19 11:10:30 UTC (rev 666)
@@ -326,7 +326,7 @@
 	}
 }
 
-bool XapianIndex::addCommonTerms(const DocumentInfo &info, Xapian::Document &doc,
+void XapianIndex::addCommonTerms(const DocumentInfo &info, Xapian::Document &doc,
 	Xapian::termcount &termPos) const
 {
 	string title(info.getTitle());
@@ -408,17 +408,16 @@
 	doc.add_term(string("L") + Languages::toCode(m_stemLanguage));
 	// ...and the MIME type with prefix T
 	doc.add_term(string("T") + info.getType());
-
-	return true;
 }
 
 void XapianIndex::removeCommonTerms(Xapian::Document &doc)
 {
 	DocumentInfo docInfo;
+	set<string> commonTerms;
 	string record(doc.get_data());
 
 	// First, remove the magic term
-	doc.remove_term(MAGIC_TERM);
+	commonTerms.insert(MAGIC_TERM);
 
 	if (record.empty() == true)
         {
@@ -464,16 +463,16 @@
 	}
 
 	// Title
-	doc.remove_term(limitTermLength(string("U") + docInfo.getLocation(), true));
+	commonTerms.insert(limitTermLength(string("U") + docInfo.getLocation(), true));
 	// Host name
 	string hostName(StringManip::toLowerCase(urlObj.getHost()));
 	if (hostName.empty() == false)
 	{
-		doc.remove_term(limitTermLength(string("H") + hostName, true));
+		commonTerms.insert(limitTermLength(string("H") + hostName, true));
 		string::size_type dotPos = hostName.find('.');
 		while (dotPos != string::npos)
 		{
-			doc.remove_term(limitTermLength(string("H") + hostName.substr(dotPos + 1), true));
+			commonTerms.insert(limitTermLength(string("H") + hostName.substr(dotPos + 1), true));
 
 			// Next
 			dotPos = hostName.find('.', dotPos + 1);
@@ -483,11 +482,11 @@
 	string tree(urlObj.getLocation());
 	if (tree.empty() == false)
 	{
-		doc.remove_term(limitTermLength(string("XDIR:") + tree, true));
+		commonTerms.insert(limitTermLength(string("XDIR:") + tree, true));
 		string::size_type slashPos = tree.find('/', 1);
 		while (slashPos != string::npos)
 		{
-			doc.remove_term(limitTermLength(string("XDIR:") + tree.substr(0, slashPos), true));
+			commonTerms.insert(limitTermLength(string("XDIR:") + tree.substr(0, slashPos), true));
 
 			// Next
 			slashPos = tree.find('/', slashPos + 1);
@@ -499,7 +498,7 @@
 	{
 		string extension;
 
-		doc.remove_term(limitTermLength(string("P") + fileName, true));
+		commonTerms.insert(limitTermLength(string("P") + fileName, true));
 
 		// Does it have an extension ?
 		string::size_type extPos = fileName.rfind('.');
@@ -508,7 +507,7 @@
 		{
 			extension = StringManip::toLowerCase(fileName.substr(extPos + 1));
 		}
-		doc.remove_term(limitTermLength(string("XEXT:") + extension));
+		commonTerms.insert(limitTermLength(string("XEXT:") + extension));
 	}
 	// Date terms
 	time_t timeT = TimeConverter::fromTimestamp(docInfo.getTimestamp());
@@ -516,14 +515,28 @@
 	string yyyymmdd = TimeConverter::toTimestamp(tm->tm_year + 1900, tm->tm_mon + 1, tm->tm_mday);
 	if (yyyymmdd.length() == 8)
 	{
-		doc.remove_term(string("D") + yyyymmdd);
-		doc.remove_term(string("M") + yyyymmdd.substr(0, 6));
-		doc.remove_term(string("Y") + yyyymmdd.substr(0, 4));
+		commonTerms.insert(string("D") + yyyymmdd);
+		commonTerms.insert(string("M") + yyyymmdd.substr(0, 6));
+		commonTerms.insert(string("Y") + yyyymmdd.substr(0, 4));
 	}
 	// Language code
-	doc.remove_term(string("L") + Languages::toCode(language));
+	commonTerms.insert(string("L") + Languages::toCode(language));
 	// MIME type
-	doc.remove_term(string("T") + docInfo.getType());
+	commonTerms.insert(string("T") + docInfo.getType());
+
+	for (set<string>::const_iterator termIter = commonTerms.begin(); termIter != commonTerms.end(); ++termIter)
+	{
+		try
+		{
+			doc.remove_term(*termIter);
+		}
+		catch (const Xapian::Error &error)
+		{
+#ifdef DEBUG
+			cout << "XapianIndex::removeCommonTerms: " << error.get_errno() << " " << error.get_msg() << endl;
+#endif
+		}
+	}
 }
 
 string XapianIndex::scanDocument(const char *pData, unsigned int dataLength,
@@ -1085,17 +1098,15 @@
 		{
 			doc.add_term(limitTermLength(string("XLABEL:") + *labelIter));
 		}
-		if (addCommonTerms(docInfo, doc, termPos) == true)
+		addCommonTerms(docInfo, doc, termPos);
+		setDocumentData(docInfo, doc, m_stemLanguage);
+
+		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
+		if (pIndex != NULL)
 		{
-			setDocumentData(docInfo, doc, m_stemLanguage);
-
-			Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
-			if (pIndex != NULL)
-			{
-				// Add this document to the Xapian index
-				docId = pIndex->add_document(doc);
-				indexed = true;
-			}
+			// Add this document to the Xapian index
+			docId = pIndex->add_document(doc);
+			indexed = true;
 		}
 	}
 	catch (const Xapian::Error &error)
@@ -1168,17 +1179,15 @@
 				doc.add_term(limitTermLength(string("XLABEL:") + *labelIter));
 			}
 		}
-		if (addCommonTerms(docInfo, doc, termPos) == true)
+		addCommonTerms(docInfo, doc, termPos);
+		setDocumentData(docInfo, doc, m_stemLanguage);
+
+		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
+		if (pIndex != NULL)
 		{
-			setDocumentData(docInfo, doc, m_stemLanguage);
-
-			Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
-			if (pIndex != NULL)
-			{
-				// Update the document in the database
-				pIndex->replace_document(docId, doc);
-				updated = true;
-			}
+			// Update the document in the database
+			pIndex->replace_document(docId, doc);
+			updated = true;
 		}
 	}
 	catch (const Xapian::Error &error)

Modified: trunk/Index/XapianIndex.h
===================================================================
--- trunk/Index/XapianIndex.h	2006-12-19 11:08:19 UTC (rev 665)
+++ trunk/Index/XapianIndex.h	2006-12-19 11:10:30 UTC (rev 666)
@@ -130,7 +130,7 @@
 		void removeFirstPostingsFromDocument(Tokenizer &tokens, Xapian::Document &doc,
 			const std::string &prefix, const std::string &language, StemmingMode mode) const;
 
-		bool addCommonTerms(const DocumentInfo &info, Xapian::Document &doc,
+		void addCommonTerms(const DocumentInfo &info, Xapian::Document &doc,
 			Xapian::termcount &termPos) const;
 
 		void removeCommonTerms(Xapian::Document &doc);



From fabricecolin at mail.berlios.de  Wed Dec 20 14:00:25 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 20 Dec 2006 14:00:25 +0100
Subject: [Pinot-svn] r667 - trunk/Tokenize
Message-ID: <200612201300.kBKD0Pw9013381@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-20 14:00:20 +0100 (Wed, 20 Dec 2006)
New Revision: 667

Modified:
   trunk/Tokenize/HtmlTokenizer.cpp
Log:
Error and warning handlers log only in DEBUG mode.


Modified: trunk/Tokenize/HtmlTokenizer.cpp
===================================================================
--- trunk/Tokenize/HtmlTokenizer.cpp	2006-12-19 11:10:30 UTC (rev 666)
+++ trunk/Tokenize/HtmlTokenizer.cpp	2006-12-20 13:00:20 UTC (rev 667)
@@ -407,9 +407,10 @@
 	va_start(args, pMsg);
 	vsnprintf(pErr, 1000, pMsg, args );
 	va_end(args);
+#ifdef DEBUG
+	cout << "HtmlTokenizer::errorHandler: " << pErr << endl;
+#endif
 
-	cerr << "HtmlTokenizer::errorHandler: " << pErr << endl;
-
 	// Be lenient as much as possible
 	xmlResetLastError();
 	// ...but remember the document had errors
@@ -424,8 +425,9 @@
 	va_start(args, pMsg);
 	vsnprintf(pErr, 1000, pMsg, args );
 	va_end(args);
-
-	cerr << "HtmlTokenizer::warningHandler: " << pErr << endl;
+#ifdef DEBUG
+	cout << "HtmlTokenizer::warningHandler: " << pErr << endl;
+#endif
 }
 
 Link::Link() :
@@ -626,7 +628,7 @@
 #endif
 	else
 	{
-		cerr << "HtmlTokenizer::parseHTML: couldn't create parser context" << endl;
+		cerr << "Couldn't create HTML parser" << endl;
 	}
 
 	// The text after the last link might make a good abstract



From fabricecolin at mail.berlios.de  Wed Dec 20 14:01:19 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 20 Dec 2006 14:01:19 +0100
Subject: [Pinot-svn] r668 - trunk
Message-ID: <200612201301.kBKD1Jfg013645@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-20 14:01:19 +0100 (Wed, 20 Dec 2006)
New Revision: 668

Modified:
   trunk/pinot.desktop
Log:
Removed Application from Categories to keep desktop-file-install 0.11 happy.


Modified: trunk/pinot.desktop
===================================================================
--- trunk/pinot.desktop	2006-12-20 13:00:20 UTC (rev 667)
+++ trunk/pinot.desktop	2006-12-20 13:01:19 UTC (rev 668)
@@ -10,5 +10,5 @@
 Icon=pinot.png
 Terminal=false
 Type=Application
-Categories=GTK;Core;Application;Network;Filesystem;
+Categories=GTK;Core;Network;Filesystem;
 Encoding=UTF-8



From fabricecolin at mail.berlios.de  Wed Dec 20 14:17:01 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 20 Dec 2006 14:17:01 +0100
Subject: [Pinot-svn] r669 - trunk/po
Message-ID: <200612201317.kBKDH1IY016373@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-20 14:16:58 +0100 (Wed, 20 Dec 2006)
New Revision: 669

Modified:
   trunk/po/es.po
   trunk/po/fr.po
   trunk/po/nl.po
   trunk/po/sv.po
Log:
Synced translations with source.


Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2006-12-20 13:01:19 UTC (rev 668)
+++ trunk/po/es.po	2006-12-20 13:16:58 UTC (rev 669)
@@ -6,10 +6,10 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.64\n"
+"Project-Id-Version: pinot 0.65\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-12-04 22:28+0800\n"
-"PO-Revision-Date: 2006-12-03 15:05+0000\n"
+"POT-Creation-Date: 2006-12-03 15:05+0000\n"
+"PO-Revision-Date: 2006-12-20 21:10+0800\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: es <fabricecolin at users.berlios.de>\n"
 "MIME-Version: 1.0\n"
@@ -25,18 +25,18 @@
 msgid "Current User"
 msgstr "Usuario"
 
-#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
-#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
-#: UI/GTK2/src/mainWindow.cc:1153 UI/GTK2/src/mainWindow.cc:1196
-#: UI/GTK2/src/mainWindow.cc:1216 UI/GTK2/src/mainWindow.cc:1247
-#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/PinotSettings.cpp:235
-#: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:322
+#: UI/GTK2/src/mainWindow.cc:325 UI/GTK2/src/mainWindow.cc:551
+#: UI/GTK2/src/mainWindow.cc:1205 UI/GTK2/src/mainWindow.cc:1248
+#: UI/GTK2/src/mainWindow.cc:1268 UI/GTK2/src/mainWindow.cc:1299
+#: UI/GTK2/src/mainWindow.cc:1869 UI/GTK2/src/PinotSettings.cpp:240
+#: UI/GTK2/src/PinotSettings.cpp:1230 UI/GTK2/src/PinotSettings.cpp:1286
 msgid "My Web Pages"
 msgstr "Mis Paginas Web"
 
-#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:310
-#: UI/GTK2/src/mainWindow.cc:313 UI/GTK2/src/PinotSettings.cpp:236
-#: UI/GTK2/src/PinotSettings.cpp:1225 UI/GTK2/src/PinotSettings.cpp:1281
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:316
+#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/PinotSettings.cpp:241
+#: UI/GTK2/src/PinotSettings.cpp:1231 UI/GTK2/src/PinotSettings.cpp:1287
 msgid "My Documents"
 msgstr "Mis documentos"
 
@@ -143,182 +143,182 @@
 msgid "Ready"
 msgstr "Listo"
 
-#: UI/GTK2/src/mainWindow.cc:234
+#: UI/GTK2/src/mainWindow.cc:240
 msgid "N/A"
 msgstr "Desconocido"
 
-#: UI/GTK2/src/mainWindow.cc:249
+#: UI/GTK2/src/mainWindow.cc:255
 msgid "<undefined>"
 msgstr "<indefinido>"
 
-#: UI/GTK2/src/mainWindow.cc:468
+#: UI/GTK2/src/mainWindow.cc:474
 msgid "Result location is"
 msgstr "La localizaci?n del resultado es"
 
-#: UI/GTK2/src/mainWindow.cc:555
+#: UI/GTK2/src/mainWindow.cc:561
 msgid "Document location is"
 msgstr "La localizaci?n del documento es"
 
-#: UI/GTK2/src/mainWindow.cc:878
+#: UI/GTK2/src/mainWindow.cc:884
 msgid "Showing"
 msgstr "Mostrando"
 
-#: UI/GTK2/src/mainWindow.cc:883
+#: UI/GTK2/src/mainWindow.cc:889
 msgid "of"
 msgstr "documentos"
 
-#: UI/GTK2/src/mainWindow.cc:888
+#: UI/GTK2/src/mainWindow.cc:894
 msgid "documents, starting at"
 msgstr "documentos comenzando en"
 
-#: UI/GTK2/src/mainWindow.cc:921
+#: UI/GTK2/src/mainWindow.cc:927
 msgid "Query"
 msgstr "B?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:925 UI/GTK2/src/mainWindow.cc:2876
+#: UI/GTK2/src/mainWindow.cc:931 UI/GTK2/src/mainWindow.cc:2937
 msgid "on"
 msgstr "en"
 
-#: UI/GTK2/src/mainWindow.cc:929
+#: UI/GTK2/src/mainWindow.cc:935
 msgid "ended"
 msgstr "finalizado"
 
-#: UI/GTK2/src/mainWindow.cc:1018
+#: UI/GTK2/src/mainWindow.cc:1070
 msgid "More Like"
 msgstr "M?s como"
 
-#: UI/GTK2/src/mainWindow.cc:1079
+#: UI/GTK2/src/mainWindow.cc:1131
 msgid "Updated label(s)"
 msgstr "Etiqueta(s) actualizada(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1163
+#: UI/GTK2/src/mainWindow.cc:1215
 msgid "Updated document"
 msgstr "Documento actualizado"
 
-#: UI/GTK2/src/mainWindow.cc:1176
+#: UI/GTK2/src/mainWindow.cc:1228
 msgid "Indexed"
 msgstr "Indizado"
 
-#: UI/GTK2/src/mainWindow.cc:1217
+#: UI/GTK2/src/mainWindow.cc:1269
 msgid "Unindexed document(s)"
 msgstr "Documento(s) no indizado(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1258
+#: UI/GTK2/src/mainWindow.cc:1310
 msgid "Updated document properties"
 msgstr "Propiedades del documento actualizadas"
 
-#: UI/GTK2/src/mainWindow.cc:1305
+#: UI/GTK2/src/mainWindow.cc:1357
 msgid "Couldn't rename index, name"
 msgstr "No se pudo renombrar ?ndice, nombre"
 
-#: UI/GTK2/src/mainWindow.cc:1309 UI/GTK2/src/mainWindow.cc:2200
-#: UI/GTK2/src/mainWindow.cc:2711
+#: UI/GTK2/src/mainWindow.cc:1361 UI/GTK2/src/mainWindow.cc:2261
+#: UI/GTK2/src/mainWindow.cc:2772
 msgid "is already in use"
 msgstr "ya est? en uso"
 
-#: UI/GTK2/src/mainWindow.cc:1322
+#: UI/GTK2/src/mainWindow.cc:1374
 msgid "Couldn't rename index"
 msgstr "No se pudo renombrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1335
+#: UI/GTK2/src/mainWindow.cc:1387
 msgid "Edited index"
 msgstr "?ndice editado"
 
-#: UI/GTK2/src/mainWindow.cc:1695 UI/GTK2/src/mainWindow.cc:2370
+#: UI/GTK2/src/mainWindow.cc:1747 UI/GTK2/src/mainWindow.cc:2431
 msgid "Live query"
 msgstr "B?squeda activa"
 
-#: UI/GTK2/src/mainWindow.cc:1721
+#: UI/GTK2/src/mainWindow.cc:1773
 msgid "Couldn't find query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:1765 UI/GTK2/src/mainWindow.cc:1861
+#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/mainWindow.cc:1913
 msgid "Please set a location for the index first"
 msgstr "Por favor, primero fije una localizaci?n para el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1940 UI/GTK2/src/WorkerThreads.cpp:675
-#: UI/GTK2/src/WorkerThreads.cpp:1519
+#: UI/GTK2/src/mainWindow.cc:1992 UI/GTK2/src/WorkerThreads.cpp:671
+#: UI/GTK2/src/WorkerThreads.cpp:1518
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1944 UI/GTK2/src/WorkerThreads.cpp:679
-#: UI/GTK2/src/WorkerThreads.cpp:1523
+#: UI/GTK2/src/mainWindow.cc:1996 UI/GTK2/src/WorkerThreads.cpp:675
+#: UI/GTK2/src/WorkerThreads.cpp:1522
 msgid "doesn't exist"
 msgstr "no existe"
 
-#: UI/GTK2/src/mainWindow.cc:2088
+#: UI/GTK2/src/mainWindow.cc:2149
 msgid "Remove this document from the index ?"
 msgstr "?Borrar este documento del ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2107
+#: UI/GTK2/src/mainWindow.cc:2168
 msgid "Remove these documents from the index ?"
 msgstr "?Borrar este documento del ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2151
+#: UI/GTK2/src/mainWindow.cc:2212
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Una herramienta metabuscador para el escritorio libre"
 
-#: UI/GTK2/src/mainWindow.cc:2152
+#: UI/GTK2/src/mainWindow.cc:2213
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2257
 msgid "Index name"
 msgstr "Nombre del ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2211
+#: UI/GTK2/src/mainWindow.cc:2272
 msgid "Couldn't add index"
 msgstr "No se pudo a?adir el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2225
+#: UI/GTK2/src/mainWindow.cc:2286
 msgid "Added new index"
 msgstr "A?adido un nuevo ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2260
+#: UI/GTK2/src/mainWindow.cc:2321
 msgid "Couldn't remove index"
 msgstr "No se pudo borrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2525
+#: UI/GTK2/src/mainWindow.cc:2586
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Al menos una tarea no ha finalizado. ?Parar ahora?"
 
-#: UI/GTK2/src/mainWindow.cc:2707
+#: UI/GTK2/src/mainWindow.cc:2768
 msgid "Query name"
 msgstr "Nombre la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2734
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Couldn't update query"
 msgstr "No se pudo actualizar la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2742
+#: UI/GTK2/src/mainWindow.cc:2803
 msgid "Edited query"
 msgstr "B?squeda editada"
 
-#: UI/GTK2/src/mainWindow.cc:2749
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Couldn't add query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2757
+#: UI/GTK2/src/mainWindow.cc:2818
 msgid "Added new query"
 msgstr "A?adida una nueva b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2770
+#: UI/GTK2/src/mainWindow.cc:2831
 msgid "Query is not set"
 msgstr "B?squeda no definida"
 
-#: UI/GTK2/src/mainWindow.cc:2781
+#: UI/GTK2/src/mainWindow.cc:2842
 msgid "No search engine selected"
 msgstr "Motor de b?squeda no seleccionado"
 
-#: UI/GTK2/src/mainWindow.cc:2863
+#: UI/GTK2/src/mainWindow.cc:2924
 msgid "Please set the Google API key first"
 msgstr "Por favor, primero configure el API de Google"
 
-#: UI/GTK2/src/mainWindow.cc:2872
+#: UI/GTK2/src/mainWindow.cc:2933
 msgid "Running query"
 msgstr "Ejecutando la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:3044
+#: UI/GTK2/src/mainWindow.cc:3105
 msgid "No default application defined for type"
 msgstr "No hay aplicaci?n predefinida para el tipo"
 
@@ -415,79 +415,79 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:249
 msgid "Unknown"
 msgstr "Desconocido"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:250
 msgid "Danish"
 msgstr "Dan?s"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:251
 msgid "Dutch"
 msgstr "Holand?s"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:252
 msgid "English"
 msgstr "Ingl?s"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:253
 msgid "Finnish"
 msgstr "Finland?s"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:254
 msgid "French"
 msgstr "Franc?s"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+#: UI/GTK2/src/pinot.cc:186 UI/GTK2/src/pinot-dbus-daemon.cc:255
 msgid "German"
 msgstr "Alem?n"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+#: UI/GTK2/src/pinot.cc:187 UI/GTK2/src/pinot-dbus-daemon.cc:256
 msgid "Italian"
 msgstr "Italiano"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+#: UI/GTK2/src/pinot.cc:188 UI/GTK2/src/pinot-dbus-daemon.cc:257
 msgid "Norwegian"
 msgstr "Noruego"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+#: UI/GTK2/src/pinot.cc:189 UI/GTK2/src/pinot-dbus-daemon.cc:258
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:712
+#: UI/GTK2/src/pinot.cc:190 UI/GTK2/src/pinot-dbus-daemon.cc:259
 msgid "Russian"
 msgstr "Ruso"
 
-#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:713
+#: UI/GTK2/src/pinot.cc:191 UI/GTK2/src/pinot-dbus-daemon.cc:260
 msgid "Spanish"
 msgstr "Espa?ol"
 
-#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:714
+#: UI/GTK2/src/pinot.cc:192 UI/GTK2/src/pinot-dbus-daemon.cc:261
 msgid "Swedish"
 msgstr "Sueco"
 
-#: UI/GTK2/src/pinot.cc:209
+#: UI/GTK2/src/pinot.cc:216
 msgid "Couldn't open index"
 msgstr "No se pudo abrir el ?ndice"
 
-#: UI/GTK2/src/pinot.cc:225
+#: UI/GTK2/src/pinot.cc:232
 msgid "Couldn't create history database"
 msgstr "No se pudo crear la base de datos del hist?rico"
 
-#: UI/GTK2/src/PinotSettings.cpp:241
+#: UI/GTK2/src/PinotSettings.cpp:246
 msgid "Important"
 msgstr "Importante"
 
-#: UI/GTK2/src/PinotSettings.cpp:242
+#: UI/GTK2/src/PinotSettings.cpp:247
 msgid "New"
 msgstr "Nuevo"
 
-#: UI/GTK2/src/PinotSettings.cpp:243
+#: UI/GTK2/src/PinotSettings.cpp:248
 msgid "Personal"
 msgstr "Personal"
 
-#: UI/GTK2/src/PinotSettings.cpp:1049
+#: UI/GTK2/src/PinotSettings.cpp:1055
 msgid "Unclassified"
 msgstr "No clasificado"
 
@@ -507,15 +507,15 @@
 msgid "Pattern"
 msgstr "Patron"
 
-#: UI/GTK2/src/prefsDialog.cc:418
+#: UI/GTK2/src/prefsDialog.cc:426
 msgid "New Label"
 msgstr "Nueva etiqueta"
 
-#: UI/GTK2/src/prefsDialog.cc:459
+#: UI/GTK2/src/prefsDialog.cc:467
 msgid "Directory to index"
 msgstr "Carpeta a indexar"
 
-#: UI/GTK2/src/prefsDialog.cc:517
+#: UI/GTK2/src/prefsDialog.cc:525
 msgid "Mbox File Location"
 msgstr "Localizaci?n del fichero mbox"
 
@@ -652,81 +652,69 @@
 msgid "Extract"
 msgstr "Extra?dos"
 
-#: UI/GTK2/src/WorkerThreads.cpp:325
+#: UI/GTK2/src/WorkerThreads.cpp:321
 msgid "Can't index mail here"
 msgstr "No se pudo indizar el buzon de correo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:346
+#: UI/GTK2/src/WorkerThreads.cpp:342
 msgid "is already being indexed"
 msgstr "ya est? indizado"
 
-#: UI/GTK2/src/WorkerThreads.cpp:356
+#: UI/GTK2/src/WorkerThreads.cpp:352
 msgid "is blacklisted"
 msgstr "ya excluido"
 
-#: UI/GTK2/src/WorkerThreads.cpp:364 UI/GTK2/src/WorkerThreads.cpp:688
-#: UI/GTK2/src/WorkerThreads.cpp:965 UI/GTK2/src/WorkerThreads.cpp:974
-#: UI/GTK2/src/WorkerThreads.cpp:1143 UI/GTK2/src/WorkerThreads.cpp:1399
-#: UI/GTK2/src/WorkerThreads.cpp:1532
+#: UI/GTK2/src/WorkerThreads.cpp:360 UI/GTK2/src/WorkerThreads.cpp:684
+#: UI/GTK2/src/WorkerThreads.cpp:961 UI/GTK2/src/WorkerThreads.cpp:970
+#: UI/GTK2/src/WorkerThreads.cpp:1139 UI/GTK2/src/WorkerThreads.cpp:1398
+#: UI/GTK2/src/WorkerThreads.cpp:1531
 msgid "Index error on"
 msgstr "Error en el ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:809 UI/GTK2/src/WorkerThreads.cpp:909
+#: UI/GTK2/src/WorkerThreads.cpp:805 UI/GTK2/src/WorkerThreads.cpp:905
 msgid "Couldn't create search engine"
 msgstr "No se pudo crear el motor de b?squeda"
 
-#: UI/GTK2/src/WorkerThreads.cpp:821 UI/GTK2/src/WorkerThreads.cpp:923
+#: UI/GTK2/src/WorkerThreads.cpp:817 UI/GTK2/src/WorkerThreads.cpp:919
 msgid "Couldn't run query on search engine"
 msgstr "No se pudo ejecutar la b?squeda contra el motor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:837
+#: UI/GTK2/src/WorkerThreads.cpp:833
 msgid "No title"
 msgstr "Sin t?tulo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1053
+#: UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't obtain downloader for protocol"
 msgstr "No se pudo usar un recuperador para el protocolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1064
+#: UI/GTK2/src/WorkerThreads.cpp:1060
 msgid "Couldn't retrieve"
 msgstr "No se pudo descargar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1167 UI/GTK2/src/WorkerThreads.cpp:1234
+#: UI/GTK2/src/WorkerThreads.cpp:1161 UI/GTK2/src/WorkerThreads.cpp:1233
 msgid "Cannot index document type"
 msgstr "No se pudo indizar el tipo de documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1171 UI/GTK2/src/WorkerThreads.cpp:1238
+#: UI/GTK2/src/WorkerThreads.cpp:1165 UI/GTK2/src/WorkerThreads.cpp:1237
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1260
+#: UI/GTK2/src/WorkerThreads.cpp:1259
 msgid "Couldn't tokenize"
 msgstr "No se pudo extraer cadenas"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1280
+#: UI/GTK2/src/WorkerThreads.cpp:1279
 msgid "Robots META tag forbids indexing"
 msgstr "La etiqueta META Robots proh?be la indizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1329
+#: UI/GTK2/src/WorkerThreads.cpp:1328
 msgid "Couldn't index"
 msgstr "No se pudo indizar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1410
+#: UI/GTK2/src/WorkerThreads.cpp:1409
 msgid "Couldn't unindex document(s)"
 msgstr "No se pudo des-indizar lo(s) documento(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1544
+#: UI/GTK2/src/WorkerThreads.cpp:1543
 msgid "Couldn't update document"
 msgstr "No se pudo actualizar el documento"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1734
-msgid "No monitoring handler"
-msgstr "No hay monitorizaci?n"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1776
-msgid "Couldn't initialize file monitor"
-msgstr "No se puede inicializar el monitor de archivo"
-
-#: UI/GTK2/src/WorkerThreads.cpp:2080
-msgid "Couldn't open directory"
-msgstr "No se pudo abrir el directorio"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2006-12-20 13:01:19 UTC (rev 668)
+++ trunk/po/fr.po	2006-12-20 13:16:58 UTC (rev 669)
@@ -6,10 +6,10 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.64\n"
+"Project-Id-Version: pinot 0.65\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-12-04 22:28+0800\n"
-"PO-Revision-Date: 2006-11-29 15:09+0000\n"
+"POT-Creation-Date: 2006-11-29 15:09+0000\n"
+"PO-Revision-Date: 2006-12-20 21:10+0800\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: fr <fabricecolin at users.berlios.de>\n"
 "MIME-Version: 1.0\n"
@@ -25,18 +25,18 @@
 msgid "Current User"
 msgstr "Utilisateur"
 
-#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
-#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
-#: UI/GTK2/src/mainWindow.cc:1153 UI/GTK2/src/mainWindow.cc:1196
-#: UI/GTK2/src/mainWindow.cc:1216 UI/GTK2/src/mainWindow.cc:1247
-#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/PinotSettings.cpp:235
-#: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:322
+#: UI/GTK2/src/mainWindow.cc:325 UI/GTK2/src/mainWindow.cc:551
+#: UI/GTK2/src/mainWindow.cc:1205 UI/GTK2/src/mainWindow.cc:1248
+#: UI/GTK2/src/mainWindow.cc:1268 UI/GTK2/src/mainWindow.cc:1299
+#: UI/GTK2/src/mainWindow.cc:1869 UI/GTK2/src/PinotSettings.cpp:240
+#: UI/GTK2/src/PinotSettings.cpp:1230 UI/GTK2/src/PinotSettings.cpp:1286
 msgid "My Web Pages"
 msgstr "Mes Pages Web"
 
-#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:310
-#: UI/GTK2/src/mainWindow.cc:313 UI/GTK2/src/PinotSettings.cpp:236
-#: UI/GTK2/src/PinotSettings.cpp:1225 UI/GTK2/src/PinotSettings.cpp:1281
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:316
+#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/PinotSettings.cpp:241
+#: UI/GTK2/src/PinotSettings.cpp:1231 UI/GTK2/src/PinotSettings.cpp:1287
 msgid "My Documents"
 msgstr "Mes Documents"
 
@@ -143,182 +143,182 @@
 msgid "Ready"
 msgstr "Pret"
 
-#: UI/GTK2/src/mainWindow.cc:234
+#: UI/GTK2/src/mainWindow.cc:240
 msgid "N/A"
 msgstr "Inconnue"
 
-#: UI/GTK2/src/mainWindow.cc:249
+#: UI/GTK2/src/mainWindow.cc:255
 msgid "<undefined>"
 msgstr "<inconnu>"
 
-#: UI/GTK2/src/mainWindow.cc:468
+#: UI/GTK2/src/mainWindow.cc:474
 msgid "Result location is"
 msgstr "Le chemin du resultat est"
 
-#: UI/GTK2/src/mainWindow.cc:555
+#: UI/GTK2/src/mainWindow.cc:561
 msgid "Document location is"
 msgstr "Le chemin du document is"
 
-#: UI/GTK2/src/mainWindow.cc:878
+#: UI/GTK2/src/mainWindow.cc:884
 msgid "Showing"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:883
+#: UI/GTK2/src/mainWindow.cc:889
 msgid "of"
 msgstr "documents,"
 
-#: UI/GTK2/src/mainWindow.cc:888
+#: UI/GTK2/src/mainWindow.cc:894
 msgid "documents, starting at"
 msgstr "au total, a partir de"
 
-#: UI/GTK2/src/mainWindow.cc:921
+#: UI/GTK2/src/mainWindow.cc:927
 msgid "Query"
 msgstr "La recherche"
 
-#: UI/GTK2/src/mainWindow.cc:925 UI/GTK2/src/mainWindow.cc:2876
+#: UI/GTK2/src/mainWindow.cc:931 UI/GTK2/src/mainWindow.cc:2937
 msgid "on"
 msgstr "sur"
 
-#: UI/GTK2/src/mainWindow.cc:929
+#: UI/GTK2/src/mainWindow.cc:935
 msgid "ended"
 msgstr "est terminee"
 
-#: UI/GTK2/src/mainWindow.cc:1018
+#: UI/GTK2/src/mainWindow.cc:1070
 msgid "More Like"
 msgstr "Similaire a"
 
-#: UI/GTK2/src/mainWindow.cc:1079
+#: UI/GTK2/src/mainWindow.cc:1131
 msgid "Updated label(s)"
 msgstr "Mis a jour l(es) etiquette(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1163
+#: UI/GTK2/src/mainWindow.cc:1215
 msgid "Updated document"
 msgstr "Mis a jour le document"
 
-#: UI/GTK2/src/mainWindow.cc:1176
+#: UI/GTK2/src/mainWindow.cc:1228
 msgid "Indexed"
 msgstr "Indexe"
 
-#: UI/GTK2/src/mainWindow.cc:1217
+#: UI/GTK2/src/mainWindow.cc:1269
 msgid "Unindexed document(s)"
 msgstr "Desindexe le(s) document(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1258
+#: UI/GTK2/src/mainWindow.cc:1310
 msgid "Updated document properties"
 msgstr "Mis a jour les proprietes du document"
 
-#: UI/GTK2/src/mainWindow.cc:1305
+#: UI/GTK2/src/mainWindow.cc:1357
 msgid "Couldn't rename index, name"
 msgstr "N'a pas pu renommer l'index, le nom"
 
-#: UI/GTK2/src/mainWindow.cc:1309 UI/GTK2/src/mainWindow.cc:2200
-#: UI/GTK2/src/mainWindow.cc:2711
+#: UI/GTK2/src/mainWindow.cc:1361 UI/GTK2/src/mainWindow.cc:2261
+#: UI/GTK2/src/mainWindow.cc:2772
 msgid "is already in use"
 msgstr "est deja utilise"
 
-#: UI/GTK2/src/mainWindow.cc:1322
+#: UI/GTK2/src/mainWindow.cc:1374
 msgid "Couldn't rename index"
 msgstr "N'a pas pu renommer l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1335
+#: UI/GTK2/src/mainWindow.cc:1387
 msgid "Edited index"
 msgstr "Edite l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1695 UI/GTK2/src/mainWindow.cc:2370
+#: UI/GTK2/src/mainWindow.cc:1747 UI/GTK2/src/mainWindow.cc:2431
 msgid "Live query"
 msgstr "Recherche"
 
-#: UI/GTK2/src/mainWindow.cc:1721
+#: UI/GTK2/src/mainWindow.cc:1773
 msgid "Couldn't find query"
 msgstr "N'a pas pu trouver"
 
-#: UI/GTK2/src/mainWindow.cc:1765 UI/GTK2/src/mainWindow.cc:1861
+#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/mainWindow.cc:1913
 msgid "Please set a location for the index first"
 msgstr "Donnez un chemin a l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1940 UI/GTK2/src/WorkerThreads.cpp:675
-#: UI/GTK2/src/WorkerThreads.cpp:1519
+#: UI/GTK2/src/mainWindow.cc:1992 UI/GTK2/src/WorkerThreads.cpp:671
+#: UI/GTK2/src/WorkerThreads.cpp:1518
 msgid "Index"
 msgstr "L'index"
 
-#: UI/GTK2/src/mainWindow.cc:1944 UI/GTK2/src/WorkerThreads.cpp:679
-#: UI/GTK2/src/WorkerThreads.cpp:1523
+#: UI/GTK2/src/mainWindow.cc:1996 UI/GTK2/src/WorkerThreads.cpp:675
+#: UI/GTK2/src/WorkerThreads.cpp:1522
 msgid "doesn't exist"
 msgstr "n'existe pas"
 
-#: UI/GTK2/src/mainWindow.cc:2088
+#: UI/GTK2/src/mainWindow.cc:2149
 msgid "Remove this document from the index ?"
 msgstr "Enlever ce document de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2107
+#: UI/GTK2/src/mainWindow.cc:2168
 msgid "Remove these documents from the index ?"
 msgstr "Enlever ces documents de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2151
+#: UI/GTK2/src/mainWindow.cc:2212
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Un outil de recherche pour le Bureau Libre"
 
-#: UI/GTK2/src/mainWindow.cc:2152
+#: UI/GTK2/src/mainWindow.cc:2213
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2257
 msgid "Index name"
 msgstr "Nom de l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2211
+#: UI/GTK2/src/mainWindow.cc:2272
 msgid "Couldn't add index"
 msgstr "N'a pas pu ajouter l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2225
+#: UI/GTK2/src/mainWindow.cc:2286
 msgid "Added new index"
 msgstr "Ajoute un nouvel index"
 
-#: UI/GTK2/src/mainWindow.cc:2260
+#: UI/GTK2/src/mainWindow.cc:2321
 msgid "Couldn't remove index"
 msgstr "N'a pas pu enlever l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2525
+#: UI/GTK2/src/mainWindow.cc:2586
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Au moins une tache n'est pas terminee. Quitter maintenant ?"
 
-#: UI/GTK2/src/mainWindow.cc:2707
+#: UI/GTK2/src/mainWindow.cc:2768
 msgid "Query name"
 msgstr "Nom de la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2734
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Couldn't update query"
 msgstr "N'a pas pu mettre a jour la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2742
+#: UI/GTK2/src/mainWindow.cc:2803
 msgid "Edited query"
 msgstr "Edite la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2749
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Couldn't add query"
 msgstr "N'a pas pu ajouter la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2757
+#: UI/GTK2/src/mainWindow.cc:2818
 msgid "Added new query"
 msgstr "Ajoute une nouvelle recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2770
+#: UI/GTK2/src/mainWindow.cc:2831
 msgid "Query is not set"
 msgstr "Recherche indefinie"
 
-#: UI/GTK2/src/mainWindow.cc:2781
+#: UI/GTK2/src/mainWindow.cc:2842
 msgid "No search engine selected"
 msgstr "Pas de moteur selectionne"
 
-#: UI/GTK2/src/mainWindow.cc:2863
+#: UI/GTK2/src/mainWindow.cc:2924
 msgid "Please set the Google API key first"
 msgstr "Configurez la clef de l'API Google"
 
-#: UI/GTK2/src/mainWindow.cc:2872
+#: UI/GTK2/src/mainWindow.cc:2933
 msgid "Running query"
 msgstr "Recherche en cours"
 
-#: UI/GTK2/src/mainWindow.cc:3044
+#: UI/GTK2/src/mainWindow.cc:3105
 msgid "No default application defined for type"
 msgstr "Pas d'application definie pour le type"
 
@@ -415,79 +415,79 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:249
 msgid "Unknown"
 msgstr "Inconnu"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:250
 msgid "Danish"
 msgstr "Danois"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:251
 msgid "Dutch"
 msgstr "Hollandais"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:252
 msgid "English"
 msgstr "Anglais"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:253
 msgid "Finnish"
 msgstr "Finlandais"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:254
 msgid "French"
 msgstr "Francais"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+#: UI/GTK2/src/pinot.cc:186 UI/GTK2/src/pinot-dbus-daemon.cc:255
 msgid "German"
 msgstr "Allemand"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+#: UI/GTK2/src/pinot.cc:187 UI/GTK2/src/pinot-dbus-daemon.cc:256
 msgid "Italian"
 msgstr "Italien"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+#: UI/GTK2/src/pinot.cc:188 UI/GTK2/src/pinot-dbus-daemon.cc:257
 msgid "Norwegian"
 msgstr "Norvegien"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+#: UI/GTK2/src/pinot.cc:189 UI/GTK2/src/pinot-dbus-daemon.cc:258
 msgid "Portuguese"
 msgstr "Portugais"
 
-#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:712
+#: UI/GTK2/src/pinot.cc:190 UI/GTK2/src/pinot-dbus-daemon.cc:259
 msgid "Russian"
 msgstr "Russe"
 
-#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:713
+#: UI/GTK2/src/pinot.cc:191 UI/GTK2/src/pinot-dbus-daemon.cc:260
 msgid "Spanish"
 msgstr "Espagnol"
 
-#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:714
+#: UI/GTK2/src/pinot.cc:192 UI/GTK2/src/pinot-dbus-daemon.cc:261
 msgid "Swedish"
 msgstr "Suedois"
 
-#: UI/GTK2/src/pinot.cc:209
+#: UI/GTK2/src/pinot.cc:216
 msgid "Couldn't open index"
 msgstr "N'a pas pu ouvrir l'index"
 
-#: UI/GTK2/src/pinot.cc:225
+#: UI/GTK2/src/pinot.cc:232
 msgid "Couldn't create history database"
 msgstr "N'a pas pu creer la base d'historiques"
 
-#: UI/GTK2/src/PinotSettings.cpp:241
+#: UI/GTK2/src/PinotSettings.cpp:246
 msgid "Important"
 msgstr "Important"
 
-#: UI/GTK2/src/PinotSettings.cpp:242
+#: UI/GTK2/src/PinotSettings.cpp:247
 msgid "New"
 msgstr "Nouveau"
 
-#: UI/GTK2/src/PinotSettings.cpp:243
+#: UI/GTK2/src/PinotSettings.cpp:248
 msgid "Personal"
 msgstr "Personnel"
 
-#: UI/GTK2/src/PinotSettings.cpp:1049
+#: UI/GTK2/src/PinotSettings.cpp:1055
 msgid "Unclassified"
 msgstr "Sans classification"
 
@@ -507,15 +507,15 @@
 msgid "Pattern"
 msgstr "Motif"
 
-#: UI/GTK2/src/prefsDialog.cc:418
+#: UI/GTK2/src/prefsDialog.cc:426
 msgid "New Label"
 msgstr "Nouvelle Etiquette"
 
-#: UI/GTK2/src/prefsDialog.cc:459
+#: UI/GTK2/src/prefsDialog.cc:467
 msgid "Directory to index"
 msgstr "Repertoire a indexer"
 
-#: UI/GTK2/src/prefsDialog.cc:517
+#: UI/GTK2/src/prefsDialog.cc:525
 msgid "Mbox File Location"
 msgstr "Chemin du Fichier mbox"
 
@@ -652,81 +652,69 @@
 msgid "Extract"
 msgstr "Extrait"
 
-#: UI/GTK2/src/WorkerThreads.cpp:325
+#: UI/GTK2/src/WorkerThreads.cpp:321
 msgid "Can't index mail here"
 msgstr "Ne peut pas indexer le courrier ici"
 
-#: UI/GTK2/src/WorkerThreads.cpp:346
+#: UI/GTK2/src/WorkerThreads.cpp:342
 msgid "is already being indexed"
 msgstr "est deja indexe"
 
-#: UI/GTK2/src/WorkerThreads.cpp:356
+#: UI/GTK2/src/WorkerThreads.cpp:352
 msgid "is blacklisted"
 msgstr "est exclus"
 
-#: UI/GTK2/src/WorkerThreads.cpp:364 UI/GTK2/src/WorkerThreads.cpp:688
-#: UI/GTK2/src/WorkerThreads.cpp:965 UI/GTK2/src/WorkerThreads.cpp:974
-#: UI/GTK2/src/WorkerThreads.cpp:1143 UI/GTK2/src/WorkerThreads.cpp:1399
-#: UI/GTK2/src/WorkerThreads.cpp:1532
+#: UI/GTK2/src/WorkerThreads.cpp:360 UI/GTK2/src/WorkerThreads.cpp:684
+#: UI/GTK2/src/WorkerThreads.cpp:961 UI/GTK2/src/WorkerThreads.cpp:970
+#: UI/GTK2/src/WorkerThreads.cpp:1139 UI/GTK2/src/WorkerThreads.cpp:1398
+#: UI/GTK2/src/WorkerThreads.cpp:1531
 msgid "Index error on"
 msgstr "Erreur sur l'index"
 
-#: UI/GTK2/src/WorkerThreads.cpp:809 UI/GTK2/src/WorkerThreads.cpp:909
+#: UI/GTK2/src/WorkerThreads.cpp:805 UI/GTK2/src/WorkerThreads.cpp:905
 msgid "Couldn't create search engine"
 msgstr "N'a pas pu creer le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:821 UI/GTK2/src/WorkerThreads.cpp:923
+#: UI/GTK2/src/WorkerThreads.cpp:817 UI/GTK2/src/WorkerThreads.cpp:919
 msgid "Couldn't run query on search engine"
 msgstr "N'a pas pu lancer la recherche sur le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:837
+#: UI/GTK2/src/WorkerThreads.cpp:833
 msgid "No title"
 msgstr "Pas de titre"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1053
+#: UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't obtain downloader for protocol"
 msgstr "N'a pas pu obtenir un brouteur pour"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1064
+#: UI/GTK2/src/WorkerThreads.cpp:1060
 msgid "Couldn't retrieve"
 msgstr "N'a pas pu telecharger"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1167 UI/GTK2/src/WorkerThreads.cpp:1234
+#: UI/GTK2/src/WorkerThreads.cpp:1161 UI/GTK2/src/WorkerThreads.cpp:1233
 msgid "Cannot index document type"
 msgstr "Impossible d'indexer ce type de documents"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1171 UI/GTK2/src/WorkerThreads.cpp:1238
+#: UI/GTK2/src/WorkerThreads.cpp:1165 UI/GTK2/src/WorkerThreads.cpp:1237
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1260
+#: UI/GTK2/src/WorkerThreads.cpp:1259
 msgid "Couldn't tokenize"
 msgstr "N'a pas pu extraire les termes de"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1280
+#: UI/GTK2/src/WorkerThreads.cpp:1279
 msgid "Robots META tag forbids indexing"
 msgstr "Le META tag Robots interdit d'indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1329
+#: UI/GTK2/src/WorkerThreads.cpp:1328
 msgid "Couldn't index"
 msgstr "N'a pas pu indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1410
+#: UI/GTK2/src/WorkerThreads.cpp:1409
 msgid "Couldn't unindex document(s)"
 msgstr "N'a pas pu desindexer le(s) document(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1544
+#: UI/GTK2/src/WorkerThreads.cpp:1543
 msgid "Couldn't update document"
 msgstr "N'a pas pu mettre a jour le document"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1734
-msgid "No monitoring handler"
-msgstr "Pas de moniteur"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1776
-msgid "Couldn't initialize file monitor"
-msgstr "N'a pas pu initializer le moniteur de fichiers"
-
-#: UI/GTK2/src/WorkerThreads.cpp:2080
-msgid "Couldn't open directory"
-msgstr "N'a pas pu ouvrir le repertoire"

Modified: trunk/po/nl.po
===================================================================
--- trunk/po/nl.po	2006-12-20 13:01:19 UTC (rev 668)
+++ trunk/po/nl.po	2006-12-20 13:16:58 UTC (rev 669)
@@ -6,10 +6,10 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.64\n"
+"Project-Id-Version: pinot 0.65\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-12-04 22:28+0800\n"
-"PO-Revision-Date: 2006-12-03 15:13+0000\n"
+"POT-Creation-Date: 2006-12-03 15:13+0000\n"
+"PO-Revision-Date: 2006-12-20 21:10+0800\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: Dutch <nl at li.org>\n"
 "MIME-Version: 1.0\n"
@@ -25,18 +25,18 @@
 msgid "Current User"
 msgstr "Huidige gebruiker"
 
-#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
-#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
-#: UI/GTK2/src/mainWindow.cc:1153 UI/GTK2/src/mainWindow.cc:1196
-#: UI/GTK2/src/mainWindow.cc:1216 UI/GTK2/src/mainWindow.cc:1247
-#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/PinotSettings.cpp:235
-#: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:322
+#: UI/GTK2/src/mainWindow.cc:325 UI/GTK2/src/mainWindow.cc:551
+#: UI/GTK2/src/mainWindow.cc:1205 UI/GTK2/src/mainWindow.cc:1248
+#: UI/GTK2/src/mainWindow.cc:1268 UI/GTK2/src/mainWindow.cc:1299
+#: UI/GTK2/src/mainWindow.cc:1869 UI/GTK2/src/PinotSettings.cpp:240
+#: UI/GTK2/src/PinotSettings.cpp:1230 UI/GTK2/src/PinotSettings.cpp:1286
 msgid "My Web Pages"
 msgstr "Mijn webpagina's"
 
-#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:310
-#: UI/GTK2/src/mainWindow.cc:313 UI/GTK2/src/PinotSettings.cpp:236
-#: UI/GTK2/src/PinotSettings.cpp:1225 UI/GTK2/src/PinotSettings.cpp:1281
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:316
+#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/PinotSettings.cpp:241
+#: UI/GTK2/src/PinotSettings.cpp:1231 UI/GTK2/src/PinotSettings.cpp:1287
 msgid "My Documents"
 msgstr "Mijn documenten"
 
@@ -144,183 +144,183 @@
 msgid "Ready"
 msgstr "Gereed"
 
-#: UI/GTK2/src/mainWindow.cc:234
+#: UI/GTK2/src/mainWindow.cc:240
 msgid "N/A"
 msgstr "NVT"
 
-#: UI/GTK2/src/mainWindow.cc:249
+#: UI/GTK2/src/mainWindow.cc:255
 msgid "<undefined>"
 msgstr "<niet gedefinieerd>"
 
-#: UI/GTK2/src/mainWindow.cc:468
+#: UI/GTK2/src/mainWindow.cc:474
 msgid "Result location is"
 msgstr "Uitvoerlocatie is"
 
-#: UI/GTK2/src/mainWindow.cc:555
+#: UI/GTK2/src/mainWindow.cc:561
 msgid "Document location is"
 msgstr "Documentlocatie is"
 
-#: UI/GTK2/src/mainWindow.cc:878
+#: UI/GTK2/src/mainWindow.cc:884
 msgid "Showing"
 msgstr "Aan het tonen"
 
-#: UI/GTK2/src/mainWindow.cc:883
+#: UI/GTK2/src/mainWindow.cc:889
 msgid "of"
 msgstr "van"
 
-#: UI/GTK2/src/mainWindow.cc:888
+#: UI/GTK2/src/mainWindow.cc:894
 msgid "documents, starting at"
 msgstr "documenten, beginnend bij"
 
-#: UI/GTK2/src/mainWindow.cc:921
+#: UI/GTK2/src/mainWindow.cc:927
 msgid "Query"
 msgstr "Query"
 
-#: UI/GTK2/src/mainWindow.cc:925 UI/GTK2/src/mainWindow.cc:2876
+#: UI/GTK2/src/mainWindow.cc:931 UI/GTK2/src/mainWindow.cc:2937
 msgid "on"
 msgstr "op"
 
-#: UI/GTK2/src/mainWindow.cc:929
+#: UI/GTK2/src/mainWindow.cc:935
 msgid "ended"
 msgstr "Beeindigd"
 
-#: UI/GTK2/src/mainWindow.cc:1018
+#: UI/GTK2/src/mainWindow.cc:1070
 msgid "More Like"
 msgstr "Meer zoals"
 
-#: UI/GTK2/src/mainWindow.cc:1079
+#: UI/GTK2/src/mainWindow.cc:1131
 msgid "Updated label(s)"
 msgstr "Vernieuwde na(a)m(en)"
 
-#: UI/GTK2/src/mainWindow.cc:1163
+#: UI/GTK2/src/mainWindow.cc:1215
 msgid "Updated document"
 msgstr "Vernieuwd document"
 
-#: UI/GTK2/src/mainWindow.cc:1176
+#: UI/GTK2/src/mainWindow.cc:1228
 msgid "Indexed"
 msgstr "Geindexeerd"
 
-#: UI/GTK2/src/mainWindow.cc:1217
+#: UI/GTK2/src/mainWindow.cc:1269
 msgid "Unindexed document(s)"
 msgstr "Niet geindexeerd(e) document(en)"
 
-#: UI/GTK2/src/mainWindow.cc:1258
+#: UI/GTK2/src/mainWindow.cc:1310
 msgid "Updated document properties"
 msgstr "Vernieuwde documenteigenschappen"
 
-#: UI/GTK2/src/mainWindow.cc:1305
+#: UI/GTK2/src/mainWindow.cc:1357
 msgid "Couldn't rename index, name"
 msgstr "Kon index niet hernoemen, naam"
 
-#: UI/GTK2/src/mainWindow.cc:1309 UI/GTK2/src/mainWindow.cc:2200
-#: UI/GTK2/src/mainWindow.cc:2711
+#: UI/GTK2/src/mainWindow.cc:1361 UI/GTK2/src/mainWindow.cc:2261
+#: UI/GTK2/src/mainWindow.cc:2772
 msgid "is already in use"
 msgstr "is reeds in gebruik"
 
-#: UI/GTK2/src/mainWindow.cc:1322
+#: UI/GTK2/src/mainWindow.cc:1374
 msgid "Couldn't rename index"
 msgstr "Kon index niet hernoemen"
 
-#: UI/GTK2/src/mainWindow.cc:1335
+#: UI/GTK2/src/mainWindow.cc:1387
 msgid "Edited index"
 msgstr "Bewerkte index"
 
-#: UI/GTK2/src/mainWindow.cc:1695 UI/GTK2/src/mainWindow.cc:2370
+#: UI/GTK2/src/mainWindow.cc:1747 UI/GTK2/src/mainWindow.cc:2431
 msgid "Live query"
 msgstr "Rechtstreekse query"
 
-#: UI/GTK2/src/mainWindow.cc:1721
+#: UI/GTK2/src/mainWindow.cc:1773
 msgid "Couldn't find query"
 msgstr "Kon query niet vinden"
 
-#: UI/GTK2/src/mainWindow.cc:1765 UI/GTK2/src/mainWindow.cc:1861
+#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/mainWindow.cc:1913
 msgid "Please set a location for the index first"
 msgstr "Geef aub eerst een bestemming voor de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:1940 UI/GTK2/src/WorkerThreads.cpp:675
-#: UI/GTK2/src/WorkerThreads.cpp:1519
+#: UI/GTK2/src/mainWindow.cc:1992 UI/GTK2/src/WorkerThreads.cpp:671
+#: UI/GTK2/src/WorkerThreads.cpp:1518
 msgid "Index"
 msgstr "Inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:1944 UI/GTK2/src/WorkerThreads.cpp:679
-#: UI/GTK2/src/WorkerThreads.cpp:1523
+#: UI/GTK2/src/mainWindow.cc:1996 UI/GTK2/src/WorkerThreads.cpp:675
+#: UI/GTK2/src/WorkerThreads.cpp:1522
 msgid "doesn't exist"
 msgstr "bestaat niet"
 
-#: UI/GTK2/src/mainWindow.cc:2088
+#: UI/GTK2/src/mainWindow.cc:2149
 msgid "Remove this document from the index ?"
 msgstr "Verwijder dit document uit de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2107
+#: UI/GTK2/src/mainWindow.cc:2168
 msgid "Remove these documents from the index ?"
 msgstr "Verwijder deze documenten uit de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2151
+#: UI/GTK2/src/mainWindow.cc:2212
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Een metazoek tool voor de Free Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2152
+#: UI/GTK2/src/mainWindow.cc:2213
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2257
 msgid "Index name"
 msgstr "Naam inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2211
+#: UI/GTK2/src/mainWindow.cc:2272
 msgid "Couldn't add index"
 msgstr "Kon inhoudsopgave niet toevoegen"
 
-#: UI/GTK2/src/mainWindow.cc:2225
+#: UI/GTK2/src/mainWindow.cc:2286
 msgid "Added new index"
 msgstr "Nieuwe inhoudsopgave toegevoegd"
 
-#: UI/GTK2/src/mainWindow.cc:2260
+#: UI/GTK2/src/mainWindow.cc:2321
 msgid "Couldn't remove index"
 msgstr "Kon inhoudsopgave niet verwijderen"
 
-#: UI/GTK2/src/mainWindow.cc:2525
+#: UI/GTK2/src/mainWindow.cc:2586
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Tenminste een taak is nog niet gereed. Nu stoppen?"
 
-#: UI/GTK2/src/mainWindow.cc:2707
+#: UI/GTK2/src/mainWindow.cc:2768
 msgid "Query name"
 msgstr "Naam query"
 
-#: UI/GTK2/src/mainWindow.cc:2734
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Couldn't update query"
 msgstr "Kon query niet actualiseren"
 
-#: UI/GTK2/src/mainWindow.cc:2742
+#: UI/GTK2/src/mainWindow.cc:2803
 msgid "Edited query"
 msgstr "Bewerkte query"
 
-#: UI/GTK2/src/mainWindow.cc:2749
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Couldn't add query"
 msgstr "Kon query niet toevoegen"
 
-#: UI/GTK2/src/mainWindow.cc:2757
+#: UI/GTK2/src/mainWindow.cc:2818
 msgid "Added new query"
 msgstr "Nieuwe query toegevoegd"
 
-#: UI/GTK2/src/mainWindow.cc:2770
+#: UI/GTK2/src/mainWindow.cc:2831
 #, fuzzy
 msgid "Query is not set"
 msgstr "Query niet vastgelegd"
 
-#: UI/GTK2/src/mainWindow.cc:2781
+#: UI/GTK2/src/mainWindow.cc:2842
 msgid "No search engine selected"
 msgstr "Geen zoekmachine geselecteerd"
 
-#: UI/GTK2/src/mainWindow.cc:2863
+#: UI/GTK2/src/mainWindow.cc:2924
 msgid "Please set the Google API key first"
 msgstr "Geef eerst de Google API sleutel in"
 
-#: UI/GTK2/src/mainWindow.cc:2872
+#: UI/GTK2/src/mainWindow.cc:2933
 msgid "Running query"
 msgstr "Lopende query"
 
-#: UI/GTK2/src/mainWindow.cc:3044
+#: UI/GTK2/src/mainWindow.cc:3105
 msgid "No default application defined for type"
 msgstr "Geen standaard toepassing gedefinieerd voor het type"
 
@@ -417,79 +417,79 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:249
 msgid "Unknown"
 msgstr "Niet bekend"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:250
 msgid "Danish"
 msgstr "Deens"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:251
 msgid "Dutch"
 msgstr "Nederlands"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:252
 msgid "English"
 msgstr "Engels"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:253
 msgid "Finnish"
 msgstr "Fins"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:254
 msgid "French"
 msgstr "Frans"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+#: UI/GTK2/src/pinot.cc:186 UI/GTK2/src/pinot-dbus-daemon.cc:255
 msgid "German"
 msgstr "Duits"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+#: UI/GTK2/src/pinot.cc:187 UI/GTK2/src/pinot-dbus-daemon.cc:256
 msgid "Italian"
 msgstr "Italiaans"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+#: UI/GTK2/src/pinot.cc:188 UI/GTK2/src/pinot-dbus-daemon.cc:257
 msgid "Norwegian"
 msgstr "Noors"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+#: UI/GTK2/src/pinot.cc:189 UI/GTK2/src/pinot-dbus-daemon.cc:258
 msgid "Portuguese"
 msgstr "Portugees"
 
-#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:712
+#: UI/GTK2/src/pinot.cc:190 UI/GTK2/src/pinot-dbus-daemon.cc:259
 msgid "Russian"
 msgstr "Russisch"
 
-#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:713
+#: UI/GTK2/src/pinot.cc:191 UI/GTK2/src/pinot-dbus-daemon.cc:260
 msgid "Spanish"
 msgstr "Spaans"
 
-#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:714
+#: UI/GTK2/src/pinot.cc:192 UI/GTK2/src/pinot-dbus-daemon.cc:261
 msgid "Swedish"
 msgstr "Zweeds"
 
-#: UI/GTK2/src/pinot.cc:209
+#: UI/GTK2/src/pinot.cc:216
 msgid "Couldn't open index"
 msgstr "Kan index niet openen"
 
-#: UI/GTK2/src/pinot.cc:225
+#: UI/GTK2/src/pinot.cc:232
 msgid "Couldn't create history database"
 msgstr "Kon historische database niet maken"
 
-#: UI/GTK2/src/PinotSettings.cpp:241
+#: UI/GTK2/src/PinotSettings.cpp:246
 msgid "Important"
 msgstr "Belangrijk"
 
-#: UI/GTK2/src/PinotSettings.cpp:242
+#: UI/GTK2/src/PinotSettings.cpp:247
 msgid "New"
 msgstr "Nieuw"
 
-#: UI/GTK2/src/PinotSettings.cpp:243
+#: UI/GTK2/src/PinotSettings.cpp:248
 msgid "Personal"
 msgstr "Persoonlijk"
 
-#: UI/GTK2/src/PinotSettings.cpp:1049
+#: UI/GTK2/src/PinotSettings.cpp:1055
 msgid "Unclassified"
 msgstr "Niet geklassificeerd"
 
@@ -510,15 +510,15 @@
 msgid "Pattern"
 msgstr "Patroon"
 
-#: UI/GTK2/src/prefsDialog.cc:418
+#: UI/GTK2/src/prefsDialog.cc:426
 msgid "New Label"
 msgstr "Nieuwe naam"
 
-#: UI/GTK2/src/prefsDialog.cc:459
+#: UI/GTK2/src/prefsDialog.cc:467
 msgid "Directory to index"
 msgstr "Directory naar inhoudsopgave"
 
-#: UI/GTK2/src/prefsDialog.cc:517
+#: UI/GTK2/src/prefsDialog.cc:525
 msgid "Mbox File Location"
 msgstr "Mbox bestandslocatie"
 
@@ -658,82 +658,70 @@
 msgid "Extract"
 msgstr "Uitpakken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:325
+#: UI/GTK2/src/WorkerThreads.cpp:321
 msgid "Can't index mail here"
 msgstr "Kan mail hier niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:346
+#: UI/GTK2/src/WorkerThreads.cpp:342
 msgid "is already being indexed"
 msgstr "wordt al geindexeerd"
 
-#: UI/GTK2/src/WorkerThreads.cpp:356
+#: UI/GTK2/src/WorkerThreads.cpp:352
 msgid "is blacklisted"
 msgstr "staat op blacklist"
 
-#: UI/GTK2/src/WorkerThreads.cpp:364 UI/GTK2/src/WorkerThreads.cpp:688
-#: UI/GTK2/src/WorkerThreads.cpp:965 UI/GTK2/src/WorkerThreads.cpp:974
-#: UI/GTK2/src/WorkerThreads.cpp:1143 UI/GTK2/src/WorkerThreads.cpp:1399
-#: UI/GTK2/src/WorkerThreads.cpp:1532
+#: UI/GTK2/src/WorkerThreads.cpp:360 UI/GTK2/src/WorkerThreads.cpp:684
+#: UI/GTK2/src/WorkerThreads.cpp:961 UI/GTK2/src/WorkerThreads.cpp:970
+#: UI/GTK2/src/WorkerThreads.cpp:1139 UI/GTK2/src/WorkerThreads.cpp:1398
+#: UI/GTK2/src/WorkerThreads.cpp:1531
 msgid "Index error on"
 msgstr "Indexeringsfout op"
 
-#: UI/GTK2/src/WorkerThreads.cpp:809 UI/GTK2/src/WorkerThreads.cpp:909
+#: UI/GTK2/src/WorkerThreads.cpp:805 UI/GTK2/src/WorkerThreads.cpp:905
 msgid "Couldn't create search engine"
 msgstr "Kon zoekmachine niet maken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:821 UI/GTK2/src/WorkerThreads.cpp:923
+#: UI/GTK2/src/WorkerThreads.cpp:817 UI/GTK2/src/WorkerThreads.cpp:919
 msgid "Couldn't run query on search engine"
 msgstr "Kon query niet uitvoeren op zoekmachine"
 
-#: UI/GTK2/src/WorkerThreads.cpp:837
+#: UI/GTK2/src/WorkerThreads.cpp:833
 msgid "No title"
 msgstr "Geen titel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1053
+#: UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't obtain downloader for protocol"
 msgstr "Kon geen downloader verkrijgen voor protocol"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1064
+#: UI/GTK2/src/WorkerThreads.cpp:1060
 msgid "Couldn't retrieve"
 msgstr "Kon niet opzoeken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1167 UI/GTK2/src/WorkerThreads.cpp:1234
+#: UI/GTK2/src/WorkerThreads.cpp:1161 UI/GTK2/src/WorkerThreads.cpp:1233
 msgid "Cannot index document type"
 msgstr "Kan documenttype niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1171 UI/GTK2/src/WorkerThreads.cpp:1238
+#: UI/GTK2/src/WorkerThreads.cpp:1165 UI/GTK2/src/WorkerThreads.cpp:1237
 msgid "at"
 msgstr "bij"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1260
+#: UI/GTK2/src/WorkerThreads.cpp:1259
 #, fuzzy
 msgid "Couldn't tokenize"
 msgstr "Kon tokens niet toepassen"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1280
+#: UI/GTK2/src/WorkerThreads.cpp:1279
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META taf verbiedt indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1329
+#: UI/GTK2/src/WorkerThreads.cpp:1328
 msgid "Couldn't index"
 msgstr "Kon niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1410
+#: UI/GTK2/src/WorkerThreads.cpp:1409
 msgid "Couldn't unindex document(s)"
 msgstr "Kan indexering van bestand(en) niet ongedaan maken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1544
+#: UI/GTK2/src/WorkerThreads.cpp:1543
 msgid "Couldn't update document"
 msgstr "Kan document niet actualiseren"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1734
-msgid "No monitoring handler"
-msgstr "Geen monitoring handler"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1776
-msgid "Couldn't initialize file monitor"
-msgstr "Kan bestandsmonitor niet initialiseren"
-
-#: UI/GTK2/src/WorkerThreads.cpp:2080
-msgid "Couldn't open directory"
-msgstr "Kan map niet openen"

Modified: trunk/po/sv.po
===================================================================
--- trunk/po/sv.po	2006-12-20 13:01:19 UTC (rev 668)
+++ trunk/po/sv.po	2006-12-20 13:16:58 UTC (rev 669)
@@ -6,10 +6,10 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot\n"
+"Project-Id-Version: pinot 0.65\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-12-04 22:28+0800\n"
-"PO-Revision-Date: 2006-12-03 16:44+0000\n"
+"POT-Creation-Date: 2006-12-03 16:44+0000\n"
+"PO-Revision-Date: 2006-12-20 21:10+0800\n"
 "Last-Translator: Daniel Nylander <po at danielnylander.se>\n"
 "Language-Team: Swedish <sv at li.org>\n"
 "MIME-Version: 1.0\n"
@@ -25,18 +25,18 @@
 msgid "Current User"
 msgstr "Aktuell anv?ndare"
 
-#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:316
-#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/mainWindow.cc:545
-#: UI/GTK2/src/mainWindow.cc:1153 UI/GTK2/src/mainWindow.cc:1196
-#: UI/GTK2/src/mainWindow.cc:1216 UI/GTK2/src/mainWindow.cc:1247
-#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/PinotSettings.cpp:235
-#: UI/GTK2/src/PinotSettings.cpp:1224 UI/GTK2/src/PinotSettings.cpp:1280
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:322
+#: UI/GTK2/src/mainWindow.cc:325 UI/GTK2/src/mainWindow.cc:551
+#: UI/GTK2/src/mainWindow.cc:1205 UI/GTK2/src/mainWindow.cc:1248
+#: UI/GTK2/src/mainWindow.cc:1268 UI/GTK2/src/mainWindow.cc:1299
+#: UI/GTK2/src/mainWindow.cc:1869 UI/GTK2/src/PinotSettings.cpp:240
+#: UI/GTK2/src/PinotSettings.cpp:1230 UI/GTK2/src/PinotSettings.cpp:1286
 msgid "My Web Pages"
 msgstr "Mina webbsidor"
 
-#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:310
-#: UI/GTK2/src/mainWindow.cc:313 UI/GTK2/src/PinotSettings.cpp:236
-#: UI/GTK2/src/PinotSettings.cpp:1225 UI/GTK2/src/PinotSettings.cpp:1281
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:316
+#: UI/GTK2/src/mainWindow.cc:319 UI/GTK2/src/PinotSettings.cpp:241
+#: UI/GTK2/src/PinotSettings.cpp:1231 UI/GTK2/src/PinotSettings.cpp:1287
 msgid "My Documents"
 msgstr "Mina dokument"
 
@@ -143,182 +143,182 @@
 msgid "Ready"
 msgstr "Redo"
 
-#: UI/GTK2/src/mainWindow.cc:234
+#: UI/GTK2/src/mainWindow.cc:240
 msgid "N/A"
 msgstr "-"
 
-#: UI/GTK2/src/mainWindow.cc:249
+#: UI/GTK2/src/mainWindow.cc:255
 msgid "<undefined>"
 msgstr "<odefinierad>"
 
-#: UI/GTK2/src/mainWindow.cc:468
+#: UI/GTK2/src/mainWindow.cc:474
 msgid "Result location is"
 msgstr "Resultatplatsen ?r"
 
-#: UI/GTK2/src/mainWindow.cc:555
+#: UI/GTK2/src/mainWindow.cc:561
 msgid "Document location is"
 msgstr "Dokumentplatsen ?r"
 
-#: UI/GTK2/src/mainWindow.cc:878
+#: UI/GTK2/src/mainWindow.cc:884
 msgid "Showing"
 msgstr "Visar"
 
-#: UI/GTK2/src/mainWindow.cc:883
+#: UI/GTK2/src/mainWindow.cc:889
 msgid "of"
 msgstr "av"
 
-#: UI/GTK2/src/mainWindow.cc:888
+#: UI/GTK2/src/mainWindow.cc:894
 msgid "documents, starting at"
 msgstr "dokument, b?rjar med"
 
-#: UI/GTK2/src/mainWindow.cc:921
+#: UI/GTK2/src/mainWindow.cc:927
 msgid "Query"
 msgstr "Fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:925 UI/GTK2/src/mainWindow.cc:2876
+#: UI/GTK2/src/mainWindow.cc:931 UI/GTK2/src/mainWindow.cc:2937
 msgid "on"
 msgstr "p?"
 
-#: UI/GTK2/src/mainWindow.cc:929
+#: UI/GTK2/src/mainWindow.cc:935
 msgid "ended"
 msgstr "slutade"
 
-#: UI/GTK2/src/mainWindow.cc:1018
+#: UI/GTK2/src/mainWindow.cc:1070
 msgid "More Like"
 msgstr "Kanske mer som"
 
-#: UI/GTK2/src/mainWindow.cc:1079
+#: UI/GTK2/src/mainWindow.cc:1131
 msgid "Updated label(s)"
 msgstr "Uppdaterade etikett(er)"
 
-#: UI/GTK2/src/mainWindow.cc:1163
+#: UI/GTK2/src/mainWindow.cc:1215
 msgid "Updated document"
 msgstr "Uppdaterade dokument"
 
-#: UI/GTK2/src/mainWindow.cc:1176
+#: UI/GTK2/src/mainWindow.cc:1228
 msgid "Indexed"
 msgstr "Indexerade"
 
-#: UI/GTK2/src/mainWindow.cc:1217
+#: UI/GTK2/src/mainWindow.cc:1269
 msgid "Unindexed document(s)"
 msgstr "Ej indexerade dokument"
 
-#: UI/GTK2/src/mainWindow.cc:1258
+#: UI/GTK2/src/mainWindow.cc:1310
 msgid "Updated document properties"
 msgstr "Egenskaper f?r uppdaterade dokument"
 
-#: UI/GTK2/src/mainWindow.cc:1305
+#: UI/GTK2/src/mainWindow.cc:1357
 msgid "Couldn't rename index, name"
 msgstr "Kunde inte byta namn p? index, namn"
 
-#: UI/GTK2/src/mainWindow.cc:1309 UI/GTK2/src/mainWindow.cc:2200
-#: UI/GTK2/src/mainWindow.cc:2711
+#: UI/GTK2/src/mainWindow.cc:1361 UI/GTK2/src/mainWindow.cc:2261
+#: UI/GTK2/src/mainWindow.cc:2772
 msgid "is already in use"
 msgstr "anv?nds redan"
 
-#: UI/GTK2/src/mainWindow.cc:1322
+#: UI/GTK2/src/mainWindow.cc:1374
 msgid "Couldn't rename index"
 msgstr "Kunde inte byta namn p? index"
 
-#: UI/GTK2/src/mainWindow.cc:1335
+#: UI/GTK2/src/mainWindow.cc:1387
 msgid "Edited index"
 msgstr "Redigerade index"
 
-#: UI/GTK2/src/mainWindow.cc:1695 UI/GTK2/src/mainWindow.cc:2370
+#: UI/GTK2/src/mainWindow.cc:1747 UI/GTK2/src/mainWindow.cc:2431
 msgid "Live query"
 msgstr "Levande fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:1721
+#: UI/GTK2/src/mainWindow.cc:1773
 msgid "Couldn't find query"
 msgstr "Kunde inte hitta fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:1765 UI/GTK2/src/mainWindow.cc:1861
+#: UI/GTK2/src/mainWindow.cc:1817 UI/GTK2/src/mainWindow.cc:1913
 msgid "Please set a location for the index first"
 msgstr "St?ll in en plats f?r indexet f?rst"
 
-#: UI/GTK2/src/mainWindow.cc:1940 UI/GTK2/src/WorkerThreads.cpp:675
-#: UI/GTK2/src/WorkerThreads.cpp:1519
+#: UI/GTK2/src/mainWindow.cc:1992 UI/GTK2/src/WorkerThreads.cpp:671
+#: UI/GTK2/src/WorkerThreads.cpp:1518
 msgid "Index"
 msgstr "Index"
 
-#: UI/GTK2/src/mainWindow.cc:1944 UI/GTK2/src/WorkerThreads.cpp:679
-#: UI/GTK2/src/WorkerThreads.cpp:1523
+#: UI/GTK2/src/mainWindow.cc:1996 UI/GTK2/src/WorkerThreads.cpp:675
+#: UI/GTK2/src/WorkerThreads.cpp:1522
 msgid "doesn't exist"
 msgstr "finns inte"
 
-#: UI/GTK2/src/mainWindow.cc:2088
+#: UI/GTK2/src/mainWindow.cc:2149
 msgid "Remove this document from the index ?"
 msgstr "Ta bort detta dokument fr?n indexet?"
 
-#: UI/GTK2/src/mainWindow.cc:2107
+#: UI/GTK2/src/mainWindow.cc:2168
 msgid "Remove these documents from the index ?"
 msgstr "Ta bort dessa dokument fr?n indexet?"
 
-#: UI/GTK2/src/mainWindow.cc:2151
+#: UI/GTK2/src/mainWindow.cc:2212
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Ett metas?kningsverktyg f?r Free Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2152
+#: UI/GTK2/src/mainWindow.cc:2213
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "? 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2257
 msgid "Index name"
 msgstr "Indexnamn"
 
-#: UI/GTK2/src/mainWindow.cc:2211
+#: UI/GTK2/src/mainWindow.cc:2272
 msgid "Couldn't add index"
 msgstr "Kunde inte l?gga till index"
 
-#: UI/GTK2/src/mainWindow.cc:2225
+#: UI/GTK2/src/mainWindow.cc:2286
 msgid "Added new index"
 msgstr "Lade till nytt index"
 
-#: UI/GTK2/src/mainWindow.cc:2260
+#: UI/GTK2/src/mainWindow.cc:2321
 msgid "Couldn't remove index"
 msgstr "Kunde inte ta bort index"
 
-#: UI/GTK2/src/mainWindow.cc:2525
+#: UI/GTK2/src/mainWindow.cc:2586
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "?tminstone en uppgift har inte f?rdigst?llts ?n. Avsluta nu?"
 
-#: UI/GTK2/src/mainWindow.cc:2707
+#: UI/GTK2/src/mainWindow.cc:2768
 msgid "Query name"
 msgstr "Fr?genamn"
 
-#: UI/GTK2/src/mainWindow.cc:2734
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Couldn't update query"
 msgstr "Kunde inte uppdatera fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2742
+#: UI/GTK2/src/mainWindow.cc:2803
 msgid "Edited query"
 msgstr "Redigerade fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2749
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Couldn't add query"
 msgstr "Kunde inte l?gga till fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2757
+#: UI/GTK2/src/mainWindow.cc:2818
 msgid "Added new query"
 msgstr "Lade till ny fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2770
+#: UI/GTK2/src/mainWindow.cc:2831
 msgid "Query is not set"
 msgstr "Fr?gan ?r inte inst?lld"
 
-#: UI/GTK2/src/mainWindow.cc:2781
+#: UI/GTK2/src/mainWindow.cc:2842
 msgid "No search engine selected"
 msgstr "Ingen s?kmotor vald"
 
-#: UI/GTK2/src/mainWindow.cc:2863
+#: UI/GTK2/src/mainWindow.cc:2924
 msgid "Please set the Google API key first"
 msgstr "St?ll in Google API-nyckeln f?rst"
 
-#: UI/GTK2/src/mainWindow.cc:2872
+#: UI/GTK2/src/mainWindow.cc:2933
 msgid "Running query"
 msgstr "K?r fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:3044
+#: UI/GTK2/src/mainWindow.cc:3105
 msgid "No default application defined for type"
 msgstr "Inget standardprogram definierat f?r typen"
 
@@ -415,79 +415,79 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:173 UI/GTK2/src/pinot-dbus-daemon.cc:702
+#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:249
 msgid "Unknown"
 msgstr "Ok?nd"
 
-#: UI/GTK2/src/pinot.cc:174 UI/GTK2/src/pinot-dbus-daemon.cc:703
+#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:250
 msgid "Danish"
 msgstr "Danska"
 
-#: UI/GTK2/src/pinot.cc:175 UI/GTK2/src/pinot-dbus-daemon.cc:704
+#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:251
 msgid "Dutch"
 msgstr "Nederl?ndska"
 
-#: UI/GTK2/src/pinot.cc:176 UI/GTK2/src/pinot-dbus-daemon.cc:705
+#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:252
 msgid "English"
 msgstr "Engelska"
 
-#: UI/GTK2/src/pinot.cc:177 UI/GTK2/src/pinot-dbus-daemon.cc:706
+#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:253
 msgid "Finnish"
 msgstr "Finska"
 
-#: UI/GTK2/src/pinot.cc:178 UI/GTK2/src/pinot-dbus-daemon.cc:707
+#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:254
 msgid "French"
 msgstr "Franska"
 
-#: UI/GTK2/src/pinot.cc:179 UI/GTK2/src/pinot-dbus-daemon.cc:708
+#: UI/GTK2/src/pinot.cc:186 UI/GTK2/src/pinot-dbus-daemon.cc:255
 msgid "German"
 msgstr "Tyska"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:709
+#: UI/GTK2/src/pinot.cc:187 UI/GTK2/src/pinot-dbus-daemon.cc:256
 msgid "Italian"
 msgstr "Italienska"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:710
+#: UI/GTK2/src/pinot.cc:188 UI/GTK2/src/pinot-dbus-daemon.cc:257
 msgid "Norwegian"
 msgstr "Norska"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:711
+#: UI/GTK2/src/pinot.cc:189 UI/GTK2/src/pinot-dbus-daemon.cc:258
 msgid "Portuguese"
 msgstr "Portugisiska"
 
-#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:712
+#: UI/GTK2/src/pinot.cc:190 UI/GTK2/src/pinot-dbus-daemon.cc:259
 msgid "Russian"
 msgstr "Ryska"
 
-#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:713
+#: UI/GTK2/src/pinot.cc:191 UI/GTK2/src/pinot-dbus-daemon.cc:260
 msgid "Spanish"
 msgstr "Spanska"
 
-#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:714
+#: UI/GTK2/src/pinot.cc:192 UI/GTK2/src/pinot-dbus-daemon.cc:261
 msgid "Swedish"
 msgstr "Svenska"
 
-#: UI/GTK2/src/pinot.cc:209
+#: UI/GTK2/src/pinot.cc:216
 msgid "Couldn't open index"
 msgstr "Kunde inte ?ppna index"
 
-#: UI/GTK2/src/pinot.cc:225
+#: UI/GTK2/src/pinot.cc:232
 msgid "Couldn't create history database"
 msgstr "Kunde inte skapa historikdatabas"
 
-#: UI/GTK2/src/PinotSettings.cpp:241
+#: UI/GTK2/src/PinotSettings.cpp:246
 msgid "Important"
 msgstr "Viktigt"
 
-#: UI/GTK2/src/PinotSettings.cpp:242
+#: UI/GTK2/src/PinotSettings.cpp:247
 msgid "New"
 msgstr "Ny"
 
-#: UI/GTK2/src/PinotSettings.cpp:243
+#: UI/GTK2/src/PinotSettings.cpp:248
 msgid "Personal"
 msgstr "Personlig"
 
-#: UI/GTK2/src/PinotSettings.cpp:1049
+#: UI/GTK2/src/PinotSettings.cpp:1055
 msgid "Unclassified"
 msgstr "Oklassificerad"
 
@@ -507,15 +507,15 @@
 msgid "Pattern"
 msgstr "M?nster"
 
-#: UI/GTK2/src/prefsDialog.cc:418
+#: UI/GTK2/src/prefsDialog.cc:426
 msgid "New Label"
 msgstr "Ny etikett"
 
-#: UI/GTK2/src/prefsDialog.cc:459
+#: UI/GTK2/src/prefsDialog.cc:467
 msgid "Directory to index"
 msgstr "Katalog f?r index"
 
-#: UI/GTK2/src/prefsDialog.cc:517
+#: UI/GTK2/src/prefsDialog.cc:525
 msgid "Mbox File Location"
 msgstr "Plats f?r mbox-fil"
 
@@ -654,81 +654,69 @@
 msgid "Extract"
 msgstr "Utdrag"
 
-#: UI/GTK2/src/WorkerThreads.cpp:325
+#: UI/GTK2/src/WorkerThreads.cpp:321
 msgid "Can't index mail here"
 msgstr "Kan inte indexera post h?r"
 
-#: UI/GTK2/src/WorkerThreads.cpp:346
+#: UI/GTK2/src/WorkerThreads.cpp:342
 msgid "is already being indexed"
 msgstr "h?ller redan p? att bli indexerad"
 
-#: UI/GTK2/src/WorkerThreads.cpp:356
+#: UI/GTK2/src/WorkerThreads.cpp:352
 msgid "is blacklisted"
 msgstr "?r svartlistad"
 
-#: UI/GTK2/src/WorkerThreads.cpp:364 UI/GTK2/src/WorkerThreads.cpp:688
-#: UI/GTK2/src/WorkerThreads.cpp:965 UI/GTK2/src/WorkerThreads.cpp:974
-#: UI/GTK2/src/WorkerThreads.cpp:1143 UI/GTK2/src/WorkerThreads.cpp:1399
-#: UI/GTK2/src/WorkerThreads.cpp:1532
+#: UI/GTK2/src/WorkerThreads.cpp:360 UI/GTK2/src/WorkerThreads.cpp:684
+#: UI/GTK2/src/WorkerThreads.cpp:961 UI/GTK2/src/WorkerThreads.cpp:970
+#: UI/GTK2/src/WorkerThreads.cpp:1139 UI/GTK2/src/WorkerThreads.cpp:1398
+#: UI/GTK2/src/WorkerThreads.cpp:1531
 msgid "Index error on"
 msgstr "Indexfel p?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:809 UI/GTK2/src/WorkerThreads.cpp:909
+#: UI/GTK2/src/WorkerThreads.cpp:805 UI/GTK2/src/WorkerThreads.cpp:905
 msgid "Couldn't create search engine"
 msgstr "Kunde inte skapa s?kmotor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:821 UI/GTK2/src/WorkerThreads.cpp:923
+#: UI/GTK2/src/WorkerThreads.cpp:817 UI/GTK2/src/WorkerThreads.cpp:919
 msgid "Couldn't run query on search engine"
 msgstr "Kunde inte k?ra fr?ga p? s?kmotor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:837
+#: UI/GTK2/src/WorkerThreads.cpp:833
 msgid "No title"
 msgstr "Ingen titel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1053
+#: UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't obtain downloader for protocol"
 msgstr "Kunde inte f? protokollh?mtare"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1064
+#: UI/GTK2/src/WorkerThreads.cpp:1060
 msgid "Couldn't retrieve"
 msgstr "Kunde inte h?mta"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1167 UI/GTK2/src/WorkerThreads.cpp:1234
+#: UI/GTK2/src/WorkerThreads.cpp:1161 UI/GTK2/src/WorkerThreads.cpp:1233
 msgid "Cannot index document type"
 msgstr "Kan inte indexera dokumenttyp"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1171 UI/GTK2/src/WorkerThreads.cpp:1238
+#: UI/GTK2/src/WorkerThreads.cpp:1165 UI/GTK2/src/WorkerThreads.cpp:1237
 msgid "at"
 msgstr "p?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1260
+#: UI/GTK2/src/WorkerThreads.cpp:1259
 msgid "Couldn't tokenize"
 msgstr "Kunde inte g?ra token"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1280
+#: UI/GTK2/src/WorkerThreads.cpp:1279
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META-tagg f?rbjuder indexering"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1329
+#: UI/GTK2/src/WorkerThreads.cpp:1328
 msgid "Couldn't index"
 msgstr "Kunde inte indexera"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1410
+#: UI/GTK2/src/WorkerThreads.cpp:1409
 msgid "Couldn't unindex document(s)"
 msgstr "Kunde inte avindexera dokument"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1544
+#: UI/GTK2/src/WorkerThreads.cpp:1543
 msgid "Couldn't update document"
 msgstr "Kunde inte uppdatera dokument"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1734
-msgid "No monitoring handler"
-msgstr "Ingen ?vervakningshanterare"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1776
-msgid "Couldn't initialize file monitor"
-msgstr "Kunde inte initiera fil?vervakare"
-
-#: UI/GTK2/src/WorkerThreads.cpp:2080
-msgid "Couldn't open directory"
-msgstr "Kunde inte ?ppna katalog"



From fabricecolin at mail.berlios.de  Wed Dec 20 14:19:37 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 20 Dec 2006 14:19:37 +0100
Subject: [Pinot-svn] r670 - trunk
Message-ID: <200612201319.kBKDJb7j016734@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-20 14:19:37 +0100 (Wed, 20 Dec 2006)
New Revision: 670

Modified:
   trunk/configure.in
Log:
Bumped version number.


Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-12-20 13:16:58 UTC (rev 669)
+++ trunk/configure.in	2006-12-20 13:19:37 UTC (rev 670)
@@ -2,7 +2,7 @@
 # using glademm V2.6.0
 
 AC_PREREQ(2.50)
-AC_INIT(pinot, 0.64,[fabricecolin at users.berlios.de])
+AC_INIT(pinot, 0.65,[fabricecolin at users.berlios.de])
 AM_INIT_AUTOMAKE
 AC_CONFIG_HEADERS(config.h)
 



From fabricecolin at mail.berlios.de  Wed Dec 20 14:20:53 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 20 Dec 2006 14:20:53 +0100
Subject: [Pinot-svn] r671 - in trunk: Collect Index Search UI/GTK2/src
Message-ID: <200612201320.kBKDKrf9017200@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-20 14:20:53 +0100 (Wed, 20 Dec 2006)
New Revision: 671

Modified:
   trunk/Collect/pinot-collect.1
   trunk/Index/pinot-index.1
   trunk/Search/pinot-search.1
   trunk/UI/GTK2/src/pinot-dbus-daemon.1
   trunk/UI/GTK2/src/pinot.1
Log:
Updated with new version number.


Modified: trunk/Collect/pinot-collect.1
===================================================================
--- trunk/Collect/pinot-collect.1	2006-12-20 13:19:37 UTC (rev 670)
+++ trunk/Collect/pinot-collect.1	2006-12-20 13:20:53 UTC (rev 671)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-COLLECT "1" "December 2006" "pinot-collect - pinot 0.64" "User Commands"
+.TH PINOT-COLLECT "1" "December 2006" "pinot-collect - pinot 0.65" "User Commands"
 .SH NAME
 pinot-collect \- Download an URL from the command-line
 .SH SYNOPSIS

Modified: trunk/Index/pinot-index.1
===================================================================
--- trunk/Index/pinot-index.1	2006-12-20 13:19:37 UTC (rev 670)
+++ trunk/Index/pinot-index.1	2006-12-20 13:20:53 UTC (rev 671)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-INDEX "1" "December 2006" "pinot-index - pinot 0.64" "User Commands"
+.TH PINOT-INDEX "1" "December 2006" "pinot-index - pinot 0.65" "User Commands"
 .SH NAME
 pinot-index \- Index documents from the command-line
 .SH SYNOPSIS

Modified: trunk/Search/pinot-search.1
===================================================================
--- trunk/Search/pinot-search.1	2006-12-20 13:19:37 UTC (rev 670)
+++ trunk/Search/pinot-search.1	2006-12-20 13:20:53 UTC (rev 671)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-SEARCH "1" "December 2006" "pinot-search - pinot 0.64" "User Commands"
+.TH PINOT-SEARCH "1" "December 2006" "pinot-search - pinot 0.65" "User Commands"
 .SH NAME
 pinot-search \- Query search engines from the command-line
 .SH SYNOPSIS

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.1
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.1	2006-12-20 13:19:37 UTC (rev 670)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.1	2006-12-20 13:20:53 UTC (rev 671)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-DBUS-DAEMON "1" "December 2006" "pinot-dbus-daemon - pinot 0.64" "User Commands"
+.TH PINOT-DBUS-DAEMON "1" "December 2006" "pinot-dbus-daemon - pinot 0.65" "User Commands"
 .SH NAME
 pinot-dbus-daemon \- D-Bus search and index daemon
 .SH SYNOPSIS

Modified: trunk/UI/GTK2/src/pinot.1
===================================================================
--- trunk/UI/GTK2/src/pinot.1	2006-12-20 13:19:37 UTC (rev 670)
+++ trunk/UI/GTK2/src/pinot.1	2006-12-20 13:20:53 UTC (rev 671)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT "1" "December 2006" "pinot - pinot 0.64" "User Commands"
+.TH PINOT "1" "December 2006" "pinot - pinot 0.65" "User Commands"
 .SH NAME
 pinot \- A metasearch tool for the Free Desktop
 .SH SYNOPSIS



From fabricecolin at mail.berlios.de  Thu Dec 21 15:58:32 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 21 Dec 2006 15:58:32 +0100
Subject: [Pinot-svn] r672 - in trunk: UI/GTK2/src po
Message-ID: <200612211458.kBLEwWKR005792@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-21 15:58:31 +0100 (Thu, 21 Dec 2006)
New Revision: 672

Modified:
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/UI/GTK2/src/pinot.cc
   trunk/po/es.po
   trunk/po/fr.po
   trunk/po/nl.po
   trunk/po/sv.po
Log:
Force locale to UTF-8. This is very hackish but should help with a so far
unexplained crash when it's something else, eg fr_FR.ISO-8859-1.


Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-20 13:20:53 UTC (rev 671)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2006-12-21 14:58:31 UTC (rev 672)
@@ -227,9 +227,33 @@
 	g_refMainLoop = Glib::MainLoop::create();
 	Glib::set_application_name("Pinot DBus Daemon");
 
+	char *pLocale = setlocale(LC_ALL, NULL);
+	if (pLocale != NULL)
+	{
+		string locale(pLocale);
+
+		if (locale != "C")
+		{
+			string::size_type pos = locale.find_last_of(".");
+			if (pos != string::npos)
+			{
+				locale.resize(pos);
+			}
+			locale += ".UTF-8";
+
+			pLocale = setlocale(LC_ALL, locale.c_str());
+			if (pLocale != NULL)
+			{
+#ifdef DEBUG
+				cout << "Changed locale to " << pLocale << endl;
+#endif
+			}
+		}
+	}
+
 	// This will create the necessary directories on the first run
 	PinotSettings &settings = PinotSettings::getInstance();
-	// This is the daemon so disable DBus
+	// This is the daemon so disable DBus client
 	settings.enableDBus(false);
 
 	string confDirectory = PinotSettings::getConfigurationDirectory();

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2006-12-20 13:20:53 UTC (rev 671)
+++ trunk/UI/GTK2/src/pinot.cc	2006-12-21 14:58:31 UTC (rev 672)
@@ -158,6 +158,30 @@
 	Gtk::Main m(&argc, &argv);
 	Glib::set_application_name("Pinot GTK2 UI");
 
+	char *pLocale = setlocale(LC_ALL, NULL);
+	if (pLocale != NULL)
+	{
+		string locale(pLocale);
+
+		if (locale != "C")
+		{
+			string::size_type pos = locale.find_last_of(".");
+			if (pos != string::npos)
+			{
+				locale.resize(pos);
+			}
+			locale += ".UTF-8";
+
+			pLocale = setlocale(LC_ALL, locale.c_str());
+			if (pLocale != NULL)
+			{
+#ifdef DEBUG
+				cout << "Changed locale to " << pLocale << endl;
+#endif
+			}
+		}
+	}
+
 	// This will create the necessary directories on the first run
 	PinotSettings &settings = PinotSettings::getInstance();
 	// Talk to the daemon through DBus

Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2006-12-20 13:20:53 UTC (rev 671)
+++ trunk/po/es.po	2006-12-21 14:58:31 UTC (rev 672)
@@ -415,63 +415,63 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:249
+#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:273
 msgid "Unknown"
 msgstr "Desconocido"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:250
+#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:274
 msgid "Danish"
 msgstr "Dan?s"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:251
+#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:275
 msgid "Dutch"
 msgstr "Holand?s"
 
-#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:252
+#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:276
 msgid "English"
 msgstr "Ingl?s"
 
-#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:253
+#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:277
 msgid "Finnish"
 msgstr "Finland?s"
 
-#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:254
+#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:278
 msgid "French"
 msgstr "Franc?s"
 
-#: UI/GTK2/src/pinot.cc:186 UI/GTK2/src/pinot-dbus-daemon.cc:255
+#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:279
 msgid "German"
 msgstr "Alem?n"
 
-#: UI/GTK2/src/pinot.cc:187 UI/GTK2/src/pinot-dbus-daemon.cc:256
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:280
 msgid "Italian"
 msgstr "Italiano"
 
-#: UI/GTK2/src/pinot.cc:188 UI/GTK2/src/pinot-dbus-daemon.cc:257
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:281
 msgid "Norwegian"
 msgstr "Noruego"
 
-#: UI/GTK2/src/pinot.cc:189 UI/GTK2/src/pinot-dbus-daemon.cc:258
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:282
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:190 UI/GTK2/src/pinot-dbus-daemon.cc:259
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:283
 msgid "Russian"
 msgstr "Ruso"
 
-#: UI/GTK2/src/pinot.cc:191 UI/GTK2/src/pinot-dbus-daemon.cc:260
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:284
 msgid "Spanish"
 msgstr "Espa?ol"
 
-#: UI/GTK2/src/pinot.cc:192 UI/GTK2/src/pinot-dbus-daemon.cc:261
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:285
 msgid "Swedish"
 msgstr "Sueco"
 
-#: UI/GTK2/src/pinot.cc:216
+#: UI/GTK2/src/pinot.cc:240
 msgid "Couldn't open index"
 msgstr "No se pudo abrir el ?ndice"
 
-#: UI/GTK2/src/pinot.cc:232
+#: UI/GTK2/src/pinot.cc:256
 msgid "Couldn't create history database"
 msgstr "No se pudo crear la base de datos del hist?rico"
 

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2006-12-20 13:20:53 UTC (rev 671)
+++ trunk/po/fr.po	2006-12-21 14:58:31 UTC (rev 672)
@@ -415,63 +415,63 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:249
+#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:273
 msgid "Unknown"
 msgstr "Inconnu"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:250
+#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:274
 msgid "Danish"
 msgstr "Danois"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:251
+#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:275
 msgid "Dutch"
 msgstr "Hollandais"
 
-#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:252
+#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:276
 msgid "English"
 msgstr "Anglais"
 
-#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:253
+#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:277
 msgid "Finnish"
 msgstr "Finlandais"
 
-#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:254
+#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:278
 msgid "French"
 msgstr "Francais"
 
-#: UI/GTK2/src/pinot.cc:186 UI/GTK2/src/pinot-dbus-daemon.cc:255
+#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:279
 msgid "German"
 msgstr "Allemand"
 
-#: UI/GTK2/src/pinot.cc:187 UI/GTK2/src/pinot-dbus-daemon.cc:256
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:280
 msgid "Italian"
 msgstr "Italien"
 
-#: UI/GTK2/src/pinot.cc:188 UI/GTK2/src/pinot-dbus-daemon.cc:257
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:281
 msgid "Norwegian"
 msgstr "Norvegien"
 
-#: UI/GTK2/src/pinot.cc:189 UI/GTK2/src/pinot-dbus-daemon.cc:258
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:282
 msgid "Portuguese"
 msgstr "Portugais"
 
-#: UI/GTK2/src/pinot.cc:190 UI/GTK2/src/pinot-dbus-daemon.cc:259
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:283
 msgid "Russian"
 msgstr "Russe"
 
-#: UI/GTK2/src/pinot.cc:191 UI/GTK2/src/pinot-dbus-daemon.cc:260
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:284
 msgid "Spanish"
 msgstr "Espagnol"
 
-#: UI/GTK2/src/pinot.cc:192 UI/GTK2/src/pinot-dbus-daemon.cc:261
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:285
 msgid "Swedish"
 msgstr "Suedois"
 
-#: UI/GTK2/src/pinot.cc:216
+#: UI/GTK2/src/pinot.cc:240
 msgid "Couldn't open index"
 msgstr "N'a pas pu ouvrir l'index"
 
-#: UI/GTK2/src/pinot.cc:232
+#: UI/GTK2/src/pinot.cc:256
 msgid "Couldn't create history database"
 msgstr "N'a pas pu creer la base d'historiques"
 

Modified: trunk/po/nl.po
===================================================================
--- trunk/po/nl.po	2006-12-20 13:20:53 UTC (rev 671)
+++ trunk/po/nl.po	2006-12-21 14:58:31 UTC (rev 672)
@@ -417,63 +417,63 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:249
+#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:273
 msgid "Unknown"
 msgstr "Niet bekend"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:250
+#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:274
 msgid "Danish"
 msgstr "Deens"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:251
+#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:275
 msgid "Dutch"
 msgstr "Nederlands"
 
-#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:252
+#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:276
 msgid "English"
 msgstr "Engels"
 
-#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:253
+#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:277
 msgid "Finnish"
 msgstr "Fins"
 
-#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:254
+#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:278
 msgid "French"
 msgstr "Frans"
 
-#: UI/GTK2/src/pinot.cc:186 UI/GTK2/src/pinot-dbus-daemon.cc:255
+#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:279
 msgid "German"
 msgstr "Duits"
 
-#: UI/GTK2/src/pinot.cc:187 UI/GTK2/src/pinot-dbus-daemon.cc:256
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:280
 msgid "Italian"
 msgstr "Italiaans"
 
-#: UI/GTK2/src/pinot.cc:188 UI/GTK2/src/pinot-dbus-daemon.cc:257
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:281
 msgid "Norwegian"
 msgstr "Noors"
 
-#: UI/GTK2/src/pinot.cc:189 UI/GTK2/src/pinot-dbus-daemon.cc:258
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:282
 msgid "Portuguese"
 msgstr "Portugees"
 
-#: UI/GTK2/src/pinot.cc:190 UI/GTK2/src/pinot-dbus-daemon.cc:259
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:283
 msgid "Russian"
 msgstr "Russisch"
 
-#: UI/GTK2/src/pinot.cc:191 UI/GTK2/src/pinot-dbus-daemon.cc:260
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:284
 msgid "Spanish"
 msgstr "Spaans"
 
-#: UI/GTK2/src/pinot.cc:192 UI/GTK2/src/pinot-dbus-daemon.cc:261
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:285
 msgid "Swedish"
 msgstr "Zweeds"
 
-#: UI/GTK2/src/pinot.cc:216
+#: UI/GTK2/src/pinot.cc:240
 msgid "Couldn't open index"
 msgstr "Kan index niet openen"
 
-#: UI/GTK2/src/pinot.cc:232
+#: UI/GTK2/src/pinot.cc:256
 msgid "Couldn't create history database"
 msgstr "Kon historische database niet maken"
 

Modified: trunk/po/sv.po
===================================================================
--- trunk/po/sv.po	2006-12-20 13:20:53 UTC (rev 671)
+++ trunk/po/sv.po	2006-12-21 14:58:31 UTC (rev 672)
@@ -415,63 +415,63 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:180 UI/GTK2/src/pinot-dbus-daemon.cc:249
+#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:273
 msgid "Unknown"
 msgstr "Ok?nd"
 
-#: UI/GTK2/src/pinot.cc:181 UI/GTK2/src/pinot-dbus-daemon.cc:250
+#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:274
 msgid "Danish"
 msgstr "Danska"
 
-#: UI/GTK2/src/pinot.cc:182 UI/GTK2/src/pinot-dbus-daemon.cc:251
+#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:275
 msgid "Dutch"
 msgstr "Nederl?ndska"
 
-#: UI/GTK2/src/pinot.cc:183 UI/GTK2/src/pinot-dbus-daemon.cc:252
+#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:276
 msgid "English"
 msgstr "Engelska"
 
-#: UI/GTK2/src/pinot.cc:184 UI/GTK2/src/pinot-dbus-daemon.cc:253
+#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:277
 msgid "Finnish"
 msgstr "Finska"
 
-#: UI/GTK2/src/pinot.cc:185 UI/GTK2/src/pinot-dbus-daemon.cc:254
+#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:278
 msgid "French"
 msgstr "Franska"
 
-#: UI/GTK2/src/pinot.cc:186 UI/GTK2/src/pinot-dbus-daemon.cc:255
+#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:279
 msgid "German"
 msgstr "Tyska"
 
-#: UI/GTK2/src/pinot.cc:187 UI/GTK2/src/pinot-dbus-daemon.cc:256
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:280
 msgid "Italian"
 msgstr "Italienska"
 
-#: UI/GTK2/src/pinot.cc:188 UI/GTK2/src/pinot-dbus-daemon.cc:257
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:281
 msgid "Norwegian"
 msgstr "Norska"
 
-#: UI/GTK2/src/pinot.cc:189 UI/GTK2/src/pinot-dbus-daemon.cc:258
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:282
 msgid "Portuguese"
 msgstr "Portugisiska"
 
-#: UI/GTK2/src/pinot.cc:190 UI/GTK2/src/pinot-dbus-daemon.cc:259
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:283
 msgid "Russian"
 msgstr "Ryska"
 
-#: UI/GTK2/src/pinot.cc:191 UI/GTK2/src/pinot-dbus-daemon.cc:260
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:284
 msgid "Spanish"
 msgstr "Spanska"
 
-#: UI/GTK2/src/pinot.cc:192 UI/GTK2/src/pinot-dbus-daemon.cc:261
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:285
 msgid "Swedish"
 msgstr "Svenska"
 
-#: UI/GTK2/src/pinot.cc:216
+#: UI/GTK2/src/pinot.cc:240
 msgid "Couldn't open index"
 msgstr "Kunde inte ?ppna index"
 
-#: UI/GTK2/src/pinot.cc:232
+#: UI/GTK2/src/pinot.cc:256
 msgid "Couldn't create history database"
 msgstr "Kunde inte skapa historikdatabas"
 



From fabricecolin at mail.berlios.de  Thu Dec 21 15:59:10 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 21 Dec 2006 15:59:10 +0100
Subject: [Pinot-svn] r673 - trunk
Message-ID: <200612211459.kBLExA4i005850@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-21 15:59:10 +0100 (Thu, 21 Dec 2006)
New Revision: 673

Modified:
   trunk/NEWS
Log:
Changes since previous release.


Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2006-12-21 14:58:31 UTC (rev 672)
+++ trunk/NEWS	2006-12-21 14:59:10 UTC (rev 673)
@@ -1,3 +1,27 @@
+2006/12/21 version_0_6_5
+Build :
+ - added option --enable-debug to configure, --enable-soap replaces --with-soap
+ - complain bitterly if libtextcat header is not found
+ - Pthreads may be provided by a library other than libpthread
+ - install configuration files in sysconfdir, libraries in libdir
+Tokenize :
+ - optimized Ogg/MP3 filter
+Index :
+ - fixed extraction of language and size from document data
+ - store date terms for future date range filtering
+ - fixed argument checking in pinot-index
+Daemon :
+ - new DBus method SetDocumentsLabels to relabel several documents at once
+ - process DBus messages in a separate thread, not in the main thread
+UI :
+ - fixed expansion of .desktop's Exec
+ - initialize D-Bus ! Not sure why this didn't cause problems before.
+ - fixes for when the locale is not UTF-8
+ - on first run, open the Preferences box and show the Indexing tab
+ - for stored queries set to index and label results, only apply the new label
+  to results that already are in one of the indexes, don't do a full update
+ - refresh labelled documents list correctly after properties are changed
+
 2006/12/05 version_0_6_4
 Collect :
  - don't needlessly load files that are going to be handled by an helper application



From fabricecolin at mail.berlios.de  Thu Dec 21 16:31:16 2006
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 21 Dec 2006 16:31:16 +0100
Subject: [Pinot-svn] r674 - tags
Message-ID: <200612211531.kBLFVG7S015995@sheep.berlios.de>

Author: fabricecolin
Date: 2006-12-21 16:31:15 +0100 (Thu, 21 Dec 2006)
New Revision: 674

Added:
   tags/version_0_6_5/
Log:
Releasing 0.65 today.


Copied: tags/version_0_6_5 (from rev 673, trunk)



