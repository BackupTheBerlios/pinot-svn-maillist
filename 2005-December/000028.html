<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Pinot-svn] r29 - in trunk/UI: GTK2 GTK2/src RenderHTML
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/pinot-svn/2005-December/index.html" >
   <LINK REL="made" HREF="mailto:pinot-svn%40lists.berlios.de?Subject=Re%3A%20%5BPinot-svn%5D%20r29%20-%20in%20trunk/UI%3A%20GTK2%20GTK2/src%20RenderHTML&In-Reply-To=%3C200512291409.jBTE9cnj026257%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000027.html">
   <LINK REL="Next"  HREF="000029.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Pinot-svn] r29 - in trunk/UI: GTK2 GTK2/src RenderHTML</H1>
    <B>fabricecolin at BerliOS</B> 
    <A HREF="mailto:pinot-svn%40lists.berlios.de?Subject=Re%3A%20%5BPinot-svn%5D%20r29%20-%20in%20trunk/UI%3A%20GTK2%20GTK2/src%20RenderHTML&In-Reply-To=%3C200512291409.jBTE9cnj026257%40sheep.berlios.de%3E"
       TITLE="[Pinot-svn] r29 - in trunk/UI: GTK2 GTK2/src RenderHTML">fabricecolin at berlios.de
       </A><BR>
    <I>Thu Dec 29 15:09:38 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000027.html">[Pinot-svn] r28 - in trunk/UI/GTK2: . src
</A></li>
        <LI>Next message: <A HREF="000029.html">[Pinot-svn] r30 - trunk/UI/GTK2/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28">[ date ]</a>
              <a href="thread.html#28">[ thread ]</a>
              <a href="subject.html#28">[ subject ]</a>
              <a href="author.html#28">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: fabricecolin
Date: 2005-12-29 15:09:35 +0100 (Thu, 29 Dec 2005)
New Revision: 29

Added:
   trunk/UI/GTK2/src/Notebook.cpp
   trunk/UI/GTK2/src/Notebook.h
Removed:
   trunk/UI/GTK2/src/NotebookTabBox.cpp
   trunk/UI/GTK2/src/NotebookTabBox.h
Modified:
   trunk/UI/GTK2/metase-gtk2.glade
   trunk/UI/GTK2/src/HtmlView.cpp
   trunk/UI/GTK2/src/HtmlView.h
   trunk/UI/GTK2/src/IndexPage.cpp
   trunk/UI/GTK2/src/IndexPage.h
   trunk/UI/GTK2/src/IndexTree.cpp
   trunk/UI/GTK2/src/Makefile
   trunk/UI/GTK2/src/ResultsTree.cpp
   trunk/UI/GTK2/src/ResultsTree.h
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/mainWindow.hh
   trunk/UI/GTK2/src/mainWindow_glade.cc
   trunk/UI/GTK2/src/mainWindow_glade.hh
   trunk/UI/RenderHTML/MozillaRenderer.cpp
   trunk/UI/RenderHTML/MozillaRenderer.h
Log:
All notebook tabs are open on a need-to basis and can can be closed.


Modified: trunk/UI/GTK2/metase-gtk2.glade
===================================================================
--- trunk/UI/GTK2/metase-gtk2.glade	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/metase-gtk2.glade	2005-12-29 14:09:35 UTC (rev 29)
@@ -146,7 +146,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_clearresults_activate&quot; last_modification_time=&quot;Wed, 03 Mar 2004 19:51:48 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image538&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image546&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-clear&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -172,6 +172,7 @@
 
 		  &lt;child&gt;
 		    &lt;widget class=&quot;GtkMenuItem&quot; id=&quot;groupresults1&quot;&gt;
+		      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
 		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Group By&lt;/property&gt;
 		      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
@@ -273,7 +274,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_import_activate&quot; last_modification_time=&quot;Tue, 02 Mar 2004 22:13:44 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image539&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image547&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-open&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -311,7 +312,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_refreshindex_activate&quot; last_modification_time=&quot;Fri, 20 Feb 2004 18:57:09 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image540&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image548&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-refresh&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -333,7 +334,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_unindex_activate&quot; last_modification_time=&quot;Thu, 28 Jul 2005 12:42:23 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image541&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image549&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-delete&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -355,7 +356,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_showfromindex_activate&quot; last_modification_time=&quot;Sun, 06 Nov 2005 08:43:05 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image542&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image550&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-properties&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -513,6 +514,7 @@
 
 	  &lt;child&gt;
 	    &lt;widget class=&quot;GtkVBox&quot; id=&quot;rightVbox&quot;&gt;
+	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
 	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
 	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
@@ -817,106 +819,7 @@
 	      &lt;/child&gt;
 
 	      &lt;child&gt;
-		&lt;widget class=&quot;GtkNotebook&quot; id=&quot;mainNotebook&quot;&gt;
-		  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;show_tabs&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;show_border&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;tab_pos&quot;&gt;GTK_POS_TOP&lt;/property&gt;
-		  &lt;property name=&quot;scrollable&quot;&gt;False&lt;/property&gt;
-		  &lt;property name=&quot;enable_popup&quot;&gt;False&lt;/property&gt;
-		  &lt;signal name=&quot;switch_page&quot; handler=&quot;on_mainNotebook_switch_page&quot; last_modification_time=&quot;Wed, 28 Dec 2005 16:33:00 GMT&quot;/&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkVBox&quot; id=&quot;resultsVbox&quot;&gt;
-		      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
-
-		      &lt;child&gt;
-			&lt;placeholder/&gt;
-		      &lt;/child&gt;
-
-		      &lt;child&gt;
-			&lt;placeholder/&gt;
-		      &lt;/child&gt;
-		    &lt;/widget&gt;
-		    &lt;packing&gt;
-		      &lt;property name=&quot;tab_expand&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;tab_fill&quot;&gt;True&lt;/property&gt;
-		    &lt;/packing&gt;
-		  &lt;/child&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;resultsLabel&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Results&lt;/property&gt;
-		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-		      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-		      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-		    &lt;/widget&gt;
-		    &lt;packing&gt;
-		      &lt;property name=&quot;type&quot;&gt;tab&lt;/property&gt;
-		    &lt;/packing&gt;
-		  &lt;/child&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkVBox&quot; id=&quot;viewVbox&quot;&gt;
-		      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
-
-		      &lt;child&gt;
-			&lt;placeholder/&gt;
-		      &lt;/child&gt;
-		    &lt;/widget&gt;
-		    &lt;packing&gt;
-		      &lt;property name=&quot;tab_expand&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;tab_fill&quot;&gt;True&lt;/property&gt;
-		    &lt;/packing&gt;
-		  &lt;/child&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;viewLabel&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;View&lt;/property&gt;
-		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-		      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-		      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-		      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-		    &lt;/widget&gt;
-		    &lt;packing&gt;
-		      &lt;property name=&quot;type&quot;&gt;tab&lt;/property&gt;
-		    &lt;/packing&gt;
-		  &lt;/child&gt;
-		&lt;/widget&gt;
-		&lt;packing&gt;
-		  &lt;property name=&quot;padding&quot;&gt;4&lt;/property&gt;
-		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-		&lt;/packing&gt;
+		&lt;placeholder/&gt;
 	      &lt;/child&gt;
 	    &lt;/widget&gt;
 	    &lt;packing&gt;

Modified: trunk/UI/GTK2/src/HtmlView.cpp
===================================================================
--- trunk/UI/GTK2/src/HtmlView.cpp	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/HtmlView.cpp	2005-12-29 14:09:35 UTC (rev 29)
@@ -26,25 +26,23 @@
 using namespace Glib;
 using namespace Gtk;
 
-HtmlView::HtmlView(VBox *viewVbox, Menu *pPopupMenu) :
+HtmlView::HtmlView(Menu *pPopupMenu) :
 	MozillaRenderer(),
-	m_pPopupMenu(pPopupMenu)
+	m_pPopupMenu(pPopupMenu),
+	m_pDocHtmlView(NULL)
 {
-	GtkWidget *view = getWidget();
+	GtkWidget *view = getObject();
 	if (view != NULL)
 	{
 		// Wrap this into a gtkmm Widget object
-		// FIXME: need manage(wrap()) ?
-		Widget *pDocHtmlView = wrap(view);
-		if ((pDocHtmlView != NULL) &amp;&amp;
-			(viewVbox != NULL))
+		m_pDocHtmlView = wrap(view);
+		if (m_pDocHtmlView != NULL)
 		{
-			viewVbox-&gt;pack_start(*pDocHtmlView);
-
 			// Handle button presses
-			pDocHtmlView-&gt;signal_button_press_event().connect_notify(SigC::slot(*this, &amp;HtmlView::onButtonPressEvent));
+			m_pDocHtmlView-&gt;signal_button_press_event().connect_notify(
+				SigC::slot(*this, &amp;HtmlView::onButtonPressEvent));
 
-			pDocHtmlView-&gt;show();
+			m_pDocHtmlView-&gt;show();
 		}
 	}
 }
@@ -71,3 +69,11 @@
 		}
 	}
 }
+
+//
+// Returns the underlying widget.
+//
+Widget *HtmlView::getWidget(void) const
+{
+	return m_pDocHtmlView;
+}

Modified: trunk/UI/GTK2/src/HtmlView.h
===================================================================
--- trunk/UI/GTK2/src/HtmlView.h	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/HtmlView.h	2005-12-29 14:09:35 UTC (rev 29)
@@ -18,7 +18,6 @@
 #define _HTMLVIEW_HH
 
 #include &lt;sigc++/object.h&gt;
-#include &lt;gtkmm/box.h&gt;
 #include &lt;gtkmm/menu.h&gt;
 
 #include &quot;MozillaRenderer.h&quot;
@@ -26,11 +25,15 @@
 class HtmlView : public MozillaRenderer, public SigC::Object
 {
 	public:
-		HtmlView(Gtk::VBox *viewVbox, Gtk::Menu *pPopupMenu);
+		HtmlView(Gtk::Menu *pPopupMenu);
 		virtual ~HtmlView();
 
+		/// Returns the underlying widget.
+		Gtk::Widget *getWidget(void) const;
+
 	protected:
 		Gtk::Menu *m_pPopupMenu;
+		Gtk::Widget *m_pDocHtmlView;
 
 		/// Handles button presses.
 		void onButtonPressEvent(GdkEventButton *ev);

Modified: trunk/UI/GTK2/src/IndexPage.cpp
===================================================================
--- trunk/UI/GTK2/src/IndexPage.cpp	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/IndexPage.cpp	2005-12-29 14:09:35 UTC (rev 29)
@@ -37,10 +37,8 @@
 
 IndexPage::IndexPage(const ustring &amp;indexName, IndexTree *pTree,
 	PinotSettings &amp;settings) :
-	VBox(),
-	m_indexName(indexName),
+	NotebookPageBox(indexName, NotebookPageBox::INDEX_PAGE, settings),
 	m_pTree(pTree),
-	m_settings(settings),
 	m_pLabelCombobox(NULL),
 	m_pBackButton(NULL),
 	m_pForwardButton(NULL),
@@ -162,26 +160,26 @@
 		{
 			m_labelName.clear();
 		}
-		m_signalLabelChanged(m_indexName, m_labelName);
+		m_signalLabelChanged(m_title, m_labelName);
 	}
 }
 
 void IndexPage::onBackClicked(void)
 {
-	m_signalBackClicked(m_indexName);
+	m_signalBackClicked(m_title);
 }
 
 void IndexPage::onForwardClicked(void)
 {
-	m_signalForwardClicked(m_indexName);
+	m_signalForwardClicked(m_title);
 }
 
 //
-// Returns the name of the index being listed.
+// Returns the page's tree.
 //
-ustring IndexPage::getIndexName(void) const
+IndexTree *IndexPage::getTree(void) const
 {
-	return m_indexName;
+	return m_pTree;
 }
 
 //
@@ -193,14 +191,6 @@
 }
 
 //
-// Returns the page's tree.
-//
-IndexTree *IndexPage::getTree(void) const
-{
-	return m_pTree;
-}
-
-//
 // Populates the labels list.
 //
 void IndexPage::populateLabelCombobox(void)

Modified: trunk/UI/GTK2/src/IndexPage.h
===================================================================
--- trunk/UI/GTK2/src/IndexPage.h	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/IndexPage.h	2005-12-29 14:09:35 UTC (rev 29)
@@ -22,7 +22,6 @@
 #include &lt;sigc++/slot.h&gt;
 #include &lt;glibmm/refptr.h&gt;
 #include &lt;glibmm/ustring.h&gt;
-#include &lt;gtkmm/box.h&gt;
 #include &lt;gtkmm/menu.h&gt;
 #include &lt;gdkmm/pixbuf.h&gt;
 #include &lt;gtkmm/combobox.h&gt;
@@ -37,24 +36,22 @@
 #include &quot;IndexedDocument.h&quot;
 #include &quot;IndexTree.h&quot;
 #include &quot;ModelColumns.h&quot;
+#include &quot;Notebook.h&quot;
 #include &quot;PinotSettings.h&quot;
 
-class IndexPage : public Gtk::VBox
+class IndexPage : public NotebookPageBox
 {
 	public:
 		IndexPage(const Glib::ustring &amp;indexName, IndexTree *pTree,
 			PinotSettings &amp;settings);
 		virtual ~IndexPage();
 
-		/// Returns the name of the index being listed.
-		Glib::ustring getIndexName(void) const;
+		/// Returns the page's tree.
+		virtual IndexTree *getTree(void) const;
 
 		/// Returns the name of the current label.
 		Glib::ustring getLabelName(void) const;
 
-		/// Returns the page's tree.
-		IndexTree *getTree(void) const;
-
 		/// Populates the labels list.
 		void populateLabelCombobox(void);
 
@@ -86,7 +83,6 @@
 		Glib::ustring m_indexName;
 		Glib::ustring m_labelName;
 		IndexTree *m_pTree;
-		PinotSettings &amp;m_settings;
 		ComboModelColumns m_labelNameColumns;
 		Glib::RefPtr&lt;Gtk::ListStore&gt; m_refLabelNameTree;
 		Gtk::ComboBox *m_pLabelCombobox;

Modified: trunk/UI/GTK2/src/IndexTree.cpp
===================================================================
--- trunk/UI/GTK2/src/IndexTree.cpp	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/IndexTree.cpp	2005-12-29 14:09:35 UTC (rev 29)
@@ -38,6 +38,7 @@
 	TreeView(),
 	m_indexName(indexName),
 	m_pPopupMenu(pPopupMenu),
+	m_pIndexScrolledwindow(NULL),
 	m_settings(settings)
 {
 	m_pIndexScrolledwindow = manage(new ScrolledWindow());
@@ -150,7 +151,10 @@
 	// Check for double clicks
 	else if (ev-&gt;type == GDK_2BUTTON_PRESS)
 	{
-		m_signalEdit;
+#ifdef DEBUG
+		cout &lt;&lt; &quot;IndexTree::onButtonPressEvent: double-click&quot; &lt;&lt; endl;
+#endif
+		m_signalEdit();
 	}
 }
 

Modified: trunk/UI/GTK2/src/Makefile
===================================================================
--- trunk/UI/GTK2/src/Makefile	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/Makefile	2005-12-29 14:09:35 UTC (rev 29)
@@ -14,7 +14,7 @@
 	queryDialog.cc queryDialog_glade.cc \
 	mainWindow.cc mainWindow_glade.cc
 UI_SRCS = pinot.cpp EnginesTree.cpp IndexPage.cpp IndexTree.cpp \
-	HtmlView.cpp ModelColumns.cpp MonitorHandler.cpp NotebookTabBox.cpp \
+	HtmlView.cpp ModelColumns.cpp MonitorHandler.cpp Notebook.cpp \
 	PinotSettings.cpp PinotUtils.cpp ResultsTree.cpp WorkerThreads.cpp
 UI_GTK2_OBJS := $(patsubst %.cc,${OBJ_DIR}/%.o,${UI_GTK2_SRCS})
 UI_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${UI_SRCS})

Copied: trunk/UI/GTK2/src/Notebook.cpp (from rev 28, trunk/UI/GTK2/src/NotebookTabBox.cpp)
===================================================================
--- trunk/UI/GTK2/src/NotebookTabBox.cpp	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/Notebook.cpp	2005-12-29 14:09:35 UTC (rev 29)
@@ -0,0 +1,206 @@
+/*
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU Library General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ */
+
+#include &lt;sigc++/slot.h&gt;
+
+#include &quot;Notebook.h&quot;
+#include &quot;PinotUtils.h&quot;
+
+using namespace SigC;
+using namespace Glib;
+using namespace Gtk;
+
+NotebookPageBox::NotebookPageBox(const ustring &amp;title, NotebookPageBox::PageType type,
+	PinotSettings &amp;settings) :
+	VBox(),
+	m_title(title),
+	m_type(type),
+	m_settings(settings)
+{
+}
+
+NotebookPageBox::~NotebookPageBox()
+{
+}
+
+//
+// Returns the page title.
+//
+ustring NotebookPageBox::getTitle(void) const
+{
+	return m_title;
+}
+
+//
+// Returns the page type.
+//
+NotebookPageBox::PageType NotebookPageBox::getType(void) const
+{
+	return m_type;
+}
+
+ResultsPage::ResultsPage(const ustring &amp;queryName, ResultsTree *pTree,
+	PinotSettings &amp;settings) :
+	NotebookPageBox(queryName, NotebookPageBox::RESULTS_PAGE, settings),
+	m_pTree(pTree)
+{
+	if (pTree != NULL)
+	{
+		pack_start(*pTree-&gt;getResultsScrolledWindow(), Gtk::PACK_EXPAND_WIDGET, 0);
+		pack_start(*pTree-&gt;getExtractScrolledWindow(), Gtk::PACK_SHRINK, 0);
+	}
+
+	show();
+}
+
+ResultsPage::~ResultsPage()
+{
+}
+
+//
+// Returns the page's tree.
+//
+ResultsTree *ResultsPage::getTree(void) const
+{
+	return m_pTree;
+}
+
+ViewPage::ViewPage(const ustring &amp;viewName, HtmlView *pView,
+	PinotSettings &amp;settings) :
+	NotebookPageBox(viewName, NotebookPageBox::VIEW_PAGE, settings),
+	m_pView(pView)
+{
+	if (pView != NULL)
+	{
+		Widget *pViewWidget = pView-&gt;getWidget();
+		if (pViewWidget != NULL)
+		{
+			pack_start(*pViewWidget);
+		}
+	}
+
+	show();
+}
+
+ViewPage::~ViewPage()
+{
+}
+
+//
+// Returns the page's view.
+//
+HtmlView *ViewPage::getView(void) const
+{
+	return m_pView;
+}
+
+NotebookTabBox::NotebookTabBox(const Glib::ustring &amp;title, NotebookPageBox::PageType type) :
+	HBox(),
+	m_title(title),
+	m_pageType(type),
+	m_tabLabel(NULL),
+#if _USE_BUTTON_TAB
+	m_tabButton(NULL)
+#else
+	m_tabEventBox(NULL)
+#endif
+{
+	int width, height;
+
+	// Lookup the standard icon size
+	bool gotDimensions = IconSize::lookup(ICON_SIZE_MENU, width, height);
+
+	m_tabLabel = manage(new Label(title));
+	m_tabImage = manage(new Image(StockID(&quot;gtk-close&quot;), IconSize(ICON_SIZE_MENU)));
+#if _USE_BUTTON_TAB
+	m_tabButton = manage(new Button());
+#else
+	m_tabEventBox = manage(new EventBox);
+#endif
+
+	m_tabLabel-&gt;set_alignment(0,0.5);
+	m_tabLabel-&gt;set_padding(0,0);
+	m_tabLabel-&gt;set_justify(JUSTIFY_LEFT);
+	m_tabLabel-&gt;set_line_wrap(false);
+	m_tabLabel-&gt;set_use_markup(false);
+	m_tabLabel-&gt;set_selectable(false);
+	m_tabImage-&gt;set_alignment(0,0);
+	m_tabImage-&gt;set_padding(0,0);
+#if _USE_BUTTON_TAB
+	m_tabButton-&gt;set_flags(CAN_FOCUS);
+	m_tabButton-&gt;set_flags(CAN_DEFAULT);
+	m_tabButton-&gt;add(*m_tabImage);
+	m_tabButton-&gt;set_relief(RELIEF_NONE);
+	m_tabButton-&gt;set_border_width(0);
+	m_tabButton-&gt;set_alignment(0,0);
+	// Resize the button
+	if (gotDimensions == true)
+	{
+		m_tabButton-&gt;set_size_request(width, height);
+		m_tabButton-&gt;check_resize();
+	}
+#else
+	m_tabEventBox-&gt;add(*m_tabImage);
+	m_tabEventBox-&gt;set_events(Gdk::BUTTON_PRESS_MASK);
+#endif
+	pack_start(*m_tabLabel);
+#if _USE_BUTTON_TAB
+	pack_start(*m_tabButton, PACK_SHRINK);
+#else
+	pack_start(*m_tabEventBox, PACK_SHRINK);
+#endif
+	set_spacing(0);
+	set_homogeneous(false);
+	m_tabLabel-&gt;show();
+	m_tabImage-&gt;show();
+#if _USE_BUTTON_TAB
+	m_tabButton-&gt;show();
+#else
+	m_tabEventBox-&gt;show();
+#endif
+	show();
+
+#if _USE_BUTTON_TAB
+	m_tabButton-&gt;signal_clicked().connect(
+		SigC::slot(*this, &amp;NotebookTabBox::onButtonClicked));
+#else
+	m_tabEventBox-&gt;signal_button_press_event().connect(
+		SigC::slot(*this, &amp;NotebookTabBox::onButtonPressEvent));
+#endif
+}
+
+NotebookTabBox::~NotebookTabBox()
+{
+}
+
+#if _USE_BUTTON_TAB
+void NotebookTabBox::onButtonClicked(void)
+#else
+bool NotebookTabBox::onButtonPressEvent(GdkEventButton *ev)
+#endif
+{
+	m_signalClose(m_title, m_pageType);
+
+	return true;
+}
+
+//
+// Returns the close signal.
+//
+Signal2&lt;void, ustring, NotebookPageBox::PageType&gt;&amp; NotebookTabBox::getCloseSignal(void)
+{
+	return m_signalClose;
+}

Copied: trunk/UI/GTK2/src/Notebook.h (from rev 28, trunk/UI/GTK2/src/NotebookTabBox.h)
===================================================================
--- trunk/UI/GTK2/src/NotebookTabBox.h	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/Notebook.h	2005-12-29 14:09:35 UTC (rev 29)
@@ -0,0 +1,116 @@
+/*
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU Library General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ */
+
+#ifndef _NOTEBOOK_HH
+#define _NOTEBOOK_HH
+
+#include &lt;sigc++/signal.h&gt;
+#include &lt;glibmm/ustring.h&gt;
+#include &lt;gtkmm/box.h&gt;
+#include &lt;gtkmm/label.h&gt;
+#include &lt;gtkmm/image.h&gt;
+#if _USE_BUTTON_TAB
+#include &lt;gtkmm/button.h&gt;
+#else
+#include &lt;gtkmm/eventbox.h&gt;
+#endif
+
+#include &quot;HtmlView.h&quot;
+#include &quot;PinotSettings.h&quot;
+#include &quot;ResultsTree.h&quot;
+
+class NotebookPageBox : public Gtk::VBox
+{
+	public:
+		typedef enum { RESULTS_PAGE = 0, INDEX_PAGE, VIEW_PAGE } PageType;
+
+		NotebookPageBox(const Glib::ustring &amp;title, PageType type,
+			PinotSettings &amp;settings);
+		virtual ~NotebookPageBox();
+
+		/// Returns the page title.
+		Glib::ustring getTitle(void) const;
+
+		/// Returns the page type.
+		PageType getType(void) const;
+
+	protected:
+		Glib::ustring m_title;
+		PageType m_type;
+		PinotSettings &amp;m_settings;
+
+};
+
+class ResultsPage : public NotebookPageBox
+{
+	public:
+		ResultsPage(const Glib::ustring &amp;queryName, ResultsTree *pTree,
+			PinotSettings &amp;settings);
+		virtual ~ResultsPage();
+
+		/// Returns the page's tree.
+		virtual ResultsTree *getTree(void) const;
+
+	protected:
+		ResultsTree *m_pTree;
+
+};
+
+class ViewPage : public NotebookPageBox
+{
+	public:
+		ViewPage(const Glib::ustring &amp;viewName, HtmlView *pView,
+			PinotSettings &amp;settings);
+		virtual ~ViewPage();
+
+		/// Returns the page's view.
+		virtual HtmlView *getView(void) const;
+
+	protected:
+		HtmlView *m_pView;
+
+};
+
+class NotebookTabBox : public Gtk::HBox
+{
+	public:
+		NotebookTabBox(const Glib::ustring &amp;title, NotebookPageBox::PageType type);
+		virtual ~NotebookTabBox();
+
+		/// Returns the close signal.
+		SigC::Signal2&lt;void, Glib::ustring, NotebookPageBox::PageType&gt;&amp; getCloseSignal(void);
+
+	protected:
+		Glib::ustring m_title;
+		NotebookPageBox::PageType m_pageType;
+		Gtk::Label *m_tabLabel;
+		Gtk::Image *m_tabImage;
+#if _USE_BUTTON_TAB
+		Gtk::Button *m_tabButton;
+#else
+		Gtk::EventBox *m_tabEventBox;
+#endif
+		SigC::Signal2&lt;void, Glib::ustring, NotebookPageBox::PageType&gt; m_signalClose;
+
+#if _USE_BUTTON_TAB
+		void onButtonClicked(void);
+#else
+		bool onButtonPressEvent(GdkEventButton *ev);
+#endif
+
+};
+
+#endif // _NOTEBOOK_HH

Deleted: trunk/UI/GTK2/src/NotebookTabBox.cpp
===================================================================
--- trunk/UI/GTK2/src/NotebookTabBox.cpp	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/NotebookTabBox.cpp	2005-12-29 14:09:35 UTC (rev 29)
@@ -1,130 +0,0 @@
-/*
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU Library General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
- */
-
-#include &lt;sigc++/slot.h&gt;
-
-#include &quot;NotebookTabBox.h&quot;
-#include &quot;PinotUtils.h&quot;
-
-using namespace SigC;
-using namespace Glib;
-using namespace Gtk;
-
-NotebookTabBox::NotebookTabBox(const Glib::ustring &amp;title, PageType type) :
-	HBox(),
-	m_title(title),
-	m_pageType(type),
-	m_tabLabel(NULL),
-#if _USE_BUTTON_TAB
-	m_tabButton(NULL)
-#else
-	m_tabEventBox(NULL)
-#endif
-{
-	int width, height;
-
-	// Lookup the standard icon size
-	bool gotDimensions = IconSize::lookup(ICON_SIZE_MENU, width, height);
-
-	m_tabLabel = manage(new Label(title));
-	m_tabImage = manage(new Image(StockID(&quot;gtk-close&quot;), IconSize(ICON_SIZE_MENU)));
-#if _USE_BUTTON_TAB
-	m_tabButton = manage(new Button());
-#else
-	m_tabEventBox = manage(new EventBox);
-#endif
-
-	m_tabLabel-&gt;set_alignment(0,0.5);
-	m_tabLabel-&gt;set_padding(0,0);
-	m_tabLabel-&gt;set_justify(JUSTIFY_LEFT);
-	m_tabLabel-&gt;set_line_wrap(false);
-	m_tabLabel-&gt;set_use_markup(false);
-	m_tabLabel-&gt;set_selectable(false);
-	m_tabImage-&gt;set_alignment(0,0);
-	m_tabImage-&gt;set_padding(0,0);
-#if _USE_BUTTON_TAB
-	m_tabButton-&gt;set_flags(CAN_FOCUS);
-	m_tabButton-&gt;set_flags(CAN_DEFAULT);
-	m_tabButton-&gt;add(*m_tabImage);
-	m_tabButton-&gt;set_relief(RELIEF_NONE);
-	m_tabButton-&gt;set_border_width(0);
-	m_tabButton-&gt;set_alignment(0,0);
-	// Resize the button
-	if (gotDimensions == true)
-	{
-		m_tabButton-&gt;set_size_request(width, height);
-		m_tabButton-&gt;check_resize();
-	}
-#else
-	m_tabEventBox-&gt;add(*m_tabImage);
-	m_tabEventBox-&gt;set_events(Gdk::BUTTON_PRESS_MASK);
-#endif
-	pack_start(*m_tabLabel);
-#if _USE_BUTTON_TAB
-	pack_start(*m_tabButton, PACK_SHRINK);
-#else
-	pack_start(*m_tabEventBox, PACK_SHRINK);
-#endif
-	set_spacing(0);
-	set_homogeneous(false);
-	m_tabLabel-&gt;show();
-	m_tabImage-&gt;show();
-#if _USE_BUTTON_TAB
-	m_tabButton-&gt;show();
-#else
-	m_tabEventBox-&gt;show();
-#endif
-	show();
-
-#if _USE_BUTTON_TAB
-	m_tabButton-&gt;signal_clicked().connect(
-		SigC::slot(*this, &amp;NotebookTabBox::onButtonClicked));
-#else
-	m_tabEventBox-&gt;signal_button_press_event().connect(
-		SigC::slot(*this, &amp;NotebookTabBox::onButtonPressEvent));
-#endif
-}
-
-NotebookTabBox::~NotebookTabBox()
-{
-}
-
-#if _USE_BUTTON_TAB
-void NotebookTabBox::onButtonClicked(void)
-#else
-bool NotebookTabBox::onButtonPressEvent(GdkEventButton *ev)
-#endif
-{
-	m_signalClose(m_title, m_pageType);
-
-	return true;
-}
-
-//
-// Returns the page type.
-//
-NotebookTabBox::PageType NotebookTabBox::getPageType(void) const
-{
-	return m_pageType;
-}
-
-//
-// Returns the close signal.
-//
-Signal2&lt;void, ustring, NotebookTabBox::PageType&gt;&amp; NotebookTabBox::getCloseSignal(void)
-{
-	return m_signalClose;
-}

Deleted: trunk/UI/GTK2/src/NotebookTabBox.h
===================================================================
--- trunk/UI/GTK2/src/NotebookTabBox.h	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/NotebookTabBox.h	2005-12-29 14:09:35 UTC (rev 29)
@@ -1,68 +0,0 @@
-/*
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU Library General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
- */
-
-#ifndef _NOTEBOOKTABBOX_HH
-#define _NOTEBOOKTABBOX_HH
-
-#include &lt;sigc++/signal.h&gt;
-#include &lt;glibmm/ustring.h&gt;
-#include &lt;gtkmm/box.h&gt;
-#include &lt;gtkmm/label.h&gt;
-#include &lt;gtkmm/image.h&gt;
-#if _USE_BUTTON_TAB
-#include &lt;gtkmm/button.h&gt;
-#else
-#include &lt;gtkmm/eventbox.h&gt;
-#endif
-
-/**
-  * Closable notebook tab.
-  */
-class NotebookTabBox : public Gtk::HBox
-{
-	public:
-		typedef enum { RESULTS_PAGE = 0, INDEX_PAGE, VIEW_PAGE } PageType;
-
-		NotebookTabBox(const Glib::ustring &amp;title, PageType type);
-		virtual ~NotebookTabBox();
-
-		/// Returns the page type.
-		PageType getPageType(void) const;
-
-		/// Returns the close signal.
-		SigC::Signal2&lt;void, Glib::ustring, PageType&gt;&amp; getCloseSignal(void);
-
-	protected:
-		Glib::ustring m_title;
-		PageType m_pageType;
-		Gtk::Label *m_tabLabel;
-		Gtk::Image *m_tabImage;
-#if _USE_BUTTON_TAB
-		Gtk::Button *m_tabButton;
-#else
-		Gtk::EventBox *m_tabEventBox;
-#endif
-		SigC::Signal2&lt;void, Glib::ustring, PageType&gt; m_signalClose;
-
-#if _USE_BUTTON_TAB
-		void onButtonClicked(void);
-#else
-		bool onButtonPressEvent(GdkEventButton *ev);
-#endif
-
-};
-
-#endif // _NOTEBOOKTABBOX_HH

Modified: trunk/UI/GTK2/src/ResultsTree.cpp
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.cpp	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/ResultsTree.cpp	2005-12-29 14:09:35 UTC (rev 29)
@@ -40,16 +40,19 @@
 using namespace Gdk;
 using namespace Gtk;
 
-ResultsTree::ResultsTree(VBox *resultsVbox, Menu *pPopupMenu, PinotSettings &amp;settings) :
+ResultsTree::ResultsTree(const ustring &amp;queryName, Menu *pPopupMenu,
+	PinotSettings &amp;settings) :
 	TreeView(),
+	m_queryName(queryName),
 	m_pPopupMenu(pPopupMenu),
+	m_pResultsScrolledwindow(NULL),
 	m_settings(settings),
-	m_extractScrolledwindow(NULL),
+	m_pExtractScrolledwindow(NULL),
 	m_extractTextview(NULL),
 	m_showExtract(true)
 {
-	ScrolledWindow *resultsScrolledwindow = manage(new ScrolledWindow());
-	m_extractScrolledwindow = manage(new ScrolledWindow());
+	m_pResultsScrolledwindow = manage(new ScrolledWindow());
+	m_pExtractScrolledwindow = manage(new ScrolledWindow());
 	m_extractTextview = manage(new TextView());
 
 	// This is the actual results tree
@@ -59,12 +62,12 @@
 	set_rules_hint(true);
 	set_reorderable(false);
 	set_enable_search(true);
-	resultsScrolledwindow-&gt;set_flags(CAN_FOCUS);
-	resultsScrolledwindow-&gt;set_border_width(4);
-	resultsScrolledwindow-&gt;set_shadow_type(SHADOW_NONE);
-	resultsScrolledwindow-&gt;set_policy(POLICY_AUTOMATIC, POLICY_ALWAYS);
-	resultsScrolledwindow-&gt;property_window_placement().set_value(CORNER_TOP_LEFT);
-	resultsScrolledwindow-&gt;add(*this);
+	m_pResultsScrolledwindow-&gt;set_flags(CAN_FOCUS);
+	m_pResultsScrolledwindow-&gt;set_border_width(4);
+	m_pResultsScrolledwindow-&gt;set_shadow_type(SHADOW_NONE);
+	m_pResultsScrolledwindow-&gt;set_policy(POLICY_AUTOMATIC, POLICY_ALWAYS);
+	m_pResultsScrolledwindow-&gt;property_window_placement().set_value(CORNER_TOP_LEFT);
+	m_pResultsScrolledwindow-&gt;add(*this);
 
 	// That's for the extract view
 	m_extractTextview-&gt;set_flags(CAN_FOCUS);
@@ -78,17 +81,13 @@
 	m_extractTextview-&gt;set_indent(0);
 	m_extractTextview-&gt;set_wrap_mode(WRAP_WORD);
 	m_extractTextview-&gt;set_justification(JUSTIFY_LEFT);
-	m_extractScrolledwindow-&gt;set_flags(CAN_FOCUS);
-	m_extractScrolledwindow-&gt;set_border_width(4);
-	m_extractScrolledwindow-&gt;set_shadow_type(SHADOW_NONE);
-	m_extractScrolledwindow-&gt;set_policy(POLICY_AUTOMATIC, POLICY_AUTOMATIC);
-	m_extractScrolledwindow-&gt;property_window_placement().set_value(CORNER_TOP_LEFT);
-	m_extractScrolledwindow-&gt;add(*m_extractTextview);
+	m_pExtractScrolledwindow-&gt;set_flags(CAN_FOCUS);
+	m_pExtractScrolledwindow-&gt;set_border_width(4);
+	m_pExtractScrolledwindow-&gt;set_shadow_type(SHADOW_NONE);
+	m_pExtractScrolledwindow-&gt;set_policy(POLICY_AUTOMATIC, POLICY_AUTOMATIC);
+	m_pExtractScrolledwindow-&gt;property_window_placement().set_value(CORNER_TOP_LEFT);
+	m_pExtractScrolledwindow-&gt;add(*m_extractTextview);
 
-	// Position the scrolled windows
-	resultsVbox-&gt;pack_start(*resultsScrolledwindow, Gtk::PACK_EXPAND_WIDGET, 0);
-	resultsVbox-&gt;pack_start(*m_extractScrolledwindow, Gtk::PACK_SHRINK, 0);
-
 	// Associate the columns model to the results tree
 	m_refStore = TreeStore::create(m_resultsColumns);
 	set_model(m_refStore);
@@ -119,8 +118,12 @@
 	// Allow multiple selection
 	get_selection()-&gt;set_mode(SELECTION_MULTIPLE);
 
-	// Handle button presses
-	signal_button_press_event().connect_notify(SigC::slot(*this, &amp;ResultsTree::onButtonPressEvent));
+	// Connect the signals
+	signal_button_press_event().connect_notify(
+		SigC::slot(*this, &amp;ResultsTree::onButtonPressEvent));
+	get_selection()-&gt;signal_changed().connect(
+		SigC::slot(*this, &amp;ResultsTree::onSelectionChanged));
+
 	// Enable interactive search
 	set_search_column(m_resultsColumns.m_text.index());
 	set_search_equal_func(SigC::slot(*this, &amp;ResultsTree::onSearchEqual));
@@ -138,9 +141,9 @@
 
 	// Show all
 	show();
-	resultsScrolledwindow-&gt;show();
+	m_pResultsScrolledwindow-&gt;show();
 	m_extractTextview-&gt;show();
-	m_extractScrolledwindow-&gt;show();
+	m_pExtractScrolledwindow-&gt;show();
 }
 
 ResultsTree::~ResultsTree()
@@ -230,17 +233,6 @@
 	}
 }
 
-//
-// Interactive search equal function.
-//
-bool ResultsTree::onSearchEqual(const RefPtr&lt;TreeModel&gt;&amp; model, int column,
-	const ustring&amp; key, const TreeModel::iterator&amp; iter)
-{
-}
-
-//
-// Handles button presses.
-//
 void ResultsTree::onButtonPressEvent(GdkEventButton *ev)
 {
 	// Check for popup click
@@ -278,43 +270,16 @@
 	}
 }
 
-//
-// Handles selection changes.
-//
-bool ResultsTree::onSelectionChanged(void)
+void ResultsTree::onSelectionChanged(void)
 {
-	bool goodSel = true;
+	m_signalSelectionChanged(m_queryName);
+}
 
-#ifdef DEBUG
-	cout &lt;&lt; &quot;ResultsTree::onSelectionChanged: called&quot; &lt;&lt; endl;
-#endif
-	list&lt;TreeModel::Path&gt; selectedItems = get_selection()-&gt;get_selected_rows();
-	if (selectedItems.empty() == true)
-	{
-		return false;
-	}
-
-	// Go through selected items
-	for (list&lt;TreeModel::Path&gt;::iterator itemPath = selectedItems.begin();
-		itemPath != selectedItems.end(); ++itemPath)
-	{
-		TreeModel::iterator iter = m_refStore-&gt;get_iter(*itemPath);
-		TreeModel::Row row = *iter;
-
-		// Check only results are selected
-		ResultsModelColumns::ResultType type = row[m_resultsColumns.m_type];
-		if (type != ResultsModelColumns::RESULT_TITLE)
-		{
-			goodSel = false;
-		}
-	}
-
-	return goodSel;
+bool ResultsTree::onSearchEqual(const RefPtr&lt;TreeModel&gt;&amp; model, int column,
+	const ustring&amp; key, const TreeModel::iterator&amp; iter)
+{
 }
 
-//
-// Handles attempts to select rows.
-//
 bool ResultsTree::onSelectionSelect(const RefPtr&lt;TreeModel&gt;&amp; model,
 		const TreeModel::Path&amp; path, bool path_currently_selected)
 {
@@ -343,7 +308,7 @@
 			set&lt;string&gt; engineNames, indexNames;
 			string extract;
 
-			m_queryName = locale_from_utf8(row[m_resultsColumns.m_queryName]);
+			// m_queryName and row[m_resultsColumns.m_queryName] should be equal
 			string url = locale_from_utf8(row[m_resultsColumns.m_url]);
 			unsigned int engineIds = row[m_resultsColumns.m_engines];
 			unsigned int indexIds = row[m_resultsColumns.m_indexes];
@@ -378,7 +343,7 @@
 #ifdef DEBUG
 				cout &lt;&lt; &quot;ResultsTree::onSelectionSelect: first engine for &quot; &lt;&lt; url &lt;&lt; &quot; was &quot; &lt;&lt; engineName &lt;&lt; endl;
 #endif
-				extract = history.getItemExtract(m_queryName, engineName, url);
+				extract = history.getItemExtract(locale_from_utf8(m_queryName), engineName, url);
 			}
 
 			RefPtr&lt;TextBuffer&gt; refBuffer = m_extractTextview-&gt;get_buffer();
@@ -392,9 +357,6 @@
 	return true;
 }
 
-//
-// Handles GTK style changes.
-//
 void ResultsTree::onStyleChanged(const RefPtr&lt;Style&gt; &amp;previous_style)
 {
 #ifdef DEBUG
@@ -409,6 +371,22 @@
 }
 
 //
+// Returns the results scrolled window.
+//
+ScrolledWindow *ResultsTree::getResultsScrolledWindow(void) const
+{
+	return m_pResultsScrolledwindow;
+}
+
+//
+// Returns the extract scrolled window.
+//
+ScrolledWindow *ResultsTree::getExtractScrolledWindow(void) const
+{
+	return m_pExtractScrolledwindow;
+}
+
+//
 // Adds a set of results.
 // Returns true if something was added to the tree.
 //
@@ -773,6 +751,40 @@
 }
 
 //
+// Determines if results are selected.
+//
+bool ResultsTree::checkSelection(void)
+{
+	bool goodSel = true;
+
+#ifdef DEBUG
+	cout &lt;&lt; &quot;ResultsTree::checkSelection: called&quot; &lt;&lt; endl;
+#endif
+	list&lt;TreeModel::Path&gt; selectedItems = get_selection()-&gt;get_selected_rows();
+	if (selectedItems.empty() == true)
+	{
+		return false;
+	}
+
+	// Go through selected items
+	for (list&lt;TreeModel::Path&gt;::iterator itemPath = selectedItems.begin();
+		itemPath != selectedItems.end(); ++itemPath)
+	{
+		TreeModel::iterator iter = m_refStore-&gt;get_iter(*itemPath);
+		TreeModel::Row row = *iter;
+
+		// Check only results are selected
+		ResultsModelColumns::ResultType type = row[m_resultsColumns.m_type];
+		if (type != ResultsModelColumns::RESULT_TITLE)
+		{
+			goodSel = false;
+		}
+	}
+
+	return goodSel;
+}
+
+//
 // Gets the first selected item's URL.
 //
 ustring ResultsTree::getFirstSelectionURL(void)
@@ -941,16 +953,24 @@
 	if (m_showExtract == true)
 	{
 		// Show the extract
-		m_extractScrolledwindow-&gt;show();
+		m_pExtractScrolledwindow-&gt;show();
 	}
 	else
 	{
 		// Hide
-		m_extractScrolledwindow-&gt;hide();
+		m_pExtractScrolledwindow-&gt;hide();
 	}
 }
 
 //
+// Returns the changed selection signal.
+//
+Signal1&lt;void, ustring&gt;&amp; ResultsTree::getSelectionChangedSignal(void)
+{
+	return m_signalSelectionChanged;
+}
+
+//
 // Adds a new row in the results tree.
 //
 bool ResultsTree::appendResult(const string &amp;text, const string &amp;url,

Modified: trunk/UI/GTK2/src/ResultsTree.h
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.h	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/ResultsTree.h	2005-12-29 14:09:35 UTC (rev 29)
@@ -25,7 +25,6 @@
 #include &lt;glibmm/refptr.h&gt;
 #include &lt;glibmm/ustring.h&gt;
 #include &lt;gdkmm/pixbuf.h&gt;
-#include &lt;gtkmm/box.h&gt;
 #include &lt;gtkmm/button.h&gt;
 #include &lt;gtkmm/menu.h&gt;
 #include &lt;gtkmm/scrolledwindow.h&gt;
@@ -42,15 +41,16 @@
 class ResultsTree : public Gtk::TreeView
 {
 	public:
-		ResultsTree(Gtk::VBox *resultsVbox, Gtk::Menu *pPopupMenu, PinotSettings &amp;settings);
+		ResultsTree(const Glib::ustring &amp;queryName, Gtk::Menu *pPopupMenu,
+			PinotSettings &amp;settings);
 		virtual ~ResultsTree();
 
-		/**
-		  * Handles selection changes.
-		  * Returns true if a result is selected.
-		  */
-		bool onSelectionChanged(void);
+		/// Returns the results scrolled window.
+		Gtk::ScrolledWindow *getResultsScrolledWindow(void) const;
 
+		/// Returns the extract scrolled window.
+		Gtk::ScrolledWindow *getExtractScrolledWindow(void) const;
+
 		/**
 		  * Adds a set of results.
 		  * Returns true if something was added to the tree.
@@ -61,6 +61,9 @@
 		/// Groups results.
 		void regroupResults(bool groupBySearchEngine);
 
+		/// Determines if results are selected.
+		bool checkSelection(void);
+
 		/// Gets the first selected item's URL.
 		Glib::ustring getFirstSelectionURL(void);
 
@@ -82,9 +85,15 @@
 		/// Shows or hides the extract field.
 		void showExtract(bool show = true);
 
+		/// Returns the changed selection signal.
+		SigC::Signal1&lt;void, Glib::ustring&gt;&amp; getSelectionChangedSignal(void);
+
 	protected:
+		Glib::ustring m_queryName;
+		Gtk::Menu *m_pPopupMenu;
+		Gtk::ScrolledWindow *m_pResultsScrolledwindow;
 		Glib::RefPtr&lt;Gtk::TreeStore&gt; m_refStore;
-		Gtk::Menu *m_pPopupMenu;
+		SigC::Signal1&lt;void, Glib::ustring&gt; m_signalSelectionChanged;
 		PinotSettings &amp;m_settings;
 		Glib::RefPtr&lt;Gdk::Pixbuf&gt; m_indexedIconPixbuf;
 		Glib::RefPtr&lt;Gdk::Pixbuf&gt; m_viewededIconPixbuf;
@@ -93,11 +102,10 @@
 		Glib::RefPtr&lt;Gdk::Pixbuf&gt; m_downIconPixbuf;
 		std::map&lt;std::string, Gtk::TreeModel::iterator&gt; m_resultsGroups;
 		ResultsModelColumns m_resultsColumns;
-		Gtk::ScrolledWindow *m_extractScrolledwindow;
+		Gtk::ScrolledWindow *m_pExtractScrolledwindow;
 		Gtk::TextView *m_extractTextview;
 		std::set&lt;std::string&gt; m_indexNames;
 		bool m_showExtract;
-		std::string m_queryName;
 
 		void renderViewStatus(Gtk::CellRenderer *renderer, const Gtk::TreeModel::iterator &amp;iter);
 
@@ -105,14 +113,13 @@
 
 		void renderRanking(Gtk::CellRenderer *renderer, const Gtk::TreeModel::iterator &amp;iter);
 
-		/// Interactive search equal function.
+		void onButtonPressEvent(GdkEventButton *ev);
+
+		void onSelectionChanged(void);
+
 		bool onSearchEqual(const Glib::RefPtr&lt;Gtk::TreeModel&gt;&amp; model, int column,
 			const Glib::ustring&amp; key, const Gtk::TreeModel::iterator&amp; iter);
 
-		/// Handles button presses.
-		void onButtonPressEvent(GdkEventButton *ev);
-
-		/// Handles attempts to select rows.
 		bool onSelectionSelect(const Glib::RefPtr&lt;Gtk::TreeModel&gt;&amp; model,
 			const Gtk::TreeModel::Path&amp; path, bool path_currently_selected);
 

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/mainWindow.cc	2005-12-29 14:09:35 UTC (rev 29)
@@ -44,6 +44,7 @@
 #include &quot;XapianEngine.h&quot;
 #include &quot;config.h&quot;
 #include &quot;NLS.h&quot;
+#include &quot;IndexPage.h&quot;
 #include &quot;PinotUtils.h&quot;
 #include &quot;mainWindow.hh&quot;
 #include &quot;aboutDialog.hh&quot;
@@ -126,9 +127,10 @@
 mainWindow::mainWindow() :
 	m_settings(PinotSettings::getInstance()), mainWindow_glade(),
 	m_pEnginesTree(NULL),
-	m_pResultsTree(NULL),
+	m_pNotebook(NULL),
 	m_pIndexMenu(NULL),
-	m_pLabelsMenu(NULL)
+	m_pLabelsMenu(NULL),
+	m_pHtmlView(NULL)
 {
 	// Reposition and resize the window
 	// Make sure the coordinates and sizes make sense
@@ -178,28 +180,24 @@
 	// Populate
 	populate_queryTreeview();
 
-	// Position the results tree
-	m_pResultsTree = manage(new ResultsTree(resultsVbox, resultsMenuitem-&gt;get_submenu(), m_settings));
-	// Connect to the &quot;changed&quot; signal
-	m_pResultsTree-&gt;get_selection()-&gt;signal_changed().connect(SigC::slot(*this,
-		&amp;mainWindow::on_resultsTreeviewSelection_changed));
-
 	// Populate the index menu
 	populate_indexMenu();
 
-	// Add an HTML renderer in the View tab
-	m_pHtmlView = new HtmlView(viewVbox, NULL);
-	if (m_settings.m_browseResults == true)
+	// Create a notebook, without any page initially
+	m_pNotebook = manage(new Notebook());
+	m_pNotebook-&gt;set_flags(Gtk::CAN_FOCUS);
+	m_pNotebook-&gt;set_show_tabs(true);
+	m_pNotebook-&gt;set_show_border(true);
+	m_pNotebook-&gt;set_tab_pos(Gtk::POS_TOP);
+	m_pNotebook-&gt;set_scrollable(false);
+	rightVbox-&gt;pack_start(*m_pNotebook, Gtk::PACK_EXPAND_WIDGET, 4);
+	m_pNotebook-&gt;signal_switch_page().connect(
+		SigC::slot(*this, &amp;mainWindow::on_switch_page), false);
+
+	// Create an HTML renderer
+	m_pHtmlView = new HtmlView(NULL);
+	if (m_settings.m_browseResults == false)
 	{
-		// Hide this tab
-		Widget *pPage = mainNotebook-&gt;get_nth_page(1);
-		if (pPage != NULL)
-		{
-			pPage-&gt;hide();
-		}
-	}
-	else
-	{
 		view_document(&quot;<A HREF="file:///usr/share/pinot/index.html">file:///usr/share/pinot/index.html</A>&quot;, true);
 	}
 
@@ -208,6 +206,8 @@
 	removeQueryButton-&gt;set_sensitive(false);
 	findQueryButton-&gt;set_sensitive(false);
 	clearresults1-&gt;set_sensitive(false);
+	showextract1-&gt;set_sensitive(false);
+	groupresults1-&gt;set_sensitive(false);
 	viewresults1-&gt;set_sensitive(false);
 	// Hide the View Cache menu item ?
 	if (SearchEngineFactory::isSupported(&quot;googleapi&quot;) == false)
@@ -256,6 +256,7 @@
 
 	// Now we are ready
 	set_status(_(&quot;Ready&quot;));
+	m_pNotebook-&gt;show();
 	show();
 }
 
@@ -272,15 +273,12 @@
 		for_each(m_state.m_pThreads.begin(), m_state.m_pThreads.end(), DeleteSetPointer());
 	}
 
-	// This is a hack to avoid segfaults when the View tab hasn't been made visible
-	Widget *pPage = mainNotebook-&gt;get_nth_page(1);
-	if (pPage != NULL)
+	// Stop in case we were loading a page
+	NotebookPageBox *pNotebookPage = get_page(_(&quot;View&quot;), NotebookPageBox::VIEW_PAGE);
+	if (pNotebookPage != NULL)
 	{
-		pPage-&gt;show();
+		m_pHtmlView-&gt;stop();
 	}
-	mainNotebook-&gt;set_current_page(1);
-	// Stop if we were loading a page
-	m_pHtmlView-&gt;stop();
 	delete m_pHtmlView;
 }
 
@@ -449,11 +447,31 @@
 //
 // Results tree selection changed
 //
-void mainWindow::on_resultsTreeviewSelection_changed()
+void mainWindow::on_resultsTreeviewSelection_changed(ustring queryName)
 {
-	if (m_pResultsTree-&gt;onSelectionChanged() == true)
+	ustring url;
+	bool hasSelection = false;
+
+	NotebookPageBox *pNotebookPage = get_page(queryName, NotebookPageBox::RESULTS_PAGE);
+	if (pNotebookPage != NULL)
 	{
-		ustring url = m_pResultsTree-&gt;getFirstSelectionURL();
+		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+		if (pResultsPage != NULL)
+		{
+			ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+			if (pResultsTree != NULL)
+			{
+				hasSelection = pResultsTree-&gt;checkSelection();
+				if (hasSelection == true)
+				{
+					url = pResultsTree-&gt;getFirstSelectionURL();
+				}
+			}
+		}
+	}
+
+	if (hasSelection == true)
+	{
 		bool isViewable = true, isIndexable = true, isCached = false;
 
 		Url urlObj(locale_from_utf8(url));
@@ -502,7 +520,7 @@
 {
 	vector&lt;IndexedDocument&gt; documentsList;
 
-	IndexPage *pIndexPage = get_index_page(indexName);
+	IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(indexName, NotebookPageBox::INDEX_PAGE));
 	if (pIndexPage == NULL)
 	{
 		return;
@@ -560,7 +578,7 @@
 #endif
 
 	// Is there already a page for this index ?
-	pIndexPage = get_index_page(indexName);
+	pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(indexName, NotebookPageBox::INDEX_PAGE));
 	if (pIndexPage != NULL)
 	{
 		// Force a refresh
@@ -574,13 +592,12 @@
 		foundPage = true;
 	}
 
-	if ((foundPage == false) &amp;&amp;
-		(m_state.writeLock(1) == true))
+	if (foundPage == false)
 	{
 		NotebookTabBox *pTab = manage(new NotebookTabBox(indexName,
-			NotebookTabBox::INDEX_PAGE));
+			NotebookPageBox::INDEX_PAGE));
 		pTab-&gt;getCloseSignal().connect(
-			SigC::slot(*this, &amp;mainWindow::on_page_closed));
+			SigC::slot(*this, &amp;mainWindow::on_close_page));
 
 		// Position the index tree
 		pIndexTree = manage(new IndexTree(indexName, indexMenuitem-&gt;get_submenu(), m_settings));
@@ -599,14 +616,19 @@
 			SigC::slot(*this, &amp;mainWindow::on_indexBackButton_clicked));
 		pIndexPage-&gt;getForwardClickedSignal().connect(
 			SigC::slot(*this, &amp;mainWindow::on_indexForwardButton_clicked));
-		int pageNum = mainNotebook-&gt;append_page(*pIndexPage, *pTab);
-		if (pageNum &gt;= 0)
+
+		// Append the page
+		if (m_state.writeLock(1) == true)
 		{
-			// Add this page to the list
-			foundPage = true;
+			int pageNum = m_pNotebook-&gt;append_page(*pIndexPage, *pTab);
+			m_pNotebook-&gt;pages().back().set_tab_label_packing(false, true, Gtk::PACK_START);
+			if (pageNum &gt;= 0)
+			{
+				foundPage = true;
+			}
+
+			m_state.unlock();
 		}
-
-		m_state.unlock();
 	}
 
 	if (foundPage == true)
@@ -620,7 +642,7 @@
 //
 void mainWindow::on_label_changed(ustring indexName, ustring labelName)
 {
-	IndexPage *pIndexPage = get_index_page(indexName);
+	IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(indexName, NotebookPageBox::INDEX_PAGE));
 	if (pIndexPage == NULL)
 	{
 		return;
@@ -647,25 +669,52 @@
 }
 
 //
-// Notebook page closed
+// Notebook page switch
 //
-void mainWindow::on_page_closed(ustring title, NotebookTabBox::PageType type)
+void mainWindow::on_switch_page(GtkNotebookPage *p0, guint p1)
 {
-	if (type != NotebookTabBox::INDEX_PAGE)
+#ifdef DEBUG
+	cout &lt;&lt; &quot;mainWindow::on_switch_page: switched to page &quot; &lt;&lt; p1 &lt;&lt; endl;
+#endif
+	if (m_state.m_currentPage != (int)p1)
 	{
-		return;
+		// Disable the widgets that depend on what page is selected
+		// Results
+		clearresults1-&gt;set_sensitive(false);
+		showextract1-&gt;set_sensitive(false);
+		groupresults1-&gt;set_sensitive(false);
+		viewresults1-&gt;set_sensitive(false);
+		viewcache1-&gt;set_sensitive(false);
+		indexresults1-&gt;set_sensitive(false);
+		// Index
+		viewfromindex1-&gt;set_sensitive(false);
+		refreshindex1-&gt;set_sensitive(false);
+		showfromindex1-&gt;set_sensitive(false);
+		unindex1-&gt;set_sensitive(false);
 	}
+	m_state.m_currentPage = (int)p1;
+}
 
+//
+// Notebook page closed
+//
+void mainWindow::on_close_page(ustring title, NotebookPageBox::PageType type)
+{
 #ifdef DEBUG
-	cout &lt;&lt; &quot;mainWindow::on_page_closed: called for tab &quot; &lt;&lt; title &lt;&lt; endl;
+	cout &lt;&lt; &quot;mainWindow::on_close_page: called for tab &quot; &lt;&lt; title &lt;&lt; endl;
 #endif
-	int pageNum = get_index_page_number(title);
+	int pageNum = get_page_number(title, type);
 	if (pageNum &gt;= 0)
 	{
+		if (type == NotebookPageBox::VIEW_PAGE)
+		{
+			m_pHtmlView-&gt;stop();
+		}
+
 		if (m_state.writeLock(2) == true)
 		{
 			// Remove the page
-			mainNotebook-&gt;remove_page(pageNum);
+			m_pNotebook-&gt;remove_page(pageNum);
 
 			m_state.unlock();
 		}
@@ -749,7 +798,7 @@
 		ustring indexName = locale_to_utf8(pBrowseThread-&gt;getIndexName());
 
 		// Find the page for this index
-		pIndexPage = get_index_page(indexName);
+		pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(indexName, NotebookPageBox::INDEX_PAGE));
 		if (pIndexPage == NULL)
 		{
 			// It's probably been closed by the user
@@ -793,6 +842,7 @@
 		unsigned int count = 0;
 		ResultsModelColumns::ResultType rootType;
 		bool mergeDuplicates = false;
+		int pageNum = -1;
 
 		QueryingThread *pQueryThread = dynamic_cast&lt;QueryingThread *&gt;(pThread);
 		if (pQueryThread == NULL)
@@ -802,51 +852,93 @@
 		}
 
 		QueryProperties queryProps = pQueryThread-&gt;getQuery();
-		string queryName = queryProps.getName();
-		string engineName = pQueryThread-&gt;getEngineName();
+		ustring queryName = to_utf8(queryProps.getName());
+		ustring engineName = to_utf8(pQueryThread-&gt;getEngineName());
+		const vector&lt;Result&gt; &amp;resultsList = pQueryThread-&gt;getResults();
 
 		status = _(&quot;Query&quot;);
 		status += &quot; &quot;;
-		status += to_utf8(queryName);
+		status += queryName;
 		status += &quot; &quot;;
 		status += _(&quot;on&quot;);
 		status += &quot; &quot;;
-		status += to_utf8(engineName);
+		status += engineName;
 		status += &quot; &quot;;
 		status += _(&quot;ended&quot;);
 		set_status(status);
 
-		// Switch to the results page
-		mainNotebook-&gt;set_current_page(0);
+		// Find the page for this query
+		ResultsTree *pResultsTree = NULL;
+		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(get_page(queryName, NotebookPageBox::RESULTS_PAGE));
+		if (pResultsPage != NULL)
+		{
+			pResultsTree = pResultsPage-&gt;getTree();
+			if (pResultsTree == NULL)
+			{
+				return;
+			}
+			pageNum = get_page_number(queryName, NotebookPageBox::RESULTS_PAGE);
+		}
+		else
+		{
+			// There is none, create one
+			NotebookTabBox *pTab = manage(new NotebookTabBox(queryName,
+				NotebookPageBox::RESULTS_PAGE));
+			pTab-&gt;getCloseSignal().connect(
+				SigC::slot(*this, &amp;mainWindow::on_close_page));
 
-		// Add these results to the tree
-		const vector&lt;Result&gt; &amp;resultsList = pQueryThread-&gt;getResults();
-		if (m_pResultsTree-&gt;addResults(queryProps, engineName,
-			resultsList, searchenginegroup1-&gt;get_active()) == true)
+			// Position the results tree
+			pResultsTree = manage(new ResultsTree(queryName, resultsMenuitem-&gt;get_submenu(), m_settings));
+			pResultsPage = manage(new ResultsPage(queryName, pResultsTree, m_settings));
+			// Connect to the &quot;changed&quot; signal
+			pResultsTree-&gt;getSelectionChangedSignal().connect(
+				SigC::slot(*this, &amp;mainWindow::on_resultsTreeviewSelection_changed));
+
+			// Append the page
+			if (m_state.writeLock(1) == true)
+			{
+				pageNum = m_pNotebook-&gt;append_page(*pResultsPage, *pTab);
+				m_pNotebook-&gt;pages().back().set_tab_label_packing(false, true, Gtk::PACK_START);
+
+				m_state.unlock();
+			}
+		}
+
+		if (pageNum &gt;= 0)
 		{
+			// Switch to that page
+			m_pNotebook-&gt;set_current_page(pageNum);
+
+			// Add the results to the tree
+			if (pResultsTree-&gt;addResults(queryProps, engineName,
+				resultsList, searchenginegroup1-&gt;get_active()) == true)
+			{
 #ifdef DEBUG
-			cout &lt;&lt; &quot;mainWindow::on_thread_end: added results&quot; &lt;&lt; endl;
+				cout &lt;&lt; &quot;mainWindow::on_thread_end: added results&quot; &lt;&lt; endl;
 #endif
-			// Enable results clearing
-			clearresults1-&gt;set_sensitive(true);
+				// Enable some menuitems
+				clearresults1-&gt;set_sensitive(true);
+				showextract1-&gt;set_sensitive(false);
+				groupresults1-&gt;set_sensitive(false);
+			}
+		}
 
-			// Index results ?
-			if ((queryProps.getIndexResults() == true) &amp;&amp;
-				(resultsList.empty() == false))
-			{
-				string labelName = queryProps.getLabelName();
+		// Index results ?
+		if ((queryProps.getIndexResults() == true) &amp;&amp;
+			(resultsList.empty() == false))
+		{
+			string labelName = queryProps.getLabelName();
 
 #ifdef DEBUG
-				cout &lt;&lt; &quot;mainWindow::on_thread_end: indexing results, with label &quot; &lt;&lt; labelName &lt;&lt; endl;
+			cout &lt;&lt; &quot;mainWindow::on_thread_end: indexing results, with label &quot; &lt;&lt; labelName &lt;&lt; endl;
 #endif
-				for (vector&lt;Result&gt;::const_iterator resultIter = resultsList.begin();
-					resultIter != resultsList.end(); ++resultIter)
-				{
-					// Queue this action
-					queue_index(DocumentInfo(resultIter-&gt;getTitle(), resultIter-&gt;getLocation(),
-						resultIter-&gt;getType(), resultIter-&gt;getLanguage()),
-						labelName);
-				}
+			for (vector&lt;Result&gt;::const_iterator resultIter = resultsList.begin();
+				resultIter != resultsList.end(); ++resultIter)
+			{
+				// Queue this action
+				queue_index(DocumentInfo(resultIter-&gt;getTitle(), resultIter-&gt;getLocation(),
+					resultIter-&gt;getType(), resultIter-&gt;getLanguage()),
+					labelName);
 			}
 		}
 	}
@@ -860,7 +952,7 @@
 		}
 		ustring indexName = locale_to_utf8(pLabelQueryThread-&gt;getIndexName());
 
-		IndexPage *pIndexPage = get_index_page(indexName);
+		IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(indexName, NotebookPageBox::INDEX_PAGE));
 		if (pIndexPage == NULL)
 		{
 			return;
@@ -908,7 +1000,7 @@
 					pIndexTree-&gt;setLabel(documentsList);
 
 					// Switch to the index page
-					mainNotebook-&gt;set_current_page(get_index_page_number(indexName));
+					m_pNotebook-&gt;set_current_page(get_page_number(indexName, NotebookPageBox::INDEX_PAGE));
 					break;
 				}
 			}
@@ -948,13 +1040,21 @@
 				// Make sure settings haven't changed in the meantime
 				if (m_settings.m_browseResults == false)
 				{
-					// Display the URL in the View tab
-					mainNotebook-&gt;set_current_page(1);
-					if (m_pHtmlView-&gt;renderData(pData, dataLength, url) == true)
+					ustring viewName = _(&quot;View&quot;);
+
+					// Is there still a view page ?
+					int pageNum = get_page_number(viewName, NotebookPageBox::VIEW_PAGE);
+					if (pageNum &gt;= 0)
 					{
-						//viewstop1-&gt;set_sensitive(true);
+						// Display the URL in the View tab
+						if (m_pHtmlView-&gt;renderData(pData, dataLength, url) == true)
+						{
+							//viewstop1-&gt;set_sensitive(true);
+							set_status(locale_to_utf8(url));
+						}
+
+						m_pNotebook-&gt;set_current_page(pageNum);
 					}
-					set_status(locale_to_utf8(url));
 				}
 			}
 		}
@@ -1000,7 +1100,7 @@
 			}
 
 			// Is the index still being shown ?
-			IndexPage *pIndexPage = get_index_page(_(&quot;My Documents&quot;));
+			IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(_(&quot;My Documents&quot;), NotebookPageBox::INDEX_PAGE));
 			if (pIndexPage != NULL)
 			{
 				IndexTree *pIndexTree = pIndexPage-&gt;getTree();
@@ -1071,7 +1171,7 @@
 			return;
 		}
 
-		IndexPage *pIndexPage = get_index_page(_(&quot;My Documents&quot;));
+		IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(_(&quot;My Documents&quot;), NotebookPageBox::INDEX_PAGE));
 		if (pIndexPage != NULL)
 		{
 			IndexTree *pIndexTree = pIndexPage-&gt;getTree();
@@ -1199,7 +1299,7 @@
 	bool hasLabel = false;
 
 	// Find the page for this index
-	pIndexPage = get_index_page(locale_to_utf8(indexName));
+	pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(locale_to_utf8(indexName), NotebookPageBox::INDEX_PAGE));
 	if (pIndexPage == NULL)
 	{
 		// It's probably been closed by the user
@@ -1288,9 +1388,9 @@
 
 	if (m_state.readLock(5) == true)
 	{
-		for (int pageNum = 0; pageNum &lt; mainNotebook-&gt;get_n_pages(); ++pageNum)
+		for (int pageNum = 0; pageNum &lt; m_pNotebook-&gt;get_n_pages(); ++pageNum)
 		{
-			Widget *pPage = mainNotebook-&gt;get_nth_page(pageNum);
+			Widget *pPage = m_pNotebook-&gt;get_nth_page(pageNum);
 			if (pPage != NULL)
 			{
 				IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(pPage);
@@ -1314,22 +1414,10 @@
 	// Do the changes affect the View tab ?
 	if (useExternalBrowser != m_settings.m_browseResults)
 	{
-		int nCurrentPage = mainNotebook-&gt;get_current_page();
-		Widget *pPage = mainNotebook-&gt;get_nth_page(1);
-		if (pPage != NULL)
+		// Close the existing view page ?
+		if (m_settings.m_browseResults == true)
 		{
-			// Hide or show ?
-			if (m_settings.m_browseResults == true)
-			{
-				pPage-&gt;hide();
-			}
-			else
-			{
-				pPage-&gt;show();
-
-				// Make sure we show the same tab
-				mainNotebook-&gt;set_current_page(nCurrentPage);
-			}
+			on_close_page(_(&quot;View&quot;), NotebookPageBox::VIEW_PAGE);
 		}
 	}
 
@@ -1391,38 +1479,44 @@
 		// Copy only the query name, not the summary
 		text = row[m_queryColumns.m_name];
 	}
-	else if (m_pResultsTree-&gt;is_focus() == true)
+	else
 	{
-		vector&lt;Result&gt; resultsList;
-		bool firstItem = true;
+		// The focus may be on one of the notebook pages
+		NotebookPageBox *pNotebookPage = get_page_with_focus();
+		if (pNotebookPage != NULL)
+		{
+			ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+			if (pResultsPage != NULL)
+			{
+				vector&lt;Result&gt; resultsList;
+				bool firstItem = true;
 
 #ifdef DEBUG
-		cout &lt;&lt; &quot;mainWindow::on_copy_activate: results tree&quot; &lt;&lt; endl;
+				cout &lt;&lt; &quot;mainWindow::on_copy_activate: results tree&quot; &lt;&lt; endl;
 #endif
-		// Get the current results selection
-		m_pResultsTree-&gt;getSelection(resultsList);
-	
-		for (vector&lt;Result&gt;::const_iterator resultIter = resultsList.begin();
-			resultIter != resultsList.end(); ++resultIter)
-		{
-			if (firstItem == false)
-			{
-				text += &quot;\n&quot;;
+				ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+				if (pResultsTree != NULL)
+				{
+					// Get the current results selection
+					pResultsTree-&gt;getSelection(resultsList);
+				}
+
+				for (vector&lt;Result&gt;::const_iterator resultIter = resultsList.begin();
+					resultIter != resultsList.end(); ++resultIter)
+				{
+					if (firstItem == false)
+					{
+						text += &quot;\n&quot;;
+					}
+					text += resultIter-&gt;getTitle();
+					text += &quot; &quot;;
+					text += resultIter-&gt;getLocation();
+					firstItem = false;
+				}
 			}
-			text += resultIter-&gt;getTitle();
-			text += &quot; &quot;;
-			text += resultIter-&gt;getLocation();
-			firstItem = false;
-		}
-	}
-	else
-	{
-		// The focus may be on one of the index tabs
-		IndexPage *pIndexPage = get_index_page_with_focus(true);
-		if (pIndexPage != NULL)
-		{
-			IndexTree *pIndexTree = pIndexPage-&gt;getTree();
-			if (pIndexTree != NULL)
+
+			IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(pNotebookPage);
+			if (pIndexPage != NULL)
 			{
 				vector&lt;IndexedDocument&gt; documentsList;
 				bool firstItem = true;
@@ -1430,8 +1524,12 @@
 #ifdef DEBUG
 				cout &lt;&lt; &quot;mainWindow::on_copy_activate: index tree&quot; &lt;&lt; endl;
 #endif
-				// Get the current documents selection
-				pIndexTree-&gt;getSelection(documentsList);
+				IndexTree *pIndexTree = pIndexPage-&gt;getTree();
+				if (pIndexTree != NULL)
+				{
+					// Get the current documents selection
+					pIndexTree-&gt;getSelection(documentsList);
+				}
 
 				for (vector&lt;IndexedDocument&gt;::const_iterator docIter = documentsList.begin();
 					docIter != documentsList.end(); ++docIter)
@@ -1511,15 +1609,25 @@
 	{
 		liveQueryEntry-&gt;delete_selection();
 	}
-	else if (m_pResultsTree-&gt;is_focus() == true)
+	else
 	{
+		NotebookPageBox *pNotebookPage = get_page_with_focus();
+		if (pNotebookPage != NULL)
+		{
+			ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+			if (pResultsPage != NULL)
+			{
 #ifdef DEBUG
-		cout &lt;&lt; &quot;mainWindow::on_delete_activate: results tree&quot; &lt;&lt; endl;
+				cout &lt;&lt; &quot;mainWindow::on_delete_activate: results tree&quot; &lt;&lt; endl;
 #endif
-		if (m_pResultsTree-&gt;deleteSelection() == true)
-		{
-			// The results tree is now empty
-			clearresults1-&gt;set_sensitive(false);
+				ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+				if ((pResultsTree != NULL) &amp;&amp;
+					(pResultsTree-&gt;deleteSelection() == true))
+				{
+					// The results tree is now empty
+					clearresults1-&gt;set_sensitive(false);
+				}
+			}
 		}
 	}
 	// Nothing else can be deleted
@@ -1530,8 +1638,20 @@
 //
 void mainWindow::on_clearresults_activate()
 {
-	m_pResultsTree-&gt;clear();
-	clearresults1-&gt;set_sensitive(false);
+	NotebookPageBox *pNotebookPage = get_page_with_focus();
+	if (pNotebookPage != NULL)
+	{
+		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+		if (pResultsPage != NULL)
+		{
+			ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+			if (pResultsTree != NULL)
+			{
+				pResultsTree-&gt;clear();
+				clearresults1-&gt;set_sensitive(false);
+			}
+		}
+	}
 }
 
 //
@@ -1539,10 +1659,19 @@
 //
 void mainWindow::on_showextract_activate()
 {
-#ifdef DEBUG
-	cout &lt;&lt; &quot;mainWindow::on_showextract_activate: called&quot; &lt;&lt; endl;
-#endif
-	m_pResultsTree-&gt;showExtract(showextract1-&gt;get_active());
+	NotebookPageBox *pNotebookPage = get_page_with_focus();
+	if (pNotebookPage != NULL)
+	{
+		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+		if (pResultsPage != NULL)
+		{
+			ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+			if (pResultsTree != NULL)
+			{
+				pResultsTree-&gt;showExtract(showextract1-&gt;get_active());
+			}
+		}
+	}
 }
 
 //
@@ -1552,11 +1681,20 @@
 {
 	ResultsModelColumns::ResultType currentType, newType;
 
-#ifdef DEBUG
-	cout &lt;&lt; &quot;mainWindow::on_groupresults_activate: called&quot; &lt;&lt; endl;
-#endif
 	// What's the new grouping criteria ?
-	m_pResultsTree-&gt;regroupResults(searchenginegroup1-&gt;get_active());
+	NotebookPageBox *pNotebookPage = get_page_with_focus();
+	if (pNotebookPage != NULL)
+	{
+		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+		if (pResultsPage != NULL)
+		{
+			ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+			if (pResultsTree != NULL)
+			{
+				pResultsTree-&gt;regroupResults(searchenginegroup1-&gt;get_active());
+			}
+		}
+	}
 }
 
 //
@@ -1564,11 +1702,23 @@
 //
 void mainWindow::on_viewresults_activate()
 {
-	ustring url = m_pResultsTree-&gt;getFirstSelectionURL();
-	if (view_document(locale_from_utf8(url)) == true)
+	NotebookPageBox *pNotebookPage = get_page_with_focus();
+	if (pNotebookPage != NULL)
 	{
-		// We can update the row right now
-		m_pResultsTree-&gt;setFirstSelectionViewedState(true);
+		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+		if (pResultsPage != NULL)
+		{
+			ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+			if (pResultsTree != NULL)
+			{
+				ustring url = pResultsTree-&gt;getFirstSelectionURL();
+				if (view_document(locale_from_utf8(url)) == true)
+				{
+					// We can update the row right now
+					pResultsTree-&gt;setFirstSelectionViewedState(true);
+				}
+			}
+		}
 	}
 }
 
@@ -1577,12 +1727,24 @@
 //
 void mainWindow::on_viewcache_activate()
 {
-	ustring url = m_pResultsTree-&gt;getFirstSelectionURL();
+	NotebookPageBox *pNotebookPage = get_page_with_focus();
+	if (pNotebookPage != NULL)
+	{
+		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+		if (pResultsPage != NULL)
+		{
+			ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+			if (pResultsTree != NULL)
+			{
+				ustring url = pResultsTree-&gt;getFirstSelectionURL();
 
-	start_thread(new DownloadingThread(url, true));
+				start_thread(new DownloadingThread(url, true));
 
-	// Update the row now, even though the cached page may not be retrieved
-	m_pResultsTree-&gt;setFirstSelectionViewedState(true);
+				// Update the row now, even though the cached page may not be retrieved
+				pResultsTree-&gt;setFirstSelectionViewedState(true);
+			}
+		}
+	}
 }
 
 //
@@ -1590,6 +1752,8 @@
 //
 void mainWindow::on_indexresults_activate()
 {
+	vector&lt;Result&gt; resultsList;
+
 	// Make sure this has been configured
 	if (m_settings.m_indexLocation.empty() == true)
 	{
@@ -1597,8 +1761,19 @@
 		return;
 	}
 
-	vector&lt;Result&gt; resultsList;
-	m_pResultsTree-&gt;getSelection(resultsList);
+	NotebookPageBox *pNotebookPage = get_page_with_focus();
+	if (pNotebookPage != NULL)
+	{
+		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+		if (pResultsPage != NULL)
+		{
+			ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+			if (pResultsTree != NULL)
+			{
+				pResultsTree-&gt;getSelection(resultsList);
+			}
+		}
+	}
 
 	// Go through selected results
 	for (vector&lt;Result&gt;::const_iterator resultIter = resultsList.begin();
@@ -1639,7 +1814,7 @@
 //
 void mainWindow::on_viewfromindex_activate()
 {
-	IndexPage *pIndexPage = get_index_page_with_focus(false);
+	IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page_with_focus());
 	if (pIndexPage != NULL)
 	{
 		IndexTree *pIndexTree = pIndexPage-&gt;getTree();
@@ -1668,7 +1843,7 @@
 	}
 
 	// Get the current documents selection
-	IndexPage *pIndexPage = get_index_page_with_focus(false);
+	IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page_with_focus());
 	if (pIndexPage != NULL)
 	{
 		IndexTree *pIndexTree = pIndexPage-&gt;getTree();
@@ -1725,11 +1900,14 @@
 	int width, height;
 	bool matchedLabel = false, editTitle = false;
 
+#ifdef DEBUG
+	cout &lt;&lt; &quot;mainWindow::on_showfromindex_activate: called&quot; &lt;&lt; endl;
+#endif
 	IndexTree *pIndexTree = NULL;
-	IndexPage *pIndexPage = get_index_page_with_focus(false);
+	IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page_with_focus());
 	if (pIndexPage != NULL)
 	{
-		indexName = locale_from_utf8(pIndexPage-&gt;getIndexName());
+		indexName = locale_from_utf8(pIndexPage-&gt;getTitle());
 		labelName = locale_from_utf8(pIndexPage-&gt;getLabelName());
 		pIndexTree = pIndexPage-&gt;getTree();
 	}
@@ -1857,7 +2035,7 @@
 	ustring boxTitle = _(&quot;Delete this document from the index ?&quot;);
 
 	IndexTree *pIndexTree = NULL;
-	IndexPage *pIndexPage = get_index_page_with_focus(false);
+	IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page_with_focus());
 	if (pIndexPage != NULL)
 	{
 		pIndexTree = pIndexPage-&gt;getTree();
@@ -2143,7 +2321,7 @@
 //
 void mainWindow::on_indexBackButton_clicked(ustring indexName)
 {
-	IndexPage *pIndexPage = get_index_page(indexName);
+	IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(indexName, NotebookPageBox::INDEX_PAGE));
 	if (pIndexPage != NULL)
 	{
 		if (pIndexPage-&gt;getFirstDocument() &gt;= m_maxDocsCount)
@@ -2159,7 +2337,7 @@
 //
 void mainWindow::on_indexForwardButton_clicked(ustring indexName)
 {
-	IndexPage *pIndexPage = get_index_page(indexName);
+	IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(indexName, NotebookPageBox::INDEX_PAGE));
 	if (pIndexPage != NULL)
 	{
 		if (pIndexPage-&gt;getDocumentsCount() == 0)
@@ -2190,31 +2368,6 @@
 }
 
 //
-// Notebook page switch
-//
-void mainWindow::on_mainNotebook_switch_page(GtkNotebookPage *p0, guint p1)
-{
-#ifdef DEBUG
-	cout &lt;&lt; &quot;mainWindow::on_mainNotebook_switch_page: switched to page &quot; &lt;&lt; p1 &lt;&lt; endl;
-#endif
-	if (m_state.m_currentPage != (int)p1)
-	{
-		// Disable the widgets that depend on what page is selected
-		// Results
-		clearresults1-&gt;set_sensitive(false);
-		viewresults1-&gt;set_sensitive(false);
-		viewcache1-&gt;set_sensitive(false);
-		indexresults1-&gt;set_sensitive(false);
-		// Index
-		viewfromindex1-&gt;set_sensitive(false);
-		refreshindex1-&gt;set_sensitive(false);
-		showfromindex1-&gt;set_sensitive(false);
-		unindex1-&gt;set_sensitive(false);
-	}
-	m_state.m_currentPage = (int)p1;
-}
-
-//
 // Main window deleted
 //
 bool mainWindow::on_mainWindow_delete_event(GdkEventAny *ev)
@@ -2263,79 +2416,56 @@
 }
 
 //
-// Returns the IndexPage for the index that has the focus.
+// Returns the page that has the focus.
 //
-IndexPage *mainWindow::get_index_page_with_focus(bool checkTree)
+NotebookPageBox *mainWindow::get_page_with_focus(void)
 {
-	IndexPage *pIndexPage = NULL;
+	NotebookPageBox *pNotebookPage = NULL;
 
 	if (m_state.readLock(7) == true)
 	{
-		for (int pageNum = 0; pageNum &lt; mainNotebook-&gt;get_n_pages(); ++pageNum)
+		if (m_state.m_currentPage &gt;= 0)
 		{
-			Widget *pPage = mainNotebook-&gt;get_nth_page(pageNum);
+			Widget *pPage = m_pNotebook-&gt;get_nth_page(m_state.m_currentPage);
 			if (pPage != NULL)
 			{
-				pIndexPage = dynamic_cast&lt;IndexPage*&gt;(pPage);
-				if (pIndexPage != NULL)
-				{
-#ifdef DEBUG
-					cout &lt;&lt; &quot;mainWindow::get_index_page_with_focus: &quot; &lt;&lt; pIndexPage-&gt;getIndexName() &lt;&lt; endl;
-#endif
-					if (checkTree == false)
-					{
-						if (pIndexPage-&gt;is_focus() == true)
-						{
-							break;
-						}
-					}
-					else
-					{
-						IndexTree *pIndexTree = pIndexPage-&gt;getTree();
-						if ((pIndexTree != NULL) &amp;&amp;
-							(pIndexTree-&gt;is_focus() == true))
-						{
-							break;
-						}
-					}
-					pIndexPage = NULL;
-				}
+				pNotebookPage = dynamic_cast&lt;NotebookPageBox*&gt;(pPage);
 			}
 		}
 
 		m_state.unlock();
 	}
 
-	return pIndexPage;
+	return pNotebookPage;
 }
 
 //
-// Returns the IndexPage for the given index.
+// Returns the page with the given title.
 //
-IndexPage *mainWindow::get_index_page(const ustring &amp;indexName)
+NotebookPageBox *mainWindow::get_page(const ustring &amp;title, NotebookPageBox::PageType type)
 {
-	IndexPage *pIndexPage = NULL;
+	NotebookPageBox *pNotebookPage = NULL;
 
 	if (m_state.readLock(8) == true)
 	{
-		for (int pageNum = 0; pageNum &lt; mainNotebook-&gt;get_n_pages(); ++pageNum)
+		for (int pageNum = 0; pageNum &lt; m_pNotebook-&gt;get_n_pages(); ++pageNum)
 		{
-			Widget *pPage = mainNotebook-&gt;get_nth_page(pageNum);
+			Widget *pPage = m_pNotebook-&gt;get_nth_page(pageNum);
 			if (pPage != NULL)
 			{
-				pIndexPage = dynamic_cast&lt;IndexPage*&gt;(pPage);
-				if (pIndexPage != NULL)
+				pNotebookPage = dynamic_cast&lt;NotebookPageBox*&gt;(pPage);
+				if (pNotebookPage != NULL)
 				{
 #ifdef DEBUG
-					cout &lt;&lt; &quot;mainWindow::get_index_page: &quot; &lt;&lt; pIndexPage-&gt;getIndexName() &lt;&lt; endl;
+					cout &lt;&lt; &quot;mainWindow::get_page: &quot; &lt;&lt; pNotebookPage-&gt;getTitle() &lt;&lt; endl;
 #endif
-					// It's an index page, check the name of the index
-					if (indexName == pIndexPage-&gt;getIndexName())
+					if ((title == pNotebookPage-&gt;getTitle()) &amp;&amp;
+						(type == pNotebookPage-&gt;getType()))
 					{
 						// That's the page we are looking for
 						break;
 					}
-					pIndexPage = NULL;
+					pNotebookPage = NULL;
 				}
 			}
 		}
@@ -2343,31 +2473,31 @@
 		m_state.unlock();
 	}
 
-	return pIndexPage;
+	return pNotebookPage;
 }
 
 //
-// Returns the page number for the given index.
+// Returns the page number with the given title.
 //
-int mainWindow::get_index_page_number(const ustring &amp;indexName)
+int mainWindow::get_page_number(const ustring &amp;title, NotebookPageBox::PageType type)
 {
 	int pageNumber = -1;
 
 	if (m_state.readLock(9) == true)
 	{
-		for (int pageNum = 0; pageNum &lt; mainNotebook-&gt;get_n_pages(); ++pageNum)
+		for (int pageNum = 0; pageNum &lt; m_pNotebook-&gt;get_n_pages(); ++pageNum)
 		{
-			Widget *pPage = mainNotebook-&gt;get_nth_page(pageNum);
+			Widget *pPage = m_pNotebook-&gt;get_nth_page(pageNum);
 			if (pPage != NULL)
 			{
-				IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(pPage);
-				if (pIndexPage != NULL)
+				NotebookPageBox *pNotebookPage = dynamic_cast&lt;NotebookPageBox*&gt;(pPage);
+				if (pNotebookPage != NULL)
 				{
 #ifdef DEBUG
-					cout &lt;&lt; &quot;mainWindow::get_index_page_number: &quot; &lt;&lt; pIndexPage-&gt;getIndexName() &lt;&lt; endl;
+					cout &lt;&lt; &quot;mainWindow::get_page_number: &quot; &lt;&lt; pNotebookPage-&gt;getTitle() &lt;&lt; endl;
 #endif
-					// It's an index page, check the name of the index
-					if (indexName == pIndexPage-&gt;getIndexName())
+					if ((title == pNotebookPage-&gt;getTitle()) &amp;&amp;
+						(type == pNotebookPage-&gt;getType()))
 					{
 						// That's the page we are looking for
 						pageNumber = pageNum;
@@ -2668,7 +2798,7 @@
 	}
 	m_state.m_browsingIndex = true;
 
-	IndexPage *pIndexPage = get_index_page(indexName);
+	IndexPage *pIndexPage = dynamic_cast&lt;IndexPage*&gt;(get_page(indexName, NotebookPageBox::INDEX_PAGE));
 	if (pIndexPage != NULL)
 	{
 		IndexTree *pIndexTree = pIndexPage-&gt;getTree();
@@ -2681,7 +2811,7 @@
 		pIndexPage-&gt;setDocumentsCount(0);
 
 		// Switch to that index page
-		mainNotebook-&gt;set_current_page(get_index_page_number(indexName));
+		m_pNotebook-&gt;set_current_page(get_page_number(indexName, NotebookPageBox::INDEX_PAGE));
 	}
 
 	if (indexName == _(&quot;My Documents&quot;))
@@ -2779,9 +2909,6 @@
 		set_status(_(&quot;No URL to browse&quot;));
 		return false;
 	}
-#ifdef DEBUG
-	cout &lt;&lt; &quot;mainWindow::view_document: URL is &quot; &lt;&lt; url &lt;&lt; endl;
-#endif
 
 	// Is browsing enabled ?
 	if ((internalViewerOnly == false) &amp;&amp;
@@ -2820,13 +2947,46 @@
 		}
 		else
 		{
-			// Display the URL in the View tab
-			mainNotebook-&gt;set_current_page(1);
-			if (m_pHtmlView-&gt;renderUrl(url) == true)
+			ViewPage *pViewPage = NULL;
+			ustring viewName = _(&quot;View&quot;);
+			int pageNum = -1;
+
+			// Is there already a page for this index ?
+			pViewPage = dynamic_cast&lt;ViewPage*&gt;(get_page(viewName, NotebookPageBox::VIEW_PAGE));
+			if (pViewPage != NULL)
 			{
-				//viewstop1-&gt;set_sensitive(true);
+				pageNum = get_page_number(viewName, NotebookPageBox::VIEW_PAGE);
 			}
-			set_status(locale_to_utf8(m_pHtmlView-&gt;getLocation()));
+			else
+			{
+				NotebookTabBox *pTab = manage(new NotebookTabBox(viewName,
+					NotebookPageBox::VIEW_PAGE));
+				pTab-&gt;getCloseSignal().connect(
+					SigC::slot(*this, &amp;mainWindow::on_close_page));
+
+				// Position everything
+				pViewPage = manage(new ViewPage(viewName, m_pHtmlView, m_settings));
+
+				// Append the page
+				if (m_state.writeLock(1) == true)
+				{
+					pageNum = m_pNotebook-&gt;append_page(*pViewPage, *pTab);
+					m_pNotebook-&gt;pages().back().set_tab_label_packing(false, true, Gtk::PACK_START);
+
+					m_state.unlock();
+				}
+			}
+
+			if (pageNum &gt;= 0)
+			{
+				// Display the URL
+				m_pNotebook-&gt;set_current_page(pageNum);
+				if (m_pHtmlView-&gt;renderUrl(url) == true)
+				{
+					//viewstop1-&gt;set_sensitive(true);
+				}
+				set_status(locale_to_utf8(m_pHtmlView-&gt;getLocation()));
+			}
 		}
 	}
 

Modified: trunk/UI/GTK2/src/mainWindow.hh
===================================================================
--- trunk/UI/GTK2/src/mainWindow.hh	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/mainWindow.hh	2005-12-29 14:09:35 UTC (rev 29)
@@ -25,6 +25,7 @@
 #include &lt;gdkmm/pixbuf.h&gt;
 #include &lt;gdkmm/color.h&gt;
 #include &lt;gtkmm/rc.h&gt;
+#include &lt;gtkmm/notebook.h&gt;
 #include &lt;gtkmm/liststore.h&gt;
 #include &lt;gtkmm/treestore.h&gt;
 #include &lt;gtkmm/treeselection.h&gt;
@@ -38,9 +39,8 @@
 #include &quot;QueryProperties.h&quot;
 #include &quot;EnginesTree.h&quot;
 #include &quot;HtmlView.h&quot;
-#include &quot;IndexPage.h&quot;
 #include &quot;ModelColumns.h&quot;
-#include &quot;NotebookTabBox.h&quot;
+#include &quot;Notebook.h&quot;
 #include &quot;PinotSettings.h&quot;
 #include &quot;ResultsTree.h&quot;
 #include &quot;WorkerThreads.h&quot;
@@ -61,11 +61,12 @@
 	// Handlers
 	void on_enginesTreeviewSelection_changed();
 	void on_queryTreeviewSelection_changed();
-	void on_resultsTreeviewSelection_changed();
+	void on_resultsTreeviewSelection_changed(Glib::ustring queryName);
 	void on_indexTreeviewSelection_changed(Glib::ustring indexName);
 	void on_index_changed(Glib::ustring indexName);
 	void on_label_changed(Glib::ustring indexName, Glib::ustring labelName);
-	void on_page_closed(Glib::ustring title, NotebookTabBox::PageType type);
+	void on_switch_page(GtkNotebookPage *p0, guint p1);
+	void on_close_page(Glib::ustring title, NotebookPageBox::PageType type);
 	void on_thread_end();
 	void on_editindex(Glib::ustring indexName, Glib::ustring location);
 	void on_message_reception(DocumentInfo docInfo, std::string labelName);
@@ -109,13 +110,14 @@
 	virtual void on_indexForwardButton_clicked(Glib::ustring indexName);
 
 	virtual bool on_queryTreeview_button_press_event(GdkEventButton *ev);
-	virtual void on_mainNotebook_switch_page(GtkNotebookPage *p0, guint p1);
 	virtual bool on_mainWindow_delete_event(GdkEventAny *ev);
 
 	// Action methods
-	IndexPage *get_index_page_with_focus(bool checkTree);
-	IndexPage *get_index_page(const Glib::ustring &amp;indexName);
-	int get_index_page_number(const Glib::ustring &amp;indexName);
+	NotebookPageBox *get_page_with_focus(void);
+	NotebookPageBox *get_page(const Glib::ustring &amp;title,
+		NotebookPageBox::PageType type);
+	int get_page_number(const Glib::ustring &amp;title,
+		NotebookPageBox::PageType type);
 	bool queue_index(const DocumentInfo &amp;docInfo, const std::string &amp;labelName,
 		unsigned int docId = 0);
 	bool queue_unindex(set&lt;unsigned int&gt; &amp;docIdList);
@@ -144,8 +146,8 @@
 	// Query
 	QueryModelColumns m_queryColumns;
 	Glib::RefPtr&lt;Gtk::ListStore&gt; m_refQueryTree;
-	// Results
-	ResultsTree *m_pResultsTree;
+	// Notebook
+	Gtk::Notebook *m_pNotebook;
 	// Index
 	Gtk::Menu *m_pIndexMenu;
 	Gtk::Menu *m_pLabelsMenu;

Modified: trunk/UI/GTK2/src/mainWindow_glade.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow_glade.cc	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/mainWindow_glade.cc	2005-12-29 14:09:35 UTC (rev 29)
@@ -1,4 +1,4 @@
-// generated 2005/12/29 0:33:08 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at thorgrim.dyndns.org.</A>(none)
+// generated 2005/12/29 5:49:01 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at thorgrim.dyndns.org.</A>(none)
 // using glademm V2.6.0
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -71,14 +71,14 @@
    delete1 = NULL;
    Gtk::Menu *editMenuitem_menu = Gtk::manage(new class Gtk::Menu());
    editMenuitem = NULL;
-   Gtk::Image *image530 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-clear&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image546 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-clear&quot;), Gtk::IconSize(1)));
    clearresults1 = NULL;
    showextract1 = NULL;
    searchenginegroup1 = NULL;
    Gtk::RadioMenuItem::Group _RadioMIGroup_searchenginegroup1;
    hostnamegroup1 = NULL;
    Gtk::Menu *groupresults1_menu = Gtk::manage(new class Gtk::Menu());
-   Gtk::MenuItem *groupresults1 = NULL;
+   groupresults1 = NULL;
    Gtk::MenuItem *separator1 = NULL;
    viewresults1 = NULL;
    viewcache1 = NULL;
@@ -86,15 +86,15 @@
    Gtk::Menu *resultsMenuitem_menu = Gtk::manage(new class Gtk::Menu());
    resultsMenuitem = NULL;
    list1 = NULL;
-   Gtk::Image *image531 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-open&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image547 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-open&quot;), Gtk::IconSize(1)));
    import1 = NULL;
    Gtk::MenuItem *separator3 = NULL;
    viewfromindex1 = NULL;
-   Gtk::Image *image532 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-refresh&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image548 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-refresh&quot;), Gtk::IconSize(1)));
    refreshindex1 = NULL;
-   Gtk::Image *image533 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-delete&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image549 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-delete&quot;), Gtk::IconSize(1)));
    unindex1 = NULL;
-   Gtk::Image *image534 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-properties&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image550 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-properties&quot;), Gtk::IconSize(1)));
    showfromindex1 = NULL;
    Gtk::Menu *indexMenuitem_menu = Gtk::manage(new class Gtk::Menu());
    indexMenuitem = NULL;
@@ -139,15 +139,7 @@
 #else //
    queryExpander = Gtk::manage(new class Gtk::HandleBox());
 #endif //
-   resultsVbox = Gtk::manage(new class Gtk::VBox(false, 0));
-   
-   Gtk::Label *resultsLabel = Gtk::manage(new class Gtk::Label(_(&quot;Results&quot;)));
-   viewVbox = Gtk::manage(new class Gtk::VBox(false, 0));
-   
-   Gtk::Label *viewLabel = Gtk::manage(new class Gtk::Label(_(&quot;View&quot;)));
-   mainNotebook = Gtk::manage(new class Gtk::Notebook());
-   
-   Gtk::VBox *rightVbox = Gtk::manage(new class Gtk::VBox(false, 0));
+   rightVbox = Gtk::manage(new class Gtk::VBox(false, 0));
    mainHpaned = Gtk::manage(new class Gtk::HPaned());
    mainProgressbar = Gtk::manage(new class Gtk::ProgressBar());
    mainStatusbar = Gtk::manage(new class Gtk::Statusbar());
@@ -182,7 +174,7 @@
    groupresults1_menu-&gt;items().push_back(Gtk::Menu_Helpers::RadioMenuElem(_RadioMIGroup_searchenginegroup1, _(&quot;Host Name&quot;)));
    hostnamegroup1 = (Gtk::RadioMenuItem *)&amp;groupresults1_menu-&gt;items().back();
    
-   resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Clear List&quot;), *image530));
+   resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Clear List&quot;), *image546));
    clearresults1 = (Gtk::ImageMenuItem *)&amp;resultsMenuitem_menu-&gt;items().back();
    
    resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::CheckMenuElem(_(&quot;Show Extract&quot;)));
@@ -206,7 +198,7 @@
    indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;List Contents Of&quot;)));
    list1 = (Gtk::MenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
-   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Import&quot;), *image531));
+   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Import&quot;), *image547));
    import1 = (Gtk::ImageMenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
    indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::SeparatorElem());
@@ -215,13 +207,13 @@
    indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;View&quot;)));
    viewfromindex1 = (Gtk::MenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
-   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Update&quot;), *image532));
+   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Update&quot;), *image548));
    refreshindex1 = (Gtk::ImageMenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
-   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Unindex&quot;), *image533));
+   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Unindex&quot;), *image549));
    unindex1 = (Gtk::ImageMenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
-   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Properties&quot;), *image534));
+   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Properties&quot;), *image550));
    showfromindex1 = (Gtk::ImageMenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
    helpMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;_About&quot;)));
@@ -241,19 +233,19 @@
    
    mainMenubar-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;_Help&quot;), *helpMenuitem_menu));
    helpMenuitem = (Gtk::MenuItem *)&amp;mainMenubar-&gt;items().back();
-   image530-&gt;set_alignment(0.5,0.5);
-   image530-&gt;set_padding(0,0);
+   image546-&gt;set_alignment(0.5,0.5);
+   image546-&gt;set_padding(0,0);
    showextract1-&gt;set_active(true);
    searchenginegroup1-&gt;set_active(true);
    hostnamegroup1-&gt;set_active(false);
-   image531-&gt;set_alignment(0.5,0.5);
-   image531-&gt;set_padding(0,0);
-   image532-&gt;set_alignment(0.5,0.5);
-   image532-&gt;set_padding(0,0);
-   image533-&gt;set_alignment(0.5,0.5);
-   image533-&gt;set_padding(0,0);
-   image534-&gt;set_alignment(0.5,0.5);
-   image534-&gt;set_padding(0,0);
+   image547-&gt;set_alignment(0.5,0.5);
+   image547-&gt;set_padding(0,0);
+   image548-&gt;set_alignment(0.5,0.5);
+   image548-&gt;set_padding(0,0);
+   image549-&gt;set_alignment(0.5,0.5);
+   image549-&gt;set_padding(0,0);
+   image550-&gt;set_alignment(0.5,0.5);
+   image550-&gt;set_padding(0,0);
    image439-&gt;set_alignment(0.5,0.5);
    image439-&gt;set_padding(0,0);
    addIndexButton-&gt;set_flags(Gtk::CAN_FOCUS);
@@ -350,30 +342,8 @@
 #if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;2
    queryExpander-&gt;set_label_widget(*queryLabel);
 #endif //
-   resultsLabel-&gt;set_alignment(0.5,0.5);
-   resultsLabel-&gt;set_padding(0,0);
-   resultsLabel-&gt;set_justify(Gtk::JUSTIFY_LEFT);
-   resultsLabel-&gt;set_line_wrap(false);
-   resultsLabel-&gt;set_use_markup(false);
-   resultsLabel-&gt;set_selectable(false);
-   viewLabel-&gt;set_alignment(0.5,0.5);
-   viewLabel-&gt;set_padding(0,0);
-   viewLabel-&gt;set_justify(Gtk::JUSTIFY_LEFT);
-   viewLabel-&gt;set_line_wrap(false);
-   viewLabel-&gt;set_use_markup(false);
-   viewLabel-&gt;set_selectable(false);
-   mainNotebook-&gt;set_flags(Gtk::CAN_FOCUS);
-   mainNotebook-&gt;set_show_tabs(true);
-   mainNotebook-&gt;set_show_border(true);
-   mainNotebook-&gt;set_tab_pos(Gtk::POS_TOP);
-   mainNotebook-&gt;set_scrollable(false);
-   mainNotebook-&gt;append_page(*resultsVbox, *resultsLabel);
-   mainNotebook-&gt;pages().back().set_tab_label_packing(false, true, Gtk::PACK_START);
-   mainNotebook-&gt;append_page(*viewVbox, *viewLabel);
-   mainNotebook-&gt;pages().back().set_tab_label_packing(false, true, Gtk::PACK_START);
    rightVbox-&gt;pack_start(*liveQueryHbox, Gtk::PACK_SHRINK, 0);
    rightVbox-&gt;pack_start(*queryExpander, Gtk::PACK_SHRINK, 0);
-   rightVbox-&gt;pack_start(*mainNotebook, Gtk::PACK_EXPAND_WIDGET, 4);
    mainHpaned-&gt;set_flags(Gtk::CAN_FOCUS);
    mainHpaned-&gt;set_position(105);
    mainHpaned-&gt;pack1(*leftVbox, Gtk::SHRINK);
@@ -400,7 +370,7 @@
    paste1-&gt;show();
    delete1-&gt;show();
    editMenuitem-&gt;show();
-   image530-&gt;show();
+   image546-&gt;show();
    clearresults1-&gt;show();
    showextract1-&gt;show();
    searchenginegroup1-&gt;show();
@@ -412,15 +382,15 @@
    indexresults1-&gt;show();
    resultsMenuitem-&gt;show();
    list1-&gt;show();
-   image531-&gt;show();
+   image547-&gt;show();
    import1-&gt;show();
    separator3-&gt;show();
    viewfromindex1-&gt;show();
-   image532-&gt;show();
+   image548-&gt;show();
    refreshindex1-&gt;show();
-   image533-&gt;show();
+   image549-&gt;show();
    unindex1-&gt;show();
-   image534-&gt;show();
+   image550-&gt;show();
    showfromindex1-&gt;show();
    indexMenuitem-&gt;show();
    about1-&gt;show();
@@ -452,11 +422,6 @@
    queryHbox-&gt;show();
    queryLabel-&gt;show();
    queryExpander-&gt;show();
-   resultsVbox-&gt;show();
-   resultsLabel-&gt;show();
-   viewVbox-&gt;show();
-   viewLabel-&gt;show();
-   mainNotebook-&gt;show();
    rightVbox-&gt;show();
    mainHpaned-&gt;show();
    mainProgressbar-&gt;show();
@@ -490,7 +455,6 @@
    editQueryButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;mainWindow_glade::on_editQueryButton_clicked), false);
    removeQueryButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;mainWindow_glade::on_removeQueryButton_clicked), false);
    findQueryButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;mainWindow_glade::on_findQueryButton_clicked), false);
-   mainNotebook-&gt;signal_switch_page().connect(SigC::slot(*this, &amp;mainWindow_glade::on_mainNotebook_switch_page), false);
    mainWindow-&gt;signal_delete_event().connect(SigC::slot(*this, &amp;mainWindow_glade::on_mainWindow_delete_event), false);
 }
 

Modified: trunk/UI/GTK2/src/mainWindow_glade.hh
===================================================================
--- trunk/UI/GTK2/src/mainWindow_glade.hh	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/GTK2/src/mainWindow_glade.hh	2005-12-29 14:09:35 UTC (rev 29)
@@ -1,4 +1,4 @@
-// generated 2005/12/29 0:33:08 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at thorgrim.dyndns.org.</A>(none)
+// generated 2005/12/29 5:49:01 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at thorgrim.dyndns.org.</A>(none)
 // using glademm V2.6.0
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -45,7 +45,6 @@
 #else //
 #include &lt;gtkmm/handlebox.h&gt;
 #endif //
-#include &lt;gtkmm/notebook.h&gt;
 #include &lt;gtkmm/paned.h&gt;
 #include &lt;gtkmm/progressbar.h&gt;
 #include &lt;gtkmm/statusbar.h&gt;
@@ -70,6 +69,7 @@
         class Gtk::CheckMenuItem * showextract1;
         class Gtk::RadioMenuItem * searchenginegroup1;
         class Gtk::RadioMenuItem * hostnamegroup1;
+        class Gtk::MenuItem * groupresults1;
         class Gtk::MenuItem * viewresults1;
         class Gtk::MenuItem * viewcache1;
         class Gtk::MenuItem * indexresults1;
@@ -98,9 +98,7 @@
 #else //
         class Gtk::HandleBox * queryExpander;
 #endif //
-        class Gtk::VBox * resultsVbox;
-        class Gtk::VBox * viewVbox;
-        class Gtk::Notebook * mainNotebook;
+        class Gtk::VBox * rightVbox;
         class Gtk::HPaned * mainHpaned;
         class Gtk::ProgressBar * mainProgressbar;
         class Gtk::Statusbar * mainStatusbar;
@@ -135,7 +133,6 @@
         virtual void on_editQueryButton_clicked() = 0;
         virtual void on_removeQueryButton_clicked() = 0;
         virtual void on_findQueryButton_clicked() = 0;
-        virtual void on_mainNotebook_switch_page(GtkNotebookPage *p0, guint p1) = 0;
         virtual bool on_mainWindow_delete_event(GdkEventAny *ev) = 0;
 };
 #endif

Modified: trunk/UI/RenderHTML/MozillaRenderer.cpp
===================================================================
--- trunk/UI/RenderHTML/MozillaRenderer.cpp	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/RenderHTML/MozillaRenderer.cpp	2005-12-29 14:09:35 UTC (rev 29)
@@ -76,7 +76,7 @@
 }
 
 /// Returns the GTK widget.
-GtkWidget *MozillaRenderer::getWidget(void)
+GtkWidget *MozillaRenderer::getObject(void)
 {
 	return m_htmlWidget;
 }

Modified: trunk/UI/RenderHTML/MozillaRenderer.h
===================================================================
--- trunk/UI/RenderHTML/MozillaRenderer.h	2005-12-29 09:00:55 UTC (rev 28)
+++ trunk/UI/RenderHTML/MozillaRenderer.h	2005-12-29 14:09:35 UTC (rev 29)
@@ -38,9 +38,6 @@
 		/// Shutdowns the renderer.
 		static void shutdown(void);
 
-		/// Returns the GTK widget.
-		GtkWidget *getWidget(void);
-
 		/// Renders HTML held in a buffer.
 		bool renderData(const char *data, unsigned int length, const string &amp;baseUrl);
 
@@ -75,6 +72,9 @@
 		GtkWidget *m_htmlWidget;
 		bool m_rendering;
 
+		/// Returns the GTK widget.
+		GtkWidget *getObject(void);
+
 	private:
 		MozillaRenderer(const MozillaRenderer &amp;other);
 		MozillaRenderer &amp;operator=(const MozillaRenderer &amp;other);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000027.html">[Pinot-svn] r28 - in trunk/UI/GTK2: . src
</A></li>
	<LI>Next message: <A HREF="000029.html">[Pinot-svn] r30 - trunk/UI/GTK2/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28">[ date ]</a>
              <a href="thread.html#28">[ thread ]</a>
              <a href="subject.html#28">[ subject ]</a>
              <a href="author.html#28">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/pinot-svn">More information about the Pinot-svn
mailing list</a><br>
</body></html>
