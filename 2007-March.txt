From fabricecolin at mail.berlios.de  Thu Mar  1 14:52:12 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 1 Mar 2007 14:52:12 +0100
Subject: [Pinot-svn] r751 - in trunk: Collect Index Search UI/GTK2/src
Message-ID: <200703011352.l21DqCur011382@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-01 14:52:12 +0100 (Thu, 01 Mar 2007)
New Revision: 751

Modified:
   trunk/Collect/pinot-collect.1
   trunk/Index/pinot-index.1
   trunk/Search/pinot-search.1
   trunk/Search/pinot-search.cpp
   trunk/UI/GTK2/src/pinot-dbus-daemon.1
   trunk/UI/GTK2/src/pinot.1
Log:
Updated manual pages.


Modified: trunk/Collect/pinot-collect.1
===================================================================
--- trunk/Collect/pinot-collect.1	2007-02-28 13:39:02 UTC (rev 750)
+++ trunk/Collect/pinot-collect.1	2007-03-01 13:52:12 UTC (rev 751)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-COLLECT "1" "December 2006" "pinot-collect - pinot 0.65" "User Commands"
+.TH PINOT-COLLECT "1" "March 2007" "pinot-collect - pinot 0.70" "User Commands"
 .SH NAME
 pinot-collect \- Download an URL from the command-line
 .SH SYNOPSIS

Modified: trunk/Index/pinot-index.1
===================================================================
--- trunk/Index/pinot-index.1	2007-02-28 13:39:02 UTC (rev 750)
+++ trunk/Index/pinot-index.1	2007-03-01 13:52:12 UTC (rev 751)
@@ -1,10 +1,10 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-INDEX "1" "December 2006" "pinot-index - pinot 0.65" "User Commands"
+.TH PINOT-INDEX "1" "March 2007" "pinot-index - pinot 0.70" "User Commands"
 .SH NAME
 pinot-index \- Index documents from the command-line
 .SH SYNOPSIS
 .B pinot-index
-[\fIOPTIONS\fR] \fIINDEXTYPE INDEXLOCATION\fR
+[\fIOPTIONS\fR]
 .SH DESCRIPTION
 pinot\-index \- Index documents from the command\-line
 .SH OPTIONS
@@ -12,6 +12,9 @@
 \fB\-c\fR, \fB\-\-check\fR
 check whether the given URL is in the index
 .TP
+\fB\-d\fR, \fB\-\-db\fR
+path to index to use (mandatory)
+.TP
 \fB\-h\fR, \fB\-\-help\fR
 display this help and exit
 .TP
@@ -24,9 +27,9 @@
 \fB\-v\fR, \fB\-\-version\fR
 output version information and exit
 .SH EXAMPLES
-pinot\-index \fB\-\-check\fR file:///home/fabrice/Documents/Bozo.txt \fB\-\-showinfo\fR xapian ~/.pinot/daemon
+pinot\-index \fB\-\-check\fR file:///home/fabrice/Documents/Bozo.txt \fB\-\-showinfo\fR \fB\-\-db\fR ~/.pinot/daemon
 .PP
-pinot\-index \fB\-\-index\fR http://pinot.berlios.de/ xapian ~/.pinot/index
+pinot\-index \fB\-\-index\fR http://pinot.berlios.de/ \fB\-\-db\fR ~/.pinot/index
 .SH "REPORTING BUGS"
 Report bugs to fabricecolin at users.berlios.de
 .PP

Modified: trunk/Search/pinot-search.1
===================================================================
--- trunk/Search/pinot-search.1	2007-02-28 13:39:02 UTC (rev 750)
+++ trunk/Search/pinot-search.1	2007-03-01 13:52:12 UTC (rev 751)
@@ -1,10 +1,10 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-SEARCH "1" "December 2006" "pinot-search - pinot 0.65" "User Commands"
+.TH PINOT-SEARCH "1" "March 2007" "pinot-search - pinot 0.70" "User Commands"
 .SH NAME
 pinot-search \- Query search engines from the command-line
 .SH SYNOPSIS
 .B pinot-search
-[\fIOPTIONS\fR] \fISEARCHENGINETYPE SEARCHENGINENAME|SEARCHENGINEOPTION QUERYSTRING MAXRESULTSCOUNT\fR
+[\fIOPTIONS\fR] \fISEARCHENGINETYPE SEARCHENGINENAME|SEARCHENGINEOPTION QUERYSTRING\fR
 .SH DESCRIPTION
 pinot\-search \- Query search engines from the command\-line
 .SH OPTIONS
@@ -12,6 +12,9 @@
 \fB\-h\fR, \fB\-\-help\fR
 display this help and exit
 .TP
+\fB\-m\fR, \fB\-\-max\fR
+maximum number of results (default: 10)
+.TP
 \fB\-v\fR, \fB\-\-version\fR
 output version information and exit
 .PP
@@ -19,11 +22,11 @@
 .SH EXAMPLES
 pinot\-search googleapi mygoogleapikey "clowns" 10
 .PP
-pinot\-search opensearch /usr/share/pinot/engines/KrustyDescription.xml "clowns" 10
+pinot\-search opensearch /usr/share/pinot/engines/KrustyDescription.xml "clowns"
 .PP
-pinot\-search sherlock /usr/share/pinot/engines/Bozo.src "clowns" 10
+pinot\-search \fB\-\-max\fR 20 sherlock /usr/share/pinot/engines/Bozo.src "clowns"
 .PP
-pinot\-search xapian ~/.pinot/index "clowns" 10
+pinot\-search \fB\-\-max\fR 10 xapian ~/.pinot/index "clowns"
 .PP
 pinot\-search xapian somehostname:12345 "clowns" 10
 .SH "REPORTING BUGS"

Modified: trunk/Search/pinot-search.cpp
===================================================================
--- trunk/Search/pinot-search.cpp	2007-02-28 13:39:02 UTC (rev 750)
+++ trunk/Search/pinot-search.cpp	2007-03-01 13:52:12 UTC (rev 751)
@@ -61,7 +61,7 @@
 					<< "Usage: pinot-search [OPTIONS] SEARCHENGINETYPE SEARCHENGINENAME|SEARCHENGINEOPTION QUERYSTRING\n\n"
 					<< "Options:\n"
 					<< "  -h, --help		display this help and exit\n"
-					<< "  -m, --max			maximum number of results (default: 10)\n"
+					<< "  -m, --max 		maximum number of results (default: 10)\n"
 					<< "  -v, --version		output version information and exit\n\n"
 					<< "Supported search engine types are";
 				for (set<string>::iterator engineIter = engines.begin(); engineIter != engines.end(); ++engineIter)

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.1
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.1	2007-02-28 13:39:02 UTC (rev 750)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.1	2007-03-01 13:52:12 UTC (rev 751)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-DBUS-DAEMON "1" "December 2006" "pinot-dbus-daemon - pinot 0.65" "User Commands"
+.TH PINOT-DBUS-DAEMON "1" "March 2007" "pinot-dbus-daemon - pinot 0.70" "User Commands"
 .SH NAME
 pinot-dbus-daemon \- D-Bus search and index daemon
 .SH SYNOPSIS

Modified: trunk/UI/GTK2/src/pinot.1
===================================================================
--- trunk/UI/GTK2/src/pinot.1	2007-02-28 13:39:02 UTC (rev 750)
+++ trunk/UI/GTK2/src/pinot.1	2007-03-01 13:52:12 UTC (rev 751)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT "1" "December 2006" "pinot - pinot 0.65" "User Commands"
+.TH PINOT "1" "March 2007" "pinot - pinot 0.70" "User Commands"
 .SH NAME
 pinot \- A metasearch tool for the Free Desktop
 .SH SYNOPSIS



From fabricecolin at mail.berlios.de  Mon Mar  5 12:28:01 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 5 Mar 2007 12:28:01 +0100
Subject: [Pinot-svn] r752 - in trunk: . UI/GTK2/src
Message-ID: <200703051128.l25BS1SV002637@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-05 12:28:01 +0100 (Mon, 05 Mar 2007)
New Revision: 752

Modified:
   trunk/UI/GTK2/src/Makefile.am
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/UI/GTK2/src/pinot.cc
   trunk/configure.in
Log:
Make sure Glib::thread_init() is called before any other glib function.
Run the dbus version number through awk to make it more useful.
Call dbus_threads_init_default() just in case if dbus >= 1.0 is available.


Modified: trunk/UI/GTK2/src/Makefile.am
===================================================================
--- trunk/UI/GTK2/src/Makefile.am	2007-03-01 13:52:12 UTC (rev 751)
+++ trunk/UI/GTK2/src/Makefile.am	2007-03-05 11:28:01 UTC (rev 752)
@@ -78,7 +78,6 @@
 AM_CXXFLAGS = -I$(top_srcdir)/Utils -I$(top_srcdir)/Tokenize -I$(top_srcdir)/Tokenize/filters \
 	-I$(top_srcdir)/SQL -I$(top_srcdir)/Monitor -I$(top_srcdir)/Collect \
 	-I$(top_srcdir)/Index -I$(top_srcdir)/Search -I$(top_srcdir)/Search/Google \
-	-DDBUS_GLIB_VERSION=@DBUS_GLIB_VERSION@ \
 	@SQL_CFLAGS@ @HTTP_CFLAGS@ @GMIME_CFLAGS@ @XML_CFLAGS@ @SOAP_CFLAGS@ @DBUS_CFLAGS@ @INDEX_CFLAGS@ @UI_CFLAGS@
 
 pinot_LDADD = -L$(top_srcdir)/Utils -L$(top_srcdir)/Tokenize -L$(top_srcdir)/SQL -L$(top_srcdir)/Monitor \

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2007-03-01 13:52:12 UTC (rev 751)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2007-03-05 11:28:01 UTC (rev 752)
@@ -218,18 +218,26 @@
 	textdomain(GETTEXT_PACKAGE);
 #endif //ENABLE_NLS
 
-	// This should make Xapian use Flint rather than Quartz
-	Glib::setenv("XAPIAN_PREFER_FLINT", "1");
-
-	MIMEScanner::initialize();
-	DownloaderInterface::initialize();
+	// Initialize threads support before doing anything else
 	if (Glib::thread_supported() == false)
 	{
 		Glib::thread_init();
 	}
+	// Initialize the GType and the D-Bus thread system
+	g_type_init();
+#if DBUS_VERSION > 1000000
+	dbus_threads_init_default();
+#endif
+	dbus_g_thread_init();
+
+	MIMEScanner::initialize();
+	DownloaderInterface::initialize();
 	g_refMainLoop = Glib::MainLoop::create();
 	Glib::set_application_name("Pinot DBus Daemon");
 
+	// This should make Xapian use Flint rather than Quartz
+	Glib::setenv("XAPIAN_PREFER_FLINT", "1");
+
 	char *pLocale = setlocale(LC_ALL, NULL);
 	if (pLocale != NULL)
 	{
@@ -350,10 +358,6 @@
 		cerr << "Couldn't set scheduling priority to " << priority << endl;
 	}
 
-	// Initialize the GType and the D-Bus thread system
-	g_type_init();
-	dbus_g_thread_init();
-
 	GError *pError = NULL;
 	DBusGConnection *pBus = dbus_g_bus_get(DBUS_BUS_SESSION, &pError);
 	if (pBus == NULL)
@@ -433,25 +437,9 @@
 #ifdef DEBUG
 	cout << "Closing connection..." << endl;
 #endif
-	// FIXME: use our friend the preprocessor
-	if (DBUS_GLIB_VERSION < 0.7)
-	{
-		// Don't unref the connection to avoid "assertion failed "!_dbus_transport_get_is_connected
-		// (connection->transport)" file "dbus-connection.c" line 1797 function _dbus_connection_last_unref"
-		dbus_connection_close(pConnection);
-	}
-	else
-	{
-		// Don't close the connection to avoid "Applications can not close shared connections.
-		// Please fix this in your app. Ignoring close request and continuing."
-
-		// With dbus 1.0, unref() brings "The last reference on a connection was dropped without closing the connection.
-		// This is a bug in an application. See dbus_connection_unref() documentation for details.
-		// Most likely, the application called unref() too many times and removed a reference belonging to libdbus,
-		// since this is a shared connection." but of course shared connections cannot be closed !
-
-		//dbus_connection_unref(pConnection);
-	}
+#if DBUS_VERSION < 33000
+	dbus_connection_disconnect(pConnection);
+#endif
 	dbus_g_connection_unref(pBus);
 
 	return EXIT_SUCCESS;

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2007-03-01 13:52:12 UTC (rev 751)
+++ trunk/UI/GTK2/src/pinot.cc	2007-03-05 11:28:01 UTC (rev 752)
@@ -143,20 +143,28 @@
 	textdomain(GETTEXT_PACKAGE);
 #endif //ENABLE_NLS
 
-	// This should make Xapian use Flint rather than Quartz
-	Glib::setenv("XAPIAN_PREFER_FLINT", "1");
-	// This will be useful for indexes served by xapian-progsrv+ssh
-	Glib::setenv("SSH_ASKPASS", prefixDir + "/libexec/openssh/ssh-askpass");
-
-	MIMEScanner::initialize();
-	DownloaderInterface::initialize();
+	// Initialize threads support before doing anything else
 	if (Glib::thread_supported() == false)
 	{
 		Glib::thread_init();
 	}
+	// Initialize the GType and the D-Bus thread system
+	g_type_init();
+#if DBUS_VERSION > 1000000
+	dbus_threads_init_default();
+#endif
+	dbus_g_thread_init();
+
+	MIMEScanner::initialize();
+	DownloaderInterface::initialize();
 	Gtk::Main m(&argc, &argv);
 	Glib::set_application_name("Pinot GTK2 UI");
 
+	// This should make Xapian use Flint rather than Quartz
+	Glib::setenv("XAPIAN_PREFER_FLINT", "1");
+	// This will be useful for indexes served by xapian-progsrv+ssh
+	Glib::setenv("SSH_ASKPASS", prefixDir + "/libexec/openssh/ssh-askpass");
+
 	char *pLocale = setlocale(LC_ALL, NULL);
 	if (pLocale != NULL)
 	{
@@ -272,10 +280,6 @@
 
 	atexit(closeAll);
 
-	// Initialize the GType and the D-Bus thread system
-	g_type_init();
-	dbus_g_thread_init();
-
 	try
 	{
 		// Set an icon for all windows

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2007-03-01 13:52:12 UTC (rev 751)
+++ trunk/configure.in	2007-03-05 11:28:01 UTC (rev 752)
@@ -240,8 +240,9 @@
 PKG_CHECK_MODULES(DBUS, dbus-glib-1)
 AC_SUBST(DBUS_CFLAGS)
 AC_SUBST(DBUS_LIBS)
-DBUS_GLIB_VERSION=`pkg-config --modversion dbus-glib-1`
-AC_SUBST(DBUS_GLIB_VERSION)
+DBUS_VERSION=`pkg-config --modversion dbus-1 | $AWK 'BEGIN { FS = "."; } { printf "%d", ($1 * 1000 + $2) * 1000 + $3;}'`
+AC_DEFINE_UNQUOTED(DBUS_VERSION,$DBUS_VERSION,
+    [DBus version])
 PKG_CHECK_MODULES(SIGCPP, sigc++-2.0 >= 2.0 )
 AC_SUBST(SIGCPP_CFLAGS)
 AC_SUBST(SIGCPP_LIBS)



From fabricecolin at mail.berlios.de  Mon Mar  5 12:39:15 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 5 Mar 2007 12:39:15 +0100
Subject: [Pinot-svn] r753 - trunk
Message-ID: <200703051139.l25BdF1M023045@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-05 12:39:14 +0100 (Mon, 05 Mar 2007)
New Revision: 753

Modified:
   trunk/TODO
Log:
Cleanup.


Modified: trunk/TODO
===================================================================
--- trunk/TODO	2007-03-05 11:28:01 UTC (rev 752)
+++ trunk/TODO	2007-03-05 11:39:14 UTC (rev 753)
@@ -85,9 +85,8 @@
 - Allow building without inotify/the DBus daemon
 - Clean up method names
 - Prefer ustring to string whenever possible
-- Make unique (http://guniqueapp.akl.lt/)
 - Queue unindexing too
-- Export Web searching over D-Bus
+- Don't link against SOAP stuff, it's not needed here
 - Labels should be managed by the daemon, and not saved to the configuration file
 - Make sure labels are alpha-numeric characters exclusively
 - DBus SetDocument[s]Labels should create labels if necessary
@@ -103,6 +102,7 @@
 - Display search engines icons (Gtk::IconSource::set_filename() and Gtk::Style::render_icon())
 - Replace Combobox objects with ComboboxText's (glademm support required)
 - Replace glademm with libglademm ?
+- Make unique (http://guniqueapp.akl.lt/)
 - Filter documents by language, similarly to how labels are shown
 - Either Live Query behaves like a live query (eg results list updated when new documents match)
   or it is renamed to something else to avoid confusion



From fabricecolin at mail.berlios.de  Mon Mar  5 12:45:10 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 5 Mar 2007 12:45:10 +0100
Subject: [Pinot-svn] r754 - in trunk: . po
Message-ID: <200703051145.l25BjAP1031481@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-05 12:45:02 +0100 (Mon, 05 Mar 2007)
New Revision: 754

Modified:
   trunk/NEWS
   trunk/po/es.po
   trunk/po/fr.po
   trunk/po/nl.po
   trunk/po/pt_BR.po
   trunk/po/ru.po
   trunk/po/sv.po
Log:
Setting release date to today.


Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2007-03-05 11:39:14 UTC (rev 753)
+++ trunk/NEWS	2007-03-05 11:45:02 UTC (rev 754)
@@ -1,4 +1,4 @@
-??? version_0_7_0
+2007/03/05 version_0_7_0
 Tokenize :
  - now use Dijon's filters (http://dijon.berlios.de/)
 Index :
@@ -10,6 +10,7 @@
 Daemon :
  - log the daemon's PID
  - sped up unindexing of documents after a directory is deleted
+ - caught up with changes in D-Bus 1.0
 UI :
  - stored queries can do date range filtering. If dates don't make sense
   (eg From >= To), they are ignored
@@ -20,6 +21,8 @@
  - revamped configuration dialog for external indexes
  - Index > Properties now shows a document's size and number of unique terms
  - most operations that involve peeking at the index are done in the background
+ - work-around for desktop files that attempt setting env variables in Exec
+ - caught up with changes in D-Bus 1.0
  - Brazilian Portuguese translation by Leonardo Melo
  - Russian translation by Sergey Vostrikov
 

Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2007-03-05 11:39:14 UTC (rev 753)
+++ trunk/po/es.po	2007-03-05 11:45:02 UTC (rev 754)
@@ -456,64 +456,64 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:203 UI/GTK2/src/pinot-dbus-daemon.cc:284
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
 #: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
 msgid "Unknown"
 msgstr "Desconocido"
 
-#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:285
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
 msgid "Danish"
 msgstr "Dan?s"
 
-#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:286
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Dutch"
 msgstr "Holand?s"
 
-#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:287
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "English"
 msgstr "Ingl?s"
 
-#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:288
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "Finnish"
 msgstr "Finland?s"
 
-#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:289
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "French"
 msgstr "Franc?s"
 
-#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:290
+#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "German"
 msgstr "Alem?n"
 
-#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:291
+#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "Italian"
 msgstr "Italiano"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
+#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Norwegian"
 msgstr "Noruego"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Russian"
 msgstr "Ruso"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Spanish"
 msgstr "Espa?ol"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Swedish"
 msgstr "Sueco"
 
-#: UI/GTK2/src/pinot.cc:239
+#: UI/GTK2/src/pinot.cc:247
 msgid "Couldn't open index"
 msgstr "No se pudo abrir el ?ndice"
 
-#: UI/GTK2/src/pinot.cc:255
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't create history database"
 msgstr "No se pudo crear la base de datos del hist?rico"
 

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2007-03-05 11:39:14 UTC (rev 753)
+++ trunk/po/fr.po	2007-03-05 11:45:02 UTC (rev 754)
@@ -27,20 +27,20 @@
 
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
-#: UI/GTK2/src/mainWindow.cc:1186 UI/GTK2/src/mainWindow.cc:1229
-#: UI/GTK2/src/mainWindow.cc:1251 UI/GTK2/src/mainWindow.cc:1282
-#: UI/GTK2/src/mainWindow.cc:1855 UI/GTK2/src/PinotSettings.cpp:241
-#: UI/GTK2/src/PinotSettings.cpp:1281 UI/GTK2/src/PinotSettings.cpp:1337
-#: UI/GTK2/src/statisticsDialog.cc:88 UI/GTK2/src/WorkerThreads.cpp:820
-#: UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
+#: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
+#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
+#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
 msgid "My Web Pages"
 msgstr "Mes Pages Web"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
-#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/PinotSettings.cpp:242
-#: UI/GTK2/src/PinotSettings.cpp:1282 UI/GTK2/src/PinotSettings.cpp:1338
-#: UI/GTK2/src/statisticsDialog.cc:74 UI/GTK2/src/WorkerThreads.cpp:825
-#: UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
+#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
+#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
+#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
 msgid "My Documents"
 msgstr "Mes Documents"
 
@@ -212,7 +212,7 @@
 msgid "Query"
 msgstr "La recherche"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2923
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
 msgid "on"
 msgstr "sur"
 
@@ -220,142 +220,142 @@
 msgid "ended"
 msgstr "est terminee"
 
-#: UI/GTK2/src/mainWindow.cc:1051
+#: UI/GTK2/src/mainWindow.cc:1053
 msgid "More Like"
 msgstr "Similaire a"
 
-#: UI/GTK2/src/mainWindow.cc:1112
+#: UI/GTK2/src/mainWindow.cc:1114
 msgid "Updated label(s)"
 msgstr "Mis a jour l(es) etiquette(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1196
+#: UI/GTK2/src/mainWindow.cc:1198
 msgid "Updated document"
 msgstr "Mis a jour le document"
 
-#: UI/GTK2/src/mainWindow.cc:1209
+#: UI/GTK2/src/mainWindow.cc:1211
 msgid "Indexed"
 msgstr "Indexe"
 
-#: UI/GTK2/src/mainWindow.cc:1252
+#: UI/GTK2/src/mainWindow.cc:1254
 msgid "Unindexed document(s)"
 msgstr "Desindexe le(s) document(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1293
+#: UI/GTK2/src/mainWindow.cc:1295
 msgid "Updated document properties"
 msgstr "Mis a jour les proprietes du document"
 
-#: UI/GTK2/src/mainWindow.cc:1346
+#: UI/GTK2/src/mainWindow.cc:1348
 msgid "Couldn't rename index, name"
 msgstr "N'a pas pu renommer l'index, le nom"
 
-#: UI/GTK2/src/mainWindow.cc:1350 UI/GTK2/src/mainWindow.cc:2242
-#: UI/GTK2/src/mainWindow.cc:2753
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
+#: UI/GTK2/src/mainWindow.cc:2755
 msgid "is already in use"
 msgstr "est deja utilise"
 
-#: UI/GTK2/src/mainWindow.cc:1363
+#: UI/GTK2/src/mainWindow.cc:1365
 msgid "Couldn't rename index"
 msgstr "N'a pas pu renommer l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1376
+#: UI/GTK2/src/mainWindow.cc:1378
 msgid "Edited index"
 msgstr "Edite l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1752 UI/GTK2/src/mainWindow.cc:2412
+#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
 msgid "Live query"
 msgstr "Recherche"
 
-#: UI/GTK2/src/mainWindow.cc:1778
+#: UI/GTK2/src/mainWindow.cc:1780
 msgid "Couldn't find query"
 msgstr "N'a pas pu trouver"
 
-#: UI/GTK2/src/mainWindow.cc:1971 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1608
+#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
+#: UI/GTK2/src/WorkerThreads.cpp:1618
 msgid "Index"
 msgstr "L'index"
 
-#: UI/GTK2/src/mainWindow.cc:1975 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1612
+#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
+#: UI/GTK2/src/WorkerThreads.cpp:1622
 msgid "doesn't exist"
 msgstr "n'existe pas"
 
-#: UI/GTK2/src/mainWindow.cc:2129
+#: UI/GTK2/src/mainWindow.cc:2131
 msgid "Remove this document from the index ?"
 msgstr "Enlever ce document de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2148
+#: UI/GTK2/src/mainWindow.cc:2150
 msgid "Remove these documents from the index ?"
 msgstr "Enlever ces documents de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2192
+#: UI/GTK2/src/mainWindow.cc:2194
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Un outil de recherche pour le Bureau Libre"
 
-#: UI/GTK2/src/mainWindow.cc:2193
+#: UI/GTK2/src/mainWindow.cc:2195
 msgid "Search the Web and your documents !"
 msgstr "Cherche le Web et vos documents"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2196
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2238
+#: UI/GTK2/src/mainWindow.cc:2240
 msgid "Index name"
 msgstr "Nom de l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2255
 msgid "Couldn't add index"
 msgstr "N'a pas pu ajouter l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2267
+#: UI/GTK2/src/mainWindow.cc:2269
 msgid "Added new index"
 msgstr "Ajoute un nouvel index"
 
-#: UI/GTK2/src/mainWindow.cc:2302
+#: UI/GTK2/src/mainWindow.cc:2304
 msgid "Couldn't remove index"
 msgstr "N'a pas pu enlever l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2567
+#: UI/GTK2/src/mainWindow.cc:2569
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Au moins une tache n'est pas terminee. Quitter maintenant ?"
 
-#: UI/GTK2/src/mainWindow.cc:2749
+#: UI/GTK2/src/mainWindow.cc:2751
 msgid "Query name"
 msgstr "Nom de la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2776
+#: UI/GTK2/src/mainWindow.cc:2778
 msgid "Couldn't update query"
 msgstr "N'a pas pu mettre a jour la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2784
+#: UI/GTK2/src/mainWindow.cc:2786
 msgid "Edited query"
 msgstr "Edite la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2791
+#: UI/GTK2/src/mainWindow.cc:2793
 msgid "Couldn't add query"
 msgstr "N'a pas pu ajouter la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2799
+#: UI/GTK2/src/mainWindow.cc:2801
 msgid "Added new query"
 msgstr "Ajoute une nouvelle recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2812
+#: UI/GTK2/src/mainWindow.cc:2814
 msgid "Query is not set"
 msgstr "Recherche indefinie"
 
-#: UI/GTK2/src/mainWindow.cc:2823
+#: UI/GTK2/src/mainWindow.cc:2825
 msgid "No search engine selected"
 msgstr "Pas de moteur selectionne"
 
-#: UI/GTK2/src/mainWindow.cc:2910
+#: UI/GTK2/src/mainWindow.cc:2912
 msgid "Please set the Google API key first"
 msgstr "Configurez la clef de l'API Google"
 
-#: UI/GTK2/src/mainWindow.cc:2919
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Running query"
 msgstr "Recherche en cours"
 
-#: UI/GTK2/src/mainWindow.cc:3103
+#: UI/GTK2/src/mainWindow.cc:3105
 msgid "No default application defined for type"
 msgstr "Pas d'application definie pour le type"
 
@@ -457,64 +457,64 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:203 UI/GTK2/src/pinot-dbus-daemon.cc:284
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
 #: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
 msgid "Unknown"
 msgstr "Inconnu"
 
-#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:285
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
 msgid "Danish"
 msgstr "Danois"
 
-#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:286
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Dutch"
 msgstr "Hollandais"
 
-#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:287
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "English"
 msgstr "Anglais"
 
-#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:288
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "Finnish"
 msgstr "Finlandais"
 
-#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:289
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "French"
 msgstr "Francais"
 
-#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:290
+#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "German"
 msgstr "Allemand"
 
-#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:291
+#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "Italian"
 msgstr "Italien"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
+#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Norwegian"
 msgstr "Norvegien"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Portuguese"
 msgstr "Portugais"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Russian"
 msgstr "Russe"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Spanish"
 msgstr "Espagnol"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Swedish"
 msgstr "Suedois"
 
-#: UI/GTK2/src/pinot.cc:239
+#: UI/GTK2/src/pinot.cc:247
 msgid "Couldn't open index"
 msgstr "N'a pas pu ouvrir l'index"
 
-#: UI/GTK2/src/pinot.cc:255
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't create history database"
 msgstr "N'a pas pu creer la base d'historiques"
 
@@ -530,7 +530,7 @@
 msgid "Personal"
 msgstr "Personnel"
 
-#: UI/GTK2/src/PinotSettings.cpp:1085
+#: UI/GTK2/src/PinotSettings.cpp:1082
 msgid "Unclassified"
 msgstr "Sans classification"
 
@@ -777,8 +777,8 @@
 
 #: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
 #: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1488
-#: UI/GTK2/src/WorkerThreads.cpp:1621
+#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
+#: UI/GTK2/src/WorkerThreads.cpp:1631
 msgid "Index error on"
 msgstr "Erreur sur l'index"
 
@@ -802,26 +802,26 @@
 msgid "Couldn't retrieve"
 msgstr "N'a pas pu telecharger"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1334
+#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
 msgid "Cannot index document type"
 msgstr "Impossible d'indexer ce type de documents"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1338
+#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1369
+#: UI/GTK2/src/WorkerThreads.cpp:1376
 msgid "Robots META tag forbids indexing"
 msgstr "Le META tag Robots interdit d'indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1420
+#: UI/GTK2/src/WorkerThreads.cpp:1430
 msgid "Couldn't index"
 msgstr "N'a pas pu indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1499
+#: UI/GTK2/src/WorkerThreads.cpp:1509
 msgid "Couldn't unindex document(s)"
 msgstr "N'a pas pu desindexer le(s) document(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1633
+#: UI/GTK2/src/WorkerThreads.cpp:1643
 msgid "Couldn't update document"
 msgstr "N'a pas pu mettre a jour le document"

Modified: trunk/po/nl.po
===================================================================
--- trunk/po/nl.po	2007-03-05 11:39:14 UTC (rev 753)
+++ trunk/po/nl.po	2007-03-05 11:45:02 UTC (rev 754)
@@ -27,20 +27,20 @@
 
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
-#: UI/GTK2/src/mainWindow.cc:1186 UI/GTK2/src/mainWindow.cc:1229
-#: UI/GTK2/src/mainWindow.cc:1251 UI/GTK2/src/mainWindow.cc:1282
-#: UI/GTK2/src/mainWindow.cc:1855 UI/GTK2/src/PinotSettings.cpp:241
-#: UI/GTK2/src/PinotSettings.cpp:1281 UI/GTK2/src/PinotSettings.cpp:1337
-#: UI/GTK2/src/statisticsDialog.cc:88 UI/GTK2/src/WorkerThreads.cpp:820
-#: UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
+#: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
+#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
+#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
 msgid "My Web Pages"
 msgstr "Mijn webpagina's"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
-#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/PinotSettings.cpp:242
-#: UI/GTK2/src/PinotSettings.cpp:1282 UI/GTK2/src/PinotSettings.cpp:1338
-#: UI/GTK2/src/statisticsDialog.cc:74 UI/GTK2/src/WorkerThreads.cpp:825
-#: UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
+#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
+#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
+#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
 msgid "My Documents"
 msgstr "Mijn documenten"
 
@@ -215,7 +215,7 @@
 msgid "Query"
 msgstr "Query"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2923
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
 msgid "on"
 msgstr "op"
 
@@ -223,144 +223,144 @@
 msgid "ended"
 msgstr "Beeindigd"
 
-#: UI/GTK2/src/mainWindow.cc:1051
+#: UI/GTK2/src/mainWindow.cc:1053
 msgid "More Like"
 msgstr "Meer zoals"
 
-#: UI/GTK2/src/mainWindow.cc:1112
+#: UI/GTK2/src/mainWindow.cc:1114
 msgid "Updated label(s)"
 msgstr "Vernieuwde na(a)m(en)"
 
-#: UI/GTK2/src/mainWindow.cc:1196
+#: UI/GTK2/src/mainWindow.cc:1198
 msgid "Updated document"
 msgstr "Vernieuwd document"
 
-#: UI/GTK2/src/mainWindow.cc:1209
+#: UI/GTK2/src/mainWindow.cc:1211
 msgid "Indexed"
 msgstr "Geindexeerd"
 
-#: UI/GTK2/src/mainWindow.cc:1252
+#: UI/GTK2/src/mainWindow.cc:1254
 msgid "Unindexed document(s)"
 msgstr "Niet geindexeerd(e) document(en)"
 
-#: UI/GTK2/src/mainWindow.cc:1293
+#: UI/GTK2/src/mainWindow.cc:1295
 msgid "Updated document properties"
 msgstr "Vernieuwde documenteigenschappen"
 
-#: UI/GTK2/src/mainWindow.cc:1346
+#: UI/GTK2/src/mainWindow.cc:1348
 msgid "Couldn't rename index, name"
 msgstr "Kon index niet hernoemen, naam"
 
-#: UI/GTK2/src/mainWindow.cc:1350 UI/GTK2/src/mainWindow.cc:2242
-#: UI/GTK2/src/mainWindow.cc:2753
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
+#: UI/GTK2/src/mainWindow.cc:2755
 msgid "is already in use"
 msgstr "is reeds in gebruik"
 
-#: UI/GTK2/src/mainWindow.cc:1363
+#: UI/GTK2/src/mainWindow.cc:1365
 msgid "Couldn't rename index"
 msgstr "Kon index niet hernoemen"
 
-#: UI/GTK2/src/mainWindow.cc:1376
+#: UI/GTK2/src/mainWindow.cc:1378
 msgid "Edited index"
 msgstr "Bewerkte index"
 
-#: UI/GTK2/src/mainWindow.cc:1752 UI/GTK2/src/mainWindow.cc:2412
+#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
 msgid "Live query"
 msgstr "Rechtstreekse query"
 
-#: UI/GTK2/src/mainWindow.cc:1778
+#: UI/GTK2/src/mainWindow.cc:1780
 msgid "Couldn't find query"
 msgstr "Kon query niet vinden"
 
-#: UI/GTK2/src/mainWindow.cc:1971 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1608
+#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
+#: UI/GTK2/src/WorkerThreads.cpp:1618
 msgid "Index"
 msgstr "Inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:1975 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1612
+#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
+#: UI/GTK2/src/WorkerThreads.cpp:1622
 msgid "doesn't exist"
 msgstr "bestaat niet"
 
-#: UI/GTK2/src/mainWindow.cc:2129
+#: UI/GTK2/src/mainWindow.cc:2131
 msgid "Remove this document from the index ?"
 msgstr "Verwijder dit document uit de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2148
+#: UI/GTK2/src/mainWindow.cc:2150
 msgid "Remove these documents from the index ?"
 msgstr "Verwijder deze documenten uit de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2192
+#: UI/GTK2/src/mainWindow.cc:2194
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Een metazoek tool voor de Free Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2193
+#: UI/GTK2/src/mainWindow.cc:2195
 msgid "Search the Web and your documents !"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2196
 #, fuzzy
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2238
+#: UI/GTK2/src/mainWindow.cc:2240
 msgid "Index name"
 msgstr "Naam inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2255
 msgid "Couldn't add index"
 msgstr "Kon inhoudsopgave niet toevoegen"
 
-#: UI/GTK2/src/mainWindow.cc:2267
+#: UI/GTK2/src/mainWindow.cc:2269
 msgid "Added new index"
 msgstr "Nieuwe inhoudsopgave toegevoegd"
 
-#: UI/GTK2/src/mainWindow.cc:2302
+#: UI/GTK2/src/mainWindow.cc:2304
 msgid "Couldn't remove index"
 msgstr "Kon inhoudsopgave niet verwijderen"
 
-#: UI/GTK2/src/mainWindow.cc:2567
+#: UI/GTK2/src/mainWindow.cc:2569
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Tenminste een taak is nog niet gereed. Nu stoppen?"
 
-#: UI/GTK2/src/mainWindow.cc:2749
+#: UI/GTK2/src/mainWindow.cc:2751
 msgid "Query name"
 msgstr "Naam query"
 
-#: UI/GTK2/src/mainWindow.cc:2776
+#: UI/GTK2/src/mainWindow.cc:2778
 msgid "Couldn't update query"
 msgstr "Kon query niet actualiseren"
 
-#: UI/GTK2/src/mainWindow.cc:2784
+#: UI/GTK2/src/mainWindow.cc:2786
 msgid "Edited query"
 msgstr "Bewerkte query"
 
-#: UI/GTK2/src/mainWindow.cc:2791
+#: UI/GTK2/src/mainWindow.cc:2793
 msgid "Couldn't add query"
 msgstr "Kon query niet toevoegen"
 
-#: UI/GTK2/src/mainWindow.cc:2799
+#: UI/GTK2/src/mainWindow.cc:2801
 msgid "Added new query"
 msgstr "Nieuwe query toegevoegd"
 
-#: UI/GTK2/src/mainWindow.cc:2812
+#: UI/GTK2/src/mainWindow.cc:2814
 #, fuzzy
 msgid "Query is not set"
 msgstr "Query niet vastgelegd"
 
-#: UI/GTK2/src/mainWindow.cc:2823
+#: UI/GTK2/src/mainWindow.cc:2825
 msgid "No search engine selected"
 msgstr "Geen zoekmachine geselecteerd"
 
-#: UI/GTK2/src/mainWindow.cc:2910
+#: UI/GTK2/src/mainWindow.cc:2912
 msgid "Please set the Google API key first"
 msgstr "Geef eerst de Google API sleutel in"
 
-#: UI/GTK2/src/mainWindow.cc:2919
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Running query"
 msgstr "Lopende query"
 
-#: UI/GTK2/src/mainWindow.cc:3103
+#: UI/GTK2/src/mainWindow.cc:3105
 msgid "No default application defined for type"
 msgstr "Geen standaard toepassing gedefinieerd voor het type"
 
@@ -462,64 +462,64 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:203 UI/GTK2/src/pinot-dbus-daemon.cc:284
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
 #: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
 msgid "Unknown"
 msgstr "Niet bekend"
 
-#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:285
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
 msgid "Danish"
 msgstr "Deens"
 
-#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:286
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Dutch"
 msgstr "Nederlands"
 
-#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:287
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "English"
 msgstr "Engels"
 
-#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:288
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "Finnish"
 msgstr "Fins"
 
-#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:289
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "French"
 msgstr "Frans"
 
-#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:290
+#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "German"
 msgstr "Duits"
 
-#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:291
+#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "Italian"
 msgstr "Italiaans"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
+#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Norwegian"
 msgstr "Noors"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Portuguese"
 msgstr "Portugees"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Russian"
 msgstr "Russisch"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Spanish"
 msgstr "Spaans"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Swedish"
 msgstr "Zweeds"
 
-#: UI/GTK2/src/pinot.cc:239
+#: UI/GTK2/src/pinot.cc:247
 msgid "Couldn't open index"
 msgstr "Kan index niet openen"
 
-#: UI/GTK2/src/pinot.cc:255
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't create history database"
 msgstr "Kon historische database niet maken"
 
@@ -535,7 +535,7 @@
 msgid "Personal"
 msgstr "Persoonlijk"
 
-#: UI/GTK2/src/PinotSettings.cpp:1085
+#: UI/GTK2/src/PinotSettings.cpp:1082
 msgid "Unclassified"
 msgstr "Niet geklassificeerd"
 
@@ -794,8 +794,8 @@
 
 #: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
 #: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1488
-#: UI/GTK2/src/WorkerThreads.cpp:1621
+#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
+#: UI/GTK2/src/WorkerThreads.cpp:1631
 msgid "Index error on"
 msgstr "Indexeringsfout op"
 
@@ -819,26 +819,26 @@
 msgid "Couldn't retrieve"
 msgstr "Kon niet opzoeken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1334
+#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
 msgid "Cannot index document type"
 msgstr "Kan documenttype niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1338
+#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "at"
 msgstr "bij"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1369
+#: UI/GTK2/src/WorkerThreads.cpp:1376
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META taf verbiedt indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1420
+#: UI/GTK2/src/WorkerThreads.cpp:1430
 msgid "Couldn't index"
 msgstr "Kon niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1499
+#: UI/GTK2/src/WorkerThreads.cpp:1509
 msgid "Couldn't unindex document(s)"
 msgstr "Kan indexering van bestand(en) niet ongedaan maken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1633
+#: UI/GTK2/src/WorkerThreads.cpp:1643
 msgid "Couldn't update document"
 msgstr "Kan document niet actualiseren"

Modified: trunk/po/pt_BR.po
===================================================================
--- trunk/po/pt_BR.po	2007-03-05 11:39:14 UTC (rev 753)
+++ trunk/po/pt_BR.po	2007-03-05 11:45:02 UTC (rev 754)
@@ -27,20 +27,20 @@
 
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
-#: UI/GTK2/src/mainWindow.cc:1186 UI/GTK2/src/mainWindow.cc:1229
-#: UI/GTK2/src/mainWindow.cc:1251 UI/GTK2/src/mainWindow.cc:1282
-#: UI/GTK2/src/mainWindow.cc:1855 UI/GTK2/src/PinotSettings.cpp:241
-#: UI/GTK2/src/PinotSettings.cpp:1281 UI/GTK2/src/PinotSettings.cpp:1337
-#: UI/GTK2/src/statisticsDialog.cc:88 UI/GTK2/src/WorkerThreads.cpp:820
-#: UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
+#: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
+#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
+#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
 msgid "My Web Pages"
 msgstr "Minhas P?ginas Web"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
-#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/PinotSettings.cpp:242
-#: UI/GTK2/src/PinotSettings.cpp:1282 UI/GTK2/src/PinotSettings.cpp:1338
-#: UI/GTK2/src/statisticsDialog.cc:74 UI/GTK2/src/WorkerThreads.cpp:825
-#: UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
+#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
+#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
+#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
 msgid "My Documents"
 msgstr "Meus Documentos"
 
@@ -214,7 +214,7 @@
 msgid "Query"
 msgstr "Consulta"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2923
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
 msgid "on"
 msgstr "no"
 
@@ -222,142 +222,142 @@
 msgid "ended"
 msgstr "finalizada"
 
-#: UI/GTK2/src/mainWindow.cc:1051
+#: UI/GTK2/src/mainWindow.cc:1053
 msgid "More Like"
 msgstr "Mais pr?xima"
 
-#: UI/GTK2/src/mainWindow.cc:1112
+#: UI/GTK2/src/mainWindow.cc:1114
 msgid "Updated label(s)"
 msgstr "T?tulo(s) atualizado(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1196
+#: UI/GTK2/src/mainWindow.cc:1198
 msgid "Updated document"
 msgstr "Documento atualizado"
 
-#: UI/GTK2/src/mainWindow.cc:1209
+#: UI/GTK2/src/mainWindow.cc:1211
 msgid "Indexed"
 msgstr "Indexado"
 
-#: UI/GTK2/src/mainWindow.cc:1252
+#: UI/GTK2/src/mainWindow.cc:1254
 msgid "Unindexed document(s)"
 msgstr "Documento(s) n?o indexidado(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1293
+#: UI/GTK2/src/mainWindow.cc:1295
 msgid "Updated document properties"
 msgstr "Propriedade de documentos atualizados"
 
-#: UI/GTK2/src/mainWindow.cc:1346
+#: UI/GTK2/src/mainWindow.cc:1348
 msgid "Couldn't rename index, name"
 msgstr "N?o foi poss?vel renomear ?ndice, nome"
 
-#: UI/GTK2/src/mainWindow.cc:1350 UI/GTK2/src/mainWindow.cc:2242
-#: UI/GTK2/src/mainWindow.cc:2753
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
+#: UI/GTK2/src/mainWindow.cc:2755
 msgid "is already in use"
 msgstr "j? est? em uso"
 
-#: UI/GTK2/src/mainWindow.cc:1363
+#: UI/GTK2/src/mainWindow.cc:1365
 msgid "Couldn't rename index"
 msgstr "N?o foi poss?vel renomear ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1376
+#: UI/GTK2/src/mainWindow.cc:1378
 msgid "Edited index"
 msgstr "?ndice editado"
 
-#: UI/GTK2/src/mainWindow.cc:1752 UI/GTK2/src/mainWindow.cc:2412
+#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
 msgid "Live query"
 msgstr "Query ativa"
 
-#: UI/GTK2/src/mainWindow.cc:1778
+#: UI/GTK2/src/mainWindow.cc:1780
 msgid "Couldn't find query"
 msgstr "N?o foi poss?vel encontrar consulta"
 
-#: UI/GTK2/src/mainWindow.cc:1971 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1608
+#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
+#: UI/GTK2/src/WorkerThreads.cpp:1618
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1975 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1612
+#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
+#: UI/GTK2/src/WorkerThreads.cpp:1622
 msgid "doesn't exist"
 msgstr "n?o existe"
 
-#: UI/GTK2/src/mainWindow.cc:2129
+#: UI/GTK2/src/mainWindow.cc:2131
 msgid "Remove this document from the index ?"
 msgstr "Remover documento do ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2148
+#: UI/GTK2/src/mainWindow.cc:2150
 msgid "Remove these documents from the index ?"
 msgstr "Remover documentos do ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2192
+#: UI/GTK2/src/mainWindow.cc:2194
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Um mecanismo de metabusca gr?tis para Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2193
+#: UI/GTK2/src/mainWindow.cc:2195
 msgid "Search the Web and your documents !"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2196
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2238
+#: UI/GTK2/src/mainWindow.cc:2240
 msgid "Index name"
 msgstr "Nome do ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2255
 msgid "Couldn't add index"
 msgstr "N?o foi poss?vel adicionar ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2267
+#: UI/GTK2/src/mainWindow.cc:2269
 msgid "Added new index"
 msgstr "Adicionar novo ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2302
+#: UI/GTK2/src/mainWindow.cc:2304
 msgid "Couldn't remove index"
 msgstr "N?o foi poss?vel remover ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2567
+#: UI/GTK2/src/mainWindow.cc:2569
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Pelo menos uma tarefa n?o terminou ainda. Sair assim mesmo?"
 
-#: UI/GTK2/src/mainWindow.cc:2749
+#: UI/GTK2/src/mainWindow.cc:2751
 msgid "Query name"
 msgstr "Nome da consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2776
+#: UI/GTK2/src/mainWindow.cc:2778
 msgid "Couldn't update query"
 msgstr "N?o foi poss?vel atualizar consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2784
+#: UI/GTK2/src/mainWindow.cc:2786
 msgid "Edited query"
 msgstr "Consulta editada"
 
-#: UI/GTK2/src/mainWindow.cc:2791
+#: UI/GTK2/src/mainWindow.cc:2793
 msgid "Couldn't add query"
 msgstr "N?o foi poss?vel adicionar consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2799
+#: UI/GTK2/src/mainWindow.cc:2801
 msgid "Added new query"
 msgstr "Adicionar nova consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2812
+#: UI/GTK2/src/mainWindow.cc:2814
 msgid "Query is not set"
 msgstr "Consulta n?o foi atualizada"
 
-#: UI/GTK2/src/mainWindow.cc:2823
+#: UI/GTK2/src/mainWindow.cc:2825
 msgid "No search engine selected"
 msgstr "Nenhum mecanismo de pesquisa selecionado"
 
-#: UI/GTK2/src/mainWindow.cc:2910
+#: UI/GTK2/src/mainWindow.cc:2912
 msgid "Please set the Google API key first"
 msgstr "Primeiro informe a tecla para Google API"
 
-#: UI/GTK2/src/mainWindow.cc:2919
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Running query"
 msgstr "Executando consulta"
 
-#: UI/GTK2/src/mainWindow.cc:3103
+#: UI/GTK2/src/mainWindow.cc:3105
 msgid "No default application defined for type"
 msgstr "Aplica??o associada ao tipo n?o definida"
 
@@ -459,64 +459,64 @@
 msgid "Pinot"
 msgstr "Pino"
 
-#: UI/GTK2/src/pinot.cc:203 UI/GTK2/src/pinot-dbus-daemon.cc:284
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
 #: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
 msgid "Unknown"
 msgstr "Desconhecido"
 
-#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:285
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
 msgid "Danish"
 msgstr "Danish"
 
-#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:286
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Dutch"
 msgstr "Dutch"
 
-#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:287
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "English"
 msgstr "English"
 
-#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:288
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "Finnish"
 msgstr "Terminar"
 
-#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:289
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "French"
 msgstr "French"
 
-#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:290
+#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "German"
 msgstr "German"
 
-#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:291
+#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "Italian"
 msgstr "Italian"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
+#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Norwegian"
 msgstr "Norwegian"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Russian"
 msgstr "Russian"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Spanish"
 msgstr "Spanish"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Swedish"
 msgstr "Swedish"
 
-#: UI/GTK2/src/pinot.cc:239
+#: UI/GTK2/src/pinot.cc:247
 msgid "Couldn't open index"
 msgstr "N?o foi poss?vel abrir ?ndice"
 
-#: UI/GTK2/src/pinot.cc:255
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't create history database"
 msgstr "N?o foi poss?vel criar base de hist?rico"
 
@@ -532,7 +532,7 @@
 msgid "Personal"
 msgstr "Pessoal"
 
-#: UI/GTK2/src/PinotSettings.cpp:1085
+#: UI/GTK2/src/PinotSettings.cpp:1082
 msgid "Unclassified"
 msgstr "N?o classificado"
 
@@ -794,8 +794,8 @@
 
 #: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
 #: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1488
-#: UI/GTK2/src/WorkerThreads.cpp:1621
+#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
+#: UI/GTK2/src/WorkerThreads.cpp:1631
 msgid "Index error on"
 msgstr "Erro no ?ndice no"
 
@@ -819,26 +819,26 @@
 msgid "Couldn't retrieve"
 msgstr "N?o foi poss?vel carregar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1334
+#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
 msgid "Cannot index document type"
 msgstr "Imposs?vel indexar tipo de arquivo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1338
+#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "at"
 msgstr "no"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1369
+#: UI/GTK2/src/WorkerThreads.cpp:1376
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META tag n?o s?o permitidos no ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1420
+#: UI/GTK2/src/WorkerThreads.cpp:1430
 msgid "Couldn't index"
 msgstr "N?o foi poss?vel indexar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1499
+#: UI/GTK2/src/WorkerThreads.cpp:1509
 msgid "Couldn't unindex document(s)"
 msgstr "N?o foi poss?vel remover documento(s) do ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1633
+#: UI/GTK2/src/WorkerThreads.cpp:1643
 msgid "Couldn't update document"
 msgstr "N?o foi poss?vel atualizar documento"

Modified: trunk/po/ru.po
===================================================================
--- trunk/po/ru.po	2007-03-05 11:39:14 UTC (rev 753)
+++ trunk/po/ru.po	2007-03-05 11:45:02 UTC (rev 754)
@@ -27,20 +27,20 @@
 
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
-#: UI/GTK2/src/mainWindow.cc:1186 UI/GTK2/src/mainWindow.cc:1229
-#: UI/GTK2/src/mainWindow.cc:1251 UI/GTK2/src/mainWindow.cc:1282
-#: UI/GTK2/src/mainWindow.cc:1855 UI/GTK2/src/PinotSettings.cpp:241
-#: UI/GTK2/src/PinotSettings.cpp:1281 UI/GTK2/src/PinotSettings.cpp:1337
-#: UI/GTK2/src/statisticsDialog.cc:88 UI/GTK2/src/WorkerThreads.cpp:820
-#: UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
+#: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
+#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
+#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
 msgid "My Web Pages"
 msgstr "??? web-????????"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
-#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/PinotSettings.cpp:242
-#: UI/GTK2/src/PinotSettings.cpp:1282 UI/GTK2/src/PinotSettings.cpp:1338
-#: UI/GTK2/src/statisticsDialog.cc:74 UI/GTK2/src/WorkerThreads.cpp:825
-#: UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
+#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
+#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
+#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
 msgid "My Documents"
 msgstr "??? ?????????"
 
@@ -214,7 +214,7 @@
 msgid "Query"
 msgstr "??????"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2923
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
 msgid "on"
 msgstr "??"
 
@@ -222,142 +222,142 @@
 msgid "ended"
 msgstr "?????????????"
 
-#: UI/GTK2/src/mainWindow.cc:1051
+#: UI/GTK2/src/mainWindow.cc:1053
 msgid "More Like"
 msgstr "????? ????????"
 
-#: UI/GTK2/src/mainWindow.cc:1112
+#: UI/GTK2/src/mainWindow.cc:1114
 msgid "Updated label(s)"
 msgstr "????????? ????? (??)"
 
-#: UI/GTK2/src/mainWindow.cc:1196
+#: UI/GTK2/src/mainWindow.cc:1198
 msgid "Updated document"
 msgstr "??????????? ????????"
 
-#: UI/GTK2/src/mainWindow.cc:1209
+#: UI/GTK2/src/mainWindow.cc:1211
 msgid "Indexed"
 msgstr "?????????????"
 
-#: UI/GTK2/src/mainWindow.cc:1252
+#: UI/GTK2/src/mainWindow.cc:1254
 msgid "Unindexed document(s)"
 msgstr "?? ????????????? ??????????"
 
-#: UI/GTK2/src/mainWindow.cc:1293
+#: UI/GTK2/src/mainWindow.cc:1295
 msgid "Updated document properties"
 msgstr "?????????? ??????? ?????????"
 
-#: UI/GTK2/src/mainWindow.cc:1346
+#: UI/GTK2/src/mainWindow.cc:1348
 msgid "Couldn't rename index, name"
 msgstr "?????????? ????????????? ??????, ????????"
 
-#: UI/GTK2/src/mainWindow.cc:1350 UI/GTK2/src/mainWindow.cc:2242
-#: UI/GTK2/src/mainWindow.cc:2753
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
+#: UI/GTK2/src/mainWindow.cc:2755
 msgid "is already in use"
 msgstr "??? ????????????"
 
-#: UI/GTK2/src/mainWindow.cc:1363
+#: UI/GTK2/src/mainWindow.cc:1365
 msgid "Couldn't rename index"
 msgstr "?????????? ????????????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:1376
+#: UI/GTK2/src/mainWindow.cc:1378
 msgid "Edited index"
 msgstr "?????????????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:1752 UI/GTK2/src/mainWindow.cc:2412
+#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
 msgid "Live query"
 msgstr "???????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:1778
+#: UI/GTK2/src/mainWindow.cc:1780
 msgid "Couldn't find query"
 msgstr "?????????? ????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:1971 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1608
+#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
+#: UI/GTK2/src/WorkerThreads.cpp:1618
 msgid "Index"
 msgstr "??????"
 
-#: UI/GTK2/src/mainWindow.cc:1975 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1612
+#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
+#: UI/GTK2/src/WorkerThreads.cpp:1622
 msgid "doesn't exist"
 msgstr "???"
 
-#: UI/GTK2/src/mainWindow.cc:2129
+#: UI/GTK2/src/mainWindow.cc:2131
 msgid "Remove this document from the index ?"
 msgstr "??????? ???????? ?? ??????? ?"
 
-#: UI/GTK2/src/mainWindow.cc:2148
+#: UI/GTK2/src/mainWindow.cc:2150
 msgid "Remove these documents from the index ?"
 msgstr "??????? ??? ????????? ?? ????????"
 
-#: UI/GTK2/src/mainWindow.cc:2192
+#: UI/GTK2/src/mainWindow.cc:2194
 msgid "A metasearch tool for the Free Desktop"
 msgstr "?????????? ?????????? ??? ?????????? ????????"
 
-#: UI/GTK2/src/mainWindow.cc:2193
+#: UI/GTK2/src/mainWindow.cc:2195
 msgid "Search the Web and your documents !"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2196
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2238
+#: UI/GTK2/src/mainWindow.cc:2240
 msgid "Index name"
 msgstr "???????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2255
 msgid "Couldn't add index"
 msgstr "?????????? ???????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2267
+#: UI/GTK2/src/mainWindow.cc:2269
 msgid "Added new index"
 msgstr "???????? ????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2302
+#: UI/GTK2/src/mainWindow.cc:2304
 msgid "Couldn't remove index"
 msgstr "?????????? ??????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2567
+#: UI/GTK2/src/mainWindow.cc:2569
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "?? ??????? ???? ???? ?????? ??? ?? ?????????. ????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2749
+#: UI/GTK2/src/mainWindow.cc:2751
 msgid "Query name"
 msgstr "???????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2776
+#: UI/GTK2/src/mainWindow.cc:2778
 msgid "Couldn't update query"
 msgstr "?????????? ???????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2784
+#: UI/GTK2/src/mainWindow.cc:2786
 msgid "Edited query"
 msgstr "?????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2791
+#: UI/GTK2/src/mainWindow.cc:2793
 msgid "Couldn't add query"
 msgstr "?????????? ???????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2799
+#: UI/GTK2/src/mainWindow.cc:2801
 msgid "Added new query"
 msgstr "???????? ????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2812
+#: UI/GTK2/src/mainWindow.cc:2814
 msgid "Query is not set"
 msgstr "?????? ?? ??????????"
 
-#: UI/GTK2/src/mainWindow.cc:2823
+#: UI/GTK2/src/mainWindow.cc:2825
 msgid "No search engine selected"
 msgstr "?? ???? ????????? ??????? ?? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2910
+#: UI/GTK2/src/mainWindow.cc:2912
 msgid "Please set the Google API key first"
 msgstr "??????????, ??????? ????????????? ???? Google API"
 
-#: UI/GTK2/src/mainWindow.cc:2919
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Running query"
 msgstr "?????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:3103
+#: UI/GTK2/src/mainWindow.cc:3105
 msgid "No default application defined for type"
 msgstr "?? ???? ?????????? ?? ????????? ?? ?????????? ??? ???? ??????????"
 
@@ -459,64 +459,64 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:203 UI/GTK2/src/pinot-dbus-daemon.cc:284
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
 #: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
 msgid "Unknown"
 msgstr "???????????"
 
-#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:285
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
 msgid "Danish"
 msgstr "???????"
 
-#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:286
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Dutch"
 msgstr "???????????"
 
-#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:287
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "English"
 msgstr "??????????"
 
-#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:288
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "Finnish"
 msgstr "???????"
 
-#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:289
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "French"
 msgstr "???????????"
 
-#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:290
+#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "German"
 msgstr "????????"
 
-#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:291
+#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "Italian"
 msgstr "???????????"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
+#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Norwegian"
 msgstr "??????????"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Portuguese"
 msgstr "?????????????"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Russian"
 msgstr "???????"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Spanish"
 msgstr "?????????"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Swedish"
 msgstr "????????"
 
-#: UI/GTK2/src/pinot.cc:239
+#: UI/GTK2/src/pinot.cc:247
 msgid "Couldn't open index"
 msgstr "?????????? ??????? ??????"
 
-#: UI/GTK2/src/pinot.cc:255
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't create history database"
 msgstr "?? ??????? ??????? ???? ?????? ???????"
 
@@ -532,7 +532,7 @@
 msgid "Personal"
 msgstr "??????"
 
-#: UI/GTK2/src/PinotSettings.cpp:1085
+#: UI/GTK2/src/PinotSettings.cpp:1082
 msgid "Unclassified"
 msgstr "??????????????"
 
@@ -787,8 +787,8 @@
 
 #: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
 #: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1488
-#: UI/GTK2/src/WorkerThreads.cpp:1621
+#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
+#: UI/GTK2/src/WorkerThreads.cpp:1631
 msgid "Index error on"
 msgstr "?????? ??????? ??"
 
@@ -812,26 +812,26 @@
 msgid "Couldn't retrieve"
 msgstr "?? ??????? ???????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1334
+#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
 msgid "Cannot index document type"
 msgstr "?????????? ????????????? ?????? ??? ??????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1338
+#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "at"
 msgstr "?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1369
+#: UI/GTK2/src/WorkerThreads.cpp:1376
 msgid "Robots META tag forbids indexing"
 msgstr "META-???? ??????? ????????? ??????????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1420
+#: UI/GTK2/src/WorkerThreads.cpp:1430
 msgid "Couldn't index"
 msgstr "?????????? ????????? ??????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1499
+#: UI/GTK2/src/WorkerThreads.cpp:1509
 msgid "Couldn't unindex document(s)"
 msgstr "?????????? ??????????????? ????????(?)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1633
+#: UI/GTK2/src/WorkerThreads.cpp:1643
 msgid "Couldn't update document"
 msgstr "?????????? ???????? ????????"

Modified: trunk/po/sv.po
===================================================================
--- trunk/po/sv.po	2007-03-05 11:39:14 UTC (rev 753)
+++ trunk/po/sv.po	2007-03-05 11:45:02 UTC (rev 754)
@@ -27,20 +27,20 @@
 
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
-#: UI/GTK2/src/mainWindow.cc:1186 UI/GTK2/src/mainWindow.cc:1229
-#: UI/GTK2/src/mainWindow.cc:1251 UI/GTK2/src/mainWindow.cc:1282
-#: UI/GTK2/src/mainWindow.cc:1855 UI/GTK2/src/PinotSettings.cpp:241
-#: UI/GTK2/src/PinotSettings.cpp:1281 UI/GTK2/src/PinotSettings.cpp:1337
-#: UI/GTK2/src/statisticsDialog.cc:88 UI/GTK2/src/WorkerThreads.cpp:820
-#: UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
+#: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
+#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
+#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
 msgid "My Web Pages"
 msgstr "Mina webbsidor"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
-#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/PinotSettings.cpp:242
-#: UI/GTK2/src/PinotSettings.cpp:1282 UI/GTK2/src/PinotSettings.cpp:1338
-#: UI/GTK2/src/statisticsDialog.cc:74 UI/GTK2/src/WorkerThreads.cpp:825
-#: UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
+#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
+#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
+#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
 msgid "My Documents"
 msgstr "Mina dokument"
 
@@ -212,7 +212,7 @@
 msgid "Query"
 msgstr "Fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2923
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
 msgid "on"
 msgstr "p?"
 
@@ -220,142 +220,142 @@
 msgid "ended"
 msgstr "slutade"
 
-#: UI/GTK2/src/mainWindow.cc:1051
+#: UI/GTK2/src/mainWindow.cc:1053
 msgid "More Like"
 msgstr "Kanske mer som"
 
-#: UI/GTK2/src/mainWindow.cc:1112
+#: UI/GTK2/src/mainWindow.cc:1114
 msgid "Updated label(s)"
 msgstr "Uppdaterade etikett(er)"
 
-#: UI/GTK2/src/mainWindow.cc:1196
+#: UI/GTK2/src/mainWindow.cc:1198
 msgid "Updated document"
 msgstr "Uppdaterade dokument"
 
-#: UI/GTK2/src/mainWindow.cc:1209
+#: UI/GTK2/src/mainWindow.cc:1211
 msgid "Indexed"
 msgstr "Indexerade"
 
-#: UI/GTK2/src/mainWindow.cc:1252
+#: UI/GTK2/src/mainWindow.cc:1254
 msgid "Unindexed document(s)"
 msgstr "Ej indexerade dokument"
 
-#: UI/GTK2/src/mainWindow.cc:1293
+#: UI/GTK2/src/mainWindow.cc:1295
 msgid "Updated document properties"
 msgstr "Egenskaper f?r uppdaterade dokument"
 
-#: UI/GTK2/src/mainWindow.cc:1346
+#: UI/GTK2/src/mainWindow.cc:1348
 msgid "Couldn't rename index, name"
 msgstr "Kunde inte byta namn p? index, namn"
 
-#: UI/GTK2/src/mainWindow.cc:1350 UI/GTK2/src/mainWindow.cc:2242
-#: UI/GTK2/src/mainWindow.cc:2753
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
+#: UI/GTK2/src/mainWindow.cc:2755
 msgid "is already in use"
 msgstr "anv?nds redan"
 
-#: UI/GTK2/src/mainWindow.cc:1363
+#: UI/GTK2/src/mainWindow.cc:1365
 msgid "Couldn't rename index"
 msgstr "Kunde inte byta namn p? index"
 
-#: UI/GTK2/src/mainWindow.cc:1376
+#: UI/GTK2/src/mainWindow.cc:1378
 msgid "Edited index"
 msgstr "Redigerade index"
 
-#: UI/GTK2/src/mainWindow.cc:1752 UI/GTK2/src/mainWindow.cc:2412
+#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
 msgid "Live query"
 msgstr "Levande fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:1778
+#: UI/GTK2/src/mainWindow.cc:1780
 msgid "Couldn't find query"
 msgstr "Kunde inte hitta fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:1971 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1608
+#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
+#: UI/GTK2/src/WorkerThreads.cpp:1618
 msgid "Index"
 msgstr "Index"
 
-#: UI/GTK2/src/mainWindow.cc:1975 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1612
+#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
+#: UI/GTK2/src/WorkerThreads.cpp:1622
 msgid "doesn't exist"
 msgstr "finns inte"
 
-#: UI/GTK2/src/mainWindow.cc:2129
+#: UI/GTK2/src/mainWindow.cc:2131
 msgid "Remove this document from the index ?"
 msgstr "Ta bort detta dokument fr?n indexet?"
 
-#: UI/GTK2/src/mainWindow.cc:2148
+#: UI/GTK2/src/mainWindow.cc:2150
 msgid "Remove these documents from the index ?"
 msgstr "Ta bort dessa dokument fr?n indexet?"
 
-#: UI/GTK2/src/mainWindow.cc:2192
+#: UI/GTK2/src/mainWindow.cc:2194
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Ett metas?kningsverktyg f?r Free Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2193
+#: UI/GTK2/src/mainWindow.cc:2195
 msgid "Search the Web and your documents !"
 msgstr "S?k p? webben och i dina dokument!"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2196
 msgid "(C) 2005 Fabrice Colin"
 msgstr "? 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2238
+#: UI/GTK2/src/mainWindow.cc:2240
 msgid "Index name"
 msgstr "Indexnamn"
 
-#: UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2255
 msgid "Couldn't add index"
 msgstr "Kunde inte l?gga till index"
 
-#: UI/GTK2/src/mainWindow.cc:2267
+#: UI/GTK2/src/mainWindow.cc:2269
 msgid "Added new index"
 msgstr "Lade till nytt index"
 
-#: UI/GTK2/src/mainWindow.cc:2302
+#: UI/GTK2/src/mainWindow.cc:2304
 msgid "Couldn't remove index"
 msgstr "Kunde inte ta bort index"
 
-#: UI/GTK2/src/mainWindow.cc:2567
+#: UI/GTK2/src/mainWindow.cc:2569
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "?tminstone en uppgift har inte f?rdigst?llts ?n. Avsluta nu?"
 
-#: UI/GTK2/src/mainWindow.cc:2749
+#: UI/GTK2/src/mainWindow.cc:2751
 msgid "Query name"
 msgstr "Fr?genamn"
 
-#: UI/GTK2/src/mainWindow.cc:2776
+#: UI/GTK2/src/mainWindow.cc:2778
 msgid "Couldn't update query"
 msgstr "Kunde inte uppdatera fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2784
+#: UI/GTK2/src/mainWindow.cc:2786
 msgid "Edited query"
 msgstr "Redigerade fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2791
+#: UI/GTK2/src/mainWindow.cc:2793
 msgid "Couldn't add query"
 msgstr "Kunde inte l?gga till fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2799
+#: UI/GTK2/src/mainWindow.cc:2801
 msgid "Added new query"
 msgstr "Lade till ny fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2812
+#: UI/GTK2/src/mainWindow.cc:2814
 msgid "Query is not set"
 msgstr "Fr?gan ?r inte inst?lld"
 
-#: UI/GTK2/src/mainWindow.cc:2823
+#: UI/GTK2/src/mainWindow.cc:2825
 msgid "No search engine selected"
 msgstr "Ingen s?kmotor vald"
 
-#: UI/GTK2/src/mainWindow.cc:2910
+#: UI/GTK2/src/mainWindow.cc:2912
 msgid "Please set the Google API key first"
 msgstr "St?ll in Google API-nyckeln f?rst"
 
-#: UI/GTK2/src/mainWindow.cc:2919
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Running query"
 msgstr "K?r fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:3103
+#: UI/GTK2/src/mainWindow.cc:3105
 msgid "No default application defined for type"
 msgstr "Inget standardprogram definierat f?r typen"
 
@@ -458,64 +458,64 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:203 UI/GTK2/src/pinot-dbus-daemon.cc:284
+#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
 #: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
 msgid "Unknown"
 msgstr "Ok?nd"
 
-#: UI/GTK2/src/pinot.cc:204 UI/GTK2/src/pinot-dbus-daemon.cc:285
+#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
 msgid "Danish"
 msgstr "Danska"
 
-#: UI/GTK2/src/pinot.cc:205 UI/GTK2/src/pinot-dbus-daemon.cc:286
+#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Dutch"
 msgstr "Nederl?ndska"
 
-#: UI/GTK2/src/pinot.cc:206 UI/GTK2/src/pinot-dbus-daemon.cc:287
+#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "English"
 msgstr "Engelska"
 
-#: UI/GTK2/src/pinot.cc:207 UI/GTK2/src/pinot-dbus-daemon.cc:288
+#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "Finnish"
 msgstr "Finska"
 
-#: UI/GTK2/src/pinot.cc:208 UI/GTK2/src/pinot-dbus-daemon.cc:289
+#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "French"
 msgstr "Franska"
 
-#: UI/GTK2/src/pinot.cc:209 UI/GTK2/src/pinot-dbus-daemon.cc:290
+#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "German"
 msgstr "Tyska"
 
-#: UI/GTK2/src/pinot.cc:210 UI/GTK2/src/pinot-dbus-daemon.cc:291
+#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "Italian"
 msgstr "Italienska"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
+#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Norwegian"
 msgstr "Norska"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Portuguese"
 msgstr "Portugisiska"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Russian"
 msgstr "Ryska"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Spanish"
 msgstr "Spanska"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Swedish"
 msgstr "Svenska"
 
-#: UI/GTK2/src/pinot.cc:239
+#: UI/GTK2/src/pinot.cc:247
 msgid "Couldn't open index"
 msgstr "Kunde inte ?ppna index"
 
-#: UI/GTK2/src/pinot.cc:255
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't create history database"
 msgstr "Kunde inte skapa historikdatabas"
 
@@ -531,7 +531,7 @@
 msgid "Personal"
 msgstr "Personlig"
 
-#: UI/GTK2/src/PinotSettings.cpp:1085
+#: UI/GTK2/src/PinotSettings.cpp:1082
 msgid "Unclassified"
 msgstr "Oklassificerad"
 
@@ -786,8 +786,8 @@
 
 #: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
 #: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1488
-#: UI/GTK2/src/WorkerThreads.cpp:1621
+#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
+#: UI/GTK2/src/WorkerThreads.cpp:1631
 msgid "Index error on"
 msgstr "Indexfel p?"
 
@@ -811,26 +811,26 @@
 msgid "Couldn't retrieve"
 msgstr "Kunde inte h?mta"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1334
+#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
 msgid "Cannot index document type"
 msgstr "Kan inte indexera dokumenttyp"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1338
+#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "at"
 msgstr "p?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1369
+#: UI/GTK2/src/WorkerThreads.cpp:1376
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META-tagg f?rbjuder indexering"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1420
+#: UI/GTK2/src/WorkerThreads.cpp:1430
 msgid "Couldn't index"
 msgstr "Kunde inte indexera"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1499
+#: UI/GTK2/src/WorkerThreads.cpp:1509
 msgid "Couldn't unindex document(s)"
 msgstr "Kunde inte avindexera dokument"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1633
+#: UI/GTK2/src/WorkerThreads.cpp:1643
 msgid "Couldn't update document"
 msgstr "Kunde inte uppdatera dokument"



From fabricecolin at mail.berlios.de  Tue Mar  6 11:24:43 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 6 Mar 2007 11:24:43 +0100
Subject: [Pinot-svn] r755 - trunk
Message-ID: <200703061024.l26AOhDG018530@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-06 11:24:42 +0100 (Tue, 06 Mar 2007)
New Revision: 755

Modified:
   trunk/NEWS
   trunk/README
Log:
Describe work-around for threading problem on FreeBSD.
Release date is now today ;-)


Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2007-03-05 11:45:02 UTC (rev 754)
+++ trunk/NEWS	2007-03-06 10:24:42 UTC (rev 755)
@@ -1,4 +1,4 @@
-2007/03/05 version_0_7_0
+2007/03/06 version_0_7_0
 Tokenize :
  - now use Dijon's filters (http://dijon.berlios.de/)
 Index :

Modified: trunk/README
===================================================================
--- trunk/README	2007-03-05 11:45:02 UTC (rev 754)
+++ trunk/README	2007-03-06 10:24:42 UTC (rev 755)
@@ -403,18 +403,24 @@
     "--enable-threadsafe --enable-threads-override-locks" to configure.
 
   * If you have built Pinot from source, make sure you have done a "make install".
-    Pinot will fail to start if it can't find stuff it needs, its icon for instance.
+    Pinot will fail to start if it can't find stuff it needs, its icon for
+    instance.
 
   * If "make install" fails with an error about Categories in pinot.desktop
-    and you have desktop-file-utils 0.11, either downgrade to 0.10 or upgrade to 0.12
-    if possible, or edit the top-level Makefile and replace the line 
+    and you have desktop-file-utils 0.11, either downgrade to 0.10 or upgrade
+    to 0.12 if possible, or edit the top-level Makefile and replace the line
      @desktop-file-install --vendor="" --dir=$(DESTDIR)$(datadir)/applications pinot.desktop
     with
      $(INSTALL_DATA) pinot.desktop $(DESTDIR)$(datadir)/applications/pinot.desktop
     and run "make install" again.
 
-  * The directory filter doesn't work as expected if the filter starts with a
-    non alpha-numeric character
-    This has been fixed in Xapian 0.9.8.
+  * In stored queries, the directory filter doesn't work as expected if the
+    directory name starts with a non alpha-numeric character. This has been
+    fixed in Xapian 0.9.8.
 
+  * On FreeBSD, threading issues may cause the daemon to crash unexpectedly.
+    A fix is to add the following lines to /etc/libmap.conf (which may not exist) :
+     libpthread.so.2         libc_r.so.6
+     libpthread.so           libc_r.so
+    Refer to the libmap.conf(5) man page for details.
 



From fabricecolin at mail.berlios.de  Tue Mar  6 11:30:27 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 6 Mar 2007 11:30:27 +0100
Subject: [Pinot-svn] r756 - tags
Message-ID: <200703061030.l26AURvQ019010@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-06 11:30:26 +0100 (Tue, 06 Mar 2007)
New Revision: 756

Added:
   tags/version_0_7_0/
Log:
Releasing 0.70 today.


Copied: tags/version_0_7_0 (from rev 755, trunk)



From fabricecolin at mail.berlios.de  Wed Mar  7 16:08:04 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 7 Mar 2007 16:08:04 +0100
Subject: [Pinot-svn] r757 - in trunk: . Collect
Message-ID: <200703071508.l27F84gT025024@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-07 16:08:04 +0100 (Wed, 07 Mar 2007)
New Revision: 757

Modified:
   trunk/Collect/DownloaderInterface.cpp
   trunk/configure.in
Log:
Curl might not have been built against OpenSSL so check the output of
'curl-config --features' and act accordingly.
This was reported by Reuben Thomas.


Modified: trunk/Collect/DownloaderInterface.cpp
===================================================================
--- trunk/Collect/DownloaderInterface.cpp	2007-03-06 10:30:26 UTC (rev 756)
+++ trunk/Collect/DownloaderInterface.cpp	2007-03-07 15:08:04 UTC (rev 757)
@@ -19,50 +19,55 @@
 #include <pthread.h>
 #include <iostream>
 
+#ifdef USE_SSL
 #include <openssl/crypto.h>
+#endif
 
 #include "DownloaderInterface.h"
 
 using namespace std;
 
+#ifdef USE_SSL
 // OpenSSL multi-thread support, required by Curl
 static pthread_mutex_t locksTable[CRYPTO_NUM_LOCKS];
 
 // OpenSSL locking functiom
 static void lockingCallback(int mode, int n, const char *file, int line)
 {
-        int status = 0;
+	int status = 0;
 
-        if (mode & CRYPTO_LOCK)
-        {
-                status = pthread_mutex_lock(&(locksTable[n]));
+	if (mode & CRYPTO_LOCK)
+	{
+		status = pthread_mutex_lock(&(locksTable[n]));
 #ifdef DEBUG
-                if (status != 0)
-                {
-                        cout << "lockingCallback: failed to lock mutex " << n << endl;
-                }
+		if (status != 0)
+		{
+			cout << "lockingCallback: failed to lock mutex " << n << endl;
+		}
 #endif
-        }
-        else
-        {
-                status = pthread_mutex_unlock(&(locksTable[n]));
+	}
+	else
+	{
+		status = pthread_mutex_unlock(&(locksTable[n]));
 #ifdef DEBUG
-                if (status != 0)
-                {
-                        cout << "lockingCallback: failed to unlock mutex " << n << endl;
-                }
+		if (status != 0)
+		{
+			cout << "lockingCallback: failed to unlock mutex " << n << endl;
+		}
 #endif
-        }
+	}
 }
 
 static unsigned long idCallback(void)
 {
-        return (unsigned long)pthread_self();
+	return (unsigned long)pthread_self();
 }
+#endif
 
 /// Initialize downloaders.
 void DownloaderInterface::initialize(void)
 {
+#ifdef USE_SSL
 	pthread_mutexattr_t mutexAttr;
 
 	pthread_mutexattr_init(&mutexAttr);
@@ -78,11 +83,13 @@
 	CRYPTO_set_id_callback(idCallback);
 
 	pthread_mutexattr_destroy(&mutexAttr);
+#endif
 }
 
 /// Shutdown downloaders.
 void DownloaderInterface::shutdown(void)
 {
+#ifdef USE_SSL
 	// Reset the OpenSSL callbacks
 	CRYPTO_set_id_callback(NULL);
 	CRYPTO_set_locking_callback(NULL);
@@ -92,6 +99,7 @@
 	{
 		pthread_mutex_destroy(&(locksTable[lockNum]));
 	}
+#endif
 }
 
 DownloaderInterface::DownloaderInterface() :

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2007-03-06 10:30:26 UTC (rev 756)
+++ trunk/configure.in	2007-03-07 15:08:04 UTC (rev 757)
@@ -122,7 +122,7 @@
 neon)
 PKG_CHECK_MODULES(NEON, neon >= 0.24 )
 PKG_CHECK_MODULES(SSL, openssl >= 0.9.7 )
-HTTP_LIBRARY="USE_NEON"
+EXTRA_HTTP_CFLAGS="-DUSE_NEON -DUSE_SSL"
 HTTP_DOWNLOADER="NeonDownloader"
 ;;
 curl)
@@ -133,7 +133,15 @@
 fi
 CURL_CFLAGS=`$CURL_CONFIG --cflags`
 CURL_LIBS=`$CURL_CONFIG --libs`
-HTTP_LIBRARY="USE_CURL"
+AC_MSG_CHECKING(whether curl needs OpenSSL)
+CURL_SSL_FEATURE=`$CURL_CONFIG --features | grep -i SSL`
+if test "x$CURL_SSL_FEATURE" = "x"; then
+   EXTRA_HTTP_CFLAGS="-DUSE_CURL"
+   AC_MSG_RESULT(no)
+else
+   EXTRA_HTTP_CFLAGS="-DUSE_CURL -DUSE_SSL"
+   AC_MSG_RESULT(yes)
+fi
 HTTP_DOWNLOADER="CurlDownloader"
 ;;
 esac
@@ -223,7 +231,7 @@
 PKG_CHECK_MODULES(SQL, sqlite3 >= 3.1 )
 AC_SUBST(SQL_CFLAGS)
 AC_SUBST(SQL_LIBS)
-HTTP_CFLAGS="$NEON_CFLAGS $SSL_CFLAGS $CURL_CFLAGS -D$HTTP_LIBRARY"
+HTTP_CFLAGS="$NEON_CFLAGS $SSL_CFLAGS $CURL_CFLAGS $EXTRA_HTTP_CFLAGS"
 HTTP_LIBS="$NEON_LIBS $SSL_LIBS $CURL_LIBS"
 AC_SUBST(HTTP_CFLAGS)
 AC_SUBST(HTTP_LIBS)



From fabricecolin at mail.berlios.de  Thu Mar  8 13:59:00 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 8 Mar 2007 13:59:00 +0100
Subject: [Pinot-svn] r758 - trunk
Message-ID: <200703081259.l28Cx0QZ025605@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-08 13:58:59 +0100 (Thu, 08 Mar 2007)
New Revision: 758

Modified:
   trunk/TODO
Log:
Keep track of stuff I told Reuben I would do :-)


Modified: trunk/TODO
===================================================================
--- trunk/TODO	2007-03-07 15:08:04 UTC (rev 757)
+++ trunk/TODO	2007-03-08 12:58:59 UTC (rev 758)
@@ -1,3 +1,14 @@
+Documentation
+- dotfiles are skipped
+- symlinks to GAIM logs and hidden mail will enable indexing
+- how is My Web Pages populated; talk about use as document storage
+- how to show Web engines
+- difference between setting up external indexes with + and installing plugins
+- list what files from libtextcat 2.2 go where ?
+- MIME type should be as returned by xdg-utils' 'xdg-mime query filetype ...'
+- try listing names of dependency packages for most distros
+- how to trouble-shoot with delve, get to a file with filters and labels
+
 General
 - Fix the FIXMEs
 - Get rid of dead code/classes/methods...
@@ -33,6 +44,7 @@
 - Make download timeout configurable
 - Support for HTML frames
 - Curl and Neon must support a proxy, so allow to configure that
+- MBoxCollector should return headers too !
 
 Search
 - With engines that provide a redirection URL for results (eg Acoona), it looks like
@@ -49,6 +61,7 @@
 - Allow sorting by date
 - Get hold of stopwords lists for the languages supported by Xapian's stemmers
  and remove stopwords from queries as first step of search
+- Make multi-step index search optional
 
 Index
 - Play around with the XAPIAN_FLUSH_THRESHOLD env var
@@ -94,6 +107,7 @@
 - There's currently no way to get a document's ID without running a search
 - Allow notifications when configuration should be reloaded
 - Implement Wasabi draft(s)
+- SimpleQuery to switch multi-step search on
 
 UI
 - When sorting results by host name, give better score to results that appear several times
@@ -114,4 +128,8 @@
  to get hold of a revision of the index ?
 - GTK has a file chooser button, does glade-- have support for it ?
 - Query expansion should be interactive
-
+- UI doesn't show documents indexed by the daemon the very first time it's run, at least until
+ it's restarted; doing a flush at startup if the index is empty might fix that
+- Status window should be live. Errors should say what failed !
+- Multi-step search should be off to start with. If no exact match is found, show a button
+ in the results group to allow the user to try step 2 and beyond



From fabricecolin at mail.berlios.de  Sat Mar 10 08:09:31 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 10 Mar 2007 08:09:31 +0100
Subject: [Pinot-svn] r759 - in trunk: Index UI/GTK2/src
Message-ID: <200703100709.l2A79VKk006446@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-10 08:09:30 +0100 (Sat, 10 Mar 2007)
New Revision: 759

Modified:
   trunk/Index/pinot-index.cpp
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/UI/GTK2/src/pinot.cc
Log:
Initialize HtmlFilter before loading the filters.


Modified: trunk/Index/pinot-index.cpp
===================================================================
--- trunk/Index/pinot-index.cpp	2007-03-08 12:58:59 UTC (rev 758)
+++ trunk/Index/pinot-index.cpp	2007-03-10 07:09:30 UTC (rev 759)
@@ -126,6 +126,7 @@
 
 	MIMEScanner::initialize();
 	DownloaderInterface::initialize();
+	Dijon::HtmlFilter::initialize();
 	Dijon::FilterFactory::loadFilters(string(LIBDIR) + string("/pinot/filters"));
 
 	// Make sure the index is open in the correct mode
@@ -135,6 +136,7 @@
 		cerr << "Couldn't open index " << databaseName << endl;
 
 		Dijon::FilterFactory::unloadFilters();
+		Dijon::HtmlFilter::shutdown();
 		DownloaderInterface::shutdown();
 		MIMEScanner::shutdown();
 
@@ -149,6 +151,7 @@
 
 		XapianDatabaseFactory::closeAll();
 		Dijon::FilterFactory::unloadFilters();
+		Dijon::HtmlFilter::shutdown();
 		DownloaderInterface::shutdown();
 		MIMEScanner::shutdown();
 
@@ -179,6 +182,7 @@
 
 			XapianDatabaseFactory::closeAll();
 			Dijon::FilterFactory::unloadFilters();
+			Dijon::HtmlFilter::shutdown();
 			DownloaderInterface::shutdown();
 			MIMEScanner::shutdown();
 
@@ -254,6 +258,7 @@
 
 	XapianDatabaseFactory::closeAll();
 	Dijon::FilterFactory::unloadFilters();
+	Dijon::HtmlFilter::shutdown();
 	DownloaderInterface::shutdown();
 	MIMEScanner::shutdown();
 

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2007-03-08 12:58:59 UTC (rev 758)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2007-03-10 07:09:30 UTC (rev 759)
@@ -84,6 +84,7 @@
 
 	// Close the tokenizer libraries
 	Dijon::FilterFactory::unloadFilters();
+	Dijon::HtmlFilter::shutdown();
 
 	// Restore the stream buffers
 	if (g_coutBuf != NULL)
@@ -304,6 +305,7 @@
 	Languages::setIntlName(12, _("Swedish"));
 
 	// Load tokenizer libraries, if any
+	Dijon::HtmlFilter::initialize();
 	Dijon::FilterFactory::loadFilters(string(LIBDIR) + "/pinot/filters");
 	Dijon::FilterFactory::loadFilters(confDirectory + "/filters");
 	// Load the settings

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2007-03-08 12:58:59 UTC (rev 758)
+++ trunk/UI/GTK2/src/pinot.cc	2007-03-10 07:09:30 UTC (rev 759)
@@ -78,6 +78,7 @@
 
 	// Close the tokenizer libraries
 	Dijon::FilterFactory::unloadFilters();
+	Dijon::HtmlFilter::shutdown();
 
 	// Restore the stream buffers
 	if (g_coutBuf != NULL)
@@ -226,6 +227,7 @@
 	settings.loadSearchEngines(prefixDir + "/share/pinot/engines");
 	settings.loadSearchEngines(confDirectory + "/engines");
 	// Load tokenizer libraries, if any
+	Dijon::HtmlFilter::initialize();
 	Dijon::FilterFactory::loadFilters(string(LIBDIR) + "/pinot/filters");
 	Dijon::FilterFactory::loadFilters(confDirectory + "/filters");
 	// Load the settings



From fabricecolin at mail.berlios.de  Mon Mar 12 13:49:05 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 12 Mar 2007 13:49:05 +0100
Subject: [Pinot-svn] r760 - in trunk: . Collect
Message-ID: <200703121249.l2CCn5oH015551@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-12 13:49:05 +0100 (Mon, 12 Mar 2007)
New Revision: 760

Removed:
   trunk/Collect/XapianCollector.cpp
   trunk/Collect/XapianCollector.h
   trunk/Collect/pinot-collect.1
   trunk/Collect/pinot-collect.cpp
Modified:
   trunk/Collect/DownloaderFactory.cpp
   trunk/Collect/Makefile.am
   trunk/Makefile.am
   trunk/pinot.spec.in
Log:
XapianCollector is no longer needed. Removed pinot-collect.


Modified: trunk/Collect/DownloaderFactory.cpp
===================================================================
--- trunk/Collect/DownloaderFactory.cpp	2007-03-10 07:09:30 UTC (rev 759)
+++ trunk/Collect/DownloaderFactory.cpp	2007-03-12 12:49:05 UTC (rev 760)
@@ -16,7 +16,6 @@
  *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
  */
 
-#include "XapianCollector.h"
 #ifdef USE_NEON
 #include "NeonDownloader.h"
 #else
@@ -54,10 +53,6 @@
 #endif
 #endif
 	}
-	else if (protocol == "xapian")
-	{
-		pDownloader = new XapianCollector();
-	}
 	else if (protocol == "file")
 	{
 		pDownloader = new FileCollector();

Modified: trunk/Collect/Makefile.am
===================================================================
--- trunk/Collect/Makefile.am	2007-03-10 07:09:30 UTC (rev 759)
+++ trunk/Collect/Makefile.am	2007-03-12 12:49:05 UTC (rev 760)
@@ -6,28 +6,17 @@
 	DownloaderInterface.h \
 	FileCollector.h \
 	MboxCollector.h \
-	NeonDownloader.h \
-	XapianCollector.h
+	NeonDownloader.h
 
 noinst_LTLIBRARIES = libCollect.la
 
-bin_PROGRAMS = pinot-collect
-
 libCollect_la_SOURCES = \
 	@HTTP_DOWNLOADER at .cpp \
 	DownloaderFactory.cpp \
 	DownloaderInterface.cpp \
 	FileCollector.cpp \
-	MboxCollector.cpp \
-	XapianCollector.cpp
+	MboxCollector.cpp
 
-pinot_collect_SOURCES = \
-	pinot-collect.cpp
-
-pinot_collect_LDADD = -L../Utils -L../Tokenize \
-	-lCollect -lTokenize -lUtils -lBasicUtils \
-	@GLIBMM_LIBS@ @INDEX_LIBS@ @XML_LIBS@ @GMIME_LIBS@ @HTTP_LIBS@ @MISC_LIBS@
-
 AM_CXXFLAGS = -I$(srcdir)/../Utils -I$(srcdir)/../Tokenize -I$(srcdir)/../Tokenize/filters \
 	@INDEX_CFLAGS@ @XML_CFLAGS@ @HTTP_CFLAGS@ @GMIME_CFLAGS@ @GLIBMM_CFLAGS@
 

Deleted: trunk/Collect/XapianCollector.cpp
===================================================================
--- trunk/Collect/XapianCollector.cpp	2007-03-10 07:09:30 UTC (rev 759)
+++ trunk/Collect/XapianCollector.cpp	2007-03-12 12:49:05 UTC (rev 760)
@@ -1,203 +0,0 @@
-/*
- *  Copyright 2005,2006 Fabrice Colin
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU Library General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
- */
-
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <unistd.h>
-#include <stdio.h>
-#include <stdarg.h>
-#include <pthread.h>
-#include <iostream>
-
-#include "IndexedDocument.h"
-#include "StringManip.h"
-#include "Url.h"
-#include "XapianCollector.h"
-
-using namespace std;
-
-XapianCollector::XapianCollector() :
-	DownloaderInterface()
-{
-	m_databaseName = "";
-	// Always get documents data from the index
-	m_getDocData = true;
-	m_pDatabase = NULL;
-}
-
-XapianCollector::XapianCollector(const string &database, bool getDocData) :
-	DownloaderInterface()
-{
-	m_databaseName = database;
-	m_getDocData = getDocData;
-	m_pDatabase = NULL;
-
-	// Try opening this database
-	if (openDatabase() == false)
-	{
-		m_databaseName.clear();
-		m_pDatabase = NULL;
-	}
-	m_getDocData = getDocData;
-}
-
-XapianCollector::~XapianCollector()
-{
-	if (m_pDatabase != NULL)
-	{
-		delete m_pDatabase;
-	}
-}
-
-bool XapianCollector::openDatabase(void)
-{
-	struct stat dbStat;
-
-	if (m_databaseName.empty() == true)
-	{
-		return false;
-	}
-
-	// The specified path must be either a directory or a symlink (to a directory)
-	if (stat(m_databaseName.c_str(), &dbStat) == -1)
-	{
-		// Database directory doesn't exist
-		cerr << "XapianCollector::openDatabase: " << m_databaseName << " doesn't exist" << endl;
-		return false;
-	}
-	else if (!S_ISDIR(dbStat.st_mode))
-	{
-		cerr << "XapianCollector::openDatabase: " << m_databaseName << " is not a directory" << endl;
-		return false;
-	}
-
-	// Try opening it now
-	try
-	{
-#ifdef DEBUG
-		cout << "XapianCollector::openDatabase: opening database " << m_databaseName << endl;
-#endif
-		m_pDatabase = new Xapian::Database(m_databaseName);
-
-		return true;
-	}
-	catch (const Xapian::Error &error)
-	{
-		cerr << "XapianCollector::openDatabase: couldn't open database: " << error.get_msg() << endl;
-	}
-
-	return false;
-}
-
-//
-// Implementation of DownloaderInterface
-//
-
-/// Retrieves the specified document; NULL if error.
-Document *XapianCollector::retrieveUrl(const DocumentInfo &docInfo)
-{
-	string url = docInfo.getLocation();
-	Url thisUrl(url);
-
-	if (thisUrl.getProtocol() != "xapian")
-	{
-		// We can't handle that type of protocol...
-		return NULL;
-	}
-
-	// Ignore host portion of the URL as we can only deal with local indexes
-	// Get the database location and document ID out of the location field
-	string database = thisUrl.getLocation();
-	string documentId = thisUrl.getFile();
-	Xapian::docid docId;
-	sscanf(documentId.c_str(), "%u", &docId);
-#ifdef DEBUG
-	cout << "XapianCollector::retrieveUrl: database is " << database << ", document ID is " << docId << endl;
-#endif
-
-	// The constructor may already have opened an index, check this URL corresponds
-	if (database != m_databaseName)
-	{
-		// The requested URL is in some other index
-		if (m_pDatabase != NULL)
-		{
-			delete m_pDatabase;
-			m_pDatabase = NULL;
-		}
-		// Try opening that index then
-		m_databaseName = database;
-		if (openDatabase() == false)
-		{
-			m_pDatabase = NULL;
-			m_databaseName.clear();
-		}
-	}
-
-	if (m_pDatabase == NULL)
-	{
-		return NULL;
-	}
-
-	IndexedDocument *pIndexedDoc = NULL;
-
-	try
-	{
-		// Now retrieve the desired document
-		Xapian::Document doc = m_pDatabase->get_document(docId);
-		// ... and its data
-		string record = doc.get_data();
-
-		// Extract the title, location, summary, type and timestamp
-		string title = StringManip::extractField(record, "caption=", "\n");
-#ifdef DEBUG
-		cout << "XapianCollector::retrieveUrl: found omindex title " << title << endl;
-#endif
-		string location = StringManip::extractField(record, "url=", "\n");
-		string type = StringManip::extractField(record, "type=", "\n");
-		string timestamp = StringManip::extractField(record, "timestamp=", "\n");
-		string language = StringManip::extractField(record, "language=", "\n");
-		string bytesSize = StringManip::extractField(record, "size=", "\n");
-#ifdef DEBUG
-		cout << "XapianCollector::retrieveUrl: " << docId << " was indexed from " << location << " at " << timestamp << endl;
-#endif
-
-		pIndexedDoc = new IndexedDocument(title, url, location, type, language);
-		pIndexedDoc->setTimestamp(timestamp);
-		if (bytesSize.empty() == false)
-		{
-			pIndexedDoc->setSize((off_t)atol(bytesSize.c_str()));
-		}
-
-		// Extract document's data ?
-		if (m_getDocData == true)
-		{
-			// The only data we have at hand is the summary
-			string summary = StringManip::extractField(record, "sample=", "\n");
-#ifdef DEBUG
-			cout << "XapianCollector::retrieveUrl: found omindex summary " << summary << endl;
-#endif
-			pIndexedDoc->setData(summary.c_str(), summary.length());
-		}
-	}
-	catch (const Xapian::Error &error)
-	{
-		cerr << "Couldn't retrieve document: " << error.get_msg() << endl;
-	}
-
-	return pIndexedDoc;
-}

Deleted: trunk/Collect/XapianCollector.h
===================================================================
--- trunk/Collect/XapianCollector.h	2007-03-10 07:09:30 UTC (rev 759)
+++ trunk/Collect/XapianCollector.h	2007-03-12 12:49:05 UTC (rev 760)
@@ -1,52 +0,0 @@
-/*
- *  Copyright 2005,2006 Fabrice Colin
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU Library General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
- */
-
-#ifndef _XAPIAN_COLLECTOR_H
-#define _XAPIAN_COLLECTOR_H
-
-#include <string>
-
-#include <xapian.h>
-
-#include "DownloaderInterface.h"
-
-/// Downloader for documents in a Xapian index.
-class XapianCollector : public DownloaderInterface
-{
-	public:
-		XapianCollector();
-		XapianCollector(const std::string &database, bool getDocData);
-		virtual ~XapianCollector();
-
-		/// Retrieves the specified document; NULL if error. Caller deletes.
-		virtual Document *retrieveUrl(const DocumentInfo &docInfo);
-
-	protected:
-		std::string m_databaseName;
-		bool m_getDocData;
-		Xapian::Database *m_pDatabase;
-
-		bool openDatabase(void);
-
-	private:
-		XapianCollector(const XapianCollector &other);
-		XapianCollector &operator=(const XapianCollector &other);
-
-};
-
-#endif // _XAPIAN_COLLECTOR_H

Deleted: trunk/Collect/pinot-collect.1
===================================================================
--- trunk/Collect/pinot-collect.1	2007-03-10 07:09:30 UTC (rev 759)
+++ trunk/Collect/pinot-collect.1	2007-03-12 12:49:05 UTC (rev 760)
@@ -1,26 +0,0 @@
-.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-COLLECT "1" "March 2007" "pinot-collect - pinot 0.70" "User Commands"
-.SH NAME
-pinot-collect \- Download an URL from the command-line
-.SH SYNOPSIS
-.B pinot-collect
-[\fIOPTIONS\fR] \fIURL\fR
-.SH DESCRIPTION
-pinot\-collect \- Download an URL from the command\-line
-.SH OPTIONS
-.TP
-\fB\-h\fR, \fB\-\-help\fR
-display this help and exit
-.TP
-\fB\-v\fR, \fB\-\-version\fR
-output version information and exit
-.SH EXAMPLES
-.IP
-pinot\-collect http://some.website.com/
-pinot\-collect xapian:///home/fabrice/.pinot/index/1
-.SH "REPORTING BUGS"
-Report bugs to fabricecolin at users.berlios.de
-.PP
-This is free software.  You may redistribute copies of it under the terms of
-the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.
-There is NO WARRANTY, to the extent permitted by law.

Deleted: trunk/Collect/pinot-collect.cpp
===================================================================
--- trunk/Collect/pinot-collect.cpp	2007-03-10 07:09:30 UTC (rev 759)
+++ trunk/Collect/pinot-collect.cpp	2007-03-12 12:49:05 UTC (rev 760)
@@ -1,150 +0,0 @@
-/*
- *  Copyright 2005,2006 Fabrice Colin
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU Library General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
- */
-
-#include <getopt.h>
-#include <stdio.h>
-#include <stdlib.h>
-#include <string>
-#include <iostream>
-#include <fstream>
-
-#include "MIMEScanner.h"
-#include "Url.h"
-#include "DownloaderFactory.h"
-#include "config.h"
-
-using namespace std;
-
-static struct option g_longOptions[] = {
-	{"help", 0, 0, 'h'},
-	{"version", 0, 0, 'v'},
-	{0, 0, 0, 0}
-};
-
-int main(int argc, char **argv)
-{
-	int longOptionIndex = 0;
-
-	// Look at the options
-	int optionChar = getopt_long(argc, argv, "hv", g_longOptions, &longOptionIndex);
-	while (optionChar != -1)
-	{
-		switch (optionChar)
-		{
-			case 'h':
-				// Help
-				cout << "pinot-collect - Download an URL from the command-line\n\n"
-					<< "Usage: pinot-collect [OPTIONS] URL\n\n"
-					<< "Options:\n"
-					<< "  -h, --help		display this help and exit\n"
-					<< "  -v, --version		output version information and exit\n"
-					<< "\nExamples:\n"
-					<< "  pinot-collect http://some.website.com/\n"
-					<< "  pinot-collect xapian:///home/fabrice/.pinot/index/1\n"
-					<< "\nReport bugs to " << PACKAGE_BUGREPORT << endl;
-				return EXIT_SUCCESS;
-			case 'v':
-				cout << "pinot-collect - " << PACKAGE_STRING << "\n\n"
-					<< "This is free software.  You may redistribute copies of it under the terms of\n"
-					<< "the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.\n"
-					<< "There is NO WARRANTY, to the extent permitted by law." << endl;
-				return EXIT_SUCCESS;
-			default:
-				return EXIT_FAILURE;
-		}
-
-		// Next option
-		optionChar = getopt_long(argc, argv, "hv", g_longOptions, &longOptionIndex);
-	}
-
-	if (argc < 2)
-	{
-		cerr << "Not enough parameters" << endl;
-		return EXIT_FAILURE;
-	}
-
-	MIMEScanner::initialize();
-	DownloaderInterface::initialize();
-
-	string url(argv[1]);
-	Url thisUrl(url);
-	cout << "Protocol: " << thisUrl.getProtocol() << endl;
-	cout << "User: " << thisUrl.getUser() << endl;
-	cout << "Password: " << thisUrl.getPassword() << endl;
-	cout << "Host: " << thisUrl.getHost() << endl;
-	cout << "Location: " << thisUrl.getLocation() << endl;
-	cout << "File: " << thisUrl.getFile() << endl;
-	cout << "Parameters: " << thisUrl.getParameters() << endl;
-
-	// Which Downloader ?
-	DownloaderInterface *pDownloader = DownloaderFactory::getDownloader(thisUrl.getProtocol());
-	if (pDownloader == NULL)
-	{
-		cerr << "Couldn't obtain downloader for protocol " << thisUrl.getProtocol() << endl;
-
-		DownloaderInterface::shutdown();
-		MIMEScanner::shutdown();
-
-		return EXIT_FAILURE;
-	}
-
-	DocumentInfo docInfo("Test", url, "", "");
-	Document *pDoc = pDownloader->retrieveUrl(docInfo);
-	if (pDoc == NULL)
-	{
-		cerr << "Download operation failed !" << endl;
-	}
-	else
-	{
-		cout << "Type: " << pDoc->getType() << endl;
-
-		unsigned int contentLen;
-		const char *pContent = pDoc->getData(contentLen);
-
-		if ((pContent != NULL) &&
-			(contentLen > 0))
-		{
-			string fileName(thisUrl.getFile());
-
-			if (fileName.empty() == true)
-			{
-				fileName = "index.html";
-			}
-
-			cout << "Saving " << contentLen << " bytes to " << fileName << endl;
-
-			// Save the content to a file
-			ofstream outputFile(fileName.c_str());
-			outputFile.write(pContent, contentLen);
-			outputFile.close();
-		}
-		else
-		{
-			cout << "Document is empty" << endl;
-		}
-
-		delete pDoc;
-	}
-
-	delete pDownloader;
-
-	DownloaderInterface::shutdown();
-	MIMEScanner::shutdown();
-
-	return EXIT_SUCCESS;
-}

Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2007-03-10 07:09:30 UTC (rev 759)
+++ trunk/Makefile.am	2007-03-12 12:49:05 UTC (rev 760)
@@ -6,14 +6,14 @@
 	textcat_conf.txt textcat3_conf.txt \
 	pinot.desktop pinot-dbus-daemon.desktop pinot.spec \
 	Search/Plugins/*src Search/Plugins/*.xml \
-	Collect/pinot-collect.1 Index/pinot-index.1 Search/pinot-search.1 \
+	Index/pinot-index.1 Search/pinot-search.1 \
 	UI/GTK2/src/pinot.1 UI/GTK2/src/pinot-dbus-daemon.1 \
 	UI/GTK2/src/pinot-dbus-daemon.xml UI/GTK2/src/de.berlios.Pinot.service \
 	UI/GTK2/xapian-powered.png UI/GTK2/pinot.png \
 	UI/GTK2/metase-gtk2.glade UI/GTK2/metase-gtk2.gladep \
 	scripts/bash/pinot-enum-index.sh scripts/python/pinot-live.py
 
-man_MANS = Collect/pinot-collect.1 Index/pinot-index.1 Search/pinot-search.1 \
+man_MANS = Index/pinot-index.1 Search/pinot-search.1 \
 	UI/GTK2/src/pinot.1 UI/GTK2/src/pinot-dbus-daemon.1
 
 install-data-local:

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2007-03-10 07:09:30 UTC (rev 759)
+++ trunk/pinot.spec.in	2007-03-12 12:49:05 UTC (rev 760)
@@ -93,7 +93,6 @@
 %config(noreplace) %{_sysconfdir}/pinot/textcat_conf.txt
 %config(noreplace) %{_sysconfdir}/pinot/textcat3_conf.txt
 %{_bindir}/pinot
-%ghost %{_bindir}/pinot-collect
 %{_bindir}/pinot-dbus-daemon
 %{_bindir}/pinot-index
 %{_bindir}/pinot-search
@@ -135,7 +134,6 @@
 %{_sysconfdir}/xdg/autostart/*.desktop
 %{_datadir}/applications/*.desktop
 %{_mandir}/man1/pinot.*
-%ghost %{_mandir}/man1/pinot-collect.*
 %{_mandir}/man1/pinot-dbus-daemon.*
 %{_mandir}/man1/pinot-index.*
 %{_mandir}/man1/pinot-search.*



From fabricecolin at mail.berlios.de  Mon Mar 12 15:33:23 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 12 Mar 2007 15:33:23 +0100
Subject: [Pinot-svn] r761 - trunk/Collect
Message-ID: <200703121433.l2CEXNsF025810@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-12 15:33:22 +0100 (Mon, 12 Mar 2007)
New Revision: 761

Modified:
   trunk/Collect/MboxCollector.cpp
Log:
Set property OPERATING_MODE to "view".


Modified: trunk/Collect/MboxCollector.cpp
===================================================================
--- trunk/Collect/MboxCollector.cpp	2007-03-12 12:49:05 UTC (rev 760)
+++ trunk/Collect/MboxCollector.cpp	2007-03-12 14:33:22 UTC (rev 761)
@@ -84,6 +84,9 @@
 		return NULL;
 	}
 
+	// We want to get extra content like headers
+	pFilter->set_property(Dijon::Filter::OPERATING_MODE, "view");
+
 	// The first document should be the message we are interested in
 	if ((pFilter->skip_to_document(parameters) == true) &&
 		(pFilter->has_documents() == true))



From fabricecolin at mail.berlios.de  Mon Mar 12 15:41:30 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 12 Mar 2007 15:41:30 +0100
Subject: [Pinot-svn] r762 - trunk/UI/GTK2/src
Message-ID: <200703121441.l2CEfUVS027828@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-12 15:41:30 +0100 (Mon, 12 Mar 2007)
New Revision: 762

Modified:
   trunk/UI/GTK2/src/pinot.cc
Log:
Don't bother with our little locale hack if it's already UTF8.


Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2007-03-12 14:33:22 UTC (rev 761)
+++ trunk/UI/GTK2/src/pinot.cc	2007-03-12 14:41:30 UTC (rev 762)
@@ -21,6 +21,7 @@
 #include <unistd.h>
 #include <libintl.h>
 #include <getopt.h>
+#include <strings.h>
 #include <iostream>
 #include <fstream>
 #include <glibmm.h>
@@ -166,6 +167,7 @@
 	// This will be useful for indexes served by xapian-progsrv+ssh
 	Glib::setenv("SSH_ASKPASS", prefixDir + "/libexec/openssh/ssh-askpass");
 
+	// This is a hack to force the locale to UTF-8
 	char *pLocale = setlocale(LC_ALL, NULL);
 	if (pLocale != NULL)
 	{
@@ -173,19 +175,28 @@
 
 		if (locale != "C")
 		{
+			bool appendUTF8 = false;
+
 			string::size_type pos = locale.find_last_of(".");
-			if (pos != string::npos)
+			if ((pos != string::npos) &&
+				((strcasecmp(locale.substr(pos).c_str(), ".utf8") != 0) &&
+				(strcasecmp(locale.substr(pos).c_str(), ".utf-8") != 0)))
 			{
 				locale.resize(pos);
+				appendUTF8 = true;
 			}
-			locale += ".UTF-8";
 
-			pLocale = setlocale(LC_ALL, locale.c_str());
-			if (pLocale != NULL)
+			if (appendUTF8 == true)
 			{
+				locale += ".UTF-8";
+
+				pLocale = setlocale(LC_ALL, locale.c_str());
+				if (pLocale != NULL)
+				{
 #ifdef DEBUG
-				cout << "Changed locale to " << pLocale << endl;
+					cout << "Changed locale to " << pLocale << endl;
 #endif
+				}
 			}
 		}
 	}



From fabricecolin at mail.berlios.de  Thu Mar 15 13:42:28 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 15 Mar 2007 13:42:28 +0100
Subject: [Pinot-svn] r763 - in trunk: Index UI/GTK2/src
Message-ID: <200703151242.l2FCgSgc028963@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-15 13:42:24 +0100 (Thu, 15 Mar 2007)
New Revision: 763

Modified:
   trunk/Index/DBusXapianIndex.cpp
   trunk/Index/DBusXapianIndex.h
   trunk/UI/GTK2/src/ServerThreads.cpp
   trunk/UI/GTK2/src/pinot-dbus-daemon.xml
   trunk/UI/GTK2/src/pinot.cc
Log:
Changed signatures of DBus methods Get and SetDocumentInfo to allow passing
any metadata field.
Define DBUS_API_SUBJECT_TO_CHANGE only if DBus version is < 1.0.


Modified: trunk/Index/DBusXapianIndex.cpp
===================================================================
--- trunk/Index/DBusXapianIndex.cpp	2007-03-12 14:41:30 UTC (rev 762)
+++ trunk/Index/DBusXapianIndex.cpp	2007-03-15 12:42:24 UTC (rev 763)
@@ -19,7 +19,9 @@
 #include <iostream>
 extern "C"
 {
+#if DBUS_VERSION < 1000000
 #define DBUS_API_SUBJECT_TO_CHANGE
+#endif
 #include <dbus/dbus.h>
 #include <dbus/dbus-glib.h>
 #include <dbus/dbus-glib-lowlevel.h>
@@ -36,6 +38,7 @@
 using std::set;
 using std::min;
 
+
 static DBusGConnection *getBusConnection(void)
 {
 	GError *pError = NULL;
@@ -102,6 +105,200 @@
 	}
 }
 
+/// Extracts docId and docInfo from a dbus message.
+bool DBusXapianIndex::documentInfoFromDBus(DBusMessageIter *iter, unsigned int &docId,
+	DocumentInfo &docInfo)
+{
+	DBusMessageIter array_iter;
+	DBusMessageIter struct_iter;
+
+	if (iter == NULL)
+	{
+		return false;
+	}
+
+	int type = dbus_message_iter_get_arg_type(iter);
+	if (type != DBUS_TYPE_UINT32)
+	{
+#ifdef DEBUG
+		cout << "DBusXapianIndex::documentInfoFromDBus: expected unsigned integer, got " << type << endl;
+#endif
+		return false;
+	}
+	dbus_message_iter_get_basic(iter, &docId);
+	dbus_message_iter_next(iter);
+	
+	type = dbus_message_iter_get_arg_type(iter);
+	if (type != DBUS_TYPE_ARRAY)
+	{
+#ifdef DEBUG
+		cout << "DBusXapianIndex::documentInfoFromDBus: expected array, got " << type << endl;
+#endif
+		return false;
+	}
+	dbus_message_iter_recurse(iter, &array_iter);
+
+	do
+	{
+		const gchar *pName = NULL;
+		const gchar *pValue = NULL;
+
+		type = dbus_message_iter_get_arg_type(&array_iter);
+		if (type != DBUS_TYPE_STRUCT)
+		{
+#ifdef DEBUG
+			cout << "DBusXapianIndex::documentInfoFromDBus: expected struct, got " << type << endl;
+#endif
+			return false;
+		}
+
+		dbus_message_iter_recurse(&array_iter, &struct_iter);
+		dbus_message_iter_get_basic(&struct_iter, &pName);
+		if (pName == NULL)
+		{
+#ifdef DEBUG
+			cout << "DBusXapianIndex::documentInfoFromDBus: invalid field name" << endl;
+#endif
+		}
+
+		dbus_message_iter_next(&struct_iter);
+		dbus_message_iter_get_basic(&struct_iter, &pValue);
+		if (pValue == NULL)
+		{
+#ifdef DEBUG
+			cout << "DBusXapianIndex::documentInfoFromDBus: invalid field value" << endl;
+#endif
+			continue;
+		}
+#ifdef DEBUG
+		cout << "DBusXapianIndex::documentInfoFromDBus: field " << pName << "=" << pValue << endl;
+#endif
+
+		// Populate docInfo
+		string fieldName(pName);
+		if (fieldName == "title")
+		{
+			docInfo.setTitle(pValue);
+		}
+		else if (fieldName == "location")
+		{
+			docInfo.setLocation(pValue);
+		}
+		else if (fieldName == "mimetype")
+		{
+			docInfo.setType(pValue);
+		}
+		else if (fieldName == "language")
+		{
+			docInfo.setLanguage(Languages::toLocale(pValue));
+		}
+		else if (fieldName == "timestamp")
+		{
+			docInfo.setTimestamp(pValue);
+		}
+		else if (fieldName == "size")
+		{
+			docInfo.setSize((off_t )atoi(pValue));
+		}
+	}
+	while (dbus_message_iter_next(&array_iter));
+
+	return true;
+}
+
+/// Converts docId and docInfo to a dbus message.
+bool DBusXapianIndex::documentInfoToDBus(DBusMessageIter *iter, unsigned int docId,
+	const DocumentInfo &docInfo)
+{
+        DBusMessageIter array_iter;
+	DBusMessageIter struct_iter;
+	const char *fieldNames[] = { "title", "location", "mimetype", "language", "timestamp", "size", NULL };
+
+	if (iter == NULL)
+	{
+		return false;
+	}
+
+	// Append the document ID ?
+	if (docId != 0)
+	{
+		dbus_message_iter_append_basic(iter, DBUS_TYPE_UINT32, &docId);
+	}
+	if (!dbus_message_iter_open_container(iter, DBUS_TYPE_ARRAY,
+		DBUS_STRUCT_BEGIN_CHAR_AS_STRING \
+		DBUS_TYPE_STRING_AS_STRING \
+		DBUS_TYPE_STRING_AS_STRING \
+		DBUS_STRUCT_END_CHAR_AS_STRING, &array_iter))
+	{
+#ifdef DEBUG
+		cout << "DBusXapianIndex::documentInfoToDBus: couldn't open array container" << endl;
+#endif
+		return false;
+	}
+
+	for (unsigned int fieldNum = 0; fieldNames[fieldNum] != NULL; ++fieldNum)
+	{
+		const char *pValue = NULL;
+		char sizeStr[64];
+
+		if (!dbus_message_iter_open_container(&array_iter,
+			DBUS_TYPE_STRUCT, NULL, &struct_iter))
+		{
+#ifdef DEBUG
+			cout << "DBusXapianIndex::documentInfoToDBus: couldn't open struct container" << endl;
+#endif
+			return false;
+		}
+
+		dbus_message_iter_append_basic(&struct_iter, DBUS_TYPE_STRING, &fieldNames[fieldNum]);
+		switch (fieldNum)
+		{
+			case 0:
+				pValue = docInfo.getTitle().c_str();
+				break;
+			case 1:
+				pValue = docInfo.getLocation().c_str();
+				break;
+			case 2:
+				pValue = docInfo.getType().c_str();
+				break;
+			case 3:
+				pValue = Languages::toEnglish(docInfo.getLanguage()).c_str();
+				break;
+			case 4:
+				pValue = docInfo.getTimestamp().c_str();
+				break;
+			case 5:
+			default:
+				snprintf(sizeStr, 64, "%u", docInfo.getSize());
+				pValue = sizeStr;
+				break;
+		}
+		dbus_message_iter_append_basic(&struct_iter, DBUS_TYPE_STRING, &pValue);
+#ifdef DEBUG
+		cout << "DBusXapianIndex::documentInfoToDBus: field " << fieldNames[fieldNum] << "=" << pValue << endl;
+#endif
+
+		if (!dbus_message_iter_close_container(&array_iter, &struct_iter))
+		{
+#ifdef DEBUG
+			cout << "DBusXapianIndex::documentInfoToDBus: couldn't close struct container" << endl;
+#endif
+			return false;
+		}
+	}
+
+	if (!dbus_message_iter_close_container(iter, &array_iter))
+	{
+#ifdef DEBUG
+		cout << "DBusXapianIndex::documentInfoToDBus: couldn't close array container" << endl;
+#endif
+		return false;
+	}
+
+	return true;
+}
+
 /// Asks the D-Bus service for statistics.
 bool DBusXapianIndex::getStatistics(unsigned int &crawledCount, unsigned int &docsCount)
 {
@@ -303,6 +500,7 @@
 /// Updates a document's properties.
 bool DBusXapianIndex::updateDocumentInfo(unsigned int docId, const DocumentInfo &docInfo)
 {
+	DBusMessageIter iter;
 	bool updated = false;
 
 	DBusGConnection *pBus = getBusConnection();
@@ -311,42 +509,47 @@
 		return false;
 	}
 
-	DBusGProxy *pBusProxy = getBusProxy(pBus);
-	if (pBusProxy == NULL)
+	// FIXME: AFAIK we can't use DBusGProxy with message iterators
+	DBusMessage *pMsg = dbus_message_new_method_call("de.berlios.Pinot",
+		"/de/berlios/Pinot", "de.berlios.Pinot", "SetDocumentInfo");
+	if (pMsg == NULL)
 	{
-		cerr << "DBusXapianIndex::updateDocumentInfo: couldn't get bus proxy" << endl;
+		cerr << "DBusXapianIndex::updateDocumentInfo: couldn't call method" << endl;
 		return false;
 	}
 
-	GError *pError = NULL;
-	const char *pTitle = docInfo.getTitle().c_str();
-	const char *pLocation = docInfo.getLocation().c_str();
-	const char *pType = docInfo.getType().c_str();
-	string language(Languages::toEnglish(docInfo.getLanguage()));
-	const char *pLanguage = language.c_str();
-
-	if (dbus_g_proxy_call(pBusProxy, "SetDocumentInfo", &pError,
-		G_TYPE_UINT, docId,
-		G_TYPE_STRING, pTitle,
-		G_TYPE_STRING, pLocation,
-		G_TYPE_STRING, pType,
-		G_TYPE_STRING, pLanguage,
-		G_TYPE_INVALID,
-		G_TYPE_UINT, &docId,
-		G_TYPE_INVALID) == TRUE)
+	dbus_message_iter_init_append(pMsg, &iter);
+	if (DBusXapianIndex::documentInfoToDBus(&iter, docId, docInfo) == false)
 	{
-		updated = true;
+		dbus_message_unref(pMsg);
 	}
 	else
 	{
-		if (pError != NULL)
+		DBusError err;
+
+		dbus_error_init(&err);
+		DBusMessage *pReply = dbus_connection_send_with_reply_and_block(dbus_g_connection_get_connection(pBus),
+			pMsg, 1000 * 10, &err);
+		dbus_message_unref(pMsg);
+
+		if (dbus_error_is_set(&err))
 		{
-			cerr << "DBusXapianIndex::updateDocumentInfo: " << pError->message << endl;
-			g_error_free(pError);
+			cerr << "DBusXapianIndex::updateDocumentInfo: " << err.message << endl;
+			dbus_error_free(&err);
+			return false;
 		}
+
+		if (pReply != NULL)
+		{
+			dbus_message_get_args(pReply, NULL,
+				DBUS_TYPE_UINT32, &docId,
+				DBUS_TYPE_INVALID);
+			updated = true;
+
+			dbus_message_unref(pReply);
+		}
 	}
 
-	g_object_unref(pBusProxy);
 	// FIXME: don't we have to call dbus_g_connection_unref(pBus); ?
 
 	return updated;

Modified: trunk/Index/DBusXapianIndex.h
===================================================================
--- trunk/Index/DBusXapianIndex.h	2007-03-12 14:41:30 UTC (rev 762)
+++ trunk/Index/DBusXapianIndex.h	2007-03-15 12:42:24 UTC (rev 763)
@@ -21,6 +21,13 @@
 
 #include <string>
 #include <set>
+extern "C"
+{
+#if DBUS_VERSION < 1000000
+#define DBUS_API_SUBJECT_TO_CHANGE
+#endif
+#include <dbus/dbus.h>
+}
 
 #include "XapianIndex.h"
 
@@ -34,6 +41,14 @@
 
 		DBusXapianIndex &operator=(const DBusXapianIndex &other);
 
+		/// Extracts docId and docInfo from a dbus message.
+		static bool documentInfoFromDBus(DBusMessageIter *iter, unsigned int &docId,
+			DocumentInfo &docInfo);
+
+		/// Converts docId and docInfo to a dbus message.
+		static bool documentInfoToDBus(DBusMessageIter *iter, unsigned int docId,
+			const DocumentInfo &docInfo);
+
 		/// Asks the D-Bus service for statistics.
 		static bool getStatistics(unsigned int &crawledCount, unsigned int &docsCount);
 

Modified: trunk/UI/GTK2/src/ServerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-12 14:41:30 UTC (rev 762)
+++ trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-15 12:42:24 UTC (rev 763)
@@ -35,6 +35,7 @@
 #include "Languages.h"
 #include "TimeConverter.h"
 #include "Url.h"
+#include "DBusXapianIndex.h"
 #include "XapianIndex.h"
 #include "XapianEngine.h"
 #include "config.h"
@@ -736,68 +737,72 @@
 	}
 #endif
 
-	if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "DeleteLabel") == TRUE)
+	if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "GetStatistics") == TRUE)
 	{
-		char *pLabel = NULL;
+		CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
+		unsigned int crawledFilesCount = history.getItemsCount(CrawlHistory::CRAWLED);
+		unsigned int docsCount = index.getDocumentsCount();
 
+#ifdef DEBUG
+		cout << "DBusServletThread::doWork: received GetStatistics" << endl;
+#endif
+		// Prepare the reply
+		m_pReply = newDBusReply(m_pRequest);
+		if (m_pReply != NULL)
+		{
+			dbus_message_append_args(m_pReply,
+				DBUS_TYPE_UINT32, &crawledFilesCount,
+				DBUS_TYPE_UINT32, &docsCount,
+				DBUS_TYPE_INVALID);
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "RenameLabel") == TRUE)
+	{
+		char *pOldLabel = NULL;
+		char *pNewLabel = NULL;
+
 		if (dbus_message_get_args(m_pRequest, &error,
-			DBUS_TYPE_STRING, &pLabel,
+			DBUS_TYPE_STRING, &pOldLabel,
+			DBUS_TYPE_STRING, &pNewLabel,
 			DBUS_TYPE_INVALID) == TRUE)
 		{
 #ifdef DEBUG
-			cout << "DBusServletThread::doWork: received DeleteLabel " << pLabel << endl;
+			cout << "DBusServletThread::doWork: received RenameLabel " << pOldLabel << ", " << pNewLabel << endl;
 #endif
-			// Delete the label
-			flushIndex = index.deleteLabel(pLabel);
+			// Rename the label
+			flushIndex = index.renameLabel(pOldLabel, pNewLabel);
 
 			// Prepare the reply
 			m_pReply = newDBusReply(m_pRequest);
 			if (m_pReply != NULL)
 			{
 				dbus_message_append_args(m_pReply,
-					DBUS_TYPE_STRING, &pLabel,
+					DBUS_TYPE_STRING, &pNewLabel,
 					DBUS_TYPE_INVALID);
 			}
 		}
 	}
-	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "GetDocumentInfo") == TRUE)
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "DeleteLabel") == TRUE)
 	{
-		unsigned int docId = 0;
+		char *pLabel = NULL;
 
 		if (dbus_message_get_args(m_pRequest, &error,
-			DBUS_TYPE_UINT32, &docId,
+			DBUS_TYPE_STRING, &pLabel,
 			DBUS_TYPE_INVALID) == TRUE)
 		{
-			DocumentInfo docInfo;
-
 #ifdef DEBUG
-			cout << "DBusServletThread::doWork: received GetDocumentInfo " << docId << endl;
+			cout << "DBusServletThread::doWork: received DeleteLabel " << pLabel << endl;
 #endif
-			if (index.getDocumentInfo(docId, docInfo) == true)
-			{
-				// Prepare the reply
-				m_pReply = newDBusReply(m_pRequest);
-				if (m_pReply != NULL)
-				{
-					string language(Languages::toEnglish(docInfo.getLanguage()));
-					const char *pTitle = docInfo.getTitle().c_str();
-					const char *pLocation = docInfo.getLocation().c_str();
-					const char *pType = docInfo.getType().c_str();
-					const char *pLanguage = language.c_str();
+			// Delete the label
+			flushIndex = index.deleteLabel(pLabel);
 
-					dbus_message_append_args(m_pReply,
-						DBUS_TYPE_STRING, &pTitle,
-						DBUS_TYPE_STRING, &pLocation,
-						DBUS_TYPE_STRING, &pType,
-						DBUS_TYPE_STRING, &pLanguage,
-						DBUS_TYPE_INVALID);
-				}
-			}
-			else
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
 			{
-				m_pReply = dbus_message_new_error(m_pRequest,
-					"de.berlios.Pinot.GetDocumentInfo",
-					"Unknown document");
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_STRING, &pLabel,
+					DBUS_TYPE_INVALID);
 			}
 		}
 	}
@@ -846,88 +851,6 @@
 			}
 		}
 	}
-	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "GetStatistics") == TRUE)
-	{
-		CrawlHistory history(PinotSettings::getInstance().m_historyDatabase);
-		unsigned int crawledFilesCount = history.getItemsCount(CrawlHistory::CRAWLED);
-		unsigned int docsCount = index.getDocumentsCount();
-
-#ifdef DEBUG
-		cout << "DBusServletThread::doWork: received GetStatistics" << endl;
-#endif
-		// Prepare the reply
-		m_pReply = newDBusReply(m_pRequest);
-		if (m_pReply != NULL)
-		{
-			dbus_message_append_args(m_pReply,
-				DBUS_TYPE_UINT32, &crawledFilesCount,
-				DBUS_TYPE_UINT32, &docsCount,
-				DBUS_TYPE_INVALID);
-		}
-	}
-	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "RenameLabel") == TRUE)
-	{
-		char *pOldLabel = NULL;
-		char *pNewLabel = NULL;
-
-		if (dbus_message_get_args(m_pRequest, &error,
-			DBUS_TYPE_STRING, &pOldLabel,
-			DBUS_TYPE_STRING, &pNewLabel,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-#ifdef DEBUG
-			cout << "DBusServletThread::doWork: received RenameLabel " << pOldLabel << ", " << pNewLabel << endl;
-#endif
-			// Rename the label
-			flushIndex = index.renameLabel(pOldLabel, pNewLabel);
-
-			// Prepare the reply
-			m_pReply = newDBusReply(m_pRequest);
-			if (m_pReply != NULL)
-			{
-				dbus_message_append_args(m_pReply,
-					DBUS_TYPE_STRING, &pNewLabel,
-					DBUS_TYPE_INVALID);
-			}
-		}
-	}
-	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "SetDocumentInfo") == TRUE)
-	{
-		char *pTitle = NULL;
-		char *pLocation = NULL;
-		char *pType = NULL;
-		char *pLanguage = NULL;
-		unsigned int docId = 0;
-
-		if (dbus_message_get_args(m_pRequest, &error,
-			DBUS_TYPE_UINT32, &docId,
-			DBUS_TYPE_STRING, &pTitle,
-			DBUS_TYPE_STRING, &pLocation,
-			DBUS_TYPE_STRING, &pType,
-			DBUS_TYPE_STRING, &pLanguage,
-			DBUS_TYPE_INVALID) == TRUE)
-		{
-			DocumentInfo docInfo(pTitle, pLocation, pType,
-				((pLanguage != NULL) ? Languages::toLocale(pLanguage) : ""));
-
-#ifdef DEBUG
-			cout << "DBusServletThread::doWork: received SetDocumentInfo " << docId << ", " << pTitle
-				<< ", " << pLocation << ", " << pType << ", " << pLanguage << endl;
-#endif
-
-			// Update the document info
-			flushIndex = index.updateDocumentInfo(docId, docInfo);
-
-			// Prepare the reply
-			m_pReply = newDBusReply(m_pRequest);
-			if (m_pReply != NULL)
-			{
-				dbus_message_append_args(m_pReply,
-					DBUS_TYPE_UINT32, &docId,
-					DBUS_TYPE_INVALID);
-			}
-		}
-	}
 	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "SetDocumentLabels") == TRUE)
 	{
 		char **ppLabels = NULL;
@@ -1005,7 +928,7 @@
 				labels.insert(ppLabels[labelIndex]);
 			}
 #ifdef DEBUG
-			cout << "DBusServletThread::doWork: received SetDocumentLabels on " << docIds.size()
+			cout << "DBusServletThread::doWork: received SetDocumentsLabels on " << docIds.size()
 				<< " IDs, " << labelsCount << " labels" << ", " << resetLabels << endl;
 #endif
 			// Set labels
@@ -1025,6 +948,77 @@
 			}
 		}
 	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "GetDocumentInfo") == TRUE)
+	{
+		unsigned int docId = 0;
+
+		if (dbus_message_get_args(m_pRequest, &error,
+			DBUS_TYPE_UINT32, &docId,
+			DBUS_TYPE_INVALID) == TRUE)
+		{
+			DocumentInfo docInfo;
+
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received GetDocumentInfo on " << docId << endl;
+#endif
+			if (index.getDocumentInfo(docId, docInfo) == true)
+			{
+				// Prepare the reply
+				m_pReply = newDBusReply(m_pRequest);
+				if (m_pReply != NULL)
+				{
+					DBusMessageIter iter;
+
+					dbus_message_iter_init_append(m_pReply, &iter);
+					if (DBusXapianIndex::documentInfoToDBus(&iter, 0, docInfo) == false)
+					{
+						dbus_message_unref(m_pReply);
+						m_pReply = dbus_message_new_error(m_pRequest,
+							"de.berlios.Pinot.GetDocumentInfo",
+							"Unknown error");
+					}
+				}
+			}
+			else
+			{
+				m_pReply = dbus_message_new_error(m_pRequest,
+					"de.berlios.Pinot.GetDocumentInfo",
+					"Unknown document");
+			}
+		}
+	}
+	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "SetDocumentInfo") == TRUE)
+	{
+		DBusMessageIter iter;
+		DocumentInfo docInfo;
+		unsigned int docId = 0;
+
+		dbus_message_iter_init(m_pRequest, &iter);
+		if (DBusXapianIndex::documentInfoFromDBus(&iter, docId, docInfo) == false)
+		{
+			m_pReply = dbus_message_new_error(m_pRequest,
+				"de.berlios.Pinot.SetDocumentInfo",
+				"Unknown error");
+		}
+		else
+		{
+#ifdef DEBUG
+			cout << "DBusServletThread::doWork: received SetDocumentInfo on " << docId << endl;
+#endif
+
+			// Update the document info
+			flushIndex = index.updateDocumentInfo(docId, docInfo);
+
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
+			{
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_UINT32, &docId,
+					DBUS_TYPE_INVALID);
+			}
+		}
+	}
 	else if (dbus_message_is_method_call(m_pRequest, "de.berlios.Pinot", "SimpleQuery") == TRUE)
 	{
 		char *pSearchText = NULL;

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.xml
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.xml	2007-03-12 14:41:30 UTC (rev 762)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.xml	2007-03-15 12:42:24 UTC (rev 763)
@@ -5,42 +5,6 @@
 	-->
   <interface name="de.berlios.Pinot">
     <!--
-	Deletes a label.
-	 label: the name of the label to delete
-	-->
-    <method name="DeleteLabel">
-      <annotation name="de.berlios.Pinot.DeleteLabel" value="pinotDBus"/>
-      <arg type="s" name="label" direction="in"/>
-      <arg type="s" name="label" direction="out"/>
-    </method>
-    <!--
-	Retrieves information about a document.
-	 docId: the document's ID
-	 title : title of the document (automatically extracted from document if possible
-	         or the file name otherwise)
-	 location: the document's URL (eg "file:///home/fabrice/Documents/SomeFile.txt")
-	 type: the document's MIME type
-	 language: the document's language in English, as extracted at indexing time
-	-->
-    <method name="GetDocumentInfo">
-      <annotation name="de.berlios.Pinot.GetDocumentInfo" value="pinotDBus"/>
-      <arg type="u" name="docId" direction="in"/>
-      <arg type="s" name="title" direction="out"/>
-      <arg type="s" name="location" direction="out"/>
-      <arg type="s" name="type" direction="out"/>
-      <arg type="s" name="language" direction="out"/>
-    </method>
-    <!--
-	Retrieves a document's labels.
-	 docId: the document's ID
-	 labels: array of labels applied to the document
-	-->
-    <method name="GetDocumentLabels">
-      <annotation name="de.berlios.Pinot.GetDocumentLabels" value="pinotDBus"/>
-      <arg type="u" name="docId" direction="in"/>
-      <arg type="as" name="labels" direction="out"/>
-    </method>
-    <!--
 	Retrieves statistics.
 	 crawledCount: the number of documents crawled
 	 docsCount: the number of documents in the index
@@ -62,21 +26,23 @@
       <arg type="s" name="newLabel" direction="out"/>
     </method>
     <!--
-	Sets information about a document.
+	Deletes a label.
+	 label: the name of the label to delete
+	-->
+    <method name="DeleteLabel">
+      <annotation name="de.berlios.Pinot.DeleteLabel" value="pinotDBus"/>
+      <arg type="s" name="label" direction="in"/>
+      <arg type="s" name="label" direction="out"/>
+    </method>
+    <!--
+	Retrieves a document's labels.
 	 docId: the document's ID
-	 title : title of the document
-	 location: the document's URL (eg "file:///home/fabrice/Documents/SomeFile.txt")
-	 type: the document's MIME type
-	 language: the document's language in English
+	 labels: array of labels applied to the document
 	-->
-    <method name="SetDocumentInfo">
-      <annotation name="de.berlios.Pinot.SetDocumentInfo" value="pinotDBus"/>
+    <method name="GetDocumentLabels">
+      <annotation name="de.berlios.Pinot.GetDocumentLabels" value="pinotDBus"/>
       <arg type="u" name="docId" direction="in"/>
-      <arg type="s" name="title" direction="in"/>
-      <arg type="s" name="location" direction="in"/>
-      <arg type="s" name="type" direction="in"/>
-      <arg type="s" name="language" direction="in"/>
-      <arg type="u" name="docId" direction="out"/>
+      <arg type="as" name="labels" direction="out"/>
     </method>
     <!--
 	Sets a document's labels.
@@ -97,14 +63,35 @@
 	 labels: array of labels to apply to the documents
 	 resetLabels: TRUE if existing labels should be unset
 	-->
-    <method name="SetDocumentLabels">
-      <annotation name="de.berlios.Pinot.SetDocumentLabels" value="pinotDBus"/>
+    <method name="SetDocumentsLabels">
+      <annotation name="de.berlios.Pinot.SetDocumentsLabels" value="pinotDBus"/>
       <arg type="as" name="docIds" direction="in"/>
       <arg type="as" name="labels" direction="in"/>
       <arg type="b" name="resetLabels" direction="in"/>
       <arg type="b" name="status" direction="out"/>
     </method>
     <!--
+	Retrieves information about a document.
+	 docId: the document's ID
+	 fields : array of string-string (field name, field value) structures
+	-->
+    <method name="GetDocumentInfo">
+      <annotation name="de.berlios.Pinot.GetDocumentInfo" value="pinotDBus"/>
+      <arg type="u" name="docId" direction="in"/>
+      <arg type="a(ss)" name="fields" direction="out"/>
+    </method>
+    <!--
+	Sets information about a document.
+	 docId: the document's ID
+	 fields : array of string-string (field name, field value) structures
+	-->
+    <method name="SetDocumentInfo">
+      <annotation name="de.berlios.Pinot.SetDocumentInfo" value="pinotDBus"/>
+      <arg type="u" name="docId" direction="in"/>
+      <arg type="a(ss)" name="fields" direction="in"/>
+      <arg type="u" name="docId" direction="out"/>
+    </method>
+    <!--
 	Queries the index.
 	 searchText : search text, as would be entered in Pinot's live query field
 	 maxHits: the maximum number of hits desired

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2007-03-12 14:41:30 UTC (rev 762)
+++ trunk/UI/GTK2/src/pinot.cc	2007-03-15 12:42:24 UTC (rev 763)
@@ -31,7 +31,9 @@
 #include <glibmm/convert.h>
 extern "C"
 {
+#if DBUS_VERSION < 1000000
 #define DBUS_API_SUBJECT_TO_CHANGE
+#endif
 #include <dbus/dbus.h>
 #include <dbus/dbus-glib.h>
 #include <dbus/dbus-glib-lowlevel.h>



From fabricecolin at mail.berlios.de  Thu Mar 15 14:04:08 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 15 Mar 2007 14:04:08 +0100
Subject: [Pinot-svn] r764 - trunk/Utils
Message-ID: <200703151304.l2FD48ul030699@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-15 14:04:08 +0100 (Thu, 15 Mar 2007)
New Revision: 764

Modified:
   trunk/Utils/CommandLine.cpp
   trunk/Utils/MIMEScanner.cpp
Log:
If a desktop file has an equal sign in Exec, run the command with sh -c as
system() would do because we don't have an easy way to find out where the equal
sign is.


Modified: trunk/Utils/CommandLine.cpp
===================================================================
--- trunk/Utils/CommandLine.cpp	2007-03-15 12:42:24 UTC (rev 763)
+++ trunk/Utils/CommandLine.cpp	2007-03-15 13:04:08 UTC (rev 764)
@@ -16,6 +16,7 @@
  *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
  */
 
+#include <stdlib.h>
 #include <strings.h>
 #include <glibmm/shell.h>
 #include <glibmm/spawn.h>
@@ -71,6 +72,20 @@
 {
 	string commandLine(action.m_exec);
 
+	string::size_type equalPos = action.m_exec.find("=");
+	if (equalPos != string::npos)
+	{
+		// The .desktop spec says that the program name or path in Exec may not contain it
+		// but that's ignored by some .desktop files. So it could be either of :
+		//  FOO=bar my program				- not valid
+		//  sh -c "FOO=bar exec myprogram"		- valid
+		//  myprogram --option FOO=bar			- valid
+		// There's no easy way to find out which, so be lenient and use system()
+		commandLine = "sh -c \"";
+		commandLine += action.m_exec;
+		commandLine += "\"";
+	}
+
 	if (commandLine.empty() == true)
 	{
 		return false;

Modified: trunk/Utils/MIMEScanner.cpp
===================================================================
--- trunk/Utils/MIMEScanner.cpp	2007-03-15 12:42:24 UTC (rev 763)
+++ trunk/Utils/MIMEScanner.cpp	2007-03-15 13:04:08 UTC (rev 764)
@@ -101,22 +101,7 @@
 			m_name = getKeyValue(pDesktopFile, "Name");
 			// This may contain parameters described here :
 			// http://standards.freedesktop.org/desktop-entry-spec/latest/ar01s06.html
-			string execKey(getKeyValue(pDesktopFile, "Exec"));
-			// The name or path of the executable program may not contain the equal sign
-			string::size_type pos = execKey.find("=");
-			if (pos == string::npos)
-			{
-				m_exec = execKey;
-			}
-			else
-			{
-				pos = execKey.find(" ", pos);
-				if ((pos != string::npos) &&
-					(pos + 1 < execKey.length()))
-				{
-					m_exec = execKey.substr(pos + 1);
-				}
-			}
+			m_exec = getKeyValue(pDesktopFile, "Exec");
 			m_icon = getKeyValue(pDesktopFile, "Icon");
 			m_device = getKeyValue(pDesktopFile, "Device");
 



From fabricecolin at mail.berlios.de  Thu Mar 15 14:30:07 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 15 Mar 2007 14:30:07 +0100
Subject: [Pinot-svn] r765 - trunk
Message-ID: <200703151330.l2FDU7dt000736@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-15 14:30:07 +0100 (Thu, 15 Mar 2007)
New Revision: 765

Modified:
   trunk/README
Log:
Somewhat better documentation.


Modified: trunk/README
===================================================================
--- trunk/README	2007-03-15 13:04:08 UTC (rev 764)
+++ trunk/README	2007-03-15 13:30:07 UTC (rev 765)
@@ -5,18 +5,19 @@
 
 1. What is Pinot
 2. Upgrading from previous versions
-3. Using the Google API
-4. Automatic indexing and monitoring
-5. Search strategy
-6. Viewing cached results
-7. Installing additional search plugins
+3. Available engines
+4. Indexes
+5. Indexing and monitoring
+6. Search strategy
+7. Viewing cached results
 8. File formats
-9. More Like This
-10. D-Bus service
-11. Deskbar Applet plugin
-12. How to reset indexes
-13. Dependencies
-14. FAQ
+9. File patterns
+10. More Like This
+11. D-Bus service
+12. Deskbar Applet plugin
+13. How to reset indexes
+14. Dependencies
+15. FAQ
 
 
 1. What is Pinot
@@ -37,47 +38,123 @@
 2. Upgrading from previous versions
 
 
-  * from 0.50 or older to 0.60
-  The "My Documents" index was renamed "My Web Pages". A new index, appropriately
-  named "My Documents" ;-), includes all local files including mbox files and is
+  * from 0.50 or older to 0.60 or newer
+  The My Documents index was renamed My Web Pages. A new index, appropriately
+  named My Documents ;-), includes all local files including mbox files and is
   populated by the new D-Bus service.
-
   If you used the Import facility to index specific directories on your system,
   it is recommended you manually unindex the corresponding documents from the
-  "My Web Pages" index, and configure these directories to be automatically
-  indexed by the D-Bus service, See section "4. Automatic indexing and monitoring".
-  The "My EMail" index was dropped. Email messages will now appear in your
-  "My Documents" index.
+  My Web Pages index, and configure these directories to be automatically
+  indexed by the D-Bus service, See section "5. Indexing and monitoring".
+  The My EMail index was dropped. Email messages will now appear in your
+  My Documents index.
 
 
-3. Using the Google API
+3. Available engines 
 
 
+  One of the main functionalities of Pinot is metasearch. This lets you query
+  a variety of sources, including Web-based search engines. By default, the
+  list of available engines is hidden and defaults to internal indexes (see
+  section "4. Indexes"). To show the list of engines, click on the Show All
+  Search Engines button, next to the Query field immediately below the menu
+  bar. Click on the same button again to hide the list.
+
+  Any number of engine or engine group may be selected at any one time.
+  Multi-selection is done like in any other application. All queries are always
+  run against the list of currently selected engines.
+
+  Starting with v0.42, Pinot supports both Sherlock and OpenSearch Description
+  plugins. They are installed in $PREFIX/share/pinot/engines/, where PREFIX
+  is usually /usr. Additional engines can be installed in that directory or
+  in ~/.pinot/engines. Note this directory is not created automatically.
+
+  Sherlock is what Firefox and the Mozilla suite use. Chances are that somebody
+  wrote a plugin for the engine you are interested in. MyCroft at
+  http://mycroft.mozdev.org/ has got plenty of plugins. Beware that a lot are
+  out of date and will require some changes. Use pinot-search on the
+  command-line to run a quick check on a plugin, eg
+  $ pinot-search sherlock /usr/share/pinot/engines/Bozo.src "clowns"
+
+  Plugins are categorized by channels. For Sherlock plugins, the routeType
+  element under SEARCH specifies the name of the channel the plugin belongs to.
+
+  As for OpenSearch, A9.com has an extensive list at
+  http://a9.com/-/search/moreColumns.jsp. A Description file is not available
+  for all engines though...
+  Pinot should work with OpenSearch Description 1.0 and 1.1 (draft 2) plugins.
+  One thing to keep in mind is that because Description doesn't describe how
+  to parse the results page returned by the search engine, Pinot assumes that
+  the engine will return results formatted according to the OpenSearch Response
+  standard.
+  In practice, this means that plugins that don't stick to the following rules
+  will be ignored or won't show any result :
+    * For Description 1.1 plugins, the type attribute on the Url field must be
+      set to "application/atom+xml" or "application/rss+xml" (default).
+      "text/html" will be rejected.
+    * The search engine's results page content type must be some form of XML,
+      otherwise Pinot won't attempt parsing it. 
+  Pinot differs from the Description spec in that it interprets the Tags field
+  as a channel name. The standard defines Tags as a "space-delimited set of
+  words that are used as keywords to identify and categorize this search
+  content".
+
   If the version of Pinot you are using was built with support for the Google
-  SOAP API, a "Google API" engine will appear in pinot's engines list. To query
-  this engine, you need to obtain a key from Google.
-
-  Go to http://api.google.com/ and create an account. You will then receive
-  your Google API key by email. Start pinot and enter the key in the corresponding
+  SOAP API, a "Google API" engine will appear in the group The Web. To query
+  this engine, create an account at http://api.google.com/. You will then
+  receive a Google API key by email. Enter this key in the corresponding
   field in the General tab of the Preferences box.
 
 
-4. Automatic indexing and monitoring
+4. Indexes
 
 
+  Pinot has two internal indexes. My Documents is populated by the D-Bus
+  service and contains documents found on your computer. My Web Pages is
+  populated by the UI whenever you :
+    * import an external document, using the Index, Import URL menu
+    * index results returned by Web engines, using the Results, Index menu
+      or through a Stored Query
+  Both index may have any of the file types listed in section "8. File formats".
+
+  Indexes built by any other Xapian-based tools can be added to Pinot. To add
+  an external index, click the + button at the bottom of the engines list.
+  It can either be local, in which case you will have to select the directory
+  where it is found, or served from a remote machine by xapian-tcpsrv. See
+  the manual page for xapian-tcpsrv(1).
+
+  All indexes are grouped together under the channel Current User in the
+  engines list.
+
+
+5. Indexing and monitoring
+
+
   Pinot can automatically index :
-    * directories and their contents. Monitoring for changes is optional.
-    * mbox mail accounts. Monitoring is always enabled.
-  Both are configured with the Indexing tab in the Preferences box and are
+    * mbox mail accounts. Monitoring for changes is always enabled.
+    * directories. Their contents are crawled. Monitoring is optional.
+  Both are configured under the Indexing tab of the Preferences box and are
   handled by the D-Bus service.
-  If you want to exclude specific files or directories from indexing, use
-  patterns as described in section "8. File formats".
-  See section "10. D-Bus service".
 
+  All files and directories with a name that starts with a dot, eg ".gaim",
+  are skipped and their content is not indexed. If you want to exclude any
+  other specific files or directories from indexing, use patterns as described
+  in section "9. File patterns".
 
-5. Search strategy
+  Mbox files held in a dot-directory should be added to the mail boxes list
+  in Preferences. Others found during a directory crawl will be fully indexed
+  but not monitored for changes.
 
+  While Pinot is not currently able to get to and index application-specific
+  data held in dot-directories, it can index common file formats as listed
+  in section "8. File formats".
+  If you would like to index your GAIM chat logs, which are plain HTML files,
+  symlink ~/.gaim/logs to one of the directories configured in Preferences.
 
+
+6. Search strategy
+
+
   When querying an index, Pinot adopts a multi-stepped search strategy that
   first attempts to find the documents that best match the query. If a given
   step doesn't return results, the next step alters the query slightly before
@@ -116,7 +193,7 @@
   documentation for Xapian's QueryParser at http://www.xapian.org/docs/queryparser.html
 
 
-6. Viewing cached results
+7. Viewing cached results
 
 
   Results returned by search engines can be viewed "live" by selecting the View
@@ -140,44 +217,6 @@
       pinot.berlios.de/download.html
 
 
-7. Installing additional search plugins
-
-
-  Starting with v0.42, Pinot supports both Sherlock and OpenSearch Description
-  plugins. They are installed in $PREFIX/share/pinot/engines/, where PREFIX
-  is usually /usr.
-  Additional engines can be installed in that directory or in ~/.pinot/engines.
-  Note this directory is not created automatically.
-  Sherlock is what Firefox and the Mozilla suite use. Chances are that somebody
-  wrote a plugin for the engine you are interested in. MyCroft at
-  http://mycroft.mozdev.org/ has got plenty of plugins. Beware that a lot are
-  out of date and will require some changes. Use pinot-search on the
-  command-line to run a quick check on a plugin, eg
-  $ pinot-search sherlock /usr/share/pinot/engines/Bozo.src "clowns" 10
-
-  Plugins are categorized by channels. For Sherlock plugins, the routeType
-  element under SEARCH specifies the name of the channel the plugin belongs to.
-  As for OpenSearch, A9.com has an extensive list at
-  http://a9.com/-/search/moreColumns.jsp. A Description file is not available
-  for all engines though...
-  Pinot should work with OpenSearch Description 1.0 and 1.1 (draft 2) plugins.
-  One thing to keep in mind is that because Description doesn't describe how
-  to parse the results page returned by the search engine, Pinot assumes that
-  the engine will return results formatted according to the OpenSearch Response
-  standard.
-  In practice, this means that plugins that don't stick to the following rules
-  will be ignored or won't show any result :
-    * For Description 1.1 plugins, the type attribute on the Url field must be
-      set to "application/atom+xml" or "application/rss+xml" (default).
-      "text/html" will be rejected.
-    * The search engine's results page content type must be some form of XML,
-      otherwise Pinot won't attempt parsing it. 
-  Pinot differs from the Description spec in that it interprets the Tags field
-  as a channel name. The standard defines Tags as a "space-delimited set of
-  words that are used as keywords to identify and categorize this search
-  content".
-
-
 8. File formats
 
 
@@ -194,23 +233,30 @@
   More formats will be supported as the project matures.
 
   For other document types, Pinot will only index metadata such as name,
-  location etc... In any case, starting with 0.62, it is possible to
-  skip indexing of files with glob(3) patterns.
-  These patterns are configured in the Indexing tab of the Preferences box.
+  location etc...
+
+
+9. File patterns
+
+
+  Starting with version 0.62, it is possible to skip indexing of files with
+  glob(3) patterns. These patterns are configured in the Indexing tab of the
+  Preferences box.
+
   For example, "*.mp3" will skip all files with the extension "mp3", even
   though that particular document type is supported by Pinot.
   Patterns also apply to directory; for instance "*/Desktop*" will skip
   "~/Desktop" and not crawl nor monitor this directory's contents.
   If you have never run Pinot before, it will initialize the patterns list
-  to common picture, archive and video types such as JPG, GIF, ZIP and MPG.
+  to common picture and video types such as JPG, GIF, ZIP and MPG.
 
 
-9. More Like This
+10. More Like This
 
 
    The More Like This feature is enabled when at least one of the results
    currently selected is indexed, ie if the result was previously manually
-   indexed in "My Web Pages", or if it's a local file indexed in "My Documents".
+   indexed in My Web Pages, or if it's a local file indexed in My Documents.
    Its role is to expand queries.
 
    When activated, it will suggest other terms from the selected results
@@ -219,7 +265,7 @@
    "More Like Me".
 
 
-10. D-Bus service
+11. D-Bus service
 
 
    D-Bus activation makes sure the service is running whenever one of its
@@ -259,11 +305,9 @@
   The daemon will also exit if killed.
 
   For a list of available D-Bus methods, see the file pinot-dbus-daemon.xml.
-  Note that only the My Documents index is accessible through D-Bus for the
-  time being.
 
 
-11. Deskbar Applet plugin
+12. Deskbar Applet plugin
 
 
   Deskbar Applet provides an omnipresent versatile search interface for Gnome.
@@ -279,7 +323,7 @@
   results in the same order as the Pinot UI.
 
 
-12. How to reset indexes
+13. How to reset indexes
 
 
   You may wish to reset one of the index and start from scratch. There
@@ -299,7 +343,7 @@
     delete from CrawlSources;"
 
 
-13. Dependencies
+14. Dependencies
 
 
   The version numbers indicate the minimum version Pinot has been tested
@@ -376,7 +420,7 @@
 ---------------------------------------------------------------
 
 
-14. FAQ
+15. FAQ
 
 
   * At startup, when listing an index or indexing documents, Pinot complains



From fabricecolin at mail.berlios.de  Fri Mar 16 16:39:34 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 16 Mar 2007 16:39:34 +0100
Subject: [Pinot-svn] r766 - in trunk: Index UI/GTK2/src
Message-ID: <200703161539.l2GFdYdv012764@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-16 16:39:33 +0100 (Fri, 16 Mar 2007)
New Revision: 766

Modified:
   trunk/Index/DBusXapianIndex.cpp
   trunk/UI/GTK2/src/pinot-dbus-daemon.xml
Log:
On second thought, better use the same DocumentInfo fields as the document data
fields, at least for the time being.


Modified: trunk/Index/DBusXapianIndex.cpp
===================================================================
--- trunk/Index/DBusXapianIndex.cpp	2007-03-15 13:30:07 UTC (rev 765)
+++ trunk/Index/DBusXapianIndex.cpp	2007-03-16 15:39:33 UTC (rev 766)
@@ -38,6 +38,7 @@
 using std::set;
 using std::min;
 
+const char *g_fieldNames[] = { "caption", "url", "type", "language", "modtime", "size", NULL };
 
 static DBusGConnection *getBusConnection(void)
 {
@@ -176,27 +177,27 @@
 
 		// Populate docInfo
 		string fieldName(pName);
-		if (fieldName == "title")
+		if (fieldName == g_fieldNames[0])
 		{
 			docInfo.setTitle(pValue);
 		}
-		else if (fieldName == "location")
+		else if (fieldName == g_fieldNames[1])
 		{
 			docInfo.setLocation(pValue);
 		}
-		else if (fieldName == "mimetype")
+		else if (fieldName == g_fieldNames[2])
 		{
 			docInfo.setType(pValue);
 		}
-		else if (fieldName == "language")
+		else if (fieldName == g_fieldNames[3])
 		{
 			docInfo.setLanguage(Languages::toLocale(pValue));
 		}
-		else if (fieldName == "timestamp")
+		else if (fieldName == g_fieldNames[4])
 		{
 			docInfo.setTimestamp(pValue);
 		}
-		else if (fieldName == "size")
+		else if (fieldName == g_fieldNames[5])
 		{
 			docInfo.setSize((off_t )atoi(pValue));
 		}
@@ -212,7 +213,6 @@
 {
         DBusMessageIter array_iter;
 	DBusMessageIter struct_iter;
-	const char *fieldNames[] = { "title", "location", "mimetype", "language", "timestamp", "size", NULL };
 
 	if (iter == NULL)
 	{
@@ -236,7 +236,7 @@
 		return false;
 	}
 
-	for (unsigned int fieldNum = 0; fieldNames[fieldNum] != NULL; ++fieldNum)
+	for (unsigned int fieldNum = 0; g_fieldNames[fieldNum] != NULL; ++fieldNum)
 	{
 		const char *pValue = NULL;
 		char sizeStr[64];
@@ -250,7 +250,7 @@
 			return false;
 		}
 
-		dbus_message_iter_append_basic(&struct_iter, DBUS_TYPE_STRING, &fieldNames[fieldNum]);
+		dbus_message_iter_append_basic(&struct_iter, DBUS_TYPE_STRING, &g_fieldNames[fieldNum]);
 		switch (fieldNum)
 		{
 			case 0:
@@ -276,7 +276,7 @@
 		}
 		dbus_message_iter_append_basic(&struct_iter, DBUS_TYPE_STRING, &pValue);
 #ifdef DEBUG
-		cout << "DBusXapianIndex::documentInfoToDBus: field " << fieldNames[fieldNum] << "=" << pValue << endl;
+		cout << "DBusXapianIndex::documentInfoToDBus: field " << g_fieldNames[fieldNum] << "=" << pValue << endl;
 #endif
 
 		if (!dbus_message_iter_close_container(&array_iter, &struct_iter))

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.xml
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.xml	2007-03-15 13:30:07 UTC (rev 765)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.xml	2007-03-16 15:39:33 UTC (rev 766)
@@ -73,7 +73,8 @@
     <!--
 	Retrieves information about a document.
 	 docId: the document's ID
-	 fields : array of string-string (field name, field value) structures
+	 fields : array of (s name, s value) structures with name one of
+	 "caption", "url", "type", "language", "modtime", "size"
 	-->
     <method name="GetDocumentInfo">
       <annotation name="de.berlios.Pinot.GetDocumentInfo" value="pinotDBus"/>
@@ -83,7 +84,8 @@
     <!--
 	Sets information about a document.
 	 docId: the document's ID
-	 fields : array of string-string (field name, field value) structures
+	 fields : array of (s name, s value) structures with name one of
+	 "caption", "url", "type", "language", "modtime", "size"
 	-->
     <method name="SetDocumentInfo">
       <annotation name="de.berlios.Pinot.SetDocumentInfo" value="pinotDBus"/>



From fabricecolin at mail.berlios.de  Fri Mar 16 16:45:57 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 16 Mar 2007 16:45:57 +0100
Subject: [Pinot-svn] r767 - in trunk: Index Search
Message-ID: <200703161545.l2GFjvxL013251@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-16 16:45:56 +0100 (Fri, 16 Mar 2007)
New Revision: 767

Modified:
   trunk/Index/XapianDatabase.cpp
   trunk/Index/XapianIndex.cpp
   trunk/Search/XapianEngine.cpp
Log:
In XapianIndex, if a prefix is to be used for terms use the same for capitalized
terms, so that they are not confused with unprefixed terms.
Escape label, file name, directory name and URL terms since they may contain
spaces. On the search side, pre-process the query string and escape all filter
values set between double-quotes.
Reindexing is required for these changes to work properly.
Some fixes to XapianDatabase.


Modified: trunk/Index/XapianDatabase.cpp
===================================================================
--- trunk/Index/XapianDatabase.cpp	2007-03-16 15:39:33 UTC (rev 766)
+++ trunk/Index/XapianDatabase.cpp	2007-03-16 15:45:56 UTC (rev 767)
@@ -20,6 +20,7 @@
 #include <sys/stat.h>
 #include <fcntl.h>
 #include <unistd.h>
+#include <stdlib.h>
 #include <regex.h>
 #include <stdio.h>
 #include <iostream>
@@ -397,7 +398,7 @@
 
 	// A bad field is one that includes one of our field delimiters
 	if (regcomp(&fieldRegex,
-		"(url|sample|caption|type|timestamp|language)=",
+		"(url|sample|caption|type|modtime|language|size)=",
 		REG_EXTENDED|REG_ICASE) == 0)
 	{
 		if (regexec(&fieldRegex, field.c_str(), 1,
@@ -493,6 +494,11 @@
 		timestamp = TimeConverter::toTimestamp(timeT);
 	}
 	pDoc->setTimestamp(timestamp);
+	string bytesSize(StringManip::extractField(record, "size=", ""));
+	if (bytesSize.empty() == false)
+	{
+		pDoc->setSize((off_t)atol(bytesSize.c_str()));
+	}
 }
 
 /// Returns the URL for the given document in the given index.

Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2007-03-16 15:39:33 UTC (rev 766)
+++ trunk/Index/XapianIndex.cpp	2007-03-16 15:45:56 UTC (rev 767)
@@ -165,6 +165,7 @@
 	const string &prefix, Xapian::termcount &termPos, StemmingMode mode) const
 {
 	Xapian::Stem *pStemmer = NULL;
+	string upperCasePrefix("R");
 	string term;
 
 	// Do we know what language to use for stemming ?
@@ -173,6 +174,12 @@
 		pStemmer = new Xapian::Stem(StringManip::toLowerCase(m_stemLanguage));
 	}
 
+	// Terms starting with a capital letter are R-prefixed, unless a prefix is already defined
+	if (prefix.empty() == false)
+	{
+		upperCasePrefix = prefix;
+	}
+
 	// Get the terms
 	while (tokens.nextToken(term) == true)
 	{
@@ -183,8 +190,7 @@
 		// Does it start with a capital letter ?
 		if (isupper((int)term[0]) != 0)
 		{
-			// R-prefix the raw term
-			doc.add_posting(XapianDatabase::limitTermLength(string("R") + term), termPos);
+			doc.add_posting(XapianDatabase::limitTermLength(upperCasePrefix + term), termPos);
 		}
 		// Lower case the term
 		term = StringManip::toLowerCase(term);
@@ -231,6 +237,7 @@
 {
 	Xapian::TermIterator termListIter = doc.termlist_begin();
 	Xapian::Stem *pStemmer = NULL;
+	string upperCasePrefix("R");
 	string term;
 
 	// Do we know what language to use for stemming ?
@@ -239,6 +246,12 @@
 		pStemmer = new Xapian::Stem(StringManip::toLowerCase(language));
 	}
 
+	// Terms starting with a capital letter are R-prefixed, unless a prefix is already defined
+	if (prefix.empty() == false)
+	{
+		upperCasePrefix = prefix;
+	}
+
 	// Get the terms and remove the first posting for each
 	while (tokens.nextToken(term) == true)
 	{
@@ -249,8 +262,7 @@
 		// Does it start with a capital letter ?
 		if (isupper((int)term[0]) != 0)
 		{
-			// R-prefix the raw term
-			removeFirstPosting(doc, termListIter, string("R") + term);
+			removeFirstPosting(doc, termListIter, upperCasePrefix + term);
 		}
 		// Lower case the term
 		term = StringManip::toLowerCase(term);
@@ -305,7 +317,7 @@
 	}
 
 	// Index the full URL with prefix U
-	doc.add_term(XapianDatabase::limitTermLength(string("U") + location, true));
+	doc.add_term(XapianDatabase::limitTermLength(string("U") + Url::escapeUrl(location), true));
 	// ...the host name and included domains with prefix H
 	string hostName(StringManip::toLowerCase(urlObj.getHost()));
 	if (hostName.empty() == false)
@@ -324,11 +336,11 @@
 	string tree(urlObj.getLocation());
 	if (tree.empty() == false)
 	{
-		doc.add_term(XapianDatabase::limitTermLength(string("XDIR:") + tree, true));
+		doc.add_term(XapianDatabase::limitTermLength(string("XDIR:") + Url::escapeUrl(tree), true));
 		string::size_type slashPos = tree.find('/', 1);
 		while (slashPos != string::npos)
 		{
-			doc.add_term(XapianDatabase::limitTermLength(string("XDIR:") + tree.substr(0, slashPos), true));
+			doc.add_term(XapianDatabase::limitTermLength(string("XDIR:") +  Url::escapeUrl(tree.substr(0, slashPos)), true));
 
 			// Next
 			slashPos = tree.find('/', slashPos + 1);
@@ -340,7 +352,7 @@
 	{
 		string extension;
 
-		doc.add_term(XapianDatabase::limitTermLength(string("P") + fileName, true));
+		doc.add_term(XapianDatabase::limitTermLength(string("P") + Url::escapeUrl(fileName), true));
 
 		// Does it have an extension ?
 		string::size_type extPos = fileName.rfind('.');
@@ -419,8 +431,8 @@
 		removeFirstPostingsFromDocument(titleTokens, doc, "", language, m_stemMode);
 	}
 
-	// Title
-	commonTerms.insert(XapianDatabase::limitTermLength(string("U") + docInfo.getLocation(), true));
+	// Location 
+	commonTerms.insert(XapianDatabase::limitTermLength(string("U") + Url::escapeUrl(docInfo.getLocation()), true));
 	// Host name
 	string hostName(StringManip::toLowerCase(urlObj.getHost()));
 	if (hostName.empty() == false)
@@ -439,11 +451,11 @@
 	string tree(urlObj.getLocation());
 	if (tree.empty() == false)
 	{
-		commonTerms.insert(XapianDatabase::limitTermLength(string("XDIR:") + tree, true));
+		commonTerms.insert(XapianDatabase::limitTermLength(string("XDIR:") + Url::escapeUrl(tree), true));
 		string::size_type slashPos = tree.find('/', 1);
 		while (slashPos != string::npos)
 		{
-			commonTerms.insert(XapianDatabase::limitTermLength(string("XDIR:") + tree.substr(0, slashPos), true));
+			commonTerms.insert(XapianDatabase::limitTermLength(string("XDIR:") +  Url::escapeUrl(tree.substr(0, slashPos)), true));
 
 			// Next
 			slashPos = tree.find('/', slashPos + 1);
@@ -455,7 +467,7 @@
 	{
 		string extension;
 
-		commonTerms.insert(XapianDatabase::limitTermLength(string("P") + fileName, true));
+		commonTerms.insert(XapianDatabase::limitTermLength(string("P") + Url::escapeUrl(fileName), true));
 
 		// Does it have an extension ?
 		string::size_type extPos = fileName.rfind('.');
@@ -694,7 +706,7 @@
 
 			// Get documents that have this label
 			// FIXME: would it be faster to get the document's terms ?
-			term += name;
+			term += Url::escapeUrl(name);
 			Xapian::PostingIterator postingIter = pIndex->postlist_begin(term);
 			if (postingIter != pIndex->postlist_end(term))
 			{
@@ -753,7 +765,7 @@
 					// Is this a label ?
 					if (strncasecmp((*termIter).c_str(), "XLABEL:", min(7, (int)(*termIter).length())) == 0)
 					{
-						labels.insert((*termIter).substr(7));
+						labels.insert(Url::unescapeUrl((*termIter).substr(7)));
 					}
 				}
 				gotLabels = true;
@@ -790,7 +802,7 @@
 		Xapian::Database *pIndex = pDatabase->readLock();
 		if (pIndex != NULL)
 		{
-			string term = XapianDatabase::limitTermLength(string("U") + Url::canonicalizeUrl(url), true);
+			string term = XapianDatabase::limitTermLength(string("U") + Url::escapeUrl(Url::canonicalizeUrl(url)), true);
 
 			// Get documents that have this term
 			Xapian::PostingIterator postingIter = pIndex->postlist_begin(term);
@@ -960,7 +972,7 @@
 
 				// Each label appears only one per document so the collection frequency
 				// is the number of documents that have this label
-				docCount = pIndex->get_collection_freq(term + labelName);
+				docCount = pIndex->get_collection_freq(term + Url::escapeUrl(labelName));
 			}
 		}
 	}
@@ -991,7 +1003,7 @@
 {
 	string term("XLABEL:");
 
-	term += name;
+	term += Url::escapeUrl(name);
 	return listDocumentsWithTerm(term, docIds, maxDocsCount, startDoc);
 }
 
@@ -1001,7 +1013,7 @@
 {
 	string term("XDIR:");
 
-	term += dirName;
+	term += Url::escapeUrl(dirName);
 	return listDocumentsWithTerm(XapianDatabase::limitTermLength(term, true),
 		docIds, maxDocsCount, startDoc);
 }
@@ -1055,7 +1067,7 @@
 		for (set<string>::const_iterator labelIter = labels.begin(); labelIter != labels.end();
 			++labelIter)
 		{
-			doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + *labelIter));
+			doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + Url::escapeUrl(*labelIter)));
 		}
 		addCommonTerms(docInfo, doc, termPos);
 		setDocumentData(docInfo, doc, m_stemLanguage);
@@ -1135,7 +1147,7 @@
 			for (set<string>::const_iterator labelIter = labels.begin(); labelIter != labels.end();
 				++labelIter)
 			{
-				doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + *labelIter));
+				doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + Url::escapeUrl(*labelIter)));
 			}
 		}
 		addCommonTerms(docInfo, doc, termPos);
@@ -1271,7 +1283,7 @@
 			{
 				if (labelIter->empty() == false)
 				{
-					doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + *labelIter));
+					doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + Url::escapeUrl(*labelIter)));
 				}
 			}
 
@@ -1355,7 +1367,7 @@
 		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
 		if (pIndex != NULL)
 		{
-			string term = XapianDatabase::limitTermLength(string("U") + Url::canonicalizeUrl(location), true);
+			string term = XapianDatabase::limitTermLength(string("U") + Url::escapeUrl(Url::canonicalizeUrl(location)), true);
 
 			// Only one document should have this term
 			pIndex->delete_document(term);
@@ -1401,11 +1413,11 @@
 
 			if (isDirectory == true)
 			{
-				term = XapianDatabase::limitTermLength(string("XDIR:") + name, true);
+				term = XapianDatabase::limitTermLength(string("XDIR:") + Url::escapeUrl(name), true);
 			}
 			else
 			{
-				term += name;
+				term += Url::escapeUrl(name);
 			}
 #ifdef DEBUG
 			cout << "XapianIndex::unindexDocuments: term is " << term << endl;
@@ -1450,7 +1462,7 @@
 			string term("XLABEL:");
 
 			// Get documents that have this label
-			term += name;
+			term += Url::escapeUrl(name);
 			for (Xapian::PostingIterator postingIter = pIndex->postlist_begin(term);
 				postingIter != pIndex->postlist_end(term); ++postingIter)
 			{
@@ -1461,7 +1473,7 @@
 				// Remove the term
 				doc.remove_term(term);
 				// ...add the new one
-				doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + newName));
+				doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + Url::escapeUrl(newName)));
 				// ...and update the document
 				pIndex->replace_document(docId, doc);
 			}
@@ -1502,7 +1514,7 @@
 			string term("XLABEL:");
 
 			// Get documents that have this label
-			term += name;
+			term += Url::escapeUrl(name);
 			for (Xapian::PostingIterator postingIter = pIndex->postlist_begin(term);
 				postingIter != pIndex->postlist_end(term); ++postingIter)
 			{

Modified: trunk/Search/XapianEngine.cpp
===================================================================
--- trunk/Search/XapianEngine.cpp	2007-03-16 15:39:33 UTC (rev 766)
+++ trunk/Search/XapianEngine.cpp	2007-03-16 15:45:56 UTC (rev 767)
@@ -203,6 +203,41 @@
 	parser.add_boolean_prefix("type", "T");
 	parser.add_boolean_prefix("label", "XLABEL:");
 
+	// Do some pre-processing : look for filters with quoted values
+	string::size_type escapedFilterEnd = 0;
+	string::size_type escapedFilterStart = freeQuery.find(":\"");
+	while ((escapedFilterStart != string::npos) &&
+		(escapedFilterStart < freeQuery.length() - 2))
+	{
+		escapedFilterEnd = freeQuery.find("\"", escapedFilterStart + 2);
+		if (escapedFilterEnd == string::npos)
+		{
+			break;
+		}
+
+		string filterValue = freeQuery.substr(escapedFilterStart + 2, escapedFilterEnd - escapedFilterStart - 2);
+		if (filterValue.empty() == false)
+		{
+			string escapedValue(Url::escapeUrl(filterValue));
+
+			freeQuery.replace(escapedFilterStart + 1, escapedFilterEnd - escapedFilterStart,
+				escapedValue);
+			escapedFilterEnd = escapedFilterEnd + escapedValue.length() - filterValue.length();
+		}
+		else
+		{
+			// No value !
+			freeQuery.replace(escapedFilterStart, escapedFilterEnd - escapedFilterStart + 1, ":");
+			escapedFilterEnd -= 2;
+		}
+#ifdef DEBUG
+		cout << "XapianEngine::parseQuery: replaced filter: " << freeQuery << endl;
+#endif
+
+		// Next
+		escapedFilterStart = freeQuery.find(":\"", escapedFilterEnd);
+	}
+
 	// Activate all options and parse
 	Xapian::Query parsedQuery = parser.parse_query(freeQuery,
 		Xapian::QueryParser::FLAG_BOOLEAN|Xapian::QueryParser::FLAG_PHRASE|Xapian::QueryParser::FLAG_LOVEHATE|Xapian::QueryParser::FLAG_BOOLEAN_ANY_CASE|Xapian::QueryParser::FLAG_WILDCARD);



From fabricecolin at mail.berlios.de  Sat Mar 17 04:12:40 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 17 Mar 2007 04:12:40 +0100
Subject: [Pinot-svn] r768 - in trunk: Index Search
Message-ID: <200703170312.l2H3Ceej010029@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-17 04:12:40 +0100 (Sat, 17 Mar 2007)
New Revision: 768

Modified:
   trunk/Index/XapianDatabase.cpp
   trunk/Index/XapianIndex.cpp
   trunk/Search/XapianEngine.cpp
Log:
Limit length of terms before prefix is applied so that search-time pre-processing
doesn't have to bother about prefixes when dealing with long terms.
Labels were not always length limited.
When pre-processing filters, transform them as done at indexing time.


Modified: trunk/Index/XapianDatabase.cpp
===================================================================
--- trunk/Index/XapianDatabase.cpp	2007-03-16 15:45:56 UTC (rev 767)
+++ trunk/Index/XapianDatabase.cpp	2007-03-17 03:12:40 UTC (rev 768)
@@ -36,7 +36,7 @@
 using std::string;
 
 // This puts a limit to terms length.
-const unsigned int XapianDatabase::m_maxTermLength = 240;
+const unsigned int XapianDatabase::m_maxTermLength = 230;
 
 XapianDatabase::XapianDatabase(const string &databaseName, bool readOnly) :
 	m_databaseName(databaseName),

Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2007-03-16 15:45:56 UTC (rev 767)
+++ trunk/Index/XapianIndex.cpp	2007-03-17 03:12:40 UTC (rev 768)
@@ -190,7 +190,7 @@
 		// Does it start with a capital letter ?
 		if (isupper((int)term[0]) != 0)
 		{
-			doc.add_posting(XapianDatabase::limitTermLength(upperCasePrefix + term), termPos);
+			doc.add_posting(upperCasePrefix + XapianDatabase::limitTermLength(term), termPos);
 		}
 		// Lower case the term
 		term = StringManip::toLowerCase(term);
@@ -199,24 +199,24 @@
 		if ((mode == STORE_UNSTEM) ||
 			(pStemmer == NULL))
 		{
-			doc.add_posting(XapianDatabase::limitTermLength(prefix + term), termPos);
+			doc.add_posting(prefix + XapianDatabase::limitTermLength(term), termPos);
 		}
 		else if (mode == STORE_STEM)
 		{
 			string stemmedTerm = pStemmer->stem_word(term);
 
-			doc.add_posting(XapianDatabase::limitTermLength(prefix + stemmedTerm), termPos);
+			doc.add_posting(prefix + XapianDatabase::limitTermLength(stemmedTerm), termPos);
 		}
 		else if (mode == STORE_BOTH)
 		{
 			string stemmedTerm = pStemmer->stem_word(term);
 
 			// Add both at the same position
-			doc.add_posting(XapianDatabase::limitTermLength(prefix + term), termPos);
+			doc.add_posting(prefix + XapianDatabase::limitTermLength(term), termPos);
 			if (stemmedTerm != term)
 			{
 				// No point adding the same term twice
-				doc.add_posting(XapianDatabase::limitTermLength(prefix + stemmedTerm), termPos);
+				doc.add_posting(prefix + XapianDatabase::limitTermLength(stemmedTerm), termPos);
 			}
 		}
 
@@ -271,20 +271,20 @@
 		if ((mode == STORE_UNSTEM) ||
 			(pStemmer == NULL))
 		{
-			removeFirstPosting(doc, termListIter, XapianDatabase::limitTermLength(prefix + term));
+			removeFirstPosting(doc, termListIter, prefix + XapianDatabase::limitTermLength(term));
 		}
 		else if (mode == STORE_STEM)
 		{
-			removeFirstPosting(doc, termListIter, XapianDatabase::limitTermLength(prefix + pStemmer->stem_word(term)));
+			removeFirstPosting(doc, termListIter, prefix + XapianDatabase::limitTermLength(pStemmer->stem_word(term)));
 		}
 		else if (mode == STORE_BOTH)
 		{
 			string stemmedTerm = pStemmer->stem_word(term);
 
-			removeFirstPosting(doc, termListIter, XapianDatabase::limitTermLength(prefix + term));
+			removeFirstPosting(doc, termListIter, prefix + XapianDatabase::limitTermLength(term));
 			if (stemmedTerm != term)
 			{
-				removeFirstPosting(doc, termListIter, XapianDatabase::limitTermLength(prefix + stemmedTerm));
+				removeFirstPosting(doc, termListIter, prefix + XapianDatabase::limitTermLength(stemmedTerm));
 			}
 		}
 	}
@@ -317,16 +317,16 @@
 	}
 
 	// Index the full URL with prefix U
-	doc.add_term(XapianDatabase::limitTermLength(string("U") + Url::escapeUrl(location), true));
+	doc.add_term(string("U") + XapianDatabase::limitTermLength(Url::escapeUrl(location), true));
 	// ...the host name and included domains with prefix H
 	string hostName(StringManip::toLowerCase(urlObj.getHost()));
 	if (hostName.empty() == false)
 	{
-		doc.add_term(XapianDatabase::limitTermLength(string("H") + hostName, true));
+		doc.add_term(string("H") + XapianDatabase::limitTermLength(hostName, true));
 		string::size_type dotPos = hostName.find('.');
 		while (dotPos != string::npos)
 		{
-			doc.add_term(XapianDatabase::limitTermLength(string("H") + hostName.substr(dotPos + 1), true));
+			doc.add_term(string("H") + XapianDatabase::limitTermLength(hostName.substr(dotPos + 1), true));
 
 			// Next
 			dotPos = hostName.find('.', dotPos + 1);
@@ -336,11 +336,11 @@
 	string tree(urlObj.getLocation());
 	if (tree.empty() == false)
 	{
-		doc.add_term(XapianDatabase::limitTermLength(string("XDIR:") + Url::escapeUrl(tree), true));
+		doc.add_term(string("XDIR:") + XapianDatabase::limitTermLength(Url::escapeUrl(tree), true));
 		string::size_type slashPos = tree.find('/', 1);
 		while (slashPos != string::npos)
 		{
-			doc.add_term(XapianDatabase::limitTermLength(string("XDIR:") +  Url::escapeUrl(tree.substr(0, slashPos)), true));
+			doc.add_term(string("XDIR:") + XapianDatabase::limitTermLength(Url::escapeUrl(tree.substr(0, slashPos)), true));
 
 			// Next
 			slashPos = tree.find('/', slashPos + 1);
@@ -352,7 +352,7 @@
 	{
 		string extension;
 
-		doc.add_term(XapianDatabase::limitTermLength(string("P") + Url::escapeUrl(fileName), true));
+		doc.add_term(string("P") + XapianDatabase::limitTermLength(Url::escapeUrl(fileName), true));
 
 		// Does it have an extension ?
 		string::size_type extPos = fileName.rfind('.');
@@ -361,7 +361,7 @@
 		{
 			extension = StringManip::toLowerCase(fileName.substr(extPos + 1));
 		}
-		doc.add_term(XapianDatabase::limitTermLength(string("XEXT:") + extension));
+		doc.add_term(string("XEXT:") + XapianDatabase::limitTermLength(extension));
 	}
 	// Add the date terms D, M and Y
 	time_t timeT = TimeConverter::fromTimestamp(info.getTimestamp());
@@ -432,16 +432,16 @@
 	}
 
 	// Location 
-	commonTerms.insert(XapianDatabase::limitTermLength(string("U") + Url::escapeUrl(docInfo.getLocation()), true));
+	commonTerms.insert(string("U") + XapianDatabase::limitTermLength(Url::escapeUrl(docInfo.getLocation()), true));
 	// Host name
 	string hostName(StringManip::toLowerCase(urlObj.getHost()));
 	if (hostName.empty() == false)
 	{
-		commonTerms.insert(XapianDatabase::limitTermLength(string("H") + hostName, true));
+		commonTerms.insert(string("H") + XapianDatabase::limitTermLength(hostName, true));
 		string::size_type dotPos = hostName.find('.');
 		while (dotPos != string::npos)
 		{
-			commonTerms.insert(XapianDatabase::limitTermLength(string("H") + hostName.substr(dotPos + 1), true));
+			commonTerms.insert(string("H") + XapianDatabase::limitTermLength(hostName.substr(dotPos + 1), true));
 
 			// Next
 			dotPos = hostName.find('.', dotPos + 1);
@@ -451,11 +451,11 @@
 	string tree(urlObj.getLocation());
 	if (tree.empty() == false)
 	{
-		commonTerms.insert(XapianDatabase::limitTermLength(string("XDIR:") + Url::escapeUrl(tree), true));
+		commonTerms.insert(string("XDIR:") + XapianDatabase::limitTermLength(Url::escapeUrl(tree), true));
 		string::size_type slashPos = tree.find('/', 1);
 		while (slashPos != string::npos)
 		{
-			commonTerms.insert(XapianDatabase::limitTermLength(string("XDIR:") +  Url::escapeUrl(tree.substr(0, slashPos)), true));
+			commonTerms.insert(string("XDIR:") + XapianDatabase::limitTermLength(Url::escapeUrl(tree.substr(0, slashPos)), true));
 
 			// Next
 			slashPos = tree.find('/', slashPos + 1);
@@ -467,7 +467,7 @@
 	{
 		string extension;
 
-		commonTerms.insert(XapianDatabase::limitTermLength(string("P") + Url::escapeUrl(fileName), true));
+		commonTerms.insert(string("P") + XapianDatabase::limitTermLength(Url::escapeUrl(fileName), true));
 
 		// Does it have an extension ?
 		string::size_type extPos = fileName.rfind('.');
@@ -476,7 +476,7 @@
 		{
 			extension = StringManip::toLowerCase(fileName.substr(extPos + 1));
 		}
-		commonTerms.insert(XapianDatabase::limitTermLength(string("XEXT:") + extension));
+		commonTerms.insert(string("XEXT:") + XapianDatabase::limitTermLength(extension));
 	}
 	// Date terms
 	time_t timeT = TimeConverter::fromTimestamp(docInfo.getTimestamp());
@@ -706,7 +706,7 @@
 
 			// Get documents that have this label
 			// FIXME: would it be faster to get the document's terms ?
-			term += Url::escapeUrl(name);
+			term += XapianDatabase::limitTermLength(Url::escapeUrl(name));
 			Xapian::PostingIterator postingIter = pIndex->postlist_begin(term);
 			if (postingIter != pIndex->postlist_end(term))
 			{
@@ -802,7 +802,7 @@
 		Xapian::Database *pIndex = pDatabase->readLock();
 		if (pIndex != NULL)
 		{
-			string term = XapianDatabase::limitTermLength(string("U") + Url::escapeUrl(Url::canonicalizeUrl(url)), true);
+			string term = string("U") + XapianDatabase::limitTermLength(Url::escapeUrl(Url::canonicalizeUrl(url)), true);
 
 			// Get documents that have this term
 			Xapian::PostingIterator postingIter = pIndex->postlist_begin(term);
@@ -972,7 +972,8 @@
 
 				// Each label appears only one per document so the collection frequency
 				// is the number of documents that have this label
-				docCount = pIndex->get_collection_freq(term + Url::escapeUrl(labelName));
+				term += XapianDatabase::limitTermLength(Url::escapeUrl(labelName));
+				docCount = pIndex->get_collection_freq(term);
 			}
 		}
 	}
@@ -1003,7 +1004,7 @@
 {
 	string term("XLABEL:");
 
-	term += Url::escapeUrl(name);
+	term += XapianDatabase::limitTermLength(Url::escapeUrl(name));
 	return listDocumentsWithTerm(term, docIds, maxDocsCount, startDoc);
 }
 
@@ -1011,10 +1012,9 @@
 bool XapianIndex::listDocumentsInDirectory(const string &dirName, set<unsigned int> &docIds,
 	unsigned int maxDocsCount, unsigned int startDoc) const
 {
-	string term("XDIR:");
+	string term(Url::escapeUrl(dirName));
 
-	term += Url::escapeUrl(dirName);
-	return listDocumentsWithTerm(XapianDatabase::limitTermLength(term, true),
+	return listDocumentsWithTerm(string("XDIR") + XapianDatabase::limitTermLength(term, true),
 		docIds, maxDocsCount, startDoc);
 }
 
@@ -1067,7 +1067,7 @@
 		for (set<string>::const_iterator labelIter = labels.begin(); labelIter != labels.end();
 			++labelIter)
 		{
-			doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + Url::escapeUrl(*labelIter)));
+			doc.add_term(string("XLABEL:") + XapianDatabase::limitTermLength(Url::escapeUrl(*labelIter)));
 		}
 		addCommonTerms(docInfo, doc, termPos);
 		setDocumentData(docInfo, doc, m_stemLanguage);
@@ -1147,7 +1147,7 @@
 			for (set<string>::const_iterator labelIter = labels.begin(); labelIter != labels.end();
 				++labelIter)
 			{
-				doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + Url::escapeUrl(*labelIter)));
+				doc.add_term(string("XLABEL:") + XapianDatabase::limitTermLength(Url::escapeUrl(*labelIter)));
 			}
 		}
 		addCommonTerms(docInfo, doc, termPos);
@@ -1283,7 +1283,7 @@
 			{
 				if (labelIter->empty() == false)
 				{
-					doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + Url::escapeUrl(*labelIter)));
+					doc.add_term(string("XLABEL:") + XapianDatabase::limitTermLength(Url::escapeUrl(*labelIter)));
 				}
 			}
 
@@ -1367,7 +1367,7 @@
 		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
 		if (pIndex != NULL)
 		{
-			string term = XapianDatabase::limitTermLength(string("U") + Url::escapeUrl(Url::canonicalizeUrl(location)), true);
+			string term = string("U") + XapianDatabase::limitTermLength(Url::escapeUrl(Url::canonicalizeUrl(location)), true);
 
 			// Only one document should have this term
 			pIndex->delete_document(term);
@@ -1413,11 +1413,11 @@
 
 			if (isDirectory == true)
 			{
-				term = XapianDatabase::limitTermLength(string("XDIR:") + Url::escapeUrl(name), true);
+				term = string("XDIR:") + XapianDatabase::limitTermLength(Url::escapeUrl(name), true);
 			}
 			else
 			{
-				term += Url::escapeUrl(name);
+				term += XapianDatabase::limitTermLength(Url::escapeUrl(name));
 			}
 #ifdef DEBUG
 			cout << "XapianIndex::unindexDocuments: term is " << term << endl;
@@ -1462,7 +1462,7 @@
 			string term("XLABEL:");
 
 			// Get documents that have this label
-			term += Url::escapeUrl(name);
+			term += XapianDatabase::limitTermLength(Url::escapeUrl(name));
 			for (Xapian::PostingIterator postingIter = pIndex->postlist_begin(term);
 				postingIter != pIndex->postlist_end(term); ++postingIter)
 			{
@@ -1473,7 +1473,7 @@
 				// Remove the term
 				doc.remove_term(term);
 				// ...add the new one
-				doc.add_term(XapianDatabase::limitTermLength(string("XLABEL:") + Url::escapeUrl(newName)));
+				doc.add_term(string("XLABEL:") + XapianDatabase::limitTermLength(Url::escapeUrl(newName)));
 				// ...and update the document
 				pIndex->replace_document(docId, doc);
 			}
@@ -1514,7 +1514,7 @@
 			string term("XLABEL:");
 
 			// Get documents that have this label
-			term += Url::escapeUrl(name);
+			term += XapianDatabase::limitTermLength(Url::escapeUrl(name));
 			for (Xapian::PostingIterator postingIter = pIndex->postlist_begin(term);
 				postingIter != pIndex->postlist_end(term); ++postingIter)
 			{

Modified: trunk/Search/XapianEngine.cpp
===================================================================
--- trunk/Search/XapianEngine.cpp	2007-03-16 15:45:56 UTC (rev 767)
+++ trunk/Search/XapianEngine.cpp	2007-03-17 03:12:40 UTC (rev 768)
@@ -56,6 +56,40 @@
 	return 28 + (year % 4 == 0);
 }
 
+static void checkFilter(const string &freeQuery, string::size_type filterValueStart,
+	bool &escapeValue, bool &hashValue)
+{
+	string filterName;
+	string::size_type filterNameStart = freeQuery.rfind(' ', filterValueStart);
+
+	escapeValue = hashValue = false;
+
+	if (filterNameStart == string::npos)
+	{
+		filterName = freeQuery.substr(0, filterValueStart);
+	}
+	else
+	{
+		filterName = freeQuery.substr(filterNameStart + 1, filterValueStart - filterNameStart - 1);
+	}
+#ifdef DEBUG
+	cout << "checkFilter: filter " << filterName << endl;
+#endif
+
+	// In XapianIndex, these are escaped and hashed
+	if ((filterName == "file") ||
+		(filterName =="dir") ||
+		(filterName == "url"))
+	{
+		escapeValue = hashValue = true;
+	}
+	// except label which is only escaped
+	else if (filterName == "label")
+	{
+		escapeValue = true;
+	}
+}
+
 XapianEngine::XapianEngine(const string &database) :
 	SearchEngineInterface()
 {
@@ -219,7 +253,26 @@
 		if (filterValue.empty() == false)
 		{
 			string escapedValue(Url::escapeUrl(filterValue));
+			bool escapeValue = false, hashValue = false;
 
+			// The value should be escaped and length-limited as done at indexing time
+			checkFilter(freeQuery, escapedFilterStart, escapeValue, hashValue);
+
+			if (escapeValue == false)
+			{
+				// No escaping
+				escapedValue = filterValue;
+			}
+			if (hashValue == true)
+			{
+				// Partially hash if necessary
+				escapedValue = XapianDatabase::limitTermLength(escapedValue, true);
+			}
+			else
+			{
+				escapedValue = XapianDatabase::limitTermLength(escapedValue);
+			}
+
 			freeQuery.replace(escapedFilterStart + 1, escapedFilterEnd - escapedFilterStart,
 				escapedValue);
 			escapedFilterEnd = escapedFilterEnd + escapedValue.length() - filterValue.length();



From fabricecolin at mail.berlios.de  Sat Mar 17 14:08:05 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 17 Mar 2007 14:08:05 +0100
Subject: [Pinot-svn] r769 - in trunk: . UI UI/GTK2 UI/icons UI/icons/16x16
	UI/icons/22x22 UI/icons/24x24 UI/icons/32x32 UI/icons/48x48
Message-ID: <200703171308.l2HD857c025934@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-17 14:08:04 +0100 (Sat, 17 Mar 2007)
New Revision: 769

Added:
   trunk/UI/icons/
   trunk/UI/icons/16x16/
   trunk/UI/icons/16x16/pinot.png
   trunk/UI/icons/22x22/
   trunk/UI/icons/22x22/pinot.png
   trunk/UI/icons/24x24/
   trunk/UI/icons/24x24/pinot.png
   trunk/UI/icons/32x32/
   trunk/UI/icons/32x32/pinot.png
   trunk/UI/icons/48x48/
   trunk/UI/icons/48x48/pinot.png
   trunk/UI/icons/pinot.xcf
   trunk/UI/icons/scalable/
Removed:
   trunk/UI/GTK2/pinot.png
   trunk/UI/GTK2/pinot.xcf
Modified:
   trunk/Makefile.am
   trunk/pinot.spec.in
Log:
Icons in several sizes.


Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2007-03-17 03:12:40 UTC (rev 768)
+++ trunk/Makefile.am	2007-03-17 13:08:04 UTC (rev 769)
@@ -1,5 +1,6 @@
 
-SUBDIRS = po Utils Tokenize SQL Collect Index @SOAP_SUBDIRS@ Search Monitor UI/GTK2/src
+SUBDIRS = po Utils Tokenize SQL Collect Index @SOAP_SUBDIRS@ Search Monitor \
+	UI/GTK2/src
 
 EXTRA_DIST = AUTHORS ChangeLog NEWS README TODO mkinstalldirs \
 	Tokenize/filters/external-filters.xml globalconfig.xml \
@@ -9,7 +10,9 @@
 	Index/pinot-index.1 Search/pinot-search.1 \
 	UI/GTK2/src/pinot.1 UI/GTK2/src/pinot-dbus-daemon.1 \
 	UI/GTK2/src/pinot-dbus-daemon.xml UI/GTK2/src/de.berlios.Pinot.service \
-	UI/GTK2/xapian-powered.png UI/GTK2/pinot.png \
+	UI/GTK2/xapian-powered.png UI/icons/48x48/pinot.png \
+	UI/icons/32x32/pinot.png UI/icons/24x24/pinot.png \
+	UI/icons/22x22/pinot.png UI/icons/16x16/pinot.png \
 	UI/GTK2/metase-gtk2.glade UI/GTK2/metase-gtk2.gladep \
 	scripts/bash/pinot-enum-index.sh scripts/python/pinot-live.py
 
@@ -36,7 +39,15 @@
 	@rm $(DESTDIR)$(libdir)/lib*filter.a $(DESTDIR)$(libdir)/lib*filter.la
 	@mv $(DESTDIR)$(libdir)/lib*filter* $(DESTDIR)$(libdir)/pinot/filters/
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/
-	$(INSTALL_DATA) UI/GTK2/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/pinot.png
+	$(INSTALL_DATA) UI/icons/48x48/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/pinot.png
+	$(mkinstalldirs) $(DESTDIR)$(datadir)/icons/hicolor/32x32/apps/
+	$(INSTALL_DATA) UI/icons/32x32/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/32x32/apps/pinot.png
+	$(mkinstalldirs) $(DESTDIR)$(datadir)/icons/hicolor/24x24/apps/
+	$(INSTALL_DATA) UI/icons/24x24/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/24x24/apps/pinot.png
+	$(mkinstalldirs) $(DESTDIR)$(datadir)/icons/hicolor/22x22/apps/
+	$(INSTALL_DATA) UI/icons/22x22/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/22x22/apps/pinot.png
+	$(mkinstalldirs) $(DESTDIR)$(datadir)/icons/hicolor/16x16/apps/
+	$(INSTALL_DATA) UI/icons/16x16/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/16x16/apps/pinot.png
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/applications
 	@desktop-file-install --vendor="" --dir=$(DESTDIR)$(datadir)/applications pinot.desktop
 	$(mkinstalldirs) $(DESTDIR)${sysconfdir}/xdg/autostart

Deleted: trunk/UI/GTK2/pinot.png
===================================================================
(Binary files differ)

Deleted: trunk/UI/GTK2/pinot.xcf
===================================================================
(Binary files differ)

Added: trunk/UI/icons/16x16/pinot.png
===================================================================
(Binary files differ)


Property changes on: trunk/UI/icons/16x16/pinot.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/UI/icons/22x22/pinot.png
===================================================================
(Binary files differ)


Property changes on: trunk/UI/icons/22x22/pinot.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/UI/icons/24x24/pinot.png
===================================================================
(Binary files differ)


Property changes on: trunk/UI/icons/24x24/pinot.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/UI/icons/32x32/pinot.png
===================================================================
(Binary files differ)


Property changes on: trunk/UI/icons/32x32/pinot.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Copied: trunk/UI/icons/48x48/pinot.png (from rev 765, trunk/UI/GTK2/pinot.png)

Copied: trunk/UI/icons/pinot.xcf (from rev 765, trunk/UI/GTK2/pinot.xcf)

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2007-03-17 03:12:40 UTC (rev 768)
+++ trunk/pinot.spec.in	2007-03-17 13:08:04 UTC (rev 769)
@@ -131,6 +131,10 @@
 %{_datadir}/locale/ru/LC_MESSAGES/pinot.mo
 %{_datadir}/locale/sv/LC_MESSAGES/pinot.mo
 %{_datadir}/icons/hicolor/48x48/apps/pinot.png
+%{_datadir}/icons/hicolor/32x32/apps/pinot.png
+%{_datadir}/icons/hicolor/24x24/apps/pinot.png
+%{_datadir}/icons/hicolor/22x22/apps/pinot.png
+%{_datadir}/icons/hicolor/16x16/apps/pinot.png
 %{_sysconfdir}/xdg/autostart/*.desktop
 %{_datadir}/applications/*.desktop
 %{_mandir}/man1/pinot.*



From fabricecolin at mail.berlios.de  Sun Mar 18 09:50:01 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 18 Mar 2007 09:50:01 +0100
Subject: [Pinot-svn] r770 - trunk/UI/GTK2/src
Message-ID: <200703180850.l2I8o1kf024341@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-18 09:50:01 +0100 (Sun, 18 Mar 2007)
New Revision: 770

Modified:
   trunk/UI/GTK2/src/statisticsDialog.cc
   trunk/UI/GTK2/src/statisticsDialog.hh
Log:
Status window is refreshed every 5 seconds.


Modified: trunk/UI/GTK2/src/statisticsDialog.cc
===================================================================
--- trunk/UI/GTK2/src/statisticsDialog.cc	2007-03-17 13:08:04 UTC (rev 769)
+++ trunk/UI/GTK2/src/statisticsDialog.cc	2007-03-18 08:50:01 UTC (rev 770)
@@ -16,12 +16,14 @@
  *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
  */
 
+#include <string>
 #include <fstream>
-#include <iostream>
-#include <string>
 #include <map>
 #include <set>
-#include <sigc++/slot.h>
+#include <iostream>
+#include <sigc++/class_slot.h>
+#include <glibmm/convert.h>
+#include <gtkmm/stock.h>
 
 #include "config.h"
 #include "NLS.h"
@@ -37,7 +39,9 @@
 using namespace Gtk;
 
 statisticsDialog::statisticsDialog() :
-	statisticsDialog_glade()
+	statisticsDialog_glade(),
+	m_hasErrors(false),
+	m_lastErrorDate(0)
 {
 	// Associate the columns model to the engines tree
 	m_refStore = TreeStore::create(m_statsColumns);
@@ -49,21 +53,20 @@
 		statisticsTreeview->append_column(*manage(pColumn));
 	}
 
+	// Populate
 	populate();
+	// ...and update regularly
+	m_idleConnection = Glib::signal_timeout().connect(SigC::slot(*this,
+		&statisticsDialog::on_activity_timeout), 5000);
 }
 
 statisticsDialog::~statisticsDialog()
 {
+	m_idleConnection.disconnect();
 }
 
 void statisticsDialog::populate(void)
 {
-	CrawlHistory crawlerHistory(PinotSettings::getInstance().m_historyDatabase);
-	ViewHistory viewHistory(PinotSettings::getInstance().m_historyDatabase);
-	std::map<unsigned int, string> sources;
-	char countStr[64];
-	bool hasErrors = false;
-
 	TreeModel::iterator folderIter = m_refStore->append();
 	TreeModel::Row row = *folderIter;
 	row[m_statsColumns.m_name] = _("Indexes");
@@ -72,46 +75,84 @@
 	TreeModel::iterator statIter = m_refStore->append(folderIter->children());
 	row = *statIter;
 	row[m_statsColumns.m_name] = _("My Web Pages");
+	m_myWebPagesIter = m_refStore->append(statIter->children());
+
+	statIter = m_refStore->append(folderIter->children());
+	row = *statIter;
+	row[m_statsColumns.m_name] = _("My Documents");
+	m_myDocumentsIter = m_refStore->append(statIter->children());
+
+	folderIter = m_refStore->append();
+	row = *folderIter;
+	row[m_statsColumns.m_name] = _("History");
+	m_viewStatIter = m_refStore->append(folderIter->children());
+
+	m_daemonIter = m_refStore->append();
+	row = *m_daemonIter;
+	row[m_statsColumns.m_name] = _("Daemon");
+	m_daemonStatIter = m_refStore->append(m_daemonIter->children());
+
+	m_crawledStatIter = m_refStore->append(folderIter->children());
+
+	// Expand everything
+	statisticsTreeview->expand_all();
+
+	Adjustment *pAdjustement = statisticsScrolledwindow->get_hadjustment();
+#ifdef DEBUG
+	cout << "statisticsDialog: " << pAdjustement->get_value() << " "
+		<< pAdjustement->get_lower() << " " << pAdjustement->get_upper() << endl;
+#endif
+	pAdjustement->set_value(pAdjustement->get_upper());
+	statisticsScrolledwindow->set_hadjustment(pAdjustement);
+	resize((int )pAdjustement->get_upper() * 2, get_height());
+
+	on_activity_timeout();
+}
+
+bool statisticsDialog::on_activity_timeout(void)
+{
+	CrawlHistory crawlerHistory(PinotSettings::getInstance().m_historyDatabase);
+	ViewHistory viewHistory(PinotSettings::getInstance().m_historyDatabase);
+	TreeModel::Row row;
+	std::map<unsigned int, string> sources;
+	char countStr[64];
+
+	row = *m_myWebPagesIter;
 	IndexInterface *pIndex = PinotSettings::getInstance().getIndex(PinotSettings::getInstance().m_docsIndexLocation);
 	if ((pIndex != NULL) &&
 		(pIndex->isGood() == true))
 	{
 		unsigned int docsCount = pIndex->getDocumentsCount();
+
 		snprintf(countStr, 64, "%u", docsCount);
-		TreeModel::iterator docsIter = m_refStore->append(statIter->children());
-		row = *docsIter;
 		row[m_statsColumns.m_name] = ustring(countStr) + " " + _("documents");
 	}
+	else
+	{
+		row[m_statsColumns.m_name] = _("Unknown error");
+	}
 
-	statIter = m_refStore->append(folderIter->children());
-	row = *statIter;
-	row[m_statsColumns.m_name] = _("My Documents");
+	row = *m_myDocumentsIter;
 	pIndex = PinotSettings::getInstance().getIndex(PinotSettings::getInstance().m_daemonIndexLocation);
 	if ((pIndex != NULL) &&
 		(pIndex->isGood() == true))
 	{
 		unsigned int docsCount = pIndex->getDocumentsCount();
+
 		snprintf(countStr, 64, "%u", docsCount);
-		TreeModel::iterator docsIter = m_refStore->append(statIter->children());
-		row = *docsIter;
 		row[m_statsColumns.m_name] = ustring(countStr) + " " + _("documents");
 	}
+	else
+	{
+		row[m_statsColumns.m_name] = _("Unknown error");
+	}
 
-	folderIter = m_refStore->append();
-	row = *folderIter;
-	row[m_statsColumns.m_name] = _("History");
-
 	// Show view statistics
 	unsigned int viewCount = viewHistory.getItemsCount();
 	snprintf(countStr, 64, "%u", viewCount);
-	statIter = m_refStore->append(folderIter->children());
-	row = *statIter;
+	row = *m_viewStatIter;
 	row[m_statsColumns.m_name] = ustring(_("Viewed")) + " " + countStr + " " + _("results");
 
-	folderIter = m_refStore->append();
-	row = *folderIter;
-	row[m_statsColumns.m_name] = _("Daemon");
-
 	// Is the daemon still running ?
 	string pidFileName(PinotSettings::getInstance().getConfigurationDirectory() + "/pinot-dbus-daemon.pid");
 	pid_t daemonPID = 0;
@@ -123,8 +164,7 @@
 		pidFile.close();
 	}
 	snprintf(countStr, 64, "%u", daemonPID);
-	statIter = m_refStore->append(folderIter->children());
-	row = *statIter;
+	row = *m_daemonStatIter;
 	if (daemonPID > 0)
 	{
 		// FIXME: check whether it's actually running !
@@ -138,12 +178,10 @@
 	// Show crawler statistics
 	unsigned int crawledFilesCount = crawlerHistory.getItemsCount(CrawlHistory::CRAWLED);
 	snprintf(countStr, 64, "%u", crawledFilesCount);
-	statIter = m_refStore->append(folderIter->children());
-	row = *statIter;
+	row = *m_crawledStatIter;
 	row[m_statsColumns.m_name] = ustring(_("Crawled")) + " " + countStr + " " + _("files");
 
-	TreeModel::iterator errIter;
-
+	// Show errors
 	crawlerHistory.getSources(sources);
 	for (std::map<unsigned int, string>::iterator sourceIter = sources.begin();
 		sourceIter != sources.end(); ++sourceIter)
@@ -151,25 +189,30 @@
 		set<string> errors;
 
 		// Did any error occur on this source ?
-		unsigned int errorCount = crawlerHistory.getSourceItems(sourceIter->first, CrawlHistory::ERROR, errors);
+		unsigned int errorCount = crawlerHistory.getSourceItems(sourceIter->first,
+			CrawlHistory::ERROR, errors, m_lastErrorDate);
 		if ((errorCount > 0) &&
 			(errors.empty() == false))
 		{
 			Url urlObj(sourceIter->second);
 			ustring sourceName(urlObj.getLocation());
 
-			if (hasErrors == false)
+			// Add an errors row
+			if (m_hasErrors == false)
 			{
-				// Add an errors row
-				errIter  = m_refStore->append(folderIter->children());
-				row = *errIter;
+				m_errorsIter  = m_refStore->append(m_daemonIter->children());
+				row = *m_errorsIter;
 				row[m_statsColumns.m_name] = _("Errors");
 
-				hasErrors = true;
+				// Don't expand it
+				TreeModel::Path errPath = m_refStore->get_path(m_errorsIter);
+				statisticsTreeview->collapse_row(errPath);
+
+				m_hasErrors = true;
 			}
 
 			// Add the source
-			TreeModel::iterator srcIter = m_refStore->append(errIter->children());
+			TreeModel::iterator srcIter = m_refStore->append(m_errorsIter->children());
 			row = *srcIter;
 			if (urlObj.getFile().empty() == false)
 			{
@@ -182,27 +225,14 @@
 			for (set<string>::const_iterator errorIter = errors.begin();
 				errorIter != errors.end(); ++errorIter)
 			{
-				statIter = m_refStore->append(srcIter->children());
-				row = *statIter;
+				TreeModel::iterator errIter = m_refStore->append(srcIter->children());
+				row = *errIter;
 				row[m_statsColumns.m_name] = (*errorIter);
 			}
 		}
 	}
+	m_lastErrorDate = time(NULL);
 
-	// Expand everything except errors
-	statisticsTreeview->expand_all();
-	if (hasErrors == true)
-	{
-		TreeModel::Path errPath = m_refStore->get_path(errIter);
-		statisticsTreeview->collapse_row(errPath);
-	}
+	return true;
+}
 
-	Adjustment *pAdjustement = statisticsScrolledwindow->get_hadjustment();
-#ifdef DEBUG
-	cout << "statisticsDialog: " << pAdjustement->get_value() << " "
-		<< pAdjustement->get_lower() << " " << pAdjustement->get_upper() << endl;
-#endif
-	pAdjustement->set_value(pAdjustement->get_upper());
-	statisticsScrolledwindow->set_hadjustment(pAdjustement);
-	resize((int )pAdjustement->get_upper() * 2, get_height());
-}

Modified: trunk/UI/GTK2/src/statisticsDialog.hh
===================================================================
--- trunk/UI/GTK2/src/statisticsDialog.hh	2007-03-17 13:08:04 UTC (rev 769)
+++ trunk/UI/GTK2/src/statisticsDialog.hh	2007-03-18 08:50:01 UTC (rev 770)
@@ -19,6 +19,9 @@
 #ifndef _STATISTICSDIALOG_HH
 #define _STATISTICSDIALOG_HH
 
+#include <time.h>
+#include <sigc++/slot.h>
+#include <sigc++/connection.h>
 #include <glibmm/refptr.h>
 #include <gtkmm/treestore.h>
 
@@ -34,8 +37,20 @@
 protected:
 	Glib::RefPtr<Gtk::TreeStore> m_refStore;
 	ComboModelColumns m_statsColumns;
+	Gtk::TreeModel::iterator m_myWebPagesIter;
+	Gtk::TreeModel::iterator m_myDocumentsIter;
+	Gtk::TreeModel::iterator m_viewStatIter;
+	Gtk::TreeModel::iterator m_daemonIter;
+	Gtk::TreeModel::iterator m_daemonStatIter;
+	Gtk::TreeModel::iterator m_crawledStatIter;
+	Gtk::TreeModel::iterator m_errorsIter;
+	bool m_hasErrors;
+	time_t m_lastErrorDate;
+	SigC::Connection m_idleConnection;
 
 	void populate(void);
 
+	bool on_activity_timeout(void);
+
 };
 #endif



From fabricecolin at mail.berlios.de  Sun Mar 18 13:47:08 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 18 Mar 2007 13:47:08 +0100
Subject: [Pinot-svn] r771 - trunk/SQL
Message-ID: <200703181247.l2ICl8t5017948@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-18 13:47:08 +0100 (Sun, 18 Mar 2007)
New Revision: 771

Modified:
   trunk/SQL/CrawlHistory.cpp
   trunk/SQL/CrawlHistory.h
Log:
Method getSourceItems() can return items newer than a given date.


Modified: trunk/SQL/CrawlHistory.cpp
===================================================================
--- trunk/SQL/CrawlHistory.cpp	2007-03-18 08:50:01 UTC (rev 770)
+++ trunk/SQL/CrawlHistory.cpp	2007-03-18 12:47:08 UTC (rev 771)
@@ -292,16 +292,16 @@
 
 /// Returns items that belong to a source.
 unsigned int CrawlHistory::getSourceItems(unsigned int sourceId, CrawlStatus status,
-	set<string> &urls, time_t maxDate) const
+	set<string> &urls, time_t minDate) const
 {
 	SQLiteResults *results = NULL;
 	unsigned int count = 0;
 
-	if (maxDate > 0)
+	if (minDate > 0)
 	{
 		results = executeStatement("SELECT Url FROM CrawlHistory \
-			WHERE SourceId='%u' AND Status='%q' AND Date<'%d';",
-			sourceId, statusToText(status).c_str(), maxDate);
+			WHERE SourceId='%u' AND Status='%q' AND Date>'%d';",
+			sourceId, statusToText(status).c_str(), minDate);
 	}
 	else
 	{

Modified: trunk/SQL/CrawlHistory.h
===================================================================
--- trunk/SQL/CrawlHistory.h	2007-03-18 08:50:01 UTC (rev 770)
+++ trunk/SQL/CrawlHistory.h	2007-03-18 12:47:08 UTC (rev 771)
@@ -66,7 +66,7 @@
 
 		/// Returns items that belong to a source.
 		unsigned int getSourceItems(unsigned int sourceId, CrawlStatus status,
-			set<string> &urls, time_t maxDate = 0) const;
+			set<string> &urls, time_t minDate = 0) const;
 
 		/// Returns the number of URLs.
 		unsigned int getItemsCount(CrawlStatus status) const;



From fabricecolin at mail.berlios.de  Mon Mar 19 14:27:08 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 19 Mar 2007 14:27:08 +0100
Subject: [Pinot-svn] r772 - trunk/Collect
Message-ID: <200703191327.l2JDR8iV003270@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-19 14:27:07 +0100 (Mon, 19 Mar 2007)
New Revision: 772

Modified:
   trunk/Collect/CurlDownloader.cpp
   trunk/Collect/CurlDownloader.h
   trunk/Collect/DownloaderInterface.h
   trunk/Collect/NeonDownloader.cpp
   trunk/Collect/NeonDownloader.h
Log:
Added settings for proxy address, port and type (not applicable to Neon).
Note that curl should automatically use the *_proxy environment variables.


Modified: trunk/Collect/CurlDownloader.cpp
===================================================================
--- trunk/Collect/CurlDownloader.cpp	2007-03-18 12:47:08 UTC (rev 771)
+++ trunk/Collect/CurlDownloader.cpp	2007-03-19 13:27:07 UTC (rev 772)
@@ -86,7 +86,8 @@
 unsigned int CurlDownloader::m_initialized = 0;
 
 CurlDownloader::CurlDownloader() :
-	DownloaderInterface()
+	DownloaderInterface(),
+	m_proxyPort(0)
 {
 	if (m_initialized == 0)
 	{
@@ -114,15 +115,34 @@
 // Implementation of DownloaderInterface
 //
 
-/// Sets a (name, value) setting; true if success.
+/**
+  * Sets a (name, value) setting. Setting names include :
+  * proxyaddress - the address of the proxy to use
+  * proxyport - the port of the proxy to use (positive integer)
+  * proxytype - the type of the proxy to use
+  * Returns true if success.
+  */
 bool CurlDownloader::setSetting(const string &name, const string &value)
 {
         bool goodSetting = true;
 
-        if (name == "User-Agent")
+        if (name == "useragent")
         {
                 m_userAgent = value;
         }
+	else if (name == "proxyaddress")
+	{
+		m_proxyAddress = value;
+	}
+	else if ((name == "proxyport") &&
+		(value.empty() == false))
+	{
+		m_proxyPort = (unsigned int )atoi(value.c_str());
+	}
+	else if (name == "proxytype")
+	{
+		m_proxyType = value;
+	}
         else
         {
                 goodSetting = false;
@@ -170,7 +190,30 @@
 		cout << "CurlDownloader::retrieveUrl: URL is " << url << endl;
 #endif
 		curl_easy_setopt(pCurlHandler, CURLOPT_URL, url.c_str());
+		// Is a proxy defined ?
+		// Curl automatically checks and makes use of the *_proxy environment variables 
+		if ((m_proxyAddress.empty() == false) &&
+			(m_proxyPort > 0))
+		{
+			curl_proxytype proxyType = CURLPROXY_HTTP;
 
+			curl_easy_setopt(pCurlHandler, CURLOPT_PROXY, m_proxyAddress.c_str());
+			curl_easy_setopt(pCurlHandler, CURLOPT_PROXYPORT, m_proxyPort);
+			// Type defaults to HTTP
+			if (m_proxyType.empty() == false)
+			{
+				if (m_proxyType == "SOCKS4")
+				{
+					proxyType = CURLPROXY_SOCKS4;
+				}
+				else if (m_proxyType == "SOCKS5")
+				{
+					proxyType = CURLPROXY_SOCKS5;
+				}
+			}
+			curl_easy_setopt(pCurlHandler, CURLOPT_PROXYTYPE, proxyType);
+		}
+
 		CURLcode res = curl_easy_perform(pCurlHandler);
 		if (res == CURLE_OK)
 		{

Modified: trunk/Collect/CurlDownloader.h
===================================================================
--- trunk/Collect/CurlDownloader.h	2007-03-18 12:47:08 UTC (rev 771)
+++ trunk/Collect/CurlDownloader.h	2007-03-19 13:27:07 UTC (rev 772)
@@ -30,7 +30,13 @@
 		CurlDownloader();
 		virtual ~CurlDownloader();
 
-		/// Sets a (name, value) setting; true if success.
+		/**
+		  * Sets a (name, value) setting. Setting names include :
+		  * proxyaddress - the address of the proxy to use
+		  * proxyport - the port of the proxy to use (positive integer)
+		  * proxytype - the type of the proxy to use
+		  * Returns true if success.
+		  */
 		virtual bool setSetting(const std::string &name, const std::string &value);
 
 		/// Retrieves the specified document; NULL if error. Caller deletes.
@@ -39,6 +45,9 @@
 	protected:
 		static unsigned int m_initialized;
 		std::string m_userAgent;
+		std::string m_proxyAddress;
+		unsigned int m_proxyPort;
+		std::string m_proxyType;
 
 	private:
 		CurlDownloader(const CurlDownloader &other);

Modified: trunk/Collect/DownloaderInterface.h
===================================================================
--- trunk/Collect/DownloaderInterface.h	2007-03-18 12:47:08 UTC (rev 771)
+++ trunk/Collect/DownloaderInterface.h	2007-03-19 13:27:07 UTC (rev 772)
@@ -35,7 +35,13 @@
 		/// Shutdowns downloaders.
 		static void shutdown(void);
 
-		/// Sets a (name, value) setting; true if success.
+		/**
+		  * Sets a (name, value) setting. Setting names include :
+		  * proxyaddress - the address of the proxy to use
+		  * proxyport - the port of the proxy to use (positive integer)
+		  * proxytype - the type of the proxy to use
+		  * Returns true if success.
+		  */
 		virtual bool setSetting(const std::string &name, const std::string &value);
 
 		/// Sets timeout.

Modified: trunk/Collect/NeonDownloader.cpp
===================================================================
--- trunk/Collect/NeonDownloader.cpp	2007-03-18 12:47:08 UTC (rev 771)
+++ trunk/Collect/NeonDownloader.cpp	2007-03-19 13:27:07 UTC (rev 772)
@@ -35,7 +35,8 @@
 unsigned int NeonDownloader::m_initialized = 0;
 
 NeonDownloader::NeonDownloader() :
-	DownloaderInterface()
+	DownloaderInterface(),
+	m_proxyPort(0)
 {
 	if (m_initialized == 0)
 	{
@@ -96,15 +97,34 @@
 // Implementation of DownloaderInterface
 //
 
-/// Sets a (name, value) setting; true if success.
+/**
+  * Sets a (name, value) setting. Setting names include :
+  * proxyaddress - the address of the proxy to use
+  * proxyport - the port of the proxy to use (positive integer)
+  * proxytype - the type of the proxy to use
+  * Returns true if success.
+  */
 bool NeonDownloader::setSetting(const string &name, const string &value)
 {
 	bool goodSetting = true;
 
-	if (name == "User-Agent")
+	if (name == "useragent")
 	{
 		m_userAgent = value;
 	}
+	else if (name == "proxyaddress")
+	{
+		m_proxyAddress = value;
+	}
+	else if ((name == "proxyport") &&
+		(value.empty() == false))
+	{
+		m_proxyPort = (unsigned int )atoi(value.c_str());
+	}
+	else if (name == "proxytype")
+	{
+		m_proxyType = value;
+	}
 	else
 	{
 		goodSetting = false;
@@ -152,6 +172,13 @@
 	ne_set_useragent(pSession, m_userAgent.c_str());
 	// ...and the timeout
 	ne_set_read_timeout(pSession, (int)m_timeout);
+	// Is a proxy defined ?
+	if ((m_proxyAddress.empty() == false) &&
+		(m_proxyPort > 0))
+	{
+		// Type is HTTP
+		ne_session_proxy(pSession, m_proxyAddress.c_str(), m_proxyPort);
+	}
 
 	string fullLocation = "/";
 	if (location.empty() == false)

Modified: trunk/Collect/NeonDownloader.h
===================================================================
--- trunk/Collect/NeonDownloader.h	2007-03-18 12:47:08 UTC (rev 771)
+++ trunk/Collect/NeonDownloader.h	2007-03-19 13:27:07 UTC (rev 772)
@@ -30,7 +30,13 @@
 		NeonDownloader();
 		virtual ~NeonDownloader();
 
-		/// Sets a (name, value) setting; true if success.
+		/**
+		  * Sets a (name, value) setting. Setting names include :
+		  * proxyaddress - the address of the proxy to use
+		  * proxyport - the port of the proxy to use (positive integer)
+		  * proxytype - the type of the proxy to use
+		  * Returns true if success.
+		  */
 		virtual bool setSetting(const std::string &name, const std::string &value);
 
 		/// Retrieves the specified document; NULL if error. Caller deletes.
@@ -39,6 +45,9 @@
 	protected:
 		static unsigned int m_initialized;
 		std::string m_userAgent;
+		std::string m_proxyAddress;
+		unsigned int m_proxyPort;
+		std::string m_proxyType;
 
 		std::string handleRedirection(const char *pBody, unsigned int length);
 



From fabricecolin at mail.berlios.de  Tue Mar 20 11:50:46 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 20 Mar 2007 11:50:46 +0100
Subject: [Pinot-svn] r773 - trunk/Monitor
Message-ID: <200703201050.l2KAokW9026784@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-20 11:50:45 +0100 (Tue, 20 Mar 2007)
New Revision: 773

Modified:
   trunk/Monitor/INotifyMonitor.cpp
   trunk/Monitor/MonitorEvent.cpp
   trunk/Monitor/MonitorEvent.h
Log:
Don't skip CREATE events on files !
MOVED_FROM events for which we didn't receive a MOVED_TO (because eg, the file
was moved to an unmonitored location on the same filesystem) are expired after
a minute and become DELETE events.


Modified: trunk/Monitor/INotifyMonitor.cpp
===================================================================
--- trunk/Monitor/INotifyMonitor.cpp	2007-03-19 13:27:07 UTC (rev 772)
+++ trunk/Monitor/INotifyMonitor.cpp	2007-03-20 10:50:45 UTC (rev 773)
@@ -201,6 +201,7 @@
 		cout << "INotifyMonitor::retrievePendingEvents: read "
 			<< bytesRead << " bytes at offset " << offset << endl;
 #endif
+
 		// What location is this event for ?
 		map<int, string>::iterator watchIter = m_watches.find(pEvent->wd);
 		if (watchIter == m_watches.end())
@@ -230,8 +231,6 @@
 			monEvent.m_isWatch = false;
 		}
 
-		map<uint32_t, MonitorEvent>::iterator movedIter = m_movedFrom.end();
-
 		// What type of event ?
 		if (pEvent->mask & IN_CREATE)
 		{
@@ -239,11 +238,7 @@
 			cout << "INotifyMonitor::retrievePendingEvents: created "
 				<< monEvent.m_location << endl;
 #endif
-			// Skip regular files
-			if (monEvent.m_isDirectory == true)
-			{
-				monEvent.m_type = MonitorEvent::CREATED;
-			}
+			monEvent.m_type = MonitorEvent::CREATED;
 		}
 		else if (pEvent->mask & IN_CLOSE_WRITE)
 		{
@@ -269,7 +264,7 @@
 				<< monEvent.m_location << " " << pEvent->cookie << endl;
 #endif
 			// What was the previous location ?
-			movedIter = m_movedFrom.find(pEvent->cookie);
+			map<uint32_t, MonitorEvent>::iterator movedIter = m_movedFrom.find(pEvent->cookie);
 			if (movedIter != m_movedFrom.end())
 			{
 				monEvent.m_previousLocation = movedIter->second.m_location;
@@ -305,6 +300,8 @@
 		}
 		else if (pEvent->mask & IN_MOVE_SELF)
 		{
+			map<uint32_t, MonitorEvent>::iterator movedIter = m_movedFrom.end();
+
 #ifdef DEBUG
 			cout << "INotifyMonitor::retrievePendingEvents: moved self on "
 				<< monEvent.m_location << " " << pEvent->cookie << endl;
@@ -382,6 +379,33 @@
 			events.push(monEvent);
 		}
 
+		// Any IN_MOVED_FROM event for which we didn't get a IN_MOVED_TO ?
+		time_t now = time(NULL);
+		map<uint32_t, MonitorEvent>::iterator movedIter = m_movedFrom.begin();
+		while (movedIter != m_movedFrom.end())
+		{
+			// The file was probably moved to an unmonitored location on the same filesystem
+			if (movedIter->second.m_time + 60 < now)
+			{
+				// It's as good as if it was deleted
+				movedIter->second.m_type = MonitorEvent::DELETED;
+				events.push(movedIter->second);
+#ifdef DEBUG
+				cout << "INotifyMonitor::retrievePendingEvents: don't know where "
+					<< movedIter->second.m_location << " was moved to" << endl;
+#endif
+
+				map<uint32_t, MonitorEvent>::iterator nextMovedIter = movedIter;
+				++nextMovedIter;
+				m_movedFrom.erase(movedIter);
+				movedIter = nextMovedIter;
+			}
+			else
+			{
+				++movedIter;
+			}
+		}
+
 		offset += eventSize;
 	}
 	pthread_mutex_unlock(&m_mutex);

Modified: trunk/Monitor/MonitorEvent.cpp
===================================================================
--- trunk/Monitor/MonitorEvent.cpp	2007-03-19 13:27:07 UTC (rev 772)
+++ trunk/Monitor/MonitorEvent.cpp	2007-03-20 10:50:45 UTC (rev 773)
@@ -24,7 +24,8 @@
 MonitorEvent::MonitorEvent() :
 	m_isWatch(false),
 	m_type(UNKNOWN),
-	m_isDirectory(false)
+	m_isDirectory(false),
+	m_time(time(NULL))
 {
 }
 
@@ -33,7 +34,8 @@
 	m_previousLocation(other.m_previousLocation),
 	m_isWatch(other.m_isWatch),
 	m_type(other.m_type),
-	m_isDirectory(other.m_isDirectory)
+	m_isDirectory(other.m_isDirectory),
+	m_time(other.m_time)
 {
 }
 
@@ -50,6 +52,7 @@
 		m_isWatch = other.m_isWatch;
 		m_type = other.m_type;
 		m_isDirectory = other.m_isDirectory;
+		m_time = other.m_time;
 	}
 
 	return *this;
@@ -61,6 +64,24 @@
 	{
 		return true;
 	}
+	else if (m_location == other.m_location)
+	{
+		if (m_type < other.m_type)
+		{
+			return true;
+		}
+	}
 
 	return false;
 }
+
+bool MonitorEvent::operator==(const MonitorEvent& other) const
+{
+	if ((m_location == other.m_location) &&
+		(m_type == other.m_type))
+	{
+		return true;
+	}
+
+	return false;
+}

Modified: trunk/Monitor/MonitorEvent.h
===================================================================
--- trunk/Monitor/MonitorEvent.h	2007-03-19 13:27:07 UTC (rev 772)
+++ trunk/Monitor/MonitorEvent.h	2007-03-20 10:50:45 UTC (rev 773)
@@ -19,6 +19,7 @@
 #ifndef _MONITOR_EVENT_H
 #define _MONITOR_EVENT_H
 
+#include <time.h>
 #include <string>
 
 /// An event generated by a monitor.
@@ -33,6 +34,8 @@
 
 		bool operator<(const MonitorEvent& other) const;
 
+		bool operator==(const MonitorEvent& other) const;
+
 		typedef enum { UNKNOWN = 0, EXISTS, CREATED, WRITE_CLOSED, MOVED, DELETED } EventType;
 
 		std::string m_location;
@@ -40,6 +43,7 @@
 		bool m_isWatch;
 		EventType m_type;
 		bool m_isDirectory;
+		time_t m_time;
 
 };
 



From fabricecolin at mail.berlios.de  Tue Mar 20 12:39:36 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 20 Mar 2007 12:39:36 +0100
Subject: [Pinot-svn] r774 - trunk/Index
Message-ID: <200703201139.l2KBdaS9018094@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-20 12:39:35 +0100 (Tue, 20 Mar 2007)
New Revision: 774

Modified:
   trunk/Index/pinot-index.1
   trunk/Index/pinot-index.cpp
Log:
Proxy can be configured with "-a address -p port -t type".
Check and index no longer require an URL each.


Modified: trunk/Index/pinot-index.1
===================================================================
--- trunk/Index/pinot-index.1	2007-03-20 10:50:45 UTC (rev 773)
+++ trunk/Index/pinot-index.1	2007-03-20 11:39:35 UTC (rev 774)
@@ -4,7 +4,7 @@
 pinot-index \- Index documents from the command-line
 .SH SYNOPSIS
 .B pinot-index
-[\fIOPTIONS\fR]
+[\fIOPTIONS\fR] \fIURL\fR
 .SH DESCRIPTION
 pinot\-index \- Index documents from the command\-line
 .SH OPTIONS
@@ -21,15 +21,24 @@
 \fB\-i\fR, \fB\-\-index\fR
 index the given URL
 .TP
+\fB\-a\fR, \fB\-\-proxyaddress\fR
+proxy address
+.TP
+\fB\-p\fR, \fB\-\-proxyport\fR
+proxy port
+.TP
+\fB\-t\fR, \fB\-\-proxytype\fR
+proxy type (default HTTP, SOCKS4, SOCKS5)
+.TP
 \fB\-s\fR, \fB\-\-showinfo\fR
 show information about the document
 .TP
 \fB\-v\fR, \fB\-\-version\fR
 output version information and exit
 .SH EXAMPLES
-pinot\-index \fB\-\-check\fR file:///home/fabrice/Documents/Bozo.txt \fB\-\-showinfo\fR \fB\-\-db\fR ~/.pinot/daemon
+pinot\-index \fB\-\-check\fR \fB\-\-showinfo\fR \fB\-\-db\fR ~/.pinot/daemon file:///home/fabrice/Documents/Bozo.txt
 .PP
-pinot\-index \fB\-\-index\fR http://pinot.berlios.de/ \fB\-\-db\fR ~/.pinot/index
+pinot\-index \fB\-\-index\fR \fB\-\-db\fR ~/.pinot/index http://pinot.berlios.de/
 .SH "REPORTING BUGS"
 Report bugs to fabricecolin at users.berlios.de
 .PP

Modified: trunk/Index/pinot-index.cpp
===================================================================
--- trunk/Index/pinot-index.cpp	2007-03-20 10:50:45 UTC (rev 773)
+++ trunk/Index/pinot-index.cpp	2007-03-20 11:39:35 UTC (rev 774)
@@ -35,36 +35,64 @@
 using namespace std;
 
 static struct option g_longOptions[] = {
-	{"check", 1, 0, 'c'},
+	{"check", 0, 0, 'c'},
 	{"db", 1, 0, 'd'},
 	{"help", 0, 0, 'h'},
-	{"index", 1, 0, 'i'},
+	{"index", 0, 0, 'i'},
+	{"proxyaddress", 1, 0, 'a'},
+	{"proxyport", 1, 0, 'p'},
+	{"proxytype", 1, 0, 't'},
 	{"showinfo", 0, 0, 's'},
 	{"version", 0, 0, 'v'},
 	{0, 0, 0, 0}
 };
 
+static void printHelp(void)
+{
+	// Help
+	cout << "pinot-index - Index documents from the command-line\n\n"
+		<< "Usage: pinot-index [OPTIONS] URL\n\n"
+		<< "Options:\n"
+		<< "  -c, --check               check whether the given URL is in the index\n"
+		<< "  -d, --db                  path to index to use (mandatory)\n"
+		<< "  -h, --help                display this help and exit\n"
+		<< "  -i, --index               index the given URL\n"
+		<< "  -a, --proxyaddress        proxy address\n"
+		<< "  -p, --proxyport           proxy port\n"
+		<< "  -t, --proxytype           proxy type (default HTTP, SOCKS4, SOCKS5)\n"
+		<< "  -s, --showinfo            show information about the document\n"
+		<< "  -v, --version             output version information and exit\n\n";
+	// Don't mention type dbus here as it doesn't support indexing and
+	// is identical to xapian when checking for URLs
+	cout << "Examples:\n"
+		<< "pinot-index --check --showinfo --db ~/.pinot/daemon file:///home/fabrice/Documents/Bozo.txt\n\n"
+		<< "pinot-index --index --db ~/.pinot/index http://pinot.berlios.de/\n\n"
+		<< "Report bugs to " << PACKAGE_BUGREPORT << endl;
+}
+
 int main(int argc, char **argv)
 {
 	string type, option;
-	string databaseName, urlToCheck, urlToIndex;
+	string databaseName, proxyAddress, proxyPort, proxyType;
 	int longOptionIndex = 0;
 	unsigned int docId = 0;
 	bool checkDocument = false, indexDocument = false, showInfo = false, success = false;
 
 	// Look at the options
-	int optionChar = getopt_long(argc, argv, "c:d:hi:sv", g_longOptions, &longOptionIndex);
+	int optionChar = getopt_long(argc, argv, "cd:hia:p:t:sv", g_longOptions, &longOptionIndex);
 	while (optionChar != -1)
 	{
 		set<string> engines;
 
 		switch (optionChar)
 		{
-			case 'c':
+			case 'a':
 				if (optarg != NULL)
 				{
-					urlToCheck = optarg;
+					proxyAddress = optarg;
 				}
+				break;
+			case 'c':
 				checkDocument = true;
 				break;
 			case 'd':
@@ -72,36 +100,28 @@
 				{
 					databaseName = optarg;
 				}
-				checkDocument = true;
 				break;
 			case 'h':
-				// Help
-				cout << "pinot-index - Index documents from the command-line\n\n"
-					<< "Usage: pinot-index [OPTIONS]\n\n"
-					<< "Options:\n"
-					<< "  -c, --check               check whether the given URL is in the index\n"
-					<< "  -d, --db                  path to index to use (mandatory)\n"
-					<< "  -h, --help                display this help and exit\n"
-					<< "  -i, --index               index the given URL\n"
-					<< "  -s, --showinfo            show information about the document\n"
-					<< "  -v, --version             output version information and exit\n\n";
-				// Don't mention type dbus here as it doesn't support indexing and
-				// is identical to xapian when checking for URLs
-				cout << "Examples:\n"
-					<< "pinot-index --check file:///home/fabrice/Documents/Bozo.txt --showinfo --db ~/.pinot/daemon\n\n"
-					<< "pinot-index --index http://pinot.berlios.de/ --db ~/.pinot/index\n\n"
-					<< "Report bugs to " << PACKAGE_BUGREPORT << endl;
+				printHelp();
 				return EXIT_SUCCESS;
 			case 'i':
+				indexDocument = true;
+				break;
+			case 'p':
 				if (optarg != NULL)
 				{
-					urlToIndex = optarg;
+					proxyPort = optarg;
 				}
-				indexDocument = true;
 				break;
 			case 's':
 				showInfo = true;
 				break;
+			case 't':
+				if (optarg != NULL)
+				{
+					proxyType = optarg;
+				}
+				break;
 			case 'v':
 				cout << "pinot-index - " << PACKAGE_STRING << "\n\n"
 					<< "This is free software.  You may redistribute copies of it under the terms of\n"
@@ -113,9 +133,22 @@
 		}
 
 		// Next option
-		optionChar = getopt_long(argc, argv, "c:d:hi:sv", g_longOptions, &longOptionIndex);
+		optionChar = getopt_long(argc, argv, "cd:hia:p:t:sv", g_longOptions, &longOptionIndex);
 	}
 
+	if (argc == 1)
+	{
+		printHelp();
+		return EXIT_SUCCESS;
+	}
+
+	if ((argc < 2) ||
+		(argc - optind != 1))
+	{
+		cerr << "Not enough parameters" << endl;
+		return EXIT_FAILURE;
+	}
+
 	if (((indexDocument == false) &&
 		(checkDocument == false)) ||
 		(databaseName.empty() == true))
@@ -158,21 +191,23 @@
 		return EXIT_FAILURE;
 	}
 
+	string urlParam(argv[optind]);
+
 	if (checkDocument == true)
 	{
 		if (pIndex->isGood() == true)
 		{
-			docId = pIndex->hasDocument(urlToCheck);
+			docId = pIndex->hasDocument(urlParam);
 			if (docId > 0)
 			{
-				cout << urlToCheck << ": document ID " << docId << endl;
+				cout << urlParam << ": document ID " << docId << endl;
 				success = true;
 			}
 		}
 	}
 	if (indexDocument == true)
 	{
-		Url thisUrl(urlToIndex);
+		Url thisUrl(urlParam);
 
 		// Which Downloader ?
 		DownloaderInterface *pDownloader = DownloaderFactory::getDownloader(thisUrl.getProtocol());
@@ -189,7 +224,16 @@
 			return EXIT_FAILURE;
 		}
 
-		DocumentInfo docInfo(urlToIndex, urlToIndex, MIMEScanner::scanUrl(thisUrl), "");
+		// Set up the proxy
+		if ((proxyAddress.empty() == false) &&
+			(proxyPort.empty() == false))
+		{
+			pDownloader->setSetting("proxyaddress", proxyAddress);
+			pDownloader->setSetting("proxyport", proxyPort);
+			pDownloader->setSetting("proxytype", proxyType);
+		}
+
+		DocumentInfo docInfo(urlParam, urlParam, MIMEScanner::scanUrl(thisUrl), "");
 		Document *pDoc = pDownloader->retrieveUrl(docInfo);
 		if (pDoc == NULL)
 		{
@@ -202,7 +246,7 @@
 			pIndex->setStemmingMode(IndexInterface::STORE_BOTH);
 
 			// Update an existing document or add to the index ?
-			docId = pIndex->hasDocument(urlToIndex);
+			docId = pIndex->hasDocument(urlParam);
 			if (docId > 0)
 			{
 				// Update the document



From fabricecolin at mail.berlios.de  Tue Mar 20 12:42:25 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 20 Mar 2007 12:42:25 +0100
Subject: [Pinot-svn] r775 - trunk/Search
Message-ID: <200703201142.l2KBgPLr022345@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-20 12:42:22 +0100 (Tue, 20 Mar 2007)
New Revision: 775

Modified:
   trunk/Search/SearchEngineInterface.cpp
   trunk/Search/SearchEngineInterface.h
   trunk/Search/WebEngine.cpp
   trunk/Search/WebEngine.h
   trunk/Search/pinot-search.1
   trunk/Search/pinot-search.cpp
Log:
Changes to allow configuring the proxy to use for Web searches.


Modified: trunk/Search/SearchEngineInterface.cpp
===================================================================
--- trunk/Search/SearchEngineInterface.cpp	2007-03-20 11:39:35 UTC (rev 774)
+++ trunk/Search/SearchEngineInterface.cpp	2007-03-20 11:42:22 UTC (rev 775)
@@ -63,6 +63,12 @@
 	return false;
 }
 
+/// Returns the downloader used if any.
+DownloaderInterface *SearchEngineInterface::getDownloader(void)
+{
+	return NULL;
+}
+
 /// Returns the results for the previous query.
 const vector<Result> &SearchEngineInterface::getResults(void) const
 {

Modified: trunk/Search/SearchEngineInterface.h
===================================================================
--- trunk/Search/SearchEngineInterface.h	2007-03-20 11:39:35 UTC (rev 774)
+++ trunk/Search/SearchEngineInterface.h	2007-03-20 11:42:22 UTC (rev 775)
@@ -24,6 +24,7 @@
 #include <set>
 #include <vector>
 
+#include "DownloaderInterface.h"
 #include "QueryProperties.h"
 #include "Result.h"
 
@@ -47,6 +48,9 @@
 		/// Sets whether the query should be expanded.
 		virtual bool setQueryExpansion(set<unsigned int> &relevantDocuments);
 
+		/// Returns the downloader used if any.
+		virtual DownloaderInterface *getDownloader(void);
+
 		/// Runs a query; true if success.
 		virtual bool runQuery(QueryProperties& queryProps) = 0;
 

Modified: trunk/Search/WebEngine.cpp
===================================================================
--- trunk/Search/WebEngine.cpp	2007-03-20 11:39:35 UTC (rev 774)
+++ trunk/Search/WebEngine.cpp	2007-03-20 11:42:22 UTC (rev 775)
@@ -54,27 +54,30 @@
 }
 
 WebEngine::WebEngine() :
-	SearchEngineInterface()
+	SearchEngineInterface(),
+	m_pDownloader(DownloaderFactory::getDownloader("http"))
 {
 }
 
 WebEngine::~WebEngine()
 {
 	m_resultsList.clear();
+	if (m_pDownloader != NULL)
+	{
+		delete m_pDownloader;
+	}
 }
 
 Document *WebEngine::downloadPage(const DocumentInfo &docInfo)
 {
 	m_charset.clear();
 
-	// Any type of downloader will do...
-	DownloaderInterface *pDownloader = DownloaderFactory::getDownloader("http");
-	if (pDownloader == NULL)
+	if (m_pDownloader == NULL)
 	{
 		return NULL;
 	}
 
-	Document *pDoc = pDownloader->retrieveUrl(docInfo);
+	Document *pDoc = m_pDownloader->retrieveUrl(docInfo);
 	if (pDoc != NULL)
 	{
 		string contentType(pDoc->getType());
@@ -104,7 +107,6 @@
 			}
 		}
 	}
-	delete pDownloader;
 
 	return pDoc;
 }
@@ -269,3 +271,9 @@
 
 	return true;
 }
+
+/// Returns the downloader used if any.
+DownloaderInterface *WebEngine::getDownloader(void)
+{
+	return m_pDownloader;
+}

Modified: trunk/Search/WebEngine.h
===================================================================
--- trunk/Search/WebEngine.h	2007-03-20 11:39:35 UTC (rev 774)
+++ trunk/Search/WebEngine.h	2007-03-20 11:42:22 UTC (rev 775)
@@ -33,7 +33,11 @@
 		WebEngine();
 		virtual ~WebEngine();
 
+		/// Returns the downloader used if any.
+		virtual DownloaderInterface *getDownloader(void);
+
 	protected:
+		DownloaderInterface *m_pDownloader;
 		std::string m_hostFilter;
 		std::string m_fileFilter;
 		std::set<std::string> m_queryTerms;

Modified: trunk/Search/pinot-search.1
===================================================================
--- trunk/Search/pinot-search.1	2007-03-20 11:39:35 UTC (rev 774)
+++ trunk/Search/pinot-search.1	2007-03-20 11:42:22 UTC (rev 775)
@@ -13,8 +13,17 @@
 display this help and exit
 .TP
 \fB\-m\fR, \fB\-\-max\fR
-maximum number of results (default: 10)
+maximum number of results (default 10)
 .TP
+\fB\-a\fR, \fB\-\-proxyaddress\fR
+proxy address
+.TP
+\fB\-p\fR, \fB\-\-proxyport\fR
+proxy port
+.TP
+\fB\-t\fR, \fB\-\-proxytype\fR
+proxy type (default HTTP, SOCKS4, SOCKS5)
+.TP
 \fB\-v\fR, \fB\-\-version\fR
 output version information and exit
 .PP

Modified: trunk/Search/pinot-search.cpp
===================================================================
--- trunk/Search/pinot-search.cpp	2007-03-20 11:39:35 UTC (rev 774)
+++ trunk/Search/pinot-search.cpp	2007-03-20 11:42:22 UTC (rev 775)
@@ -36,47 +36,64 @@
 static struct option g_longOptions[] = {
 	{"help", 0, 0, 'h'},
 	{"max", 1, 0, 'm'},
+	{"proxyaddress", 1, 0, 'a'},
+	{"proxyport", 1, 0, 'p'},
+	{"proxytype", 1, 0, 't'},
 	{"version", 0, 0, 'v'},
 	{0, 0, 0, 0}
 };
 
+static void printHelp(void)
+{
+	set<string> engines;
+
+	// Help
+	SearchEngineFactory::getSupportedEngines(engines);
+	cout << "pinot-search - Query search engines from the command-line\n\n"
+		<< "Usage: pinot-search [OPTIONS] SEARCHENGINETYPE SEARCHENGINENAME|SEARCHENGINEOPTION QUERYSTRING\n\n"
+		<< "Options:\n"
+		<< "  -h, --help                display this help and exit\n"
+		<< "  -m, --max                 maximum number of results (default 10)\n"
+		<< "  -a, --proxyaddress        proxy address\n"
+		<< "  -p, --proxyport           proxy port\n"
+		<< "  -t, --proxytype           proxy type (default HTTP, SOCKS4, SOCKS5)\n"
+		<< "  -v, --version             output version information and exit\n\n"
+		<< "Supported search engine types are";
+	for (set<string>::iterator engineIter = engines.begin(); engineIter != engines.end(); ++engineIter)
+	{
+		cout << " " << *engineIter;
+	}
+	cout << "\n\nExamples:\n"
+#ifdef HAVE_GOOGLEAPI
+		<< "pinot-search googleapi mygoogleapikey \"clowns\" 10\n\n"
+#endif
+		<< "pinot-search opensearch " << PREFIX << "/share/pinot/engines/KrustyDescription.xml \"clowns\"\n\n"
+		<< "pinot-search --max 20 sherlock " << PREFIX << "/share/pinot/engines/Bozo.src \"clowns\"\n\n"
+		<< "pinot-search --max 10 xapian ~/.pinot/index \"clowns\"\n\n"
+		<< "pinot-search xapian somehostname:12345 \"clowns\" 10\n\n"
+		<< "Report bugs to " << PACKAGE_BUGREPORT << endl;
+}
+
 int main(int argc, char **argv)
 {
-	string type, option;
+	string type, option, proxyAddress, proxyPort, proxyType;
 	unsigned int count = 10; 
 	int longOptionIndex = 0;
 
 	// Look at the options
-	int optionChar = getopt_long(argc, argv, "hm:v", g_longOptions, &longOptionIndex);
+	int optionChar = getopt_long(argc, argv, "hm:a:p:t:v", g_longOptions, &longOptionIndex);
 	while (optionChar != -1)
 	{
-		set<string> engines;
-
 		switch (optionChar)
 		{
-			case 'h':
-				// Help
-				SearchEngineFactory::getSupportedEngines(engines);
-				cout << "pinot-search - Query search engines from the command-line\n\n"
-					<< "Usage: pinot-search [OPTIONS] SEARCHENGINETYPE SEARCHENGINENAME|SEARCHENGINEOPTION QUERYSTRING\n\n"
-					<< "Options:\n"
-					<< "  -h, --help		display this help and exit\n"
-					<< "  -m, --max 		maximum number of results (default: 10)\n"
-					<< "  -v, --version		output version information and exit\n\n"
-					<< "Supported search engine types are";
-				for (set<string>::iterator engineIter = engines.begin(); engineIter != engines.end(); ++engineIter)
+			case 'a':
+				if (optarg != NULL)
 				{
-					cout << " " << *engineIter;
+					proxyAddress = optarg;
 				}
-				cout << "\n\nExamples:\n"
-#ifdef HAVE_GOOGLEAPI
-					<< "pinot-search googleapi mygoogleapikey \"clowns\" 10\n\n"
-#endif
-					<< "pinot-search opensearch " << PREFIX << "/share/pinot/engines/KrustyDescription.xml \"clowns\"\n\n"
-					<< "pinot-search --max 20 sherlock " << PREFIX << "/share/pinot/engines/Bozo.src \"clowns\"\n\n"
-					<< "pinot-search --max 10 xapian ~/.pinot/index \"clowns\"\n\n"
-					<< "pinot-search xapian somehostname:12345 \"clowns\" 10\n\n"
-					<< "Report bugs to " << PACKAGE_BUGREPORT << endl;
+				break;
+			case 'h':
+				printHelp();
 				return EXIT_SUCCESS;
 			case 'm':
 				if (optarg != NULL)
@@ -84,6 +101,18 @@
 					count = (unsigned int )atoi(optarg);
 				}
 				break;
+			case 'p':
+				if (optarg != NULL)
+				{
+					proxyPort = optarg;
+				}
+				break;
+			case 't':
+				if (optarg != NULL)
+				{
+					proxyType = optarg;
+				}
+				break;
 			case 'v':
 				cout << "pinot-search - " << PACKAGE_STRING << "\n\n"
 					<< "This is free software.  You may redistribute copies of it under the terms of\n"
@@ -95,9 +124,15 @@
 		}
 
 		// Next option
-		optionChar = getopt_long(argc, argv, "hm:v", g_longOptions, &longOptionIndex);
+		optionChar = getopt_long(argc, argv, "hm:a:p:t:v", g_longOptions, &longOptionIndex);
 	}
 
+	if (argc == 1)
+	{
+		printHelp();
+		return EXIT_SUCCESS;
+	}
+
 	if ((argc < 4) ||
 		(argc - optind != 3))
 	{
@@ -125,6 +160,17 @@
 	// How many results ?
 	pEngine->setMaxResultsCount(count);
 
+	// Set up the proxy
+	DownloaderInterface *pDownloader = pEngine->getDownloader();
+	if ((pDownloader != NULL) &&
+		(proxyAddress.empty() == false) &&
+		(proxyPort.empty() == false))
+	{
+		pDownloader->setSetting("proxyaddress", proxyAddress);
+		pDownloader->setSetting("proxyport", proxyPort);
+		pDownloader->setSetting("proxytype", proxyType);
+	}
+
 	QueryProperties queryProps("senginetest", argv[optind + 2]);
 	if (pEngine->runQuery(queryProps) == true)
 	{



From fabricecolin at mail.berlios.de  Tue Mar 20 12:46:41 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 20 Mar 2007 12:46:41 +0100
Subject: [Pinot-svn] r776 - trunk/UI/GTK2/src
Message-ID: <200703201146.l2KBkf1J026859@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-20 12:46:40 +0100 (Tue, 20 Mar 2007)
New Revision: 776

Modified:
   trunk/UI/GTK2/src/ServerThreads.cpp
Log:
MonitorThread::processEvents() didn't skip dotfiles and blacklisted files.


Modified: trunk/UI/GTK2/src/ServerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-20 11:42:22 UTC (rev 775)
+++ trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-20 11:46:40 UTC (rev 776)
@@ -153,6 +153,16 @@
 			<< event.m_location << " " << event.m_isDirectory << endl;
 #endif
 
+		// Skip dotfiles and blacklisted files
+		Url urlObj("file://" + event.m_location);
+		if ((urlObj.getFile()[0] == '.') ||
+			(PinotSettings::getInstance().isBlackListed(event.m_location) == true))
+		{
+			// Next
+			events.pop();
+			continue;
+		}
+
 		// What's the event code ?
 		if (event.m_type == MonitorEvent::EXISTS)
 		{



From fabricecolin at mail.berlios.de  Wed Mar 21 18:15:31 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 21 Mar 2007 18:15:31 +0100
Subject: [Pinot-svn] r777 - in trunk: UI/GTK2/src scripts/python
Message-ID: <200703211715.l2LHFVHe008697@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-21 18:15:31 +0100 (Wed, 21 Mar 2007)
New Revision: 777

Modified:
   trunk/UI/GTK2/src/ServerThreads.cpp
   trunk/scripts/python/pinot-live.py
Log:
Updated deskbar handler to cope with new GetDocumentInfo. Use
deskbar.Utils.url_show() if available. Also added license and copyright notices.
D-Bus daemon implements org.freedesktop.DBus.Introspectable.Introspect.


Modified: trunk/UI/GTK2/src/ServerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-20 11:46:40 UTC (rev 776)
+++ trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-21 17:15:31 UTC (rev 777)
@@ -27,6 +27,7 @@
 #include <errno.h>
 #include <exception>
 #include <iostream>
+#include <fstream>
 #include <sigc++/class_slot.h>
 #include <sigc++/compatibility.h>
 #include <sigc++/slot.h>
@@ -64,6 +65,40 @@
         return NULL;
 }
 
+static ustring g_xmlDescription;
+
+static bool loadXMLDescription(void)
+{
+	if (g_xmlDescription.empty() == false)
+	{
+		return true;
+	}
+
+	ifstream xmlFile;
+	string xmlFileName(PREFIX);
+
+	xmlFileName += "/share/doc/pinot-dbus-daemon.xml";
+	xmlFile.open(xmlFileName.c_str());
+	if (xmlFile.good() == true)
+	{
+		xmlFile.seekg(0, ios::end);
+		int length = xmlFile.tellg();
+		xmlFile.seekg(0, ios::beg);
+
+		char *pXmlBuffer = new char[length + 1];
+		xmlFile.read(pXmlBuffer, length);
+		if (xmlFile.fail() == false)
+		{
+			pXmlBuffer[length] = '\0';
+			g_xmlDescription = pXmlBuffer;
+		}
+		delete[] pXmlBuffer;
+	}
+	xmlFile.close();
+
+	return true;	
+}
+
 MonitorThread::MonitorThread(MonitorInterface *pMonitor, MonitorHandler *pHandler) :
 	WorkerThread(),
 	m_ctrlReadPipe(-1),
@@ -1151,6 +1186,25 @@
 			}
 		}
 	}
+	else if (dbus_message_is_method_call(m_pRequest, "org.freedesktop.DBus.Introspectable", "Introspect") == TRUE)
+	{
+#ifdef DEBUG
+		cout << "DBusServletThread::doWork: received Introspect" << endl;
+#endif
+		if (loadXMLDescription() == true)
+		{
+			// Prepare the reply
+			m_pReply = newDBusReply(m_pRequest);
+			if (m_pReply != NULL)
+			{
+				const char *pXmlData = g_xmlDescription.c_str();
+
+				dbus_message_append_args(m_pReply,
+					DBUS_TYPE_STRING, &pXmlData,
+					DBUS_TYPE_INVALID);
+			}
+		}
+	}
 	else
 	{
 #ifdef DEBUG

Modified: trunk/scripts/python/pinot-live.py
===================================================================
--- trunk/scripts/python/pinot-live.py	2007-03-20 11:46:40 UTC (rev 776)
+++ trunk/scripts/python/pinot-live.py	2007-03-21 17:15:31 UTC (rev 777)
@@ -1,5 +1,23 @@
+#!/usr/bin/env python
+#
+# Copyright 2005-2007 Fabrice Colin
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+#
+
 import gnome
-
 import deskbar
 import deskbar.Handler, deskbar
 import gobject
@@ -55,7 +73,11 @@
 
 	def action(self, text=None):
 		print "Opening Pinot hit: ", self.url
-		gnome.url_show (self.url)
+		# Prefer deskbar's url_show is available
+		try:
+			deskbar.Utils.url_show (self.url)
+		except AttributeError:
+			gnome.url_show (self.url)
 
 	def get_category (self):
 		return "files"
@@ -102,7 +124,23 @@
 		except Exception, msg:
 			print 'Caught exception: ', msg
 
-	def __receive_hits (self, name, url, mime_type, main_language):
+	def __receive_hits (self, fields):
+		name = "Unknown"
+		url = ""
+		mime_type = "application/octet-stream"
+		main_language = ""
+
+		# Get the fields we need to build a match
+		for field in fields:
+			if field[0] == "caption":
+				name = field[1]
+			elif field[0] == "url":
+				url = field[1]
+			elif field[0] == "type":
+				mime_type = field[1]
+			elif field[0] == "language":
+				main_language = field[1]
+
 		self.results.append( PinotFileMatch(self, name, url, mime_type, main_language) )
 		print "Got hit ", len(self.results)
 		if len(self.results) == self.results_count:



From fabricecolin at mail.berlios.de  Thu Mar 22 11:56:58 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 22 Mar 2007 11:56:58 +0100
Subject: [Pinot-svn] r778 - in trunk: Collect UI/GTK2/src Utils
Message-ID: <200703221056.l2MAuwfJ015452@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-22 11:56:57 +0100 (Thu, 22 Mar 2007)
New Revision: 778

Modified:
   trunk/Collect/FileCollector.cpp
   trunk/UI/GTK2/src/ServerThreads.cpp
   trunk/Utils/Document.cpp
Log:
Directories are indexed as separate documents.


Modified: trunk/Collect/FileCollector.cpp
===================================================================
--- trunk/Collect/FileCollector.cpp	2007-03-21 17:15:31 UTC (rev 777)
+++ trunk/Collect/FileCollector.cpp	2007-03-22 10:56:57 UTC (rev 778)
@@ -58,8 +58,11 @@
 
 	Document *pDocument = new Document(docInfo);
 
-	// Determine the file type
-	pDocument->setType(MIMEScanner::scanFile(fileLocation));
+	if (pDocument->getType().empty() == true)
+	{
+		// Determine the file type
+		pDocument->setType(MIMEScanner::scanFile(fileLocation));
+	}
 	if (pDocument->setDataFromFile(fileLocation) == false)
 	{
 		delete pDocument;

Modified: trunk/UI/GTK2/src/ServerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-21 17:15:31 UTC (rev 777)
+++ trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-22 10:56:57 UTC (rev 778)
@@ -449,10 +449,11 @@
 bool DirectoryScannerThread::scanEntry(const string &entryName, CrawlHistory &history)
 {
 	CrawlHistory::CrawlStatus status = CrawlHistory::UNKNOWN;
+	string location("file://" + entryName);
 	time_t itemDate;
 	struct stat fileStat;
 	int statSuccess = 0;
-	bool scanSuccess = true;
+	bool scanSuccess = true, reportFile = false;
 
 	if (entryName.empty() == true)
 	{
@@ -463,7 +464,7 @@
 	}
 
 	// Skip . .. and dotfiles
-	Url urlObj("file://" + entryName);
+	Url urlObj(location);
 	if (urlObj.getFile()[0] == '.')
 	{
 #ifdef DEBUG
@@ -483,7 +484,7 @@
 	}
 
 	// Is this item in the database already ?
-	bool itemExists = history.hasItem("file://" + entryName, status, itemDate);
+	bool itemExists = history.hasItem(location, status, itemDate);
 
 	if (statSuccess == -1)
 	{
@@ -503,52 +504,13 @@
 	}
 	else if (S_ISREG(fileStat.st_mode))
 	{
-		DocumentInfo docInfo;
-		bool reportFile = false;
-
-		docInfo.setLocation("file://" + entryName);
-
 		// Is this file blacklisted ?
 		// We have to check early so that if necessary the file's status stays at CRAWLING 
 		// and it is removed from the index at the end of this crawl
 		if (PinotSettings::getInstance().isBlackListed(entryName) == false)
 		{
-			if (itemExists == false)
-			{
-				// Record it
-				history.insertItem(docInfo.getLocation(), CrawlHistory::CRAWLED, m_sourceId, fileStat.st_mtime);
-#ifdef DEBUG
-				cout << "DirectoryScannerThread::scanEntry: reporting new file " << entryName << endl;
-#endif
-				reportFile = true;
-			}
-			else
-			{
-				// Update the record
-				history.updateItem(docInfo.getLocation(), CrawlHistory::CRAWLED, fileStat.st_mtime);
-
-				// Was it last crawled after it was modified ?
-				if (itemDate < fileStat.st_mtime)
-				{
-#ifdef DEBUG
-					cout << "DirectoryScannerThread::scanEntry: reporting modified file " << entryName << endl;
-#endif
-					// No, crawl and index it again
-					reportFile = true;
-				}
-			}
+			reportFile = true;
 		}
-
-		if (reportFile == true)
-		{
-			Url urlObj(docInfo.getLocation());
-
-			docInfo.setTitle(urlObj.getFile());
-			docInfo.setTimestamp(TimeConverter::toTimestamp(fileStat.st_mtime));
-			docInfo.setSize(fileStat.st_size);
-
-			foundFile(docInfo);
-		}
 	}
 	else if (S_ISDIR(fileStat.st_mode))
 	{
@@ -611,6 +573,7 @@
 				// Close the directory
 				closedir(pDir);
 				--m_currentLevel;
+				reportFile = true;
 			}
 			else
 			{
@@ -629,6 +592,7 @@
 		scanSuccess = false;
 	}
 
+	// Did an error occur ?
 	if (scanSuccess == false)
 	{
 		time_t timeNow = time(NULL);
@@ -636,14 +600,56 @@
 		// Record this error
 		if (itemExists == false)
 		{
-			history.insertItem("file://" + entryName, CrawlHistory::ERROR, m_sourceId, timeNow);
+			history.insertItem(location, CrawlHistory::ERROR, m_sourceId, timeNow);
 		}
 		else
 		{
-			history.updateItem("file://" + entryName, CrawlHistory::ERROR, timeNow);
+			history.updateItem(location, CrawlHistory::ERROR, timeNow);
 		}
 	}
+	else if (reportFile == true)
+	{
+		if (itemExists == false)
+		{
+			// Record it
+			history.insertItem(location, CrawlHistory::CRAWLED, m_sourceId, fileStat.st_mtime);
+#ifdef DEBUG
+			cout << "DirectoryScannerThread::scanEntry: reporting new file " << entryName << endl;
+#endif
+		}
+		else
+		{
+			// Update the record
+			history.updateItem(location, CrawlHistory::CRAWLED, fileStat.st_mtime);
 
+			// Was it last crawled after it was modified ?
+			if (itemDate >= fileStat.st_mtime)
+			{
+				// Yes, it was
+				reportFile = false;
+			}
+#ifdef DEBUG
+			else cout << "DirectoryScannerThread::scanEntry: reporting modified file " << entryName << endl;
+#endif
+		}
+
+		if (reportFile == true)
+		{
+			DocumentInfo docInfo;
+
+			docInfo.setLocation(location);
+			docInfo.setTitle(urlObj.getFile());
+			if (S_ISDIR(fileStat.st_mode))
+			{
+				docInfo.setType("x-directory/normal");
+			}
+			docInfo.setTimestamp(TimeConverter::toTimestamp(fileStat.st_mtime));
+			docInfo.setSize(fileStat.st_size);
+
+			foundFile(docInfo);
+		}
+	}
+
 	return scanSuccess;
 }
 

Modified: trunk/Utils/Document.cpp
===================================================================
--- trunk/Utils/Document.cpp	2007-03-21 17:15:31 UTC (rev 777)
+++ trunk/Utils/Document.cpp	2007-03-22 10:56:57 UTC (rev 778)
@@ -138,16 +138,19 @@
 	}
 
 	// Make sure the file exists
-	if ((stat(fileName.c_str(), &fileStat) != 0) ||
+	if (stat(fileName.c_str(), &fileStat) != 0)
+	{
+		return false;
+	}
+
+	if ((!S_ISDIR(fileStat.st_mode)) && 
 		(!S_ISREG(fileStat.st_mode)))
 	{
-#ifdef DEBUG
-		cout << "Document::setDataFromFile: " << fileName << " is not a file" << endl;
-#endif
 		return false;
 	}
 
-	if (fileStat.st_size == 0)
+	if ((S_ISDIR(fileStat.st_mode)) ||
+		(fileStat.st_size == 0))
 	{
 		// The file is empty
 		resetData();



From fabricecolin at mail.berlios.de  Thu Mar 22 12:00:21 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 22 Mar 2007 12:00:21 +0100
Subject: [Pinot-svn] r779 - trunk/UI/GTK2/src
Message-ID: <200703221100.l2MB0LDo015739@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-22 12:00:20 +0100 (Thu, 22 Mar 2007)
New Revision: 779

Modified:
   trunk/UI/GTK2/src/ModelColumns.cpp
   trunk/UI/GTK2/src/ModelColumns.h
   trunk/UI/GTK2/src/ResultsTree.cpp
   trunk/UI/GTK2/src/ResultsTree.h
Log:
Documents MIME type was lost by the results tree.


Modified: trunk/UI/GTK2/src/ModelColumns.cpp
===================================================================
--- trunk/UI/GTK2/src/ModelColumns.cpp	2007-03-22 10:56:57 UTC (rev 778)
+++ trunk/UI/GTK2/src/ModelColumns.cpp	2007-03-22 11:00:20 UTC (rev 779)
@@ -58,6 +58,7 @@
 {
 	add(m_text);
 	add(m_url);
+	add(m_type);
 	add(m_indexed);
 	add(m_viewed);
 	add(m_rankDiff);
@@ -66,7 +67,7 @@
 	add(m_engines);
 	add(m_indexes);
 	add(m_docId);
-	add(m_type);
+	add(m_resultType);
 	add(m_timestamp);
 	add(m_timestampTime);
 }

Modified: trunk/UI/GTK2/src/ModelColumns.h
===================================================================
--- trunk/UI/GTK2/src/ModelColumns.h	2007-03-22 10:56:57 UTC (rev 778)
+++ trunk/UI/GTK2/src/ModelColumns.h	2007-03-22 11:00:20 UTC (rev 779)
@@ -81,6 +81,7 @@
 
 	Gtk::TreeModelColumn<Glib::ustring> m_text;
 	Gtk::TreeModelColumn<Glib::ustring> m_url;
+	Gtk::TreeModelColumn<Glib::ustring> m_type;
 	Gtk::TreeModelColumn<bool> m_indexed;
 	Gtk::TreeModelColumn<bool> m_viewed;
 	Gtk::TreeModelColumn<int> m_rankDiff;
@@ -90,7 +91,7 @@
 	Gtk::TreeModelColumn<unsigned int> m_indexes;
 	Gtk::TreeModelColumn<unsigned int> m_docId;
 	typedef enum { RESULT_ROOT = 0, RESULT_TITLE, RESULT_HOST, RESULT_OTHER } ResultType;
-	Gtk::TreeModelColumn<ResultType> m_type;
+	Gtk::TreeModelColumn<ResultType> m_resultType;
 	Gtk::TreeModelColumn<Glib::ustring> m_timestamp;
 	Gtk::TreeModelColumn<time_t> m_timestampTime;
 

Modified: trunk/UI/GTK2/src/ResultsTree.cpp
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.cpp	2007-03-22 10:56:57 UTC (rev 778)
+++ trunk/UI/GTK2/src/ResultsTree.cpp	2007-03-22 11:00:20 UTC (rev 779)
@@ -300,7 +300,7 @@
 			pTextRenderer->property_background_gdk().reset_value();
 		}
 
-		ResultsModelColumns::ResultType type = row[m_resultsColumns.m_type];
+		ResultsModelColumns::ResultType type = row[m_resultsColumns.m_resultType];
 		if ((type == ResultsModelColumns::RESULT_ROOT) ||
 			(type == ResultsModelColumns::RESULT_HOST))
 		{
@@ -376,7 +376,7 @@
 		m_refExtractStore->clear();
 
 		// Is this an actual result ?
-		ResultsModelColumns::ResultType type = row[m_resultsColumns.m_type];
+		ResultsModelColumns::ResultType type = row[m_resultsColumns.m_resultType];
 		if (type == ResultsModelColumns::RESULT_TITLE)
 		{
 #ifdef DEBUG
@@ -568,7 +568,7 @@
 				isIndexed = true;
 			}
 
-			if (appendResult(title, location, (int)currentScore, rankDiff, isIndexed,
+			if (appendResult(title, location, resultIter->getType(), (int)currentScore, rankDiff, isIndexed,
 				docId, resultIter->getTimestamp(), engineId, indexId, titleIter, &(*groupIter), true) == true)
 			{
 #ifdef DEBUG
@@ -662,7 +662,7 @@
 #ifdef DEBUG
 		cout << "ResultsTree::setGroupMode: looking at " << row[m_resultsColumns.m_text] << endl;
 #endif
-		ResultsModelColumns::ResultType type = row[m_resultsColumns.m_type];
+		ResultsModelColumns::ResultType type = row[m_resultsColumns.m_resultType];
 		// Skip new type rows
 		if (type == newType)
 		{
@@ -700,6 +700,7 @@
 						// Add result
 						success = appendResult(childRow[m_resultsColumns.m_text],
 							childRow[m_resultsColumns.m_url],
+							childRow[m_resultsColumns.m_type],
 							childRow[m_resultsColumns.m_score],
 							childRow[m_resultsColumns.m_rankDiff],
 							childRow[m_resultsColumns.m_indexed],
@@ -771,6 +772,7 @@
 								// Add result
 								appendResult(childRow[m_resultsColumns.m_text],
 									childRow[m_resultsColumns.m_url],
+									childRow[m_resultsColumns.m_type],
 									childRow[m_resultsColumns.m_score],
 									childRow[m_resultsColumns.m_rankDiff],
 									childRow[m_resultsColumns.m_indexed],
@@ -838,7 +840,7 @@
 		TreeModel::iterator iter = m_refStore->get_iter(*itemPath);
 		TreeModel::Row row = *iter;
 
-		if (row[m_resultsColumns.m_type] != ResultsModelColumns::RESULT_TITLE)
+		if (row[m_resultsColumns.m_resultType] != ResultsModelColumns::RESULT_TITLE)
 		{
 			continue;
 		}
@@ -847,7 +849,8 @@
 			(row[m_resultsColumns.m_indexed] == false))
 		{
 			resultsList.push_back(DocumentInfo(from_utf8(row[m_resultsColumns.m_text]),
-				from_utf8(row[m_resultsColumns.m_url]), "", ""));
+				from_utf8(row[m_resultsColumns.m_url]),
+				from_utf8(row[m_resultsColumns.m_type]), ""));
 		}
 	}
 #ifdef DEBUG
@@ -875,7 +878,7 @@
 		TreeModel::iterator iter = m_refStore->get_iter(*itemPath);
 		TreeModel::Row row = *iter;
 
-		if (row[m_resultsColumns.m_type] == ResultsModelColumns::RESULT_TITLE)
+		if (row[m_resultsColumns.m_resultType] == ResultsModelColumns::RESULT_TITLE)
 		{
 			bool isIndexed = row[m_resultsColumns.m_indexed];
 
@@ -901,6 +904,7 @@
 					}
 				}
 			}
+			current.setType(from_utf8(row[m_resultsColumns.m_type]));
 
 			resultsList.push_back(current);
 		}
@@ -930,7 +934,7 @@
 		TreeModel::iterator iter = m_refStore->get_iter(*itemPath);
 		TreeModel::Row row = *iter;
 
-		if (row[m_resultsColumns.m_type] != ResultsModelColumns::RESULT_TITLE)
+		if (row[m_resultsColumns.m_resultType] != ResultsModelColumns::RESULT_TITLE)
 		{
 			continue;
 		}
@@ -960,7 +964,7 @@
 		bool updateParent = false;
 
 		// This could be a group that's in the map and should be removed first
-		if (row[m_resultsColumns.m_type] != ResultsModelColumns::RESULT_TITLE)
+		if (row[m_resultsColumns.m_resultType] != ResultsModelColumns::RESULT_TITLE)
 		{
 			string groupName = from_utf8(row[m_resultsColumns.m_text]);
 			std::map<string, TreeModel::iterator>::iterator mapIter = m_resultsGroups.find(groupName);
@@ -1030,8 +1034,8 @@
 	{
 		TreeModel::Row row = *parentIter;
 
-		if ((row[m_resultsColumns.m_type] != ResultsModelColumns::RESULT_ROOT) &&
-			(row[m_resultsColumns.m_type] != ResultsModelColumns::RESULT_HOST))
+		if ((row[m_resultsColumns.m_resultType] != ResultsModelColumns::RESULT_ROOT) &&
+			(row[m_resultsColumns.m_resultType] != ResultsModelColumns::RESULT_HOST))
 		{
 			continue;
 		}
@@ -1042,7 +1046,7 @@
 		{
 			row = *iter;
 
-			if ((row[m_resultsColumns.m_type] == ResultsModelColumns::RESULT_TITLE) &&
+			if ((row[m_resultsColumns.m_resultType] == ResultsModelColumns::RESULT_TITLE) &&
 				(row[m_resultsColumns.m_engines] == engineId) &&
 				(row[m_resultsColumns.m_indexes] == indexId))
 			{
@@ -1155,9 +1159,10 @@
 // Adds a new row in the results tree.
 //
 bool ResultsTree::appendResult(const ustring &text, const ustring &url,
-	int score, int rankDiff, bool isIndexed, unsigned int docId,
-	const ustring &timestamp, unsigned int engineId, unsigned int indexId,
-	TreeModel::iterator &newRowIter, const TreeModel::Row *parentRow, bool noDuplicates)
+	const ustring &type, int score, int rankDiff, bool isIndexed,
+	unsigned int docId, const ustring &timestamp, unsigned int engineId,
+	unsigned int indexId, TreeModel::iterator &newRowIter,
+	const TreeModel::Row *parentRow, bool noDuplicates)
 {
 	if (parentRow == NULL)
 	{
@@ -1200,7 +1205,7 @@
 	bool wasViewed = viewHistory.hasItem(url);
 
 	TreeModel::Row childRow = *newRowIter;
-	updateRow(childRow, text, url, score, engineId, indexId,
+	updateRow(childRow, text, url, type, score, engineId, indexId,
 		docId, timestamp, ResultsModelColumns::RESULT_TITLE, isIndexed,
 		wasViewed, rankDiff);
 
@@ -1223,7 +1228,7 @@
 		groupIter = m_refStore->append();
 		TreeModel::Row groupRow = *groupIter;
 		updateRow(groupRow, to_utf8(groupName),
-			"", 0, 0, 0, 0, "", groupType,
+			"", "", 0, 0, 0, 0, "", groupType,
 			false, false, false);
 
 		// Update the map
@@ -1255,7 +1260,7 @@
 	int averageScore = 0;
 
 	// Check the iterator doesn't point to a result
-	if (groupRow[m_resultsColumns.m_type] == ResultsModelColumns::RESULT_TITLE)
+	if (groupRow[m_resultsColumns.m_resultType] == ResultsModelColumns::RESULT_TITLE)
 	{
 		return;
 	}
@@ -1290,20 +1295,22 @@
 // Updates a row.
 //
 void ResultsTree::updateRow(TreeModel::Row &row, const ustring &text,
-	const ustring &url, int score, unsigned int engineId, unsigned int indexId,
+	const ustring &url, const ustring &type, int score,
+	unsigned int engineId, unsigned int indexId,
 	unsigned int docId, const ustring &timestamp,
-	ResultsModelColumns::ResultType type, bool indexed, bool viewed, int rankDiff)
+	ResultsModelColumns::ResultType resultType, bool indexed, bool viewed, int rankDiff)
 {
 	try
 	{
 		row[m_resultsColumns.m_text] = text;
 		row[m_resultsColumns.m_url] = url;
+		row[m_resultsColumns.m_type] = type;
 		row[m_resultsColumns.m_score] = score;
 		row[m_resultsColumns.m_scoreText] = "";
 		row[m_resultsColumns.m_engines] = engineId;
 		row[m_resultsColumns.m_indexes] = indexId;
 		row[m_resultsColumns.m_docId] = docId;
-		row[m_resultsColumns.m_type] = type;
+		row[m_resultsColumns.m_resultType] = resultType;
 		row[m_resultsColumns.m_timestamp] = timestamp;
 		row[m_resultsColumns.m_timestampTime] = TimeConverter::fromTimestamp(timestamp);
 

Modified: trunk/UI/GTK2/src/ResultsTree.h
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.h	2007-03-22 10:56:57 UTC (rev 778)
+++ trunk/UI/GTK2/src/ResultsTree.h	2007-03-22 11:00:20 UTC (rev 779)
@@ -151,8 +151,9 @@
 
 		/// Adds a new row in the results tree.
 		bool appendResult(const Glib::ustring &text, const Glib::ustring &url,
-			int score, int rankDiff, bool isIndexed, unsigned int docId,
-			const Glib::ustring &timestamp, unsigned int engineId, unsigned int indexId,
+			const Glib::ustring &type, int score, int rankDiff,
+			bool isIndexed, unsigned int docId, const Glib::ustring &timestamp,
+			unsigned int engineId, unsigned int indexId,
 			Gtk::TreeModel::iterator &newRowIter, const Gtk::TreeModel::Row *parentRow = NULL,
 			bool noDuplicates = false);
 
@@ -161,7 +162,8 @@
 
 		/// Updates a row.
 		void updateRow(Gtk::TreeModel::Row &row, const Glib::ustring &text,
-			const Glib::ustring &url, int score, unsigned int engineId, unsigned int indexId,
+			const Glib::ustring &url, const Glib::ustring &type,
+			int score, unsigned int engineId, unsigned int indexId,
 			unsigned int docId, const Glib::ustring &timestamp,
 			ResultsModelColumns::ResultType type, bool indexed, bool viewed, int rankDiff);
 



From fabricecolin at mail.berlios.de  Thu Mar 22 12:02:19 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 22 Mar 2007 12:02:19 +0100
Subject: [Pinot-svn] r780 - in trunk: Search UI/GTK2/src Utils
Message-ID: <200703221102.l2MB2JDC015972@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-22 12:02:19 +0100 (Thu, 22 Mar 2007)
New Revision: 780

Modified:
   trunk/Search/XapianEngine.cpp
   trunk/UI/GTK2/src/PinotSettings.cpp
   trunk/Utils/MIMEScanner.cpp
Log:
Tweaked DEBUG output.


Modified: trunk/Search/XapianEngine.cpp
===================================================================
--- trunk/Search/XapianEngine.cpp	2007-03-22 11:00:20 UTC (rev 779)
+++ trunk/Search/XapianEngine.cpp	2007-03-22 11:02:19 UTC (rev 780)
@@ -556,12 +556,7 @@
 		while (fullQuery.empty() == false)
 		{
 #ifdef DEBUG
-			cout << "XapianEngine::runQuery: query terms are " << endl;
-			for (Xapian::TermIterator termIter = fullQuery.get_terms_begin();
-				termIter != fullQuery.get_terms_end(); ++termIter)
-			{
-				cout << " " << *termIter << endl;
-			}
+			cout << "XapianEngine::runQuery: " << fullQuery.get_description() << endl;
 #endif
 			// Query the database
 			if (queryDatabase(pIndex, fullQuery) == false)

Modified: trunk/UI/GTK2/src/PinotSettings.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.cpp	2007-03-22 11:00:20 UTC (rev 779)
+++ trunk/UI/GTK2/src/PinotSettings.cpp	2007-03-22 11:02:19 UTC (rev 780)
@@ -1085,9 +1085,6 @@
 					m_engineChannels.insert(pair<string, bool>(engineChannel, true));
 				}
 			}
-#ifdef DEBUG
-			else cout << "PinotSettings::loadSearchEngines: stat failed on " << location << endl;
-#endif
 		}
 
 		// Next entry

Modified: trunk/Utils/MIMEScanner.cpp
===================================================================
--- trunk/Utils/MIMEScanner.cpp	2007-03-22 11:00:20 UTC (rev 779)
+++ trunk/Utils/MIMEScanner.cpp	2007-03-22 11:02:19 UTC (rev 780)
@@ -309,17 +309,19 @@
 
 		if (pType != NULL)
 		{
-			return pType;
+			mimeType = pType;
 		}
-
-#ifdef DEBUG
-		cout << "MIMEScanner::scanFile: couldn't determine type of " << fileName << endl;
-#endif
-		if (xdg_mime_type_unknown != NULL)
+		else
 		{
-			mimeType = xdg_mime_type_unknown;
+			if (xdg_mime_type_unknown != NULL)
+			{
+				mimeType = xdg_mime_type_unknown;
+			}
 		}
 	}
+#ifdef DEBUG
+	cout << "MIMEScanner::scanFile: " << fileName << " " << mimeType << endl;
+#endif
 
 	return mimeType;
 }



From fabricecolin at mail.berlios.de  Thu Mar 22 13:46:08 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 22 Mar 2007 13:46:08 +0100
Subject: [Pinot-svn] r781 - in trunk/UI/GTK2: . src
Message-ID: <200703221246.l2MCk8AX001060@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-22 13:45:56 +0100 (Thu, 22 Mar 2007)
New Revision: 781

Modified:
   trunk/UI/GTK2/metase-gtk2.glade
   trunk/UI/GTK2/src/PinotSettings.cpp
   trunk/UI/GTK2/src/PinotSettings.h
   trunk/UI/GTK2/src/indexDialog.cc
   trunk/UI/GTK2/src/indexDialog.hh
   trunk/UI/GTK2/src/indexDialog_glade.cc
   trunk/UI/GTK2/src/indexDialog_glade.hh
   trunk/UI/GTK2/src/prefsDialog.cc
   trunk/UI/GTK2/src/prefsDialog.hh
   trunk/UI/GTK2/src/prefsDialog_glade.cc
   trunk/UI/GTK2/src/prefsDialog_glade.hh
Log:
Added Network tab to Preferences box for configuring the proxy.
Both indexDialog and prefsDialog use ComboBoxText.


Modified: trunk/UI/GTK2/metase-gtk2.glade
===================================================================
--- trunk/UI/GTK2/metase-gtk2.glade	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/metase-gtk2.glade	2007-03-22 12:45:56 UTC (rev 781)
@@ -1033,34 +1033,6 @@
 	      <property name="column_spacing">0</property>
 
 	      <child>
-		<widget class="GtkLabel" id="robotsLabel">
-		  <property name="visible">True</property>
-		  <property name="label" translatable="yes">HTTP crawling:</property>
-		  <property name="use_underline">False</property>
-		  <property name="use_markup">False</property>
-		  <property name="justify">GTK_JUSTIFY_LEFT</property>
-		  <property name="wrap">False</property>
-		  <property name="selectable">False</property>
-		  <property name="xalign">0</property>
-		  <property name="yalign">0.5</property>
-		  <property name="xpad">4</property>
-		  <property name="ypad">4</property>
-		  <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		  <property name="width_chars">-1</property>
-		  <property name="single_line_mode">False</property>
-		  <property name="angle">0</property>
-		</widget>
-		<packing>
-		  <property name="left_attach">0</property>
-		  <property name="right_attach">1</property>
-		  <property name="top_attach">0</property>
-		  <property name="bottom_attach">1</property>
-		  <property name="x_options">fill</property>
-		  <property name="y_options">fill</property>
-		</packing>
-	      </child>
-
-	      <child>
 		<widget class="GtkLabel" id="apiKeyLabel">
 		  <property agent="glademm" name="cxx_visibility">protected</property>
 		  <property name="visible">True</property>
@@ -1114,30 +1086,6 @@
 	      </child>
 
 	      <child>
-		<widget class="GtkCheckButton" id="ignoreRobotsCheckbutton">
-		  <property agent="glademm" name="cxx_visibility">protected</property>
-		  <property name="visible">True</property>
-		  <property name="can_focus">True</property>
-		  <property name="label" translatable="yes">Ignore robots.txt and Robots META tag</property>
-		  <property name="use_underline">True</property>
-		  <property name="relief">GTK_RELIEF_NORMAL</property>
-		  <property name="focus_on_click">True</property>
-		  <property name="active">False</property>
-		  <property name="inconsistent">False</property>
-		  <property name="draw_indicator">True</property>
-		</widget>
-		<packing>
-		  <property name="left_attach">1</property>
-		  <property name="right_attach">2</property>
-		  <property name="top_attach">0</property>
-		  <property name="bottom_attach">1</property>
-		  <property name="x_padding">4</property>
-		  <property name="y_padding">4</property>
-		  <property name="y_options">fill</property>
-		</packing>
-	      </child>
-
-	      <child>
 		<widget class="GtkLabel" id="newResultsLabel">
 		  <property name="visible">True</property>
 		  <property name="label" translatable="yes">New results:</property>
@@ -1235,6 +1183,59 @@
 		  <property name="y_options">fill</property>
 		</packing>
 	      </child>
+
+	      <child>
+		<widget class="GtkCheckButton" id="ignoreRobotsCheckbutton">
+		  <property agent="glademm" name="cxx_visibility">protected</property>
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="label" translatable="yes">Ignore robots.txt and Robots META tag</property>
+		  <property name="use_underline">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+		  <property name="active">False</property>
+		  <property name="inconsistent">False</property>
+		  <property name="draw_indicator">True</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">1</property>
+		  <property name="right_attach">2</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		  <property name="x_padding">4</property>
+		  <property name="y_padding">4</property>
+		  <property name="y_options">fill</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkLabel" id="robotsLabel">
+		  <property agent="glademm" name="cxx_visibility">protected</property>
+		  <property name="visible">True</property>
+		  <property name="label" translatable="yes">HTTP crawling:</property>
+		  <property name="use_underline">False</property>
+		  <property name="use_markup">False</property>
+		  <property name="justify">GTK_JUSTIFY_LEFT</property>
+		  <property name="wrap">False</property>
+		  <property name="selectable">False</property>
+		  <property name="xalign">0</property>
+		  <property name="yalign">0.5</property>
+		  <property name="xpad">4</property>
+		  <property name="ypad">4</property>
+		  <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		  <property name="width_chars">-1</property>
+		  <property name="single_line_mode">False</property>
+		  <property name="angle">0</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		  <property name="x_options">fill</property>
+		  <property name="y_options"></property>
+		</packing>
+	      </child>
 	    </widget>
 	    <packing>
 	      <property name="tab_expand">False</property>
@@ -1266,6 +1267,268 @@
 	  </child>
 
 	  <child>
+	    <widget class="GtkTable" id="netTable">
+	      <property name="visible">True</property>
+	      <property name="n_rows">3</property>
+	      <property name="n_columns">1</property>
+	      <property name="homogeneous">False</property>
+	      <property name="row_spacing">0</property>
+	      <property name="column_spacing">0</property>
+
+	      <child>
+		<widget class="GtkRadioButton" id="directConnectionRadiobutton">
+		  <property agent="glademm" name="cxx_visibility">protected</property>
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="label" translatable="yes">Direct connection to the Internet</property>
+		  <property name="use_underline">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+		  <property name="active">True</property>
+		  <property name="inconsistent">False</property>
+		  <property name="draw_indicator">True</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">0</property>
+		  <property name="bottom_attach">1</property>
+		  <property name="x_padding">4</property>
+		  <property name="y_padding">4</property>
+		  <property name="y_options">fill</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkRadioButton" id="proxyRadiobutton">
+		  <property agent="glademm" name="cxx_visibility">protected</property>
+		  <property name="visible">True</property>
+		  <property name="can_focus">True</property>
+		  <property name="label" translatable="yes">Manual proxy configuration:</property>
+		  <property name="use_underline">True</property>
+		  <property name="relief">GTK_RELIEF_NORMAL</property>
+		  <property name="focus_on_click">True</property>
+		  <property name="active">False</property>
+		  <property name="inconsistent">False</property>
+		  <property name="draw_indicator">True</property>
+		  <property name="group">directConnectionRadiobutton</property>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">1</property>
+		  <property name="bottom_attach">2</property>
+		  <property name="x_padding">4</property>
+		  <property name="y_padding">4</property>
+		  <property name="y_options">fill</property>
+		</packing>
+	      </child>
+
+	      <child>
+		<widget class="GtkTable" id="socksTable">
+		  <property name="visible">True</property>
+		  <property name="n_rows">2</property>
+		  <property name="n_columns">4</property>
+		  <property name="homogeneous">False</property>
+		  <property name="row_spacing">0</property>
+		  <property name="column_spacing">0</property>
+
+		  <child>
+		    <widget class="GtkLabel" id="proxyAddressLabel">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Address:</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">False</property>
+		      <property name="xalign">0</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="left_attach">0</property>
+		      <property name="right_attach">1</property>
+		      <property name="top_attach">0</property>
+		      <property name="bottom_attach">1</property>
+		      <property name="x_padding">4</property>
+		      <property name="y_padding">4</property>
+		      <property name="x_options">fill</property>
+		      <property name="y_options">fill</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkEntry" id="proxyAddressEntry">
+		      <property agent="glademm" name="cxx_visibility">protected</property>
+		      <property name="visible">True</property>
+		      <property name="can_focus">True</property>
+		      <property name="editable">True</property>
+		      <property name="visibility">True</property>
+		      <property name="max_length">0</property>
+		      <property name="text" translatable="yes"></property>
+		      <property name="has_frame">True</property>
+		      <property name="invisible_char">*</property>
+		      <property name="activates_default">False</property>
+		    </widget>
+		    <packing>
+		      <property name="left_attach">1</property>
+		      <property name="right_attach">2</property>
+		      <property name="top_attach">0</property>
+		      <property name="bottom_attach">1</property>
+		      <property name="x_padding">4</property>
+		      <property name="y_padding">4</property>
+		      <property name="y_options">fill</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkLabel" id="proxyPortLabel">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Port:</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">False</property>
+		      <property name="xalign">0</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="left_attach">2</property>
+		      <property name="right_attach">3</property>
+		      <property name="top_attach">0</property>
+		      <property name="bottom_attach">1</property>
+		      <property name="x_padding">4</property>
+		      <property name="y_padding">4</property>
+		      <property name="x_options">fill</property>
+		      <property name="y_options">fill</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkSpinButton" id="proxyPortSpinbutton">
+		      <property agent="glademm" name="cxx_visibility">protected</property>
+		      <property name="visible">True</property>
+		      <property name="can_focus">True</property>
+		      <property name="climb_rate">1</property>
+		      <property name="digits">0</property>
+		      <property name="numeric">False</property>
+		      <property name="update_policy">GTK_UPDATE_ALWAYS</property>
+		      <property name="snap_to_ticks">False</property>
+		      <property name="wrap">False</property>
+		      <property name="adjustment">80 1 65535 1 10 10</property>
+		    </widget>
+		    <packing>
+		      <property name="left_attach">3</property>
+		      <property name="right_attach">4</property>
+		      <property name="top_attach">0</property>
+		      <property name="bottom_attach">1</property>
+		      <property name="x_padding">4</property>
+		      <property name="y_padding">4</property>
+		      <property name="y_options"></property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkLabel" id="proxyTypeLabel">
+		      <property name="visible">True</property>
+		      <property name="label" translatable="yes">Type:</property>
+		      <property name="use_underline">False</property>
+		      <property name="use_markup">False</property>
+		      <property name="justify">GTK_JUSTIFY_LEFT</property>
+		      <property name="wrap">False</property>
+		      <property name="selectable">False</property>
+		      <property name="xalign">0</property>
+		      <property name="yalign">0.5</property>
+		      <property name="xpad">0</property>
+		      <property name="ypad">0</property>
+		      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+		      <property name="width_chars">-1</property>
+		      <property name="single_line_mode">False</property>
+		      <property name="angle">0</property>
+		    </widget>
+		    <packing>
+		      <property name="left_attach">0</property>
+		      <property name="right_attach">1</property>
+		      <property name="top_attach">1</property>
+		      <property name="bottom_attach">2</property>
+		      <property name="x_padding">4</property>
+		      <property name="y_padding">4</property>
+		      <property name="x_options">fill</property>
+		      <property name="y_options">fill</property>
+		    </packing>
+		  </child>
+
+		  <child>
+		    <widget class="GtkComboBox" id="proxyTypeCombobox">
+		      <property agent="glademm" name="cxx_visibility">protected</property>
+		      <property name="visible">True</property>
+		      <property name="items" translatable="yes"></property>
+		      <property name="add_tearoffs">False</property>
+		      <property name="focus_on_click">True</property>
+		    </widget>
+		    <packing>
+		      <property name="left_attach">1</property>
+		      <property name="right_attach">2</property>
+		      <property name="top_attach">1</property>
+		      <property name="bottom_attach">2</property>
+		      <property name="x_padding">4</property>
+		      <property name="y_padding">4</property>
+		      <property name="y_options"></property>
+		    </packing>
+		  </child>
+		</widget>
+		<packing>
+		  <property name="left_attach">0</property>
+		  <property name="right_attach">1</property>
+		  <property name="top_attach">2</property>
+		  <property name="bottom_attach">3</property>
+		  <property name="x_options">fill</property>
+		</packing>
+	      </child>
+	    </widget>
+	    <packing>
+	      <property name="tab_expand">False</property>
+	      <property name="tab_fill">True</property>
+	    </packing>
+	  </child>
+
+	  <child>
+	    <widget class="GtkLabel" id="netLabel">
+	      <property name="visible">True</property>
+	      <property name="label" translatable="yes">Network</property>
+	      <property name="use_underline">False</property>
+	      <property name="use_markup">False</property>
+	      <property name="justify">GTK_JUSTIFY_LEFT</property>
+	      <property name="wrap">False</property>
+	      <property name="selectable">False</property>
+	      <property name="xalign">0.5</property>
+	      <property name="yalign">0.5</property>
+	      <property name="xpad">0</property>
+	      <property name="ypad">0</property>
+	      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
+	      <property name="width_chars">-1</property>
+	      <property name="single_line_mode">False</property>
+	      <property name="angle">0</property>
+	    </widget>
+	    <packing>
+	      <property name="type">tab</property>
+	    </packing>
+	  </child>
+
+	  <child>
 	    <widget class="GtkVBox" id="labelsVbox">
 	      <property name="visible">True</property>
 	      <property name="homogeneous">False</property>
@@ -3303,7 +3566,7 @@
 	      <property name="update_policy">GTK_UPDATE_ALWAYS</property>
 	      <property name="snap_to_ticks">False</property>
 	      <property name="wrap">False</property>
-	      <property name="adjustment">1024 0 65535 1 10 10</property>
+	      <property name="adjustment">1024 1 65535 1 10 10</property>
 	    </widget>
 	    <packing>
 	      <property name="left_attach">1</property>
@@ -3339,7 +3602,7 @@
 	  <child>
 	    <widget class="GtkLabel" id="hostLabel">
 	      <property name="visible">True</property>
-	      <property name="label" translatable="yes">Host name:</property>
+	      <property name="label" translatable="yes">Address:</property>
 	      <property name="use_underline">False</property>
 	      <property name="use_markup">False</property>
 	      <property name="justify">GTK_JUSTIFY_LEFT</property>

Modified: trunk/UI/GTK2/src/PinotSettings.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.cpp	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/PinotSettings.cpp	2007-03-22 12:45:56 UTC (rev 781)
@@ -101,6 +101,9 @@
 	m_newResultsColourRed(65535),
 	m_newResultsColourGreen(0),
 	m_newResultsColourBlue(0),
+	m_proxyPort(8080),
+	m_proxyType(0),
+	m_proxyEnabled(false),
 	m_firstRun(false)
 {
 	// Find out if there is a .pinot directory
@@ -397,6 +400,10 @@
 				{
 					loadColour(pElem);
 				}
+				else if (nodeName == "proxy")
+				{
+					loadProxy(pElem);
+				}
 				else if (nodeName == "mailaccount")
 				{
 					loadMailAccounts(pElem);
@@ -839,6 +846,59 @@
 	return true;
 }
 
+bool PinotSettings::loadProxy(const Element *pElem)
+{
+	if (pElem == NULL)
+	{
+		return false;
+	}
+
+	Node::NodeList childNodes = pElem->get_children();
+	if (childNodes.empty() == true)
+	{
+		return false;
+	}
+
+	for (Node::NodeList::iterator iter = childNodes.begin(); iter != childNodes.end(); ++iter)
+	{
+		Node *pNode = (*iter);
+		Element *pElem = dynamic_cast<Element*>(pNode);
+		if (pElem == NULL)
+		{
+			continue;
+		}
+
+		string nodeName = pElem->get_name();
+		string nodeContent = getElementContent(pElem);
+
+		if (nodeName == "address")
+		{
+			m_proxyAddress = nodeContent;
+		}
+		else if (nodeName == "port")
+		{
+			m_proxyPort = (unsigned int)atoi(nodeContent.c_str());
+		}
+		else if (nodeName == "type")
+		{
+			m_proxyType = (unsigned int)atoi(nodeContent.c_str());
+		}
+		else if (nodeName == "enable")
+		{
+			if (nodeContent == "YES")
+			{
+				m_proxyEnabled = true;
+			}
+			else
+			{
+				m_proxyEnabled = false;
+			}
+		}	
+	}
+
+	return true;
+}
+
 bool PinotSettings::loadMailAccounts(const Element *pElem)
 {
 	if (pElem == NULL)
@@ -1209,6 +1269,8 @@
 	}
 	// Ignore robots directives
 	addChildElement(pRootElem, "robots", (m_ignoreRobotsDirectives ? "IGNORE" : "OBEY"));
+	// Enable terms suggestion
+	addChildElement(pRootElem, "suggestterms", (m_suggestQueryTerms ? "YES" : "NO"));
 	// New results colour
 	pElem = pRootElem->add_child("newresults");
 	if (pElem == NULL)
@@ -1221,8 +1283,18 @@
 	addChildElement(pElem, "green", numStr);
 	sprintf(numStr, "%u", m_newResultsColourBlue);
 	addChildElement(pElem, "blue", numStr);
-	// Enable terms suggestion
-	addChildElement(pRootElem, "suggestterms", (m_suggestQueryTerms ? "YES" : "NO"));
+	// Proxy
+	pElem = pRootElem->add_child("proxy");
+	if (pElem == NULL)
+	{
+		return false;
+	}
+	addChildElement(pElem, "address", m_proxyAddress);
+	sprintf(numStr, "%u", m_proxyPort);
+	addChildElement(pElem, "port", numStr);
+	sprintf(numStr, "%u", m_proxyType);
+	addChildElement(pElem, "type", numStr);
+	addChildElement(pElem, "enable", (m_proxyEnabled ? "YES" : "NO"));
 	// Mail accounts
 	for (set<TimestampedItem>::iterator mailIter = m_mailAccounts.begin(); mailIter != m_mailAccounts.end(); ++mailIter)
 	{

Modified: trunk/UI/GTK2/src/PinotSettings.h
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.h	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/PinotSettings.h	2007-03-22 12:45:56 UTC (rev 781)
@@ -203,6 +203,10 @@
 		unsigned short m_newResultsColourRed;
 		unsigned short m_newResultsColourGreen;
 		unsigned short m_newResultsColourBlue;
+		Glib::ustring m_proxyAddress;
+		unsigned int m_proxyPort;
+		unsigned int m_proxyType;
+		bool m_proxyEnabled;
 		std::set<TimestampedItem> m_mailAccounts;
 		std::set<IndexableLocation> m_indexableLocations;
 		std::set<Glib::ustring> m_filePatternsBlackList;
@@ -229,6 +233,7 @@
 		bool loadQueries(const xmlpp::Element *pElem);
 		bool loadLabels(const xmlpp::Element *pElem);
 		bool loadColour(const xmlpp::Element *pElem);
+		bool loadProxy(const xmlpp::Element *pElem);
 		bool loadMailAccounts(const xmlpp::Element *pElem);
 		bool loadIndexableLocations(const xmlpp::Element *pElem);
 		bool loadFilePatterns(const xmlpp::Element *pElem);

Modified: trunk/UI/GTK2/src/indexDialog.cc
===================================================================
--- trunk/UI/GTK2/src/indexDialog.cc	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/indexDialog.cc	2007-03-22 12:45:56 UTC (rev 781)
@@ -34,11 +34,7 @@
 	m_editIndex(false),
 	m_badName(true)
 {
-	// Associate the columns model to the type combo
-	m_refTypeTree = ListStore::create(m_typeColumns);
-	typeCombobox->set_model(m_refTypeTree);
-	typeCombobox->pack_start(m_typeColumns.m_name);
-	// Populate
+	// Populate the type combo
 	populate_typeCombobox();
 
 	// By default, type is set to local
@@ -58,11 +54,7 @@
 {
 	unsigned int port = 1024;
 
-	// Associate the columns model to the type combo
-	m_refTypeTree = ListStore::create(m_typeColumns);
-	typeCombobox->set_model(m_refTypeTree);
-	typeCombobox->pack_start(m_typeColumns.m_name);
-	// Populate
+	// Populate the type combo
 	populate_typeCombobox();
 
 	// Name
@@ -129,16 +121,10 @@
 {
 	ustring servedBy(_("Served by"));
 
-	TreeModel::iterator iter = m_refTypeTree->append();
-	TreeModel::Row row = *iter;
-	row[m_typeColumns.m_name] = _("Local");
-	iter = m_refTypeTree->append();
-	row = *iter;
-	row[m_typeColumns.m_name] = servedBy + " xapian-tcpsrv";
+	typeCombobox->append_text(_("Local"));
+	typeCombobox->append_text(servedBy + " xapian-tcpsrv");
 #ifdef _SSH_TUNNEL
-	iter = m_refTypeTree->append();
-	row = *iter;
-	row[m_typeColumns.m_name] = servedBy + " xapian-progsrv+ssh";
+	typeCombobox->append_text(servedBy + " xapian-progsrv+ssh");
 #endif
 }
 

Modified: trunk/UI/GTK2/src/indexDialog.hh
===================================================================
--- trunk/UI/GTK2/src/indexDialog.hh	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/indexDialog.hh	2007-03-22 12:45:56 UTC (rev 781)
@@ -20,7 +20,6 @@
 #define _INDEXDIALOG_HH
 
 #include <glibmm/ustring.h>
-#include <gtkmm/liststore.h>
 
 #include "ModelColumns.h"
 #include "indexDialog_glade.hh"
@@ -41,8 +40,6 @@
 protected:
 	Glib::ustring m_name;
 	Glib::ustring m_location;
-	ComboModelColumns m_typeColumns;
-	Glib::RefPtr<Gtk::ListStore> m_refTypeTree;
 	bool m_editIndex;
 	bool m_badName;
 

Modified: trunk/UI/GTK2/src/indexDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/indexDialog_glade.cc	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/indexDialog_glade.cc	2007-03-22 12:45:56 UTC (rev 781)
@@ -1,9 +1,9 @@
-// generated 2006/12/29 9:49:18 SGT by fabrice at thorgrim.dyndns.org.(none)
+// generated 2007/3/22 1:27:17 SGT by fabrice at amra.dyndns.org.(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
 // glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
-// for gtk 2.10.4 and gtkmm 2.10.5
+// for gtk 2.10.8 and gtkmm 2.10.7
 //
 // Please modify the corresponding derived classes in ./src/indexDialog.cc
 
@@ -72,11 +72,11 @@
    Gtk::Label *portLabel = Gtk::manage(new class Gtk::Label(_("Port:")));
    nameEntry = Gtk::manage(new class Gtk::Entry());
    
-   Gtk::Adjustment *portSpinbutton_adj = Gtk::manage(new class Gtk::Adjustment(1024, 0, 65535, 1, 10, 10));
+   Gtk::Adjustment *portSpinbutton_adj = Gtk::manage(new class Gtk::Adjustment(1024, 1, 65535, 1, 10, 10));
    portSpinbutton = Gtk::manage(new class Gtk::SpinButton(*portSpinbutton_adj, 1, 0));
-   typeCombobox = Gtk::manage(new class Gtk::ComboBox());
+   typeCombobox = Gtk::manage(new class Gtk::ComboBoxText());
    
-   Gtk::Label *hostLabel = Gtk::manage(new class Gtk::Label(_("Host name:")));
+   Gtk::Label *hostLabel = Gtk::manage(new class Gtk::Label(_("Address:")));
    hostEntry = Gtk::manage(new class Gtk::Entry());
    
    Gtk::Table *indexTable = Gtk::manage(new class Gtk::Table(2, 2, false));
@@ -93,6 +93,10 @@
    nameLabel->set_line_wrap(false);
    nameLabel->set_use_markup(false);
    nameLabel->set_selectable(false);
+   nameLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   nameLabel->set_width_chars(-1);
+   nameLabel->set_angle(0);
+   nameLabel->set_single_line_mode(false);
    locationEntry->set_flags(Gtk::CAN_FOCUS);
    locationEntry->set_visibility(true);
    locationEntry->set_editable(true);
@@ -110,18 +114,30 @@
    typeLabel->set_line_wrap(false);
    typeLabel->set_use_markup(false);
    typeLabel->set_selectable(false);
+   typeLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   typeLabel->set_width_chars(-1);
+   typeLabel->set_angle(0);
+   typeLabel->set_single_line_mode(false);
    locationLabel->set_alignment(0,0.5);
    locationLabel->set_padding(4,4);
    locationLabel->set_justify(Gtk::JUSTIFY_LEFT);
    locationLabel->set_line_wrap(false);
    locationLabel->set_use_markup(false);
    locationLabel->set_selectable(false);
+   locationLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   locationLabel->set_width_chars(-1);
+   locationLabel->set_angle(0);
+   locationLabel->set_single_line_mode(false);
    portLabel->set_alignment(0,0.5);
    portLabel->set_padding(4,4);
    portLabel->set_justify(Gtk::JUSTIFY_LEFT);
    portLabel->set_line_wrap(false);
    portLabel->set_use_markup(false);
    portLabel->set_selectable(false);
+   portLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   portLabel->set_width_chars(-1);
+   portLabel->set_angle(0);
+   portLabel->set_single_line_mode(false);
    nameEntry->set_flags(Gtk::CAN_FOCUS);
    nameEntry->set_visibility(true);
    nameEntry->set_editable(true);
@@ -139,6 +155,10 @@
    hostLabel->set_line_wrap(false);
    hostLabel->set_use_markup(false);
    hostLabel->set_selectable(false);
+   hostLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   hostLabel->set_width_chars(-1);
+   hostLabel->set_angle(0);
+   hostLabel->set_single_line_mode(false);
    hostEntry->set_flags(Gtk::CAN_FOCUS);
    hostEntry->set_visibility(true);
    hostEntry->set_editable(true);

Modified: trunk/UI/GTK2/src/indexDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/indexDialog_glade.hh	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/indexDialog_glade.hh	2007-03-22 12:45:56 UTC (rev 781)
@@ -35,7 +35,7 @@
 #include <gtkmm/button.h>
 #include <gtkmm/entry.h>
 #include <gtkmm/spinbutton.h>
-#include <gtkmm/combobox.h>
+#include <gtkmm/comboboxtext.h>
 
 class indexDialog_glade : public Gtk::Dialog
 {  
@@ -48,7 +48,7 @@
         class Gtk::Button * locationButton;
         class Gtk::Entry * nameEntry;
         class Gtk::SpinButton * portSpinbutton;
-        class Gtk::ComboBox * typeCombobox;
+        class Gtk::ComboBoxText * typeCombobox;
         class Gtk::Entry * hostEntry;
         
         indexDialog_glade();

Modified: trunk/UI/GTK2/src/prefsDialog.cc
===================================================================
--- trunk/UI/GTK2/src/prefsDialog.cc	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/prefsDialog.cc	2007-03-22 12:45:56 UTC (rev 781)
@@ -24,7 +24,6 @@
 #include <gtkmm/menu.h>
 #include <gtkmm/messagedialog.h>
 
-#include "MIMEScanner.h"
 #include "SearchEngineFactory.h"
 #include "QueryHistory.h"
 #include "config.h"
@@ -61,6 +60,17 @@
 	// Enable terms suggestion
 	enableCompletionCheckbutton->set_active(m_settings.m_suggestQueryTerms);
 
+	populate_proxyTypeCombobox();
+	proxyRadiobutton->set_active(m_settings.m_proxyEnabled);
+	proxyAddressEntry->set_text(m_settings.m_proxyAddress);
+	proxyPortSpinbutton->set_value((double)m_settings.m_proxyPort);
+	// FIXME: sync with settings
+	if (m_settings.m_proxyType > 2)
+	{
+		m_settings.m_proxyType = 0;
+	}
+	proxyTypeCombobox->set_active(m_settings.m_proxyType);
+
 	// Associate the columns model to the labels tree
 	m_refLabelsTree = ListStore::create(m_labelsColumns);
 	labelsTreeview->set_model(m_refLabelsTree);
@@ -129,6 +139,13 @@
 	return m_startDaemon;
 }
 
+void prefsDialog::populate_proxyTypeCombobox()
+{
+	proxyTypeCombobox->append_text("HTTP");
+	proxyTypeCombobox->append_text("SOCKS v4");
+	proxyTypeCombobox->append_text("SOCKS v5");
+}
+
 void prefsDialog::populate_labelsTreeview()
 {
 	TreeModel::iterator iter;
@@ -401,6 +418,11 @@
 	m_settings.m_suggestQueryTerms = enableCompletionCheckbutton->get_active();
 	m_settings.m_googleAPIKey = apiKeyEntry->get_text();
 
+	m_settings.m_proxyEnabled = proxyRadiobutton->get_active();
+	m_settings.m_proxyAddress = proxyAddressEntry->get_text();
+	m_settings.m_proxyPort = (unsigned int)proxyPortSpinbutton->get_value();
+	m_settings.m_proxyType = proxyTypeCombobox->get_active_row_number();
+
 	// Validate the current lists
 	save_labelsTreeview();
 	bool startForDirectories = save_directoriesTreeview();
@@ -521,11 +543,8 @@
 
 	if (select_file_name(*this, _("Mbox File Location"), fileName, true) == true)
 	{
-		string mimeType = MIMEScanner::scanFile(fileName);
-
 #ifdef DEBUG
-		cout << "prefsDialog::on_addAccountButton_clicked: " << fileName
-			<< " has format " << mimeType << endl;
+		cout << "prefsDialog::on_addAccountButton_clicked: " << fileName << endl;
 #endif
 		// FIXME: unlike libmagic, shared-mime-info fails to identify most mbox files
 		// as being of type text/x-mail

Modified: trunk/UI/GTK2/src/prefsDialog.hh
===================================================================
--- trunk/UI/GTK2/src/prefsDialog.hh	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/prefsDialog.hh	2007-03-22 12:45:56 UTC (rev 781)
@@ -53,6 +53,7 @@
 	virtual void on_addPatternButton_clicked();
 	virtual void on_removePatternButton_clicked();
 
+	void populate_proxyTypeCombobox();
 	void populate_labelsTreeview();
 	void save_labelsTreeview();
 	void populate_directoriesTreeview();

Modified: trunk/UI/GTK2/src/prefsDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/prefsDialog_glade.cc	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/prefsDialog_glade.cc	2007-03-22 12:45:56 UTC (rev 781)
@@ -1,9 +1,9 @@
-// generated 2006/11/1 20:52:15 SGT by fabrice at amra.dyndns.org.(none)
+// generated 2007/3/22 1:27:17 SGT by fabrice at amra.dyndns.org.(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
 // glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
-// for gtk 2.10.4 and gtkmm 2.10.2
+// for gtk 2.10.8 and gtkmm 2.10.7
 //
 // Please modify the corresponding derived classes in ./src/prefsDialog.cc
 
@@ -40,6 +40,8 @@
 #include <gtkmm/buttonbox.h>
 #include <gtkmm/label.h>
 #include <gtkmm/table.h>
+#include <gtkmm/radiobutton.h>
+#include <gtkmm/adjustment.h>
 #include <gtkmm/scrolledwindow.h>
 #include <gtkmm/image.h>
 #include <gtkmm/box.h>
@@ -61,19 +63,35 @@
    gmm_data = new GlademmData(get_accel_group());
    prefsCancelbutton = Gtk::manage(new class Gtk::Button(Gtk::StockID("gtk-cancel")));
    prefsOkbutton = Gtk::manage(new class Gtk::Button(Gtk::StockID("gtk-ok")));
-   
-   Gtk::Label *robotsLabel = Gtk::manage(new class Gtk::Label(_("HTTP crawling:")));
    apiKeyLabel = Gtk::manage(new class Gtk::Label(_("Google API key:")));
    apiKeyEntry = Gtk::manage(new class Gtk::Entry());
-   ignoreRobotsCheckbutton = Gtk::manage(new class Gtk::CheckButton(_("Ignore robots.txt and Robots META tag")));
    
    Gtk::Label *newResultsLabel = Gtk::manage(new class Gtk::Label(_("New results:")));
    Gtk::Label *queriesLabel = Gtk::manage(new class Gtk::Label(_("Queries:")));
    enableCompletionCheckbutton = Gtk::manage(new class Gtk::CheckButton(_("Enable search terms suggestion")));
    newResultsColorbutton = Gtk::manage(new class Gtk::ColorButton());
+   ignoreRobotsCheckbutton = Gtk::manage(new class Gtk::CheckButton(_("Ignore robots.txt and Robots META tag")));
+   robotsLabel = Gtk::manage(new class Gtk::Label(_("HTTP crawling:")));
    
    Gtk::Table *generalTable = Gtk::manage(new class Gtk::Table(2, 2, false));
    Gtk::Label *generalLabel = Gtk::manage(new class Gtk::Label(_("General")));
+   Gtk::RadioButton::Group _RadioBGroup_directConnectionRadiobutton;
+   directConnectionRadiobutton = Gtk::manage(new class Gtk::RadioButton(_RadioBGroup_directConnectionRadiobutton, _("Direct connection to the Internet")));
+   proxyRadiobutton = Gtk::manage(new class Gtk::RadioButton(_RadioBGroup_directConnectionRadiobutton, _("Manual proxy configuration:")));
+   
+   Gtk::Label *proxyAddressLabel = Gtk::manage(new class Gtk::Label(_("Address:")));
+   proxyAddressEntry = Gtk::manage(new class Gtk::Entry());
+   
+   Gtk::Label *proxyPortLabel = Gtk::manage(new class Gtk::Label(_("Port:")));
+   Gtk::Adjustment *proxyPortSpinbutton_adj = Gtk::manage(new class Gtk::Adjustment(80, 1, 65535, 1, 10, 10));
+   proxyPortSpinbutton = Gtk::manage(new class Gtk::SpinButton(*proxyPortSpinbutton_adj, 1, 0));
+   
+   Gtk::Label *proxyTypeLabel = Gtk::manage(new class Gtk::Label(_("Type:")));
+   proxyTypeCombobox = Gtk::manage(new class Gtk::ComboBoxText());
+   
+   Gtk::Table *socksTable = Gtk::manage(new class Gtk::Table(2, 2, false));
+   Gtk::Table *netTable = Gtk::manage(new class Gtk::Table(2, 2, false));
+   Gtk::Label *netLabel = Gtk::manage(new class Gtk::Label(_("Network")));
    Gtk::Label *indexLabelsLabel = Gtk::manage(new class Gtk::Label(_("Labels are used to classify indexed documents:")));
    labelsTreeview = Gtk::manage(new class Gtk::TreeView());
    
@@ -143,67 +161,163 @@
    prefsOkbutton->set_flags(Gtk::CAN_DEFAULT);
    prefsOkbutton->set_relief(Gtk::RELIEF_NORMAL);
    prefsDialog->get_action_area()->property_layout_style().set_value(Gtk::BUTTONBOX_END);
-   robotsLabel->set_alignment(0,0.5);
-   robotsLabel->set_padding(4,4);
-   robotsLabel->set_justify(Gtk::JUSTIFY_LEFT);
-   robotsLabel->set_line_wrap(false);
-   robotsLabel->set_use_markup(false);
-   robotsLabel->set_selectable(false);
    apiKeyLabel->set_alignment(0,0.5);
    apiKeyLabel->set_padding(4,4);
    apiKeyLabel->set_justify(Gtk::JUSTIFY_LEFT);
    apiKeyLabel->set_line_wrap(false);
    apiKeyLabel->set_use_markup(false);
    apiKeyLabel->set_selectable(false);
+   apiKeyLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   apiKeyLabel->set_width_chars(-1);
+   apiKeyLabel->set_angle(0);
+   apiKeyLabel->set_single_line_mode(false);
    apiKeyEntry->set_flags(Gtk::CAN_FOCUS);
    apiKeyEntry->set_visibility(true);
    apiKeyEntry->set_editable(true);
    apiKeyEntry->set_max_length(0);
    apiKeyEntry->set_has_frame(true);
    apiKeyEntry->set_activates_default(false);
-   ignoreRobotsCheckbutton->set_flags(Gtk::CAN_FOCUS);
-   ignoreRobotsCheckbutton->set_relief(Gtk::RELIEF_NORMAL);
-   ignoreRobotsCheckbutton->set_mode(true);
-   ignoreRobotsCheckbutton->set_active(false);
    newResultsLabel->set_alignment(0,0.5);
    newResultsLabel->set_padding(4,4);
    newResultsLabel->set_justify(Gtk::JUSTIFY_LEFT);
    newResultsLabel->set_line_wrap(false);
    newResultsLabel->set_use_markup(false);
    newResultsLabel->set_selectable(false);
+   newResultsLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   newResultsLabel->set_width_chars(-1);
+   newResultsLabel->set_angle(0);
+   newResultsLabel->set_single_line_mode(false);
    queriesLabel->set_alignment(0,0.5);
    queriesLabel->set_padding(4,4);
    queriesLabel->set_justify(Gtk::JUSTIFY_LEFT);
    queriesLabel->set_line_wrap(false);
    queriesLabel->set_use_markup(false);
    queriesLabel->set_selectable(false);
+   queriesLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   queriesLabel->set_width_chars(-1);
+   queriesLabel->set_angle(0);
+   queriesLabel->set_single_line_mode(false);
    enableCompletionCheckbutton->set_flags(Gtk::CAN_FOCUS);
    enableCompletionCheckbutton->set_relief(Gtk::RELIEF_NORMAL);
    enableCompletionCheckbutton->set_mode(true);
    enableCompletionCheckbutton->set_active(false);
    newResultsColorbutton->set_flags(Gtk::CAN_FOCUS);
+   ignoreRobotsCheckbutton->set_flags(Gtk::CAN_FOCUS);
+   ignoreRobotsCheckbutton->set_relief(Gtk::RELIEF_NORMAL);
+   ignoreRobotsCheckbutton->set_mode(true);
+   ignoreRobotsCheckbutton->set_active(false);
+   robotsLabel->set_alignment(0,0.5);
+   robotsLabel->set_padding(4,4);
+   robotsLabel->set_justify(Gtk::JUSTIFY_LEFT);
+   robotsLabel->set_line_wrap(false);
+   robotsLabel->set_use_markup(false);
+   robotsLabel->set_selectable(false);
+   robotsLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   robotsLabel->set_width_chars(-1);
+   robotsLabel->set_angle(0);
+   robotsLabel->set_single_line_mode(false);
    generalTable->set_row_spacings(0);
    generalTable->set_col_spacings(0);
-   generalTable->attach(*robotsLabel, 0, 1, 0, 1, Gtk::FILL, Gtk::FILL, 0, 0);
    generalTable->attach(*apiKeyLabel, 0, 1, 3, 4, Gtk::FILL, Gtk::FILL, 0, 0);
    generalTable->attach(*apiKeyEntry, 1, 2, 3, 4, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
-   generalTable->attach(*ignoreRobotsCheckbutton, 1, 2, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
    generalTable->attach(*newResultsLabel, 0, 1, 1, 2, Gtk::FILL, Gtk::FILL, 0, 0);
    generalTable->attach(*queriesLabel, 0, 1, 2, 3, Gtk::FILL, Gtk::FILL, 0, 0);
    generalTable->attach(*enableCompletionCheckbutton, 1, 2, 2, 3, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
    generalTable->attach(*newResultsColorbutton, 1, 2, 1, 2, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   generalTable->attach(*ignoreRobotsCheckbutton, 1, 2, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   generalTable->attach(*robotsLabel, 0, 1, 0, 1, Gtk::FILL, Gtk::AttachOptions(), 0, 0);
    generalLabel->set_alignment(0.5,0.5);
    generalLabel->set_padding(0,0);
    generalLabel->set_justify(Gtk::JUSTIFY_LEFT);
    generalLabel->set_line_wrap(false);
    generalLabel->set_use_markup(false);
    generalLabel->set_selectable(false);
+   generalLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   generalLabel->set_width_chars(-1);
+   generalLabel->set_angle(0);
+   generalLabel->set_single_line_mode(false);
+   directConnectionRadiobutton->set_flags(Gtk::CAN_FOCUS);
+   directConnectionRadiobutton->set_relief(Gtk::RELIEF_NORMAL);
+   directConnectionRadiobutton->set_mode(true);
+   directConnectionRadiobutton->set_active(true);
+   proxyRadiobutton->set_flags(Gtk::CAN_FOCUS);
+   proxyRadiobutton->set_relief(Gtk::RELIEF_NORMAL);
+   proxyRadiobutton->set_mode(true);
+   proxyRadiobutton->set_active(false);
+   proxyAddressLabel->set_alignment(0,0.5);
+   proxyAddressLabel->set_padding(0,0);
+   proxyAddressLabel->set_justify(Gtk::JUSTIFY_LEFT);
+   proxyAddressLabel->set_line_wrap(false);
+   proxyAddressLabel->set_use_markup(false);
+   proxyAddressLabel->set_selectable(false);
+   proxyAddressLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   proxyAddressLabel->set_width_chars(-1);
+   proxyAddressLabel->set_angle(0);
+   proxyAddressLabel->set_single_line_mode(false);
+   proxyAddressEntry->set_flags(Gtk::CAN_FOCUS);
+   proxyAddressEntry->set_visibility(true);
+   proxyAddressEntry->set_editable(true);
+   proxyAddressEntry->set_max_length(0);
+   proxyAddressEntry->set_has_frame(true);
+   proxyAddressEntry->set_activates_default(false);
+   proxyPortLabel->set_alignment(0,0.5);
+   proxyPortLabel->set_padding(0,0);
+   proxyPortLabel->set_justify(Gtk::JUSTIFY_LEFT);
+   proxyPortLabel->set_line_wrap(false);
+   proxyPortLabel->set_use_markup(false);
+   proxyPortLabel->set_selectable(false);
+   proxyPortLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   proxyPortLabel->set_width_chars(-1);
+   proxyPortLabel->set_angle(0);
+   proxyPortLabel->set_single_line_mode(false);
+   proxyPortSpinbutton->set_flags(Gtk::CAN_FOCUS);
+   proxyPortSpinbutton->set_update_policy(Gtk::UPDATE_ALWAYS);
+   proxyPortSpinbutton->set_numeric(false);
+   proxyPortSpinbutton->set_digits(0);
+   proxyPortSpinbutton->set_wrap(false);
+   proxyTypeLabel->set_alignment(0,0.5);
+   proxyTypeLabel->set_padding(0,0);
+   proxyTypeLabel->set_justify(Gtk::JUSTIFY_LEFT);
+   proxyTypeLabel->set_line_wrap(false);
+   proxyTypeLabel->set_use_markup(false);
+   proxyTypeLabel->set_selectable(false);
+   proxyTypeLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   proxyTypeLabel->set_width_chars(-1);
+   proxyTypeLabel->set_angle(0);
+   proxyTypeLabel->set_single_line_mode(false);
+   socksTable->set_row_spacings(0);
+   socksTable->set_col_spacings(0);
+   socksTable->attach(*proxyAddressLabel, 0, 1, 0, 1, Gtk::FILL, Gtk::FILL, 4, 4);
+   socksTable->attach(*proxyAddressEntry, 1, 2, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   socksTable->attach(*proxyPortLabel, 2, 3, 0, 1, Gtk::FILL, Gtk::FILL, 4, 4);
+   socksTable->attach(*proxyPortSpinbutton, 3, 4, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::AttachOptions(), 4, 4);
+   socksTable->attach(*proxyTypeLabel, 0, 1, 1, 2, Gtk::FILL, Gtk::FILL, 4, 4);
+   socksTable->attach(*proxyTypeCombobox, 1, 2, 1, 2, Gtk::EXPAND|Gtk::FILL, Gtk::AttachOptions(), 4, 4);
+   netTable->set_row_spacings(0);
+   netTable->set_col_spacings(0);
+   netTable->attach(*directConnectionRadiobutton, 0, 1, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   netTable->attach(*proxyRadiobutton, 0, 1, 1, 2, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   netTable->attach(*socksTable, 0, 1, 2, 3, Gtk::FILL, Gtk::EXPAND|Gtk::FILL, 0, 0);
+   netLabel->set_alignment(0.5,0.5);
+   netLabel->set_padding(0,0);
+   netLabel->set_justify(Gtk::JUSTIFY_LEFT);
+   netLabel->set_line_wrap(false);
+   netLabel->set_use_markup(false);
+   netLabel->set_selectable(false);
+   netLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   netLabel->set_width_chars(-1);
+   netLabel->set_angle(0);
+   netLabel->set_single_line_mode(false);
    indexLabelsLabel->set_alignment(0,0.5);
    indexLabelsLabel->set_padding(4,4);
    indexLabelsLabel->set_justify(Gtk::JUSTIFY_LEFT);
    indexLabelsLabel->set_line_wrap(true);
    indexLabelsLabel->set_use_markup(false);
    indexLabelsLabel->set_selectable(false);
+   indexLabelsLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   indexLabelsLabel->set_width_chars(-1);
+   indexLabelsLabel->set_angle(0);
+   indexLabelsLabel->set_single_line_mode(false);
    labelsTreeview->set_flags(Gtk::CAN_FOCUS);
    labelsTreeview->set_headers_visible(true);
    labelsTreeview->set_rules_hint(false);
@@ -223,6 +337,10 @@
    label35->set_line_wrap(false);
    label35->set_use_markup(false);
    label35->set_selectable(false);
+   label35->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   label35->set_width_chars(-1);
+   label35->set_angle(0);
+   label35->set_single_line_mode(false);
    hbox29->pack_start(*image235, Gtk::PACK_SHRINK, 0);
    hbox29->pack_start(*label35, Gtk::PACK_SHRINK, 0);
    alignment17->add(*hbox29);
@@ -239,6 +357,10 @@
    label36->set_line_wrap(false);
    label36->set_use_markup(false);
    label36->set_selectable(false);
+   label36->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   label36->set_width_chars(-1);
+   label36->set_angle(0);
+   label36->set_single_line_mode(false);
    hbox30->pack_start(*image236, Gtk::PACK_SHRINK, 0);
    hbox30->pack_start(*label36, Gtk::PACK_SHRINK, 0);
    alignment18->add(*hbox30);
@@ -259,12 +381,20 @@
    labelsLabel->set_line_wrap(false);
    labelsLabel->set_use_markup(false);
    labelsLabel->set_selectable(false);
+   labelsLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   labelsLabel->set_width_chars(-1);
+   labelsLabel->set_angle(0);
+   labelsLabel->set_single_line_mode(false);
    directoriesLabel->set_alignment(0,0.5);
    directoriesLabel->set_padding(4,4);
    directoriesLabel->set_justify(Gtk::JUSTIFY_LEFT);
    directoriesLabel->set_line_wrap(true);
    directoriesLabel->set_use_markup(false);
    directoriesLabel->set_selectable(false);
+   directoriesLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   directoriesLabel->set_width_chars(-1);
+   directoriesLabel->set_angle(0);
+   directoriesLabel->set_single_line_mode(false);
    directoriesTreeview->set_flags(Gtk::CAN_FOCUS);
    directoriesTreeview->set_headers_visible(true);
    directoriesTreeview->set_rules_hint(false);
@@ -284,6 +414,10 @@
    label58->set_line_wrap(false);
    label58->set_use_markup(false);
    label58->set_selectable(false);
+   label58->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   label58->set_width_chars(-1);
+   label58->set_angle(0);
+   label58->set_single_line_mode(false);
    hbox54->pack_start(*image609, Gtk::PACK_SHRINK, 0);
    hbox54->pack_start(*label58, Gtk::PACK_SHRINK, 0);
    alignment35->add(*hbox54);
@@ -306,6 +440,10 @@
    mailAccountsLabel->set_line_wrap(true);
    mailAccountsLabel->set_use_markup(false);
    mailAccountsLabel->set_selectable(false);
+   mailAccountsLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   mailAccountsLabel->set_width_chars(-1);
+   mailAccountsLabel->set_angle(0);
+   mailAccountsLabel->set_single_line_mode(false);
    mailTreeview->set_flags(Gtk::CAN_FOCUS);
    mailTreeview->set_headers_visible(true);
    mailTreeview->set_rules_hint(false);
@@ -325,6 +463,10 @@
    label49->set_line_wrap(false);
    label49->set_use_markup(false);
    label49->set_selectable(false);
+   label49->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   label49->set_width_chars(-1);
+   label49->set_angle(0);
+   label49->set_single_line_mode(false);
    hbox42->pack_start(*image497, Gtk::PACK_SHRINK, 0);
    hbox42->pack_start(*label49, Gtk::PACK_SHRINK, 0);
    alignment28->add(*hbox42);
@@ -347,6 +489,10 @@
    patternsLabel->set_line_wrap(true);
    patternsLabel->set_use_markup(false);
    patternsLabel->set_selectable(false);
+   patternsLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   patternsLabel->set_width_chars(-1);
+   patternsLabel->set_angle(0);
+   patternsLabel->set_single_line_mode(false);
    patternsTreeview->set_flags(Gtk::CAN_FOCUS);
    patternsTreeview->set_headers_visible(true);
    patternsTreeview->set_rules_hint(false);
@@ -366,6 +512,10 @@
    label60->set_line_wrap(false);
    label60->set_use_markup(false);
    label60->set_selectable(false);
+   label60->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   label60->set_width_chars(-1);
+   label60->set_angle(0);
+   label60->set_single_line_mode(false);
    hbox56->pack_start(*image624, Gtk::PACK_SHRINK, 0);
    hbox56->pack_start(*label60, Gtk::PACK_SHRINK, 0);
    alignment36->add(*hbox56);
@@ -394,6 +544,10 @@
    indexingLabel->set_line_wrap(false);
    indexingLabel->set_use_markup(false);
    indexingLabel->set_selectable(false);
+   indexingLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   indexingLabel->set_width_chars(-1);
+   indexingLabel->set_angle(0);
+   indexingLabel->set_single_line_mode(false);
    prefsNotebook->set_flags(Gtk::CAN_FOCUS);
    prefsNotebook->set_show_tabs(true);
    prefsNotebook->set_show_border(true);
@@ -401,6 +555,8 @@
    prefsNotebook->set_scrollable(false);
    prefsNotebook->append_page(*generalTable, *generalLabel);
    prefsNotebook->pages().back().set_tab_label_packing(false, true, Gtk::PACK_START);
+   prefsNotebook->append_page(*netTable, *netLabel);
+   prefsNotebook->pages().back().set_tab_label_packing(false, true, Gtk::PACK_START);
    prefsNotebook->append_page(*labelsVbox, *labelsLabel);
    prefsNotebook->pages().back().set_tab_label_packing(false, true, Gtk::PACK_START);
    prefsNotebook->append_page(*indexingVbox, *indexingLabel);
@@ -418,16 +574,27 @@
    prefsDialog->add_action_widget(*prefsOkbutton, -5);
    prefsCancelbutton->show();
    prefsOkbutton->show();
-   robotsLabel->show();
    apiKeyLabel->show();
    apiKeyEntry->show();
-   ignoreRobotsCheckbutton->show();
    newResultsLabel->show();
    queriesLabel->show();
    enableCompletionCheckbutton->show();
    newResultsColorbutton->show();
+   ignoreRobotsCheckbutton->show();
+   robotsLabel->show();
    generalTable->show();
    generalLabel->show();
+   directConnectionRadiobutton->show();
+   proxyRadiobutton->show();
+   proxyAddressLabel->show();
+   proxyAddressEntry->show();
+   proxyPortLabel->show();
+   proxyPortSpinbutton->show();
+   proxyTypeLabel->show();
+   proxyTypeCombobox->show();
+   socksTable->show();
+   netTable->show();
+   netLabel->show();
    indexLabelsLabel->show();
    labelsTreeview->show();
    labelsScrolledwindow->show();

Modified: trunk/UI/GTK2/src/prefsDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/prefsDialog_glade.hh	2007-03-22 11:02:19 UTC (rev 780)
+++ trunk/UI/GTK2/src/prefsDialog_glade.hh	2007-03-22 12:45:56 UTC (rev 781)
@@ -1,9 +1,9 @@
-// generated 2006/11/1 20:52:15 SGT by fabrice at amra.dyndns.org.(none)
+// generated 2007/3/22 1:27:17 SGT by fabrice at amra.dyndns.org.(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
 // glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
-// for gtk 2.10.4 and gtkmm 2.10.2
+// for gtk 2.10.8 and gtkmm 2.10.7
 //
 // Please modify the corresponding derived classes in ./src/prefsDialog.hh and./src/prefsDialog.cc
 
@@ -37,6 +37,9 @@
 #include <gtkmm/entry.h>
 #include <gtkmm/checkbutton.h>
 #include <gtkmm/colorbutton.h>
+#include <gtkmm/radiobutton.h>
+#include <gtkmm/spinbutton.h>
+#include <gtkmm/comboboxtext.h>
 #include <gtkmm/treeview.h>
 #include <gtkmm/notebook.h>
 
@@ -51,9 +54,15 @@
         class Gtk::Button * prefsOkbutton;
         class Gtk::Label * apiKeyLabel;
         class Gtk::Entry * apiKeyEntry;
-        class Gtk::CheckButton * ignoreRobotsCheckbutton;
         class Gtk::CheckButton * enableCompletionCheckbutton;
         class Gtk::ColorButton * newResultsColorbutton;
+        class Gtk::CheckButton * ignoreRobotsCheckbutton;
+        class Gtk::Label * robotsLabel;
+        class Gtk::RadioButton * directConnectionRadiobutton;
+        class Gtk::RadioButton * proxyRadiobutton;
+        class Gtk::Entry * proxyAddressEntry;
+        class Gtk::SpinButton * proxyPortSpinbutton;
+        class Gtk::ComboBoxText * proxyTypeCombobox;
         class Gtk::TreeView * labelsTreeview;
         class Gtk::Button * addLabelButton;
         class Gtk::Button * removeLabelButton;



From fabricecolin at mail.berlios.de  Fri Mar 23 14:33:07 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 23 Mar 2007 14:33:07 +0100
Subject: [Pinot-svn] r782 - trunk/UI/GTK2/src
Message-ID: <200703231333.l2NDX7nd015612@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-23 14:33:06 +0100 (Fri, 23 Mar 2007)
New Revision: 782

Modified:
   trunk/UI/GTK2/src/IndexPage.cpp
   trunk/UI/GTK2/src/IndexPage.h
   trunk/UI/GTK2/src/importDialog.cc
   trunk/UI/GTK2/src/importDialog.hh
   trunk/UI/GTK2/src/importDialog_glade.cc
   trunk/UI/GTK2/src/importDialog_glade.hh
   trunk/UI/GTK2/src/propertiesDialog.cc
   trunk/UI/GTK2/src/propertiesDialog.hh
   trunk/UI/GTK2/src/propertiesDialog_glade.cc
   trunk/UI/GTK2/src/propertiesDialog_glade.hh
   trunk/UI/GTK2/src/queryDialog.cc
   trunk/UI/GTK2/src/queryDialog.hh
   trunk/UI/GTK2/src/queryDialog_glade.cc
   trunk/UI/GTK2/src/queryDialog_glade.hh
Log:
Replaced ComboBox + ListStore with ComboBoxText.


Modified: trunk/UI/GTK2/src/IndexPage.cpp
===================================================================
--- trunk/UI/GTK2/src/IndexPage.cpp	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/IndexPage.cpp	2007-03-23 13:33:06 UTC (rev 782)
@@ -45,7 +45,7 @@
 	m_docsCount(0),
 	m_firstDoc(0)
 {
-	m_pLabelCombobox = manage(new ComboBox());
+	m_pLabelCombobox = manage(new ComboBoxText());
 
 	Image *image521 = manage(new Image(StockID("gtk-media-rewind"), IconSize(4)));
 	Label *label52 = manage(new Label(_("Show Previous")));
@@ -105,10 +105,6 @@
 		pack_start(*pTree->getScrolledWindow());
 	}
 
-	// Associate the columns model to the label combo
-	m_refLabelNameTree = ListStore::create(m_labelNameColumns);
-	m_pLabelCombobox->set_model(m_refLabelNameTree);
-	m_pLabelCombobox->pack_start(m_labelNameColumns.m_name);
 	// Populate
 	populateLabelCombobox();
 
@@ -147,21 +143,15 @@
 
 void IndexPage::onLabelChanged(void)
 {
-	TreeModel::iterator labelIter = m_pLabelCombobox->get_active();
-	if (labelIter)
-	{
-		TreeModel::Row row = *labelIter;
-
-		m_labelName = row[m_labelNameColumns.m_name];
+	m_labelName = m_pLabelCombobox->get_active_text();
 #ifdef DEBUG
-		cout << "IndexPage::onLabelChanged: current label now " << m_labelName << endl;
+	cout << "IndexPage::onLabelChanged: current label now " << m_labelName << endl;
 #endif
-		if (m_labelName == _("All labels"))
-		{
-			m_labelName.clear();
-		}
-		m_signalLabelChanged(m_title, m_labelName);
+	if (m_labelName == _("All labels"))
+	{
+		m_labelName.clear();
 	}
+	m_signalLabelChanged(m_title, m_labelName);
 }
 
 void IndexPage::onBackClicked(void)
@@ -195,24 +185,13 @@
 //
 void IndexPage::populateLabelCombobox(void)
 {
-	TreeModel::iterator iter;
-	TreeModel::Row row;
+	m_pLabelCombobox->append_text(_("All labels"));
 
-	m_refLabelNameTree->clear();
-
-	iter = m_refLabelNameTree->append();
-	row = *iter;
-	row[m_labelNameColumns.m_name] = _("All labels");
-
 	const set<string> &labels = m_settings.getLabels();
 	for (set<string>::const_iterator labelIter = labels.begin();
 		labelIter != labels.end(); ++labelIter)
 	{
-		string labelName(*labelIter);
-
-		iter = m_refLabelNameTree->append();
-		row = *iter;
-		row[m_labelNameColumns.m_name] = to_utf8(labelName);
+		m_pLabelCombobox->append_text(to_utf8(*labelIter));
 	}
 
 	m_pLabelCombobox->set_active(0);

Modified: trunk/UI/GTK2/src/IndexPage.h
===================================================================
--- trunk/UI/GTK2/src/IndexPage.h	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/IndexPage.h	2007-03-23 13:33:06 UTC (rev 782)
@@ -26,18 +26,16 @@
 #include <glibmm/ustring.h>
 #include <gtkmm/menu.h>
 #include <gdkmm/pixbuf.h>
-#include <gtkmm/combobox.h>
+#include <gtkmm/comboboxtext.h>
 #include <gtkmm/button.h>
 #include <gtkmm/scrolledwindow.h>
 #include <gtkmm/textview.h>
-#include <gtkmm/liststore.h>
 #include <gtkmm/treeview.h>
 #include <gtkmm/treeselection.h>
 
 #include "QueryProperties.h"
 #include "IndexedDocument.h"
 #include "IndexTree.h"
-#include "ModelColumns.h"
 #include "Notebook.h"
 #include "PinotSettings.h"
 
@@ -85,9 +83,7 @@
 		Glib::ustring m_indexName;
 		Glib::ustring m_labelName;
 		IndexTree *m_pTree;
-		ComboModelColumns m_labelNameColumns;
-		Glib::RefPtr<Gtk::ListStore> m_refLabelNameTree;
-		Gtk::ComboBox *m_pLabelCombobox;
+		Gtk::ComboBoxText *m_pLabelCombobox;
 		Gtk::Button *m_pBackButton;
 		Gtk::Button *m_pForwardButton;
 		unsigned int m_docsCount;

Modified: trunk/UI/GTK2/src/importDialog.cc
===================================================================
--- trunk/UI/GTK2/src/importDialog.cc	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/importDialog.cc	2007-03-23 13:33:06 UTC (rev 782)
@@ -54,10 +54,6 @@
 	m_docsCount(0),
 	m_state(10, this)
 {
-	// Associate the columns model to the label combo
-	m_refLabelNameTree = ListStore::create(m_labelNameColumns);
-	labelNameCombobox->set_model(m_refLabelNameTree);
-	labelNameCombobox->pack_start(m_labelNameColumns.m_name);
 	// Populate
 	populate_comboboxes();
 
@@ -77,20 +73,15 @@
 
 void importDialog::populate_comboboxes(void)
 {
-	TreeModel::iterator iter = m_refLabelNameTree->append();
-	TreeModel::Row row = *iter;
-	row[m_labelNameColumns.m_name] = _("None");
+	labelNameCombobox->append_text(_("None"));
 	labelNameCombobox->set_active(0);
+
 	// Add all labels
 	const set<string> &labels = PinotSettings::getInstance().getLabels();
 	for (set<string>::const_iterator labelIter = labels.begin();
 		labelIter != labels.end(); ++labelIter)
 	{
-		string labelName(*labelIter);
-
-		iter = m_refLabelNameTree->append();
-		row = *iter;
-		row[m_labelNameColumns.m_name] = to_utf8(labelName);
+		labelNameCombobox->append_text(to_utf8(*labelIter));
 	}
 }
 
@@ -239,9 +230,7 @@
 	int chosenLabel = labelNameCombobox->get_active_row_number();
 	if (chosenLabel > 0)
 	{
-		TreeModel::iterator iter = labelNameCombobox->get_active();
-		TreeModel::Row row = *iter;
-		m_labelName = from_utf8(row[m_labelNameColumns.m_name]);
+		m_labelName = from_utf8(labelNameCombobox->get_active_text());
 	}
 
 	import_url(location);

Modified: trunk/UI/GTK2/src/importDialog.hh
===================================================================
--- trunk/UI/GTK2/src/importDialog.hh	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/importDialog.hh	2007-03-23 13:33:06 UTC (rev 782)
@@ -26,11 +26,9 @@
 #include <glibmm/refptr.h>
 #include <glibmm/ustring.h>
 #include <gtkmm/button.h>
-#include <gtkmm/liststore.h>
 
 #include "DocumentInfo.h"
 #include "MonitorInterface.h"
-#include "ModelColumns.h"
 #include "WorkerThreads.h"
 #include "importDialog_glade.hh"
 
@@ -52,9 +50,6 @@
 	void on_thread_end(WorkerThread *pThread);
 
 private:
-	// Label
-	ComboModelColumns m_labelNameColumns;
-	Glib::RefPtr<Gtk::ListStore> m_refLabelNameTree;
 	Glib::ustring m_title;
 	std::string m_labelName;
 	unsigned int m_docsCount;

Modified: trunk/UI/GTK2/src/importDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/importDialog_glade.cc	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/importDialog_glade.cc	2007-03-23 13:33:06 UTC (rev 782)
@@ -66,7 +66,7 @@
    
    Gtk::Label *locationLabel = Gtk::manage(new class Gtk::Label(_("Location:")));
    titleLabel = Gtk::manage(new class Gtk::Label(_("Title:")));
-   labelNameCombobox = Gtk::manage(new class Gtk::ComboBox());
+   labelNameCombobox = Gtk::manage(new class Gtk::ComboBoxText());
    
    Gtk::Label *labelNameLabel = Gtk::manage(new class Gtk::Label(_("Apply label:")));
    locationEntry = Gtk::manage(new class Gtk::Entry());

Modified: trunk/UI/GTK2/src/importDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/importDialog_glade.hh	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/importDialog_glade.hh	2007-03-23 13:33:06 UTC (rev 782)
@@ -34,7 +34,7 @@
 #include <gtkmm/dialog.h>
 #include <gtkmm/entry.h>
 #include <gtkmm/label.h>
-#include <gtkmm/combobox.h>
+#include <gtkmm/comboboxtext.h>
 #include <gtkmm/table.h>
 #include <gtkmm/progressbar.h>
 #include <gtkmm/button.h>
@@ -46,7 +46,7 @@
 protected:
         class Gtk::Entry * titleEntry;
         class Gtk::Label * titleLabel;
-        class Gtk::ComboBox * labelNameCombobox;
+        class Gtk::ComboBoxText * labelNameCombobox;
         class Gtk::Entry * locationEntry;
         class Gtk::Table * docTable;
         class Gtk::ProgressBar * importProgressbar;

Modified: trunk/UI/GTK2/src/propertiesDialog.cc
===================================================================
--- trunk/UI/GTK2/src/propertiesDialog.cc	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/propertiesDialog.cc	2007-03-23 13:33:06 UTC (rev 782)
@@ -40,11 +40,6 @@
 	string language(docInfo.getLanguage());
 	bool notALanguageName = false;
 
-	// Associate the columns model to the language combo
-	m_refLanguageTree = ListStore::create(m_languageColumns);
-	languageCombobox->set_model(m_refLanguageTree);
-	languageCombobox->pack_start(m_languageColumns.m_name);
-
 	// Associate the columns model to the labels tree
 	m_refLabelsTree = ListStore::create(m_labelsColumns);
 	labelsTreeview->set_model(m_refLabelsTree);
@@ -107,18 +102,12 @@
 
 void propertiesDialog::populate_languageCombobox(const string &language, bool notALanguageName)
 {
-	TreeModel::iterator iter;
-	TreeModel::Row row;
 	unsigned int languageStart = 0;
 	bool foundLanguage = false;
 
 	if (notALanguageName == true)
 	{
-		iter = m_refLanguageTree->append();
-		row = *iter;
-
-		// This is not a language name as such
-		row[m_languageColumns.m_name] = language;
+		languageCombobox->append_text(to_utf8(language));
 		languageCombobox->set_active(0);
 		languageStart = 1;
 	}
@@ -126,11 +115,9 @@
 	// Add all supported languages
 	for (unsigned int languageNum = 0; languageNum < Languages::m_count; ++languageNum)
 	{
-		string languageName = Languages::getIntlName(languageNum);
-		iter = m_refLanguageTree->append();
-		row = *iter;
-		row[m_languageColumns.m_name] = languageName;
+		string languageName(Languages::getIntlName(languageNum));
 
+		languageCombobox->append_text(to_utf8(languageName));
 		if ((notALanguageName == false) &&
 			(languageName == language))
 		{
@@ -224,11 +211,7 @@
 	int chosenLanguage = languageCombobox->get_active_row_number();
 	if (chosenLanguage >= languageStart)
 	{
-		TreeModel::iterator iter = languageCombobox->get_active();
-		TreeModel::Row row = *iter;
-		string languageName = from_utf8(row[m_languageColumns.m_name]);
-
-		m_docInfo.setLanguage(languageName);
+		m_docInfo.setLanguage(from_utf8(languageCombobox->get_active_text()));
 	}
 
 	// Go through the labels tree

Modified: trunk/UI/GTK2/src/propertiesDialog.hh
===================================================================
--- trunk/UI/GTK2/src/propertiesDialog.hh	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/propertiesDialog.hh	2007-03-23 13:33:06 UTC (rev 782)
@@ -43,8 +43,6 @@
 	const std::set<std::string> &getLabels(void) const;
 
 protected:
-	ComboModelColumns m_languageColumns;
-	Glib::RefPtr<Gtk::ListStore> m_refLanguageTree;
 	LabelModelColumns m_labelsColumns;
 	Glib::RefPtr<Gtk::ListStore> m_refLabelsTree;
 	std::set<std::string> m_labels;

Modified: trunk/UI/GTK2/src/propertiesDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/propertiesDialog_glade.cc	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/propertiesDialog_glade.cc	2007-03-23 13:33:06 UTC (rev 782)
@@ -63,7 +63,7 @@
    labelOkButton = Gtk::manage(new class Gtk::Button(Gtk::StockID("gtk-ok")));
    titleEntry = Gtk::manage(new class Gtk::Entry());
    typeEntry = Gtk::manage(new class Gtk::Entry());
-   languageCombobox = Gtk::manage(new class Gtk::ComboBox());
+   languageCombobox = Gtk::manage(new class Gtk::ComboBoxText());
    titleLabel = Gtk::manage(new class Gtk::Label(_("Title:")));
    languageLabel = Gtk::manage(new class Gtk::Label(_("Language:")));
    typeLabel = Gtk::manage(new class Gtk::Label(_("MIME type:")));

Modified: trunk/UI/GTK2/src/propertiesDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/propertiesDialog_glade.hh	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/propertiesDialog_glade.hh	2007-03-23 13:33:06 UTC (rev 782)
@@ -34,7 +34,7 @@
 #include <gtkmm/dialog.h>
 #include <gtkmm/button.h>
 #include <gtkmm/entry.h>
-#include <gtkmm/combobox.h>
+#include <gtkmm/comboboxtext.h>
 #include <gtkmm/label.h>
 #include <gtkmm/treeview.h>
 #include <gtkmm/scrolledwindow.h>
@@ -49,7 +49,7 @@
         class Gtk::Button * labelOkButton;
         class Gtk::Entry * titleEntry;
         class Gtk::Entry * typeEntry;
-        class Gtk::ComboBox * languageCombobox;
+        class Gtk::ComboBoxText * languageCombobox;
         class Gtk::Label * titleLabel;
         class Gtk::Label * languageLabel;
         class Gtk::Label * typeLabel;

Modified: trunk/UI/GTK2/src/queryDialog.cc
===================================================================
--- trunk/UI/GTK2/src/queryDialog.cc	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/queryDialog.cc	2007-03-23 13:33:06 UTC (rev 782)
@@ -83,14 +83,6 @@
 	// Index all results
 	indexCheckbutton->set_active(m_properties.getIndexResults());
 
-	// Associate the columns model to the index label combo
-	m_refLabelNameTree = ListStore::create(m_labelNameColumns);
-	labelNameCombobox->set_model(m_refLabelNameTree);
-	labelNameCombobox->pack_start(m_labelNameColumns.m_name);
-	// ...and the filter combo
-	m_refFilterTree = ListStore::create(m_filterColumns);
-	filterCombobox->set_model(m_refFilterTree);
-	filterCombobox->pack_start(m_filterColumns.m_name);
 	// Populate
 	populate_comboboxes();
 }
@@ -103,9 +95,7 @@
 {
 	unsigned int labelNum = 1;
 
-	TreeModel::iterator iter = m_refLabelNameTree->append();
-	TreeModel::Row row = *iter;
-	row[m_labelNameColumns.m_name] = _("None");
+	labelNameCombobox->append_text(_("None"));
 	labelNameCombobox->set_active(0);
 
 	// Add all labels to the label combo and select the one defined for the query
@@ -113,9 +103,7 @@
 	{
 		string labelName(*labelIter);
 
-		iter = m_refLabelNameTree->append();
-		row = *iter;
-		row[m_labelNameColumns.m_name] = to_utf8(labelName);
+		labelNameCombobox->append_text(to_utf8(labelName));
 		if (labelName == m_properties.getLabelName())
 		{
 			labelNameCombobox->set_active(labelNum);
@@ -125,33 +113,15 @@
 	}
 
 	// All supported filters
-	iter = m_refFilterTree->append();
-	row = *iter;
-	row[m_filterColumns.m_name] = _("Host name");
-	iter = m_refFilterTree->append();
-	row = *iter;
-	row[m_filterColumns.m_name] = _("File name");
-	iter = m_refFilterTree->append();
-	row = *iter;
-	row[m_filterColumns.m_name] = _("File extension");
-	iter = m_refFilterTree->append();
-	row = *iter;
-	row[m_filterColumns.m_name] = _("Title");
-	iter = m_refFilterTree->append();
-	row = *iter;
-	row[m_filterColumns.m_name] = _("URL");
-	iter = m_refFilterTree->append();
-	row = *iter;
-	row[m_filterColumns.m_name] = _("Directory");
-	iter = m_refFilterTree->append();
-	row = *iter;
-	row[m_filterColumns.m_name] = _("Language code");
-	iter = m_refFilterTree->append();
-	row = *iter;
-	row[m_filterColumns.m_name] = _("MIME type");
-	iter = m_refFilterTree->append();
-	row = *iter;
-	row[m_filterColumns.m_name] = _("Label");
+	filterCombobox->append_text(_("Host name"));
+	filterCombobox->append_text(_("File name"));
+	filterCombobox->append_text(_("File extension"));
+	filterCombobox->append_text(_("Title"));
+	filterCombobox->append_text(_("URL"));
+	filterCombobox->append_text(_("Directory"));
+	filterCombobox->append_text(_("Language code"));
+	filterCombobox->append_text(_("MIME type"));
+	filterCombobox->append_text(_("Label"));
 	filterCombobox->set_active(0);
 }
 
@@ -197,11 +167,7 @@
 	int chosenLabel = labelNameCombobox->get_active_row_number();
 	if (chosenLabel > 0)
 	{
-		TreeModel::iterator iter = labelNameCombobox->get_active();
-		TreeModel::Row row = *iter;
-		string labelName = from_utf8(row[m_labelNameColumns.m_name]);
-
-		m_properties.setLabelName(labelName);
+		m_properties.setLabelName(from_utf8(labelNameCombobox->get_active_text()));
 	}
 }
 

Modified: trunk/UI/GTK2/src/queryDialog.hh
===================================================================
--- trunk/UI/GTK2/src/queryDialog.hh	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/queryDialog.hh	2007-03-23 13:33:06 UTC (rev 782)
@@ -22,10 +22,8 @@
 #include <string>
 #include <set>
 #include <glibmm/date.h>
-#include <gtkmm/liststore.h>
 
 #include "QueryProperties.h"
-#include "ModelColumns.h"
 #include "PinotSettings.h"
 #include "queryDialog_glade.hh"
 
@@ -41,10 +39,6 @@
 	std::string m_name;
 	QueryProperties& m_properties;
 	const std::set<std::string> &m_labels;
-	ComboModelColumns m_labelNameColumns;
-	Glib::RefPtr<Gtk::ListStore> m_refLabelNameTree;
-	ComboModelColumns m_filterColumns;
-	Glib::RefPtr<Gtk::ListStore> m_refFilterTree;
 	Glib::Date m_fromDate;
 	Glib::Date m_toDate;
 	bool m_badName;

Modified: trunk/UI/GTK2/src/queryDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/queryDialog_glade.cc	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/queryDialog_glade.cc	2007-03-23 13:33:06 UTC (rev 782)
@@ -70,7 +70,7 @@
    
    Gtk::Table *nameTable = Gtk::manage(new class Gtk::Table(2, 2, false));
    Gtk::Label *filterLabel = Gtk::manage(new class Gtk::Label(_("New filter:")));
-   filterCombobox = Gtk::manage(new class Gtk::ComboBox());
+   filterCombobox = Gtk::manage(new class Gtk::ComboBoxText());
    
    Gtk::Button *addFilterButton = Gtk::manage(new class Gtk::Button(Gtk::StockID("gtk-add")));
    Gtk::HBox *queryHbox = Gtk::manage(new class Gtk::HBox(false, 0));
@@ -81,7 +81,7 @@
    Gtk::Label *queryFrameLabel = Gtk::manage(new class Gtk::Label(_("Query Text")));
    Gtk::Frame *queryFrame = Gtk::manage(new class Gtk::Frame());
    indexCheckbutton = Gtk::manage(new class Gtk::CheckButton(_("Index results with label")));
-   labelNameCombobox = Gtk::manage(new class Gtk::ComboBox());
+   labelNameCombobox = Gtk::manage(new class Gtk::ComboBoxText());
    
    Gtk::Label *resultsCountLabel = Gtk::manage(new class Gtk::Label(_("Number of results:")));
    Gtk::Adjustment *resultsCountSpinbutton_adj = Gtk::manage(new class Gtk::Adjustment(10, 10, 100, 10, 20, 20));

Modified: trunk/UI/GTK2/src/queryDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/queryDialog_glade.hh	2007-03-22 12:45:56 UTC (rev 781)
+++ trunk/UI/GTK2/src/queryDialog_glade.hh	2007-03-23 13:33:06 UTC (rev 782)
@@ -34,7 +34,7 @@
 #include <gtkmm/dialog.h>
 #include <gtkmm/button.h>
 #include <gtkmm/entry.h>
-#include <gtkmm/combobox.h>
+#include <gtkmm/comboboxtext.h>
 #include <gtkmm/textview.h>
 #include <gtkmm/checkbutton.h>
 #include <gtkmm/spinbutton.h>
@@ -48,10 +48,10 @@
 protected:
         class Gtk::Button * queryOkbutton;
         class Gtk::Entry * nameEntry;
-        class Gtk::ComboBox * filterCombobox;
+        class Gtk::ComboBoxText * filterCombobox;
         class Gtk::TextView * queryTextview;
         class Gtk::CheckButton * indexCheckbutton;
-        class Gtk::ComboBox * labelNameCombobox;
+        class Gtk::ComboBoxText * labelNameCombobox;
         class Gtk::SpinButton * resultsCountSpinbutton;
         class Gtk::CheckButton * fromCheckbutton;
         class Gtk::CheckButton * toCheckbutton;



From fabricecolin at mail.berlios.de  Fri Mar 23 14:57:47 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 23 Mar 2007 14:57:47 +0100
Subject: [Pinot-svn] r783 - trunk/UI/GTK2/src
Message-ID: <200703231357.l2NDvlj8017329@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-23 14:57:47 +0100 (Fri, 23 Mar 2007)
New Revision: 783

Modified:
   trunk/UI/GTK2/src/PinotSettings.cpp
   trunk/UI/GTK2/src/PinotSettings.h
   trunk/UI/GTK2/src/prefsDialog.cc
   trunk/UI/GTK2/src/prefsDialog.hh
   trunk/UI/GTK2/src/prefsDialog_glade.cc
   trunk/UI/GTK2/src/prefsDialog_glade.hh
Log:
Made proxy type a string so that it can be passed as is to the downloaders.
Network tab has same layout as indexDialog, and fields are disabled when direct
connection is activated.


Modified: trunk/UI/GTK2/src/PinotSettings.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.cpp	2007-03-23 13:33:06 UTC (rev 782)
+++ trunk/UI/GTK2/src/PinotSettings.cpp	2007-03-23 13:57:47 UTC (rev 783)
@@ -102,7 +102,6 @@
 	m_newResultsColourGreen(0),
 	m_newResultsColourBlue(0),
 	m_proxyPort(8080),
-	m_proxyType(0),
 	m_proxyEnabled(false),
 	m_firstRun(false)
 {
@@ -881,7 +880,7 @@
 		}
 		else if (nodeName == "type")
 		{
-			m_proxyType = (unsigned int)atoi(nodeContent.c_str());
+			m_proxyType = nodeContent;
 		}
 		else if (nodeName == "enable")
 		{
@@ -1292,8 +1291,7 @@
 	addChildElement(pElem, "address", m_proxyAddress);
 	sprintf(numStr, "%u", m_proxyPort);
 	addChildElement(pElem, "port", numStr);
-	sprintf(numStr, "%u", m_proxyType);
-	addChildElement(pElem, "type", numStr);
+	addChildElement(pElem, "type", m_proxyType);
 	addChildElement(pElem, "enable", (m_proxyEnabled ? "YES" : "NO"));
 	// Mail accounts
 	for (set<TimestampedItem>::iterator mailIter = m_mailAccounts.begin(); mailIter != m_mailAccounts.end(); ++mailIter)

Modified: trunk/UI/GTK2/src/PinotSettings.h
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.h	2007-03-23 13:33:06 UTC (rev 782)
+++ trunk/UI/GTK2/src/PinotSettings.h	2007-03-23 13:57:47 UTC (rev 783)
@@ -205,7 +205,7 @@
 		unsigned short m_newResultsColourBlue;
 		Glib::ustring m_proxyAddress;
 		unsigned int m_proxyPort;
-		unsigned int m_proxyType;
+		Glib::ustring  m_proxyType;
 		bool m_proxyEnabled;
 		std::set<TimestampedItem> m_mailAccounts;
 		std::set<IndexableLocation> m_indexableLocations;

Modified: trunk/UI/GTK2/src/prefsDialog.cc
===================================================================
--- trunk/UI/GTK2/src/prefsDialog.cc	2007-03-23 13:33:06 UTC (rev 782)
+++ trunk/UI/GTK2/src/prefsDialog.cc	2007-03-23 13:57:47 UTC (rev 783)
@@ -64,12 +64,17 @@
 	proxyRadiobutton->set_active(m_settings.m_proxyEnabled);
 	proxyAddressEntry->set_text(m_settings.m_proxyAddress);
 	proxyPortSpinbutton->set_value((double)m_settings.m_proxyPort);
-	// FIXME: sync with settings
-	if (m_settings.m_proxyType > 2)
+	int proxyType = 0;
+	if (m_settings.m_proxyType == "SOCKS4")
 	{
-		m_settings.m_proxyType = 0;
+		proxyType = 1;
 	}
-	proxyTypeCombobox->set_active(m_settings.m_proxyType);
+	else if (m_settings.m_proxyType == "SOCKS5")
+	{
+		proxyType = 2;
+	}
+	proxyTypeCombobox->set_active(proxyType);
+	on_directConnectionRadiobutton_toggled();
 
 	// Associate the columns model to the labels tree
 	m_refLabelsTree = ListStore::create(m_labelsColumns);
@@ -421,7 +426,19 @@
 	m_settings.m_proxyEnabled = proxyRadiobutton->get_active();
 	m_settings.m_proxyAddress = proxyAddressEntry->get_text();
 	m_settings.m_proxyPort = (unsigned int)proxyPortSpinbutton->get_value();
-	m_settings.m_proxyType = proxyTypeCombobox->get_active_row_number();
+	int proxyType = proxyTypeCombobox->get_active_row_number();
+	if (proxyType == 1)
+	{
+		m_settings.m_proxyType = "SOCKS4";
+	}
+	else if (proxyType == 2)
+	{
+		m_settings.m_proxyType = "SOCKS5";
+	}
+	else
+	{
+		m_settings.m_proxyType = "HTTP";
+	}
 
 	// Validate the current lists
 	save_labelsTreeview();
@@ -437,6 +454,15 @@
 	}
 }
 
+void prefsDialog::on_directConnectionRadiobutton_toggled()
+{
+	bool enabled = proxyRadiobutton->get_active();
+
+	proxyAddressEntry->set_sensitive(enabled);
+	proxyPortSpinbutton->set_sensitive(enabled);
+	proxyTypeCombobox->set_sensitive(enabled);
+}
+
 void prefsDialog::on_addLabelButton_clicked()
 {
 	// Now create a new entry in the labels list

Modified: trunk/UI/GTK2/src/prefsDialog.hh
===================================================================
--- trunk/UI/GTK2/src/prefsDialog.hh	2007-03-23 13:33:06 UTC (rev 782)
+++ trunk/UI/GTK2/src/prefsDialog.hh	2007-03-23 13:57:47 UTC (rev 783)
@@ -44,6 +44,7 @@
 
 protected:
 	virtual void on_prefsOkbutton_clicked();
+	virtual void on_directConnectionRadiobutton_toggled();
 	virtual void on_addLabelButton_clicked();
 	virtual void on_removeLabelButton_clicked();
 	virtual void on_addDirectoryButton_clicked();
@@ -65,7 +66,6 @@
 
 private:
 	PinotSettings &m_settings;
-	ComboModelColumns m_viewColumns;
 	Glib::RefPtr<Gtk::ListStore> m_refViewTree;
 	LabelModelColumns m_labelsColumns;
 	Glib::RefPtr<Gtk::ListStore> m_refLabelsTree;

Modified: trunk/UI/GTK2/src/prefsDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/prefsDialog_glade.cc	2007-03-23 13:33:06 UTC (rev 782)
+++ trunk/UI/GTK2/src/prefsDialog_glade.cc	2007-03-23 13:57:47 UTC (rev 783)
@@ -1,4 +1,4 @@
-// generated 2007/3/22 1:27:17 SGT by fabrice at amra.dyndns.org.(none)
+// generated 2007/3/23 21:55:56 SGT by fabrice at amra.dyndns.org.(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -82,11 +82,10 @@
    Gtk::Label *proxyAddressLabel = Gtk::manage(new class Gtk::Label(_("Address:")));
    proxyAddressEntry = Gtk::manage(new class Gtk::Entry());
    
+   Gtk::Label *proxyTypeLabel = Gtk::manage(new class Gtk::Label(_("Type:")));
    Gtk::Label *proxyPortLabel = Gtk::manage(new class Gtk::Label(_("Port:")));
    Gtk::Adjustment *proxyPortSpinbutton_adj = Gtk::manage(new class Gtk::Adjustment(80, 1, 65535, 1, 10, 10));
    proxyPortSpinbutton = Gtk::manage(new class Gtk::SpinButton(*proxyPortSpinbutton_adj, 1, 0));
-   
-   Gtk::Label *proxyTypeLabel = Gtk::manage(new class Gtk::Label(_("Type:")));
    proxyTypeCombobox = Gtk::manage(new class Gtk::ComboBoxText());
    
    Gtk::Table *socksTable = Gtk::manage(new class Gtk::Table(2, 2, false));
@@ -260,6 +259,16 @@
    proxyAddressEntry->set_max_length(0);
    proxyAddressEntry->set_has_frame(true);
    proxyAddressEntry->set_activates_default(false);
+   proxyTypeLabel->set_alignment(0,0.5);
+   proxyTypeLabel->set_padding(0,0);
+   proxyTypeLabel->set_justify(Gtk::JUSTIFY_LEFT);
+   proxyTypeLabel->set_line_wrap(false);
+   proxyTypeLabel->set_use_markup(false);
+   proxyTypeLabel->set_selectable(false);
+   proxyTypeLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
+   proxyTypeLabel->set_width_chars(-1);
+   proxyTypeLabel->set_angle(0);
+   proxyTypeLabel->set_single_line_mode(false);
    proxyPortLabel->set_alignment(0,0.5);
    proxyPortLabel->set_padding(0,0);
    proxyPortLabel->set_justify(Gtk::JUSTIFY_LEFT);
@@ -275,24 +284,14 @@
    proxyPortSpinbutton->set_numeric(false);
    proxyPortSpinbutton->set_digits(0);
    proxyPortSpinbutton->set_wrap(false);
-   proxyTypeLabel->set_alignment(0,0.5);
-   proxyTypeLabel->set_padding(0,0);
-   proxyTypeLabel->set_justify(Gtk::JUSTIFY_LEFT);
-   proxyTypeLabel->set_line_wrap(false);
-   proxyTypeLabel->set_use_markup(false);
-   proxyTypeLabel->set_selectable(false);
-   proxyTypeLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
-   proxyTypeLabel->set_width_chars(-1);
-   proxyTypeLabel->set_angle(0);
-   proxyTypeLabel->set_single_line_mode(false);
    socksTable->set_row_spacings(0);
    socksTable->set_col_spacings(0);
-   socksTable->attach(*proxyAddressLabel, 0, 1, 0, 1, Gtk::FILL, Gtk::FILL, 4, 4);
-   socksTable->attach(*proxyAddressEntry, 1, 2, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
-   socksTable->attach(*proxyPortLabel, 2, 3, 0, 1, Gtk::FILL, Gtk::FILL, 4, 4);
-   socksTable->attach(*proxyPortSpinbutton, 3, 4, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::AttachOptions(), 4, 4);
-   socksTable->attach(*proxyTypeLabel, 0, 1, 1, 2, Gtk::FILL, Gtk::FILL, 4, 4);
-   socksTable->attach(*proxyTypeCombobox, 1, 2, 1, 2, Gtk::EXPAND|Gtk::FILL, Gtk::AttachOptions(), 4, 4);
+   socksTable->attach(*proxyAddressLabel, 0, 1, 1, 2, Gtk::FILL, Gtk::FILL, 4, 4);
+   socksTable->attach(*proxyAddressEntry, 1, 2, 1, 2, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   socksTable->attach(*proxyTypeLabel, 0, 1, 0, 1, Gtk::FILL, Gtk::FILL, 4, 4);
+   socksTable->attach(*proxyPortLabel, 0, 1, 2, 3, Gtk::FILL, Gtk::FILL, 4, 4);
+   socksTable->attach(*proxyPortSpinbutton, 1, 2, 2, 3, Gtk::EXPAND|Gtk::FILL, Gtk::AttachOptions(), 4, 4);
+   socksTable->attach(*proxyTypeCombobox, 1, 2, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::AttachOptions(), 4, 4);
    netTable->set_row_spacings(0);
    netTable->set_col_spacings(0);
    netTable->attach(*directConnectionRadiobutton, 0, 1, 0, 1, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
@@ -588,9 +587,9 @@
    proxyRadiobutton->show();
    proxyAddressLabel->show();
    proxyAddressEntry->show();
+   proxyTypeLabel->show();
    proxyPortLabel->show();
    proxyPortSpinbutton->show();
-   proxyTypeLabel->show();
    proxyTypeCombobox->show();
    socksTable->show();
    netTable->show();
@@ -650,6 +649,7 @@
    prefsNotebook->show();
    prefsDialog->show();
    prefsOkbutton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_prefsOkbutton_clicked), false);
+   directConnectionRadiobutton->signal_toggled().connect(SigC::slot(*this, &prefsDialog_glade::on_directConnectionRadiobutton_toggled), false);
    addLabelButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_addLabelButton_clicked), false);
    removeLabelButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_removeLabelButton_clicked), false);
    addDirectoryButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_addDirectoryButton_clicked), false);

Modified: trunk/UI/GTK2/src/prefsDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/prefsDialog_glade.hh	2007-03-23 13:33:06 UTC (rev 782)
+++ trunk/UI/GTK2/src/prefsDialog_glade.hh	2007-03-23 13:57:47 UTC (rev 783)
@@ -1,4 +1,4 @@
-// generated 2007/3/22 1:27:17 SGT by fabrice at amra.dyndns.org.(none)
+// generated 2007/3/23 21:55:56 SGT by fabrice at amra.dyndns.org.(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -82,6 +82,7 @@
         ~prefsDialog_glade();
 private:
         virtual void on_prefsOkbutton_clicked() = 0;
+        virtual void on_directConnectionRadiobutton_toggled() = 0;
         virtual void on_addLabelButton_clicked() = 0;
         virtual void on_removeLabelButton_clicked() = 0;
         virtual void on_addDirectoryButton_clicked() = 0;



From fabricecolin at mail.berlios.de  Fri Mar 23 14:59:15 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 23 Mar 2007 14:59:15 +0100
Subject: [Pinot-svn] r784 - trunk/UI/GTK2
Message-ID: <200703231359.l2NDxFuN017454@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-23 14:59:14 +0100 (Fri, 23 Mar 2007)
New Revision: 784

Modified:
   trunk/UI/GTK2/metase-gtk2.glade
Log:
Reworked Network tab layout.


Modified: trunk/UI/GTK2/metase-gtk2.glade
===================================================================
--- trunk/UI/GTK2/metase-gtk2.glade	2007-03-23 13:57:47 UTC (rev 783)
+++ trunk/UI/GTK2/metase-gtk2.glade	2007-03-23 13:59:14 UTC (rev 784)
@@ -1287,6 +1287,7 @@
 		  <property name="active">True</property>
 		  <property name="inconsistent">False</property>
 		  <property name="draw_indicator">True</property>
+		  <signal name="toggled" handler="on_directConnectionRadiobutton_toggled" last_modification_time="Fri, 23 Mar 2007 13:40:21 GMT"/>
 		</widget>
 		<packing>
 		  <property name="left_attach">0</property>
@@ -1327,8 +1328,8 @@
 	      <child>
 		<widget class="GtkTable" id="socksTable">
 		  <property name="visible">True</property>
-		  <property name="n_rows">2</property>
-		  <property name="n_columns">4</property>
+		  <property name="n_rows">3</property>
+		  <property name="n_columns">2</property>
 		  <property name="homogeneous">False</property>
 		  <property name="row_spacing">0</property>
 		  <property name="column_spacing">0</property>
@@ -1354,8 +1355,8 @@
 		    <packing>
 		      <property name="left_attach">0</property>
 		      <property name="right_attach">1</property>
-		      <property name="top_attach">0</property>
-		      <property name="bottom_attach">1</property>
+		      <property name="top_attach">1</property>
+		      <property name="bottom_attach">2</property>
 		      <property name="x_padding">4</property>
 		      <property name="y_padding">4</property>
 		      <property name="x_options">fill</property>
@@ -1379,8 +1380,8 @@
 		    <packing>
 		      <property name="left_attach">1</property>
 		      <property name="right_attach">2</property>
-		      <property name="top_attach">0</property>
-		      <property name="bottom_attach">1</property>
+		      <property name="top_attach">1</property>
+		      <property name="bottom_attach">2</property>
 		      <property name="x_padding">4</property>
 		      <property name="y_padding">4</property>
 		      <property name="y_options">fill</property>
@@ -1388,9 +1389,9 @@
 		  </child>
 
 		  <child>
-		    <widget class="GtkLabel" id="proxyPortLabel">
+		    <widget class="GtkLabel" id="proxyTypeLabel">
 		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Port:</property>
+		      <property name="label" translatable="yes">Type:</property>
 		      <property name="use_underline">False</property>
 		      <property name="use_markup">False</property>
 		      <property name="justify">GTK_JUSTIFY_LEFT</property>
@@ -1406,8 +1407,8 @@
 		      <property name="angle">0</property>
 		    </widget>
 		    <packing>
-		      <property name="left_attach">2</property>
-		      <property name="right_attach">3</property>
+		      <property name="left_attach">0</property>
+		      <property name="right_attach">1</property>
 		      <property name="top_attach">0</property>
 		      <property name="bottom_attach">1</property>
 		      <property name="x_padding">4</property>
@@ -1418,33 +1419,9 @@
 		  </child>
 
 		  <child>
-		    <widget class="GtkSpinButton" id="proxyPortSpinbutton">
-		      <property agent="glademm" name="cxx_visibility">protected</property>
+		    <widget class="GtkLabel" id="proxyPortLabel">
 		      <property name="visible">True</property>
-		      <property name="can_focus">True</property>
-		      <property name="climb_rate">1</property>
-		      <property name="digits">0</property>
-		      <property name="numeric">False</property>
-		      <property name="update_policy">GTK_UPDATE_ALWAYS</property>
-		      <property name="snap_to_ticks">False</property>
-		      <property name="wrap">False</property>
-		      <property name="adjustment">80 1 65535 1 10 10</property>
-		    </widget>
-		    <packing>
-		      <property name="left_attach">3</property>
-		      <property name="right_attach">4</property>
-		      <property name="top_attach">0</property>
-		      <property name="bottom_attach">1</property>
-		      <property name="x_padding">4</property>
-		      <property name="y_padding">4</property>
-		      <property name="y_options"></property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkLabel" id="proxyTypeLabel">
-		      <property name="visible">True</property>
-		      <property name="label" translatable="yes">Type:</property>
+		      <property name="label" translatable="yes">Port:</property>
 		      <property name="use_underline">False</property>
 		      <property name="use_markup">False</property>
 		      <property name="justify">GTK_JUSTIFY_LEFT</property>
@@ -1462,8 +1439,8 @@
 		    <packing>
 		      <property name="left_attach">0</property>
 		      <property name="right_attach">1</property>
-		      <property name="top_attach">1</property>
-		      <property name="bottom_attach">2</property>
+		      <property name="top_attach">2</property>
+		      <property name="bottom_attach">3</property>
 		      <property name="x_padding">4</property>
 		      <property name="y_padding">4</property>
 		      <property name="x_options">fill</property>
@@ -1472,6 +1449,30 @@
 		  </child>
 
 		  <child>
+		    <widget class="GtkSpinButton" id="proxyPortSpinbutton">
+		      <property agent="glademm" name="cxx_visibility">protected</property>
+		      <property name="visible">True</property>
+		      <property name="can_focus">True</property>
+		      <property name="climb_rate">1</property>
+		      <property name="digits">0</property>
+		      <property name="numeric">False</property>
+		      <property name="update_policy">GTK_UPDATE_ALWAYS</property>
+		      <property name="snap_to_ticks">False</property>
+		      <property name="wrap">False</property>
+		      <property name="adjustment">80 1 65535 1 10 10</property>
+		    </widget>
+		    <packing>
+		      <property name="left_attach">1</property>
+		      <property name="right_attach">2</property>
+		      <property name="top_attach">2</property>
+		      <property name="bottom_attach">3</property>
+		      <property name="x_padding">4</property>
+		      <property name="y_padding">4</property>
+		      <property name="y_options"></property>
+		    </packing>
+		  </child>
+
+		  <child>
 		    <widget class="GtkComboBox" id="proxyTypeCombobox">
 		      <property agent="glademm" name="cxx_visibility">protected</property>
 		      <property name="visible">True</property>
@@ -1482,8 +1483,8 @@
 		    <packing>
 		      <property name="left_attach">1</property>
 		      <property name="right_attach">2</property>
-		      <property name="top_attach">1</property>
-		      <property name="bottom_attach">2</property>
+		      <property name="top_attach">0</property>
+		      <property name="bottom_attach">1</property>
 		      <property name="x_padding">4</property>
 		      <property name="y_padding">4</property>
 		      <property name="y_options"></property>



From fabricecolin at mail.berlios.de  Fri Mar 23 16:15:04 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 23 Mar 2007 16:15:04 +0100
Subject: [Pinot-svn] r785 - trunk/Index
Message-ID: <200703231515.l2NFF41V024304@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-23 16:15:03 +0100 (Fri, 23 Mar 2007)
New Revision: 785

Modified:
   trunk/Index/DBusXapianIndex.cpp
   trunk/Index/DBusXapianIndex.h
   trunk/Index/IndexInterface.h
   trunk/Index/XapianIndex.cpp
   trunk/Index/XapianIndex.h
Log:
Added versioning.
New method unindexAllDocuments() can reset the whole index.
Some cleanup.


Modified: trunk/Index/DBusXapianIndex.cpp
===================================================================
--- trunk/Index/DBusXapianIndex.cpp	2007-03-23 13:59:14 UTC (rev 784)
+++ trunk/Index/DBusXapianIndex.cpp	2007-03-23 15:15:03 UTC (rev 785)
@@ -346,18 +346,13 @@
 // Implementation of IndexInterface
 //
 
-/// Returns false if the index couldn't be opened.
-bool DBusXapianIndex::isGood(void) const
+/// Sets the version number.
+bool DBusXapianIndex::setVersion(double version) const
 {
-	return XapianIndex::isGood();
+	cerr << "DBusXapianIndex::setVersion: not allowed" << endl;
+	return false;
 }
 
-/// Gets the index location.
-string DBusXapianIndex::getLocation(void) const
-{
-	return XapianIndex::getLocation();
-}
-
 /// Returns a document's properties.
 bool DBusXapianIndex::getDocumentInfo(unsigned int docId, DocumentInfo &docInfo) const
 {
@@ -366,12 +361,6 @@
 	return XapianIndex::getDocumentInfo(docId, docInfo);
 }
 
-/// Returns a document's terms count.
-unsigned int DBusXapianIndex::getDocumentTermsCount(unsigned int docId) const
-{
-	return XapianIndex::getDocumentTermsCount(docId);
-}
-
 /// Determines whether a document has a label.
 bool DBusXapianIndex::hasLabel(unsigned int docId, const string &name) const
 {
@@ -707,6 +696,13 @@
 	return false;
 }
 
+/// Unindexes all documents.
+bool DBusXapianIndex::unindexAllDocuments(void)
+{
+	cerr << "DBusXapianIndex::unindexDocuments: not allowed" << endl;
+	return false;
+}
+
 /// Renames a label.
 bool DBusXapianIndex::renameLabel(const string &name, const string &newName)
 {

Modified: trunk/Index/DBusXapianIndex.h
===================================================================
--- trunk/Index/DBusXapianIndex.h	2007-03-23 13:59:14 UTC (rev 784)
+++ trunk/Index/DBusXapianIndex.h	2007-03-23 15:15:03 UTC (rev 785)
@@ -52,18 +52,12 @@
 		/// Asks the D-Bus service for statistics.
 		static bool getStatistics(unsigned int &crawledCount, unsigned int &docsCount);
 
-		/// Returns false if the index couldn't be opened.
-		virtual bool isGood(void) const;
+		/// Sets the version number.
+		virtual bool setVersion(double version) const;
 
-		/// Gets the index location.
-		virtual std::string getLocation(void) const;
-
 		/// Returns a document's properties.
 		virtual bool getDocumentInfo(unsigned int docId, DocumentInfo &docInfo) const;
 
-		/// Returns a document's terms count.
-		virtual unsigned int getDocumentTermsCount(unsigned int docId) const;
-
 		/// Determines whether a document has a label.
 		virtual bool hasLabel(unsigned int docId, const std::string &name) const;
 
@@ -118,6 +112,9 @@
 		/// Unindexes documents with the given label or under the given directory.
 		virtual bool unindexDocuments(const std::string &name, bool isDirectory);
 
+		/// Unindexes all documents.
+		virtual bool unindexAllDocuments(void);
+
 		/// Renames a label.
 		virtual bool renameLabel(const std::string &name, const std::string &newName);
 

Modified: trunk/Index/IndexInterface.h
===================================================================
--- trunk/Index/IndexInterface.h	2007-03-23 13:59:14 UTC (rev 784)
+++ trunk/Index/IndexInterface.h	2007-03-23 15:15:03 UTC (rev 785)
@@ -44,6 +44,12 @@
 		/// Returns false if the index couldn't be opened.
 		virtual bool isGood(void) const = 0;
 
+		/// Gets the version number.
+		virtual double getVersion(void) const = 0;
+
+		/// Sets the version number.
+		virtual bool setVersion(double version) const = 0;
+
 		/// Gets the index location.
 		virtual std::string getLocation(void) const = 0;
 
@@ -113,6 +119,9 @@
 		/// Unindexes documents with the given label or under the given directory.
 		virtual bool unindexDocuments(const std::string &name, bool isDirectory) = 0;
 
+		/// Unindexes all documents.
+		virtual bool unindexAllDocuments(void) = 0;
+
 		/// Renames a label.
 		virtual bool renameLabel(const std::string &name, const std::string &newName) = 0;
 

Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2007-03-23 13:59:14 UTC (rev 784)
+++ trunk/Index/XapianIndex.cpp	2007-03-23 15:15:03 UTC (rev 785)
@@ -41,6 +41,9 @@
 using std::cout;
 using std::cerr;
 using std::endl;
+using std::ios;
+using std::ifstream;
+using std::ofstream;
 using std::string;
 using std::vector;
 using std::set;
@@ -562,6 +565,50 @@
 	doc.set_data(XapianDatabase::propsToRecord(&docCopy));
 }
 
+bool XapianIndex::deleteDocuments(const string &term)
+{
+	bool unindexed = false;
+
+	if (term.empty() == true)
+	{
+		return false;
+	}
+
+	XapianDatabase *pDatabase = XapianDatabaseFactory::getDatabase(m_databaseName, false);
+	if (pDatabase == NULL)
+	{
+		cerr << "Bad index " << m_databaseName << endl;
+		return false;
+	}
+
+	try
+	{
+		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
+		if (pIndex != NULL)
+		{
+#ifdef DEBUG
+			cout << "XapianIndex::deleteDocuments: term is " << term << endl;
+#endif
+
+			// Delete documents from the index
+			pIndex->delete_document(term);
+
+			unindexed = true;
+		}
+	}
+	catch (const Xapian::Error &error)
+	{
+		cerr << "Couldn't unindex documents: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
+	}
+	catch (...)
+	{
+		cerr << "Couldn't unindex documents, unknown exception occured" << endl;
+	}
+	pDatabase->unlock();
+
+	return unindexed;
+}
+
 //
 // Implementation of IndexInterface
 //
@@ -572,6 +619,43 @@
 	return m_goodIndex;
 }
 
+/// Gets the version number.
+double XapianIndex::getVersion(void) const
+{
+	ifstream verFile;
+	string verFileName(m_databaseName);
+	double version = 0;
+
+	verFileName += "/version";
+	verFile.open(verFileName.c_str());
+	if (verFile.good() == true)
+	{
+		verFile >> version;
+	}
+	verFile.close();
+
+	return version;
+}
+
+/// Sets the version number.
+bool XapianIndex::setVersion(double version) const
+{
+	ofstream verFile;
+	string verFileName(m_databaseName);
+	bool setVer = false;
+
+	verFileName += "/version";
+	verFile.open(verFileName.c_str(), ios::trunc);
+	if (verFile.good() == true)
+	{
+		verFile << version;
+		setVer = true;
+	}
+	verFile.close();
+
+	return setVer;
+}
+
 /// Gets the index location.
 string XapianIndex::getLocation(void) const
 {
@@ -994,7 +1078,7 @@
 unsigned int XapianIndex::listDocuments(set<unsigned int> &docIds,
 	unsigned int maxDocsCount, unsigned int startDoc) const
 {
-	// Get documents that have the magic term
+	// All documents have the magic term
 	return listDocumentsWithTerm(MAGIC_TERM, docIds, maxDocsCount, startDoc);
 }
 
@@ -1348,98 +1432,33 @@
 /// Unindexes the given document.
 bool XapianIndex::unindexDocument(const string &location)
 {
-	bool unindexed = false;
+	string term(string("U") + XapianDatabase::limitTermLength(Url::escapeUrl(Url::canonicalizeUrl(location)), true));
 
-	if (location.empty() == true)
-	{
-		return false;
-	}
-
-	XapianDatabase *pDatabase = XapianDatabaseFactory::getDatabase(m_databaseName, false);
-	if (pDatabase == NULL)
-	{
-		cerr << "Bad index " << m_databaseName << endl;
-		return false;
-	}
-
-	try
-	{
-		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
-		if (pIndex != NULL)
-		{
-			string term = string("U") + XapianDatabase::limitTermLength(Url::escapeUrl(Url::canonicalizeUrl(location)), true);
-
-			// Only one document should have this term
-			pIndex->delete_document(term);
-			unindexed = true;
-		}
-	}
-	catch (const Xapian::Error &error)
-	{
-		cerr << "Couldn't unindex documents: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
-	}
-	catch (...)
-	{
-		cerr << "Couldn't unindex documents, unknown exception occured" << endl;
-	}
-	pDatabase->unlock();
-
-	return unindexed;
+	return deleteDocuments(term);
 }
 
 /// Unindexes documents with the given label or under the given directory.
 bool XapianIndex::unindexDocuments(const string &name, bool isDirectory)
 {
-	bool unindexed = false;
+	string term("XLABEL:");
 
-	if (name.empty() == true)
+	if (isDirectory == true)
 	{
-		return false;
+		term = string("XDIR:") + XapianDatabase::limitTermLength(Url::escapeUrl(name), true);
 	}
-
-	XapianDatabase *pDatabase = XapianDatabaseFactory::getDatabase(m_databaseName, false);
-	if (pDatabase == NULL)
+	else
 	{
-		cerr << "Bad index " << m_databaseName << endl;
-		return false;
+		term += XapianDatabase::limitTermLength(Url::escapeUrl(name));
 	}
 
-	try
-	{
-		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
-		if (pIndex != NULL)
-		{
-			string term("XLABEL:");
+	return deleteDocuments(term);
+}
 
-			if (isDirectory == true)
-			{
-				term = string("XDIR:") + XapianDatabase::limitTermLength(Url::escapeUrl(name), true);
-			}
-			else
-			{
-				term += XapianDatabase::limitTermLength(Url::escapeUrl(name));
-			}
-#ifdef DEBUG
-			cout << "XapianIndex::unindexDocuments: term is " << term << endl;
-#endif
-
-			// Delete documents from the index
-			pIndex->delete_document(term);
-
-			unindexed = true;
-		}
-	}
-	catch (const Xapian::Error &error)
-	{
-		cerr << "Couldn't unindex documents: " << error.get_type() << ": " << error.get_errno() << " " << error.get_msg() << endl;
-	}
-	catch (...)
-	{
-		cerr << "Couldn't unindex documents, unknown exception occured" << endl;
-	}
-	pDatabase->unlock();
-
-	return unindexed;
+/// Unindexes all documents.
+bool XapianIndex::unindexAllDocuments(void)
+{
+	// All documents have the magic term
+	return deleteDocuments(MAGIC_TERM);
 }
 
 /// Renames a label.

Modified: trunk/Index/XapianIndex.h
===================================================================
--- trunk/Index/XapianIndex.h	2007-03-23 13:59:14 UTC (rev 784)
+++ trunk/Index/XapianIndex.h	2007-03-23 15:15:03 UTC (rev 785)
@@ -38,6 +38,12 @@
 		/// Returns false if the index couldn't be opened.
 		virtual bool isGood(void) const;
 
+		/// Gets the version number.
+		virtual double getVersion(void) const;
+
+		/// Sets the version number.
+		virtual bool setVersion(double version) const;
+
 		/// Gets the index location.
 		virtual std::string getLocation(void) const;
 
@@ -104,6 +110,9 @@
 		/// Unindexes documents with the given label or under the given directory.
 		virtual bool unindexDocuments(const std::string &name, bool isDirectory);
 
+		/// Unindexes all documents.
+		virtual bool unindexAllDocuments(void);
+
 		/// Renames a label.
 		virtual bool renameLabel(const std::string &name, const std::string &newName);
 
@@ -139,6 +148,8 @@
 		void setDocumentData(const DocumentInfo &info, Xapian::Document &doc,
 			const std::string &language) const;
 
+		bool deleteDocuments(const std::string &term);
+
 };
 
 #endif // _XAPIAN_INDEX_H



From fabricecolin at mail.berlios.de  Sat Mar 24 05:13:15 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 24 Mar 2007 05:13:15 +0100
Subject: [Pinot-svn] r786 - trunk/UI/GTK2/src
Message-ID: <200703240413.l2O4DFvP013775@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-24 05:13:14 +0100 (Sat, 24 Mar 2007)
New Revision: 786

Modified:
   trunk/UI/GTK2/src/DaemonState.cpp
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/WorkerThreads.h
Log:
All worker threads are non-joinable. DaemonState doesn't delete the handlers
when destroyed in case they are still being used. Since it's destroyed only
when the program exits, it should be okay.


Modified: trunk/UI/GTK2/src/DaemonState.cpp
===================================================================
--- trunk/UI/GTK2/src/DaemonState.cpp	2007-03-23 15:15:03 UTC (rev 785)
+++ trunk/UI/GTK2/src/DaemonState.cpp	2007-03-24 04:13:14 UTC (rev 786)
@@ -58,14 +58,8 @@
 	{
 		delete m_pMailMonitor;
 	}
-	if (m_pDiskHandler != NULL)
-	{
-		delete m_pDiskHandler;
-	}
-	if (m_pMailHandler != NULL)
-	{
-		delete m_pMailHandler;
-	}
+	// Don't delete m_pDiskHandler and m_pMailHandler, threads may need them
+	// Since DaemonState is destroyed when the program exits, it's okay
 }
 
 bool DaemonState::crawlLocation(const string &locationToCrawl, bool isSource, bool doMonitoring)

Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2007-03-23 15:15:03 UTC (rev 785)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2007-03-24 04:13:14 UTC (rev 786)
@@ -68,22 +68,6 @@
 	}
 };
 
-// A function object to delete threads with for_each()
-struct DeleteThreadFunc
-{
-public:
-	void operator()(map<WorkerThread *, Thread *>::value_type &p)
-	{
-#ifdef DEBUG
-		cout << "DeleteThreadFunc: waiting for thread " << p.first->getId() << endl;
-#endif
-		// FIXME: the documentation says resources of the thread, including the Thread object
-		// are released by join()
-		p.second->join();
-		delete p.first;
-	}
-};
-
 Dispatcher WorkerThread::m_dispatcher;
 pthread_mutex_t WorkerThread::m_dispatcherMutex = PTHREAD_MUTEX_INITIALIZER;
 bool WorkerThread::m_immediateFlush = true;
@@ -99,7 +83,6 @@
 }
 
 WorkerThread::WorkerThread() :
-	m_joinable(true),
 	m_id(0),
 	m_background(false),
 	m_done(false)
@@ -140,7 +123,8 @@
 #ifdef DEBUG
 	cout << "WorkerThread::start: " << getType() << " " << m_id << endl;
 #endif
-	return Thread::create(slot_class(*this, &WorkerThread::threadHandler), m_joinable);
+	// Create non-joinable threads
+	return Thread::create(slot_class(*this, &WorkerThread::threadHandler), false);
 }
 
 bool WorkerThread::isDone(void) const
@@ -184,9 +168,6 @@
 		cout << "WorkerThread::emitSignal: signaling end of thread " << m_id << endl;
 #endif
 		m_dispatcher();
-#ifdef DEBUG
-		cout << "WorkerThread::emitSignal: signaled end of thread " << m_id << endl;
-#endif
 
 		pthread_mutex_unlock(&m_dispatcherMutex);
 	}
@@ -278,7 +259,6 @@
 			{
 				// This one will do...
 				pWorkerThread = threadIter->first;
-				threadIter->second->join();
 				// Remove it
 				m_threads.erase(threadIter);
 				break;
@@ -431,8 +411,6 @@
 		{
 			// Stop threads
 			for_each(m_threads.begin(), m_threads.end(), StopThreadFunc());
-			// Join them
-			for_each(m_threads.begin(), m_threads.end(), DeleteThreadFunc());
 			m_threads.clear();
 
 			unlock_threads();
@@ -778,6 +756,8 @@
 
 void QueryingThread::doWork(void)
 {
+	PinotSettings &settings = PinotSettings::getInstance();
+
 	// Get the SearchEngine
 	SearchEngineInterface *pEngine = SearchEngineFactory::getSearchEngine(m_engineName, m_engineOption);
 	if (pEngine == NULL)
@@ -791,6 +771,20 @@
 	// Set the maximum number of results
 	pEngine->setMaxResultsCount(m_queryProps.getMaximumResultsCount());
 
+	// Set up the proxy
+	DownloaderInterface *pDownloader = pEngine->getDownloader();
+	if ((pDownloader != NULL) &&
+		(settings.m_proxyEnabled == true) &&
+		(settings.m_proxyAddress.empty() == false))
+	{
+		char portStr[64];
+
+		pDownloader->setSetting("proxyaddress", settings.m_proxyAddress);
+		snprintf(portStr, 64, "%u", settings.m_proxyPort);
+		pDownloader->setSetting("proxyport", portStr);
+		pDownloader->setSetting("proxytype", settings.m_proxyType);
+	}
+
 	// Run the query
 	if (pEngine->runQuery(m_queryProps) == false)
 	{
@@ -802,7 +796,6 @@
 	{
 		IndexInterface *pDocsIndex = NULL;
 		IndexInterface *pDaemonIndex = NULL;
-		PinotSettings &settings = PinotSettings::getInstance();
 		const vector<Result> &resultsList = pEngine->getResults();
 		unsigned int indexId = 0;
 		bool isIndexQuery = false;
@@ -1153,6 +1146,20 @@
 	}
 	else if (m_done == false)
 	{
+		PinotSettings &settings = PinotSettings::getInstance();
+
+		// Set up the proxy
+		if ((settings.m_proxyEnabled == true) &&
+			(settings.m_proxyAddress.empty() == false))
+		{
+			char portStr[64];
+
+			m_pDownloader->setSetting("proxyaddress", settings.m_proxyAddress);
+			snprintf(portStr, 64, "%u", settings.m_proxyPort);
+			m_pDownloader->setSetting("proxyport", portStr);
+			m_pDownloader->setSetting("proxytype", settings.m_proxyType);
+		}
+
 		m_pDoc = m_pDownloader->retrieveUrl(m_docInfo);
 	}
 
@@ -1287,9 +1294,6 @@
 	if (doDownload == true)
 	{
 		DownloadingThread::doWork();
-#ifdef DEBUG
-		cout << "IndexingThread::doWork: downloaded " << m_docInfo.getLocation() << endl;
-#endif
 	}
 	else
 	{
@@ -1444,6 +1448,9 @@
 			}
 		}
 	}
+#ifdef DEBUG
+	else cout << "IndexingThread::doWork: couldn't download " << m_docInfo.getLocation() << endl;
+#endif
 
 	delete pIndex;
 }

Modified: trunk/UI/GTK2/src/WorkerThreads.h
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.h	2007-03-23 15:15:03 UTC (rev 785)
+++ trunk/UI/GTK2/src/WorkerThreads.h	2007-03-24 04:13:14 UTC (rev 786)
@@ -74,7 +74,6 @@
 		static Glib::Dispatcher m_dispatcher;
 		static pthread_mutex_t m_dispatcherMutex;
 		static bool m_immediateFlush;
-		bool m_joinable;
 		unsigned int m_id;
 		bool m_background;
 		bool m_done;



From fabricecolin at mail.berlios.de  Sat Mar 24 05:14:35 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 24 Mar 2007 05:14:35 +0100
Subject: [Pinot-svn] r787 - trunk/UI/GTK2/src
Message-ID: <200703240414.l2O4EZOm013821@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-24 05:14:35 +0100 (Sat, 24 Mar 2007)
New Revision: 787

Modified:
   trunk/UI/GTK2/src/PinotUtils.cpp
Log:
Get the file chooser to show hidden files.


Modified: trunk/UI/GTK2/src/PinotUtils.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotUtils.cpp	2007-03-24 04:13:14 UTC (rev 786)
+++ trunk/UI/GTK2/src/PinotUtils.cpp	2007-03-24 04:14:35 UTC (rev 787)
@@ -53,6 +53,7 @@
 	fileChooser.add_button(okButtonStockId, RESPONSE_OK);
 	// FIXME: add FileFilter's
 	fileChooser.set_title(title);
+	fileChooser.set_show_hidden(true);
 	fileChooser.show();
 
 	int result = fileChooser.run();



From fabricecolin at mail.berlios.de  Sat Mar 24 05:18:00 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 24 Mar 2007 05:18:00 +0100
Subject: [Pinot-svn] r788 - trunk/UI/GTK2/src
Message-ID: <200703240418.l2O4I0Pb013929@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-24 05:18:00 +0100 (Sat, 24 Mar 2007)
New Revision: 788

Modified:
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/UI/GTK2/src/pinot.cc
Log:
The daemon checks the version of My Documents and performs an upgrade if
necessary. The D-Bus connection is not explicitely closed at exit time in case
a servlet thread is still running.
The UI also checks the version of My Web Pages but only advises to update all
documents.


Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2007-03-24 04:14:35 UTC (rev 787)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2007-03-24 04:18:00 UTC (rev 788)
@@ -360,6 +360,35 @@
 		cerr << "Couldn't set scheduling priority to " << priority << endl;
 	}
 
+	// What version of the daemon is this ?
+	double daemonVersion = atof(VERSION);
+	// What version is the index at ?
+	XapianIndex daemonIndex(settings.m_daemonIndexLocation);
+	double indexVersion = daemonIndex.getVersion();
+	// Is an upgrade necessary ?
+	if (indexVersion <= 0.70)
+	{
+		cout << "Upgrading index from version " << indexVersion << " to " << daemonVersion << endl;
+
+		// Yes, it is
+		// Reset the index
+		if (daemonIndex.unindexAllDocuments() == true)
+		{
+			CrawlHistory history(settings.m_historyDatabase);
+			map<unsigned int, string> sources;
+
+			// ...and the history
+			history.getSources(sources);
+			for (std::map<unsigned int, string>::iterator sourceIter = sources.begin();
+				sourceIter != sources.end(); ++sourceIter)
+			{
+				history.deleteItems(sourceIter->first);
+				history.deleteSource(sourceIter->first);
+			}
+		}
+	}
+	daemonIndex.setVersion(daemonVersion);
+
 	GError *pError = NULL;
 	DBusGConnection *pBus = dbus_g_bus_get(DBUS_BUS_SESSION, &pError);
 	if (pBus == NULL)
@@ -430,19 +459,11 @@
 	{
 		cerr << "Couldn't register object path: " << pError->message << endl;
 	}
+	dbus_error_free(&error);
 
-	// Stop everything before closing the connection
+	// Stop everything
 	server.disconnect();
 	server.stop_threads();
 
-	dbus_error_free(&error);
-#ifdef DEBUG
-	cout << "Closing connection..." << endl;
-#endif
-#if DBUS_VERSION < 33000
-	dbus_connection_disconnect(pConnection);
-#endif
-	dbus_g_connection_unref(pBus);
-
 	return EXIT_SUCCESS;
 }

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2007-03-24 04:14:35 UTC (rev 787)
+++ trunk/UI/GTK2/src/pinot.cc	2007-03-24 04:18:00 UTC (rev 788)
@@ -49,6 +49,7 @@
 #include "QueryHistory.h"
 #include "ViewHistory.h"
 #include "DownloaderInterface.h"
+#include "XapianIndex.h"
 #include "config.h"
 #include "NLS.h"
 #include "PinotSettings.h"
@@ -295,6 +296,20 @@
 
 	atexit(closeAll);
 
+	// What version of the UI is this ?
+	double uiVersion = atof(VERSION);
+	// What version is the index at ?
+	XapianIndex docsIndex(settings.m_docsIndexLocation);
+	double indexVersion = docsIndex.getVersion();
+	// Is an upgrade necessary ?
+	if (indexVersion <= 0.70)
+	{
+		// Yes, it is
+		// FIXME: use a popup ! 
+		errorMsg = _("Updating all documents in My Web Pages is recommended");
+	}
+	docsIndex.setVersion(uiVersion);
+
 	try
 	{
 		// Set an icon for all windows



From fabricecolin at mail.berlios.de  Sat Mar 24 08:04:11 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 24 Mar 2007 08:04:11 +0100
Subject: [Pinot-svn] r789 - trunk/UI/GTK2/src
Message-ID: <200703240704.l2O74B7r001803@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-24 08:04:10 +0100 (Sat, 24 Mar 2007)
New Revision: 789

Modified:
   trunk/UI/GTK2/src/IndexTree.cpp
   trunk/UI/GTK2/src/PinotUtils.cpp
   trunk/UI/GTK2/src/ServerThreads.cpp
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/queryDialog.cc
Log:
Minor changes : check RefPtr's and complain if XML file cannot be found when
Introspect is received.


Modified: trunk/UI/GTK2/src/IndexTree.cpp
===================================================================
--- trunk/UI/GTK2/src/IndexTree.cpp	2007-03-24 04:18:00 UTC (rev 788)
+++ trunk/UI/GTK2/src/IndexTree.cpp	2007-03-24 07:04:10 UTC (rev 789)
@@ -131,7 +131,7 @@
 }
 
 bool IndexTree::onSelectionSelect(const RefPtr<TreeModel>& model,
-		const TreeModel::Path& path, bool path_currently_selected)
+	const TreeModel::Path& path, bool path_currently_selected)
 {
 	const TreeModel::iterator iter = model->get_iter(path);
 	const TreeModel::Row row = *iter;

Modified: trunk/UI/GTK2/src/PinotUtils.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotUtils.cpp	2007-03-24 04:18:00 UTC (rev 788)
+++ trunk/UI/GTK2/src/PinotUtils.cpp	2007-03-24 07:04:10 UTC (rev 789)
@@ -134,6 +134,11 @@
 	}
 
 	RefPtr<Style> refRCStyle = RC::get_style(*pTree);
+	if (!refRCStyle)
+	{
+		return 0;
+	}
+
 	int fontSize = refRCStyle->get_font().get_size();
 	int height = fontSize / Pango::SCALE;
 #ifdef DEBUG

Modified: trunk/UI/GTK2/src/ServerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-24 04:18:00 UTC (rev 788)
+++ trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-24 07:04:10 UTC (rev 789)
@@ -69,6 +69,8 @@
 
 static bool loadXMLDescription(void)
 {
+	bool readFile = false;
+
 	if (g_xmlDescription.empty() == false)
 	{
 		return true;
@@ -91,12 +93,13 @@
 		{
 			pXmlBuffer[length] = '\0';
 			g_xmlDescription = pXmlBuffer;
+			readFile = true;
 		}
 		delete[] pXmlBuffer;
 	}
 	xmlFile.close();
 
-	return true;	
+	return readFile;
 }
 
 MonitorThread::MonitorThread(MonitorInterface *pMonitor, MonitorHandler *pHandler) :
@@ -1210,6 +1213,10 @@
 					DBUS_TYPE_INVALID);
 			}
 		}
+		else
+		{
+			cerr << "File pinot-dbus-daemon.xml couldn't be found" << endl;
+		}
 	}
 	else
 	{

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2007-03-24 04:18:00 UTC (rev 788)
+++ trunk/UI/GTK2/src/mainWindow.cc	2007-03-24 07:04:10 UTC (rev 789)
@@ -1563,7 +1563,10 @@
 	}
 	
 	RefPtr<Clipboard> refClipboard = Clipboard::get();
-	refClipboard->set_text(text);
+	if (refClipboard)
+	{
+		refClipboard->set_text(text);
+	}
 }
 
 //
@@ -1572,6 +1575,12 @@
 void mainWindow::on_paste_activate()
 {
 	RefPtr<Clipboard> refClipboard = Clipboard::get();
+
+	if (!refClipboard)
+	{
+		return;
+	}
+
 	if (refClipboard->wait_is_text_available() == false)
 	{
 		return;

Modified: trunk/UI/GTK2/src/queryDialog.cc
===================================================================
--- trunk/UI/GTK2/src/queryDialog.cc	2007-03-24 04:18:00 UTC (rev 788)
+++ trunk/UI/GTK2/src/queryDialog.cc	2007-03-24 07:04:10 UTC (rev 789)
@@ -54,7 +54,10 @@
 	}
 	// Query text
 	RefPtr<TextBuffer> refBuffer = queryTextview->get_buffer();
-	refBuffer->set_text(to_utf8(m_properties.getFreeQuery()));
+	if (refBuffer)
+	{
+		refBuffer->set_text(to_utf8(m_properties.getFreeQuery()));
+	}
 	// Maximum number of results
 	resultsCountSpinbutton->set_value((double)m_properties.getMaximumResultsCount());
 	// Date range
@@ -154,7 +157,10 @@
 
 	// Query text
 	RefPtr<TextBuffer> refBuffer = queryTextview->get_buffer();
-	m_properties.setFreeQuery(from_utf8(refBuffer->get_text()));
+	if (refBuffer)
+	{
+		m_properties.setFreeQuery(from_utf8(refBuffer->get_text()));
+	}
 	// Maximum number of results
 	m_properties.setMaximumResultsCount((unsigned int)resultsCountSpinbutton->get_value());
 	// Date range
@@ -225,11 +231,14 @@
 	}
 
 	RefPtr<TextBuffer> refBuffer = queryTextview->get_buffer();
-	ustring queryText = refBuffer->get_text();
-	queryText += " ";
-	queryText += filter;
-	queryText += ":xxx";
-	refBuffer->set_text(queryText);
+	if (refBuffer)
+	{
+		ustring queryText = refBuffer->get_text();
+		queryText += " ";
+		queryText += filter;
+		queryText += ":xxx";
+		refBuffer->set_text(queryText);
+	}
 }
 
 void queryDialog::on_fromButton_clicked()



From fabricecolin at mail.berlios.de  Sat Mar 24 08:28:23 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 24 Mar 2007 08:28:23 +0100
Subject: [Pinot-svn] r790 - in trunk: . po
Message-ID: <200703240728.l2O7SN0M003516@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-24 08:28:21 +0100 (Sat, 24 Mar 2007)
New Revision: 790

Added:
   trunk/po/de.po
   trunk/po/it.po
   trunk/po/pt.po
Modified:
   trunk/AUTHORS
   trunk/configure.in
   trunk/pinot.spec.in
Log:
New German, Italian and Portuguese translations by by Christian Dywan, Michele
Angrisano and _PN_boy respectively.
Bumped version number.


Modified: trunk/AUTHORS
===================================================================
--- trunk/AUTHORS	2007-03-24 07:04:10 UTC (rev 789)
+++ trunk/AUTHORS	2007-03-24 07:28:21 UTC (rev 790)
@@ -13,6 +13,7 @@
 	Neal Becker <ndbecker2 at gmail dot com>
 	Gabriel C <nix dot or dot die at googlemail dot com> 
 	Roger Mason <rmason at esd dot mun dot ca>
+	Reuben Thomas <rrt at sc3d dot org> 
 
 The file Monitor/linux-inotify-syscalls.h is originally from libinotify
 (Copyright ? 2005 Ryan Lortie <desrt at desrt dot ca>).
@@ -27,9 +28,12 @@
 
 	Dutch - Tikkel <???>
 	French - Nicolas Velin <nsv at fr dot st>
+	German - Christian Dywan <christian at twotoasts dot de>
+	Italian - Michele Angrisano <darksun1988 at gmail dot com>
+	Portuguese - _PN_boy <pedro_nuno_pn at iol dot pt>
+	Portuguese (Brazil) - Leonardo Melo <leonardovazmelo at gmail dot com>
+	Russian - Sergey Vostrikov <memphis at jabber dot snc dot ru>
 	Spanish - Jes?s Tramullas <jesus at tramullas dot com>
 		- Garbage <garbage at openfutura.com>
 	Swedish - Daniel Nylander <po at danielnylander dot se>
-	Portuguese (Brazil) - Leonardo Melo <leonardovazmelo at gmail dot com>
-	Russian - Sergey Vostrikov <memphis at jabber dot snc dot ru>
 

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2007-03-24 07:04:10 UTC (rev 789)
+++ trunk/configure.in	2007-03-24 07:28:21 UTC (rev 790)
@@ -2,7 +2,7 @@
 # using glademm V2.6.0
 
 AC_PREREQ(2.50)
-AC_INIT(pinot, 0.70,[fabricecolin at users.berlios.de])
+AC_INIT(pinot, 0.71,[fabricecolin at users.berlios.de])
 AM_INIT_AUTOMAKE
 AC_CONFIG_HEADERS(config.h)
 
@@ -25,7 +25,7 @@
 		[the gettext domain])
 
 dnl Add the languages which your application supports here.
-ALL_LINGUAS="fr es nl pt_BR ru sv"
+ALL_LINGUAS="de es fr it nl pt pt_BR ru sv"
 #AM_GNU_GETTEXT([external]) 
 AM_GLIB_GNU_GETTEXT
 

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2007-03-24 07:04:10 UTC (rev 789)
+++ trunk/pinot.spec.in	2007-03-24 07:28:21 UTC (rev 790)
@@ -124,9 +124,12 @@
 %{_datadir}/pinot/engines/YahooAPI.src
 %{_datadir}/pinot/engines/Wikipedia.src
 %{_datadir}/pinot/engines/KodersDescription.xml
+%{_datadir}/locale/de/LC_MESSAGES/pinot.mo
+%{_datadir}/locale/es/LC_MESSAGES/pinot.mo
 %{_datadir}/locale/fr/LC_MESSAGES/pinot.mo
-%{_datadir}/locale/es/LC_MESSAGES/pinot.mo
+%{_datadir}/locale/it/LC_MESSAGES/pinot.mo
 %{_datadir}/locale/nl/LC_MESSAGES/pinot.mo
+%{_datadir}/locale/pt/LC_MESSAGES/pinot.mo
 %{_datadir}/locale/pt_BR/LC_MESSAGES/pinot.mo
 %{_datadir}/locale/ru/LC_MESSAGES/pinot.mo
 %{_datadir}/locale/sv/LC_MESSAGES/pinot.mo

Added: trunk/po/de.po
===================================================================
--- trunk/po/de.po	2007-03-24 07:04:10 UTC (rev 789)
+++ trunk/po/de.po	2007-03-24 07:28:21 UTC (rev 790)
@@ -0,0 +1,878 @@
+# German translation for pinot
+# Copyright (c) 2006 Rosetta Contributors and Canonical Ltd 2006
+# This file is distributed under the same license as the pinot package.
+# FIRST AUTHOR <EMAIL at ADDRESS>, 2006.
+#
+#, fuzzy
+msgid ""
+msgstr ""
+"Project-Id-Version: pinot\n"
+"Report-Msgid-Bugs-To: \n"
+"POT-Creation-Date: 2007-03-24 00:44+0800\n"
+"PO-Revision-Date: 2007-03-10 20:26+0000\n"
+"Last-Translator: Christian Dywan <christian at twotoasts.de>\n"
+"Language-Team: German <de at li.org>\n"
+"MIME-Version: 1.0\n"
+"Content-Type: text/plain; charset=UTF-8\n"
+"Content-Transfer-Encoding: 8bit\n"
+"X-Rosetta-Export-Date: 2007-03-24 04:08+0000\n"
+
+#: UI/GTK2/src/EnginesTree.cpp:70
+msgid "Search Engines"
+msgstr "Suchmaschinen"
+
+#: UI/GTK2/src/EnginesTree.cpp:328
+msgid "Current User"
+msgstr "Aktueller Benutzer"
+
+#. Bind the callback's parameter to the index name
+#. Enable these menu items unless it is not the documents index
+#. Internal indices
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
+#: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
+#: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
+#: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
+#: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
+msgid "My Web Pages"
+msgstr "Meine Webseiten"
+
+#. Populate the submenu
+#. Bind the callback's parameter to the index name
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
+#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
+#: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
+#: UI/GTK2/src/PinotSettings.cpp:1402 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:818 UI/GTK2/src/WorkerThreads.cpp:882
+msgid "My Documents"
+msgstr "Meine Dokumente"
+
+#. The last column is for the timestamp
+#: UI/GTK2/src/dateDialog_glade.cc:76 UI/GTK2/src/queryDialog_glade.cc:91
+#: UI/GTK2/src/queryDialog_glade.cc:92 UI/GTK2/src/ResultsTree.cpp:145
+msgid "Date"
+msgstr "Datum"
+
+#: UI/GTK2/src/indexDialog.cc:122
+msgid "Served by"
+msgstr ""
+
+#: UI/GTK2/src/indexDialog.cc:124
+msgid "Local"
+msgstr "Lokal"
+
+#: UI/GTK2/src/indexDialog.cc:286
+msgid "Index location"
+msgstr ""
+
+#: UI/GTK2/src/indexDialog_glade.cc:65 UI/GTK2/src/queryDialog_glade.cc:68
+msgid "Name:"
+msgstr "Name"
+
+#: UI/GTK2/src/indexDialog_glade.cc:67
+msgid "..."
+msgstr "..."
+
+#: UI/GTK2/src/indexDialog_glade.cc:70 UI/GTK2/src/prefsDialog_glade.cc:85
+msgid "Type:"
+msgstr "Typ:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:71 UI/GTK2/src/importDialog_glade.cc:67
+msgid "Location:"
+msgstr "Ort:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:72 UI/GTK2/src/prefsDialog_glade.cc:86
+msgid "Port:"
+msgstr "Port"
+
+#: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
+msgid "Address:"
+msgstr ""
+
+#: UI/GTK2/src/indexDialog_glade.cc:183
+msgid "External index"
+msgstr "Externer Index"
+
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:98
+msgid "None"
+msgstr ""
+
+#: UI/GTK2/src/importDialog_glade.cc:68
+#: UI/GTK2/src/propertiesDialog_glade.cc:67
+msgid "Title:"
+msgstr "Titel"
+
+#: UI/GTK2/src/importDialog_glade.cc:71
+msgid "Apply label:"
+msgstr ""
+
+#: UI/GTK2/src/importDialog_glade.cc:77
+msgid "Import"
+msgstr "Importieren"
+
+#: UI/GTK2/src/importDialog_glade.cc:148 UI/GTK2/src/mainWindow_glade.cc:217
+msgid "Import URL"
+msgstr "URL importieren"
+
+#. The score column is used for status icons
+#. This is the title column
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:119
+#: UI/GTK2/src/ResultsTree.cpp:127
+msgid "Title"
+msgstr ""
+
+#. URL
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:120
+#: UI/GTK2/src/ResultsTree.cpp:137
+msgid "URL"
+msgstr "URL"
+
+#: UI/GTK2/src/IndexTree.cpp:78
+msgid "Timestamp"
+msgstr "Zeitstempel"
+
+#: UI/GTK2/src/IndexPage.cpp:51
+msgid "Show Previous"
+msgstr "Voherige anzeigen"
+
+#: UI/GTK2/src/IndexPage.cpp:57
+msgid "Show Next"
+msgstr "N?chste anzeigen"
+
+#: UI/GTK2/src/IndexPage.cpp:150 UI/GTK2/src/IndexPage.cpp:188
+msgid "All labels"
+msgstr ""
+
+#: UI/GTK2/src/launcherDialog_glade.cc:64
+msgid ""
+"There is no helper application defined for this document's type.\n"
+"Please enter the command to open this document."
+msgstr ""
+"F?r diesen Dokumententyp ist keine Anwendung definiert.\n"
+"Bitte geben Sie den Befehl ein, mit dem das Dokument ge?ffnet werden soll."
+
+#: UI/GTK2/src/launcherDialog_glade.cc:67
+msgid "Use this command for other documents of the same type."
+msgstr ""
+
+#: UI/GTK2/src/launcherDialog_glade.cc:99
+msgid "Helper application"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:141
+msgid "Query Name"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:146
+msgid "Last Run"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:151
+msgid "Summary"
+msgstr ""
+
+#. Set tooltips
+#: UI/GTK2/src/mainWindow.cc:184
+msgid "Show all search engines"
+msgstr "Alle Suchmaschinen anzeigen"
+
+#: UI/GTK2/src/mainWindow.cc:185
+msgid "Add index"
+msgstr "Index hinzuf?gen"
+
+#: UI/GTK2/src/mainWindow.cc:186
+msgid "Remove index"
+msgstr "Index entfernen"
+
+#. Now we are ready
+#: UI/GTK2/src/mainWindow.cc:192
+msgid "Ready"
+msgstr "Bereit"
+
+#: UI/GTK2/src/mainWindow.cc:243
+msgid "N/A"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:258
+msgid "Undefined"
+msgstr "Unbestimmt"
+
+#. Show the URL of the first result in the status bar
+#: UI/GTK2/src/mainWindow.cc:476
+msgid "Result location is"
+msgstr ""
+
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:551
+msgid "Document location is"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:877
+msgid "Showing"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:882
+msgid "of"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:887
+msgid "documents, starting at"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:920
+msgid "Query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+msgid "on"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:928
+msgid "ended"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1053
+msgid "More Like"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1114
+msgid "Updated label(s)"
+msgstr ""
+
+#. Yes, it did
+#: UI/GTK2/src/mainWindow.cc:1198
+msgid "Updated document"
+msgstr "Dokument aktualisiert"
+
+#: UI/GTK2/src/mainWindow.cc:1211
+msgid "Indexed"
+msgstr "Indiziert"
+
+#: UI/GTK2/src/mainWindow.cc:1254
+msgid "Unindexed document(s)"
+msgstr "Nicht indizierte(s) Dokument(e)"
+
+#: UI/GTK2/src/mainWindow.cc:1295
+msgid "Updated document properties"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1348
+msgid "Couldn't rename index, name"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
+#: UI/GTK2/src/mainWindow.cc:2755
+msgid "is already in use"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1365
+msgid "Couldn't rename index"
+msgstr "Index konnte nicht umbenannt werden"
+
+#: UI/GTK2/src/mainWindow.cc:1378
+msgid "Edited index"
+msgstr ""
+
+#. Find this query
+#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+msgid "Live query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1780
+msgid "Couldn't find query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/WorkerThreads.cpp:1625
+msgid "Index"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/WorkerThreads.cpp:1629
+msgid "doesn't exist"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2131
+msgid "Remove this document from the index ?"
+msgstr "Dieses Dokument aus dem Index entfernen"
+
+#: UI/GTK2/src/mainWindow.cc:2150
+msgid "Remove these documents from the index ?"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2194
+msgid "A metasearch tool for the Free Desktop"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2195
+msgid "Search the Web and your documents !"
+msgstr "Durchsuchen Sie das Internet und Ihre Dokumente !"
+
+#: UI/GTK2/src/mainWindow.cc:2196
+msgid "(C) 2005 Fabrice Colin"
+msgstr "(C) 2005 Fabrice Colin"
+
+#: UI/GTK2/src/mainWindow.cc:2240
+msgid "Index name"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2255
+msgid "Couldn't add index"
+msgstr "Konnte Index nicht hinzuf?gen"
+
+#: UI/GTK2/src/mainWindow.cc:2269
+msgid "Added new index"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2304
+msgid "Couldn't remove index"
+msgstr "Konnte Index nicht entfernen"
+
+#: UI/GTK2/src/mainWindow.cc:2569
+msgid "At least one task hasn't completed yet. Quit now ?"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2751
+msgid "Query name"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2778
+msgid "Couldn't update query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2786
+msgid "Edited query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2793
+msgid "Couldn't add query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2801
+msgid "Added new query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2814
+msgid "Query is not set"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2825
+msgid "No search engine selected"
+msgstr "Keine Suchmaschine ausgew?hlt"
+
+#: UI/GTK2/src/mainWindow.cc:2912
+msgid "Please set the Google API key first"
+msgstr "Bitte geben Sie zuerst den Google API-Schl?ssel ein"
+
+#: UI/GTK2/src/mainWindow.cc:2921
+msgid "Running query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:3105
+msgid "No default application defined for type"
+msgstr "Keine Standardanwendung f?r Typ angegeben"
+
+#: UI/GTK2/src/mainWindow_glade.cc:125
+msgid "Query:"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:137
+msgid "Edit"
+msgstr "Bearbeiten"
+
+#: UI/GTK2/src/mainWindow_glade.cc:146
+msgid "Stored queries"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:50
+#: UI/GTK2/src/statisticsDialog_glade.cc:87
+msgid "Status"
+msgstr "Status"
+
+#: UI/GTK2/src/mainWindow_glade.cc:184
+msgid "Search Engine"
+msgstr "Suchmaschine"
+
+#: UI/GTK2/src/mainWindow_glade.cc:187
+msgid "Host Name"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:190
+msgid "Show Extract"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:193
+msgid "Group By"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:196
+msgid "Clear List"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:202
+msgid "Vie_w"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:205
+msgid "View Cache"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:208
+msgid "More Like This"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:211 UI/GTK2/src/mainWindow_glade.cc:247
+msgid "_Index"
+msgstr "_Index"
+
+#: UI/GTK2/src/mainWindow_glade.cc:214
+msgid "List Contents Of"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:223
+msgid "View"
+msgstr "Ansicht"
+
+#: UI/GTK2/src/mainWindow_glade.cc:226
+msgid "Update"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:229
+msgid "Unindex"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:232
+#: UI/GTK2/src/propertiesDialog_glade.cc:177
+msgid "Properties"
+msgstr "Eigenschaften"
+
+#: UI/GTK2/src/mainWindow_glade.cc:235
+msgid "_About"
+msgstr "_?ber"
+
+#: UI/GTK2/src/mainWindow_glade.cc:238
+msgid "_Session"
+msgstr "_Sitzung"
+
+#: UI/GTK2/src/mainWindow_glade.cc:241
+msgid "_Edit"
+msgstr "_Bearbeiten"
+
+#: UI/GTK2/src/mainWindow_glade.cc:244
+msgid "_Results"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:250
+msgid "_Help"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:387
+msgid "Pinot"
+msgstr ""
+
+#. Localize language names
+#: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
+msgid "Unknown"
+msgstr ""
+
+#: UI/GTK2/src/pinot.cc:227 UI/GTK2/src/pinot-dbus-daemon.cc:294
+msgid "Danish"
+msgstr ""
+
+#: UI/GTK2/src/pinot.cc:228 UI/GTK2/src/pinot-dbus-daemon.cc:295
+msgid "Dutch"
+msgstr ""
+
+#: UI/GTK2/src/pinot.cc:229 UI/GTK2/src/pinot-dbus-daemon.cc:296
+msgid "English"
+msgstr "Englisch"
+
+#: UI/GTK2/src/pinot.cc:230 UI/GTK2/src/pinot-dbus-daemon.cc:297
+msgid "Finnish"
+msgstr "Finnisch"
+
+#: UI/GTK2/src/pinot.cc:231 UI/GTK2/src/pinot-dbus-daemon.cc:298
+msgid "French"
+msgstr "Franz?sisch"
+
+#: UI/GTK2/src/pinot.cc:232 UI/GTK2/src/pinot-dbus-daemon.cc:299
+msgid "German"
+msgstr "Deutsch"
+
+#: UI/GTK2/src/pinot.cc:233 UI/GTK2/src/pinot-dbus-daemon.cc:300
+msgid "Italian"
+msgstr "Italienisch"
+
+#: UI/GTK2/src/pinot.cc:234 UI/GTK2/src/pinot-dbus-daemon.cc:301
+msgid "Norwegian"
+msgstr "Norwegisch"
+
+#: UI/GTK2/src/pinot.cc:235 UI/GTK2/src/pinot-dbus-daemon.cc:302
+msgid "Portuguese"
+msgstr "Portugiesisch"
+
+#: UI/GTK2/src/pinot.cc:236 UI/GTK2/src/pinot-dbus-daemon.cc:303
+msgid "Russian"
+msgstr "Russisch"
+
+#: UI/GTK2/src/pinot.cc:237 UI/GTK2/src/pinot-dbus-daemon.cc:304
+msgid "Spanish"
+msgstr "Spanisch"
+
+#: UI/GTK2/src/pinot.cc:238 UI/GTK2/src/pinot-dbus-daemon.cc:305
+msgid "Swedish"
+msgstr "Schwedisch"
+
+#: UI/GTK2/src/pinot.cc:263
+msgid "Couldn't open index"
+msgstr ""
+
+#: UI/GTK2/src/pinot.cc:279
+msgid "Couldn't create history database"
+msgstr ""
+
+#. Yes, it is
+#. FIXME: use a popup !
+#: UI/GTK2/src/pinot.cc:309
+msgid "Updating all documents in My Web Pages is recommended"
+msgstr ""
+
+#. Add default labels
+#: UI/GTK2/src/PinotSettings.cpp:249
+msgid "Important"
+msgstr ""
+
+#: UI/GTK2/src/PinotSettings.cpp:250
+msgid "New"
+msgstr ""
+
+#: UI/GTK2/src/PinotSettings.cpp:251
+msgid "Personal"
+msgstr ""
+
+#: UI/GTK2/src/PinotSettings.cpp:1141
+msgid "Unclassified"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:82
+msgid "Name"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:90
+msgid "Monitor"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:91 UI/GTK2/src/prefsDialog.cc:99
+msgid "Location"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:107
+msgid "Pattern"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:471
+msgid "New Label"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:512
+msgid "Directory to index"
+msgstr "Zu indizierendes Verzeichnis"
+
+#: UI/GTK2/src/prefsDialog.cc:570
+msgid "Mbox File Location"
+msgstr "Ort der Mbox-Datei"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:66
+msgid "Google API key:"
+msgstr "Google API-Schl?ssel:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:69
+msgid "New results:"
+msgstr "Neue Ergebnisse:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:70
+msgid "Queries:"
+msgstr "Abfragen:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:71
+msgid "Enable search terms suggestion"
+msgstr "Aktiviere Suchwortvorschl?ge"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:73
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "robots.txt und Robots META-Tag ignorieren"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "HTTP crawling:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
+msgid "General"
+msgstr "Allgemein"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:79
+msgid "Direct connection to the Internet"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80
+msgid "Manual proxy configuration:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:93
+msgid "Network"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:94
+msgid "Labels are used to classify indexed documents:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
+#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+msgid "Add"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:105
+msgid "Remove"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:113
+msgid "Labels"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:114
+msgid "These directories will be indexed and optionally monitored for changes:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:127
+msgid "Mail boxes of type mbox can be monitored and indexed:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:140
+msgid "Specify any file pattern you wish to exclude from indexing:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:154
+msgid "Indexing"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:566
+msgid "Preferences"
+msgstr "Einstellungen"
+
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:124
+msgid "Label"
+msgstr ""
+
+#: UI/GTK2/src/propertiesDialog.cc:81
+msgid "Per document"
+msgstr "Pro Dokument"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:68
+msgid "Language:"
+msgstr "Sprache:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:69
+msgid "MIME type:"
+msgstr "MIME-Typ:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:70
+msgid "Size:"
+msgstr "Gr??e"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:73
+msgid "Terms:"
+msgstr ""
+
+#. All supported filters
+#: UI/GTK2/src/queryDialog.cc:116
+msgid "Host name"
+msgstr "Rechnername"
+
+#: UI/GTK2/src/queryDialog.cc:117
+msgid "File name"
+msgstr "Dateiname"
+
+#: UI/GTK2/src/queryDialog.cc:118
+msgid "File extension"
+msgstr "Dateiendung"
+
+#: UI/GTK2/src/queryDialog.cc:121
+msgid "Directory"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog.cc:122
+msgid "Language code"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog.cc:123
+msgid "MIME type"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog.cc:237
+msgid "Start date"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog.cc:252
+msgid "End date"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:72
+msgid "New filter:"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:81
+msgid "Query Text"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:83
+msgid "Index results with label"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:86
+msgid "Number of results:"
+msgstr "Anzahl der Ergebnisse:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:89
+msgid "Start date:"
+msgstr "Anfangsdatum:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:90
+msgid "End date:"
+msgstr "Enddatum:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:201
+msgid "Query parameters"
+msgstr ""
+
+#. This is the score column
+#: UI/GTK2/src/ResultsTree.cpp:117
+#, fuzzy
+msgid "Score"
+msgstr "Relevanz"
+
+#: UI/GTK2/src/ResultsTree.cpp:174
+msgid "Extract"
+msgstr "Auslesen"
+
+#: UI/GTK2/src/statisticsDialog.cc:72
+#, fuzzy
+msgid "Indexes"
+msgstr "Indizes"
+
+#: UI/GTK2/src/statisticsDialog.cc:87
+#, fuzzy
+msgid "History"
+msgstr "Historie"
+
+#: UI/GTK2/src/statisticsDialog.cc:92
+msgid "Daemon"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
+msgid "documents"
+msgstr "Dokumente"
+
+#: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
+msgid "Unknown error"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:154
+#, fuzzy
+msgid "Viewed"
+msgstr "Angesehen"
+
+#: UI/GTK2/src/statisticsDialog.cc:154
+msgid "results"
+msgstr ""
+
+#. FIXME: check whether it's actually running !
+#: UI/GTK2/src/statisticsDialog.cc:171
+msgid "Running under PID"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:175
+msgid "Currently not running"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:182
+msgid "Crawled"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:182
+msgid "files"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:205
+msgid "Errors"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:302
+msgid "Can't index mail here"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:323
+msgid "is already being indexed"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:333
+msgid "is blacklisted"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:642 UI/GTK2/src/WorkerThreads.cpp:955
+#: UI/GTK2/src/WorkerThreads.cpp:1040 UI/GTK2/src/WorkerThreads.cpp:1049
+#: UI/GTK2/src/WorkerThreads.cpp:1235 UI/GTK2/src/WorkerThreads.cpp:1505
+#: UI/GTK2/src/WorkerThreads.cpp:1638
+msgid "Index error on"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:765 UI/GTK2/src/WorkerThreads.cpp:976
+msgid "Couldn't create search engine"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:791 UI/GTK2/src/WorkerThreads.cpp:990
+msgid "Couldn't run query on search engine"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:835
+msgid "No title"
+msgstr "Kein Titel"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1143
+msgid "Couldn't obtain downloader for protocol"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1168
+msgid "Couldn't retrieve"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1265 UI/GTK2/src/WorkerThreads.cpp:1344
+msgid "Cannot index document type"
+msgstr "Kann Dokumenttyp nicht indizieren"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1269 UI/GTK2/src/WorkerThreads.cpp:1348
+msgid "at"
+msgstr ""
+
+#. No, it isn't
+#: UI/GTK2/src/WorkerThreads.cpp:1380
+msgid "Robots META tag forbids indexing"
+msgstr "Robots META-Tag verbietet das Indizieren"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1434
+msgid "Couldn't index"
+msgstr ""
+
+#. Be pessimistic and assume something will go wrong ;-)
+#: UI/GTK2/src/WorkerThreads.cpp:1516
+msgid "Couldn't unindex document(s)"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1650
+msgid "Couldn't update document"
+msgstr ""
+
+#~ msgid "Host name:"
+#~ msgstr "Rechnername:"

Added: trunk/po/it.po
===================================================================
--- trunk/po/it.po	2007-03-24 07:04:10 UTC (rev 789)
+++ trunk/po/it.po	2007-03-24 07:28:21 UTC (rev 790)
@@ -0,0 +1,873 @@
+# Italian translation for pinot
+# Copyright (c) 2006 Rosetta Contributors and Canonical Ltd 2006
+# This file is distributed under the same license as the pinot package.
+# FIRST AUTHOR <EMAIL at ADDRESS>, 2006.
+#
+#, fuzzy
+msgid ""
+msgstr ""
+"Project-Id-Version: pinot\n"
+"Report-Msgid-Bugs-To: \n"
+"POT-Creation-Date: 2007-03-24 00:44+0800\n"
+"PO-Revision-Date: 2006-11-17 13:20+0000\n"
+"Last-Translator: Michele Angrisano <darksun1988 at gmail.com>\n"
+"Language-Team: Italian <it at li.org>\n"
+"MIME-Version: 1.0\n"
+"Content-Type: text/plain; charset=UTF-8\n"
+"Content-Transfer-Encoding: 8bit\n"
+"X-Rosetta-Export-Date: 2007-03-24 04:08+0000\n"
+
+#: UI/GTK2/src/EnginesTree.cpp:70
+msgid "Search Engines"
+msgstr "Motore di ricerca"
+
+#: UI/GTK2/src/EnginesTree.cpp:328
+msgid "Current User"
+msgstr "User attuale"
+
+#. Bind the callback's parameter to the index name
+#. Enable these menu items unless it is not the documents index
+#. Internal indices
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
+#: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
+#: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
+#: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
+#: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
+msgid "My Web Pages"
+msgstr "Mia pagine web"
+
+#. Populate the submenu
+#. Bind the callback's parameter to the index name
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
+#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
+#: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
+#: UI/GTK2/src/PinotSettings.cpp:1402 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:818 UI/GTK2/src/WorkerThreads.cpp:882
+msgid "My Documents"
+msgstr "Miei Documenti"
+
+#. The last column is for the timestamp
+#: UI/GTK2/src/dateDialog_glade.cc:76 UI/GTK2/src/queryDialog_glade.cc:91
+#: UI/GTK2/src/queryDialog_glade.cc:92 UI/GTK2/src/ResultsTree.cpp:145
+msgid "Date"
+msgstr ""
+
+#: UI/GTK2/src/indexDialog.cc:122
+msgid "Served by"
+msgstr ""
+
+#: UI/GTK2/src/indexDialog.cc:124
+msgid "Local"
+msgstr ""
+
+#: UI/GTK2/src/indexDialog.cc:286
+msgid "Index location"
+msgstr "Indice di posizione"
+
+#: UI/GTK2/src/indexDialog_glade.cc:65 UI/GTK2/src/queryDialog_glade.cc:68
+msgid "Name:"
+msgstr "Nome:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:67
+msgid "..."
+msgstr "..."
+
+#: UI/GTK2/src/indexDialog_glade.cc:70 UI/GTK2/src/prefsDialog_glade.cc:85
+msgid "Type:"
+msgstr "Tipo:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:71 UI/GTK2/src/importDialog_glade.cc:67
+msgid "Location:"
+msgstr "Posizione:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:72 UI/GTK2/src/prefsDialog_glade.cc:86
+msgid "Port:"
+msgstr "Porta:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
+msgid "Address:"
+msgstr ""
+
+#: UI/GTK2/src/indexDialog_glade.cc:183
+msgid "External index"
+msgstr "Indice esterno"
+
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:98
+msgid "None"
+msgstr "Nessuno"
+
+#: UI/GTK2/src/importDialog_glade.cc:68
+#: UI/GTK2/src/propertiesDialog_glade.cc:67
+msgid "Title:"
+msgstr "Titolo:"
+
+#: UI/GTK2/src/importDialog_glade.cc:71
+msgid "Apply label:"
+msgstr "Applica descrizione"
+
+#: UI/GTK2/src/importDialog_glade.cc:77
+msgid "Import"
+msgstr "Importare"
+
+#: UI/GTK2/src/importDialog_glade.cc:148 UI/GTK2/src/mainWindow_glade.cc:217
+msgid "Import URL"
+msgstr "Importare URL"
+
+#. The score column is used for status icons
+#. This is the title column
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:119
+#: UI/GTK2/src/ResultsTree.cpp:127
+msgid "Title"
+msgstr "Titolo"
+
+#. URL
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:120
+#: UI/GTK2/src/ResultsTree.cpp:137
+msgid "URL"
+msgstr "URL"
+
+#: UI/GTK2/src/IndexTree.cpp:78
+msgid "Timestamp"
+msgstr "Timestamp"
+
+#: UI/GTK2/src/IndexPage.cpp:51
+msgid "Show Previous"
+msgstr "Dimostrazione Precedente"
+
+#: UI/GTK2/src/IndexPage.cpp:57
+msgid "Show Next"
+msgstr "Prossima dimostrazione"
+
+#: UI/GTK2/src/IndexPage.cpp:150 UI/GTK2/src/IndexPage.cpp:188
+msgid "All labels"
+msgstr "Tutte le descrizioni"
+
+#: UI/GTK2/src/launcherDialog_glade.cc:64
+msgid ""
+"There is no helper application defined for this document's type.\n"
+"Please enter the command to open this document."
+msgstr ""
+
+#: UI/GTK2/src/launcherDialog_glade.cc:67
+msgid "Use this command for other documents of the same type."
+msgstr ""
+
+#: UI/GTK2/src/launcherDialog_glade.cc:99
+msgid "Helper application"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:141
+msgid "Query Name"
+msgstr "Nome da interrogare"
+
+#: UI/GTK2/src/mainWindow.cc:146
+msgid "Last Run"
+msgstr "Prossima corsa"
+
+#: UI/GTK2/src/mainWindow.cc:151
+msgid "Summary"
+msgstr "Sommario"
+
+#. Set tooltips
+#: UI/GTK2/src/mainWindow.cc:184
+msgid "Show all search engines"
+msgstr "Mostrare tutti i motori di ricerca"
+
+#: UI/GTK2/src/mainWindow.cc:185
+msgid "Add index"
+msgstr "Indice da aggiungere"
+
+#: UI/GTK2/src/mainWindow.cc:186
+msgid "Remove index"
+msgstr "Rimuovere indice"
+
+#. Now we are ready
+#: UI/GTK2/src/mainWindow.cc:192
+msgid "Ready"
+msgstr "Pronto"
+
+#: UI/GTK2/src/mainWindow.cc:243
+msgid "N/A"
+msgstr "N/A"
+
+#: UI/GTK2/src/mainWindow.cc:258
+msgid "Undefined"
+msgstr ""
+
+#. Show the URL of the first result in the status bar
+#: UI/GTK2/src/mainWindow.cc:476
+msgid "Result location is"
+msgstr "Il risultato della posizione ?"
+
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:551
+msgid "Document location is"
+msgstr "La posizione Document ?"
+
+#: UI/GTK2/src/mainWindow.cc:877
+msgid "Showing"
+msgstr "Dimostrazione"
+
+#: UI/GTK2/src/mainWindow.cc:882
+msgid "of"
+msgstr "dei"
+
+#: UI/GTK2/src/mainWindow.cc:887
+msgid "documents, starting at"
+msgstr "documenti, inizio a"
+
+#: UI/GTK2/src/mainWindow.cc:920
+msgid "Query"
+msgstr "Query"
+
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+msgid "on"
+msgstr "sulla"
+
+#: UI/GTK2/src/mainWindow.cc:928
+msgid "ended"
+msgstr "conclusione"
+
+#: UI/GTK2/src/mainWindow.cc:1053
+msgid "More Like"
+msgstr "Molti gradiscono"
+
+#: UI/GTK2/src/mainWindow.cc:1114
+msgid "Updated label(s)"
+msgstr "Descrizione(i) aggiornata"
+
+#. Yes, it did
+#: UI/GTK2/src/mainWindow.cc:1198
+msgid "Updated document"
+msgstr "Documento aggiornato"
+
+#: UI/GTK2/src/mainWindow.cc:1211
+msgid "Indexed"
+msgstr "Indice"
+
+#: UI/GTK2/src/mainWindow.cc:1254
+msgid "Unindexed document(s)"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1295
+msgid "Updated document properties"
+msgstr "Propriet? documento aggiornata"
+
+#: UI/GTK2/src/mainWindow.cc:1348
+msgid "Couldn't rename index, name"
+msgstr "Impossibile rinominare l'indice, nome"
+
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
+#: UI/GTK2/src/mainWindow.cc:2755
+msgid "is already in use"
+msgstr "? ora in uso"
+
+#: UI/GTK2/src/mainWindow.cc:1365
+msgid "Couldn't rename index"
+msgstr "Impossibile rinominare l'indice"
+
+#: UI/GTK2/src/mainWindow.cc:1378
+msgid "Edited index"
+msgstr "Indice modificato"
+
+#. Find this query
+#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+msgid "Live query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1780
+msgid "Couldn't find query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/WorkerThreads.cpp:1625
+msgid "Index"
+msgstr "Indice"
+
+#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/WorkerThreads.cpp:1629
+msgid "doesn't exist"
+msgstr "non esiste"
+
+#: UI/GTK2/src/mainWindow.cc:2131
+msgid "Remove this document from the index ?"
+msgstr "Rimuovere questo documento dall'indice?"
+
+#: UI/GTK2/src/mainWindow.cc:2150
+msgid "Remove these documents from the index ?"
+msgstr "Rimuovere questi documenti dall'indice?"
+
+#: UI/GTK2/src/mainWindow.cc:2194
+msgid "A metasearch tool for the Free Desktop"
+msgstr "Un tool metasearch per il Free Desktop"
+
+#: UI/GTK2/src/mainWindow.cc:2195
+msgid "Search the Web and your documents !"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2196
+msgid "(C) 2005 Fabrice Colin"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2240
+msgid "Index name"
+msgstr "Nome indice"
+
+#: UI/GTK2/src/mainWindow.cc:2255
+msgid "Couldn't add index"
+msgstr "Impossibile aggiungere l'indice"
+
+#: UI/GTK2/src/mainWindow.cc:2269
+msgid "Added new index"
+msgstr "Nuovo indice aggiunto"
+
+#: UI/GTK2/src/mainWindow.cc:2304
+msgid "Couldn't remove index"
+msgstr "Impossibile rimuovere l'indice"
+
+#: UI/GTK2/src/mainWindow.cc:2569
+msgid "At least one task hasn't completed yet. Quit now ?"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2751
+msgid "Query name"
+msgstr "Nome Query"
+
+#: UI/GTK2/src/mainWindow.cc:2778
+msgid "Couldn't update query"
+msgstr "Impossibile aggiornare il query"
+
+#: UI/GTK2/src/mainWindow.cc:2786
+msgid "Edited query"
+msgstr "Query modificato"
+
+#: UI/GTK2/src/mainWindow.cc:2793
+msgid "Couldn't add query"
+msgstr "Impossibile aggiungere il query"
+
+#: UI/GTK2/src/mainWindow.cc:2801
+msgid "Added new query"
+msgstr "Nuovo query aggiunto"
+
+#: UI/GTK2/src/mainWindow.cc:2814
+msgid "Query is not set"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2825
+msgid "No search engine selected"
+msgstr "Nessun motore di ricerca selezionato"
+
+#: UI/GTK2/src/mainWindow.cc:2912
+msgid "Please set the Google API key first"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2921
+msgid "Running query"
+msgstr "Avviare query"
+
+#: UI/GTK2/src/mainWindow.cc:3105
+msgid "No default application defined for type"
+msgstr "Nessuna applicazione di default ? stata definita per tipo"
+
+#: UI/GTK2/src/mainWindow_glade.cc:125
+msgid "Query:"
+msgstr "Query:"
+
+#: UI/GTK2/src/mainWindow_glade.cc:137
+msgid "Edit"
+msgstr "Modifica"
+
+#: UI/GTK2/src/mainWindow_glade.cc:146
+msgid "Stored queries"
+msgstr "Queries conservati"
+
+#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:50
+#: UI/GTK2/src/statisticsDialog_glade.cc:87
+msgid "Status"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:184
+msgid "Search Engine"
+msgstr "Motore di ricerca"
+
+#: UI/GTK2/src/mainWindow_glade.cc:187
+msgid "Host Name"
+msgstr "Nome Host"
+
+#: UI/GTK2/src/mainWindow_glade.cc:190
+msgid "Show Extract"
+msgstr "Mostrare l'estratto"
+
+#: UI/GTK2/src/mainWindow_glade.cc:193
+msgid "Group By"
+msgstr "Gruppo da"
+
+#: UI/GTK2/src/mainWindow_glade.cc:196
+msgid "Clear List"
+msgstr "Cancellare lista"
+
+#: UI/GTK2/src/mainWindow_glade.cc:202
+msgid "Vie_w"
+msgstr "Vedere"
+
+#: UI/GTK2/src/mainWindow_glade.cc:205
+msgid "View Cache"
+msgstr "Vedere Cache"
+
+#: UI/GTK2/src/mainWindow_glade.cc:208
+msgid "More Like This"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:211 UI/GTK2/src/mainWindow_glade.cc:247
+msgid "_Index"
+msgstr "_Indice"
+
+#: UI/GTK2/src/mainWindow_glade.cc:214
+msgid "List Contents Of"
+msgstr "Lista contenuti di"
+
+#: UI/GTK2/src/mainWindow_glade.cc:223
+msgid "View"
+msgstr "Vedere"
+
+#: UI/GTK2/src/mainWindow_glade.cc:226
+msgid "Update"
+msgstr "Aggiornare"
+
+#: UI/GTK2/src/mainWindow_glade.cc:229
+msgid "Unindex"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:232
+#: UI/GTK2/src/propertiesDialog_glade.cc:177
+msgid "Properties"
+msgstr "Propriet?"
+
+#: UI/GTK2/src/mainWindow_glade.cc:235
+msgid "_About"
+msgstr "_About"
+
+#: UI/GTK2/src/mainWindow_glade.cc:238
+msgid "_Session"
+msgstr "_Sessione"
+
+#: UI/GTK2/src/mainWindow_glade.cc:241
+msgid "_Edit"
+msgstr "_Modifica"
+
+#: UI/GTK2/src/mainWindow_glade.cc:244
+msgid "_Results"
+msgstr "_Risultati"
+
+#: UI/GTK2/src/mainWindow_glade.cc:250
+msgid "_Help"
+msgstr "_Aiuto"
+
+#: UI/GTK2/src/mainWindow_glade.cc:387
+msgid "Pinot"
+msgstr "Pinot"
+
+#. Localize language names
+#: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
+msgid "Unknown"
+msgstr "Sconosciuto"
+
+#: UI/GTK2/src/pinot.cc:227 UI/GTK2/src/pinot-dbus-daemon.cc:294
+msgid "Danish"
+msgstr "Danese"
+
+#: UI/GTK2/src/pinot.cc:228 UI/GTK2/src/pinot-dbus-daemon.cc:295
+msgid "Dutch"
+msgstr "Olandese"
+
+#: UI/GTK2/src/pinot.cc:229 UI/GTK2/src/pinot-dbus-daemon.cc:296
+msgid "English"
+msgstr "Inglese"
+
+#: UI/GTK2/src/pinot.cc:230 UI/GTK2/src/pinot-dbus-daemon.cc:297
+msgid "Finnish"
+msgstr "Finlandese"
+
+#: UI/GTK2/src/pinot.cc:231 UI/GTK2/src/pinot-dbus-daemon.cc:298
+msgid "French"
+msgstr "Francese"
+
+#: UI/GTK2/src/pinot.cc:232 UI/GTK2/src/pinot-dbus-daemon.cc:299
+msgid "German"
+msgstr "Tedesco"
+
+#: UI/GTK2/src/pinot.cc:233 UI/GTK2/src/pinot-dbus-daemon.cc:300
+msgid "Italian"
+msgstr "Italiano"
+
+#: UI/GTK2/src/pinot.cc:234 UI/GTK2/src/pinot-dbus-daemon.cc:301
+msgid "Norwegian"
+msgstr "Norvegese"
+
+#: UI/GTK2/src/pinot.cc:235 UI/GTK2/src/pinot-dbus-daemon.cc:302
+msgid "Portuguese"
+msgstr "Portoghese"
+
+#: UI/GTK2/src/pinot.cc:236 UI/GTK2/src/pinot-dbus-daemon.cc:303
+msgid "Russian"
+msgstr "Russo"
+
+#: UI/GTK2/src/pinot.cc:237 UI/GTK2/src/pinot-dbus-daemon.cc:304
+msgid "Spanish"
+msgstr "Spagnolo"
+
+#: UI/GTK2/src/pinot.cc:238 UI/GTK2/src/pinot-dbus-daemon.cc:305
+msgid "Swedish"
+msgstr "Svedese"
+
+#: UI/GTK2/src/pinot.cc:263
+msgid "Couldn't open index"
+msgstr "Impossibile aprire l'indice"
+
+#: UI/GTK2/src/pinot.cc:279
+msgid "Couldn't create history database"
+msgstr "Impossibile creare un history del database"
+
+#. Yes, it is
+#. FIXME: use a popup !
+#: UI/GTK2/src/pinot.cc:309
+msgid "Updating all documents in My Web Pages is recommended"
+msgstr ""
+
+#. Add default labels
+#: UI/GTK2/src/PinotSettings.cpp:249
+msgid "Important"
+msgstr "Importante"
+
+#: UI/GTK2/src/PinotSettings.cpp:250
+msgid "New"
+msgstr "Nuovo"
+
+#: UI/GTK2/src/PinotSettings.cpp:251
+msgid "Personal"
+msgstr "Personale"
+
+#: UI/GTK2/src/PinotSettings.cpp:1141
+msgid "Unclassified"
+msgstr "Non classificato"
+
+#: UI/GTK2/src/prefsDialog.cc:82
+msgid "Name"
+msgstr "Nome"
+
+#: UI/GTK2/src/prefsDialog.cc:90
+msgid "Monitor"
+msgstr "Monitor"
+
+#: UI/GTK2/src/prefsDialog.cc:91 UI/GTK2/src/prefsDialog.cc:99
+msgid "Location"
+msgstr "Posizione"
+
+#: UI/GTK2/src/prefsDialog.cc:107
+msgid "Pattern"
+msgstr "Motivo"
+
+#: UI/GTK2/src/prefsDialog.cc:471
+msgid "New Label"
+msgstr "Nuova descrizione"
+
+#: UI/GTK2/src/prefsDialog.cc:512
+msgid "Directory to index"
+msgstr "Directory per l'indice"
+
+#: UI/GTK2/src/prefsDialog.cc:570
+msgid "Mbox File Location"
+msgstr "Mbox File Locationc"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:66
+msgid "Google API key:"
+msgstr "Chiave Google API:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:69
+msgid "New results:"
+msgstr "Nuovi risultati:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:70
+msgid "Queries:"
+msgstr "Queries:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:71
+msgid "Enable search terms suggestion"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:73
+msgid "Ignore robots.txt and Robots META tag"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "HTTP crawling:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
+msgid "General"
+msgstr "Generale"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:79
+msgid "Direct connection to the Internet"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80
+msgid "Manual proxy configuration:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:93
+msgid "Network"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:94
+msgid "Labels are used to classify indexed documents:"
+msgstr "Le descrizioni sono usate per classificare l'indice dei documenti:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
+#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+msgid "Add"
+msgstr "Aggiungere"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:105
+msgid "Remove"
+msgstr "Rimuovere"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:113
+msgid "Labels"
+msgstr "Descrizioni"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:114
+msgid "These directories will be indexed and optionally monitored for changes:"
+msgstr ""
+"Queste directories devono essere indicizzate e opzionalmente monitorate per "
+"cambiamenti:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:127
+msgid "Mail boxes of type mbox can be monitored and indexed:"
+msgstr ""
+"Le boxe delle Mail di tipo mbox possono essere monitorate e indicizzate:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:140
+msgid "Specify any file pattern you wish to exclude from indexing:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:154
+msgid "Indexing"
+msgstr "Indicizzando"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:566
+msgid "Preferences"
+msgstr "Preferenze"
+
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:124
+msgid "Label"
+msgstr "Descrizione"
+
+#: UI/GTK2/src/propertiesDialog.cc:81
+msgid "Per document"
+msgstr "Per documento"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:68
+msgid "Language:"
+msgstr "Lingua:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:69
+msgid "MIME type:"
+msgstr "Tipo MIME:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:70
+msgid "Size:"
+msgstr ""
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:73
+msgid "Terms:"
+msgstr ""
+
+#. All supported filters
+#: UI/GTK2/src/queryDialog.cc:116
+msgid "Host name"
+msgstr "Nome host"
+
+#: UI/GTK2/src/queryDialog.cc:117
+msgid "File name"
+msgstr "Nome file"
+
+#: UI/GTK2/src/queryDialog.cc:118
+msgid "File extension"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog.cc:121
+msgid "Directory"
+msgstr "Directory"
+
+#: UI/GTK2/src/queryDialog.cc:122
+msgid "Language code"
+msgstr "Codice di linguaggio"
+
+#: UI/GTK2/src/queryDialog.cc:123
+msgid "MIME type"
+msgstr "Tipo MIME"
+
+#: UI/GTK2/src/queryDialog.cc:237
+msgid "Start date"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog.cc:252
+msgid "End date"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:72
+msgid "New filter:"
+msgstr "Nuovo filtro:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:81
+msgid "Query Text"
+msgstr "Testo Query"
+
+#: UI/GTK2/src/queryDialog_glade.cc:83
+msgid "Index results with label"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:86
+msgid "Number of results:"
+msgstr "Numero di risultati:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:89
+msgid "Start date:"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:90
+msgid "End date:"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:201
+msgid "Query parameters"
+msgstr "Parametri Querys"
+
+#. This is the score column
+#: UI/GTK2/src/ResultsTree.cpp:117
+msgid "Score"
+msgstr "Valutazione"
+
+#: UI/GTK2/src/ResultsTree.cpp:174
+msgid "Extract"
+msgstr "Estrarre"
+
+#: UI/GTK2/src/statisticsDialog.cc:72
+msgid "Indexes"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:87
+msgid "History"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:92
+msgid "Daemon"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
+msgid "documents"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
+#, fuzzy
+msgid "Unknown error"
+msgstr "Sconosciuto"
+
+#: UI/GTK2/src/statisticsDialog.cc:154
+msgid "Viewed"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:154
+msgid "results"
+msgstr ""
+
+#. FIXME: check whether it's actually running !
+#: UI/GTK2/src/statisticsDialog.cc:171
+msgid "Running under PID"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:175
+msgid "Currently not running"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:182
+msgid "Crawled"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:182
+msgid "files"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:205
+msgid "Errors"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:302
+msgid "Can't index mail here"
+msgstr "Impossibile indicizzare la mail qui"
+
+#: UI/GTK2/src/WorkerThreads.cpp:323
+msgid "is already being indexed"
+msgstr "? ora stato indicizzato"
+
+#: UI/GTK2/src/WorkerThreads.cpp:333
+msgid "is blacklisted"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:642 UI/GTK2/src/WorkerThreads.cpp:955
+#: UI/GTK2/src/WorkerThreads.cpp:1040 UI/GTK2/src/WorkerThreads.cpp:1049
+#: UI/GTK2/src/WorkerThreads.cpp:1235 UI/GTK2/src/WorkerThreads.cpp:1505
+#: UI/GTK2/src/WorkerThreads.cpp:1638
+msgid "Index error on"
+msgstr "Indice errori su"
+
+#: UI/GTK2/src/WorkerThreads.cpp:765 UI/GTK2/src/WorkerThreads.cpp:976
+msgid "Couldn't create search engine"
+msgstr "Impossibile creare un motore di ricerca"
+
+#: UI/GTK2/src/WorkerThreads.cpp:791 UI/GTK2/src/WorkerThreads.cpp:990
+msgid "Couldn't run query on search engine"
+msgstr "Impossibile avviare un query sul motore di ricerca"
+
+#: UI/GTK2/src/WorkerThreads.cpp:835
+msgid "No title"
+msgstr "Nessun titolo"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1143
+msgid "Couldn't obtain downloader for protocol"
+msgstr "Impossibile ottenere download per protocollo"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1168
+msgid "Couldn't retrieve"
+msgstr "Impossibile ritrovare"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1265 UI/GTK2/src/WorkerThreads.cpp:1344
+msgid "Cannot index document type"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1269 UI/GTK2/src/WorkerThreads.cpp:1348
+msgid "at"
+msgstr ""
+
+#. No, it isn't
+#: UI/GTK2/src/WorkerThreads.cpp:1380
+msgid "Robots META tag forbids indexing"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1434
+msgid "Couldn't index"
+msgstr "Impossibile indicizzare"
+
+#. Be pessimistic and assume something will go wrong ;-)
+#: UI/GTK2/src/WorkerThreads.cpp:1516
+msgid "Couldn't unindex document(s)"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1650
+msgid "Couldn't update document"
+msgstr "Impossibile aggiornare il documento"

Added: trunk/po/pt.po
===================================================================
--- trunk/po/pt.po	2007-03-24 07:04:10 UTC (rev 789)
+++ trunk/po/pt.po	2007-03-24 07:28:21 UTC (rev 790)
@@ -0,0 +1,874 @@
+# Portuguese translation for pinot
+# Copyright (c) 2007 Rosetta Contributors and Canonical Ltd 2007
+# This file is distributed under the same license as the pinot package.
+# FIRST AUTHOR <EMAIL at ADDRESS>, 2007.
+#
+#, fuzzy
+msgid ""
+msgstr ""
+"Project-Id-Version: pinot\n"
+"Report-Msgid-Bugs-To: \n"
+"POT-Creation-Date: 2007-03-24 00:44+0800\n"
+"PO-Revision-Date: 2007-03-11 10:32+0000\n"
+"Last-Translator: _PN_boy <pedro_nuno_pn at iol.pt>\n"
+"Language-Team: Portuguese <pt at li.org>\n"
+"MIME-Version: 1.0\n"
+"Content-Type: text/plain; charset=UTF-8\n"
+"Content-Transfer-Encoding: 8bit\n"
+"X-Rosetta-Export-Date: 2007-03-24 04:08+0000\n"
+
+#: UI/GTK2/src/EnginesTree.cpp:70
+msgid "Search Engines"
+msgstr "Motores de pesquisa"
+
+#: UI/GTK2/src/EnginesTree.cpp:328
+#, fuzzy
+msgid "Current User"
+msgstr "Utilizador corrente"
+
+#. Bind the callback's parameter to the index name
+#. Enable these menu items unless it is not the documents index
+#. Internal indices
+#: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
+#: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
+#: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
+#: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
+#: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
+msgid "My Web Pages"
+msgstr "As minhas p?ginas Web"
+
+#. Populate the submenu
+#. Bind the callback's parameter to the index name
+#: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
+#: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
+#: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
+#: UI/GTK2/src/PinotSettings.cpp:1402 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:818 UI/GTK2/src/WorkerThreads.cpp:882
+msgid "My Documents"
+msgstr "Os Meus Documentos"
+
+#. The last column is for the timestamp
+#: UI/GTK2/src/dateDialog_glade.cc:76 UI/GTK2/src/queryDialog_glade.cc:91
+#: UI/GTK2/src/queryDialog_glade.cc:92 UI/GTK2/src/ResultsTree.cpp:145
+msgid "Date"
+msgstr "Data"
+
+#: UI/GTK2/src/indexDialog.cc:122
+msgid "Served by"
+msgstr ""
+
+#: UI/GTK2/src/indexDialog.cc:124
+msgid "Local"
+msgstr "Local"
+
+#: UI/GTK2/src/indexDialog.cc:286
+msgid "Index location"
+msgstr "Localiza??o do index"
+
+#: UI/GTK2/src/indexDialog_glade.cc:65 UI/GTK2/src/queryDialog_glade.cc:68
+msgid "Name:"
+msgstr "Nome:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:67
+msgid "..."
+msgstr "..."
+
+#: UI/GTK2/src/indexDialog_glade.cc:70 UI/GTK2/src/prefsDialog_glade.cc:85
+msgid "Type:"
+msgstr "Tipo:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:71 UI/GTK2/src/importDialog_glade.cc:67
+msgid "Location:"
+msgstr "Localiza??o:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:72 UI/GTK2/src/prefsDialog_glade.cc:86
+msgid "Port:"
+msgstr "Porta:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
+msgid "Address:"
+msgstr ""
+
+#: UI/GTK2/src/indexDialog_glade.cc:183
+msgid "External index"
+msgstr "Index externo"
+
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:98
+msgid "None"
+msgstr "Nenhum"
+
+#: UI/GTK2/src/importDialog_glade.cc:68
+#: UI/GTK2/src/propertiesDialog_glade.cc:67
+msgid "Title:"
+msgstr "T?tulo:"
+
+#: UI/GTK2/src/importDialog_glade.cc:71
+msgid "Apply label:"
+msgstr ""
+
+#: UI/GTK2/src/importDialog_glade.cc:77
+msgid "Import"
+msgstr "Importar"
+
+#: UI/GTK2/src/importDialog_glade.cc:148 UI/GTK2/src/mainWindow_glade.cc:217
+msgid "Import URL"
+msgstr "Importar URL"
+
+#. The score column is used for status icons
+#. This is the title column
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:119
+#: UI/GTK2/src/ResultsTree.cpp:127
+msgid "Title"
+msgstr "Titulo"
+
+#. URL
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:120
+#: UI/GTK2/src/ResultsTree.cpp:137
+msgid "URL"
+msgstr "URL"
+
+#: UI/GTK2/src/IndexTree.cpp:78
+msgid "Timestamp"
+msgstr "Data e hora"
+
+#: UI/GTK2/src/IndexPage.cpp:51
+msgid "Show Previous"
+msgstr "Mostrar anterior"
+
+#: UI/GTK2/src/IndexPage.cpp:57
+msgid "Show Next"
+msgstr "Mostrar pr?ximo"
+
+#: UI/GTK2/src/IndexPage.cpp:150 UI/GTK2/src/IndexPage.cpp:188
+msgid "All labels"
+msgstr ""
+
+#: UI/GTK2/src/launcherDialog_glade.cc:64
+msgid ""
+"There is no helper application defined for this document's type.\n"
+"Please enter the command to open this document."
+msgstr ""
+
+#: UI/GTK2/src/launcherDialog_glade.cc:67
+msgid "Use this command for other documents of the same type."
+msgstr "Usar este comando para outros documentos do mesmo tipo"
+
+#: UI/GTK2/src/launcherDialog_glade.cc:99
+msgid "Helper application"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:141
+msgid "Query Name"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:146
+msgid "Last Run"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:151
+msgid "Summary"
+msgstr "Resumo"
+
+#. Set tooltips
+#: UI/GTK2/src/mainWindow.cc:184
+msgid "Show all search engines"
+msgstr "Mostrar todos os motores de pesquisa"
+
+#: UI/GTK2/src/mainWindow.cc:185
+msgid "Add index"
+msgstr "Adicionar index"
+
+#: UI/GTK2/src/mainWindow.cc:186
+msgid "Remove index"
+msgstr "Remover index"
+
+#. Now we are ready
+#: UI/GTK2/src/mainWindow.cc:192
+msgid "Ready"
+msgstr "Pronto"
+
+#: UI/GTK2/src/mainWindow.cc:243
+msgid "N/A"
+msgstr "N/D"
+
+#: UI/GTK2/src/mainWindow.cc:258
+msgid "Undefined"
+msgstr "Indefinido"
+
+#. Show the URL of the first result in the status bar
+#: UI/GTK2/src/mainWindow.cc:476
+msgid "Result location is"
+msgstr "A localiza??o do resultado ?"
+
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:551
+msgid "Document location is"
+msgstr "A localiza??o do documento ?"
+
+#: UI/GTK2/src/mainWindow.cc:877
+msgid "Showing"
+msgstr "Visualizando"
+
+#: UI/GTK2/src/mainWindow.cc:882
+msgid "of"
+msgstr "de"
+
+#: UI/GTK2/src/mainWindow.cc:887
+msgid "documents, starting at"
+msgstr "documentos, come?ando em"
+
+#: UI/GTK2/src/mainWindow.cc:920
+msgid "Query"
+msgstr "Pesquisa"
+
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+msgid "on"
+msgstr "activar"
+
+#: UI/GTK2/src/mainWindow.cc:928
+msgid "ended"
+msgstr "terminado"
+
+#: UI/GTK2/src/mainWindow.cc:1053
+msgid "More Like"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1114
+msgid "Updated label(s)"
+msgstr ""
+
+#. Yes, it did
+#: UI/GTK2/src/mainWindow.cc:1198
+msgid "Updated document"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1211
+msgid "Indexed"
+msgstr "Indexado"
+
+#: UI/GTK2/src/mainWindow.cc:1254
+msgid "Unindexed document(s)"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1295
+msgid "Updated document properties"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1348
+msgid "Couldn't rename index, name"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
+#: UI/GTK2/src/mainWindow.cc:2755
+msgid "is already in use"
+msgstr "j? est? em uso"
+
+#: UI/GTK2/src/mainWindow.cc:1365
+msgid "Couldn't rename index"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1378
+msgid "Edited index"
+msgstr ""
+
+#. Find this query
+#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+msgid "Live query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1780
+msgid "Couldn't find query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/WorkerThreads.cpp:1625
+msgid "Index"
+msgstr "?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/WorkerThreads.cpp:1629
+msgid "doesn't exist"
+msgstr "n?o existe"
+
+#: UI/GTK2/src/mainWindow.cc:2131
+msgid "Remove this document from the index ?"
+msgstr "Remover este documento do ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:2150
+msgid "Remove these documents from the index ?"
+msgstr "Remover estes documentos do ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:2194
+msgid "A metasearch tool for the Free Desktop"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2195
+msgid "Search the Web and your documents !"
+msgstr "Pesquise a Web e os seus documentos"
+
+#: UI/GTK2/src/mainWindow.cc:2196
+msgid "(C) 2005 Fabrice Colin"
+msgstr "(C) 2005 Fabrice Colin"
+
+#: UI/GTK2/src/mainWindow.cc:2240
+msgid "Index name"
+msgstr "Nome do ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:2255
+msgid "Couldn't add index"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2269
+msgid "Added new index"
+msgstr "Adicionar novo ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:2304
+msgid "Couldn't remove index"
+msgstr "N?o foi possivel remover o ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:2569
+msgid "At least one task hasn't completed yet. Quit now ?"
+msgstr "Pelo menos uma tarefa ainda n?o foi concluida. Sair agora?"
+
+#: UI/GTK2/src/mainWindow.cc:2751
+msgid "Query name"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2778
+msgid "Couldn't update query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2786
+msgid "Edited query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2793
+msgid "Couldn't add query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2801
+msgid "Added new query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2814
+msgid "Query is not set"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2825
+msgid "No search engine selected"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2912
+msgid "Please set the Google API key first"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:2921
+msgid "Running query"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow.cc:3105
+msgid "No default application defined for type"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:125
+msgid "Query:"
+msgstr "Pesquisa:"
+
+#: UI/GTK2/src/mainWindow_glade.cc:137
+msgid "Edit"
+msgstr "Editar"
+
+#: UI/GTK2/src/mainWindow_glade.cc:146
+msgid "Stored queries"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:50
+#: UI/GTK2/src/statisticsDialog_glade.cc:87
+msgid "Status"
+msgstr "Situa??o"
+
+#: UI/GTK2/src/mainWindow_glade.cc:184
+msgid "Search Engine"
+msgstr "Motor de busca"
+
+#: UI/GTK2/src/mainWindow_glade.cc:187
+msgid "Host Name"
+msgstr "Nome da M?quina"
+
+#: UI/GTK2/src/mainWindow_glade.cc:190
+msgid "Show Extract"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:193
+msgid "Group By"
+msgstr "Agrupar Por"
+
+#: UI/GTK2/src/mainWindow_glade.cc:196
+msgid "Clear List"
+msgstr "Limpar Lista"
+
+#: UI/GTK2/src/mainWindow_glade.cc:202
+msgid "Vie_w"
+msgstr "M_ostrar"
+
+#: UI/GTK2/src/mainWindow_glade.cc:205
+msgid "View Cache"
+msgstr "Ver Cache"
+
+#: UI/GTK2/src/mainWindow_glade.cc:208
+msgid "More Like This"
+msgstr "Mais identicos"
+
+#: UI/GTK2/src/mainWindow_glade.cc:211 UI/GTK2/src/mainWindow_glade.cc:247
+msgid "_Index"
+msgstr "?nd_ice"
+
+#: UI/GTK2/src/mainWindow_glade.cc:214
+msgid "List Contents Of"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:223
+msgid "View"
+msgstr "Visualizar"
+
+#: UI/GTK2/src/mainWindow_glade.cc:226
+msgid "Update"
+msgstr "Actualizar"
+
+#: UI/GTK2/src/mainWindow_glade.cc:229
+msgid "Unindex"
+msgstr ""
+
+#: UI/GTK2/src/mainWindow_glade.cc:232
+#: UI/GTK2/src/propertiesDialog_glade.cc:177
+msgid "Properties"
+msgstr "Propriedades"
+
+#: UI/GTK2/src/mainWindow_glade.cc:235
+msgid "_About"
+msgstr "_Sobre"
+
+#: UI/GTK2/src/mainWindow_glade.cc:238
+msgid "_Session"
+msgstr "_Sess?o"
+
+#: UI/GTK2/src/mainWindow_glade.cc:241
+msgid "_Edit"
+msgstr "_Editar"
+
+#: UI/GTK2/src/mainWindow_glade.cc:244
+msgid "_Results"
+msgstr "_Resultados"
+
+#: UI/GTK2/src/mainWindow_glade.cc:250
+msgid "_Help"
+msgstr "_Ajuda"
+
+#: UI/GTK2/src/mainWindow_glade.cc:387
+msgid "Pinot"
+msgstr "Pinot"
+
+#. Localize language names
+#: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
+msgid "Unknown"
+msgstr "Desconhecido"
+
+#: UI/GTK2/src/pinot.cc:227 UI/GTK2/src/pinot-dbus-daemon.cc:294
+msgid "Danish"
+msgstr "Dinamarqu?s"
+
+#: UI/GTK2/src/pinot.cc:228 UI/GTK2/src/pinot-dbus-daemon.cc:295
+msgid "Dutch"
+msgstr "Holand?s"
+
+#: UI/GTK2/src/pinot.cc:229 UI/GTK2/src/pinot-dbus-daemon.cc:296
+msgid "English"
+msgstr "Ingl?s"
+
+#: UI/GTK2/src/pinot.cc:230 UI/GTK2/src/pinot-dbus-daemon.cc:297
+msgid "Finnish"
+msgstr "Finl?ndes"
+
+#: UI/GTK2/src/pinot.cc:231 UI/GTK2/src/pinot-dbus-daemon.cc:298
+msgid "French"
+msgstr "Franc?s"
+
+#: UI/GTK2/src/pinot.cc:232 UI/GTK2/src/pinot-dbus-daemon.cc:299
+msgid "German"
+msgstr "Alem?o"
+
+#: UI/GTK2/src/pinot.cc:233 UI/GTK2/src/pinot-dbus-daemon.cc:300
+msgid "Italian"
+msgstr "Italiano"
+
+#: UI/GTK2/src/pinot.cc:234 UI/GTK2/src/pinot-dbus-daemon.cc:301
+msgid "Norwegian"
+msgstr "Noruegu?s"
+
+#: UI/GTK2/src/pinot.cc:235 UI/GTK2/src/pinot-dbus-daemon.cc:302
+msgid "Portuguese"
+msgstr "Portugu?s"
+
+#: UI/GTK2/src/pinot.cc:236 UI/GTK2/src/pinot-dbus-daemon.cc:303
+msgid "Russian"
+msgstr "Russo"
+
+#: UI/GTK2/src/pinot.cc:237 UI/GTK2/src/pinot-dbus-daemon.cc:304
+msgid "Spanish"
+msgstr "Espanhol"
+
+#: UI/GTK2/src/pinot.cc:238 UI/GTK2/src/pinot-dbus-daemon.cc:305
+msgid "Swedish"
+msgstr "Sueco"
+
+#: UI/GTK2/src/pinot.cc:263
+msgid "Couldn't open index"
+msgstr ""
+
+#: UI/GTK2/src/pinot.cc:279
+msgid "Couldn't create history database"
+msgstr ""
+
+#. Yes, it is
+#. FIXME: use a popup !
+#: UI/GTK2/src/pinot.cc:309
+msgid "Updating all documents in My Web Pages is recommended"
+msgstr ""
+
+#. Add default labels
+#: UI/GTK2/src/PinotSettings.cpp:249
+msgid "Important"
+msgstr "Importante"
+
+#: UI/GTK2/src/PinotSettings.cpp:250
+msgid "New"
+msgstr "Novo"
+
+#: UI/GTK2/src/PinotSettings.cpp:251
+msgid "Personal"
+msgstr "Pessoal"
+
+#: UI/GTK2/src/PinotSettings.cpp:1141
+msgid "Unclassified"
+msgstr "N?o classificado"
+
+#: UI/GTK2/src/prefsDialog.cc:82
+msgid "Name"
+msgstr "Nome :"
+
+#: UI/GTK2/src/prefsDialog.cc:90
+msgid "Monitor"
+msgstr "Supervisar"
+
+#: UI/GTK2/src/prefsDialog.cc:91 UI/GTK2/src/prefsDialog.cc:99
+msgid "Location"
+msgstr "Localiza??o"
+
+#: UI/GTK2/src/prefsDialog.cc:107
+msgid "Pattern"
+msgstr "Padr?o:"
+
+#: UI/GTK2/src/prefsDialog.cc:471
+msgid "New Label"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:512
+msgid "Directory to index"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:570
+msgid "Mbox File Location"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:66
+msgid "Google API key:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:69
+msgid "New results:"
+msgstr "Novos resultados"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:70
+msgid "Queries:"
+msgstr "Pesquisas:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:71
+msgid "Enable search terms suggestion"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:73
+msgid "Ignore robots.txt and Robots META tag"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "HTTP crawling:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
+msgid "General"
+msgstr "Geral"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:79
+msgid "Direct connection to the Internet"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80
+msgid "Manual proxy configuration:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:93
+msgid "Network"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:94
+msgid "Labels are used to classify indexed documents:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
+#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+msgid "Add"
+msgstr "Adicionar"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:105
+msgid "Remove"
+msgstr "Remover"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:113
+msgid "Labels"
+msgstr "Etiquetas"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:114
+msgid "These directories will be indexed and optionally monitored for changes:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:127
+msgid "Mail boxes of type mbox can be monitored and indexed:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:140
+msgid "Specify any file pattern you wish to exclude from indexing:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:154
+msgid "Indexing"
+msgstr "Indexando"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:566
+msgid "Preferences"
+msgstr "Prefer?ncias"
+
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:124
+msgid "Label"
+msgstr "Etiqueta"
+
+#: UI/GTK2/src/propertiesDialog.cc:81
+msgid "Per document"
+msgstr "Por documento"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:68
+msgid "Language:"
+msgstr "Idioma:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:69
+msgid "MIME type:"
+msgstr "Tipo MIME:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:70
+msgid "Size:"
+msgstr "Tamanho:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:73
+msgid "Terms:"
+msgstr "Termos:"
+
+#. All supported filters
+#: UI/GTK2/src/queryDialog.cc:116
+msgid "Host name"
+msgstr "Nome da m?quina"
+
+#: UI/GTK2/src/queryDialog.cc:117
+msgid "File name"
+msgstr "Nome do ficheiro"
+
+#: UI/GTK2/src/queryDialog.cc:118
+msgid "File extension"
+msgstr "Extens?o do ficheiro"
+
+#: UI/GTK2/src/queryDialog.cc:121
+msgid "Directory"
+msgstr "Direct?rio"
+
+#: UI/GTK2/src/queryDialog.cc:122
+msgid "Language code"
+msgstr "C?digo do idioma"
+
+#: UI/GTK2/src/queryDialog.cc:123
+msgid "MIME type"
+msgstr "Tipo MIME"
+
+#: UI/GTK2/src/queryDialog.cc:237
+msgid "Start date"
+msgstr "Data de in?cio"
+
+#: UI/GTK2/src/queryDialog.cc:252
+msgid "End date"
+msgstr "Data de fim"
+
+#: UI/GTK2/src/queryDialog_glade.cc:72
+msgid "New filter:"
+msgstr "Novo filtro:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:81
+msgid "Query Text"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:83
+msgid "Index results with label"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:86
+msgid "Number of results:"
+msgstr ""
+
+#: UI/GTK2/src/queryDialog_glade.cc:89
+msgid "Start date:"
+msgstr "Data de in?cio:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:90
+msgid "End date:"
+msgstr "Data de fim:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:201
+msgid "Query parameters"
+msgstr ""
+
+#. This is the score column
+#: UI/GTK2/src/ResultsTree.cpp:117
+msgid "Score"
+msgstr ""
+
+#: UI/GTK2/src/ResultsTree.cpp:174
+msgid "Extract"
+msgstr "Extrair"
+
+#: UI/GTK2/src/statisticsDialog.cc:72
+msgid "Indexes"
+msgstr "?ndices"
+
+#: UI/GTK2/src/statisticsDialog.cc:87
+msgid "History"
+msgstr "Hist?rico"
+
+#: UI/GTK2/src/statisticsDialog.cc:92
+msgid "Daemon"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
+msgid "documents"
+msgstr "documentos"
+
+#: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
+#, fuzzy
+msgid "Unknown error"
+msgstr "Desconhecido"
+
+#: UI/GTK2/src/statisticsDialog.cc:154
+msgid "Viewed"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:154
+msgid "results"
+msgstr "resultados"
+
+#. FIXME: check whether it's actually running !
+#: UI/GTK2/src/statisticsDialog.cc:171
+msgid "Running under PID"
+msgstr "A correr com o PID"
+
+#: UI/GTK2/src/statisticsDialog.cc:175
+msgid "Currently not running"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:182
+msgid "Crawled"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:182
+msgid "files"
+msgstr "ficheiros"
+
+#: UI/GTK2/src/statisticsDialog.cc:205
+msgid "Errors"
+msgstr "Erros"
+
+#: UI/GTK2/src/WorkerThreads.cpp:302
+msgid "Can't index mail here"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:323
+msgid "is already being indexed"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:333
+msgid "is blacklisted"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:642 UI/GTK2/src/WorkerThreads.cpp:955
+#: UI/GTK2/src/WorkerThreads.cpp:1040 UI/GTK2/src/WorkerThreads.cpp:1049
+#: UI/GTK2/src/WorkerThreads.cpp:1235 UI/GTK2/src/WorkerThreads.cpp:1505
+#: UI/GTK2/src/WorkerThreads.cpp:1638
+msgid "Index error on"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:765 UI/GTK2/src/WorkerThreads.cpp:976
+msgid "Couldn't create search engine"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:791 UI/GTK2/src/WorkerThreads.cpp:990
+msgid "Couldn't run query on search engine"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:835
+msgid "No title"
+msgstr "Sem t?tulo"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1143
+msgid "Couldn't obtain downloader for protocol"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1168
+msgid "Couldn't retrieve"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1265 UI/GTK2/src/WorkerThreads.cpp:1344
+msgid "Cannot index document type"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1269 UI/GTK2/src/WorkerThreads.cpp:1348
+msgid "at"
+msgstr ""
+
+#. No, it isn't
+#: UI/GTK2/src/WorkerThreads.cpp:1380
+msgid "Robots META tag forbids indexing"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1434
+msgid "Couldn't index"
+msgstr ""
+
+#. Be pessimistic and assume something will go wrong ;-)
+#: UI/GTK2/src/WorkerThreads.cpp:1516
+msgid "Couldn't unindex document(s)"
+msgstr ""
+
+#: UI/GTK2/src/WorkerThreads.cpp:1650
+msgid "Couldn't update document"
+msgstr ""
+
+#~ msgid "Host name:"
+#~ msgstr "Nome do servidor:"



From fabricecolin at mail.berlios.de  Sun Mar 25 09:33:41 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 25 Mar 2007 09:33:41 +0200
Subject: [Pinot-svn] r791 - trunk/po
Message-ID: <200703250733.l2P7XfUD009579@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-25 09:33:34 +0200 (Sun, 25 Mar 2007)
New Revision: 791

Modified:
   trunk/po/de.po
   trunk/po/es.po
   trunk/po/fr.po
   trunk/po/it.po
   trunk/po/nl.po
   trunk/po/pt.po
   trunk/po/pt_BR.po
   trunk/po/ru.po
   trunk/po/sv.po
Log:
Synced po files.


Modified: trunk/po/de.po
===================================================================
--- trunk/po/de.po	2007-03-24 07:28:21 UTC (rev 790)
+++ trunk/po/de.po	2007-03-25 07:33:34 UTC (rev 791)
@@ -1,15 +1,14 @@
 # German translation for pinot
 # Copyright (c) 2006 Rosetta Contributors and Canonical Ltd 2006
 # This file is distributed under the same license as the pinot package.
-# FIRST AUTHOR <EMAIL at ADDRESS>, 2006.
 #
 #, fuzzy
 msgid ""
 msgstr ""
 "Project-Id-Version: pinot\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-03-24 00:44+0800\n"
-"PO-Revision-Date: 2007-03-10 20:26+0000\n"
+"POT-Creation-Date: 2007-03-10 20:26+0000\n"
+"PO-Revision-Date: 2007-03-24 15:37+0800\n"
 "Last-Translator: Christian Dywan <christian at twotoasts.de>\n"
 "Language-Team: German <de at li.org>\n"
 "MIME-Version: 1.0\n"
@@ -25,22 +24,17 @@
 msgid "Current User"
 msgstr "Aktueller Benutzer"
 
-#. Bind the callback's parameter to the index name
-#. Enable these menu items unless it is not the documents index
-#. Internal indices
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
 #: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
 #: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
-#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1866
 #: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
 #: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
 #: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
 msgid "My Web Pages"
 msgstr "Meine Webseiten"
 
-#. Populate the submenu
-#. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
 #: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
 #: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
@@ -49,7 +43,6 @@
 msgid "My Documents"
 msgstr "Meine Dokumente"
 
-#. The last column is for the timestamp
 #: UI/GTK2/src/dateDialog_glade.cc:76 UI/GTK2/src/queryDialog_glade.cc:91
 #: UI/GTK2/src/queryDialog_glade.cc:92 UI/GTK2/src/ResultsTree.cpp:145
 msgid "Date"
@@ -95,7 +88,7 @@
 msgid "External index"
 msgstr "Externer Index"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:98
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr ""
 
@@ -116,15 +109,12 @@
 msgid "Import URL"
 msgstr "URL importieren"
 
-#. The score column is used for status icons
-#. This is the title column
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:119
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:122
 #: UI/GTK2/src/ResultsTree.cpp:127
 msgid "Title"
 msgstr ""
 
-#. URL
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:120
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:123
 #: UI/GTK2/src/ResultsTree.cpp:137
 msgid "URL"
 msgstr "URL"
@@ -173,7 +163,6 @@
 msgid "Summary"
 msgstr ""
 
-#. Set tooltips
 #: UI/GTK2/src/mainWindow.cc:184
 msgid "Show all search engines"
 msgstr "Alle Suchmaschinen anzeigen"
@@ -186,7 +175,6 @@
 msgid "Remove index"
 msgstr "Index entfernen"
 
-#. Now we are ready
 #: UI/GTK2/src/mainWindow.cc:192
 msgid "Ready"
 msgstr "Bereit"
@@ -199,12 +187,10 @@
 msgid "Undefined"
 msgstr "Unbestimmt"
 
-#. Show the URL of the first result in the status bar
 #: UI/GTK2/src/mainWindow.cc:476
 msgid "Result location is"
 msgstr ""
 
-#. Show the URL in the status bar
 #: UI/GTK2/src/mainWindow.cc:551
 msgid "Document location is"
 msgstr ""
@@ -225,7 +211,7 @@
 msgid "Query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2934
 msgid "on"
 msgstr ""
 
@@ -241,7 +227,6 @@
 msgid "Updated label(s)"
 msgstr ""
 
-#. Yes, it did
 #: UI/GTK2/src/mainWindow.cc:1198
 msgid "Updated document"
 msgstr "Dokument aktualisiert"
@@ -262,8 +247,8 @@
 msgid "Couldn't rename index, name"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2764
 msgid "is already in use"
 msgstr ""
 
@@ -275,102 +260,101 @@
 msgid "Edited index"
 msgstr ""
 
-#. Find this query
-#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+#: UI/GTK2/src/mainWindow.cc:1763 UI/GTK2/src/mainWindow.cc:2423
 msgid "Live query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:1780
+#: UI/GTK2/src/mainWindow.cc:1789
 msgid "Couldn't find query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/mainWindow.cc:1982 UI/GTK2/src/WorkerThreads.cpp:629
 #: UI/GTK2/src/WorkerThreads.cpp:1625
 msgid "Index"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/mainWindow.cc:1986 UI/GTK2/src/WorkerThreads.cpp:633
 #: UI/GTK2/src/WorkerThreads.cpp:1629
 msgid "doesn't exist"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2131
+#: UI/GTK2/src/mainWindow.cc:2140
 msgid "Remove this document from the index ?"
 msgstr "Dieses Dokument aus dem Index entfernen"
 
-#: UI/GTK2/src/mainWindow.cc:2150
+#: UI/GTK2/src/mainWindow.cc:2159
 msgid "Remove these documents from the index ?"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2203
 msgid "A metasearch tool for the Free Desktop"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2195
+#: UI/GTK2/src/mainWindow.cc:2204
 msgid "Search the Web and your documents !"
 msgstr "Durchsuchen Sie das Internet und Ihre Dokumente !"
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2205
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2240
+#: UI/GTK2/src/mainWindow.cc:2249
 msgid "Index name"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2255
+#: UI/GTK2/src/mainWindow.cc:2264
 msgid "Couldn't add index"
 msgstr "Konnte Index nicht hinzuf?gen"
 
-#: UI/GTK2/src/mainWindow.cc:2269
+#: UI/GTK2/src/mainWindow.cc:2278
 msgid "Added new index"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2304
+#: UI/GTK2/src/mainWindow.cc:2313
 msgid "Couldn't remove index"
 msgstr "Konnte Index nicht entfernen"
 
-#: UI/GTK2/src/mainWindow.cc:2569
+#: UI/GTK2/src/mainWindow.cc:2578
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2751
+#: UI/GTK2/src/mainWindow.cc:2760
 msgid "Query name"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2778
+#: UI/GTK2/src/mainWindow.cc:2787
 msgid "Couldn't update query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Edited query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2793
+#: UI/GTK2/src/mainWindow.cc:2802
 msgid "Couldn't add query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2801
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Added new query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2814
+#: UI/GTK2/src/mainWindow.cc:2823
 msgid "Query is not set"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2825
+#: UI/GTK2/src/mainWindow.cc:2834
 msgid "No search engine selected"
 msgstr "Keine Suchmaschine ausgew?hlt"
 
-#: UI/GTK2/src/mainWindow.cc:2912
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Please set the Google API key first"
 msgstr "Bitte geben Sie zuerst den Google API-Schl?ssel ein"
 
-#: UI/GTK2/src/mainWindow.cc:2921
+#: UI/GTK2/src/mainWindow.cc:2930
 msgid "Running query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:3105
+#: UI/GTK2/src/mainWindow.cc:3114
 msgid "No default application defined for type"
 msgstr "Keine Standardanwendung f?r Typ angegeben"
 
@@ -472,7 +456,6 @@
 msgid "Pinot"
 msgstr ""
 
-#. Localize language names
 #: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
 #: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
 msgid "Unknown"
@@ -534,13 +517,10 @@
 msgid "Couldn't create history database"
 msgstr ""
 
-#. Yes, it is
-#. FIXME: use a popup !
 #: UI/GTK2/src/pinot.cc:309
 msgid "Updating all documents in My Web Pages is recommended"
 msgstr ""
 
-#. Add default labels
 #: UI/GTK2/src/PinotSettings.cpp:249
 msgid "Important"
 msgstr ""
@@ -662,7 +642,7 @@
 msgid "Preferences"
 msgstr "Einstellungen"
 
-#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:124
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr ""
 
@@ -686,36 +666,35 @@
 msgid "Terms:"
 msgstr ""
 
-#. All supported filters
-#: UI/GTK2/src/queryDialog.cc:116
+#: UI/GTK2/src/queryDialog.cc:119
 msgid "Host name"
 msgstr "Rechnername"
 
-#: UI/GTK2/src/queryDialog.cc:117
+#: UI/GTK2/src/queryDialog.cc:120
 msgid "File name"
 msgstr "Dateiname"
 
-#: UI/GTK2/src/queryDialog.cc:118
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "File extension"
 msgstr "Dateiendung"
 
-#: UI/GTK2/src/queryDialog.cc:121
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "Directory"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:122
+#: UI/GTK2/src/queryDialog.cc:125
 msgid "Language code"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:123
+#: UI/GTK2/src/queryDialog.cc:126
 msgid "MIME type"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:237
+#: UI/GTK2/src/queryDialog.cc:246
 msgid "Start date"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:252
+#: UI/GTK2/src/queryDialog.cc:261
 msgid "End date"
 msgstr ""
 
@@ -747,7 +726,6 @@
 msgid "Query parameters"
 msgstr ""
 
-#. This is the score column
 #: UI/GTK2/src/ResultsTree.cpp:117
 #, fuzzy
 msgid "Score"
@@ -788,7 +766,6 @@
 msgid "results"
 msgstr ""
 
-#. FIXME: check whether it's actually running !
 #: UI/GTK2/src/statisticsDialog.cc:171
 msgid "Running under PID"
 msgstr ""
@@ -856,7 +833,6 @@
 msgid "at"
 msgstr ""
 
-#. No, it isn't
 #: UI/GTK2/src/WorkerThreads.cpp:1380
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META-Tag verbietet das Indizieren"
@@ -865,7 +841,6 @@
 msgid "Couldn't index"
 msgstr ""
 
-#. Be pessimistic and assume something will go wrong ;-)
 #: UI/GTK2/src/WorkerThreads.cpp:1516
 msgid "Couldn't unindex document(s)"
 msgstr ""
@@ -873,6 +848,3 @@
 #: UI/GTK2/src/WorkerThreads.cpp:1650
 msgid "Couldn't update document"
 msgstr ""
-
-#~ msgid "Host name:"
-#~ msgstr "Rechnername:"

Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2007-03-24 07:28:21 UTC (rev 790)
+++ trunk/po/es.po	2007-03-25 07:33:34 UTC (rev 791)
@@ -1,4 +1,4 @@
-# es PO file for pinot.
+# Spanish translation for pinot
 # Copyright (C) 2006 Fabrice Colin, Jes?s Tramullas
 # This file is distributed under the same license as the pinot package.
 # Jes?s Tramullas <jesus at tramullas.com>, 2006.
@@ -29,18 +29,18 @@
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
 #: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
 #: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
-#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
-#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
-#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
-#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1866
+#: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
+#: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
 msgid "My Web Pages"
 msgstr "Mis Paginas Web"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
 #: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
-#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
-#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
-#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
+#: UI/GTK2/src/PinotSettings.cpp:1402 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:818 UI/GTK2/src/WorkerThreads.cpp:882
 msgid "My Documents"
 msgstr "Mis documentos"
 
@@ -49,16 +49,16 @@
 msgid "Date"
 msgstr "Date"
 
-#: UI/GTK2/src/indexDialog.cc:130
+#: UI/GTK2/src/indexDialog.cc:122
 msgid "Served by"
 msgstr "Servido por"
 
-#: UI/GTK2/src/indexDialog.cc:134
+#: UI/GTK2/src/indexDialog.cc:124
 #, fuzzy
 msgid "Local"
 msgstr "Localizaci?n"
 
-#: UI/GTK2/src/indexDialog.cc:300
+#: UI/GTK2/src/indexDialog.cc:286
 msgid "Index location"
 msgstr "Localizaci?n del ?ndice"
 
@@ -70,7 +70,7 @@
 msgid "..."
 msgstr "..."
 
-#: UI/GTK2/src/indexDialog_glade.cc:70
+#: UI/GTK2/src/indexDialog_glade.cc:70 UI/GTK2/src/prefsDialog_glade.cc:85
 msgid "Type:"
 msgstr "Tipo:"
 
@@ -78,19 +78,19 @@
 msgid "Location:"
 msgstr "Localizaci?n:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:72
+#: UI/GTK2/src/indexDialog_glade.cc:72 UI/GTK2/src/prefsDialog_glade.cc:86
 msgid "Port:"
 msgstr "Puerto:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:79
-msgid "Host name:"
-msgstr "Nombre de servidor:"
+#: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
+msgid "Address:"
+msgstr ""
 
-#: UI/GTK2/src/indexDialog_glade.cc:163
+#: UI/GTK2/src/indexDialog_glade.cc:183
 msgid "External index"
 msgstr "?ndice externo"
 
-#: UI/GTK2/src/importDialog.cc:82 UI/GTK2/src/queryDialog.cc:108
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Ninguno"
 
@@ -111,12 +111,12 @@
 msgid "Import URL"
 msgstr "Importar una URL"
 
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:139
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:122
 #: UI/GTK2/src/ResultsTree.cpp:127
 msgid "Title"
 msgstr "T?tulo"
 
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:142
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:123
 #: UI/GTK2/src/ResultsTree.cpp:137
 msgid "URL"
 msgstr "URL"
@@ -133,7 +133,7 @@
 msgid "Show Next"
 msgstr "Mostrar siguientes"
 
-#: UI/GTK2/src/IndexPage.cpp:159 UI/GTK2/src/IndexPage.cpp:205
+#: UI/GTK2/src/IndexPage.cpp:150 UI/GTK2/src/IndexPage.cpp:188
 msgid "All labels"
 msgstr "Todas las etiquetas"
 
@@ -211,7 +211,7 @@
 msgid "Query"
 msgstr "B?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2934
 msgid "on"
 msgstr "en"
 
@@ -247,8 +247,8 @@
 msgid "Couldn't rename index, name"
 msgstr "No se pudo renombrar ?ndice, nombre"
 
-#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2764
 msgid "is already in use"
 msgstr "ya est? en uso"
 
@@ -260,101 +260,101 @@
 msgid "Edited index"
 msgstr "?ndice editado"
 
-#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+#: UI/GTK2/src/mainWindow.cc:1763 UI/GTK2/src/mainWindow.cc:2423
 msgid "Live query"
 msgstr "B?squeda activa"
 
-#: UI/GTK2/src/mainWindow.cc:1780
+#: UI/GTK2/src/mainWindow.cc:1789
 msgid "Couldn't find query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1618
+#: UI/GTK2/src/mainWindow.cc:1982 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/WorkerThreads.cpp:1625
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1622
+#: UI/GTK2/src/mainWindow.cc:1986 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/WorkerThreads.cpp:1629
 msgid "doesn't exist"
 msgstr "no existe"
 
-#: UI/GTK2/src/mainWindow.cc:2131
+#: UI/GTK2/src/mainWindow.cc:2140
 msgid "Remove this document from the index ?"
 msgstr "?Borrar este documento del ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2150
+#: UI/GTK2/src/mainWindow.cc:2159
 msgid "Remove these documents from the index ?"
 msgstr "?Borrar este documento del ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2203
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Una herramienta metabuscador para el escritorio libre"
 
-#: UI/GTK2/src/mainWindow.cc:2195
+#: UI/GTK2/src/mainWindow.cc:2204
 msgid "Search the Web and your documents !"
 msgstr "Busca en el web y en sus documentos"
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2205
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2240
+#: UI/GTK2/src/mainWindow.cc:2249
 msgid "Index name"
 msgstr "Nombre del ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2255
+#: UI/GTK2/src/mainWindow.cc:2264
 msgid "Couldn't add index"
 msgstr "No se pudo a?adir el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2269
+#: UI/GTK2/src/mainWindow.cc:2278
 msgid "Added new index"
 msgstr "A?adido un nuevo ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2304
+#: UI/GTK2/src/mainWindow.cc:2313
 msgid "Couldn't remove index"
 msgstr "No se pudo borrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2569
+#: UI/GTK2/src/mainWindow.cc:2578
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Al menos una tarea no ha finalizado. ?Parar ahora?"
 
-#: UI/GTK2/src/mainWindow.cc:2751
+#: UI/GTK2/src/mainWindow.cc:2760
 msgid "Query name"
 msgstr "Nombre la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2778
+#: UI/GTK2/src/mainWindow.cc:2787
 msgid "Couldn't update query"
 msgstr "No se pudo actualizar la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Edited query"
 msgstr "B?squeda editada"
 
-#: UI/GTK2/src/mainWindow.cc:2793
+#: UI/GTK2/src/mainWindow.cc:2802
 msgid "Couldn't add query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2801
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Added new query"
 msgstr "A?adida una nueva b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2814
+#: UI/GTK2/src/mainWindow.cc:2823
 msgid "Query is not set"
 msgstr "B?squeda no definida"
 
-#: UI/GTK2/src/mainWindow.cc:2825
+#: UI/GTK2/src/mainWindow.cc:2834
 msgid "No search engine selected"
 msgstr "Motor de b?squeda no seleccionado"
 
-#: UI/GTK2/src/mainWindow.cc:2912
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Please set the Google API key first"
 msgstr "Por favor, primero configure el API de Google"
 
-#: UI/GTK2/src/mainWindow.cc:2921
+#: UI/GTK2/src/mainWindow.cc:2930
 msgid "Running query"
 msgstr "Ejecutando la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:3105
+#: UI/GTK2/src/mainWindow.cc:3114
 msgid "No default application defined for type"
 msgstr "No hay aplicaci?n predefinida para el tipo"
 
@@ -370,7 +370,7 @@
 msgid "Stored queries"
 msgstr "B?squedas guardadas"
 
-#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:46
+#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:50
 #: UI/GTK2/src/statisticsDialog_glade.cc:87
 msgid "Status"
 msgstr "Estatus"
@@ -456,181 +456,197 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
-#: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
+#: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
 msgid "Unknown"
 msgstr "Desconocido"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:227 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Danish"
 msgstr "Dan?s"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:228 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "Dutch"
 msgstr "Holand?s"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:229 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "English"
 msgstr "Ingl?s"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:230 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "Finnish"
 msgstr "Finland?s"
 
-#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
+#: UI/GTK2/src/pinot.cc:231 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "French"
 msgstr "Franc?s"
 
-#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
+#: UI/GTK2/src/pinot.cc:232 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "German"
 msgstr "Alem?n"
 
-#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
+#: UI/GTK2/src/pinot.cc:233 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Italian"
 msgstr "Italiano"
 
-#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
+#: UI/GTK2/src/pinot.cc:234 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Norwegian"
 msgstr "Noruego"
 
-#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
+#: UI/GTK2/src/pinot.cc:235 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
+#: UI/GTK2/src/pinot.cc:236 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Russian"
 msgstr "Ruso"
 
-#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
+#: UI/GTK2/src/pinot.cc:237 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Spanish"
 msgstr "Espa?ol"
 
-#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
+#: UI/GTK2/src/pinot.cc:238 UI/GTK2/src/pinot-dbus-daemon.cc:305
 msgid "Swedish"
 msgstr "Sueco"
 
-#: UI/GTK2/src/pinot.cc:247
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't open index"
 msgstr "No se pudo abrir el ?ndice"
 
-#: UI/GTK2/src/pinot.cc:263
+#: UI/GTK2/src/pinot.cc:279
 msgid "Couldn't create history database"
 msgstr "No se pudo crear la base de datos del hist?rico"
 
-#: UI/GTK2/src/PinotSettings.cpp:247
+#: UI/GTK2/src/pinot.cc:309
+msgid "Updating all documents in My Web Pages is recommended"
+msgstr ""
+
+#: UI/GTK2/src/PinotSettings.cpp:249
 msgid "Important"
 msgstr "Importante"
 
-#: UI/GTK2/src/PinotSettings.cpp:248
+#: UI/GTK2/src/PinotSettings.cpp:250
 msgid "New"
 msgstr "Nuevo"
 
-#: UI/GTK2/src/PinotSettings.cpp:249
+#: UI/GTK2/src/PinotSettings.cpp:251
 msgid "Personal"
 msgstr "Personal"
 
-#: UI/GTK2/src/PinotSettings.cpp:1082
+#: UI/GTK2/src/PinotSettings.cpp:1141
 msgid "Unclassified"
 msgstr "No clasificado"
 
-#: UI/GTK2/src/prefsDialog.cc:67
+#: UI/GTK2/src/prefsDialog.cc:82
 msgid "Name"
 msgstr "Nombre"
 
-#: UI/GTK2/src/prefsDialog.cc:75
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Monitor"
 msgstr "Supervisar"
 
-#: UI/GTK2/src/prefsDialog.cc:76 UI/GTK2/src/prefsDialog.cc:84
+#: UI/GTK2/src/prefsDialog.cc:91 UI/GTK2/src/prefsDialog.cc:99
 msgid "Location"
 msgstr "Localizaci?n"
 
-#: UI/GTK2/src/prefsDialog.cc:92
+#: UI/GTK2/src/prefsDialog.cc:107
 msgid "Pattern"
 msgstr "Patron"
 
-#: UI/GTK2/src/prefsDialog.cc:423
+#: UI/GTK2/src/prefsDialog.cc:471
 msgid "New Label"
 msgstr "Nueva etiqueta"
 
-#: UI/GTK2/src/prefsDialog.cc:464
+#: UI/GTK2/src/prefsDialog.cc:512
 msgid "Directory to index"
 msgstr "Carpeta a indexar"
 
-#: UI/GTK2/src/prefsDialog.cc:522
+#: UI/GTK2/src/prefsDialog.cc:570
 msgid "Mbox File Location"
 msgstr "Localizaci?n del fichero mbox"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:65
-msgid "HTTP crawling:"
-msgstr "Agente HTTP:"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Clave del API de Google"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:68
-msgid "Ignore robots.txt and Robots META tag"
-msgstr "Ignorar robots.txt y la etiqueta META Robots"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:70
+#: UI/GTK2/src/prefsDialog_glade.cc:69
 msgid "New results:"
 msgstr "Nuevos resultados:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:71
+#: UI/GTK2/src/prefsDialog_glade.cc:70
 msgid "Queries:"
 msgstr "B?squedas:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:72
+#: UI/GTK2/src/prefsDialog_glade.cc:71
 msgid "Enable search terms suggestion"
 msgstr "Activar sugerencia de t?rminos de b?squeda"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:76
+#: UI/GTK2/src/prefsDialog_glade.cc:73
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "Ignorar robots.txt y la etiqueta META Robots"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "HTTP crawling:"
+msgstr "Agente HTTP:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
 msgid "General"
 msgstr "General"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:77
+#: UI/GTK2/src/prefsDialog_glade.cc:79
+msgid "Direct connection to the Internet"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80
+msgid "Manual proxy configuration:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:93
+msgid "Network"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:94
 msgid "Labels are used to classify indexed documents:"
 msgstr "Las etiquetas se usan para clasificar los documentos indizados:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:82 UI/GTK2/src/prefsDialog_glade.cc:102
-#: UI/GTK2/src/prefsDialog_glade.cc:115 UI/GTK2/src/prefsDialog_glade.cc:128
+#: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
+#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
 msgid "Add"
 msgstr "A?adir"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:88
+#: UI/GTK2/src/prefsDialog_glade.cc:105
 msgid "Remove"
 msgstr "Borrar"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:96
+#: UI/GTK2/src/prefsDialog_glade.cc:113
 msgid "Labels"
 msgstr "Etiquetas"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:97
+#: UI/GTK2/src/prefsDialog_glade.cc:114
 msgid "These directories will be indexed and optionally monitored for changes:"
 msgstr "Estas carpetas van a estar indexar autom?ticamente"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:110
+#: UI/GTK2/src/prefsDialog_glade.cc:127
 msgid "Mail boxes of type mbox can be monitored and indexed:"
 msgstr "Los buzones de correo de tipo mbox pueden ser controlados e indizados"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:123
+#: UI/GTK2/src/prefsDialog_glade.cc:140
 msgid "Specify any file pattern you wish to exclude from indexing:"
 msgstr "Especifique patrones que desea excluir del ?ndice:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:137
+#: UI/GTK2/src/prefsDialog_glade.cc:154
 msgid "Indexing"
 msgstr "?ndices"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:411
+#: UI/GTK2/src/prefsDialog_glade.cc:566
 msgid "Preferences"
 msgstr "Preferencias"
 
-#: UI/GTK2/src/propertiesDialog.cc:52 UI/GTK2/src/queryDialog.cc:154
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "Etiqueta"
 
-#: UI/GTK2/src/propertiesDialog.cc:86
+#: UI/GTK2/src/propertiesDialog.cc:81
 msgid "Per document"
 msgstr "Documento"
 
@@ -650,35 +666,35 @@
 msgid "Terms:"
 msgstr "T?rminos:"
 
-#: UI/GTK2/src/queryDialog.cc:130
+#: UI/GTK2/src/queryDialog.cc:119
 msgid "Host name"
 msgstr "Nombre de servidor"
 
-#: UI/GTK2/src/queryDialog.cc:133
+#: UI/GTK2/src/queryDialog.cc:120
 msgid "File name"
 msgstr "Nombre de archivo"
 
-#: UI/GTK2/src/queryDialog.cc:136
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "File extension"
 msgstr "Extensi?n del archivo"
 
-#: UI/GTK2/src/queryDialog.cc:145
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "Directory"
 msgstr "Carpeta"
 
-#: UI/GTK2/src/queryDialog.cc:148
+#: UI/GTK2/src/queryDialog.cc:125
 msgid "Language code"
 msgstr "Codigo de idioma"
 
-#: UI/GTK2/src/queryDialog.cc:151
+#: UI/GTK2/src/queryDialog.cc:126
 msgid "MIME type"
 msgstr "Tipo MIME"
 
-#: UI/GTK2/src/queryDialog.cc:271
+#: UI/GTK2/src/queryDialog.cc:246
 msgid "Start date"
 msgstr "Fecha inicial"
 
-#: UI/GTK2/src/queryDialog.cc:286
+#: UI/GTK2/src/queryDialog.cc:261
 msgid "End date"
 msgstr "Fecha final"
 
@@ -718,112 +734,117 @@
 msgid "Extract"
 msgstr "Extra?dos"
 
-#: UI/GTK2/src/statisticsDialog.cc:69
+#: UI/GTK2/src/statisticsDialog.cc:72
 #, fuzzy
 msgid "Indexes"
 msgstr "Indizado"
 
-#: UI/GTK2/src/statisticsDialog.cc:83 UI/GTK2/src/statisticsDialog.cc:97
+#: UI/GTK2/src/statisticsDialog.cc:87
+#, fuzzy
+msgid "History"
+msgstr "Carpeta"
+
+#: UI/GTK2/src/statisticsDialog.cc:92
+msgid "Daemon"
+msgstr "Daemon"
+
+#: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
 msgid "documents"
 msgstr "documentos"
 
-#: UI/GTK2/src/statisticsDialog.cc:102
+#: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
 #, fuzzy
-msgid "History"
-msgstr "Carpeta"
+msgid "Unknown error"
+msgstr "Desconocido"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 msgid "Viewed"
 msgstr "Ver"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 msgid "results"
 msgstr "resultados"
 
-#: UI/GTK2/src/statisticsDialog.cc:113
-msgid "Daemon"
-msgstr "Daemon"
-
-#: UI/GTK2/src/statisticsDialog.cc:131
+#: UI/GTK2/src/statisticsDialog.cc:171
 #, fuzzy
 msgid "Running under PID"
 msgstr "PID"
 
-#: UI/GTK2/src/statisticsDialog.cc:135
+#: UI/GTK2/src/statisticsDialog.cc:175
 msgid "Currently not running"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "Crawled"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "files"
 msgstr "archivos"
 
-#: UI/GTK2/src/statisticsDialog.cc:166
+#: UI/GTK2/src/statisticsDialog.cc:205
 msgid "Errors"
 msgstr "Errores"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322
+#: UI/GTK2/src/WorkerThreads.cpp:302
 msgid "Can't index mail here"
 msgstr "No se pudo indizar el buzon de correo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:343
+#: UI/GTK2/src/WorkerThreads.cpp:323
 msgid "is already being indexed"
 msgstr "ya est? indizado"
 
-#: UI/GTK2/src/WorkerThreads.cpp:353
+#: UI/GTK2/src/WorkerThreads.cpp:333
 msgid "is blacklisted"
 msgstr "ya excluido"
 
-#: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
-#: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
-#: UI/GTK2/src/WorkerThreads.cpp:1631
+#: UI/GTK2/src/WorkerThreads.cpp:642 UI/GTK2/src/WorkerThreads.cpp:955
+#: UI/GTK2/src/WorkerThreads.cpp:1040 UI/GTK2/src/WorkerThreads.cpp:1049
+#: UI/GTK2/src/WorkerThreads.cpp:1235 UI/GTK2/src/WorkerThreads.cpp:1505
+#: UI/GTK2/src/WorkerThreads.cpp:1638
 msgid "Index error on"
 msgstr "Error en el ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:785 UI/GTK2/src/WorkerThreads.cpp:983
+#: UI/GTK2/src/WorkerThreads.cpp:765 UI/GTK2/src/WorkerThreads.cpp:976
 msgid "Couldn't create search engine"
 msgstr "No se pudo crear el motor de b?squeda"
 
-#: UI/GTK2/src/WorkerThreads.cpp:797 UI/GTK2/src/WorkerThreads.cpp:997
+#: UI/GTK2/src/WorkerThreads.cpp:791 UI/GTK2/src/WorkerThreads.cpp:990
 msgid "Couldn't run query on search engine"
 msgstr "No se pudo ejecutar la b?squeda contra el motor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:842
+#: UI/GTK2/src/WorkerThreads.cpp:835
 msgid "No title"
 msgstr "Sin t?tulo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1150
+#: UI/GTK2/src/WorkerThreads.cpp:1143
 msgid "Couldn't obtain downloader for protocol"
 msgstr "No se pudo usar un recuperador para el protocolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1161
+#: UI/GTK2/src/WorkerThreads.cpp:1168
 msgid "Couldn't retrieve"
 msgstr "No se pudo descargar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
+#: UI/GTK2/src/WorkerThreads.cpp:1265 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "Cannot index document type"
 msgstr "No se pudo indizar el tipo de documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
+#: UI/GTK2/src/WorkerThreads.cpp:1269 UI/GTK2/src/WorkerThreads.cpp:1348
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1376
+#: UI/GTK2/src/WorkerThreads.cpp:1380
 msgid "Robots META tag forbids indexing"
 msgstr "La etiqueta META Robots proh?be la indizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1430
+#: UI/GTK2/src/WorkerThreads.cpp:1434
 msgid "Couldn't index"
 msgstr "No se pudo indizar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1509
+#: UI/GTK2/src/WorkerThreads.cpp:1516
 msgid "Couldn't unindex document(s)"
 msgstr "No se pudo des-indizar lo(s) documento(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1643
+#: UI/GTK2/src/WorkerThreads.cpp:1650
 msgid "Couldn't update document"
 msgstr "No se pudo actualizar el documento"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2007-03-24 07:28:21 UTC (rev 790)
+++ trunk/po/fr.po	2007-03-25 07:33:34 UTC (rev 791)
@@ -1,4 +1,4 @@
-# fr PO file for pinot.
+# French translation for pinot
 # Copyright (C) 2005 Fabrice Colin
 # This file is distributed under the same license as the pinot package.
 # Fabrice Colin <fabricecolin at users.berlios.de>, 2005.
@@ -29,18 +29,18 @@
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
 #: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
 #: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
-#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
-#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
-#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
-#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1866
+#: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
+#: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
 msgid "My Web Pages"
 msgstr "Mes Pages Web"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
 #: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
-#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
-#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
-#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
+#: UI/GTK2/src/PinotSettings.cpp:1402 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:818 UI/GTK2/src/WorkerThreads.cpp:882
 msgid "My Documents"
 msgstr "Mes Documents"
 
@@ -49,15 +49,15 @@
 msgid "Date"
 msgstr "Date"
 
-#: UI/GTK2/src/indexDialog.cc:130
+#: UI/GTK2/src/indexDialog.cc:122
 msgid "Served by"
 msgstr "Servi par"
 
-#: UI/GTK2/src/indexDialog.cc:134
+#: UI/GTK2/src/indexDialog.cc:124
 msgid "Local"
 msgstr "Local"
 
-#: UI/GTK2/src/indexDialog.cc:300
+#: UI/GTK2/src/indexDialog.cc:286
 msgid "Index location"
 msgstr "Chemin de l'index"
 
@@ -69,7 +69,7 @@
 msgid "..."
 msgstr "..."
 
-#: UI/GTK2/src/indexDialog_glade.cc:70
+#: UI/GTK2/src/indexDialog_glade.cc:70 UI/GTK2/src/prefsDialog_glade.cc:85
 msgid "Type:"
 msgstr "Type:"
 
@@ -77,19 +77,19 @@
 msgid "Location:"
 msgstr "Chemin:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:72
+#: UI/GTK2/src/indexDialog_glade.cc:72 UI/GTK2/src/prefsDialog_glade.cc:86
 msgid "Port:"
 msgstr "Port:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:79
-msgid "Host name:"
-msgstr "Nom de machine:"
+#: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
+msgid "Address:"
+msgstr "Addresse:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:163
+#: UI/GTK2/src/indexDialog_glade.cc:183
 msgid "External index"
 msgstr "Index externe"
 
-#: UI/GTK2/src/importDialog.cc:82 UI/GTK2/src/queryDialog.cc:108
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Aucune"
 
@@ -110,12 +110,12 @@
 msgid "Import URL"
 msgstr "Importer une URL"
 
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:139
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:122
 #: UI/GTK2/src/ResultsTree.cpp:127
 msgid "Title"
 msgstr "Titre"
 
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:142
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:123
 #: UI/GTK2/src/ResultsTree.cpp:137
 msgid "URL"
 msgstr "URL"
@@ -132,7 +132,7 @@
 msgid "Show Next"
 msgstr "Suivants"
 
-#: UI/GTK2/src/IndexPage.cpp:159 UI/GTK2/src/IndexPage.cpp:205
+#: UI/GTK2/src/IndexPage.cpp:150 UI/GTK2/src/IndexPage.cpp:188
 msgid "All labels"
 msgstr "Toutes les etiquettes"
 
@@ -212,7 +212,7 @@
 msgid "Query"
 msgstr "La recherche"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2934
 msgid "on"
 msgstr "sur"
 
@@ -248,8 +248,8 @@
 msgid "Couldn't rename index, name"
 msgstr "N'a pas pu renommer l'index, le nom"
 
-#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2764
 msgid "is already in use"
 msgstr "est deja utilise"
 
@@ -261,101 +261,101 @@
 msgid "Edited index"
 msgstr "Edite l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+#: UI/GTK2/src/mainWindow.cc:1763 UI/GTK2/src/mainWindow.cc:2423
 msgid "Live query"
 msgstr "Recherche"
 
-#: UI/GTK2/src/mainWindow.cc:1780
+#: UI/GTK2/src/mainWindow.cc:1789
 msgid "Couldn't find query"
 msgstr "N'a pas pu trouver"
 
-#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1618
+#: UI/GTK2/src/mainWindow.cc:1982 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/WorkerThreads.cpp:1625
 msgid "Index"
 msgstr "L'index"
 
-#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1622
+#: UI/GTK2/src/mainWindow.cc:1986 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/WorkerThreads.cpp:1629
 msgid "doesn't exist"
 msgstr "n'existe pas"
 
-#: UI/GTK2/src/mainWindow.cc:2131
+#: UI/GTK2/src/mainWindow.cc:2140
 msgid "Remove this document from the index ?"
 msgstr "Enlever ce document de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2150
+#: UI/GTK2/src/mainWindow.cc:2159
 msgid "Remove these documents from the index ?"
 msgstr "Enlever ces documents de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2203
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Un outil de recherche pour le Bureau Libre"
 
-#: UI/GTK2/src/mainWindow.cc:2195
+#: UI/GTK2/src/mainWindow.cc:2204
 msgid "Search the Web and your documents !"
 msgstr "Cherche le Web et vos documents"
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2205
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2240
+#: UI/GTK2/src/mainWindow.cc:2249
 msgid "Index name"
 msgstr "Nom de l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2255
+#: UI/GTK2/src/mainWindow.cc:2264
 msgid "Couldn't add index"
 msgstr "N'a pas pu ajouter l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2269
+#: UI/GTK2/src/mainWindow.cc:2278
 msgid "Added new index"
 msgstr "Ajoute un nouvel index"
 
-#: UI/GTK2/src/mainWindow.cc:2304
+#: UI/GTK2/src/mainWindow.cc:2313
 msgid "Couldn't remove index"
 msgstr "N'a pas pu enlever l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2569
+#: UI/GTK2/src/mainWindow.cc:2578
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Au moins une tache n'est pas terminee. Quitter maintenant ?"
 
-#: UI/GTK2/src/mainWindow.cc:2751
+#: UI/GTK2/src/mainWindow.cc:2760
 msgid "Query name"
 msgstr "Nom de la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2778
+#: UI/GTK2/src/mainWindow.cc:2787
 msgid "Couldn't update query"
 msgstr "N'a pas pu mettre a jour la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Edited query"
 msgstr "Edite la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2793
+#: UI/GTK2/src/mainWindow.cc:2802
 msgid "Couldn't add query"
 msgstr "N'a pas pu ajouter la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2801
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Added new query"
 msgstr "Ajoute une nouvelle recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2814
+#: UI/GTK2/src/mainWindow.cc:2823
 msgid "Query is not set"
 msgstr "Recherche indefinie"
 
-#: UI/GTK2/src/mainWindow.cc:2825
+#: UI/GTK2/src/mainWindow.cc:2834
 msgid "No search engine selected"
 msgstr "Pas de moteur selectionne"
 
-#: UI/GTK2/src/mainWindow.cc:2912
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Please set the Google API key first"
 msgstr "Configurez la clef de l'API Google"
 
-#: UI/GTK2/src/mainWindow.cc:2921
+#: UI/GTK2/src/mainWindow.cc:2930
 msgid "Running query"
 msgstr "Recherche en cours"
 
-#: UI/GTK2/src/mainWindow.cc:3105
+#: UI/GTK2/src/mainWindow.cc:3114
 msgid "No default application defined for type"
 msgstr "Pas d'application definie pour le type"
 
@@ -371,7 +371,7 @@
 msgid "Stored queries"
 msgstr "Recherches sauvegardees"
 
-#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:46
+#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:50
 #: UI/GTK2/src/statisticsDialog_glade.cc:87
 msgid "Status"
 msgstr "Statistiques"
@@ -457,181 +457,197 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
-#: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
+#: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
 msgid "Unknown"
 msgstr "Inconnu"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:227 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Danish"
 msgstr "Danois"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:228 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "Dutch"
 msgstr "Hollandais"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:229 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "English"
 msgstr "Anglais"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:230 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "Finnish"
 msgstr "Finlandais"
 
-#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
+#: UI/GTK2/src/pinot.cc:231 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "French"
 msgstr "Francais"
 
-#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
+#: UI/GTK2/src/pinot.cc:232 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "German"
 msgstr "Allemand"
 
-#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
+#: UI/GTK2/src/pinot.cc:233 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Italian"
 msgstr "Italien"
 
-#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
+#: UI/GTK2/src/pinot.cc:234 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Norwegian"
 msgstr "Norvegien"
 
-#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
+#: UI/GTK2/src/pinot.cc:235 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Portuguese"
 msgstr "Portugais"
 
-#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
+#: UI/GTK2/src/pinot.cc:236 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Russian"
 msgstr "Russe"
 
-#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
+#: UI/GTK2/src/pinot.cc:237 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Spanish"
 msgstr "Espagnol"
 
-#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
+#: UI/GTK2/src/pinot.cc:238 UI/GTK2/src/pinot-dbus-daemon.cc:305
 msgid "Swedish"
 msgstr "Suedois"
 
-#: UI/GTK2/src/pinot.cc:247
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't open index"
 msgstr "N'a pas pu ouvrir l'index"
 
-#: UI/GTK2/src/pinot.cc:263
+#: UI/GTK2/src/pinot.cc:279
 msgid "Couldn't create history database"
 msgstr "N'a pas pu creer la base d'historiques"
 
-#: UI/GTK2/src/PinotSettings.cpp:247
+#: UI/GTK2/src/pinot.cc:309
+msgid "Updating all documents in My Web Pages is recommended"
+msgstr "Il est recommende de mettre a jour tous les documents de Mes Pages Web"
+
+#: UI/GTK2/src/PinotSettings.cpp:249
 msgid "Important"
 msgstr "Important"
 
-#: UI/GTK2/src/PinotSettings.cpp:248
+#: UI/GTK2/src/PinotSettings.cpp:250
 msgid "New"
 msgstr "Nouveau"
 
-#: UI/GTK2/src/PinotSettings.cpp:249
+#: UI/GTK2/src/PinotSettings.cpp:251
 msgid "Personal"
 msgstr "Personnel"
 
-#: UI/GTK2/src/PinotSettings.cpp:1082
+#: UI/GTK2/src/PinotSettings.cpp:1141
 msgid "Unclassified"
 msgstr "Sans classification"
 
-#: UI/GTK2/src/prefsDialog.cc:67
+#: UI/GTK2/src/prefsDialog.cc:82
 msgid "Name"
 msgstr "Nom"
 
-#: UI/GTK2/src/prefsDialog.cc:75
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Monitor"
 msgstr "Surveiller"
 
-#: UI/GTK2/src/prefsDialog.cc:76 UI/GTK2/src/prefsDialog.cc:84
+#: UI/GTK2/src/prefsDialog.cc:91 UI/GTK2/src/prefsDialog.cc:99
 msgid "Location"
 msgstr "Chemin"
 
-#: UI/GTK2/src/prefsDialog.cc:92
+#: UI/GTK2/src/prefsDialog.cc:107
 msgid "Pattern"
 msgstr "Motif"
 
-#: UI/GTK2/src/prefsDialog.cc:423
+#: UI/GTK2/src/prefsDialog.cc:471
 msgid "New Label"
 msgstr "Nouvelle Etiquette"
 
-#: UI/GTK2/src/prefsDialog.cc:464
+#: UI/GTK2/src/prefsDialog.cc:512
 msgid "Directory to index"
 msgstr "Repertoire a indexer"
 
-#: UI/GTK2/src/prefsDialog.cc:522
+#: UI/GTK2/src/prefsDialog.cc:570
 msgid "Mbox File Location"
 msgstr "Chemin du Fichier mbox"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:65
-msgid "HTTP crawling:"
-msgstr "Agent HTTP:"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Clef de l'API Google"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:68
-msgid "Ignore robots.txt and Robots META tag"
-msgstr "Ignorer robots.txt et le META tag Robots"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:70
+#: UI/GTK2/src/prefsDialog_glade.cc:69
 msgid "New results:"
 msgstr "Nouveaux resultats:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:71
+#: UI/GTK2/src/prefsDialog_glade.cc:70
 msgid "Queries:"
 msgstr "Recherches:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:72
+#: UI/GTK2/src/prefsDialog_glade.cc:71
 msgid "Enable search terms suggestion"
 msgstr "Suggerer des termes"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:76
+#: UI/GTK2/src/prefsDialog_glade.cc:73
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "Ignorer robots.txt et le META tag Robots"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "HTTP crawling:"
+msgstr "Agent HTTP:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
 msgid "General"
 msgstr "General"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:77
+#: UI/GTK2/src/prefsDialog_glade.cc:79
+msgid "Direct connection to the Internet"
+msgstr "Connection directe a l'Internet"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80
+msgid "Manual proxy configuration:"
+msgstr "Configuration proxy manuelle"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:93
+msgid "Network"
+msgstr "Reseau"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:94
 msgid "Labels are used to classify indexed documents:"
 msgstr "Les etiquettes servent a classer les documents:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:82 UI/GTK2/src/prefsDialog_glade.cc:102
-#: UI/GTK2/src/prefsDialog_glade.cc:115 UI/GTK2/src/prefsDialog_glade.cc:128
+#: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
+#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
 msgid "Add"
 msgstr "Ajouter"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:88
+#: UI/GTK2/src/prefsDialog_glade.cc:105
 msgid "Remove"
 msgstr "Enlever"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:96
+#: UI/GTK2/src/prefsDialog_glade.cc:113
 msgid "Labels"
 msgstr "Etiquettes"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:97
+#: UI/GTK2/src/prefsDialog_glade.cc:114
 msgid "These directories will be indexed and optionally monitored for changes:"
 msgstr "Ces repertoires seront indexes automatiquement:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:110
+#: UI/GTK2/src/prefsDialog_glade.cc:127
 msgid "Mail boxes of type mbox can be monitored and indexed:"
 msgstr "Les boites de type mbox peuvent etre indexees"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:123
+#: UI/GTK2/src/prefsDialog_glade.cc:140
 msgid "Specify any file pattern you wish to exclude from indexing:"
 msgstr "Specifiez tous les motifs de fichiers a ne pas indexer:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:137
+#: UI/GTK2/src/prefsDialog_glade.cc:154
 msgid "Indexing"
 msgstr "Indexes"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:411
+#: UI/GTK2/src/prefsDialog_glade.cc:566
 msgid "Preferences"
 msgstr "Preferences"
 
-#: UI/GTK2/src/propertiesDialog.cc:52 UI/GTK2/src/queryDialog.cc:154
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "Etiquette"
 
-#: UI/GTK2/src/propertiesDialog.cc:86
+#: UI/GTK2/src/propertiesDialog.cc:81
 msgid "Per document"
 msgstr "Par document"
 
@@ -651,35 +667,35 @@
 msgid "Terms:"
 msgstr "Termes:"
 
-#: UI/GTK2/src/queryDialog.cc:130
+#: UI/GTK2/src/queryDialog.cc:119
 msgid "Host name"
 msgstr "Nom de machine"
 
-#: UI/GTK2/src/queryDialog.cc:133
+#: UI/GTK2/src/queryDialog.cc:120
 msgid "File name"
 msgstr "Nom de fichier"
 
-#: UI/GTK2/src/queryDialog.cc:136
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "File extension"
 msgstr "Extension de fichier"
 
-#: UI/GTK2/src/queryDialog.cc:145
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "Directory"
 msgstr "Repertoire"
 
-#: UI/GTK2/src/queryDialog.cc:148
+#: UI/GTK2/src/queryDialog.cc:125
 msgid "Language code"
 msgstr "Code langue"
 
-#: UI/GTK2/src/queryDialog.cc:151
+#: UI/GTK2/src/queryDialog.cc:126
 msgid "MIME type"
 msgstr "Type MIME"
 
-#: UI/GTK2/src/queryDialog.cc:271
+#: UI/GTK2/src/queryDialog.cc:246
 msgid "Start date"
 msgstr "Debut"
 
-#: UI/GTK2/src/queryDialog.cc:286
+#: UI/GTK2/src/queryDialog.cc:261
 msgid "End date"
 msgstr "Fin"
 
@@ -719,109 +735,114 @@
 msgid "Extract"
 msgstr "Extrait"
 
-#: UI/GTK2/src/statisticsDialog.cc:69
+#: UI/GTK2/src/statisticsDialog.cc:72
 msgid "Indexes"
 msgstr "Indexes"
 
-#: UI/GTK2/src/statisticsDialog.cc:83 UI/GTK2/src/statisticsDialog.cc:97
+#: UI/GTK2/src/statisticsDialog.cc:87
+msgid "History"
+msgstr "Historique"
+
+#: UI/GTK2/src/statisticsDialog.cc:92
+msgid "Daemon"
+msgstr "Daemon"
+
+#: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
 msgid "documents"
 msgstr "documents"
 
-#: UI/GTK2/src/statisticsDialog.cc:102
-msgid "History"
-msgstr "Historique"
+#: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
+#, fuzzy
+msgid "Unknown error"
+msgstr "Inconnu"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 msgid "Viewed"
 msgstr "Visualise"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 msgid "results"
 msgstr "resultats"
 
-#: UI/GTK2/src/statisticsDialog.cc:113
-msgid "Daemon"
-msgstr "Daemon"
-
-#: UI/GTK2/src/statisticsDialog.cc:131
+#: UI/GTK2/src/statisticsDialog.cc:171
 msgid "Running under PID"
 msgstr "PID"
 
-#: UI/GTK2/src/statisticsDialog.cc:135
+#: UI/GTK2/src/statisticsDialog.cc:175
 msgid "Currently not running"
 msgstr "Arrete"
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "Crawled"
 msgstr "Parcouru"
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "files"
 msgstr "fichiers"
 
-#: UI/GTK2/src/statisticsDialog.cc:166
+#: UI/GTK2/src/statisticsDialog.cc:205
 msgid "Errors"
 msgstr "Erreurs"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322
+#: UI/GTK2/src/WorkerThreads.cpp:302
 msgid "Can't index mail here"
 msgstr "Ne peut pas indexer le courrier ici"
 
-#: UI/GTK2/src/WorkerThreads.cpp:343
+#: UI/GTK2/src/WorkerThreads.cpp:323
 msgid "is already being indexed"
 msgstr "est deja indexe"
 
-#: UI/GTK2/src/WorkerThreads.cpp:353
+#: UI/GTK2/src/WorkerThreads.cpp:333
 msgid "is blacklisted"
 msgstr "est exclus"
 
-#: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
-#: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
-#: UI/GTK2/src/WorkerThreads.cpp:1631
+#: UI/GTK2/src/WorkerThreads.cpp:642 UI/GTK2/src/WorkerThreads.cpp:955
+#: UI/GTK2/src/WorkerThreads.cpp:1040 UI/GTK2/src/WorkerThreads.cpp:1049
+#: UI/GTK2/src/WorkerThreads.cpp:1235 UI/GTK2/src/WorkerThreads.cpp:1505
+#: UI/GTK2/src/WorkerThreads.cpp:1638
 msgid "Index error on"
 msgstr "Erreur sur l'index"
 
-#: UI/GTK2/src/WorkerThreads.cpp:785 UI/GTK2/src/WorkerThreads.cpp:983
+#: UI/GTK2/src/WorkerThreads.cpp:765 UI/GTK2/src/WorkerThreads.cpp:976
 msgid "Couldn't create search engine"
 msgstr "N'a pas pu creer le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:797 UI/GTK2/src/WorkerThreads.cpp:997
+#: UI/GTK2/src/WorkerThreads.cpp:791 UI/GTK2/src/WorkerThreads.cpp:990
 msgid "Couldn't run query on search engine"
 msgstr "N'a pas pu lancer la recherche sur le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:842
+#: UI/GTK2/src/WorkerThreads.cpp:835
 msgid "No title"
 msgstr "Pas de titre"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1150
+#: UI/GTK2/src/WorkerThreads.cpp:1143
 msgid "Couldn't obtain downloader for protocol"
 msgstr "N'a pas pu obtenir un brouteur pour"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1161
+#: UI/GTK2/src/WorkerThreads.cpp:1168
 msgid "Couldn't retrieve"
 msgstr "N'a pas pu telecharger"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
+#: UI/GTK2/src/WorkerThreads.cpp:1265 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "Cannot index document type"
 msgstr "Impossible d'indexer ce type de documents"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
+#: UI/GTK2/src/WorkerThreads.cpp:1269 UI/GTK2/src/WorkerThreads.cpp:1348
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1376
+#: UI/GTK2/src/WorkerThreads.cpp:1380
 msgid "Robots META tag forbids indexing"
 msgstr "Le META tag Robots interdit d'indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1430
+#: UI/GTK2/src/WorkerThreads.cpp:1434
 msgid "Couldn't index"
 msgstr "N'a pas pu indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1509
+#: UI/GTK2/src/WorkerThreads.cpp:1516
 msgid "Couldn't unindex document(s)"
 msgstr "N'a pas pu desindexer le(s) document(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1643
+#: UI/GTK2/src/WorkerThreads.cpp:1650
 msgid "Couldn't update document"
 msgstr "N'a pas pu mettre a jour le document"

Modified: trunk/po/it.po
===================================================================
--- trunk/po/it.po	2007-03-24 07:28:21 UTC (rev 790)
+++ trunk/po/it.po	2007-03-25 07:33:34 UTC (rev 791)
@@ -1,14 +1,13 @@
 # Italian translation for pinot
 # Copyright (c) 2006 Rosetta Contributors and Canonical Ltd 2006
 # This file is distributed under the same license as the pinot package.
-# FIRST AUTHOR <EMAIL at ADDRESS>, 2006.
 #
 #, fuzzy
 msgid ""
 msgstr ""
 "Project-Id-Version: pinot\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-03-24 00:44+0800\n"
+"POT-Creation-Date: 2007-03-24 15:37+0800\n"
 "PO-Revision-Date: 2006-11-17 13:20+0000\n"
 "Last-Translator: Michele Angrisano <darksun1988 at gmail.com>\n"
 "Language-Team: Italian <it at li.org>\n"
@@ -25,22 +24,17 @@
 msgid "Current User"
 msgstr "User attuale"
 
-#. Bind the callback's parameter to the index name
-#. Enable these menu items unless it is not the documents index
-#. Internal indices
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
 #: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
 #: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
-#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1866
 #: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
 #: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
 #: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
 msgid "My Web Pages"
 msgstr "Mia pagine web"
 
-#. Populate the submenu
-#. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
 #: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
 #: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
@@ -49,7 +43,6 @@
 msgid "My Documents"
 msgstr "Miei Documenti"
 
-#. The last column is for the timestamp
 #: UI/GTK2/src/dateDialog_glade.cc:76 UI/GTK2/src/queryDialog_glade.cc:91
 #: UI/GTK2/src/queryDialog_glade.cc:92 UI/GTK2/src/ResultsTree.cpp:145
 msgid "Date"
@@ -95,7 +88,7 @@
 msgid "External index"
 msgstr "Indice esterno"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:98
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Nessuno"
 
@@ -116,15 +109,12 @@
 msgid "Import URL"
 msgstr "Importare URL"
 
-#. The score column is used for status icons
-#. This is the title column
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:119
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:122
 #: UI/GTK2/src/ResultsTree.cpp:127
 msgid "Title"
 msgstr "Titolo"
 
-#. URL
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:120
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:123
 #: UI/GTK2/src/ResultsTree.cpp:137
 msgid "URL"
 msgstr "URL"
@@ -171,7 +161,6 @@
 msgid "Summary"
 msgstr "Sommario"
 
-#. Set tooltips
 #: UI/GTK2/src/mainWindow.cc:184
 msgid "Show all search engines"
 msgstr "Mostrare tutti i motori di ricerca"
@@ -184,7 +173,6 @@
 msgid "Remove index"
 msgstr "Rimuovere indice"
 
-#. Now we are ready
 #: UI/GTK2/src/mainWindow.cc:192
 msgid "Ready"
 msgstr "Pronto"
@@ -197,12 +185,10 @@
 msgid "Undefined"
 msgstr ""
 
-#. Show the URL of the first result in the status bar
 #: UI/GTK2/src/mainWindow.cc:476
 msgid "Result location is"
 msgstr "Il risultato della posizione ?"
 
-#. Show the URL in the status bar
 #: UI/GTK2/src/mainWindow.cc:551
 msgid "Document location is"
 msgstr "La posizione Document ?"
@@ -223,7 +209,7 @@
 msgid "Query"
 msgstr "Query"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2934
 msgid "on"
 msgstr "sulla"
 
@@ -239,7 +225,6 @@
 msgid "Updated label(s)"
 msgstr "Descrizione(i) aggiornata"
 
-#. Yes, it did
 #: UI/GTK2/src/mainWindow.cc:1198
 msgid "Updated document"
 msgstr "Documento aggiornato"
@@ -260,8 +245,8 @@
 msgid "Couldn't rename index, name"
 msgstr "Impossibile rinominare l'indice, nome"
 
-#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2764
 msgid "is already in use"
 msgstr "? ora in uso"
 
@@ -273,102 +258,101 @@
 msgid "Edited index"
 msgstr "Indice modificato"
 
-#. Find this query
-#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+#: UI/GTK2/src/mainWindow.cc:1763 UI/GTK2/src/mainWindow.cc:2423
 msgid "Live query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:1780
+#: UI/GTK2/src/mainWindow.cc:1789
 msgid "Couldn't find query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/mainWindow.cc:1982 UI/GTK2/src/WorkerThreads.cpp:629
 #: UI/GTK2/src/WorkerThreads.cpp:1625
 msgid "Index"
 msgstr "Indice"
 
-#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/mainWindow.cc:1986 UI/GTK2/src/WorkerThreads.cpp:633
 #: UI/GTK2/src/WorkerThreads.cpp:1629
 msgid "doesn't exist"
 msgstr "non esiste"
 
-#: UI/GTK2/src/mainWindow.cc:2131
+#: UI/GTK2/src/mainWindow.cc:2140
 msgid "Remove this document from the index ?"
 msgstr "Rimuovere questo documento dall'indice?"
 
-#: UI/GTK2/src/mainWindow.cc:2150
+#: UI/GTK2/src/mainWindow.cc:2159
 msgid "Remove these documents from the index ?"
 msgstr "Rimuovere questi documenti dall'indice?"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2203
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Un tool metasearch per il Free Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2195
+#: UI/GTK2/src/mainWindow.cc:2204
 msgid "Search the Web and your documents !"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2205
 msgid "(C) 2005 Fabrice Colin"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2240
+#: UI/GTK2/src/mainWindow.cc:2249
 msgid "Index name"
 msgstr "Nome indice"
 
-#: UI/GTK2/src/mainWindow.cc:2255
+#: UI/GTK2/src/mainWindow.cc:2264
 msgid "Couldn't add index"
 msgstr "Impossibile aggiungere l'indice"
 
-#: UI/GTK2/src/mainWindow.cc:2269
+#: UI/GTK2/src/mainWindow.cc:2278
 msgid "Added new index"
 msgstr "Nuovo indice aggiunto"
 
-#: UI/GTK2/src/mainWindow.cc:2304
+#: UI/GTK2/src/mainWindow.cc:2313
 msgid "Couldn't remove index"
 msgstr "Impossibile rimuovere l'indice"
 
-#: UI/GTK2/src/mainWindow.cc:2569
+#: UI/GTK2/src/mainWindow.cc:2578
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2751
+#: UI/GTK2/src/mainWindow.cc:2760
 msgid "Query name"
 msgstr "Nome Query"
 
-#: UI/GTK2/src/mainWindow.cc:2778
+#: UI/GTK2/src/mainWindow.cc:2787
 msgid "Couldn't update query"
 msgstr "Impossibile aggiornare il query"
 
-#: UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Edited query"
 msgstr "Query modificato"
 
-#: UI/GTK2/src/mainWindow.cc:2793
+#: UI/GTK2/src/mainWindow.cc:2802
 msgid "Couldn't add query"
 msgstr "Impossibile aggiungere il query"
 
-#: UI/GTK2/src/mainWindow.cc:2801
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Added new query"
 msgstr "Nuovo query aggiunto"
 
-#: UI/GTK2/src/mainWindow.cc:2814
+#: UI/GTK2/src/mainWindow.cc:2823
 msgid "Query is not set"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2825
+#: UI/GTK2/src/mainWindow.cc:2834
 msgid "No search engine selected"
 msgstr "Nessun motore di ricerca selezionato"
 
-#: UI/GTK2/src/mainWindow.cc:2912
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Please set the Google API key first"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2921
+#: UI/GTK2/src/mainWindow.cc:2930
 msgid "Running query"
 msgstr "Avviare query"
 
-#: UI/GTK2/src/mainWindow.cc:3105
+#: UI/GTK2/src/mainWindow.cc:3114
 msgid "No default application defined for type"
 msgstr "Nessuna applicazione di default ? stata definita per tipo"
 
@@ -470,7 +454,6 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#. Localize language names
 #: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
 #: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
 msgid "Unknown"
@@ -532,13 +515,10 @@
 msgid "Couldn't create history database"
 msgstr "Impossibile creare un history del database"
 
-#. Yes, it is
-#. FIXME: use a popup !
 #: UI/GTK2/src/pinot.cc:309
 msgid "Updating all documents in My Web Pages is recommended"
 msgstr ""
 
-#. Add default labels
 #: UI/GTK2/src/PinotSettings.cpp:249
 msgid "Important"
 msgstr "Importante"
@@ -663,7 +643,7 @@
 msgid "Preferences"
 msgstr "Preferenze"
 
-#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:124
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "Descrizione"
 
@@ -687,36 +667,35 @@
 msgid "Terms:"
 msgstr ""
 
-#. All supported filters
-#: UI/GTK2/src/queryDialog.cc:116
+#: UI/GTK2/src/queryDialog.cc:119
 msgid "Host name"
 msgstr "Nome host"
 
-#: UI/GTK2/src/queryDialog.cc:117
+#: UI/GTK2/src/queryDialog.cc:120
 msgid "File name"
 msgstr "Nome file"
 
-#: UI/GTK2/src/queryDialog.cc:118
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "File extension"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:121
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "Directory"
 msgstr "Directory"
 
-#: UI/GTK2/src/queryDialog.cc:122
+#: UI/GTK2/src/queryDialog.cc:125
 msgid "Language code"
 msgstr "Codice di linguaggio"
 
-#: UI/GTK2/src/queryDialog.cc:123
+#: UI/GTK2/src/queryDialog.cc:126
 msgid "MIME type"
 msgstr "Tipo MIME"
 
-#: UI/GTK2/src/queryDialog.cc:237
+#: UI/GTK2/src/queryDialog.cc:246
 msgid "Start date"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:252
+#: UI/GTK2/src/queryDialog.cc:261
 msgid "End date"
 msgstr ""
 
@@ -748,7 +727,6 @@
 msgid "Query parameters"
 msgstr "Parametri Querys"
 
-#. This is the score column
 #: UI/GTK2/src/ResultsTree.cpp:117
 msgid "Score"
 msgstr "Valutazione"
@@ -786,7 +764,6 @@
 msgid "results"
 msgstr ""
 
-#. FIXME: check whether it's actually running !
 #: UI/GTK2/src/statisticsDialog.cc:171
 msgid "Running under PID"
 msgstr ""
@@ -854,7 +831,6 @@
 msgid "at"
 msgstr ""
 
-#. No, it isn't
 #: UI/GTK2/src/WorkerThreads.cpp:1380
 msgid "Robots META tag forbids indexing"
 msgstr ""
@@ -863,7 +839,6 @@
 msgid "Couldn't index"
 msgstr "Impossibile indicizzare"
 
-#. Be pessimistic and assume something will go wrong ;-)
 #: UI/GTK2/src/WorkerThreads.cpp:1516
 msgid "Couldn't unindex document(s)"
 msgstr ""

Modified: trunk/po/nl.po
===================================================================
--- trunk/po/nl.po	2007-03-24 07:28:21 UTC (rev 790)
+++ trunk/po/nl.po	2007-03-25 07:33:34 UTC (rev 791)
@@ -1,7 +1,6 @@
 # Dutch translation for pinot
 # Copyright (c) 2006 Rosetta Contributors and Canonical Ltd 2006
 # This file is distributed under the same license as the pinot package.
-# FIRST AUTHOR <EMAIL at ADDRESS>, 2006.
 #
 #, fuzzy
 msgid ""
@@ -29,18 +28,18 @@
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
 #: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
 #: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
-#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
-#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
-#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
-#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1866
+#: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
+#: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
 msgid "My Web Pages"
 msgstr "Mijn webpagina's"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
 #: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
-#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
-#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
-#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
+#: UI/GTK2/src/PinotSettings.cpp:1402 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:818 UI/GTK2/src/WorkerThreads.cpp:882
 msgid "My Documents"
 msgstr "Mijn documenten"
 
@@ -50,16 +49,16 @@
 msgid "Date"
 msgstr "bij"
 
-#: UI/GTK2/src/indexDialog.cc:130
+#: UI/GTK2/src/indexDialog.cc:122
 msgid "Served by"
 msgstr ""
 
-#: UI/GTK2/src/indexDialog.cc:134
+#: UI/GTK2/src/indexDialog.cc:124
 #, fuzzy
 msgid "Local"
 msgstr "Locatie"
 
-#: UI/GTK2/src/indexDialog.cc:300
+#: UI/GTK2/src/indexDialog.cc:286
 msgid "Index location"
 msgstr "Index locatie"
 
@@ -71,7 +70,7 @@
 msgid "..."
 msgstr "..."
 
-#: UI/GTK2/src/indexDialog_glade.cc:70
+#: UI/GTK2/src/indexDialog_glade.cc:70 UI/GTK2/src/prefsDialog_glade.cc:85
 msgid "Type:"
 msgstr "Type:"
 
@@ -79,20 +78,19 @@
 msgid "Location:"
 msgstr "Locatie"
 
-#: UI/GTK2/src/indexDialog_glade.cc:72
+#: UI/GTK2/src/indexDialog_glade.cc:72 UI/GTK2/src/prefsDialog_glade.cc:86
 msgid "Port:"
 msgstr "Poort:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:79
-#, fuzzy
-msgid "Host name:"
-msgstr "Hostnaam"
+#: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
+msgid "Address:"
+msgstr ""
 
-#: UI/GTK2/src/indexDialog_glade.cc:163
+#: UI/GTK2/src/indexDialog_glade.cc:183
 msgid "External index"
 msgstr "Externe index"
 
-#: UI/GTK2/src/importDialog.cc:82 UI/GTK2/src/queryDialog.cc:108
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Geen"
 
@@ -113,12 +111,12 @@
 msgid "Import URL"
 msgstr "Importeren URL"
 
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:139
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:122
 #: UI/GTK2/src/ResultsTree.cpp:127
 msgid "Title"
 msgstr "Titel"
 
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:142
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:123
 #: UI/GTK2/src/ResultsTree.cpp:137
 msgid "URL"
 msgstr "URL"
@@ -135,7 +133,7 @@
 msgid "Show Next"
 msgstr "Toon volgende"
 
-#: UI/GTK2/src/IndexPage.cpp:159 UI/GTK2/src/IndexPage.cpp:205
+#: UI/GTK2/src/IndexPage.cpp:150 UI/GTK2/src/IndexPage.cpp:188
 msgid "All labels"
 msgstr "Alle namen"
 
@@ -215,7 +213,7 @@
 msgid "Query"
 msgstr "Query"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2934
 msgid "on"
 msgstr "op"
 
@@ -251,8 +249,8 @@
 msgid "Couldn't rename index, name"
 msgstr "Kon index niet hernoemen, naam"
 
-#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2764
 msgid "is already in use"
 msgstr "is reeds in gebruik"
 
@@ -264,103 +262,103 @@
 msgid "Edited index"
 msgstr "Bewerkte index"
 
-#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+#: UI/GTK2/src/mainWindow.cc:1763 UI/GTK2/src/mainWindow.cc:2423
 msgid "Live query"
 msgstr "Rechtstreekse query"
 
-#: UI/GTK2/src/mainWindow.cc:1780
+#: UI/GTK2/src/mainWindow.cc:1789
 msgid "Couldn't find query"
 msgstr "Kon query niet vinden"
 
-#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1618
+#: UI/GTK2/src/mainWindow.cc:1982 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/WorkerThreads.cpp:1625
 msgid "Index"
 msgstr "Inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1622
+#: UI/GTK2/src/mainWindow.cc:1986 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/WorkerThreads.cpp:1629
 msgid "doesn't exist"
 msgstr "bestaat niet"
 
-#: UI/GTK2/src/mainWindow.cc:2131
+#: UI/GTK2/src/mainWindow.cc:2140
 msgid "Remove this document from the index ?"
 msgstr "Verwijder dit document uit de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2150
+#: UI/GTK2/src/mainWindow.cc:2159
 msgid "Remove these documents from the index ?"
 msgstr "Verwijder deze documenten uit de inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2203
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Een metazoek tool voor de Free Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2195
+#: UI/GTK2/src/mainWindow.cc:2204
 msgid "Search the Web and your documents !"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2205
 #, fuzzy
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2240
+#: UI/GTK2/src/mainWindow.cc:2249
 msgid "Index name"
 msgstr "Naam inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2255
+#: UI/GTK2/src/mainWindow.cc:2264
 msgid "Couldn't add index"
 msgstr "Kon inhoudsopgave niet toevoegen"
 
-#: UI/GTK2/src/mainWindow.cc:2269
+#: UI/GTK2/src/mainWindow.cc:2278
 msgid "Added new index"
 msgstr "Nieuwe inhoudsopgave toegevoegd"
 
-#: UI/GTK2/src/mainWindow.cc:2304
+#: UI/GTK2/src/mainWindow.cc:2313
 msgid "Couldn't remove index"
 msgstr "Kon inhoudsopgave niet verwijderen"
 
-#: UI/GTK2/src/mainWindow.cc:2569
+#: UI/GTK2/src/mainWindow.cc:2578
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Tenminste een taak is nog niet gereed. Nu stoppen?"
 
-#: UI/GTK2/src/mainWindow.cc:2751
+#: UI/GTK2/src/mainWindow.cc:2760
 msgid "Query name"
 msgstr "Naam query"
 
-#: UI/GTK2/src/mainWindow.cc:2778
+#: UI/GTK2/src/mainWindow.cc:2787
 msgid "Couldn't update query"
 msgstr "Kon query niet actualiseren"
 
-#: UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Edited query"
 msgstr "Bewerkte query"
 
-#: UI/GTK2/src/mainWindow.cc:2793
+#: UI/GTK2/src/mainWindow.cc:2802
 msgid "Couldn't add query"
 msgstr "Kon query niet toevoegen"
 
-#: UI/GTK2/src/mainWindow.cc:2801
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Added new query"
 msgstr "Nieuwe query toegevoegd"
 
-#: UI/GTK2/src/mainWindow.cc:2814
+#: UI/GTK2/src/mainWindow.cc:2823
 #, fuzzy
 msgid "Query is not set"
 msgstr "Query niet vastgelegd"
 
-#: UI/GTK2/src/mainWindow.cc:2825
+#: UI/GTK2/src/mainWindow.cc:2834
 msgid "No search engine selected"
 msgstr "Geen zoekmachine geselecteerd"
 
-#: UI/GTK2/src/mainWindow.cc:2912
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Please set the Google API key first"
 msgstr "Geef eerst de Google API sleutel in"
 
-#: UI/GTK2/src/mainWindow.cc:2921
+#: UI/GTK2/src/mainWindow.cc:2930
 msgid "Running query"
 msgstr "Lopende query"
 
-#: UI/GTK2/src/mainWindow.cc:3105
+#: UI/GTK2/src/mainWindow.cc:3114
 msgid "No default application defined for type"
 msgstr "Geen standaard toepassing gedefinieerd voor het type"
 
@@ -376,7 +374,7 @@
 msgid "Stored queries"
 msgstr "Opgeslagen queries"
 
-#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:46
+#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:50
 #: UI/GTK2/src/statisticsDialog_glade.cc:87
 msgid "Status"
 msgstr ""
@@ -462,185 +460,201 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
-#: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
+#: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
 msgid "Unknown"
 msgstr "Niet bekend"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:227 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Danish"
 msgstr "Deens"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:228 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "Dutch"
 msgstr "Nederlands"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:229 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "English"
 msgstr "Engels"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:230 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "Finnish"
 msgstr "Fins"
 
-#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
+#: UI/GTK2/src/pinot.cc:231 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "French"
 msgstr "Frans"
 
-#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
+#: UI/GTK2/src/pinot.cc:232 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "German"
 msgstr "Duits"
 
-#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
+#: UI/GTK2/src/pinot.cc:233 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Italian"
 msgstr "Italiaans"
 
-#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
+#: UI/GTK2/src/pinot.cc:234 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Norwegian"
 msgstr "Noors"
 
-#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
+#: UI/GTK2/src/pinot.cc:235 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Portuguese"
 msgstr "Portugees"
 
-#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
+#: UI/GTK2/src/pinot.cc:236 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Russian"
 msgstr "Russisch"
 
-#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
+#: UI/GTK2/src/pinot.cc:237 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Spanish"
 msgstr "Spaans"
 
-#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
+#: UI/GTK2/src/pinot.cc:238 UI/GTK2/src/pinot-dbus-daemon.cc:305
 msgid "Swedish"
 msgstr "Zweeds"
 
-#: UI/GTK2/src/pinot.cc:247
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't open index"
 msgstr "Kan index niet openen"
 
-#: UI/GTK2/src/pinot.cc:263
+#: UI/GTK2/src/pinot.cc:279
 msgid "Couldn't create history database"
 msgstr "Kon historische database niet maken"
 
-#: UI/GTK2/src/PinotSettings.cpp:247
+#: UI/GTK2/src/pinot.cc:309
+msgid "Updating all documents in My Web Pages is recommended"
+msgstr ""
+
+#: UI/GTK2/src/PinotSettings.cpp:249
 msgid "Important"
 msgstr "Belangrijk"
 
-#: UI/GTK2/src/PinotSettings.cpp:248
+#: UI/GTK2/src/PinotSettings.cpp:250
 msgid "New"
 msgstr "Nieuw"
 
-#: UI/GTK2/src/PinotSettings.cpp:249
+#: UI/GTK2/src/PinotSettings.cpp:251
 msgid "Personal"
 msgstr "Persoonlijk"
 
-#: UI/GTK2/src/PinotSettings.cpp:1082
+#: UI/GTK2/src/PinotSettings.cpp:1141
 msgid "Unclassified"
 msgstr "Niet geklassificeerd"
 
-#: UI/GTK2/src/prefsDialog.cc:67
+#: UI/GTK2/src/prefsDialog.cc:82
 msgid "Name"
 msgstr "Naam"
 
-#: UI/GTK2/src/prefsDialog.cc:75
+#: UI/GTK2/src/prefsDialog.cc:90
 #, fuzzy
 msgid "Monitor"
 msgstr "Abonneren"
 
-#: UI/GTK2/src/prefsDialog.cc:76 UI/GTK2/src/prefsDialog.cc:84
+#: UI/GTK2/src/prefsDialog.cc:91 UI/GTK2/src/prefsDialog.cc:99
 msgid "Location"
 msgstr "Locatie"
 
-#: UI/GTK2/src/prefsDialog.cc:92
+#: UI/GTK2/src/prefsDialog.cc:107
 msgid "Pattern"
 msgstr "Patroon"
 
-#: UI/GTK2/src/prefsDialog.cc:423
+#: UI/GTK2/src/prefsDialog.cc:471
 msgid "New Label"
 msgstr "Nieuwe naam"
 
-#: UI/GTK2/src/prefsDialog.cc:464
+#: UI/GTK2/src/prefsDialog.cc:512
 msgid "Directory to index"
 msgstr "Directory naar inhoudsopgave"
 
-#: UI/GTK2/src/prefsDialog.cc:522
+#: UI/GTK2/src/prefsDialog.cc:570
 msgid "Mbox File Location"
 msgstr "Mbox bestandslocatie"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:65
-msgid "HTTP crawling:"
-msgstr "HTTP crawling:"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Google API sleutel:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:68
-msgid "Ignore robots.txt and Robots META tag"
-msgstr "Negeer robots.txt en Robots META tag"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:70
+#: UI/GTK2/src/prefsDialog_glade.cc:69
 msgid "New results:"
 msgstr "Nieuwe resultaten:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:71
+#: UI/GTK2/src/prefsDialog_glade.cc:70
 msgid "Queries:"
 msgstr "Queries:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:72
+#: UI/GTK2/src/prefsDialog_glade.cc:71
 msgid "Enable search terms suggestion"
 msgstr "Zoektermsuggestie aanzetten"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:76
+#: UI/GTK2/src/prefsDialog_glade.cc:73
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "Negeer robots.txt en Robots META tag"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "HTTP crawling:"
+msgstr "HTTP crawling:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
 msgid "General"
 msgstr "Algemeen"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:77
+#: UI/GTK2/src/prefsDialog_glade.cc:79
+msgid "Direct connection to the Internet"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80
+msgid "Manual proxy configuration:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:93
+msgid "Network"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:94
 msgid "Labels are used to classify indexed documents:"
 msgstr ""
 "Bijschriften worden gebruikt om geindexeerde documenten te klassificeren:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:82 UI/GTK2/src/prefsDialog_glade.cc:102
-#: UI/GTK2/src/prefsDialog_glade.cc:115 UI/GTK2/src/prefsDialog_glade.cc:128
+#: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
+#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
 msgid "Add"
 msgstr "Toevoegen"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:88
+#: UI/GTK2/src/prefsDialog_glade.cc:105
 msgid "Remove"
 msgstr "Verwijderen"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:96
+#: UI/GTK2/src/prefsDialog_glade.cc:113
 msgid "Labels"
 msgstr "Bijschriften"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:97
+#: UI/GTK2/src/prefsDialog_glade.cc:114
 msgid "These directories will be indexed and optionally monitored for changes:"
 msgstr ""
 "Deze directories zullen geindexeerd worden en optioneel bijgewerkt worden "
 "bij veranderingen:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:110
+#: UI/GTK2/src/prefsDialog_glade.cc:127
 msgid "Mail boxes of type mbox can be monitored and indexed:"
 msgstr "Mailboxen van het type mbox kunnen worden bijgewerkt en geindexeerd:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:123
+#: UI/GTK2/src/prefsDialog_glade.cc:140
 msgid "Specify any file pattern you wish to exclude from indexing:"
 msgstr "Geef het bestandspatroon aan dat u van indexeren wilt uitsluiten:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:137
+#: UI/GTK2/src/prefsDialog_glade.cc:154
 msgid "Indexing"
 msgstr "Aan het indexeren"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:411
+#: UI/GTK2/src/prefsDialog_glade.cc:566
 msgid "Preferences"
 msgstr "Voorkeuren"
 
-#: UI/GTK2/src/propertiesDialog.cc:52 UI/GTK2/src/queryDialog.cc:154
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "Bijschrift"
 
-#: UI/GTK2/src/propertiesDialog.cc:86
+#: UI/GTK2/src/propertiesDialog.cc:81
 msgid "Per document"
 msgstr "Per document"
 
@@ -660,36 +674,36 @@
 msgid "Terms:"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:130
+#: UI/GTK2/src/queryDialog.cc:119
 msgid "Host name"
 msgstr "Hostnaam"
 
-#: UI/GTK2/src/queryDialog.cc:133
+#: UI/GTK2/src/queryDialog.cc:120
 msgid "File name"
 msgstr "Bestandsnaam"
 
-#: UI/GTK2/src/queryDialog.cc:136
+#: UI/GTK2/src/queryDialog.cc:121
 #, fuzzy
 msgid "File extension"
 msgstr "Bestandssuffix"
 
-#: UI/GTK2/src/queryDialog.cc:145
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "Directory"
 msgstr "Map"
 
-#: UI/GTK2/src/queryDialog.cc:148
+#: UI/GTK2/src/queryDialog.cc:125
 msgid "Language code"
 msgstr "Taal code"
 
-#: UI/GTK2/src/queryDialog.cc:151
+#: UI/GTK2/src/queryDialog.cc:126
 msgid "MIME type"
 msgstr "MIME type"
 
-#: UI/GTK2/src/queryDialog.cc:271
+#: UI/GTK2/src/queryDialog.cc:246
 msgid "Start date"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:286
+#: UI/GTK2/src/queryDialog.cc:261
 msgid "End date"
 msgstr ""
 
@@ -730,115 +744,120 @@
 msgid "Extract"
 msgstr "Uitpakken"
 
-#: UI/GTK2/src/statisticsDialog.cc:69
+#: UI/GTK2/src/statisticsDialog.cc:72
 #, fuzzy
 msgid "Indexes"
 msgstr "Geindexeerd"
 
-#: UI/GTK2/src/statisticsDialog.cc:83 UI/GTK2/src/statisticsDialog.cc:97
+#: UI/GTK2/src/statisticsDialog.cc:87
 #, fuzzy
+msgid "History"
+msgstr "Map"
+
+#: UI/GTK2/src/statisticsDialog.cc:92
+msgid "Daemon"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
+#, fuzzy
 msgid "documents"
 msgstr "Mijn documenten"
 
-#: UI/GTK2/src/statisticsDialog.cc:102
+#: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
 #, fuzzy
-msgid "History"
-msgstr "Map"
+msgid "Unknown error"
+msgstr "Niet bekend"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 #, fuzzy
 msgid "Viewed"
 msgstr "Toon"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 #, fuzzy
 msgid "results"
 msgstr "_Resultaten"
 
-#: UI/GTK2/src/statisticsDialog.cc:113
-msgid "Daemon"
-msgstr ""
-
-#: UI/GTK2/src/statisticsDialog.cc:131
+#: UI/GTK2/src/statisticsDialog.cc:171
 #, fuzzy
 msgid "Running under PID"
 msgstr "Lopende query"
 
-#: UI/GTK2/src/statisticsDialog.cc:135
+#: UI/GTK2/src/statisticsDialog.cc:175
 msgid "Currently not running"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "Crawled"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "files"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:166
+#: UI/GTK2/src/statisticsDialog.cc:205
 msgid "Errors"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:322
+#: UI/GTK2/src/WorkerThreads.cpp:302
 msgid "Can't index mail here"
 msgstr "Kan mail hier niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:343
+#: UI/GTK2/src/WorkerThreads.cpp:323
 msgid "is already being indexed"
 msgstr "wordt al geindexeerd"
 
-#: UI/GTK2/src/WorkerThreads.cpp:353
+#: UI/GTK2/src/WorkerThreads.cpp:333
 msgid "is blacklisted"
 msgstr "staat op blacklist"
 
-#: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
-#: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
-#: UI/GTK2/src/WorkerThreads.cpp:1631
+#: UI/GTK2/src/WorkerThreads.cpp:642 UI/GTK2/src/WorkerThreads.cpp:955
+#: UI/GTK2/src/WorkerThreads.cpp:1040 UI/GTK2/src/WorkerThreads.cpp:1049
+#: UI/GTK2/src/WorkerThreads.cpp:1235 UI/GTK2/src/WorkerThreads.cpp:1505
+#: UI/GTK2/src/WorkerThreads.cpp:1638
 msgid "Index error on"
 msgstr "Indexeringsfout op"
 
-#: UI/GTK2/src/WorkerThreads.cpp:785 UI/GTK2/src/WorkerThreads.cpp:983
+#: UI/GTK2/src/WorkerThreads.cpp:765 UI/GTK2/src/WorkerThreads.cpp:976
 msgid "Couldn't create search engine"
 msgstr "Kon zoekmachine niet maken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:797 UI/GTK2/src/WorkerThreads.cpp:997
+#: UI/GTK2/src/WorkerThreads.cpp:791 UI/GTK2/src/WorkerThreads.cpp:990
 msgid "Couldn't run query on search engine"
 msgstr "Kon query niet uitvoeren op zoekmachine"
 
-#: UI/GTK2/src/WorkerThreads.cpp:842
+#: UI/GTK2/src/WorkerThreads.cpp:835
 msgid "No title"
 msgstr "Geen titel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1150
+#: UI/GTK2/src/WorkerThreads.cpp:1143
 msgid "Couldn't obtain downloader for protocol"
 msgstr "Kon geen downloader verkrijgen voor protocol"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1161
+#: UI/GTK2/src/WorkerThreads.cpp:1168
 msgid "Couldn't retrieve"
 msgstr "Kon niet opzoeken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
+#: UI/GTK2/src/WorkerThreads.cpp:1265 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "Cannot index document type"
 msgstr "Kan documenttype niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
+#: UI/GTK2/src/WorkerThreads.cpp:1269 UI/GTK2/src/WorkerThreads.cpp:1348
 msgid "at"
 msgstr "bij"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1376
+#: UI/GTK2/src/WorkerThreads.cpp:1380
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META taf verbiedt indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1430
+#: UI/GTK2/src/WorkerThreads.cpp:1434
 msgid "Couldn't index"
 msgstr "Kon niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1509
+#: UI/GTK2/src/WorkerThreads.cpp:1516
 msgid "Couldn't unindex document(s)"
 msgstr "Kan indexering van bestand(en) niet ongedaan maken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1643
+#: UI/GTK2/src/WorkerThreads.cpp:1650
 msgid "Couldn't update document"
 msgstr "Kan document niet actualiseren"

Modified: trunk/po/pt.po
===================================================================
--- trunk/po/pt.po	2007-03-24 07:28:21 UTC (rev 790)
+++ trunk/po/pt.po	2007-03-25 07:33:34 UTC (rev 791)
@@ -1,14 +1,13 @@
 # Portuguese translation for pinot
 # Copyright (c) 2007 Rosetta Contributors and Canonical Ltd 2007
 # This file is distributed under the same license as the pinot package.
-# FIRST AUTHOR <EMAIL at ADDRESS>, 2007.
 #
 #, fuzzy
 msgid ""
 msgstr ""
 "Project-Id-Version: pinot\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-03-24 00:44+0800\n"
+"POT-Creation-Date: 2007-03-24 15:37+0800\n"
 "PO-Revision-Date: 2007-03-11 10:32+0000\n"
 "Last-Translator: _PN_boy <pedro_nuno_pn at iol.pt>\n"
 "Language-Team: Portuguese <pt at li.org>\n"
@@ -26,22 +25,17 @@
 msgid "Current User"
 msgstr "Utilizador corrente"
 
-#. Bind the callback's parameter to the index name
-#. Enable these menu items unless it is not the documents index
-#. Internal indices
 #: UI/GTK2/src/EnginesTree.cpp:339 UI/GTK2/src/mainWindow.cc:325
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
 #: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
 #: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
-#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1866
 #: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
 #: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
 #: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
 msgid "My Web Pages"
 msgstr "As minhas p?ginas Web"
 
-#. Populate the submenu
-#. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
 #: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
 #: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
@@ -50,7 +44,6 @@
 msgid "My Documents"
 msgstr "Os Meus Documentos"
 
-#. The last column is for the timestamp
 #: UI/GTK2/src/dateDialog_glade.cc:76 UI/GTK2/src/queryDialog_glade.cc:91
 #: UI/GTK2/src/queryDialog_glade.cc:92 UI/GTK2/src/ResultsTree.cpp:145
 msgid "Date"
@@ -96,7 +89,7 @@
 msgid "External index"
 msgstr "Index externo"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:98
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Nenhum"
 
@@ -117,15 +110,12 @@
 msgid "Import URL"
 msgstr "Importar URL"
 
-#. The score column is used for status icons
-#. This is the title column
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:119
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:122
 #: UI/GTK2/src/ResultsTree.cpp:127
 msgid "Title"
 msgstr "Titulo"
 
-#. URL
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:120
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:123
 #: UI/GTK2/src/ResultsTree.cpp:137
 msgid "URL"
 msgstr "URL"
@@ -172,7 +162,6 @@
 msgid "Summary"
 msgstr "Resumo"
 
-#. Set tooltips
 #: UI/GTK2/src/mainWindow.cc:184
 msgid "Show all search engines"
 msgstr "Mostrar todos os motores de pesquisa"
@@ -185,7 +174,6 @@
 msgid "Remove index"
 msgstr "Remover index"
 
-#. Now we are ready
 #: UI/GTK2/src/mainWindow.cc:192
 msgid "Ready"
 msgstr "Pronto"
@@ -198,12 +186,10 @@
 msgid "Undefined"
 msgstr "Indefinido"
 
-#. Show the URL of the first result in the status bar
 #: UI/GTK2/src/mainWindow.cc:476
 msgid "Result location is"
 msgstr "A localiza??o do resultado ?"
 
-#. Show the URL in the status bar
 #: UI/GTK2/src/mainWindow.cc:551
 msgid "Document location is"
 msgstr "A localiza??o do documento ?"
@@ -224,7 +210,7 @@
 msgid "Query"
 msgstr "Pesquisa"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2934
 msgid "on"
 msgstr "activar"
 
@@ -240,7 +226,6 @@
 msgid "Updated label(s)"
 msgstr ""
 
-#. Yes, it did
 #: UI/GTK2/src/mainWindow.cc:1198
 msgid "Updated document"
 msgstr ""
@@ -261,8 +246,8 @@
 msgid "Couldn't rename index, name"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2764
 msgid "is already in use"
 msgstr "j? est? em uso"
 
@@ -274,102 +259,101 @@
 msgid "Edited index"
 msgstr ""
 
-#. Find this query
-#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+#: UI/GTK2/src/mainWindow.cc:1763 UI/GTK2/src/mainWindow.cc:2423
 msgid "Live query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:1780
+#: UI/GTK2/src/mainWindow.cc:1789
 msgid "Couldn't find query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/mainWindow.cc:1982 UI/GTK2/src/WorkerThreads.cpp:629
 #: UI/GTK2/src/WorkerThreads.cpp:1625
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/mainWindow.cc:1986 UI/GTK2/src/WorkerThreads.cpp:633
 #: UI/GTK2/src/WorkerThreads.cpp:1629
 msgid "doesn't exist"
 msgstr "n?o existe"
 
-#: UI/GTK2/src/mainWindow.cc:2131
+#: UI/GTK2/src/mainWindow.cc:2140
 msgid "Remove this document from the index ?"
 msgstr "Remover este documento do ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2150
+#: UI/GTK2/src/mainWindow.cc:2159
 msgid "Remove these documents from the index ?"
 msgstr "Remover estes documentos do ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2203
 msgid "A metasearch tool for the Free Desktop"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2195
+#: UI/GTK2/src/mainWindow.cc:2204
 msgid "Search the Web and your documents !"
 msgstr "Pesquise a Web e os seus documentos"
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2205
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2240
+#: UI/GTK2/src/mainWindow.cc:2249
 msgid "Index name"
 msgstr "Nome do ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2255
+#: UI/GTK2/src/mainWindow.cc:2264
 msgid "Couldn't add index"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2269
+#: UI/GTK2/src/mainWindow.cc:2278
 msgid "Added new index"
 msgstr "Adicionar novo ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2304
+#: UI/GTK2/src/mainWindow.cc:2313
 msgid "Couldn't remove index"
 msgstr "N?o foi possivel remover o ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2569
+#: UI/GTK2/src/mainWindow.cc:2578
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Pelo menos uma tarefa ainda n?o foi concluida. Sair agora?"
 
-#: UI/GTK2/src/mainWindow.cc:2751
+#: UI/GTK2/src/mainWindow.cc:2760
 msgid "Query name"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2778
+#: UI/GTK2/src/mainWindow.cc:2787
 msgid "Couldn't update query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Edited query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2793
+#: UI/GTK2/src/mainWindow.cc:2802
 msgid "Couldn't add query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2801
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Added new query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2814
+#: UI/GTK2/src/mainWindow.cc:2823
 msgid "Query is not set"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2825
+#: UI/GTK2/src/mainWindow.cc:2834
 msgid "No search engine selected"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2912
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Please set the Google API key first"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2921
+#: UI/GTK2/src/mainWindow.cc:2930
 msgid "Running query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:3105
+#: UI/GTK2/src/mainWindow.cc:3114
 msgid "No default application defined for type"
 msgstr ""
 
@@ -471,7 +455,6 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#. Localize language names
 #: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
 #: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
 msgid "Unknown"
@@ -533,13 +516,10 @@
 msgid "Couldn't create history database"
 msgstr ""
 
-#. Yes, it is
-#. FIXME: use a popup !
 #: UI/GTK2/src/pinot.cc:309
 msgid "Updating all documents in My Web Pages is recommended"
 msgstr ""
 
-#. Add default labels
 #: UI/GTK2/src/PinotSettings.cpp:249
 msgid "Important"
 msgstr "Importante"
@@ -661,7 +641,7 @@
 msgid "Preferences"
 msgstr "Prefer?ncias"
 
-#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:124
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "Etiqueta"
 
@@ -685,36 +665,35 @@
 msgid "Terms:"
 msgstr "Termos:"
 
-#. All supported filters
-#: UI/GTK2/src/queryDialog.cc:116
+#: UI/GTK2/src/queryDialog.cc:119
 msgid "Host name"
 msgstr "Nome da m?quina"
 
-#: UI/GTK2/src/queryDialog.cc:117
+#: UI/GTK2/src/queryDialog.cc:120
 msgid "File name"
 msgstr "Nome do ficheiro"
 
-#: UI/GTK2/src/queryDialog.cc:118
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "File extension"
 msgstr "Extens?o do ficheiro"
 
-#: UI/GTK2/src/queryDialog.cc:121
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "Directory"
 msgstr "Direct?rio"
 
-#: UI/GTK2/src/queryDialog.cc:122
+#: UI/GTK2/src/queryDialog.cc:125
 msgid "Language code"
 msgstr "C?digo do idioma"
 
-#: UI/GTK2/src/queryDialog.cc:123
+#: UI/GTK2/src/queryDialog.cc:126
 msgid "MIME type"
 msgstr "Tipo MIME"
 
-#: UI/GTK2/src/queryDialog.cc:237
+#: UI/GTK2/src/queryDialog.cc:246
 msgid "Start date"
 msgstr "Data de in?cio"
 
-#: UI/GTK2/src/queryDialog.cc:252
+#: UI/GTK2/src/queryDialog.cc:261
 msgid "End date"
 msgstr "Data de fim"
 
@@ -746,7 +725,6 @@
 msgid "Query parameters"
 msgstr ""
 
-#. This is the score column
 #: UI/GTK2/src/ResultsTree.cpp:117
 msgid "Score"
 msgstr ""
@@ -784,7 +762,6 @@
 msgid "results"
 msgstr "resultados"
 
-#. FIXME: check whether it's actually running !
 #: UI/GTK2/src/statisticsDialog.cc:171
 msgid "Running under PID"
 msgstr "A correr com o PID"
@@ -852,7 +829,6 @@
 msgid "at"
 msgstr ""
 
-#. No, it isn't
 #: UI/GTK2/src/WorkerThreads.cpp:1380
 msgid "Robots META tag forbids indexing"
 msgstr ""
@@ -861,7 +837,6 @@
 msgid "Couldn't index"
 msgstr ""
 
-#. Be pessimistic and assume something will go wrong ;-)
 #: UI/GTK2/src/WorkerThreads.cpp:1516
 msgid "Couldn't unindex document(s)"
 msgstr ""
@@ -869,6 +844,3 @@
 #: UI/GTK2/src/WorkerThreads.cpp:1650
 msgid "Couldn't update document"
 msgstr ""
-
-#~ msgid "Host name:"
-#~ msgstr "Nome do servidor:"

Modified: trunk/po/pt_BR.po
===================================================================
--- trunk/po/pt_BR.po	2007-03-24 07:28:21 UTC (rev 790)
+++ trunk/po/pt_BR.po	2007-03-25 07:33:34 UTC (rev 791)
@@ -1,7 +1,6 @@
 # Portuguese (Brazil) translation for pinot
 # Copyright (c) 2006 Rosetta Contributors and Canonical Ltd 2006
 # This file is distributed under the same license as the pinot package.
-# FIRST AUTHOR <EMAIL at ADDRESS>, 2006.
 #
 #, fuzzy
 msgid ""
@@ -29,18 +28,18 @@
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
 #: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
 #: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
-#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
-#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
-#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
-#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1866
+#: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
+#: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
 msgid "My Web Pages"
 msgstr "Minhas P?ginas Web"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
 #: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
-#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
-#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
-#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
+#: UI/GTK2/src/PinotSettings.cpp:1402 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:818 UI/GTK2/src/WorkerThreads.cpp:882
 msgid "My Documents"
 msgstr "Meus Documentos"
 
@@ -50,16 +49,16 @@
 msgid "Date"
 msgstr "no"
 
-#: UI/GTK2/src/indexDialog.cc:130
+#: UI/GTK2/src/indexDialog.cc:122
 msgid "Served by"
 msgstr ""
 
-#: UI/GTK2/src/indexDialog.cc:134
+#: UI/GTK2/src/indexDialog.cc:124
 #, fuzzy
 msgid "Local"
 msgstr "Localiza??o"
 
-#: UI/GTK2/src/indexDialog.cc:300
+#: UI/GTK2/src/indexDialog.cc:286
 msgid "Index location"
 msgstr "Localiza??o do ?ndice"
 
@@ -71,7 +70,7 @@
 msgid "..."
 msgstr "..."
 
-#: UI/GTK2/src/indexDialog_glade.cc:70
+#: UI/GTK2/src/indexDialog_glade.cc:70 UI/GTK2/src/prefsDialog_glade.cc:85
 msgid "Type:"
 msgstr "Tipo:"
 
@@ -79,20 +78,19 @@
 msgid "Location:"
 msgstr "Localiza??o:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:72
+#: UI/GTK2/src/indexDialog_glade.cc:72 UI/GTK2/src/prefsDialog_glade.cc:86
 msgid "Port:"
 msgstr "Porta:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:79
-#, fuzzy
-msgid "Host name:"
-msgstr "Nome do host:"
+#: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
+msgid "Address:"
+msgstr ""
 
-#: UI/GTK2/src/indexDialog_glade.cc:163
+#: UI/GTK2/src/indexDialog_glade.cc:183
 msgid "External index"
 msgstr "?ndice externo"
 
-#: UI/GTK2/src/importDialog.cc:82 UI/GTK2/src/queryDialog.cc:108
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Nenhum"
 
@@ -113,12 +111,12 @@
 msgid "Import URL"
 msgstr "Importar URL"
 
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:139
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:122
 #: UI/GTK2/src/ResultsTree.cpp:127
 msgid "Title"
 msgstr "T?tulo"
 
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:142
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:123
 #: UI/GTK2/src/ResultsTree.cpp:137
 msgid "URL"
 msgstr "URL"
@@ -135,7 +133,7 @@
 msgid "Show Next"
 msgstr "Mostrar pr?ximo"
 
-#: UI/GTK2/src/IndexPage.cpp:159 UI/GTK2/src/IndexPage.cpp:205
+#: UI/GTK2/src/IndexPage.cpp:150 UI/GTK2/src/IndexPage.cpp:188
 msgid "All labels"
 msgstr "Todos t?tulos"
 
@@ -214,7 +212,7 @@
 msgid "Query"
 msgstr "Consulta"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2934
 msgid "on"
 msgstr "no"
 
@@ -250,8 +248,8 @@
 msgid "Couldn't rename index, name"
 msgstr "N?o foi poss?vel renomear ?ndice, nome"
 
-#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2764
 msgid "is already in use"
 msgstr "j? est? em uso"
 
@@ -263,101 +261,101 @@
 msgid "Edited index"
 msgstr "?ndice editado"
 
-#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+#: UI/GTK2/src/mainWindow.cc:1763 UI/GTK2/src/mainWindow.cc:2423
 msgid "Live query"
 msgstr "Query ativa"
 
-#: UI/GTK2/src/mainWindow.cc:1780
+#: UI/GTK2/src/mainWindow.cc:1789
 msgid "Couldn't find query"
 msgstr "N?o foi poss?vel encontrar consulta"
 
-#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1618
+#: UI/GTK2/src/mainWindow.cc:1982 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/WorkerThreads.cpp:1625
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1622
+#: UI/GTK2/src/mainWindow.cc:1986 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/WorkerThreads.cpp:1629
 msgid "doesn't exist"
 msgstr "n?o existe"
 
-#: UI/GTK2/src/mainWindow.cc:2131
+#: UI/GTK2/src/mainWindow.cc:2140
 msgid "Remove this document from the index ?"
 msgstr "Remover documento do ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2150
+#: UI/GTK2/src/mainWindow.cc:2159
 msgid "Remove these documents from the index ?"
 msgstr "Remover documentos do ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2203
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Um mecanismo de metabusca gr?tis para Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2195
+#: UI/GTK2/src/mainWindow.cc:2204
 msgid "Search the Web and your documents !"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2205
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2240
+#: UI/GTK2/src/mainWindow.cc:2249
 msgid "Index name"
 msgstr "Nome do ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2255
+#: UI/GTK2/src/mainWindow.cc:2264
 msgid "Couldn't add index"
 msgstr "N?o foi poss?vel adicionar ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2269
+#: UI/GTK2/src/mainWindow.cc:2278
 msgid "Added new index"
 msgstr "Adicionar novo ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2304
+#: UI/GTK2/src/mainWindow.cc:2313
 msgid "Couldn't remove index"
 msgstr "N?o foi poss?vel remover ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2569
+#: UI/GTK2/src/mainWindow.cc:2578
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Pelo menos uma tarefa n?o terminou ainda. Sair assim mesmo?"
 
-#: UI/GTK2/src/mainWindow.cc:2751
+#: UI/GTK2/src/mainWindow.cc:2760
 msgid "Query name"
 msgstr "Nome da consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2778
+#: UI/GTK2/src/mainWindow.cc:2787
 msgid "Couldn't update query"
 msgstr "N?o foi poss?vel atualizar consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Edited query"
 msgstr "Consulta editada"
 
-#: UI/GTK2/src/mainWindow.cc:2793
+#: UI/GTK2/src/mainWindow.cc:2802
 msgid "Couldn't add query"
 msgstr "N?o foi poss?vel adicionar consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2801
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Added new query"
 msgstr "Adicionar nova consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2814
+#: UI/GTK2/src/mainWindow.cc:2823
 msgid "Query is not set"
 msgstr "Consulta n?o foi atualizada"
 
-#: UI/GTK2/src/mainWindow.cc:2825
+#: UI/GTK2/src/mainWindow.cc:2834
 msgid "No search engine selected"
 msgstr "Nenhum mecanismo de pesquisa selecionado"
 
-#: UI/GTK2/src/mainWindow.cc:2912
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Please set the Google API key first"
 msgstr "Primeiro informe a tecla para Google API"
 
-#: UI/GTK2/src/mainWindow.cc:2921
+#: UI/GTK2/src/mainWindow.cc:2930
 msgid "Running query"
 msgstr "Executando consulta"
 
-#: UI/GTK2/src/mainWindow.cc:3105
+#: UI/GTK2/src/mainWindow.cc:3114
 msgid "No default application defined for type"
 msgstr "Aplica??o associada ao tipo n?o definida"
 
@@ -373,7 +371,7 @@
 msgid "Stored queries"
 msgstr "Consultas armazenadas"
 
-#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:46
+#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:50
 #: UI/GTK2/src/statisticsDialog_glade.cc:87
 msgid "Status"
 msgstr ""
@@ -459,189 +457,205 @@
 msgid "Pinot"
 msgstr "Pino"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
-#: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
+#: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
 msgid "Unknown"
 msgstr "Desconhecido"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:227 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Danish"
 msgstr "Danish"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:228 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "Dutch"
 msgstr "Dutch"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:229 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "English"
 msgstr "English"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:230 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "Finnish"
 msgstr "Terminar"
 
-#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
+#: UI/GTK2/src/pinot.cc:231 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "French"
 msgstr "French"
 
-#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
+#: UI/GTK2/src/pinot.cc:232 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "German"
 msgstr "German"
 
-#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
+#: UI/GTK2/src/pinot.cc:233 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Italian"
 msgstr "Italian"
 
-#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
+#: UI/GTK2/src/pinot.cc:234 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Norwegian"
 msgstr "Norwegian"
 
-#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
+#: UI/GTK2/src/pinot.cc:235 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
+#: UI/GTK2/src/pinot.cc:236 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Russian"
 msgstr "Russian"
 
-#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
+#: UI/GTK2/src/pinot.cc:237 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Spanish"
 msgstr "Spanish"
 
-#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
+#: UI/GTK2/src/pinot.cc:238 UI/GTK2/src/pinot-dbus-daemon.cc:305
 msgid "Swedish"
 msgstr "Swedish"
 
-#: UI/GTK2/src/pinot.cc:247
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't open index"
 msgstr "N?o foi poss?vel abrir ?ndice"
 
-#: UI/GTK2/src/pinot.cc:263
+#: UI/GTK2/src/pinot.cc:279
 msgid "Couldn't create history database"
 msgstr "N?o foi poss?vel criar base de hist?rico"
 
-#: UI/GTK2/src/PinotSettings.cpp:247
+#: UI/GTK2/src/pinot.cc:309
+msgid "Updating all documents in My Web Pages is recommended"
+msgstr ""
+
+#: UI/GTK2/src/PinotSettings.cpp:249
 msgid "Important"
 msgstr "Importante"
 
-#: UI/GTK2/src/PinotSettings.cpp:248
+#: UI/GTK2/src/PinotSettings.cpp:250
 msgid "New"
 msgstr "Novo"
 
-#: UI/GTK2/src/PinotSettings.cpp:249
+#: UI/GTK2/src/PinotSettings.cpp:251
 msgid "Personal"
 msgstr "Pessoal"
 
-#: UI/GTK2/src/PinotSettings.cpp:1082
+#: UI/GTK2/src/PinotSettings.cpp:1141
 msgid "Unclassified"
 msgstr "N?o classificado"
 
-#: UI/GTK2/src/prefsDialog.cc:67
+#: UI/GTK2/src/prefsDialog.cc:82
 msgid "Name"
 msgstr "Nome"
 
-#: UI/GTK2/src/prefsDialog.cc:75
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Monitor"
 msgstr "Monitor"
 
-#: UI/GTK2/src/prefsDialog.cc:76 UI/GTK2/src/prefsDialog.cc:84
+#: UI/GTK2/src/prefsDialog.cc:91 UI/GTK2/src/prefsDialog.cc:99
 msgid "Location"
 msgstr "Localiza??o"
 
-#: UI/GTK2/src/prefsDialog.cc:92
+#: UI/GTK2/src/prefsDialog.cc:107
 msgid "Pattern"
 msgstr "Conjunto"
 
-#: UI/GTK2/src/prefsDialog.cc:423
+#: UI/GTK2/src/prefsDialog.cc:471
 msgid "New Label"
 msgstr "Novo t?tulo"
 
-#: UI/GTK2/src/prefsDialog.cc:464
+#: UI/GTK2/src/prefsDialog.cc:512
 msgid "Directory to index"
 msgstr "Diret?rio do ?ndice"
 
-#: UI/GTK2/src/prefsDialog.cc:522
+#: UI/GTK2/src/prefsDialog.cc:570
 msgid "Mbox File Location"
 msgstr "Mbox localiza??o do arquivo"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:65
-#, fuzzy
-msgid "HTTP crawling:"
-msgstr "HTTP crawling:"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Tecla para Google API:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:68
-msgid "Ignore robots.txt and Robots META tag"
-msgstr "Ignorar robots.txt e Robots META tag"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:70
+#: UI/GTK2/src/prefsDialog_glade.cc:69
 msgid "New results:"
 msgstr "Novos resultados:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:71
+#: UI/GTK2/src/prefsDialog_glade.cc:70
 msgid "Queries:"
 msgstr "Consultas:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:72
+#: UI/GTK2/src/prefsDialog_glade.cc:71
 msgid "Enable search terms suggestion"
 msgstr "Habilitar sugest?o de termos"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:76
+#: UI/GTK2/src/prefsDialog_glade.cc:73
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "Ignorar robots.txt e Robots META tag"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+#, fuzzy
+msgid "HTTP crawling:"
+msgstr "HTTP crawling:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
 msgid "General"
 msgstr "Geral"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:77
+#: UI/GTK2/src/prefsDialog_glade.cc:79
+msgid "Direct connection to the Internet"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80
+msgid "Manual proxy configuration:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:93
+msgid "Network"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:94
 #, fuzzy
 msgid "Labels are used to classify indexed documents:"
 msgstr "T?tulos utilizados para classificar documentos indexados:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:82 UI/GTK2/src/prefsDialog_glade.cc:102
-#: UI/GTK2/src/prefsDialog_glade.cc:115 UI/GTK2/src/prefsDialog_glade.cc:128
+#: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
+#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
 msgid "Add"
 msgstr "Adicionar"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:88
+#: UI/GTK2/src/prefsDialog_glade.cc:105
 msgid "Remove"
 msgstr "Remover"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:96
+#: UI/GTK2/src/prefsDialog_glade.cc:113
 msgid "Labels"
 msgstr "T?tulos"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:97
+#: UI/GTK2/src/prefsDialog_glade.cc:114
 #, fuzzy
 msgid "These directories will be indexed and optionally monitored for changes:"
 msgstr ""
 "Diret?rios que ser?o indexados e opcionalmente ter?o monitoradas suas "
 "altera??es:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:110
+#: UI/GTK2/src/prefsDialog_glade.cc:127
 #, fuzzy
 msgid "Mail boxes of type mbox can be monitored and indexed:"
 msgstr "Caixas de entrada do tipo mbox podem ser monitoradas e indexadas:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:123
+#: UI/GTK2/src/prefsDialog_glade.cc:140
 msgid "Specify any file pattern you wish to exclude from indexing:"
 msgstr ""
 "Especifique qualquer conjunto de arquivos que voc? deseja excluir da "
 "indexa??o:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:137
+#: UI/GTK2/src/prefsDialog_glade.cc:154
 msgid "Indexing"
 msgstr "Indexando"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:411
+#: UI/GTK2/src/prefsDialog_glade.cc:566
 msgid "Preferences"
 msgstr "Prefer?ncias"
 
-#: UI/GTK2/src/propertiesDialog.cc:52 UI/GTK2/src/queryDialog.cc:154
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "T?tulo"
 
-#: UI/GTK2/src/propertiesDialog.cc:86
+#: UI/GTK2/src/propertiesDialog.cc:81
 msgid "Per document"
 msgstr "Por documento"
 
@@ -661,35 +675,35 @@
 msgid "Terms:"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:130
+#: UI/GTK2/src/queryDialog.cc:119
 msgid "Host name"
 msgstr "Nome do host"
 
-#: UI/GTK2/src/queryDialog.cc:133
+#: UI/GTK2/src/queryDialog.cc:120
 msgid "File name"
 msgstr "Nome do arquivo"
 
-#: UI/GTK2/src/queryDialog.cc:136
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "File extension"
 msgstr "Extens?o do arquivo"
 
-#: UI/GTK2/src/queryDialog.cc:145
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "Directory"
 msgstr "Diret?rio"
 
-#: UI/GTK2/src/queryDialog.cc:148
+#: UI/GTK2/src/queryDialog.cc:125
 msgid "Language code"
 msgstr "C?digo da l?ngua"
 
-#: UI/GTK2/src/queryDialog.cc:151
+#: UI/GTK2/src/queryDialog.cc:126
 msgid "MIME type"
 msgstr "Tipo MIME"
 
-#: UI/GTK2/src/queryDialog.cc:271
+#: UI/GTK2/src/queryDialog.cc:246
 msgid "Start date"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:286
+#: UI/GTK2/src/queryDialog.cc:261
 msgid "End date"
 msgstr ""
 
@@ -730,115 +744,120 @@
 msgid "Extract"
 msgstr "Extrair"
 
-#: UI/GTK2/src/statisticsDialog.cc:69
+#: UI/GTK2/src/statisticsDialog.cc:72
 #, fuzzy
 msgid "Indexes"
 msgstr "Indexado"
 
-#: UI/GTK2/src/statisticsDialog.cc:83 UI/GTK2/src/statisticsDialog.cc:97
+#: UI/GTK2/src/statisticsDialog.cc:87
 #, fuzzy
+msgid "History"
+msgstr "Diret?rio"
+
+#: UI/GTK2/src/statisticsDialog.cc:92
+msgid "Daemon"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
+#, fuzzy
 msgid "documents"
 msgstr "Meus Documentos"
 
-#: UI/GTK2/src/statisticsDialog.cc:102
+#: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
 #, fuzzy
-msgid "History"
-msgstr "Diret?rio"
+msgid "Unknown error"
+msgstr "Desconhecido"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 #, fuzzy
 msgid "Viewed"
 msgstr "Visualizar"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 #, fuzzy
 msgid "results"
 msgstr "_Resultados"
 
-#: UI/GTK2/src/statisticsDialog.cc:113
-msgid "Daemon"
-msgstr ""
-
-#: UI/GTK2/src/statisticsDialog.cc:131
+#: UI/GTK2/src/statisticsDialog.cc:171
 #, fuzzy
 msgid "Running under PID"
 msgstr "Executando consulta"
 
-#: UI/GTK2/src/statisticsDialog.cc:135
+#: UI/GTK2/src/statisticsDialog.cc:175
 msgid "Currently not running"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "Crawled"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "files"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:166
+#: UI/GTK2/src/statisticsDialog.cc:205
 msgid "Errors"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:322
+#: UI/GTK2/src/WorkerThreads.cpp:302
 msgid "Can't index mail here"
 msgstr "N?o foi poss?vel indexar mail aqui"
 
-#: UI/GTK2/src/WorkerThreads.cpp:343
+#: UI/GTK2/src/WorkerThreads.cpp:323
 msgid "is already being indexed"
 msgstr "j? est? sendo indexado"
 
-#: UI/GTK2/src/WorkerThreads.cpp:353
+#: UI/GTK2/src/WorkerThreads.cpp:333
 msgid "is blacklisted"
 msgstr "est? na lista negra"
 
-#: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
-#: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
-#: UI/GTK2/src/WorkerThreads.cpp:1631
+#: UI/GTK2/src/WorkerThreads.cpp:642 UI/GTK2/src/WorkerThreads.cpp:955
+#: UI/GTK2/src/WorkerThreads.cpp:1040 UI/GTK2/src/WorkerThreads.cpp:1049
+#: UI/GTK2/src/WorkerThreads.cpp:1235 UI/GTK2/src/WorkerThreads.cpp:1505
+#: UI/GTK2/src/WorkerThreads.cpp:1638
 msgid "Index error on"
 msgstr "Erro no ?ndice no"
 
-#: UI/GTK2/src/WorkerThreads.cpp:785 UI/GTK2/src/WorkerThreads.cpp:983
+#: UI/GTK2/src/WorkerThreads.cpp:765 UI/GTK2/src/WorkerThreads.cpp:976
 msgid "Couldn't create search engine"
 msgstr "N?o foi poss?vel criar mecanismo de pesquisa"
 
-#: UI/GTK2/src/WorkerThreads.cpp:797 UI/GTK2/src/WorkerThreads.cpp:997
+#: UI/GTK2/src/WorkerThreads.cpp:791 UI/GTK2/src/WorkerThreads.cpp:990
 msgid "Couldn't run query on search engine"
 msgstr "N?o foi poss?vel executar consulta no mecanismo de pesquisa"
 
-#: UI/GTK2/src/WorkerThreads.cpp:842
+#: UI/GTK2/src/WorkerThreads.cpp:835
 msgid "No title"
 msgstr "Sem t?tulo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1150
+#: UI/GTK2/src/WorkerThreads.cpp:1143
 msgid "Couldn't obtain downloader for protocol"
 msgstr "N?o foi poss?vel obter fonte de download para o protocolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1161
+#: UI/GTK2/src/WorkerThreads.cpp:1168
 msgid "Couldn't retrieve"
 msgstr "N?o foi poss?vel carregar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
+#: UI/GTK2/src/WorkerThreads.cpp:1265 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "Cannot index document type"
 msgstr "Imposs?vel indexar tipo de arquivo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
+#: UI/GTK2/src/WorkerThreads.cpp:1269 UI/GTK2/src/WorkerThreads.cpp:1348
 msgid "at"
 msgstr "no"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1376
+#: UI/GTK2/src/WorkerThreads.cpp:1380
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META tag n?o s?o permitidos no ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1430
+#: UI/GTK2/src/WorkerThreads.cpp:1434
 msgid "Couldn't index"
 msgstr "N?o foi poss?vel indexar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1509
+#: UI/GTK2/src/WorkerThreads.cpp:1516
 msgid "Couldn't unindex document(s)"
 msgstr "N?o foi poss?vel remover documento(s) do ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1643
+#: UI/GTK2/src/WorkerThreads.cpp:1650
 msgid "Couldn't update document"
 msgstr "N?o foi poss?vel atualizar documento"

Modified: trunk/po/ru.po
===================================================================
--- trunk/po/ru.po	2007-03-24 07:28:21 UTC (rev 790)
+++ trunk/po/ru.po	2007-03-25 07:33:34 UTC (rev 791)
@@ -1,7 +1,6 @@
 # Russian translation for pinot
 # Copyright (c) 2006 Rosetta Contributors and Canonical Ltd 2006
 # This file is distributed under the same license as the pinot package.
-# FIRST AUTHOR <EMAIL at ADDRESS>, 2006.
 #
 #, fuzzy
 msgid ""
@@ -29,18 +28,18 @@
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
 #: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
 #: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
-#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
-#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
-#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
-#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1866
+#: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
+#: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
 msgid "My Web Pages"
 msgstr "??? web-????????"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
 #: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
-#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
-#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
-#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
+#: UI/GTK2/src/PinotSettings.cpp:1402 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:818 UI/GTK2/src/WorkerThreads.cpp:882
 msgid "My Documents"
 msgstr "??? ?????????"
 
@@ -50,16 +49,16 @@
 msgid "Date"
 msgstr "?"
 
-#: UI/GTK2/src/indexDialog.cc:130
+#: UI/GTK2/src/indexDialog.cc:122
 msgid "Served by"
 msgstr ""
 
-#: UI/GTK2/src/indexDialog.cc:134
+#: UI/GTK2/src/indexDialog.cc:124
 #, fuzzy
 msgid "Local"
 msgstr "?????????????????"
 
-#: UI/GTK2/src/indexDialog.cc:300
+#: UI/GTK2/src/indexDialog.cc:286
 msgid "Index location"
 msgstr "????????? ??????????????"
 
@@ -71,7 +70,7 @@
 msgid "..."
 msgstr "..."
 
-#: UI/GTK2/src/indexDialog_glade.cc:70
+#: UI/GTK2/src/indexDialog_glade.cc:70 UI/GTK2/src/prefsDialog_glade.cc:85
 msgid "Type:"
 msgstr "???:"
 
@@ -79,20 +78,19 @@
 msgid "Location:"
 msgstr "??????????:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:72
+#: UI/GTK2/src/indexDialog_glade.cc:72 UI/GTK2/src/prefsDialog_glade.cc:86
 msgid "Port:"
 msgstr "????:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:79
-#, fuzzy
-msgid "Host name:"
-msgstr "??? ????:"
+#: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
+msgid "Address:"
+msgstr ""
 
-#: UI/GTK2/src/indexDialog_glade.cc:163
+#: UI/GTK2/src/indexDialog_glade.cc:183
 msgid "External index"
 msgstr "??????? ??????"
 
-#: UI/GTK2/src/importDialog.cc:82 UI/GTK2/src/queryDialog.cc:108
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "???"
 
@@ -113,12 +111,12 @@
 msgid "Import URL"
 msgstr "?????? URL"
 
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:139
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:122
 #: UI/GTK2/src/ResultsTree.cpp:127
 msgid "Title"
 msgstr "????????"
 
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:142
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:123
 #: UI/GTK2/src/ResultsTree.cpp:137
 msgid "URL"
 msgstr "URL"
@@ -135,7 +133,7 @@
 msgid "Show Next"
 msgstr "???????? ?????????"
 
-#: UI/GTK2/src/IndexPage.cpp:159 UI/GTK2/src/IndexPage.cpp:205
+#: UI/GTK2/src/IndexPage.cpp:150 UI/GTK2/src/IndexPage.cpp:188
 msgid "All labels"
 msgstr "??? ?????"
 
@@ -214,7 +212,7 @@
 msgid "Query"
 msgstr "??????"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2934
 msgid "on"
 msgstr "??"
 
@@ -250,8 +248,8 @@
 msgid "Couldn't rename index, name"
 msgstr "?????????? ????????????? ??????, ????????"
 
-#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2764
 msgid "is already in use"
 msgstr "??? ????????????"
 
@@ -263,101 +261,101 @@
 msgid "Edited index"
 msgstr "?????????????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+#: UI/GTK2/src/mainWindow.cc:1763 UI/GTK2/src/mainWindow.cc:2423
 msgid "Live query"
 msgstr "???????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:1780
+#: UI/GTK2/src/mainWindow.cc:1789
 msgid "Couldn't find query"
 msgstr "?????????? ????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1618
+#: UI/GTK2/src/mainWindow.cc:1982 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/WorkerThreads.cpp:1625
 msgid "Index"
 msgstr "??????"
 
-#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1622
+#: UI/GTK2/src/mainWindow.cc:1986 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/WorkerThreads.cpp:1629
 msgid "doesn't exist"
 msgstr "???"
 
-#: UI/GTK2/src/mainWindow.cc:2131
+#: UI/GTK2/src/mainWindow.cc:2140
 msgid "Remove this document from the index ?"
 msgstr "??????? ???????? ?? ??????? ?"
 
-#: UI/GTK2/src/mainWindow.cc:2150
+#: UI/GTK2/src/mainWindow.cc:2159
 msgid "Remove these documents from the index ?"
 msgstr "??????? ??? ????????? ?? ????????"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2203
 msgid "A metasearch tool for the Free Desktop"
 msgstr "?????????? ?????????? ??? ?????????? ????????"
 
-#: UI/GTK2/src/mainWindow.cc:2195
+#: UI/GTK2/src/mainWindow.cc:2204
 msgid "Search the Web and your documents !"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2205
 msgid "(C) 2005 Fabrice Colin"
 msgstr "(C) 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2240
+#: UI/GTK2/src/mainWindow.cc:2249
 msgid "Index name"
 msgstr "???????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2255
+#: UI/GTK2/src/mainWindow.cc:2264
 msgid "Couldn't add index"
 msgstr "?????????? ???????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2269
+#: UI/GTK2/src/mainWindow.cc:2278
 msgid "Added new index"
 msgstr "???????? ????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2304
+#: UI/GTK2/src/mainWindow.cc:2313
 msgid "Couldn't remove index"
 msgstr "?????????? ??????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2569
+#: UI/GTK2/src/mainWindow.cc:2578
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "?? ??????? ???? ???? ?????? ??? ?? ?????????. ????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2751
+#: UI/GTK2/src/mainWindow.cc:2760
 msgid "Query name"
 msgstr "???????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2778
+#: UI/GTK2/src/mainWindow.cc:2787
 msgid "Couldn't update query"
 msgstr "?????????? ???????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Edited query"
 msgstr "?????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2793
+#: UI/GTK2/src/mainWindow.cc:2802
 msgid "Couldn't add query"
 msgstr "?????????? ???????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2801
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Added new query"
 msgstr "???????? ????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2814
+#: UI/GTK2/src/mainWindow.cc:2823
 msgid "Query is not set"
 msgstr "?????? ?? ??????????"
 
-#: UI/GTK2/src/mainWindow.cc:2825
+#: UI/GTK2/src/mainWindow.cc:2834
 msgid "No search engine selected"
 msgstr "?? ???? ????????? ??????? ?? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:2912
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Please set the Google API key first"
 msgstr "??????????, ??????? ????????????? ???? Google API"
 
-#: UI/GTK2/src/mainWindow.cc:2921
+#: UI/GTK2/src/mainWindow.cc:2930
 msgid "Running query"
 msgstr "?????? ???????"
 
-#: UI/GTK2/src/mainWindow.cc:3105
+#: UI/GTK2/src/mainWindow.cc:3114
 msgid "No default application defined for type"
 msgstr "?? ???? ?????????? ?? ????????? ?? ?????????? ??? ???? ??????????"
 
@@ -373,7 +371,7 @@
 msgid "Stored queries"
 msgstr "??????????? ???????"
 
-#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:46
+#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:50
 #: UI/GTK2/src/statisticsDialog_glade.cc:87
 msgid "Status"
 msgstr ""
@@ -459,182 +457,198 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
-#: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
+#: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
 msgid "Unknown"
 msgstr "???????????"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:227 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Danish"
 msgstr "???????"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:228 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "Dutch"
 msgstr "???????????"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:229 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "English"
 msgstr "??????????"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:230 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "Finnish"
 msgstr "???????"
 
-#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
+#: UI/GTK2/src/pinot.cc:231 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "French"
 msgstr "???????????"
 
-#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
+#: UI/GTK2/src/pinot.cc:232 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "German"
 msgstr "????????"
 
-#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
+#: UI/GTK2/src/pinot.cc:233 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Italian"
 msgstr "???????????"
 
-#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
+#: UI/GTK2/src/pinot.cc:234 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Norwegian"
 msgstr "??????????"
 
-#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
+#: UI/GTK2/src/pinot.cc:235 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Portuguese"
 msgstr "?????????????"
 
-#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
+#: UI/GTK2/src/pinot.cc:236 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Russian"
 msgstr "???????"
 
-#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
+#: UI/GTK2/src/pinot.cc:237 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Spanish"
 msgstr "?????????"
 
-#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
+#: UI/GTK2/src/pinot.cc:238 UI/GTK2/src/pinot-dbus-daemon.cc:305
 msgid "Swedish"
 msgstr "????????"
 
-#: UI/GTK2/src/pinot.cc:247
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't open index"
 msgstr "?????????? ??????? ??????"
 
-#: UI/GTK2/src/pinot.cc:263
+#: UI/GTK2/src/pinot.cc:279
 msgid "Couldn't create history database"
 msgstr "?? ??????? ??????? ???? ?????? ???????"
 
-#: UI/GTK2/src/PinotSettings.cpp:247
+#: UI/GTK2/src/pinot.cc:309
+msgid "Updating all documents in My Web Pages is recommended"
+msgstr ""
+
+#: UI/GTK2/src/PinotSettings.cpp:249
 msgid "Important"
 msgstr "?????"
 
-#: UI/GTK2/src/PinotSettings.cpp:248
+#: UI/GTK2/src/PinotSettings.cpp:250
 msgid "New"
 msgstr "???????"
 
-#: UI/GTK2/src/PinotSettings.cpp:249
+#: UI/GTK2/src/PinotSettings.cpp:251
 msgid "Personal"
 msgstr "??????"
 
-#: UI/GTK2/src/PinotSettings.cpp:1082
+#: UI/GTK2/src/PinotSettings.cpp:1141
 msgid "Unclassified"
 msgstr "??????????????"
 
-#: UI/GTK2/src/prefsDialog.cc:67
+#: UI/GTK2/src/prefsDialog.cc:82
 msgid "Name"
 msgstr "???"
 
-#: UI/GTK2/src/prefsDialog.cc:75
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Monitor"
 msgstr "???????"
 
-#: UI/GTK2/src/prefsDialog.cc:76 UI/GTK2/src/prefsDialog.cc:84
+#: UI/GTK2/src/prefsDialog.cc:91 UI/GTK2/src/prefsDialog.cc:99
 msgid "Location"
 msgstr "?????????????????"
 
-#: UI/GTK2/src/prefsDialog.cc:92
+#: UI/GTK2/src/prefsDialog.cc:107
 msgid "Pattern"
 msgstr "???????"
 
-#: UI/GTK2/src/prefsDialog.cc:423
+#: UI/GTK2/src/prefsDialog.cc:471
 msgid "New Label"
 msgstr "????? ?????"
 
-#: UI/GTK2/src/prefsDialog.cc:464
+#: UI/GTK2/src/prefsDialog.cc:512
 msgid "Directory to index"
 msgstr "????? ??? ??????????????"
 
-#: UI/GTK2/src/prefsDialog.cc:522
+#: UI/GTK2/src/prefsDialog.cc:570
 msgid "Mbox File Location"
 msgstr "?????????????? ????? Mbox"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:65
-msgid "HTTP crawling:"
-msgstr "HTTP ????????????:"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "???? Google API:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:68
-msgid "Ignore robots.txt and Robots META tag"
-msgstr "???????????? robots.txt ? Robots META ???"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:70
+#: UI/GTK2/src/prefsDialog_glade.cc:69
 msgid "New results:"
 msgstr "????? ??????????:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:71
+#: UI/GTK2/src/prefsDialog_glade.cc:70
 msgid "Queries:"
 msgstr "???????:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:72
+#: UI/GTK2/src/prefsDialog_glade.cc:71
 msgid "Enable search terms suggestion"
 msgstr "????????? ?????? ???????????"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:76
+#: UI/GTK2/src/prefsDialog_glade.cc:73
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "???????????? robots.txt ? Robots META ???"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "HTTP crawling:"
+msgstr "HTTP ????????????:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
 msgid "General"
 msgstr "?????"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:77
+#: UI/GTK2/src/prefsDialog_glade.cc:79
+msgid "Direct connection to the Internet"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80
+msgid "Manual proxy configuration:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:93
+msgid "Network"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:94
 msgid "Labels are used to classify indexed documents:"
 msgstr "?????, ???????????? ??? ????????????? ??????????, ????????????? :"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:82 UI/GTK2/src/prefsDialog_glade.cc:102
-#: UI/GTK2/src/prefsDialog_glade.cc:115 UI/GTK2/src/prefsDialog_glade.cc:128
+#: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
+#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
 msgid "Add"
 msgstr "????????"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:88
+#: UI/GTK2/src/prefsDialog_glade.cc:105
 msgid "Remove"
 msgstr "???????"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:96
+#: UI/GTK2/src/prefsDialog_glade.cc:113
 msgid "Labels"
 msgstr "?????"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:97
+#: UI/GTK2/src/prefsDialog_glade.cc:114
 msgid "These directories will be indexed and optionally monitored for changes:"
 msgstr ""
 "??? ???????? ????? ??????????????? ? ????????????? ??? ???????? ?????????:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:110
+#: UI/GTK2/src/prefsDialog_glade.cc:127
 msgid "Mail boxes of type mbox can be monitored and indexed:"
 msgstr "???????? ????? ???? mbox ????? ?????????????? ? ?????????????:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:123
+#: UI/GTK2/src/prefsDialog_glade.cc:140
 msgid "Specify any file pattern you wish to exclude from indexing:"
 msgstr "??????? ????? ???? ?? ?????, ??????? ????? ????????? ?? ???????:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:137
+#: UI/GTK2/src/prefsDialog_glade.cc:154
 msgid "Indexing"
 msgstr "??????????????"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:411
+#: UI/GTK2/src/prefsDialog_glade.cc:566
 msgid "Preferences"
 msgstr "?????????"
 
-#: UI/GTK2/src/propertiesDialog.cc:52 UI/GTK2/src/queryDialog.cc:154
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "?????"
 
-#: UI/GTK2/src/propertiesDialog.cc:86
+#: UI/GTK2/src/propertiesDialog.cc:81
 msgid "Per document"
 msgstr "??? ?????????? ?????????"
 
@@ -654,35 +668,35 @@
 msgid "Terms:"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:130
+#: UI/GTK2/src/queryDialog.cc:119
 msgid "Host name"
 msgstr "??? ????"
 
-#: UI/GTK2/src/queryDialog.cc:133
+#: UI/GTK2/src/queryDialog.cc:120
 msgid "File name"
 msgstr "????"
 
-#: UI/GTK2/src/queryDialog.cc:136
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "File extension"
 msgstr "?????????? ?????"
 
-#: UI/GTK2/src/queryDialog.cc:145
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "Directory"
 msgstr "???????? ??????????"
 
-#: UI/GTK2/src/queryDialog.cc:148
+#: UI/GTK2/src/queryDialog.cc:125
 msgid "Language code"
 msgstr "??? ?????"
 
-#: UI/GTK2/src/queryDialog.cc:151
+#: UI/GTK2/src/queryDialog.cc:126
 msgid "MIME type"
 msgstr "??? MIME"
 
-#: UI/GTK2/src/queryDialog.cc:271
+#: UI/GTK2/src/queryDialog.cc:246
 msgid "Start date"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:286
+#: UI/GTK2/src/queryDialog.cc:261
 msgid "End date"
 msgstr ""
 
@@ -723,115 +737,120 @@
 msgid "Extract"
 msgstr "??????????"
 
-#: UI/GTK2/src/statisticsDialog.cc:69
+#: UI/GTK2/src/statisticsDialog.cc:72
 #, fuzzy
 msgid "Indexes"
 msgstr "?????????????"
 
-#: UI/GTK2/src/statisticsDialog.cc:83 UI/GTK2/src/statisticsDialog.cc:97
+#: UI/GTK2/src/statisticsDialog.cc:87
 #, fuzzy
+msgid "History"
+msgstr "???????? ??????????"
+
+#: UI/GTK2/src/statisticsDialog.cc:92
+msgid "Daemon"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
+#, fuzzy
 msgid "documents"
 msgstr "??? ?????????"
 
-#: UI/GTK2/src/statisticsDialog.cc:102
+#: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
 #, fuzzy
-msgid "History"
-msgstr "???????? ??????????"
+msgid "Unknown error"
+msgstr "???????????"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 #, fuzzy
 msgid "Viewed"
 msgstr "???"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 #, fuzzy
 msgid "results"
 msgstr "_?????????"
 
-#: UI/GTK2/src/statisticsDialog.cc:113
-msgid "Daemon"
-msgstr ""
-
-#: UI/GTK2/src/statisticsDialog.cc:131
+#: UI/GTK2/src/statisticsDialog.cc:171
 #, fuzzy
 msgid "Running under PID"
 msgstr "?????? ???????"
 
-#: UI/GTK2/src/statisticsDialog.cc:135
+#: UI/GTK2/src/statisticsDialog.cc:175
 msgid "Currently not running"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "Crawled"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "files"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:166
+#: UI/GTK2/src/statisticsDialog.cc:205
 msgid "Errors"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:322
+#: UI/GTK2/src/WorkerThreads.cpp:302
 msgid "Can't index mail here"
 msgstr "?????? ????????????? ????? ?????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:343
+#: UI/GTK2/src/WorkerThreads.cpp:323
 msgid "is already being indexed"
 msgstr "??? ??????????????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:353
+#: UI/GTK2/src/WorkerThreads.cpp:333
 msgid "is blacklisted"
 msgstr "??????????? ? ?????? ??????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
-#: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
-#: UI/GTK2/src/WorkerThreads.cpp:1631
+#: UI/GTK2/src/WorkerThreads.cpp:642 UI/GTK2/src/WorkerThreads.cpp:955
+#: UI/GTK2/src/WorkerThreads.cpp:1040 UI/GTK2/src/WorkerThreads.cpp:1049
+#: UI/GTK2/src/WorkerThreads.cpp:1235 UI/GTK2/src/WorkerThreads.cpp:1505
+#: UI/GTK2/src/WorkerThreads.cpp:1638
 msgid "Index error on"
 msgstr "?????? ??????? ??"
 
-#: UI/GTK2/src/WorkerThreads.cpp:785 UI/GTK2/src/WorkerThreads.cpp:983
+#: UI/GTK2/src/WorkerThreads.cpp:765 UI/GTK2/src/WorkerThreads.cpp:976
 msgid "Couldn't create search engine"
 msgstr "?? ??????? ??????? ????????? ???????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:797 UI/GTK2/src/WorkerThreads.cpp:997
+#: UI/GTK2/src/WorkerThreads.cpp:791 UI/GTK2/src/WorkerThreads.cpp:990
 msgid "Couldn't run query on search engine"
 msgstr "?? ??????? ????????? ?????? ? ????????? ???????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:842
+#: UI/GTK2/src/WorkerThreads.cpp:835
 msgid "No title"
 msgstr "??? ????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1150
+#: UI/GTK2/src/WorkerThreads.cpp:1143
 msgid "Couldn't obtain downloader for protocol"
 msgstr "?? ??????? ???????? ????????? ??? ?????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1161
+#: UI/GTK2/src/WorkerThreads.cpp:1168
 msgid "Couldn't retrieve"
 msgstr "?? ??????? ???????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
+#: UI/GTK2/src/WorkerThreads.cpp:1265 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "Cannot index document type"
 msgstr "?????????? ????????????? ?????? ??? ??????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
+#: UI/GTK2/src/WorkerThreads.cpp:1269 UI/GTK2/src/WorkerThreads.cpp:1348
 msgid "at"
 msgstr "?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1376
+#: UI/GTK2/src/WorkerThreads.cpp:1380
 msgid "Robots META tag forbids indexing"
 msgstr "META-???? ??????? ????????? ??????????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1430
+#: UI/GTK2/src/WorkerThreads.cpp:1434
 msgid "Couldn't index"
 msgstr "?????????? ????????? ??????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1509
+#: UI/GTK2/src/WorkerThreads.cpp:1516
 msgid "Couldn't unindex document(s)"
 msgstr "?????????? ??????????????? ????????(?)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1643
+#: UI/GTK2/src/WorkerThreads.cpp:1650
 msgid "Couldn't update document"
 msgstr "?????????? ???????? ????????"

Modified: trunk/po/sv.po
===================================================================
--- trunk/po/sv.po	2007-03-24 07:28:21 UTC (rev 790)
+++ trunk/po/sv.po	2007-03-25 07:33:34 UTC (rev 791)
@@ -29,18 +29,18 @@
 #: UI/GTK2/src/mainWindow.cc:328 UI/GTK2/src/mainWindow.cc:541
 #: UI/GTK2/src/mainWindow.cc:1017 UI/GTK2/src/mainWindow.cc:1188
 #: UI/GTK2/src/mainWindow.cc:1231 UI/GTK2/src/mainWindow.cc:1253
-#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1857
-#: UI/GTK2/src/PinotSettings.cpp:241 UI/GTK2/src/PinotSettings.cpp:1278
-#: UI/GTK2/src/PinotSettings.cpp:1334 UI/GTK2/src/statisticsDialog.cc:74
-#: UI/GTK2/src/WorkerThreads.cpp:820 UI/GTK2/src/WorkerThreads.cpp:879
+#: UI/GTK2/src/mainWindow.cc:1284 UI/GTK2/src/mainWindow.cc:1866
+#: UI/GTK2/src/PinotSettings.cpp:243 UI/GTK2/src/PinotSettings.cpp:1345
+#: UI/GTK2/src/PinotSettings.cpp:1401 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:813 UI/GTK2/src/WorkerThreads.cpp:872
 msgid "My Web Pages"
 msgstr "Mina webbsidor"
 
 #: UI/GTK2/src/EnginesTree.cpp:340 UI/GTK2/src/mainWindow.cc:319
 #: UI/GTK2/src/mainWindow.cc:322 UI/GTK2/src/mainWindow.cc:1024
-#: UI/GTK2/src/PinotSettings.cpp:242 UI/GTK2/src/PinotSettings.cpp:1279
-#: UI/GTK2/src/PinotSettings.cpp:1335 UI/GTK2/src/statisticsDialog.cc:88
-#: UI/GTK2/src/WorkerThreads.cpp:825 UI/GTK2/src/WorkerThreads.cpp:889
+#: UI/GTK2/src/PinotSettings.cpp:244 UI/GTK2/src/PinotSettings.cpp:1346
+#: UI/GTK2/src/PinotSettings.cpp:1402 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:818 UI/GTK2/src/WorkerThreads.cpp:882
 msgid "My Documents"
 msgstr "Mina dokument"
 
@@ -50,15 +50,15 @@
 msgid "Date"
 msgstr "p?"
 
-#: UI/GTK2/src/indexDialog.cc:130
+#: UI/GTK2/src/indexDialog.cc:122
 msgid "Served by"
 msgstr "Erbjuds av"
 
-#: UI/GTK2/src/indexDialog.cc:134
+#: UI/GTK2/src/indexDialog.cc:124
 msgid "Local"
 msgstr "Lokal"
 
-#: UI/GTK2/src/indexDialog.cc:300
+#: UI/GTK2/src/indexDialog.cc:286
 msgid "Index location"
 msgstr "Indexplats"
 
@@ -70,7 +70,7 @@
 msgid "..."
 msgstr "..."
 
-#: UI/GTK2/src/indexDialog_glade.cc:70
+#: UI/GTK2/src/indexDialog_glade.cc:70 UI/GTK2/src/prefsDialog_glade.cc:85
 msgid "Type:"
 msgstr "Typ:"
 
@@ -78,19 +78,19 @@
 msgid "Location:"
 msgstr "Plats:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:72
+#: UI/GTK2/src/indexDialog_glade.cc:72 UI/GTK2/src/prefsDialog_glade.cc:86
 msgid "Port:"
 msgstr "Port:"
 
-#: UI/GTK2/src/indexDialog_glade.cc:79
-msgid "Host name:"
-msgstr "V?rdnamn:"
+#: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
+msgid "Address:"
+msgstr ""
 
-#: UI/GTK2/src/indexDialog_glade.cc:163
+#: UI/GTK2/src/indexDialog_glade.cc:183
 msgid "External index"
 msgstr "Externt index"
 
-#: UI/GTK2/src/importDialog.cc:82 UI/GTK2/src/queryDialog.cc:108
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Ingen"
 
@@ -111,12 +111,12 @@
 msgid "Import URL"
 msgstr "Importera url"
 
-#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:139
+#: UI/GTK2/src/IndexTree.cpp:68 UI/GTK2/src/queryDialog.cc:122
 #: UI/GTK2/src/ResultsTree.cpp:127
 msgid "Title"
 msgstr "Titel"
 
-#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:142
+#: UI/GTK2/src/IndexTree.cpp:73 UI/GTK2/src/queryDialog.cc:123
 #: UI/GTK2/src/ResultsTree.cpp:137
 msgid "URL"
 msgstr "Url"
@@ -133,7 +133,7 @@
 msgid "Show Next"
 msgstr "Visa n?sta"
 
-#: UI/GTK2/src/IndexPage.cpp:159 UI/GTK2/src/IndexPage.cpp:205
+#: UI/GTK2/src/IndexPage.cpp:150 UI/GTK2/src/IndexPage.cpp:188
 msgid "All labels"
 msgstr "Alla etiketter"
 
@@ -212,7 +212,7 @@
 msgid "Query"
 msgstr "Fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:924 UI/GTK2/src/mainWindow.cc:2934
 msgid "on"
 msgstr "p?"
 
@@ -248,8 +248,8 @@
 msgid "Couldn't rename index, name"
 msgstr "Kunde inte byta namn p? index, namn"
 
-#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2244
-#: UI/GTK2/src/mainWindow.cc:2755
+#: UI/GTK2/src/mainWindow.cc:1352 UI/GTK2/src/mainWindow.cc:2253
+#: UI/GTK2/src/mainWindow.cc:2764
 msgid "is already in use"
 msgstr "anv?nds redan"
 
@@ -261,101 +261,101 @@
 msgid "Edited index"
 msgstr "Redigerade index"
 
-#: UI/GTK2/src/mainWindow.cc:1754 UI/GTK2/src/mainWindow.cc:2414
+#: UI/GTK2/src/mainWindow.cc:1763 UI/GTK2/src/mainWindow.cc:2423
 msgid "Live query"
 msgstr "Levande fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:1780
+#: UI/GTK2/src/mainWindow.cc:1789
 msgid "Couldn't find query"
 msgstr "Kunde inte hitta fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:1973 UI/GTK2/src/WorkerThreads.cpp:651
-#: UI/GTK2/src/WorkerThreads.cpp:1618
+#: UI/GTK2/src/mainWindow.cc:1982 UI/GTK2/src/WorkerThreads.cpp:629
+#: UI/GTK2/src/WorkerThreads.cpp:1625
 msgid "Index"
 msgstr "Index"
 
-#: UI/GTK2/src/mainWindow.cc:1977 UI/GTK2/src/WorkerThreads.cpp:655
-#: UI/GTK2/src/WorkerThreads.cpp:1622
+#: UI/GTK2/src/mainWindow.cc:1986 UI/GTK2/src/WorkerThreads.cpp:633
+#: UI/GTK2/src/WorkerThreads.cpp:1629
 msgid "doesn't exist"
 msgstr "finns inte"
 
-#: UI/GTK2/src/mainWindow.cc:2131
+#: UI/GTK2/src/mainWindow.cc:2140
 msgid "Remove this document from the index ?"
 msgstr "Ta bort detta dokument fr?n indexet?"
 
-#: UI/GTK2/src/mainWindow.cc:2150
+#: UI/GTK2/src/mainWindow.cc:2159
 msgid "Remove these documents from the index ?"
 msgstr "Ta bort dessa dokument fr?n indexet?"
 
-#: UI/GTK2/src/mainWindow.cc:2194
+#: UI/GTK2/src/mainWindow.cc:2203
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Ett metas?kningsverktyg f?r Free Desktop"
 
-#: UI/GTK2/src/mainWindow.cc:2195
+#: UI/GTK2/src/mainWindow.cc:2204
 msgid "Search the Web and your documents !"
 msgstr "S?k p? webben och i dina dokument!"
 
-#: UI/GTK2/src/mainWindow.cc:2196
+#: UI/GTK2/src/mainWindow.cc:2205
 msgid "(C) 2005 Fabrice Colin"
 msgstr "? 2005 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2240
+#: UI/GTK2/src/mainWindow.cc:2249
 msgid "Index name"
 msgstr "Indexnamn"
 
-#: UI/GTK2/src/mainWindow.cc:2255
+#: UI/GTK2/src/mainWindow.cc:2264
 msgid "Couldn't add index"
 msgstr "Kunde inte l?gga till index"
 
-#: UI/GTK2/src/mainWindow.cc:2269
+#: UI/GTK2/src/mainWindow.cc:2278
 msgid "Added new index"
 msgstr "Lade till nytt index"
 
-#: UI/GTK2/src/mainWindow.cc:2304
+#: UI/GTK2/src/mainWindow.cc:2313
 msgid "Couldn't remove index"
 msgstr "Kunde inte ta bort index"
 
-#: UI/GTK2/src/mainWindow.cc:2569
+#: UI/GTK2/src/mainWindow.cc:2578
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "?tminstone en uppgift har inte f?rdigst?llts ?n. Avsluta nu?"
 
-#: UI/GTK2/src/mainWindow.cc:2751
+#: UI/GTK2/src/mainWindow.cc:2760
 msgid "Query name"
 msgstr "Fr?genamn"
 
-#: UI/GTK2/src/mainWindow.cc:2778
+#: UI/GTK2/src/mainWindow.cc:2787
 msgid "Couldn't update query"
 msgstr "Kunde inte uppdatera fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:2795
 msgid "Edited query"
 msgstr "Redigerade fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2793
+#: UI/GTK2/src/mainWindow.cc:2802
 msgid "Couldn't add query"
 msgstr "Kunde inte l?gga till fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2801
+#: UI/GTK2/src/mainWindow.cc:2810
 msgid "Added new query"
 msgstr "Lade till ny fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2814
+#: UI/GTK2/src/mainWindow.cc:2823
 msgid "Query is not set"
 msgstr "Fr?gan ?r inte inst?lld"
 
-#: UI/GTK2/src/mainWindow.cc:2825
+#: UI/GTK2/src/mainWindow.cc:2834
 msgid "No search engine selected"
 msgstr "Ingen s?kmotor vald"
 
-#: UI/GTK2/src/mainWindow.cc:2912
+#: UI/GTK2/src/mainWindow.cc:2921
 msgid "Please set the Google API key first"
 msgstr "St?ll in Google API-nyckeln f?rst"
 
-#: UI/GTK2/src/mainWindow.cc:2921
+#: UI/GTK2/src/mainWindow.cc:2930
 msgid "Running query"
 msgstr "K?r fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:3105
+#: UI/GTK2/src/mainWindow.cc:3114
 msgid "No default application defined for type"
 msgstr "Inget standardprogram definierat f?r typen"
 
@@ -371,7 +371,7 @@
 msgid "Stored queries"
 msgstr "Lagrade fr?gor"
 
-#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:46
+#: UI/GTK2/src/mainWindow_glade.cc:163 UI/GTK2/src/statisticsDialog.cc:50
 #: UI/GTK2/src/statisticsDialog_glade.cc:87
 #, fuzzy
 msgid "Status"
@@ -458,183 +458,199 @@
 msgid "Pinot"
 msgstr "Pinot"
 
-#: UI/GTK2/src/pinot.cc:211 UI/GTK2/src/pinot-dbus-daemon.cc:292
-#: UI/GTK2/src/propertiesDialog.cc:65 UI/GTK2/src/propertiesDialog.cc:74
+#: UI/GTK2/src/pinot.cc:226 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/propertiesDialog.cc:60 UI/GTK2/src/propertiesDialog.cc:69
 msgid "Unknown"
 msgstr "Ok?nd"
 
-#: UI/GTK2/src/pinot.cc:212 UI/GTK2/src/pinot-dbus-daemon.cc:293
+#: UI/GTK2/src/pinot.cc:227 UI/GTK2/src/pinot-dbus-daemon.cc:294
 msgid "Danish"
 msgstr "Danska"
 
-#: UI/GTK2/src/pinot.cc:213 UI/GTK2/src/pinot-dbus-daemon.cc:294
+#: UI/GTK2/src/pinot.cc:228 UI/GTK2/src/pinot-dbus-daemon.cc:295
 msgid "Dutch"
 msgstr "Nederl?ndska"
 
-#: UI/GTK2/src/pinot.cc:214 UI/GTK2/src/pinot-dbus-daemon.cc:295
+#: UI/GTK2/src/pinot.cc:229 UI/GTK2/src/pinot-dbus-daemon.cc:296
 msgid "English"
 msgstr "Engelska"
 
-#: UI/GTK2/src/pinot.cc:215 UI/GTK2/src/pinot-dbus-daemon.cc:296
+#: UI/GTK2/src/pinot.cc:230 UI/GTK2/src/pinot-dbus-daemon.cc:297
 msgid "Finnish"
 msgstr "Finska"
 
-#: UI/GTK2/src/pinot.cc:216 UI/GTK2/src/pinot-dbus-daemon.cc:297
+#: UI/GTK2/src/pinot.cc:231 UI/GTK2/src/pinot-dbus-daemon.cc:298
 msgid "French"
 msgstr "Franska"
 
-#: UI/GTK2/src/pinot.cc:217 UI/GTK2/src/pinot-dbus-daemon.cc:298
+#: UI/GTK2/src/pinot.cc:232 UI/GTK2/src/pinot-dbus-daemon.cc:299
 msgid "German"
 msgstr "Tyska"
 
-#: UI/GTK2/src/pinot.cc:218 UI/GTK2/src/pinot-dbus-daemon.cc:299
+#: UI/GTK2/src/pinot.cc:233 UI/GTK2/src/pinot-dbus-daemon.cc:300
 msgid "Italian"
 msgstr "Italienska"
 
-#: UI/GTK2/src/pinot.cc:219 UI/GTK2/src/pinot-dbus-daemon.cc:300
+#: UI/GTK2/src/pinot.cc:234 UI/GTK2/src/pinot-dbus-daemon.cc:301
 msgid "Norwegian"
 msgstr "Norska"
 
-#: UI/GTK2/src/pinot.cc:220 UI/GTK2/src/pinot-dbus-daemon.cc:301
+#: UI/GTK2/src/pinot.cc:235 UI/GTK2/src/pinot-dbus-daemon.cc:302
 msgid "Portuguese"
 msgstr "Portugisiska"
 
-#: UI/GTK2/src/pinot.cc:221 UI/GTK2/src/pinot-dbus-daemon.cc:302
+#: UI/GTK2/src/pinot.cc:236 UI/GTK2/src/pinot-dbus-daemon.cc:303
 msgid "Russian"
 msgstr "Ryska"
 
-#: UI/GTK2/src/pinot.cc:222 UI/GTK2/src/pinot-dbus-daemon.cc:303
+#: UI/GTK2/src/pinot.cc:237 UI/GTK2/src/pinot-dbus-daemon.cc:304
 msgid "Spanish"
 msgstr "Spanska"
 
-#: UI/GTK2/src/pinot.cc:223 UI/GTK2/src/pinot-dbus-daemon.cc:304
+#: UI/GTK2/src/pinot.cc:238 UI/GTK2/src/pinot-dbus-daemon.cc:305
 msgid "Swedish"
 msgstr "Svenska"
 
-#: UI/GTK2/src/pinot.cc:247
+#: UI/GTK2/src/pinot.cc:263
 msgid "Couldn't open index"
 msgstr "Kunde inte ?ppna index"
 
-#: UI/GTK2/src/pinot.cc:263
+#: UI/GTK2/src/pinot.cc:279
 msgid "Couldn't create history database"
 msgstr "Kunde inte skapa historikdatabas"
 
-#: UI/GTK2/src/PinotSettings.cpp:247
+#: UI/GTK2/src/pinot.cc:309
+msgid "Updating all documents in My Web Pages is recommended"
+msgstr ""
+
+#: UI/GTK2/src/PinotSettings.cpp:249
 msgid "Important"
 msgstr "Viktigt"
 
-#: UI/GTK2/src/PinotSettings.cpp:248
+#: UI/GTK2/src/PinotSettings.cpp:250
 msgid "New"
 msgstr "Ny"
 
-#: UI/GTK2/src/PinotSettings.cpp:249
+#: UI/GTK2/src/PinotSettings.cpp:251
 msgid "Personal"
 msgstr "Personlig"
 
-#: UI/GTK2/src/PinotSettings.cpp:1082
+#: UI/GTK2/src/PinotSettings.cpp:1141
 msgid "Unclassified"
 msgstr "Oklassificerad"
 
-#: UI/GTK2/src/prefsDialog.cc:67
+#: UI/GTK2/src/prefsDialog.cc:82
 msgid "Name"
 msgstr "Namn"
 
-#: UI/GTK2/src/prefsDialog.cc:75
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Monitor"
 msgstr "?vervaka"
 
-#: UI/GTK2/src/prefsDialog.cc:76 UI/GTK2/src/prefsDialog.cc:84
+#: UI/GTK2/src/prefsDialog.cc:91 UI/GTK2/src/prefsDialog.cc:99
 msgid "Location"
 msgstr "Plats"
 
-#: UI/GTK2/src/prefsDialog.cc:92
+#: UI/GTK2/src/prefsDialog.cc:107
 msgid "Pattern"
 msgstr "M?nster"
 
-#: UI/GTK2/src/prefsDialog.cc:423
+#: UI/GTK2/src/prefsDialog.cc:471
 msgid "New Label"
 msgstr "Ny etikett"
 
-#: UI/GTK2/src/prefsDialog.cc:464
+#: UI/GTK2/src/prefsDialog.cc:512
 msgid "Directory to index"
 msgstr "Katalog f?r index"
 
-#: UI/GTK2/src/prefsDialog.cc:522
+#: UI/GTK2/src/prefsDialog.cc:570
 msgid "Mbox File Location"
 msgstr "Plats f?r mbox-fil"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:65
-msgid "HTTP crawling:"
-msgstr "HTTP-insamling:"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Google API-nyckel:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:68
-msgid "Ignore robots.txt and Robots META tag"
-msgstr "Ignorera robots.txt och Robots META-tagg"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:70
+#: UI/GTK2/src/prefsDialog_glade.cc:69
 msgid "New results:"
 msgstr "Nya resultat:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:71
+#: UI/GTK2/src/prefsDialog_glade.cc:70
 msgid "Queries:"
 msgstr "Fr?gor:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:72
+#: UI/GTK2/src/prefsDialog_glade.cc:71
 msgid "Enable search terms suggestion"
 msgstr "Aktivera s?kf?rslag"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:76
+#: UI/GTK2/src/prefsDialog_glade.cc:73
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "Ignorera robots.txt och Robots META-tagg"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "HTTP crawling:"
+msgstr "HTTP-insamling:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:77
 msgid "General"
 msgstr "Allm?nt"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:77
+#: UI/GTK2/src/prefsDialog_glade.cc:79
+msgid "Direct connection to the Internet"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80
+msgid "Manual proxy configuration:"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:93
+msgid "Network"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog_glade.cc:94
 msgid "Labels are used to classify indexed documents:"
 msgstr "Etiketter som anv?nds f?r att klassificera indexerade dokument:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:82 UI/GTK2/src/prefsDialog_glade.cc:102
-#: UI/GTK2/src/prefsDialog_glade.cc:115 UI/GTK2/src/prefsDialog_glade.cc:128
+#: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
+#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
 msgid "Add"
 msgstr "L?gg till"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:88
+#: UI/GTK2/src/prefsDialog_glade.cc:105
 msgid "Remove"
 msgstr "Ta bort"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:96
+#: UI/GTK2/src/prefsDialog_glade.cc:113
 msgid "Labels"
 msgstr "Etiketter"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:97
+#: UI/GTK2/src/prefsDialog_glade.cc:114
 msgid "These directories will be indexed and optionally monitored for changes:"
 msgstr ""
 "Dessa kataloger kommer att bli indexerade och ?vervakade f?r ?ndringar "
 "(valfritt):"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:110
+#: UI/GTK2/src/prefsDialog_glade.cc:127
 msgid "Mail boxes of type mbox can be monitored and indexed:"
 msgstr "Postl?dor av typen mbox kan ?vervakas och indexeras:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:123
+#: UI/GTK2/src/prefsDialog_glade.cc:140
 msgid "Specify any file pattern you wish to exclude from indexing:"
 msgstr "Ange de film?nster som du ?nskar undanta fr?n indexering:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:137
+#: UI/GTK2/src/prefsDialog_glade.cc:154
 msgid "Indexing"
 msgstr "Indexerar"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:411
+#: UI/GTK2/src/prefsDialog_glade.cc:566
 msgid "Preferences"
 msgstr "Inst?llningar"
 
-#: UI/GTK2/src/propertiesDialog.cc:52 UI/GTK2/src/queryDialog.cc:154
+#: UI/GTK2/src/propertiesDialog.cc:47 UI/GTK2/src/queryDialog.cc:127
 msgid "Label"
 msgstr "Etikett"
 
-#: UI/GTK2/src/propertiesDialog.cc:86
+#: UI/GTK2/src/propertiesDialog.cc:81
 msgid "Per document"
 msgstr "Per dokument"
 
@@ -654,35 +670,35 @@
 msgid "Terms:"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:130
+#: UI/GTK2/src/queryDialog.cc:119
 msgid "Host name"
 msgstr "V?rdnamn"
 
-#: UI/GTK2/src/queryDialog.cc:133
+#: UI/GTK2/src/queryDialog.cc:120
 msgid "File name"
 msgstr "Filnamn"
 
-#: UI/GTK2/src/queryDialog.cc:136
+#: UI/GTK2/src/queryDialog.cc:121
 msgid "File extension"
 msgstr "Fil?ndelse"
 
-#: UI/GTK2/src/queryDialog.cc:145
+#: UI/GTK2/src/queryDialog.cc:124
 msgid "Directory"
 msgstr "Katalog"
 
-#: UI/GTK2/src/queryDialog.cc:148
+#: UI/GTK2/src/queryDialog.cc:125
 msgid "Language code"
 msgstr "Spr?kkod"
 
-#: UI/GTK2/src/queryDialog.cc:151
+#: UI/GTK2/src/queryDialog.cc:126
 msgid "MIME type"
 msgstr "MIME-typ"
 
-#: UI/GTK2/src/queryDialog.cc:271
+#: UI/GTK2/src/queryDialog.cc:246
 msgid "Start date"
 msgstr ""
 
-#: UI/GTK2/src/queryDialog.cc:286
+#: UI/GTK2/src/queryDialog.cc:261
 msgid "End date"
 msgstr ""
 
@@ -723,114 +739,119 @@
 msgid "Extract"
 msgstr "Utdrag"
 
-#: UI/GTK2/src/statisticsDialog.cc:69
+#: UI/GTK2/src/statisticsDialog.cc:72
 msgid "Indexes"
 msgstr "Index"
 
-#: UI/GTK2/src/statisticsDialog.cc:83 UI/GTK2/src/statisticsDialog.cc:97
+#: UI/GTK2/src/statisticsDialog.cc:87
+#, fuzzy
+msgid "History"
+msgstr "Katalog"
+
+#: UI/GTK2/src/statisticsDialog.cc:92
+msgid "Daemon"
+msgstr ""
+
+#: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
 msgid "documents"
 msgstr "dokument"
 
-#: UI/GTK2/src/statisticsDialog.cc:102
+#: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
 #, fuzzy
-msgid "History"
-msgstr "Katalog"
+msgid "Unknown error"
+msgstr "Ok?nd"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 #, fuzzy
 msgid "Viewed"
 msgstr "Visa"
 
-#: UI/GTK2/src/statisticsDialog.cc:109
+#: UI/GTK2/src/statisticsDialog.cc:154
 #, fuzzy
 msgid "results"
 msgstr "_Resultat"
 
-#: UI/GTK2/src/statisticsDialog.cc:113
-msgid "Daemon"
-msgstr ""
-
-#: UI/GTK2/src/statisticsDialog.cc:131
+#: UI/GTK2/src/statisticsDialog.cc:171
 #, fuzzy
 msgid "Running under PID"
 msgstr "K?r fr?ga"
 
-#: UI/GTK2/src/statisticsDialog.cc:135
+#: UI/GTK2/src/statisticsDialog.cc:175
 msgid "Currently not running"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 #, fuzzy
 msgid "Crawled"
 msgstr "Insamlare"
 
-#: UI/GTK2/src/statisticsDialog.cc:143
+#: UI/GTK2/src/statisticsDialog.cc:182
 msgid "files"
 msgstr ""
 
-#: UI/GTK2/src/statisticsDialog.cc:166
+#: UI/GTK2/src/statisticsDialog.cc:205
 msgid "Errors"
 msgstr "Fel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322
+#: UI/GTK2/src/WorkerThreads.cpp:302
 msgid "Can't index mail here"
 msgstr "Kan inte indexera post h?r"
 
-#: UI/GTK2/src/WorkerThreads.cpp:343
+#: UI/GTK2/src/WorkerThreads.cpp:323
 msgid "is already being indexed"
 msgstr "h?ller redan p? att bli indexerad"
 
-#: UI/GTK2/src/WorkerThreads.cpp:353
+#: UI/GTK2/src/WorkerThreads.cpp:333
 msgid "is blacklisted"
 msgstr "?r svartlistad"
 
-#: UI/GTK2/src/WorkerThreads.cpp:664 UI/GTK2/src/WorkerThreads.cpp:962
-#: UI/GTK2/src/WorkerThreads.cpp:1047 UI/GTK2/src/WorkerThreads.cpp:1056
-#: UI/GTK2/src/WorkerThreads.cpp:1228 UI/GTK2/src/WorkerThreads.cpp:1498
-#: UI/GTK2/src/WorkerThreads.cpp:1631
+#: UI/GTK2/src/WorkerThreads.cpp:642 UI/GTK2/src/WorkerThreads.cpp:955
+#: UI/GTK2/src/WorkerThreads.cpp:1040 UI/GTK2/src/WorkerThreads.cpp:1049
+#: UI/GTK2/src/WorkerThreads.cpp:1235 UI/GTK2/src/WorkerThreads.cpp:1505
+#: UI/GTK2/src/WorkerThreads.cpp:1638
 msgid "Index error on"
 msgstr "Indexfel p?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:785 UI/GTK2/src/WorkerThreads.cpp:983
+#: UI/GTK2/src/WorkerThreads.cpp:765 UI/GTK2/src/WorkerThreads.cpp:976
 msgid "Couldn't create search engine"
 msgstr "Kunde inte skapa s?kmotor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:797 UI/GTK2/src/WorkerThreads.cpp:997
+#: UI/GTK2/src/WorkerThreads.cpp:791 UI/GTK2/src/WorkerThreads.cpp:990
 msgid "Couldn't run query on search engine"
 msgstr "Kunde inte k?ra fr?ga p? s?kmotor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:842
+#: UI/GTK2/src/WorkerThreads.cpp:835
 msgid "No title"
 msgstr "Ingen titel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1150
+#: UI/GTK2/src/WorkerThreads.cpp:1143
 msgid "Couldn't obtain downloader for protocol"
 msgstr "Kunde inte f? protokollh?mtare"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1161
+#: UI/GTK2/src/WorkerThreads.cpp:1168
 msgid "Couldn't retrieve"
 msgstr "Kunde inte h?mta"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1258 UI/GTK2/src/WorkerThreads.cpp:1340
+#: UI/GTK2/src/WorkerThreads.cpp:1265 UI/GTK2/src/WorkerThreads.cpp:1344
 msgid "Cannot index document type"
 msgstr "Kan inte indexera dokumenttyp"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1262 UI/GTK2/src/WorkerThreads.cpp:1344
+#: UI/GTK2/src/WorkerThreads.cpp:1269 UI/GTK2/src/WorkerThreads.cpp:1348
 msgid "at"
 msgstr "p?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1376
+#: UI/GTK2/src/WorkerThreads.cpp:1380
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META-tagg f?rbjuder indexering"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1430
+#: UI/GTK2/src/WorkerThreads.cpp:1434
 msgid "Couldn't index"
 msgstr "Kunde inte indexera"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1509
+#: UI/GTK2/src/WorkerThreads.cpp:1516
 msgid "Couldn't unindex document(s)"
 msgstr "Kunde inte avindexera dokument"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1643
+#: UI/GTK2/src/WorkerThreads.cpp:1650
 msgid "Couldn't update document"
 msgstr "Kunde inte uppdatera dokument"



From fabricecolin at mail.berlios.de  Sun Mar 25 17:05:58 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sun, 25 Mar 2007 17:05:58 +0200
Subject: [Pinot-svn] r792 - trunk/UI/GTK2/src
Message-ID: <200703251505.l2PF5wPl019889@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-25 17:05:57 +0200 (Sun, 25 Mar 2007)
New Revision: 792

Modified:
   trunk/UI/GTK2/src/ServerThreads.cpp
Log:
The D-Bus interface description file was looked for in the wrong directory.


Modified: trunk/UI/GTK2/src/ServerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-25 07:33:34 UTC (rev 791)
+++ trunk/UI/GTK2/src/ServerThreads.cpp	2007-03-25 15:05:57 UTC (rev 792)
@@ -79,7 +79,7 @@
 	ifstream xmlFile;
 	string xmlFileName(PREFIX);
 
-	xmlFileName += "/share/doc/pinot-dbus-daemon.xml";
+	xmlFileName += "/share/pinot/pinot-dbus-daemon.xml";
 	xmlFile.open(xmlFileName.c_str());
 	if (xmlFile.good() == true)
 	{
@@ -99,6 +99,10 @@
 	}
 	xmlFile.close();
 
+	if (readFile == false)
+	{
+		cerr << "File " << xmlFileName << " couldn't be read" << endl;
+	}
 	return readFile;
 }
 
@@ -1213,10 +1217,6 @@
 					DBUS_TYPE_INVALID);
 			}
 		}
-		else
-		{
-			cerr << "File pinot-dbus-daemon.xml couldn't be found" << endl;
-		}
 	}
 	else
 	{



From fabricecolin at mail.berlios.de  Thu Mar 29 13:07:49 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 29 Mar 2007 13:07:49 +0200
Subject: [Pinot-svn] r793 - trunk
Message-ID: <200703291107.l2TB7nrk023263@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-29 13:07:48 +0200 (Thu, 29 Mar 2007)
New Revision: 793

Modified:
   trunk/pinot.desktop
Log:
Extra translations.


Modified: trunk/pinot.desktop
===================================================================
--- trunk/pinot.desktop	2007-03-25 15:05:57 UTC (rev 792)
+++ trunk/pinot.desktop	2007-03-29 11:07:48 UTC (rev 793)
@@ -3,13 +3,17 @@
 Name[es]=Metabuscador Pinot
 Name[fr]=Pinot Outil De Recherche
 Name[nl]=Pinot Metazoek Tool
+Name[pt]=Mecanismo de metabusca Pinot
 Name[pt_BR]=Mecanismo de metabusca Pinot
 Name[ru]=?????????? ?????????? Pinot
 Name[sv]=Pinot Metas?kningsverktyg
 Comment=Search the Web and your documents
 Comment[es]=Busca en el web y en sus documentos
+Comment[de]=Durchsuchen Sie das Internet und Ihre Dokumente
 Comment[fr]=Cherche le Web et vos documents
-Comment[sv]=S?k p? webben och i dina dokument!
+Comment[pt]=Pesquise a Web e os seus documentos
+Comment[pt_BR]=Pesquise a Web e os seus documentos
+Comment[sv]=S?k p? webben och i dina dokument
 Exec=pinot
 StartupNotify=true
 Icon=pinot.png



From fabricecolin at mail.berlios.de  Thu Mar 29 15:13:29 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 29 Mar 2007 15:13:29 +0200
Subject: [Pinot-svn] r794 - trunk/Utils/xdgmime
Message-ID: <200703291313.l2TDDTJt028407@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-29 15:13:24 +0200 (Thu, 29 Mar 2007)
New Revision: 794

Modified:
   trunk/Utils/xdgmime/ChangeLog
   trunk/Utils/xdgmime/xdgmimecache.c
Log:
Sync with current gtk+ source.


Modified: trunk/Utils/xdgmime/ChangeLog
===================================================================
--- trunk/Utils/xdgmime/ChangeLog	2007-03-29 11:07:48 UTC (rev 793)
+++ trunk/Utils/xdgmime/ChangeLog	2007-03-29 13:13:24 UTC (rev 794)
@@ -1,366 +1,348 @@
-2006-07-13  Christian Neumair  <chris at gnome-de.org>
+2007-01-07  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimemagic.c: (_xdg_mime_magic_parse_magic_line):
-	Only declare 'i' #if LITTLE_ENDIAN. Partially fixes GNOME #340277.
-	Thanks to James Andrewartha.
+	* xdgmimecache.c (cache_glob_node_lookup_suffix): Don't return "" 
+	as match.  (fd.o #9544, Yevgen Muntyan)
 
-2006-03-02  Christian Neumair  <chris at gnome-de.org>
+2007-01-07  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimeglob.c: (_xdg_glob_hash_insert_text),
-	(_xdg_glob_hash_append_glob): Don't strdup the MIME type when passing
-	it to _xdg_glob_hash_insert_text, but let the function itself figure
-	out whether string duplication is needed. Fixes #5993.
-	Thanks to Martin Wehner.
+	* xdgmimecache.c (_xdg_mime_cache_list_mime_parents): Fix 
+	several problems with this function.  (fd.o #9560, Yevgen Muntyan)
 
-2006-02-25  Christian Neumair  <chris at gnome-de.org>
+2006-08-17  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimemagic.c: (_xdg_mime_magic_lookup_data): Make
-	priority equality check more robust so that it works for three or more
-	matches. Also allow matchlets with 0 priority.
+	* === Released 2.10.2 ===
 
-2006-02-19  Christian Neumair  <chris at gnome-de.org>
+2006-07-23  Matthias Clasen  <mclasen at redhat.com>
+	
+	* === Released 2.10.1 ===
 
-	* src/xdgmimemagic.c: (_xdg_mime_magic_lookup_data): When two
-	unrelated MIME types with equal priorities match, don't assume one of
-	them matches.
-	http://bugzilla.gnome.org/show_bug.cgi?id=331719
+2006-07-20  Matthias Clasen  <mclasen at redhat.com>
 
-2006-01-03  Christian Neumair  <chris at gnome-de.org>
+	Fix a thinko that leads to constantly reloading
+	the mime data if a mime.cache is present.  Patch
+	by Yevgen Muntyan, bugs.freedesktop.org #7495
+	
+	* xdgmime.c (xdg_check_dir): Look for mime.cache first.
+	(xdg_check_file): Report existance of the file separately.
+	
+2006-07-20  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimemagic.c: (_xdg_mime_magic_lookup_data): Also consider
-	match priority for the returned MIME type.
+	* xdgmime.c (xdg_mime_shutdown): Unref the caches.
+	Patch by Yevgen Muntyan, bugs.freedesktop.org #7496
 
-2005-12-01  Christian Neumair  <chris at gnome-de.org>
+	* xdgmimemagic.c: 
+	* xdgmime.c: 
+	* xdgmime.h: Add xdg_init-free versions of some
+	functions and use them internally, so that we don't
+	reload caches and clobber data structures in the
+	middle of an operation.  Patch by Joe Shaw,
+	bugs.freedesktop.org #6824
 
-	* src/xdgmime.c: (xdg_mime_get_mime_type_from_file_name):
-	* src/xdgmimecache.c: (_xdg_mime_cache_get_mime_type_from_file_name):
-	Return XDG_MIME_TYPE_UNKNOWN if multiple MIME types match a simple
-	pattern.
+2006-07-19  Matthias Clasen  <mclasen at redhat.com>
 
-2005-12-01  Matthias Clasen  <mclasen at redhat.com>
+	* xdgmimeglob.c (_xdg_glob_hash_node_lookup_file_name):
+	Don't return NULL as a mimetype, ever, patch
+	by Yevgen Muntyan, bugs.freedesktop.org #5241
 
-	* src/xdgmimecache.h:
-	* src/xdgmimecache.c (_xdg_mime_cache_get_mime_type_for_file): 
-	Allow passing in a struct stat * to avoid re-stat()ing. 
-	Forgotten commit from an earlier entry.
+2006-07-02  Matthias Clasen  <mclasen at redhat.com>
+	
+	* === Released 2.10.0 ===
 
-	* src/xdgmimecache.c (cache_glob_lookup_literal):
-	(cache_glob_lookup_fnmatch):
-	(cache_glob_node_lookup_suffix): Change these functions to
-	allow returning more than one mime type if identical globs
-	match.
-
-	* src/xdgmimemagic.h: 
-	* src/xdgmimeglob.h: 
-	* src/xdgmimemagic.c (_xdg_mime_magic_lookup_data): 
-	* src/xdgmimeglob.c (_xdg_glob_hash_lookup_file_name): 
-	Change these functions to allow returning more than one
-	mime type if identical globs match.
+2006-06-21  Matthias Clasen  <mclasen at redhat.com>
 	
-	* src/xdgmimecache.c (_xdg_mime_cache_get_mime_type_for_file): 
-	* src/xdgmime.c (xdg_mime_get_mime_type_for_file): 
-	If multiple identical globs match, use magic to disambiguate.
-	
-2005-11-04  Matthias Clasen  <mclasen at redhat.com>
+	* === Released 2.9.4 ===
 
-	* xdgmime.c (xdg_mime_list_mime_parents): Prevent
-	a segfault.
+2006-06-12  Matthias Clasen  <mclasen at redhat.com>
 
-2005-10-18  Matthias Clasen  <mclasen at redhat.com>
-	
-	* src/xdgmime.c:
-	* src/xdgmimecache.h:
-	* src/xdgmimecache.c: Make the array of caches NULL-terminated
-	and rename it to _caches.  (#4011)
+	* === Released 2.9.3 ===
 
-	* src/xdgmime.h:
-	* src/xdgmime.c: Add a struct statbuf * argument to 
-	xdg_mime_get_mime_type_for_file().  (#3529)
+2006-06-05  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/test-mime.c: Adjust callers. Add License.
+	* === Released 2.9.2 ===
 
-	* src/xdgmimecache.c: Make magic comparisons work correctly.
+2006-05-16  Matthias Clasen  <mclasen at redhat.com>
 
-Thu Jun  9 23:55:25 2005  Jonathan Blandford  <jrb at redhat.com>
+	* === Released 2.9.1 ====
 
-	* src/xdgmime.c (xdg_mime_init_from_directory): patch from
-	federico to realloc the right size, #3506
+2006-05-04  Matthias Clasen  <mclasen at redhat.com>
 
-2005-04-17  Christophe Fergeau  <teuf at gnome.org>
+	* === Released 2.9.0 ===
 
-	* src/xdgmimeint.c: fix gcc4 signedness warning
+2006-04-03  Matthias Clasen  <mclasen at redhat.com>
 
-2005-04-17  Christophe Fergeau  <teuf at gnome.org>
+	* xdgmime.[hc]: Move xdg_mime_type_unknown to .rodata.
 
-	* src/xdgmimemagic.c: (_xdg_mime_magic_matchlet_compare_to_data),
-	(_xdg_mime_magic_matchlet_compare_level),
-	(_xdg_mime_magic_lookup_data): when  magic patterns matches, check if
-	there aren't subtypes with matching patterns too, and if so, favour
-	the subtype over the parent type, should fix #2686
+2006-03-06  Matthias Clasen  <mclasen at redhat.com>
 
-2005-04-16  Christophe Fergeau  <teuf at gnome.org>
+	* xdgmimemagic.c: Remove superfluous extern errno 
+	declaration.  (#333605, Tommi Komulainen)
 
-	* src/xdgmime.c: (xdg_mime_init_from_directory): fix leak when
-	mime.cache doesn't exist
+2006-02-27  Matthias Clasen  <mclasen at redhat.com>
 
-2005-04-16  Christophe Fergeau  <teuf at gnome.org>
+	* xdgmime.h (xdg_mime_dump): Don't export xdg_mime_dump.
 
-	* src/test-mime.c: (main): disabled call to xdg_mime_dump for now
-	* src/xdgmimemagic.c: (_xdg_mime_magic_matchlet_compare_to_data):
-	fixed off by 1 error when handling offsets, fixes bug #2050 and 
-	partly bug #2359
+2005-12-01  Matthias Clasen  <mclasen at redhat.com>
 
-Fri Apr  8 23:37:33 2005  Jonathan Blandford  <jrb at redhat.com>
+	* Merge upstream changes to handle duplicate glob
+	patterns.
 
-	* src/xdgmimecache.c: Actually add the file.  Also, patch from
-	Matthias Clasen <mclasen at redhat.com> to fix small bugs, #2939
+2005-11-04  Matthias Clasen  <mclasen at redhat.com>
 
-Fri Apr  1 14:59:43 2005  Jonathan Blandford  <jrb at redhat.com>
+	* xdgmime.c (xdg_mime_list_mime_parents): Prevent
+	a segfault.  
 
-	* src/xdgmimecache.c: Patch from Matthias Clasen to mmap the
-	cached xdg file.
+2005-10-18  Matthias Clasen  <mclasen at redhat.com>
 
-Mon Mar 28 13:58:32 2005  Jonathan Blandford  <jrb at redhat.com>
+	* xdgmimecache.c: Make magic comparisons work correctly
+	in the cache.
 
-	* src/xdgmimeglob.c (_xdg_glob_hash_insert_text): patch from
-	Matthias Clasen to handle globs that don't have '.' chars in
-	them.  As an example 'foo~' should match '*~'
+2005-10-17  Matthias Clasen  <mclasen at redhat.com>
 
-Mon Mar 21 13:16:12 2005  Jonathan Blandford  <jrb at redhat.com>
+	* xdgmime.c (xdg_mime_get_mime_type_for_file): Remove
+	a debugging printf.
 
-	* src/xdgmime.c (xdg_mime_shutdown): fix from  Axel Liljencrantz
-	<f97-ali at nada.kth.se> to free parent_list in shutdown.
+2005-09-01  Matthias Clasen  <mclasen at redhat.com>
 
-2005-01-10  Christophe Fergeau  <teuf at gnome.org>
+	* xdgmime.h:
+	* xdgmime.c (xdg_mime_get_mime_type_for_file): Take
+	a struct statbuf * as argument.
 
-	* src/xdgmimeglob.c: (_xdg_glob_hash_lookup_file_name): make previous
-	commit actually work...
+	* test-mime.c (main): Adjust.
 
-2005-01-10  Christophe Fergeau  <teuf at gnome.org>
+2005-08-24  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimeglob.c: (_xdg_glob_hash_lookup_file_name): don't get
-	confused by multiple dots in filenames when doing extension matching
+	* === Released 2.8.2 ===
 
-2004-12-13  Marco Pesenti Gritti  <marco at gnome.org>
+	* === Released 2.8.1 ===
 
-	* src/xdgmime.h:
+2005-08-13  Matthias Clasen  <mclasen at redhat.com>
 
-	 wrap new API in XDG_ENTRY()
+	* === Released 2.8.0 ===
 
-2004-12-13  Marco Pesenti Gritti  <marco at gnome.org>
+2005-08-07  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimeglob.c: (_xdg_glob_hash_lookup_file_name):
+	* Rename caches to _caches, so it doesn't
+	get exported. Also don't export n_caches.
 
-	Do not assume the filename is UTF8. We just need to look
-	for the dot which is ASCII.
+2005-08-02  Matthias Clasen  <mclasen at redhat.com>
 
-2004-12-09  Marco Pesenti Gritti  <marco at gnome.org>
+	* === Released 2.7.5 ===
 
-	* src/xdgmimeint.h:
+2005-07-22  Matthias Clasen  <mclasen at redhat.com>
 
-	Remove spacings I introduced by mistake
+	* === Released 2.7.4 === 
 
-2004-12-09  Marco Pesenti Gritti  <marco at gnome.org>
+2005-07-15  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimealias.c: (_xdg_mime_alias_read_from_file):
-	* src/xdgmimeint.c: (_xdg_ucs4_to_lower):
-	* src/xdgmimeint.h:
-	* src/xdgmimeparent.c: (_xdg_mime_parent_read_from_file):
+	* === Released 2.7.3 ===
+	
+2005-07-08  Matthias Clasen  <mclasen at redhat.com>
+	
+	* === Released 2.7.2 ===
 
-	Check in Mariano Su?rez-Alvarez <msuarezalvarez at arnet.com.ar> patch
-	for GNOME bug #160838.
+2005-07-01  Matthias Clasen  <mclasen at redhat.com>
 
-2004-12-09  Marco Pesenti Gritti  <marco at gnome.org>
+	* === Released 2.7.1 ===
+	
+2005-06-20  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimeglob.c: (_xdg_glob_hash_node_lookup_file_name):
-	* src/xdgmimeint.c: (_xdg_ucs4_to_lower):
-	* src/xdgmimeint.h:
+	* xdgmimecache.c: Handle missing MAP_FAILED.  (#308449, Georg
+	Schwarz)
 
-	Follow the freedesktop spec about case sensitiveness. Fix #732
+2005-06-20  Matthias Clasen  <mclasen at redhat.com>
 
-2004-12-08  Christophe Fergeau  <teuf at gnome.org>
+	* === Released 2.7.0 ===
 
-	* src/xdgmimeglob.c: (_xdg_mime_glob_read_from_file): backing out
-	"fix" for bug #1048 since it frees memory that shouldn't be freed.
+2005-06-10  Federico Mena Quintero  <federico at ximian.com>
 
-2004-12-08  Marco Pesenti Gritti  <marco at gnome.org>
+	* xdgmime.c (xdg_mime_init_from_directory): Pass the correct size
+	to realloc().  Fixes https://bugs.freedesktop.org/show_bug.cgi?id=3506.
 
-	* src/xdgmimemagic.c: (_xdg_mime_magic_read_from_file):
+2005-06-09  Matthias Clasen  <mclasen at redhat.com>
 
-	Check that fread succeeded reading all chars. Fix #1049
+	* xdgmimemagic.c: Don't declare errno, including errno.h 
+	is enough.  (#304164, Joerg Sonnenberger)
 
-2004-12-08  Marco Pesenti Gritti  <marco at gnome.org>
+2005-05-20  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmime.c:
-	* src/xdgmimealias.c:
-	* src/xdgmimeglob.c:
-	* src/xdgmimeint.c:
-	* src/xdgmimemagic.c:
-	* src/xdgmimeparent.c:
+	* xdgmimecache.c (GET_UINT32): Don't rely on C99 
+	types.  (#304924, John Ehresman)
 
-	Include config.h. Fix #913
+2005-04-29  Matthias Clasen  <mclasen at redhat.com>
 
-2004-12-08  Marco Pesenti Gritti  <marco at gnome.org>
+	* Sync to upstream.
 
-	* src/xdgmimealias.c: (_xdg_mime_alias_list_lookup):
+2005-04-08  Matthias Clasen  <mclasen at redhat.com>
 
-	Fix a typo
+	* xdgmimecache.c (cache_magic_matchlet_compare_to_data) 
+	(cache_magic_matchlet_compare): Use cache->buffer, not 
+	cache.  
 
-2004-12-08  Marco Pesenti Gritti  <marco at gnome.org>
+Tue Apr  5 16:00:04 2005  Manish Singh  <yosh at gimp.org>
 
-	* src/xdgmime.c: (xdg_mime_unalias_mime_type),
-	(xdg_mime_mime_type_equal), (xdg_mime_mime_type_subclass),
-	(xdg_mime_get_mime_parents):
-	* src/xdgmime.h:
+	* Makefile.am: add xdgmimecache.[ch].
 
-	Add apis to get parents and to unalias mime type
+2005-03-28  Matthias Clasen  <mclasen at redhat.com>
 
-2004-12-08  Marco Pesenti Gritti  <marco at gnome.org>
+	* xdgmimeglob.c: Sync to latest upstream,
+	including fixes for matching against multiple
+	extensions (eg .tar.gz) and for suffix
+	patterns which don't start with a dot.
 
-	* src/xdgmimealias.c: (_xdg_mime_alias_list_lookup):
-	* src/xdgmimeparent.c: (_xdg_mime_parent_list_lookup):
+Sat Mar 19 23:52:33 2005  Manish Singh  <yosh at gimp.org>
 
-	Protect against stupid bsearch() implementations.  (#1961,
-	Morten Welinder)
+	* xdgmimeglob.c (_xdg_glob_hash_insert_text): cast away the constness
+	in the call to free().
 
-2004-12-08  Marco Pesenti Gritti  <marco at gnome.org>
+2005-03-20  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimeparent.c: (_xdg_mime_parent_read_from_file):
+	* xdgmimeglob.c (_xdg_glob_hash_insert_text): Don't 
+	leak node->mime_type if we are reusing an existing
+	node.  (#170774, Kjartan Maraas)
 
-	Initialize the parent field of the newly allocate list 
-	entry.  (#1916, Alex Larsson)
+2005-01-08  Matthias Clasen  <mclasen at redhat.com>
 
-2004-12-08  Marco Pesenti Gritti  <marco at gnome.org>
+	* === Released 2.6.1 ===
+	
+2004-12-16  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimeglob.c: (_xdg_mime_glob_read_from_file):
+	* === Released 2.6.0 ===
 
-	Patch from Matthias Clasen <mclasen at redhat.com> to fix
-	a mem leak. Bug #1048
+2004-12-13  Marco Pesenti Gritti  <marco at gnome.org>
 
-2004-12-08  Marco Pesenti Gritti  <marco at gnome.org>
+	* xdgmimeglob.c: (_xdg_glob_hash_lookup_file_name):
 
-	* src/xdgmimeglob.h:
+	Resync with upstream again
 
-	Patch from Michael.Wilson at bull.net to fix compile error on AIX
+Fri Dec 10 13:58:38 2004  Manish Singh  <yosh at gimp.org>
 
-Sun Nov  7 02:25:21 2004  Jonathan Blandford  <jrb at redhat.com>
+	* xdgmime.h: wrap new API in XDG_ENTRY().
 
-	* src/xdgmime.h: Patch from Matthias Clasen <mclasen at redhat.com>
-	to add alias and inheritence support.
+2004-12-09  Marco Pesenti Gritti  <marco at gnome.org>
 
-2004-09-16  Christophe Fergeau  <teuf at gnome.org>
+	* xdgmime.c: (xdg_mime_unalias_mime_type),
+	(xdg_mime_mime_type_equal), (xdg_mime_mime_type_subclass),
+	(xdg_mime_get_mime_parents):
+	* xdgmime.h:
+	* xdgmimealias.c: (_xdg_mime_alias_list_lookup):
+	* xdgmimeglob.c: (_xdg_glob_hash_node_lookup_file_name):
+	* xdgmimeint.c: (_xdg_ucs4_to_lower):
+	* xdgmimeint.h:
+	* xdgmimemagic.c: (_xdg_mime_magic_read_from_file):
+	* xdgmimeparent.c: (_xdg_mime_parent_list_lookup):
 
-	* src/xdgmimeglob.c: (_xdg_glob_hash_free_nodes):
-	* src/xdgmimemagic.c: (_xdg_mime_magic_free): fix memory leaks, 
-	  fixes http://bugzilla.gnome.org/show_bug.cgi?id=152771 and
-	  http://bugzilla.gnome.org/show_bug.cgi?id=152768
+	Resync with upstream
 
-Mon Jul 19 00:23:00 2004  Jonathan Blandford  <jrb at gnome.org>
+2004-12-09  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmime.c (xdg_mime_register_reload_callback): register a
-	callback when we reload MIME data.
+	* xdgmimealias.c (_xdg_mime_alias_read_from_file): 
+	* xdgmimeparent.c (_xdg_mime_parent_read_from_file): Make
+	repeated calls accumulate the results, don't call qsort()
+	on empty arrays.  (#160838, Mariano Su?rez-Alvarez)
 
-	* src/xdgmime.c (xdg_mime_remove_callback): Add capability to
-	remove callback.
+2004-12-02  Matthias Clasen  <mclasen at redhat.com>
 
-Sun Jul 18 20:56:22 2004  Jonathan Blandford  <jrb at gnome.org>
+	* === Released 2.5.6 ===
 
-	* src/xdgmime.c (xdg_mime_shutdown):
-	(xdg_mime_init): reread data when it changes on disk.
+2004-11-29  Matthias Clasen  <mclasen at redhat.com>
 
-Thu May 27 16:18:14 2004  Jonathan Blandford  <jrb at gnome.org>
+	* xdgmimeparent.c (_xdg_mime_parent_list_lookup): 
+	* xdgmimealias.c (_xdg_mime_alias_list_lookup): Protect 
+	against stupid bsearch() implementations.  (#159737,
+	Morten Welinder)
+ 
+2004-11-24  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmime.h: move xdg_mime_shutdown into the XDG_ENTRY guard.
+	* xdgmimeparent.c (_xdg_mime_parent_read_from_file): 
+	Initialize the parent field of the newly allocate list 
+	entry.  (#159330, Alex Larsson)
 
-Thu May 27 15:02:13 2004  Jonathan Blandford  <jrb at gnome.org>
+Fri Nov 19 15:10:32 2004  Manish Singh  <yosh at gimp.org>
 
-	* src/xdgmimemagic.c (_xdg_mime_magic_read_magic_file): patch from
-	Hongli Lai <h.lai at chello.nl> to catch magic files that don't end
-	with a '\n'.
+	* xdgmime.c: Don't put /* within a comment.
 
-Fri Apr 30 11:56:01 2004  Jonathan Blandford  <jrb at gnome.org>
+2004-11-09  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimemagic.c (_xdg_mime_magic_read_a_number): make the
-	buffer the right size.  Reported by Morten Welinder, #136323
+	* xdgmime.h: Prefix all symbols.
 
-Sun Mar 21 23:56:46 2004  Jonathan Blandford  <jrb at gnome.org>
+2004-11-08  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimemagic.c: Patch from Arjan van de Ven
-	<arjanv at redhat.com> to do s/fgetc/getc_unlocked/g.
+	* xdgmime.c (xdg_mime_mime_type_subclass): Enable matching
+	of supertypes as text/*.
 
-Wed Mar 10 22:28:41 2004  Jonathan Blandford  <jrb at gnome.org>
+	* Sync from upstream
 
-	* src/xdgmimemagic.c (_xdg_mime_magic_read_a_number): fix usage of
-	isdigit.  Reported by Morten Welinder, #136323
+2004-10-27  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimemagic.c (_xdg_mime_magic_read_magic_file): patch from
-	Christophe Fergeau to reverse the order of the matchlet before
-	adding it to the list.
+	* === Released 2.5.4 ===
 
-	* src/xdgmimeint.h (_xdg_utf8_skip): patch from Alexander Larsson
-	to make extern.
+2004-09-19  Matthias Clasen  <mclasen at redhat.com>
 
-Wed Jan 21 09:29:41 2004  Jonathan Blandford  <jrb at gnome.org>
+	* === Released 2.5.3 ===
 
-	* src/xdgmimemagic.c (_xdg_mime_magic_insert_match): dropped
-	patches.  Fix.
+2004-08-25  Matthias Clasen  <mclasen at redhat.com>
 
-	* src/xdgmimeglob.c (_xdg_glob_hash_free_nodes): dropped patches.
-	Fix.
+	* === Released 2.5.2 ===
 
-Tue Jan 20 14:55:39 2004  Jonathan Blandford  <jrb at gnome.org>
+Wed Aug 11 20:44:35 2004  Matthias Clasen  <maclas at gmx.de>
 
-	* src/xdgmime.h (XDG_MIME_TYPE_UNKNOWN): move the definition so
-	that it catches the XDG_ENTRY mangling.
+	* xdgmime.h (xdg_mime_shutdown): Add the XDG_PREFIX to
+	this function as well.
 
-	* src/xdgmimemagic.c: make some functions static
+2004-08-01  Matthias Clasen  <mclasen at redhat.com>
 
-Tue Jan 20 14:34:26 2004  Jonathan Blandford  <jrb at gnome.org>
+	* === Released 2.5.1 ===
 
-	* src/xdgmime.c (xdg_mime_get_max_buffer_extents): add function so
-	that it's easy to get the max buffer extents.
+Tue Jul 20 22:24:35 2004  Matthias Clasen  <maclas at gmx.de>
 
-Tue Jan 20 12:55:55 2004  Jonathan Blandford  <jrb at gnome.org>
+	* xdgmimeglob.h: Remove trailing commas from 
+	enumerations. (#148035)
 
-	* src/Makefile: Test prefix code
+Sun Jul 18 20:17:41 2004  Soeren Sandmann  <sandmann at daimi.au.dk>
 
-	* src/xdgmime*.h: Fully use the prefix code
+	* === Released 2.5.0 ==
 
-	* src/xdgmime.c: finish the syncing from both GTK+ and gnome-vfs.
+Thu May 27 15:23:17 2004  Jonathan Blandford  <jrb at gnome.org>
 
-Tue Jan 13 16:21:04 2004  Jonathan Blandford  <jrb at gnome.org>
+	* Sync from upstream
 
-	* src/xdgmime.[ch] (XDG_MIME_TYPE_UNKNOWN): make an extern const
-	char * so that comparisons can work.
+Fri Apr 30 00:19:11 2004  Matthias Clasen  <maclas at gmx.de>
 
-	* src/xdgmimeint.c (_xdg_utf8_to_ucs4): patch from Dave Jones
-	<davej at redhat.com> to make operations more explicit.
+	* xdgmimemagic.c (_xdg_mime_magic_read_a_number): Make sure
+	the static string is long enough.  (#136323, Morten Welinder)
 
-Tue Oct 28 15:09:06 2003  Jonathan Blandford  <jrb at redhat.com>
+2004-03-12  Morten Welinder  <terra at gnome.org>
 
-	* README: Add a readme, and clarify the licensing terms of the
-	software.
+	* *.c: Make sure to include <config.h>  (#137001)
 
-Tue Oct 28 14:47:37 2003  Jonathan Blandford  <jrb at redhat.com>
+Wed Mar 10 22:48:15 2004  Jonathan Blandford  <jrb at gnome.org>
 
-	* src/xdgmime.c (xdg_mime_shutdown): implement shutdown.  This
-	frees all memory and resets to an uninitialized state as best as
-	possible.
+	* Sync from upstream
 
-Mon Oct 27 11:45:58 2003  Jonathan Blandford  <jrb at redhat.com>
+Sun Feb  8 19:05:16 2004  Manish Singh  <yosh at gimp.org>
 
-	* src/xdgmimemagic.c (_xdg_mime_magic_read_a_number): strtol
-	returns a long, not an int.  Thanks to Manish Singh for pointing
-	this out.
+	* xdgmimeint.h: declare _xdg_utf8_skip as extern to prevent multiple
+	definitions.
 
-	* src/xdgmimemagic.c (_xdg_mime_magic_parse_magic_line): change
-	assertion to avoid a warning.
+Wed Jan 21 09:33:13 2004  Jonathan Blandford  <jrb at gnome.org>
 
-Tue Oct 21 15:56:55 2003  Jonathan Blandford  <jrb at gnome.org>
+	* libgnomevfs/xdgmimeglob.c:
+	* libgnomevfs/xdgmimemagic.c: Sync from upstream
 
-	* Makefile: add a simple makefile
-	* src/Makefile: ditto
+Tue Jan 20 13:07:04 2004  Jonathan Blandford  <jrb at gnome.org>
 
+	* xdgmime.c: resync with upstream sources.
+
+Fri Oct 24 16:54:57 2003  Owen Taylor  <otaylor at redhat.com>
+
+	* Makefile.am (libxdgmime_la_SOURCES): Add .h files to 
+	SOURCES.
+
+Fri Oct 24 16:02:32 2003  Owen Taylor  <otaylor at redhat.com>
+
+	* *.[ch]: Relicense to be dual AFL/LGPL (and thus also
+	GPL) rather than AFL/GPL. Also update AFL version to 1.2.
+
 Tue Jul 22 15:37:45 2003  Jonathan Blandford  <jrb at gnome.org>
 
 	* xdgmime/xdgmime.c (xdg_mime_init): use XDG_DATA_HOME instead of

Modified: trunk/Utils/xdgmime/xdgmimecache.c
===================================================================
--- trunk/Utils/xdgmime/xdgmimecache.c	2007-03-29 11:07:48 UTC (rev 793)
+++ trunk/Utils/xdgmime/xdgmimecache.c	2007-03-29 13:13:24 UTC (rev 794)
@@ -463,7 +463,8 @@
 	    {
 	      mimetype_offset = GET_UINT32 (cache->buffer, offset + 16 * mid + 4);
 	      n = 0;
-	      mime_types[n++] = cache->buffer + mimetype_offset;
+	      if (mimetype_offset)
+		mime_types[n++] = cache->buffer + mimetype_offset;
 	      
 	      n_children = GET_UINT32 (cache->buffer, offset + 16 * mid + 8);
 	      child_offset = GET_UINT32 (cache->buffer, offset + 16 * mid + 12);
@@ -850,10 +851,12 @@
 char **
 _xdg_mime_cache_list_mime_parents (const char *mime)
 {
-  int i, j, p;
+  int i, j, k, p;
   char *all_parents[128]; /* we'll stop at 128 */ 
   char **result;
 
+  mime = xdg_mime_unalias_mime_type (mime);
+
   p = 0;
   for (i = 0; _caches[i]; i++)
     {
@@ -864,16 +867,20 @@
 
       for (j = 0; j < n_entries; j++)
 	{
-	  xdg_uint32_t mimetype_offset = GET_UINT32 (cache->buffer, list_offset + 4 + 8 * i);
-	  xdg_uint32_t parents_offset = GET_UINT32 (cache->buffer, list_offset + 4 + 8 * i + 4);
-	  
+	  xdg_uint32_t mimetype_offset = GET_UINT32 (cache->buffer, list_offset + 4 + 8 * j);
+	  xdg_uint32_t parents_offset = GET_UINT32 (cache->buffer, list_offset + 4 + 8 * j + 4);
+
 	  if (strcmp (cache->buffer + mimetype_offset, mime) == 0)
 	    {
+	      xdg_uint32_t parent_mime_offset;
 	      xdg_uint32_t n_parents = GET_UINT32 (cache->buffer, parents_offset);
-	      
-	      for (j = 0; j < n_parents; j++)
-		all_parents[p++] = cache->buffer + parents_offset + 4 + 4 * j;
 
+	      for (k = 0; k < n_parents && p < 127; k++)
+		{
+		  parent_mime_offset = GET_UINT32 (cache->buffer, parents_offset + 4 + 4 * k);
+		  all_parents[p++] = cache->buffer + parent_mime_offset;
+		}
+
 	      break;
 	    }
 	}



From fabricecolin at mail.berlios.de  Thu Mar 29 15:19:09 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 29 Mar 2007 15:19:09 +0200
Subject: [Pinot-svn] r795 - trunk
Message-ID: <200703291319.l2TDJ91R029405@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-29 15:19:08 +0200 (Thu, 29 Mar 2007)
New Revision: 795

Modified:
   trunk/README
Log:
Details upgrading to 0.71. Some minor changes.


Modified: trunk/README
===================================================================
--- trunk/README	2007-03-29 13:13:24 UTC (rev 794)
+++ trunk/README	2007-03-29 13:19:08 UTC (rev 795)
@@ -50,6 +50,13 @@
   My Documents index.
 
 
+  * to 0.71 or newer
+  V0.71 and newer will detect what version the My Documents index was built
+  with and automatically upgrade it by reindexing all documents, if necessary.
+  As for My Web Pages, the UI will indicate when upgrading is necessary.
+  Updating documents with the Index, Update menu is recommended.
+
+
 3. Available engines 
 
 
@@ -429,8 +436,7 @@
     (or more) index is still locked. Quit Pinot and look for a "db_lock" file
     in "~/.pinot/index". If it's there, delete it and restart Pinot.
     Starting with 0.60, indexes are created with the newer Flint back-end
-    which is immune to this issue. The easiest way to "upgrade" is to delete
-    the index, let Pinot recreate it, then reindex your data.
+    which is immune to this issue.
 
   * When compiling from source, you may run into linking problems related to
     libstdc++.la. Try patching xapian-config as explained in the post at
@@ -464,7 +470,12 @@
 
   * On FreeBSD, threading issues may cause the daemon to crash unexpectedly.
     A fix is to add the following lines to /etc/libmap.conf (which may not exist) :
+     [/usr/local/bin/pinot-dbus-daemon]
      libpthread.so.2         libc_r.so.6
      libpthread.so           libc_r.so
+
+     [/usr/local/bin/pinot]
+     libpthread.so.2         libc_r.so.6
+     libpthread.so           libc_r.so
     Refer to the libmap.conf(5) man page for details.
 



From fabricecolin at mail.berlios.de  Thu Mar 29 15:25:13 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 29 Mar 2007 15:25:13 +0200
Subject: [Pinot-svn] r796 - trunk
Message-ID: <200703291325.l2TDPDfu030541@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-29 15:25:12 +0200 (Thu, 29 Mar 2007)
New Revision: 796

Modified:
   trunk/TODO
Log:
Removed items that were implemented recently and added a whole lot more...


Modified: trunk/TODO
===================================================================
--- trunk/TODO	2007-03-29 13:19:08 UTC (rev 795)
+++ trunk/TODO	2007-03-29 13:25:12 UTC (rev 796)
@@ -1,13 +1,10 @@
 Documentation
-- dotfiles are skipped
-- symlinks to GAIM logs and hidden mail will enable indexing
-- how is My Web Pages populated; talk about use as document storage
-- how to show Web engines
-- difference between setting up external indexes with + and installing plugins
-- list what files from libtextcat 2.2 go where ?
+- List what files from libtextcat 2.2 go where ?
 - MIME type should be as returned by xdg-utils' 'xdg-mime query filetype ...'
-- try listing names of dependency packages for most distros
-- how to trouble-shoot with delve, get to a file with filters and labels
+- Try listing names of dependency packages for most distros
+- How to trouble-shoot with delve, get to a file with filters and labels
+- Explain when indexing and updating are done, eg in the results list, Index on
+ a result already indexed doesn't update it
 
 General
 - Fix the FIXMEs
@@ -34,8 +31,6 @@
 
 Monitor
 - Implement support for Solaris FEM
-- Moves to unmonitored locations queue MOVED_FROM events but we never receive MOVED_TO's;
- time out MOVED_FROM's after a while and generate DELETE events
 
 Collect
 - Comply with robot stuff defined at http://www.robotstxt.org/
@@ -43,8 +38,6 @@
 - Make User-Agent string configurable
 - Make download timeout configurable
 - Support for HTML frames
-- Curl and Neon must support a proxy, so allow to configure that
-- MBoxCollector should return headers too !
 
 Search
 - With engines that provide a redirection URL for results (eg Acoona), it looks like
@@ -56,12 +49,10 @@
 - Support for Google Buttons
 - Export search results as OpenSearch Response or CSV
 - Nested queries
-- Search for U-prefixed term in query generated by QueryParser and hash the URL if necessary
-- Make sure filters with quotes are (space-)escaped
-- Allow sorting by date
 - Get hold of stopwords lists for the languages supported by Xapian's stemmers
  and remove stopwords from queries as first step of search
 - Make multi-step index search optional
+- AbstractGenerator seed terms should only be the query terms matched by the document
 
 Index
 - Play around with the XAPIAN_FLUSH_THRESHOLD env var
@@ -76,17 +67,19 @@
 - Reverse terms so that left wildcards can be applied ?
 - Index directories with type "x-directory/normal"
 - XapianIndex could do with some common code refactoring
-- Make sure prefixed terms are (space-)escaped
 - With Xapian 1.0, all indexes can be browsed with the new global posting list, ie
   Xapian::Database::postlist_begin("")
 - Use Xapian new TextSplitter class
 - Index Nautilus metadata (http://linuxboxadmin.com/articles/nautilus.php)
-- Automatically categorize documents based on MIME type into picture, video, etc...
+- Automatically categorize documents based on MIME type and source into picture, video, etc...
+- Does updateDocumentInfo sometimes fail to remove terms from the old title ?
+- DBusXapianIndex to use D-Bus method Index
+- pinot-index to instantiate a DBusXapianIndex if dealing with the daemon index
 
 Mail
 - Find out what kind of locking scheme Mozilla uses (POSIX lock ?) and use that
 - Index Evolution email (Camel, might be useful for other types actually)
-- Append sender to title or use as host name ?
+- Index mail headers
 - Decypher and use Mozilla's mailbox scheme, eg
   mailbox://mbox_file_name?number=2164959&part=1.2&type=text/plain&filename=portability.txt
 - When parsing email's Date field, take the timezone offset into account, eg in
@@ -101,35 +94,46 @@
 - Queue unindexing too
 - Don't link against SOAP stuff, it's not needed here
 - Labels should be managed by the daemon, and not saved to the configuration file
-- Make sure labels are alpha-numeric characters exclusively
 - DBus SetDocument[s]Labels should create labels if necessary
 - Reintroduce Index method in D-Bus interface
 - There's currently no way to get a document's ID without running a search
 - Allow notifications when configuration should be reloaded
-- Implement Wasabi draft(s)
+- Implement Xesam draft(s)
 - SimpleQuery to switch multi-step search on
 
 UI
-- When sorting results by host name, give better score to results that appear several times
-- Show which threads are running, what they are doing, and allow to stop them selectively
-- Automatic indexing of a query's results depending on type, source, size, language
+- When sorting results by host name, give better score to results that appear
+ several times
+- Show which threads are running, what they are doing, and allow to stop them
+ selectively
+- Automatic indexing of a query's results depending on type, source, size,
+ language
 - Display search engines icons (Gtk::IconSource::set_filename() and Gtk::Style::render_icon())
-- Replace Combobox objects with ComboboxText's (glademm support required)
 - Replace glademm with libglademm ?
 - Make unique (http://guniqueapp.akl.lt/)
-- Filter documents by language, similarly to how labels are shown
-- Either Live Query behaves like a live query (eg results list updated when new documents match)
-  or it is renamed to something else to avoid confusion
-- When viewing a result, all rows for that same URL should be updated with the Viewed icon
+- Either Live Query behaves like a live query (eg results list updated when new
+ documents match) or it is renamed to something else to avoid confusion
+- When viewing a result, all rows for that same URL should be updated with the
+ Viewed icon
 - Set results' indexed status after IndexingThread returns
 - Show date ranges in queries summary
 - Add Group By None to show all results at the same level
-- Opening when the daemon is busy indexing is awfully slow : is it because we are trying
- to get hold of a revision of the index ?
-- GTK has a file chooser button, does glade-- have support for it ?
+- Make use of GTKmm 2.10 StatusIcon
 - Query expansion should be interactive
-- UI doesn't show documents indexed by the daemon the very first time it's run, at least until
- it's restarted; doing a flush at startup if the index is empty might fix that
-- Status window should be live. Errors should say what failed !
-- Multi-step search should be off to start with. If no exact match is found, show a button
- in the results group to allow the user to try step 2 and beyond
+- UI doesn't show documents indexed by the daemon the very first time it's run,
+ at least until it's restarted
+- Errors should say what failed !
+- Unknown exceptions in IndexingThread or elsewhere should be logged as errors
+- Show whether Pinot was built with boost Spirit and how many plugins of each
+ type there are
+- Multi-step search should be off to start with. If no exact match is found,
+ show a button in the results group to allow the user to try step 2 and beyond
+- Profile the UI and find out why it takes so much CPU at startup, especially
+ when the daemon is busy indexing : is it because we are trying to get hold of
+ a revision of the index ?
+- Delete all temporary files when exiting
+- Size is lost by both Index and ResultsTree
+- Add less than, equal to. greater than filters on size for stored queries
+- Allow filtering index lists with a stored query instead of just labels
+- Show with icons which stored queries are fully, partially or not at all Web friendly
+



From fabricecolin at mail.berlios.de  Thu Mar 29 15:25:55 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 29 Mar 2007 15:25:55 +0200
Subject: [Pinot-svn] r797 - trunk/Tokenize
Message-ID: <200703291325.l2TDPtNa030667@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-29 15:25:54 +0200 (Thu, 29 Mar 2007)
New Revision: 797

Modified:
   trunk/Tokenize/FilterUtils.cpp
Log:
More verbose DEBUG output.


Modified: trunk/Tokenize/FilterUtils.cpp
===================================================================
--- trunk/Tokenize/FilterUtils.cpp	2007-03-29 13:25:12 UTC (rev 796)
+++ trunk/Tokenize/FilterUtils.cpp	2007-03-29 13:25:54 UTC (rev 797)
@@ -67,7 +67,7 @@
 		(pFilter->is_data_input_ok(Filter::DOCUMENT_DATA) == true))
 	{
 #ifdef DEBUG
-		cout << "FilterUtils::feedFilter: feeding data" << endl;
+		cout << "FilterUtils::feedFilter: feeding " << dataLength << " bytes of data from " << location << endl;
 #endif
 		fedInput = pFilter->set_document_data(pData, dataLength);
 	}



From fabricecolin at mail.berlios.de  Sat Mar 31 05:30:47 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 31 Mar 2007 05:30:47 +0200
Subject: [Pinot-svn] r798 - trunk
Message-ID: <200703310330.l2V3Ulnm003515@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-31 05:30:44 +0200 (Sat, 31 Mar 2007)
New Revision: 798

Modified:
   trunk/NEWS
Log:
Changes since previous release.


Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2007-03-29 13:25:54 UTC (rev 797)
+++ trunk/NEWS	2007-03-31 03:30:44 UTC (rev 798)
@@ -1,3 +1,34 @@
+2007/03/31 version_0_7_1
+Tokenize :
+ - HTML filter wasn't always properly initialized, which could cause a crash
+Monitor :
+ - file creation wasn't acted upon
+ - moves to unmonitored locations are treated as deletions
+Collect :
+ - fixed building with a version of curl that doesn't depend on OpenSSL
+ - dropped pinot-collect tool
+Index :
+ - added versioning
+ - label names, file names, directory names and URLs are escaped
+ - directories are indexed as separate documents
+Search :
+ - filters with spaces or control characters should be double-quoted, eg :
+  file:"Cats & Dogs.txt"
+Daemon :
+ - extended D-Bus methods Set and GetDocumentInfo
+ - fixed off-by-one error in numbering of mail messages parts
+ - blacklist wasn't applied to files for which the monitor reports events
+ - an index created with Pinot < 0.71 is automatically upgraded
+Deskbar :
+ - use deskbar.Utils.url_show() if available
+UI :
+ - added proxy support for Web engines queries and collection of documents on HTTP
+ - better work-around for desktop files that attempt setting env variables in Exec
+ - use Gtk::ComboboxText where appropriate
+ - German translation by Christian Dywan
+ - Italian translation by Michele Angrisano
+ - Portuguese translation by _PN_boy
+
 2007/03/06 version_0_7_0
 Tokenize :
  - now use Dijon's filters (http://dijon.berlios.de/)



From fabricecolin at mail.berlios.de  Sat Mar 31 06:04:07 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 31 Mar 2007 06:04:07 +0200
Subject: [Pinot-svn] r799 - tags
Message-ID: <200703310404.l2V447IE007682@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-31 06:04:04 +0200 (Sat, 31 Mar 2007)
New Revision: 799

Added:
   tags/version_0_7_1/
Log:
Releasing 0.71 today.


Copied: tags/version_0_7_1 (from rev 798, trunk)



From fabricecolin at mail.berlios.de  Sat Mar 31 11:24:27 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 31 Mar 2007 11:24:27 +0200
Subject: [Pinot-svn] r800 - trunk
Message-ID: <200703310924.l2V9OR44032667@sheep.berlios.de>

Author: fabricecolin
Date: 2007-03-31 11:24:27 +0200 (Sat, 31 Mar 2007)
New Revision: 800

Modified:
   trunk/NEWS
Log:
I forgot to list two new features... Never mind.


Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2007-03-31 04:04:04 UTC (rev 799)
+++ trunk/NEWS	2007-03-31 09:24:27 UTC (rev 800)
@@ -22,6 +22,8 @@
 Deskbar :
  - use deskbar.Utils.url_show() if available
 UI :
+ - Status window is now live
+ - View on a plain text message shows the mail headers
  - added proxy support for Web engines queries and collection of documents on HTTP
  - better work-around for desktop files that attempt setting env variables in Exec
  - use Gtk::ComboboxText where appropriate



