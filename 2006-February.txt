From fabricecolin at berlios.de  Wed Feb  1 14:33:40 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 1 Feb 2006 14:33:40 +0100
Subject: [Pinot-svn] r91 - trunk/Search
Message-ID: <200602011333.k11DXeBA015390@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-01 14:33:38 +0100 (Wed, 01 Feb 2006)
New Revision: 91

Modified:
   trunk/Search/SherlockParser.cpp
   trunk/Search/plugintest.cpp
Log:
Sherlock parser grammar copes with foreign tags.


Modified: trunk/Search/SherlockParser.cpp
===================================================================
--- trunk/Search/SherlockParser.cpp	2006-01-31 04:06:30 UTC (rev 90)
+++ trunk/Search/SherlockParser.cpp	2006-02-01 13:33:38 UTC (rev 91)
@@ -158,7 +158,7 @@
 		definition(plugin_grammar const &self)
 		{
 			// Start
-			search_plugin = search_header >> input_elements >> search_footer;
+			search_plugin = search_header >> input_elements >> search_footer >> rest;
 
 			// All items have a name and an optionally-quoted value, separated by =
 			end_of_name = ch_p('=');
@@ -227,10 +227,13 @@
 
 			// SEARCH has a closing tag
 			search_footer =  ch_p('<') >> ch_p('/') >> as_lower_d[str_p("search")] >> ch_p('>');
+
+			// Rest
+			rest = *anychar_p;
 		}
 
 		string unquotedValue, itemName, itemValue;		
-		rule<ScannerT> search_plugin, search_header, search_footer;
+		rule<ScannerT> search_plugin, search_header, search_footer, rest;
 		rule<ScannerT> end_of_name, any_name, any_value_without_quotes, any_value, search_item;
 		rule<ScannerT> input_elements, input_element, inputprev_element, inputnext_element, interpret_element;
 		rule<ScannerT> input_item_name, input_item_value, input_item_user, input_item_factor;
@@ -516,12 +519,14 @@
 	// We are done with the document
 	delete pPluginDoc;
 
-	SherlockResponseParser *pResponseParser = new SherlockResponseParser();
+	SherlockResponseParser *pResponseParser = NULL;
 
 	if (parseInfo.full == true)
 	{
 		map<string, string> lowSearchParams, lowInterpretParams, lowInputItems;
 
+		pResponseParser = new SherlockResponseParser();
+
 		LowerAndCopy lowCopy1(lowSearchParams);
 		for_each(searchParams.begin(), searchParams.end(), lowCopy1);
 		LowerAndCopy lowCopy2(lowInterpretParams);
@@ -541,6 +546,13 @@
 			properties.m_name = mapIter->second;
 		}
 
+		// Description
+		mapIter = lowSearchParams.find("description");
+		if (mapIter != lowSearchParams.end())
+		{
+			properties.m_description = mapIter->second;
+		}
+
 		// Channel
 		mapIter = lowSearchParams.find("routetype");
 		if (mapIter != lowSearchParams.end())
@@ -679,9 +691,6 @@
 			}
 		}
 	}
-#ifdef DEBUG
-	else cout << "SherlockParser::parse: syntax error near " << parseInfo.stop << endl;
-#endif
 
 	return pResponseParser;
 }

Modified: trunk/Search/plugintest.cpp
===================================================================
--- trunk/Search/plugintest.cpp	2006-01-31 04:06:30 UTC (rev 90)
+++ trunk/Search/plugintest.cpp	2006-02-01 13:33:38 UTC (rev 91)
@@ -64,7 +64,8 @@
 		{
 			delete pResponseParser;
 
-			cout << "Plugin " << properties.m_name << ": " << properties.m_description << endl;
+			cout << "Plugin: " << properties.m_name << endl;
+			cout << "Description: " << properties.m_description << endl;
 			cout << "Channel: " << properties.m_channel << endl;
 			cout << "URL: " << properties.m_baseUrl << endl;
 			cout << "Input parameters are:" << endl;



From fabricecolin at berlios.de  Wed Feb  1 14:35:26 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 1 Feb 2006 14:35:26 +0100
Subject: [Pinot-svn] r92 - trunk/UI/GTK2/src
Message-ID: <200602011335.k11DZQBK016431@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-01 14:35:20 +0100 (Wed, 01 Feb 2006)
New Revision: 92

Modified:
   trunk/UI/GTK2/src/pinot.cc
Log:
Added missing call to bind_textdomain_codeset().


Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2006-02-01 13:33:38 UTC (rev 91)
+++ trunk/UI/GTK2/src/pinot.cc	2006-02-01 13:35:20 UTC (rev 92)
@@ -89,8 +89,9 @@
 	struct sigaction newAction;
 
 #if defined(ENABLE_NLS)
-	bindtextdomain (GETTEXT_PACKAGE, PACKAGE_LOCALE_DIR);
-	textdomain (GETTEXT_PACKAGE);
+	bindtextdomain(GETTEXT_PACKAGE, PACKAGE_LOCALE_DIR);
+	bind_textdomain_codeset(GETTEXT_PACKAGE, "UTF-8");
+	textdomain(GETTEXT_PACKAGE);
 #endif //ENABLE_NLS
 
 	NeonDownloader::initialize();



From fabricecolin at berlios.de  Wed Feb  1 14:46:54 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 1 Feb 2006 14:46:54 +0100
Subject: [Pinot-svn] r93 - trunk/UI/GTK2/src
Message-ID: <200602011346.k11DksPu023208@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-01 14:46:26 +0100 (Wed, 01 Feb 2006)
New Revision: 93

Modified:
   trunk/UI/GTK2/src/EnginesTree.cpp
Log:
Select the current user's engines group by default.


Modified: trunk/UI/GTK2/src/EnginesTree.cpp
===================================================================
--- trunk/UI/GTK2/src/EnginesTree.cpp	2006-02-01 13:35:20 UTC (rev 92)
+++ trunk/UI/GTK2/src/EnginesTree.cpp	2006-02-01 13:46:26 UTC (rev 93)
@@ -317,6 +317,8 @@
 		row[m_enginesColumns.m_type] = indexType;
 	}
 
+	get_selection()->select(localIter);
+
 	expand_all();
 }
 



From fabricecolin at berlios.de  Wed Feb  1 15:00:59 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 1 Feb 2006 15:00:59 +0100
Subject: [Pinot-svn] r94 - trunk
Message-ID: <200602011400.k11E0x2L027880@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-01 15:00:49 +0100 (Wed, 01 Feb 2006)
New Revision: 94

Removed:
   trunk/libxmlpp026.patch
Log:
Obsolete.


Deleted: trunk/libxmlpp026.patch
===================================================================
--- trunk/libxmlpp026.patch	2006-02-01 13:46:26 UTC (rev 93)
+++ trunk/libxmlpp026.patch	2006-02-01 14:00:49 UTC (rev 94)
@@ -1,13 +0,0 @@
---- pinot-0.20/variables.mk_bak    2005-07-17 19:55:39.549604896 +0800
-+++ pinot-0.20/variables.mk        2005-07-17 20:01:56.493300744 +0800
-@@ -72,8 +72,8 @@
- SQLITE_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags sqlite3)
- SQLITE_LIBS = $(shell /usr/bin/pkg-config --libs sqlite3)
- # LibXML 2.0
--LIBXML_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags libxml++-2.6)
--LIBXML_LIBS = $(shell /usr/bin/pkg-config --libs libxml++-2.6)
-+LIBXML_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags libxml++-1.0) -DHAS_LIBXMLPP026
-+LIBXML_LIBS = $(shell /usr/bin/pkg-config --libs libxml++-1.0)
- # Mozilla
- MOZILLA_LIB_DIR = $(shell dirname `find /usr/lib*/mozilla* -name libgtkembedmoz.so | head -1`)
- ifeq ($(MOZILLA_LIB_DIR),)



From fabricecolin at berlios.de  Thu Feb  2 14:18:29 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Thu, 2 Feb 2006 14:18:29 +0100
Subject: [Pinot-svn] r95 - trunk/UI/GTK2/src
Message-ID: <200602021318.k12DIT7b017465@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-02 14:18:24 +0100 (Thu, 02 Feb 2006)
New Revision: 95

Modified:
   trunk/UI/GTK2/src/ResultsTree.cpp
   trunk/UI/GTK2/src/mainWindow.cc
Log:
UTF-8 fixes on stored queries dates and results extracts.


Modified: trunk/UI/GTK2/src/ResultsTree.cpp
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.cpp	2006-02-01 14:00:49 UTC (rev 94)
+++ trunk/UI/GTK2/src/ResultsTree.cpp	2006-02-02 13:18:24 UTC (rev 95)
@@ -347,7 +347,7 @@
 			}
 
 			RefPtr<TextBuffer> refBuffer = m_extractTextview->get_buffer();
-			refBuffer->set_text(extract);
+			refBuffer->set_text(to_utf8(extract));
 			// The extract is not editable
 			m_extractTextview->set_editable(false);
 			m_extractTextview->set_cursor_visible(false);

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-02-01 14:00:49 UTC (rev 94)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-02-02 13:18:24 UTC (rev 95)
@@ -280,7 +280,7 @@
 		{
 			lastRun = _("N/A");
 		}
-		row[m_queryColumns.m_lastRun] = lastRun;
+		row[m_queryColumns.m_lastRun] = to_utf8(lastRun);
 		string summary = queryIter->second.toString();
 		if (summary.empty() == false)
 		{
@@ -2279,7 +2279,7 @@
 {
 	QueryProperties queryProps;
 
-	queryProps.setName("Live query");
+	queryProps.setName(_("Live query"));
 	// FIXME: parse the query string !
 	queryProps.setAnyWords(from_utf8(liveQueryEntry->get_text()));
 
@@ -2362,7 +2362,7 @@
 		run_search(queryProps);
 
 		// Update the Last Run column
-		queryRow[m_queryColumns.m_lastRun] = TimeConverter::toTimestamp(time(NULL));
+		queryRow[m_queryColumns.m_lastRun] = to_utf8(TimeConverter::toTimestamp(time(NULL)));
 	}
 }
 



From fabricecolin at berlios.de  Mon Feb  6 15:16:57 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Mon, 6 Feb 2006 15:16:57 +0100
Subject: [Pinot-svn] r96 - trunk/UI/GTK2/src
Message-ID: <200602061416.k16EGvwf002860@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-06 15:16:55 +0100 (Mon, 06 Feb 2006)
New Revision: 96

Modified:
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/pinot.cc
Log:
In index_document(), don't complain about already indexed files if we are going
to set a label on them. Let the main program set the default icon. Use the live
query's field as OR terms for new stored queries.


Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-02-02 13:18:24 UTC (rev 95)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-02-06 14:16:55 UTC (rev 96)
@@ -118,10 +118,6 @@
 		mainHpaned->set_position(m_settings.m_panePos);
 	}
 
-	// Set an icon for this and other windows
-	set_icon_from_file("/usr/share/icons/hicolor/48x48/apps/pinot.png");
-	set_default_icon_from_file("/usr/share/icons/hicolor/48x48/apps/pinot.png");
-
 	// Position the engine tree
 	m_pEnginesTree = manage(new EnginesTree(enginesVbox, m_settings));
 	// Connect to the "changed" signal
@@ -2291,7 +2287,7 @@
 //
 void mainWindow::on_addQueryButton_clicked()
 {
-	QueryProperties queryProps = QueryProperties("", "", "", "", "");
+	QueryProperties queryProps = QueryProperties("", "", "", from_utf8(liveQueryEntry->get_text()), "");
 
 	edit_query(queryProps, true);
 }
@@ -2880,7 +2876,8 @@
 			// This is a new document
 			start_thread(new IndexingThread(docInfo, labelName));
 		}
-		else
+		// Complain about already indexed files only if we aren't going to set a label on them
+		else if (labelName.empty() == true)
 		{
 			ustring status = url;
 			status += " ";
@@ -2993,7 +2990,10 @@
 				{
 					//viewstop1->set_sensitive(true);
 				}
-				set_status(to_utf8(m_pHtmlView->getLocation()));
+				ustring status = _("Viewing");
+				status += " ";
+				status += to_utf8(m_pHtmlView->getLocation());
+				set_status(status);
 			}
 		}
 	}
@@ -3019,6 +3019,9 @@
 		delete pNewThread;
 		return false;
 	}
+#ifdef DEBUG
+	cout << "mainWindow::start_thread: started thread " << pNewThread->getId() << endl;
+#endif
 
 	if (inBackground == false)
 	{

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2006-02-02 13:18:24 UTC (rev 95)
+++ trunk/UI/GTK2/src/pinot.cc	2006-02-06 14:16:55 UTC (rev 96)
@@ -168,6 +168,9 @@
 
 	try
 	{
+		// Set an icon for all windows
+		Gtk::Window::set_default_icon_from_file("/usr/share/icons/hicolor/48x48/apps/pinot.png");
+
 		// Create and open the main dialog box
 		mainWindow mainBox;
 		m.run(mainBox);



From fabricecolin at berlios.de  Mon Feb  6 15:23:30 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Mon, 6 Feb 2006 15:23:30 +0100
Subject: [Pinot-svn] r97 - in trunk: . Index
Message-ID: <200602061423.k16ENUns013722@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-06 15:23:27 +0100 (Mon, 06 Feb 2006)
New Revision: 97

Modified:
   trunk/Index/XapianIndex.cpp
   trunk/pinot.spec
Log:
Dropped support for libxml++ v0.26 as v2.12 is required now (or so it seems).
Add H-prefixed terms for all of the host name's subdomains so that searching
for "Hberlios.de" returns pages from "Hpinot.berlios.de"...


Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-02-06 14:16:55 UTC (rev 96)
+++ trunk/Index/XapianIndex.cpp	2006-02-06 14:23:27 UTC (rev 97)
@@ -163,11 +163,14 @@
 bool XapianIndex::prepareDocument(const DocumentInfo &info, Xapian::Document &doc,
 	Xapian::termcount &termPos, const std::string &summary) const
 {
+	string title(info.getTitle());
+	string location(info.getLocation());
+	Url urlObj(location);
+
 	// Add a magic term :-)
 	doc.add_term(MAGIC_TERM);
 
 	// Index the title with and without prefix T
-	string title = info.getTitle();
 	if (title.empty() == false)
 	{
 		Document titleDoc;
@@ -178,17 +181,28 @@
 		addTermsToDocument(titleTokens, doc, "", termPos, m_stemMode);
 	}
 
-	string location = info.getLocation();
-	Url urlObj(location);
-
 	// Index the full URL with prefix U
 	doc.add_term(limitTermLength(string("U") + location, true));
-	// ...the host name with prefix H
-	string hostName = urlObj.getHost();
-	doc.add_term(limitTermLength(string("H") + StringManip::toLowerCase(hostName), true));
+	// ...the host name and included domains with prefix H
+	string hostName(StringManip::toLowerCase(urlObj.getHost()));
+	if (hostName.empty() == false)
+	{
+		doc.add_term(limitTermLength(string("H") + hostName, true));
+		string::size_type dotPos = hostName.find('.');
+		while (dotPos != string::npos)
+		{
+			doc.add_term(limitTermLength(string("H") + hostName.substr(dotPos + 1), true));
+
+			// Next
+			dotPos = hostName.find('.', dotPos + 1);
+		}
+	}
 	// ...and the file name with prefix F
-	string fileName = urlObj.getFile();
-	doc.add_term(limitTermLength(string("F") + StringManip::toLowerCase(fileName), true));
+	string fileName(urlObj.getFile());
+	if (fileName.empty() == false)
+	{
+		doc.add_term(limitTermLength(string("F") + StringManip::toLowerCase(fileName), true));
+	}
 	// Finally, add the language with prefix L
 	doc.add_term(string("L") + StringManip::toLowerCase(m_stemLanguage));
 

Modified: trunk/pinot.spec
===================================================================
--- trunk/pinot.spec	2006-02-06 14:16:55 UTC (rev 96)
+++ trunk/pinot.spec	2006-02-06 14:23:27 UTC (rev 97)
@@ -8,18 +8,10 @@
 License: GPL
 Group: Applications/Internet 
 Source: %{name}-%{version}.tar.gz
-Patch0: libxmlpp026.patch
 URL: http://pinot.berlios.de/
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
-Requires: xapian-core-libs >= 0.9.2, neon >= 0.24, gtkmm24 >= 2.6, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
-BuildRequires: xapian-core-devel >= 0.9.2, neon-devel >= 0.24, gtkmm24-devel >= 2.6, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
-%if 0%{?_with_libxmlpp026:1}
-Requires: libxml++ >= 0.26
-BuildRequires: libxml++-devel >= 0.26
-%else
-Requires: libxml++ >= 2.6 
-BuildRequires: libxml++-devel >= 2.6
-%endif
+Requires: xapian-core-libs >= 0.9.2, neon >= 0.24, gtkmm24 >= 2.6, libxml++ >= 2.12, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
+BuildRequires: xapian-core-devel >= 0.9.2, neon-devel >= 0.24, gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
 
 %description
 Pinot is a metasearch tool for the Free Desktop. It enables one to query
@@ -47,9 +39,6 @@
 
 %prep
 %setup -q
-%if 0%{?_with_libxmlpp026:1}
-%patch0 -p1 -b .xml026
-%endif
 
 %build
 make DEBUG=yes



From fabricecolin at berlios.de  Tue Feb  7 13:18:06 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Tue, 7 Feb 2006 13:18:06 +0100
Subject: [Pinot-svn] r98 - in trunk: Index Search Utils
Message-ID: <200602071218.k17CI60c008871@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-07 13:18:03 +0100 (Tue, 07 Feb 2006)
New Revision: 98

Modified:
   trunk/Index/Summarizer.cpp
   trunk/Index/XapianIndex.cpp
   trunk/Search/QueryProperties.cpp
   trunk/Search/XapianEngine.cpp
   trunk/Utils/Languages.cpp
   trunk/Utils/Languages.h
Log:
Changed term prefixes to conform to Omega's termprefixes.txt document. This
will allow indexes to be queried by other Xapian-based tools that follow
those conventions and Pinot to use the QueryParser class at some point.
Unfortunately, users will have to update their documents and reapply labels !


Modified: trunk/Index/Summarizer.cpp
===================================================================
--- trunk/Index/Summarizer.cpp	2006-02-06 14:23:27 UTC (rev 97)
+++ trunk/Index/Summarizer.cpp	2006-02-07 12:18:03 UTC (rev 98)
@@ -42,15 +42,7 @@
 	m_dictionaryCode("en")
 {
 	// Look up the language code
-	for (unsigned int langNum = 0; langNum < Languages::m_count; ++langNum)
-	{
-		if (strncasecmp(language.c_str(), Languages::m_names[langNum],
-			min(language.length(), strlen(Languages::m_names[langNum]))) == 0)
-		{
-			m_dictionaryCode = Languages::m_codes[langNum];
-			break;
-		}
-	}
+	m_dictionaryCode = Languages::toCode(language);
 }
 
 Summarizer::~Summarizer()

Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-02-06 14:23:27 UTC (rev 97)
+++ trunk/Index/XapianIndex.cpp	2006-02-07 12:18:03 UTC (rev 98)
@@ -20,11 +20,13 @@
 #include <unistd.h>
 #include <stdio.h>
 #include <stdarg.h>
+#include <strings.h>
 #include <time.h>
 #include <regex.h>
 #include <iostream>
 #include <fstream>
 #include <algorithm>
+#include <utility>
 
 #include "Languages.h"
 #include "StringManip.h"
@@ -37,6 +39,7 @@
 
 using std::string;
 using std::set;
+using std::min;
 
 // This puts a limit to terms length.
 const unsigned int XapianIndex::m_maxTermLength = 128;
@@ -170,13 +173,13 @@
 	// Add a magic term :-)
 	doc.add_term(MAGIC_TERM);
 
-	// Index the title with and without prefix T
+	// Index the title with and without prefix S
 	if (title.empty() == false)
 	{
 		Document titleDoc;
 		titleDoc.setData(title.c_str(), title.length());
 		Tokenizer titleTokens(&titleDoc);
-		addTermsToDocument(titleTokens, doc, "T", termPos, STORE_UNSTEM);
+		addTermsToDocument(titleTokens, doc, "S", termPos, STORE_UNSTEM);
 		titleTokens.rewind();
 		addTermsToDocument(titleTokens, doc, "", termPos, m_stemMode);
 	}
@@ -197,14 +200,14 @@
 			dotPos = hostName.find('.', dotPos + 1);
 		}
 	}
-	// ...and the file name with prefix F
+	// ...and the file name with prefix P
 	string fileName(urlObj.getFile());
 	if (fileName.empty() == false)
 	{
-		doc.add_term(limitTermLength(string("F") + StringManip::toLowerCase(fileName), true));
+		doc.add_term(limitTermLength(string("P") + StringManip::toLowerCase(fileName), true));
 	}
-	// Finally, add the language with prefix L
-	doc.add_term(string("L") + StringManip::toLowerCase(m_stemLanguage));
+	// Finally, add the language code with prefix L
+	doc.add_term(string("L") + Languages::toCode(m_stemLanguage));
 
 	setDocumentData(doc, info, summary, m_stemLanguage);
 
@@ -393,7 +396,7 @@
 		for (set<string>::const_iterator labelIter = labels.begin(); labelIter != labels.end();
 			++labelIter)
 		{
-			doc.add_term(limitTermLength(string("C") + *labelIter));
+			doc.add_term(limitTermLength(string("XLABEL:") + *labelIter));
 		}
 		if (prepareDocument(docInfo, doc, termPos, summary) == true)
 		{
@@ -492,7 +495,7 @@
 		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
 		if (pIndex != NULL)
 		{
-			string term("C");
+			string term("XLABEL:");
 
 			// Get documents that have this label
 			// FIXME: would it be faster to get the document's terms ?
@@ -541,16 +544,20 @@
 		Xapian::Database *pIndex = pDatabase->readLock();
 		if (pIndex != NULL)
 		{
-			for (Xapian::TermIterator termIter = pIndex->termlist_begin(docId);
-				termIter != pIndex->termlist_end(docId); ++termIter)
+			Xapian::TermIterator termIter = pIndex->termlist_begin(docId);
+			if (termIter != pIndex->termlist_end(docId))
 			{
-				// Is this a label ?
-				if ((*termIter)[0] == 'C')
+				for (termIter.skip_to("XLABEL:");
+					termIter != pIndex->termlist_end(docId); ++termIter)
 				{
-					labels.insert((*termIter).substr(1));
+					// Is this a label ?
+					if (strncasecmp((*termIter).c_str(), "XLABEL:", min(7, (int)(*termIter).length())) == 0)
+					{
+						labels.insert((*termIter).substr(7));
+					}
 				}
+				gotLabels = true;
 			}
-			gotLabels = true;
 		}
 	}
 	catch (const Xapian::Error &error)
@@ -584,7 +591,7 @@
 		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
 		if (pIndex != NULL)
 		{
-			string term("C");
+			string term("XLABEL:");
 
 			// Get documents that have this label
 			term += name;
@@ -659,7 +666,7 @@
 			for (set<string>::const_iterator labelIter = labels.begin(); labelIter != labels.end();
 				++labelIter)
 			{
-				doc.add_term(limitTermLength(string("C") + *labelIter));
+				doc.add_term(limitTermLength(string("XLABEL:") + *labelIter));
 			}
 		}
 		if (prepareDocument(docInfo, doc, termPos, summary) == true)
@@ -758,13 +765,17 @@
 			// Reset existing labels ?
 			if (resetLabels == true)
 			{
-				for (Xapian::TermIterator termIter = doc.termlist_begin();
-					termIter != doc.termlist_end(); ++termIter)
+				Xapian::TermIterator termIter = pIndex->termlist_begin(docId);
+				if (termIter != pIndex->termlist_end(docId))
 				{
-					// Is this a label ?
-					if ((*termIter)[0] == 'C')
+					for (termIter.skip_to("XLABEL:");
+						termIter != pIndex->termlist_end(docId); ++termIter)
 					{
-						doc.remove_term(*termIter);
+						// Is this a label ?
+						if (strncasecmp((*termIter).c_str(), "XLABEL:", min(7, (int)(*termIter).length())) == 0)
+						{
+							doc.remove_term(*termIter);
+						}
 					}
 				}
 			}
@@ -773,7 +784,7 @@
 			for (set<string>::const_iterator labelIter = labels.begin(); labelIter != labels.end();
 				++labelIter)
 			{
-				doc.add_term(limitTermLength(string("C") + *labelIter));
+				doc.add_term(limitTermLength(string("XLABEL:") + *labelIter));
 			}
 
 			pIndex->replace_document(docId, doc);
@@ -901,7 +912,7 @@
 		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
 		if (pIndex != NULL)
 		{
-			string term("C");
+			string term("XLABEL:");
 
 			// Delete documents from the index
 			term += labelName;
@@ -996,7 +1007,7 @@
 		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
 		if (pIndex != NULL)
 		{
-			string term("C");
+			string term("XLABEL:");
 
 			// Get documents that have this label
 			term += name;
@@ -1010,7 +1021,7 @@
 				// Remove the term
 				doc.remove_term(term);
 				// ...add the new one
-				doc.add_term(limitTermLength(string("C") + newName));
+				doc.add_term(limitTermLength(string("XLABEL:") + newName));
 				// ...and update the document
 				pIndex->replace_document(docId, doc);
 			}
@@ -1048,7 +1059,7 @@
 		Xapian::WritableDatabase *pIndex = pDatabase->writeLock();
 		if (pIndex != NULL)
 		{
-			string term("C");
+			string term("XLABEL:");
 
 			// Get documents that have this label
 			term += name;

Modified: trunk/Search/QueryProperties.cpp
===================================================================
--- trunk/Search/QueryProperties.cpp	2006-02-06 14:23:27 UTC (rev 97)
+++ trunk/Search/QueryProperties.cpp	2006-02-07 12:18:03 UTC (rev 98)
@@ -17,6 +17,7 @@
 #include <iostream>
 #include <algorithm>
 
+#include "Languages.h"
 #include "QueryProperties.h"
 
 QueryProperties::QueryProperties()
@@ -298,7 +299,7 @@
 		if (m_language.empty() == false)
 		{
 			queryString += " +L";
-			queryString += m_language;
+			queryString += Languages::toCode(Languages::toEnglish(m_language));
 		}
 		if (m_hostFilter.empty() == false)
 		{
@@ -307,12 +308,12 @@
 		}
 		if (m_fileFilter.empty() == false)
 		{
-			queryString += " +F";
+			queryString += " +P";
 			queryString += m_fileFilter;
 		}
 		if (m_labelFilter.empty() == false)
 		{
-			queryString += " +C";
+			queryString += " +XLABEL:";
 			queryString += m_labelFilter;
 		}
 	}

Modified: trunk/Search/XapianEngine.cpp
===================================================================
--- trunk/Search/XapianEngine.cpp	2006-02-06 14:23:27 UTC (rev 97)
+++ trunk/Search/XapianEngine.cpp	2006-02-07 12:18:03 UTC (rev 98)
@@ -287,7 +287,7 @@
 	{
 		vector<string> fileTerms;
 
-		term = "F";
+		term = "P";
 		term += StringManip::toLowerCase(queryProps.getFileFilter());
 		fileTerms.push_back(term);
 		if (followOperators == true)
@@ -302,7 +302,7 @@
 	{
 		vector<string> labelTerms;
 
-		term = "C";
+		term = "XLABEL:";
 		term += queryProps.getLabelFilter();
 		labelTerms.push_back(term);
 		if (followOperators == true)
@@ -319,7 +319,7 @@
 		vector<string> languageTerms;
 
 		term = "L";
-		term += StringManip::toLowerCase(Languages::toEnglish(language));
+		term += Languages::toCode(Languages::toEnglish(language));
 #ifdef DEBUG
 		cout << "XapianEngine::stackQuery: filter "  << term << endl;
 #endif

Modified: trunk/Utils/Languages.cpp
===================================================================
--- trunk/Utils/Languages.cpp	2006-02-06 14:23:27 UTC (rev 97)
+++ trunk/Utils/Languages.cpp	2006-02-07 12:18:03 UTC (rev 98)
@@ -13,7 +13,7 @@
  *  along with this program; if not, write to the Free Software
  *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
  */
-
+ 
 #include <string.h>
 #include <utility>
 
@@ -98,3 +98,22 @@
 
 	return language;
 }
+
+string Languages::toCode(const string &language)
+{
+	if (language.empty() == false)
+	{
+		// Get the language code
+		for (unsigned int langNum = 0; langNum < Languages::m_count; ++langNum)
+		{
+			if (strncasecmp(language.c_str(), Languages::m_names[langNum],
+				min(language.length(), strlen(Languages::m_names[langNum]))) == 0)
+			{
+				// That's the one !
+				return Languages::m_codes[langNum];
+			}
+		}
+	}
+
+	return language;
+}

Modified: trunk/Utils/Languages.h
===================================================================
--- trunk/Utils/Languages.h	2006-02-06 14:23:27 UTC (rev 97)
+++ trunk/Utils/Languages.h	2006-02-07 12:18:03 UTC (rev 98)
@@ -37,11 +37,14 @@
 		/// Returns a language name, in the current locale.
 		static std::string toLocale(const std::string &language);
 
+		/// Returns a language code.
+		static std::string toCode(const std::string &language);
+
 		static unsigned int m_count;
-		static char *m_codes[];
 		static char *m_names[];
 
 	protected:
+		static char *m_codes[];
 		static std::map<unsigned int, std::string> m_intlNames;
 
 		Languages();



From fabricecolin at berlios.de  Tue Feb  7 13:18:55 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Tue, 7 Feb 2006 13:18:55 +0100
Subject: [Pinot-svn] r99 - trunk/Tokenize
Message-ID: <200602071218.k17CItwt008975@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-07 13:18:54 +0100 (Tue, 07 Feb 2006)
New Revision: 99

Modified:
   trunk/Tokenize/HtmlTokenizer.cpp
Log:
Don't lower case tags, this messes up links !


Modified: trunk/Tokenize/HtmlTokenizer.cpp
===================================================================
--- trunk/Tokenize/HtmlTokenizer.cpp	2006-02-07 12:18:03 UTC (rev 98)
+++ trunk/Tokenize/HtmlTokenizer.cpp	2006-02-07 12:18:54 UTC (rev 99)
@@ -15,6 +15,7 @@
  */
 
 #include <string.h>
+#include <strings.h>
 #include <sys/types.h>
 #include <regex.h>
 #include <stack>
@@ -150,9 +151,7 @@
 			int nLinksMatches = 3, nMetaMatches = 3;
 
 			// Found a tag from startPos to pos
-			string tag = str.substr(startPos, pos - startPos);
-			// Lower case the whole thing
-			tag = StringManip::toLowerCase(tag);
+			string tag(str.substr(startPos, pos - startPos));
 			// Push it onto the stack
 			tagsStack.push(tag);
 #ifdef DEBUG_TOKENIZER
@@ -214,7 +213,7 @@
 			}
 			// Maybe it's the anchor's end ?
 			else if ((extractLinks == true) &&
-				(tag == "/a"))
+				(strncasecmp(tag.c_str(), "/a", 2) == 0))
 			{
 				if (getLinkName == true)
 				{
@@ -248,16 +247,16 @@
 				{
 					string parentTag = tagsStack.top();
 
-					if ((tag.substr(0, 6) == "script") ||
-						(tag.substr(0, 5) == "style"))
+					if ((strncasecmp(tag.c_str(), "script", 6) == 0) ||
+						(strncasecmp(tag.c_str(), "style", 5) == 0))
 					{
 #ifdef DEBUG_TOKENIZER
 						cout << "HtmlTokenizer::parseHTML: skip script" << endl;
 #endif
 						catText = false;
 					}
-					else if (((tag.substr(0, 7) == "/script") ||
-						(tag.substr(0, 6) == "/style")) &&
+					else if (((strncasecmp(tag.c_str(), "/script", 7) == 0) ||
+						(strncasecmp(tag.c_str(), "/style", 6) == 0)) &&
 						(textBlockStart(parentTag) == false))
 					{
 #ifdef DEBUG_TOKENIZER
@@ -294,8 +293,8 @@
 /// Returns true if the tag corresponds to a text block.
 bool HtmlTokenizer::textBlockStart(const string &tag)
 {
-	if ((tag.substr(0, 4) == "body") ||
-		(tag.substr(0, 5) == "title"))
+	if ((strncasecmp(tag.c_str(), "body", 4) == 0) ||
+		(strncasecmp(tag.c_str(), "title", 5) == 0))
 	{
 		return true;
 	}
@@ -306,8 +305,8 @@
 /// Returns true if the tag corresponds to the end of a text block.
 bool HtmlTokenizer::textBlockEnd(const string &tag)
 {
-	if ((tag.substr(0, 5) == "/body") ||
-		(tag.substr(0, 6) == "/title"))
+	if ((strncasecmp(tag.c_str(), "/body", 5) == 0) ||
+		(strncasecmp(tag.c_str(), "/title", 6) == 0))
 	{
 		return true;
 	}



From fabricecolin at berlios.de  Tue Feb  7 13:21:45 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Tue, 7 Feb 2006 13:21:45 +0100
Subject: [Pinot-svn] r100 - in trunk: . Search
Message-ID: <200602071221.k17CLjX0009944@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-07 13:21:43 +0100 (Tue, 07 Feb 2006)
New Revision: 100

Modified:
   trunk/Makefile
   trunk/Search/SearchEngineFactory.cpp
   trunk/Search/SearchEngineFactory.h
   trunk/Search/senginetest.cpp
   trunk/pinot.spec
Log:
Distribute senginetest as pinot_search as a shell based metasearch would
be useful. SearchEngineFactory can list supported engine types.


Modified: trunk/Makefile
===================================================================
--- trunk/Makefile	2006-02-07 12:18:54 UTC (rev 99)
+++ trunk/Makefile	2006-02-07 12:21:43 UTC (rev 100)
@@ -41,6 +41,7 @@
 install-pinot:
 	@mkdir -p $(PREFIX)/usr/bin/
 	install -m 755 ${BIN_DIR}/pinot $(PREFIX)/usr/bin/pinot
+	install -m 755 ${BIN_DIR}/senginetest $(PREFIX)/usr/bin/pinot_search
 	@mkdir -p $(PREFIX)/usr/share/pinot/engines/
 	@mkdir -p $(PREFIX)/usr/share/pinot/tokenizers/
 	install -m 644 index.html $(PREFIX)/usr/share/pinot/

Modified: trunk/Search/SearchEngineFactory.cpp
===================================================================
--- trunk/Search/SearchEngineFactory.cpp	2006-02-07 12:18:54 UTC (rev 99)
+++ trunk/Search/SearchEngineFactory.cpp	2006-02-07 12:21:43 UTC (rev 100)
@@ -64,6 +64,22 @@
 	return myEngine;
 }
 
+void SearchEngineFactory::getSupportedEngines(set<string> &engines)
+{
+	engines.clear();
+
+	// List supported engines
+	engines.insert("sherlock");
+	engines.insert("opensearch");
+	engines.insert("xapian");
+#ifdef HAS_GOOGLEAPI
+	engines.insert("googleapi");
+#endif
+#ifdef HAS_OSAPI
+	engines.insert("objectssearchapi");
+#endif
+}
+
 /// Indicates whether a search engine is supported or not.
 bool SearchEngineFactory::isSupported(const string &type)
 {

Modified: trunk/Search/SearchEngineFactory.h
===================================================================
--- trunk/Search/SearchEngineFactory.h	2006-02-07 12:18:54 UTC (rev 99)
+++ trunk/Search/SearchEngineFactory.h	2006-02-07 12:21:43 UTC (rev 100)
@@ -35,6 +35,9 @@
 		/// Returns a SearchEngine of the specified type; NULL if unavailable.
 		static SearchEngineInterface *getSearchEngine(const string &type, const string &option);
 
+		/// Returns all supported engines.
+		static void getSupportedEngines(set<string> &engines);
+
 		/// Indicates whether a search engine is supported or not.
 		static bool isSupported(const string &type);
 

Modified: trunk/Search/senginetest.cpp
===================================================================
--- trunk/Search/senginetest.cpp	2006-02-07 12:18:54 UTC (rev 99)
+++ trunk/Search/senginetest.cpp	2006-02-07 12:21:43 UTC (rev 100)
@@ -21,96 +21,32 @@
 #include <fstream>
 
 #include "SearchEngineFactory.h"
-#ifdef HAS_GOOGLEAPI
-#include "GoogleAPIEngine.h"
-#endif
 #include "DownloaderFactory.h"
 #include "Url.h"
 #include "HtmlTokenizer.h"
 
 using namespace std;
 
-static void fetchCachedPage(const string &url, const string &file, const string &key)
-{
-#ifdef DEBUG
-	cout << "fetchCachedPage: attempting to save " << url << " to " << file << endl;
-#endif
-
-#ifdef HAS_GOOGLEAPI
-	Url thisUrl(url);
-	GoogleAPIEngine googleApiEngine;
-	googleApiEngine.setKey(key);
-
-	Document *urlDoc = googleApiEngine.retrieveCachedUrl(url);
-	if (urlDoc != NULL)
-	{
-		unsigned int urlContentLen;
-		ofstream outputFile;
-		outputFile.open(file.c_str(), ofstream::out | ofstream::trunc);
-		outputFile << urlDoc->getData(urlContentLen);
-		outputFile.close();
-
-		delete urlDoc;
-	}
-	else
-	{
-		cerr << "fetchCachedPage: couldn't get " << url << " !" << endl;
-	}
-#endif
-}
-
-static void fetchPage(const string &url, const string &file)
-{
-#ifdef DEBUG
-	cout << "fetchPage: attempting to save " << url << " to " << file << endl;
-#endif
-
-	// Any type of downloader will do...
-	Url thisUrl(url);
-	DownloaderInterface *myDownloader = DownloaderFactory::getDownloader(thisUrl.getProtocol(), "");
-	if (myDownloader == NULL)
-	{
-		cerr << "fetchPage: couldn't obtain downloader instance (" << thisUrl.getProtocol() << ")" << endl;
-		return;
-	}
-
-	DocumentInfo docInfo("Page", url, "", "");
-	Document *urlDoc = myDownloader->retrieveUrl(docInfo);
-	if (urlDoc != NULL)
-	{
-		unsigned int urlContentLen;
-		ofstream outputFile;
-		outputFile.open(file.c_str(), ofstream::out | ofstream::trunc);
-		outputFile << urlDoc->getData(urlContentLen);
-		outputFile.close();
-
-		delete urlDoc;
-	}
-	else
-	{
-		cerr << "fetchPage: couldn't get " << url << " !" << endl;
-	}
-
-	delete myDownloader;
-}
-
 int main(int argc, char **argv)
 {
 	string type, option;
-	bool bDownloadResults = false;
 
 	if (argc < 5)
 	{
-		cerr << "Usage: " << argv[0] << " <search engine name> <option> <search string> <max results> [DOWNLOAD]" << endl;
-		return EXIT_FAILURE;
-	}
-	if (argc > 5)
-	{
-		string flag = argv[5];
-		if (flag == "DOWNLOAD")
+		set<string> engines;
+
+		cerr << "Usage: " << argv[0] << " <search engine type> <name>|<key> <query string> <max results count>" << endl;
+		cerr << "Example: " << argv[0] << " sherlock /usr/share/pinot/engines/Bozo.src \"clowns\" 10" << endl;
+
+		SearchEngineFactory::getSupportedEngines(engines);
+		cerr << "Supported search engine types:";
+		for (set<string>::iterator engineIter = engines.begin(); engineIter != engines.end(); ++engineIter)
 		{
-			bDownloadResults = true;
+			cerr << " " << *engineIter;
 		}
+		cerr << endl;
+
+		return EXIT_FAILURE;
 	}
 
 	// Which SearchEngine ?
@@ -154,28 +90,6 @@
 				cout << count << " Title    : " << HtmlTokenizer::stripTags((*resultIter).getTitle()) << endl;
 				cout << count << " Extract  : " << HtmlTokenizer::stripTags((*resultIter).getExtract()) << endl;
 				cout << count << " Score    : " << (*resultIter).getScore() << endl;
-
-				if (bDownloadResults == true)
-				{
-					// Set the name of the file to which this page will be saved
-					char num[16];
-					sprintf(num, "%d", count);
-					string url = (*resultIter).getLocation();
-					string file = num;
-					file += "_";
-					file += thisUrl.getHost();
-					file += ".html";
-
-					if (type == "googleapi")
-					{
-						// Fetch the page from the Google cache
-						fetchCachedPage(url, file, option);
-					}
-					else
-					{
-						fetchPage(url, file);
-					}
-				}
 				count++;
 
 				// Next

Modified: trunk/pinot.spec
===================================================================
--- trunk/pinot.spec	2006-02-07 12:18:54 UTC (rev 99)
+++ trunk/pinot.spec	2006-02-07 12:21:43 UTC (rev 100)
@@ -77,6 +77,7 @@
 %defattr(-, root, root, -)
 %doc ChangeLog COPYING README TODO
 %{_bindir}/pinot
+%{_bindir}/pinot_search
 %{_datadir}/pinot/index.html
 %{_datadir}/pinot/xapian-powered.png
 %{_datadir}/pinot/metase-gtk2.glade



From fabricecolin at berlios.de  Sun Feb 12 08:06:20 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sun, 12 Feb 2006 08:06:20 +0100
Subject: [Pinot-svn] r101 - in trunk: . UI/GTK2/src UI/RenderHTML
Message-ID: <200602120706.k1C76KAG013986@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-12 08:05:53 +0100 (Sun, 12 Feb 2006)
New Revision: 101

Modified:
   trunk/UI/GTK2/src/Makefile
   trunk/UI/RenderHTML/Makefile
   trunk/variables.mk
Log:
Don't link all executables to the Mozilla libs !


Modified: trunk/UI/GTK2/src/Makefile
===================================================================
--- trunk/UI/GTK2/src/Makefile	2006-02-07 12:21:43 UTC (rev 100)
+++ trunk/UI/GTK2/src/Makefile	2006-02-12 07:05:53 UTC (rev 101)
@@ -4,7 +4,7 @@
 
 CXXFLAGS += -DHAVE_CONFIG_H -I. -I.. ${GTKMOZ_CXXFLAGS} ${GTKMM_CXXFLAGS}
 
-LIBS += ${GTKMOZ_LIBS} ${GTKMM_LIBS} -lgthread-2.0 -lfam
+LIBS += ${MOZILLA_XPCOM_LIBS} ${GTKMOZ_LIBS} ${GTKMM_LIBS} -lgthread-2.0 -lfam
 
 UI_GTK2_SRCS = importDialog.cc importDialog_glade.cc \
 	indexDialog.cc indexDialog_glade.cc \

Modified: trunk/UI/RenderHTML/Makefile
===================================================================
--- trunk/UI/RenderHTML/Makefile	2006-02-07 12:21:43 UTC (rev 100)
+++ trunk/UI/RenderHTML/Makefile	2006-02-12 07:05:53 UTC (rev 101)
@@ -4,7 +4,7 @@
 
 CXXFLAGS += -DHAVE_CONFIG_H -I. -I.. ${GTKMOZ_CXXFLAGS} 
 
-LIBS += ${GTKMOZ_LIBS}
+LIBS += ${MOZILLA_XPCOM_LIBS} ${GTKMOZ_LIBS}
 
 HTML_SRCS = MozillaRenderer.cpp
 HTML_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${HTML_SRCS})

Modified: trunk/variables.mk
===================================================================
--- trunk/variables.mk	2006-02-07 12:21:43 UTC (rev 100)
+++ trunk/variables.mk	2006-02-12 07:05:53 UTC (rev 101)
@@ -96,7 +96,7 @@
 CXXFLAGS += -g -DDEBUG
 endif
 LIBS := -lmagic -lpthread -lcrypt ${NEON_LIBS} ${OTS_LIBS} ${GMIME_LIBS} ${TEXTCAT_LIBS} \
-	${LIBXML_LIBS} ${XAPIAN_LIBS} ${SQLITE_LIBS} ${MOZILLA_XPCOM_LIBS}
+	${LIBXML_LIBS} ${XAPIAN_LIBS} ${SQLITE_LIBS}
 
 # Common targets
 



From fabricecolin at berlios.de  Sun Feb 12 08:13:21 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sun, 12 Feb 2006 08:13:21 +0100
Subject: [Pinot-svn] r102 - trunk
Message-ID: <200602120713.k1C7DLWN016478@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-12 08:13:11 +0100 (Sun, 12 Feb 2006)
New Revision: 102

Modified:
   trunk/ChangeLog
   trunk/Makefile
   trunk/README
   trunk/TODO
   trunk/index.html
Log:
Lots of minor updates.


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2006-02-12 07:05:53 UTC (rev 101)
+++ trunk/ChangeLog	2006-02-12 07:13:11 UTC (rev 102)
@@ -1,3 +1,17 @@
+??? version_0_4_5
+Build :
+ - dropped patch for libxml++ v0.26 support
+Search :
+ - include pinot_search to query search engines from the command-line
+ - better parsing of Sherlock plugins with foreign tags
+Index :
+ - URLs of results returned by Sherlock engines were incorrectly lower-cased
+ - Changed term prefixes to conform to conventions used by Omega and other
+  Xapian-based tools. Unfortunately, users will have to update documents and
+  reapply labels !
+UI :
+ - UTF-8 fixes on stored queries dates, results extracts and locale catalogs
+
 2006/01/31 version_0_4_2
 Search :
  - support for OpenSearch Description, Query and Response

Modified: trunk/Makefile
===================================================================
--- trunk/Makefile	2006-02-12 07:05:53 UTC (rev 101)
+++ trunk/Makefile	2006-02-12 07:13:11 UTC (rev 102)
@@ -10,7 +10,7 @@
 SOAP_PROJECTS += Search/ObjectsSearch
 endif
 PROJECTS := Utils Tokenize SQL Collect ${SOAP_PROJECTS} Search Index \
-	UI/RenderHTML UI/GTK2/src ${PLUGIN_PROJECTS}
+	UI/RenderHTML UI/GTK2/src
 TARGETS_ALL := $(patsubst %,%_all,${PROJECTS})
 TARGETS_CLEAN := $(patsubst %,%_clean,${PROJECTS})
 

Modified: trunk/README
===================================================================
--- trunk/README	2006-02-12 07:05:53 UTC (rev 101)
+++ trunk/README	2006-02-12 07:13:11 UTC (rev 102)
@@ -31,10 +31,10 @@
 
  GSOAP			$GSOAP_HOME			2.6.2
 
-gtkmm >= 2.4.12						gtkmm24-devel-2.6.2-2
+gtkmm							gtkmm24-devel-2.6.2-2
 http://www.gtkmm.org/
 
-libxml++ (3)						libxml++-devel-2.10.0-1
+libxml++ (3)						libxml++-devel-2.12.0-2.fc4
 http://libxmlplusplus.sourceforge.net/
 
  libxml2						libxml2-devel-2.6.16-3

Modified: trunk/TODO
===================================================================
--- trunk/TODO	2006-02-12 07:05:53 UTC (rev 101)
+++ trunk/TODO	2006-02-12 07:13:11 UTC (rev 102)
@@ -17,15 +17,11 @@
 - Allow to use "extended" INTERPRET tags selectively 
 - With engines that provide a redirection URL for results (eg Acoona), it looks like
   the query hitory is not saved/checked correctly
-- OR terms if AND search on index doesn't return anything
 - Add Creative Commons (http://search.yahoo.com/cc)
 - Add http://beta.exalead.com/search
 - Add csourcesearch.net
 - Add http://www.patentcommons.org/commons/patentsearch.php
 - Add http://www.podzinger.com/
-- Apply Pinot specific filters (eg "L" for language) on internal indices only
-- Assuming text is tokenized a la omindex, use Xapian's QueryParser, map fields
-  (label, language, title) to prefixes, etc...
 - Implement AutoDiscovery of OpenSearch Description files (http://opensearch.a9.com/spec/1.1/description/)
 
 Collect
@@ -64,7 +60,6 @@
 - Sort out issues with gtk_embed_moz if possible
 - Replace Mozilla GTK embed with GTK WebCore or latest gtkhtml, or drop altogether ?
 - Is it possible to build against Firefox instead of the Mozilla suite ?
-- Highlight search terms
 
 Mail
 - Find out what kind of locking scheme Mozilla uses (POSIX lock ?) and use that
@@ -101,5 +96,6 @@
 - Prefer ustring to string whenever possible
 - Closing when threads are running gives the impression Pinot has crashed; how do we tell the user
   we are waiting for something to finish ?
+- ViewHistory should have a Date field to allow expiration/cleanup
 - Try sizing the window optimally on the first startup
 

Modified: trunk/index.html
===================================================================
--- trunk/index.html	2006-02-12 07:05:53 UTC (rev 101)
+++ trunk/index.html	2006-02-12 07:13:11 UTC (rev 102)
@@ -14,8 +14,8 @@
 
 <tr>
 <td colspan="3" align="center">
-Visit the
-<a href="http://pinot.berlios.de/">web site</a> hosted by BerliOS.
+Visit the web site at
+<a href="http://pinot.berlios.de/">pinot.berlios.de</a>.
 </td>
 </tr>
 



From fabricecolin at berlios.de  Sun Feb 12 12:34:38 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sun, 12 Feb 2006 12:34:38 +0100
Subject: [Pinot-svn] r103 - in trunk: . Collect Index SQL Search Tokenize UI/GTK2/src UI/RenderHTML Utils
Message-ID: <200602121134.k1CBYcGN015222@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-12 12:34:36 +0100 (Sun, 12 Feb 2006)
New Revision: 103

Added:
   trunk/Collect/Makefile.am
   trunk/Index/Makefile.am
   trunk/Makefile.am
   trunk/SQL/Makefile.am
   trunk/Search/Makefile.am
   trunk/Tokenize/Makefile.am
   trunk/UI/GTK2/src/Makefile.am
   trunk/UI/RenderHTML/Makefile.am
   trunk/Utils/Makefile.am
   trunk/configure.in
Log:
Initial support for autotools.


Added: trunk/Collect/Makefile.am
===================================================================
--- trunk/Collect/Makefile.am	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/Collect/Makefile.am	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,22 @@
+# Process this file with automake to produce Makefile.in
+
+noinst_HEADERS = \
+	DownloaderFactory.h \
+	DownloaderInterface.h \
+	FileCollector.h \
+	MboxCollector.h \
+	NeonDownloader.h \
+	XapianCollector.h
+
+noinst_LTLIBRARIES = libCollect.la
+
+libCollect_la_SOURCES = \
+	DownloaderFactory.cpp \
+	DownloaderInterface.cpp \
+	FileCollector.cpp \
+	MboxCollector.cpp \
+	NeonDownloader.cpp \
+	XapianCollector.cpp
+
+AM_CXXFLAGS = -I../Utils -I../Tokenize @HTTP_CFLAGS@ @MIME_CFLAGS@
+

Added: trunk/Index/Makefile.am
===================================================================
--- trunk/Index/Makefile.am	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/Index/Makefile.am	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,16 @@
+# Process this file with automake to produce Makefile.in
+
+noinst_HEADERS = \
+	LanguageDetector.h \
+	Summarizer.h \
+	XapianIndex.h
+
+noinst_LTLIBRARIES = libIndex.la
+
+libIndex_la_SOURCES = \
+	LanguageDetector.cpp \
+	Summarizer.cpp \
+	XapianIndex.cpp
+
+AM_CXXFLAGS = -I../Utils -I../Tokenize @INDEX_CFLAGS@ 
+

Added: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/Makefile.am	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,9 @@
+# generated 2005/12/14 20:48:47 SGT by fabrice at amra.dyndns.org.(none)
+# using glademm V2.6.0
+
+SUBDIRS = po Utils Tokenize SQL Collect Search Index UI/RenderHTML UI/GTK2/src
+
+EXTRA_DIST = config.rpath mkinstalldirs m4/ChangeLog TODO README configure 
+
+ACLOCAL_AMFLAGS = -I m4
+

Added: trunk/SQL/Makefile.am
===================================================================
--- trunk/SQL/Makefile.am	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/SQL/Makefile.am	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,16 @@
+# Process this file with automake to produce Makefile.in
+
+noinst_HEADERS = \
+	QueryHistory.h \
+	SQLiteBase.h \
+	ViewHistory.h
+
+noinst_LTLIBRARIES = libSQL.la
+
+libSQL_la_SOURCES = \
+	QueryHistory.cpp \
+	SQLiteBase.cpp \
+	ViewHistory.cpp
+
+AM_CXXFLAGS = -I../Utils
+

Added: trunk/Search/Makefile.am
===================================================================
--- trunk/Search/Makefile.am	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/Search/Makefile.am	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,28 @@
+# Process this file with automake to produce Makefile.in
+
+noinst_HEADERS = \
+	OpenSearchParser.h \
+	QueryProperties.h \
+	SearchPluginProperties.h \
+	WebEngine.h \
+	SearchEngineFactory.h \
+	XapianEngine.h \
+	PluginWebEngine.h \
+	SearchEngineInterface.h \
+	SherlockParser.h
+
+noinst_LTLIBRARIES = libSearch.la
+
+libSearch_la_SOURCES = \
+	OpenSearchParser.cpp \
+	QueryProperties.cpp \
+	SearchPluginProperties.cpp \
+	WebEngine.cpp \
+	SearchEngineFactory.cpp \
+	XapianEngine.cpp \
+	PluginWebEngine.cpp \
+	SearchEngineInterface.cpp \
+	SherlockParser.cpp
+
+AM_CXXFLAGS = -I../Utils -I../Tokenize -I../Collect @XML_CFLAGS@
+

Added: trunk/Tokenize/Makefile.am
===================================================================
--- trunk/Tokenize/Makefile.am	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/Tokenize/Makefile.am	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,24 @@
+# Process this file with automake to produce Makefile.in
+
+noinst_HEADERS = \
+	HtmlTokenizer.h \
+	PdfTokenizer.h \
+	RtfTokenizer.h \
+	Tokenizer.h \
+	TokenizerFactory.h \
+	UnknownTypeTokenizer.h \
+	WordTokenizer.h
+
+noinst_LTLIBRARIES = libTokenize.la
+
+libTokenize_la_SOURCES = \
+	HtmlTokenizer.cpp \
+	PdfTokenizer.cpp \
+	RtfTokenizer.cpp \
+	Tokenizer.cpp \
+	TokenizerFactory.cpp \
+	UnknownTypeTokenizer.cpp \
+	WordTokenizer.cpp
+
+AM_CXXFLAGS = -I../Utils
+

Added: trunk/UI/GTK2/src/Makefile.am
===================================================================
--- trunk/UI/GTK2/src/Makefile.am	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/UI/GTK2/src/Makefile.am	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,64 @@
+# Process this file with automake to produce Makefile.in
+
+noinst_HEADERS = \
+	mainWindow_glade.hh \
+	mainWindow.hh \
+	prefsDialog_glade.hh \
+	prefsDialog.hh \
+	queryDialog_glade.hh \
+	queryDialog.hh \
+	importDialog_glade.hh \
+	importDialog.hh \
+	propertiesDialog_glade.hh \
+	propertiesDialog.hh \
+	indexDialog_glade.hh \
+	indexDialog.hh \
+	EnginesTree.h \
+	IndexPage.h \
+	ModelColumns.h \
+	Notebook.h \
+	PinotUtils.h \
+	WorkerThreads.h \
+	HtmlView.h \
+	IndexTree.h \
+	MonitorHandler.h \
+	PinotSettings.h \
+	ResultsTree.h
+
+pinot_SOURCES = \
+	pinot.cc \
+	mainWindow_glade.cc \
+	mainWindow.cc \
+	prefsDialog_glade.cc \
+	prefsDialog.cc \
+	queryDialog_glade.cc \
+	queryDialog.cc \
+	importDialog_glade.cc \
+	importDialog.cc \
+	propertiesDialog_glade.cc \
+	propertiesDialog.cc \
+	indexDialog_glade.cc \
+	indexDialog.cc \
+	EnginesTree.cpp \
+	IndexPage.cpp \
+	ModelColumns.cpp \
+	Notebook.cpp \
+	PinotUtils.cpp \
+	WorkerThreads.cpp \
+	HtmlView.cpp \
+	IndexTree.cpp \
+	MonitorHandler.cpp \
+	PinotSettings.cpp \
+	ResultsTree.cpp
+
+bin_PROGRAMS = pinot
+
+AM_CXXFLAGS = -I../../../Utils -I../../../Tokenize -I../../../SQL \
+	-I../../../Collect -I../../../Search -I../../../Index -I../../RenderHTML \
+	@SQL_CFLAGS@ @HTTP_CFLAGS@ @MIME_CFLAGS@ @XML_CFLAGS@ @INDEX_CFLAGS@ @UI_CFLAGS@
+
+pinot_LDADD = -L../../../Utils -L../../../Tokenize -L../../../SQL \
+        -L../../../Collect -L../../../Search -L../../../Index -L../../RenderHTML \
+	@LIBS@ @UI_LIBS@ @INDEX_LIBS@ @XML_LIBS@ @MIME_LIBS@ @HTTP_LIBS@ @SQL_LIBS@ \
+	-lHTML -lIndex -lSearch -lCollect -lSQL -lTokenize -lUtils
+

Added: trunk/UI/RenderHTML/Makefile.am
===================================================================
--- trunk/UI/RenderHTML/Makefile.am	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/UI/RenderHTML/Makefile.am	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,12 @@
+# Process this file with automake to produce Makefile.in
+
+noinst_HEADERS = \
+	MozillaRenderer.h
+
+noinst_LTLIBRARIES = libHTML.la
+
+libHTML_la_SOURCES = \
+	MozillaRenderer.cpp
+
+AM_CXXFLAGS = @UI_CFLAGS@
+

Added: trunk/Utils/Makefile.am
===================================================================
--- trunk/Utils/Makefile.am	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/Utils/Makefile.am	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,38 @@
+# Process this file with automake to produce Makefile.in
+
+noinst_HEADERS = \
+	Document.h \
+	HtmlDocument.h \
+	Languages.h \
+	MIMEScanner.h \
+	StringManip.h \
+	Timer.h \
+	XapianDatabase.h \
+	DocumentInfo.h \
+	IndexedDocument.h \
+	MboxParser.h \
+	Result.h \
+	TimeConverter.h \
+	Url.h \
+	XapianDatabaseFactory.h
+
+noinst_LTLIBRARIES = libUtils.la
+
+libUtils_la_SOURCES = \
+	Document.cpp \
+	HtmlDocument.cpp \
+	Languages.cpp \
+	MIMEScanner.cpp \
+	StringManip.cpp \
+	Timer.cpp \
+	XapianDatabase.cpp \
+	DocumentInfo.cpp \
+	IndexedDocument.cpp \
+	MboxParser.cpp \
+	Result.cpp \
+	TimeConverter.cpp \
+	Url.cpp \
+	XapianDatabaseFactory.cpp
+
+AM_CXXFLAGS = @INDEX_CFLAGS@ @MIME_CFLAGS@
+

Added: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-12 07:13:11 UTC (rev 102)
+++ trunk/configure.in	2006-02-12 11:34:36 UTC (rev 103)
@@ -0,0 +1,89 @@
+# generated 2005/12/14 20:48:47 SGT by fabrice at amra.dyndns.org.(none)
+# using glademm V2.6.0
+
+AC_PREREQ(2.50)
+AC_INIT(pinot, 0.45,[colinf at chez.com.(none)])
+AM_INIT_AUTOMAKE
+AC_CONFIG_HEADERS(config.h)
+
+AC_ISC_POSIX
+AC_PROG_CC
+AM_PROG_CC_STDC
+AC_HEADER_STDC
+AC_PROG_CPP
+AC_PROG_CXX
+AC_PROG_CXXCPP
+AM_PROG_LIBTOOL
+
+dnl *************************************************
+dnl gettext support
+dnl *************************************************
+
+GETTEXT_PACKAGE=pinot
+AC_SUBST(GETTEXT_PACKAGE)
+AC_DEFINE_UNQUOTED(GETTEXT_PACKAGE,"$GETTEXT_PACKAGE",
+		[the gettext domain])
+
+dnl Add the languages which your application supports here.
+ALL_LINGUAS="en_GB fr_FR es_ES"
+AM_GLIB_GNU_GETTEXT
+
+dnl Set PACKAGE_LOCALE_DIR in config.h.
+if test "x${prefix}" = "xNONE"; then
+  AC_DEFINE_UNQUOTED(PACKAGE_LOCALE_DIR, "${ac_default_prefix}/${DATADIRNAME}/locale",
+		[the location of locale files])
+else
+  AC_DEFINE_UNQUOTED(PACKAGE_LOCALE_DIR, "${prefix}/${DATADIRNAME}/locale",
+		[the location of locale files])
+fi
+
+AC_LANG_CPLUSPLUS
+
+dnl Xapian
+AC_PATH_PROG(XAPIAN_CONFIG, xapian-config, no)
+if test "$XAPIAN_CONFIG" = "no" ; then
+   AC_MSG_ERROR([Can't find xapian-config in $PATH.])
+   exit 1
+fi
+XAPIAN_CFLAGS=`$XAPIAN_CONFIG --cxxflags`
+XAPIAN_LIBS=`$XAPIAN_CONFIG --libs`
+
+dnl Other libraries
+PKG_CHECK_MODULES(SQL, sqlite3 >= 3.1 )
+AC_SUBST(SQL_CFLAGS)
+AC_SUBST(SQL_LIBS)
+PKG_CHECK_MODULES(HTTP, neon >= 0.24 )
+AC_SUBST(HTTP_CFLAGS)
+AC_SUBST(HTTP_LIBS)
+PKG_CHECK_MODULES(MIME, gmime-2.0 >= 2.0 )
+AC_SUBST(MIME_CFLAGS)
+AC_SUBST(MIME_LIBS)
+PKG_CHECK_MODULES(XML, libxml++-2.6 >= 2.12 )
+AC_SUBST(XML_CFLAGS)
+AC_SUBST(XML_LIBS)
+PKG_CHECK_MODULES(OTS, libots-1 >= 0.4.2 )
+INDEX_CFLAGS="$XAPIAN_CFLAGS $OTS_CFLAGS"
+INDEX_LIBS="$XAPIAN_LIBS $OTS_LIBS -ltextcat"
+AC_SUBST(INDEX_CFLAGS)
+AC_SUBST(INDEX_LIBS)
+PKG_CHECK_MODULES(UI, mozilla-xpcom >= 1.4 mozilla-nss >= 1.4 mozilla-gtkmozembed >= 1.4 gtkmm-2.4 >= 2.6 )
+dnl Location of Mozilla's library directory
+MOZILLA_GTKEMBED=`find /usr/lib*/mozilla* -name libgtkembedmoz.so | head -1`
+if [ -z "$MOZILLA_GTKEMBED" ]; then
+  MOZILLA_LIB_DIR=/usr/lib/mozilla
+else
+  MOZILLA_LIB_DIR=`dirname ${MOZILLA_GTKEMBED}`
+fi
+UI_LIBS="-lmagic -lpthread -lcrypt -lfam -L${MOZILLA_LIB_DIR} -Xlinker -rpath -Xlinker ${MOZILLA_LIB_DIR} $UI_LIBS"
+AC_SUBST(UI_CFLAGS)
+AC_SUBST(UI_LIBS)
+
+dnl Check for specific functions
+AC_CHECK_FUNCS(gettimeofday)
+AC_CHECK_FUNCS(lstat)
+AC_CHECK_FUNCS(mmap)
+
+AC_OUTPUT(Makefile pinot.spec Utils/Makefile Tokenize/Makefile SQL/Makefile
+	Collect/Makefile Search/Makefile Index/Makefile UI/RenderHTML/Makefile \
+	UI/GTK2/src/Makefile po/Makefile )
+



From fabricecolin at berlios.de  Sun Feb 12 13:22:59 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sun, 12 Feb 2006 13:22:59 +0100
Subject: [Pinot-svn] r104 - in trunk: . po
Message-ID: <200602121222.k1CCMxNO009806@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-12 13:22:56 +0100 (Sun, 12 Feb 2006)
New Revision: 104

Added:
   trunk/autogen.sh
   trunk/pinot.spec.in
   trunk/po/Makefile.in
   trunk/po/Makevars
   trunk/po/POTFILES.in
Modified:
   trunk/configure.in
   trunk/po/POTFILES
Log:
More autotools stuff.


Added: trunk/autogen.sh
===================================================================
--- trunk/autogen.sh	2006-02-12 11:34:36 UTC (rev 103)
+++ trunk/autogen.sh	2006-02-12 12:22:56 UTC (rev 104)
@@ -0,0 +1,61 @@
+#!/bin/sh
+# generated 2005/12/14 20:48:47 SGT by fabrice at amra.dyndns.org.(none)
+# using glademm V2.6.0
+
+if test ! -f install-sh ; then touch install-sh ; fi
+
+MAKE=`which gnumake`
+if test ! -x "$MAKE" ; then MAKE=`which gmake` ; fi
+if test ! -x "$MAKE" ; then MAKE=`which make` ; fi
+HAVE_GNU_MAKE=`$MAKE --version|grep -c "Free Software Foundation"`
+
+if test "$HAVE_GNU_MAKE" != "1"; then 
+echo Only non-GNU make found: $MAKE
+else
+echo `$MAKE --version | head -1` found
+fi
+
+if which autoconf2.50 >/dev/null 2>&1
+then AC_POSTFIX=2.50
+elif which autoconf >/dev/null 2>&1
+then AC_POSTFIX=""
+else 
+  echo 'you need autoconfig (2.58+ recommended) to generate the Makefile'
+  exit 1
+fi
+echo `autoconf$AC_POSTFIX --version | head -1` found
+
+if which automake-1.9 >/dev/null 2>&1
+then AM_POSTFIX=-1.9
+elif which automake-1.8 >/dev/null 2>&1
+then AM_POSTFIX=-1.8
+elif which automake-1.7 >/dev/null 2>&1
+then AM_POSTFIX=-1.7
+elif which automake-1.6 >/dev/null 2>&1
+then AM_POSTFIX=-1.6
+elif which automake >/dev/null 2>&1
+then AM_POSTFIX=""
+else
+  echo 'you need automake (1.8.3+ recommended) to generate the Makefile'
+  exit 1
+fi
+echo `automake$AM_POSTFIX --version | head -1` found
+
+echo This script runs configure and make...
+echo You did remember necessary arguments for configure, right?
+
+# autoreconf$AC_POSTFIX -fim _might_ do the trick, too.
+#  chose to your taste
+aclocal$AM_POSTFIX
+libtoolize --force --copy
+gettextize
+if test ! -e po/Makevars
+then cp po/Makevars.template po/Makevars
+fi
+if test ! -e po/LINGUAS
+then touch po/LINGUAS
+fi
+autoheader$AC_POSTFIX
+automake$AM_POSTFIX --add-missing --copy --gnu
+autoconf$AC_POSTFIX
+./configure $* && $MAKE


Property changes on: trunk/autogen.sh
___________________________________________________________________
Name: svn:executable
   + *

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-12 11:34:36 UTC (rev 103)
+++ trunk/configure.in	2006-02-12 12:22:56 UTC (rev 104)
@@ -2,7 +2,7 @@
 # using glademm V2.6.0
 
 AC_PREREQ(2.50)
-AC_INIT(pinot, 0.45,[colinf at chez.com.(none)])
+AC_INIT(pinot, 0.45,[colinf at chez.com])
 AM_INIT_AUTOMAKE
 AC_CONFIG_HEADERS(config.h)
 
@@ -26,6 +26,7 @@
 
 dnl Add the languages which your application supports here.
 ALL_LINGUAS="en_GB fr_FR es_ES"
+AM_GNU_GETTEXT([external]) 
 AM_GLIB_GNU_GETTEXT
 
 dnl Set PACKAGE_LOCALE_DIR in config.h.
@@ -83,7 +84,7 @@
 AC_CHECK_FUNCS(lstat)
 AC_CHECK_FUNCS(mmap)
 
-AC_OUTPUT(Makefile pinot.spec Utils/Makefile Tokenize/Makefile SQL/Makefile
-	Collect/Makefile Search/Makefile Index/Makefile UI/RenderHTML/Makefile \
-	UI/GTK2/src/Makefile po/Makefile )
+AC_OUTPUT(Makefile pinot.spec Utils/Makefile Tokenize/Makefile SQL/Makefile \
+	po/Makefile Collect/Makefile Search/Makefile Index/Makefile \
+	UI/RenderHTML/Makefile UI/GTK2/src/Makefile )
 

Added: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-02-12 11:34:36 UTC (rev 103)
+++ trunk/pinot.spec.in	2006-02-12 12:22:56 UTC (rev 104)
@@ -0,0 +1,122 @@
+# @configure_input@
+# We need an explicit dependency on mozilla as the so files don't have a version number 
+%define mozilla_ver %(/usr/bin/mozilla-config --version)
+
+Summary: Metasearch tool
+Name: @PACKAGE@
+Version: @VERSION@
+Release: 1
+License: GPL
+Group: Applications/Internet 
+Source: %{name}-%{version}.tar.gz
+URL: http://pinot.berlios.de/
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+Requires: xapian-core-libs >= 0.9.2, neon >= 0.24, gtkmm24 >= 2.6, libxml++ >= 2.12, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
+BuildRequires: xapian-core-devel >= 0.9.2, neon-devel >= 0.24, gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
+
+%description
+Pinot is a metasearch tool for the Free Desktop. It enables one to query
+sources, display as well as analyze and locally index the returned results.
+It may also be used as a lightweight personal space search tool.
+
+%package text-docs 
+Summary: Tokenizers for Pinot that handle various text document formats
+Group: Applications/Internet
+Requires: %{name} = %{version}
+Requires: pdftohtml, antiword, unrtf
+Obsoletes: pinot-pdf, pinot-word
+
+%description text-docs 
+The included tokenizers add support for PDF, MS Word and RTF documents.
+
+%package omega 
+Summary: Xapian Omega plugin for Pinot
+Group: Applications/Internet
+Requires: %{name} = %{version}
+Requires: xapian-omega
+
+%description omega
+The included plugin enables Pinot to use Xapian Omega as a search engine.
+
+%prep
+%setup -q
+
+%build
+make DEBUG=yes
+make DEBUG=yes pinot_mo
+
+%install
+[ -n "$RPM_BUILD_ROOT" -a "$RPM_BUILD_ROOT" != / ] && rm -rf $RPM_BUILD_ROOT
+make install PREFIX=$RPM_BUILD_ROOT
+# This engine is not usable as it is
+mv $RPM_BUILD_ROOT/%{_datadir}/pinot/engines/AmazonAPI.src $RPM_BUILD_ROOT/%{_datadir}/pinot/
+# Desktop file
+cat >%{name}.desktop << EOF
+[Desktop Entry]
+Name=Pinot Metasearch Tool
+Comment=Search the Web and your documents
+Exec=%{_bindir}/pinot
+StartupNotify=true
+Icon=pinot.png
+Terminal=false
+Type=Application
+Categories=Application;Network;
+Encoding=UTF-8
+EOF
+mkdir -p $RPM_BUILD_ROOT/%{_datadir}/applications
+desktop-file-install --vendor Amra \
+	--dir $RPM_BUILD_ROOT/%{_datadir}/applications  \
+	%{name}.desktop
+
+%post
+gtk-update-icon-cache -q -f %{_datadir}/icons/hicolor || :
+
+%clean
+[ -n "$RPM_BUILD_ROOT" -a "$RPM_BUILD_ROOT" != / ] && rm -rf $RPM_BUILD_ROOT
+
+%files
+%defattr(-, root, root, -)
+%doc ChangeLog COPYING README TODO
+%{_bindir}/pinot
+%{_bindir}/pinot_search
+%{_datadir}/pinot/index.html
+%{_datadir}/pinot/xapian-powered.png
+%{_datadir}/pinot/metase-gtk2.glade
+%{_datadir}/pinot/metase-gtk2.gladep
+%{_datadir}/pinot/textcat_conf.txt
+%{_datadir}/pinot/*.src
+%dir %{_datadir}/pinot/engines/
+%config(noreplace) %{_datadir}/pinot/engines/A9.src
+%config(noreplace) %{_datadir}/pinot/engines/Acoona.src
+%config(noreplace) %{_datadir}/pinot/engines/Altavista.src
+%config(noreplace) %{_datadir}/pinot/engines/AskJeeves.src
+%config(noreplace) %{_datadir}/pinot/engines/BitTorrent.src
+%config(noreplace) %{_datadir}/pinot/engines/Clusty.src
+%config(noreplace) %{_datadir}/pinot/engines/Freshmeat.src
+%config(noreplace) %{_datadir}/pinot/engines/Google.src
+%config(noreplace) %{_datadir}/pinot/engines/Lycos.src
+%config(noreplace) %{_datadir}/pinot/engines/MSN.src
+%config(noreplace) %{_datadir}/pinot/engines/Teoma.src
+%config(noreplace) %{_datadir}/pinot/engines/Topix.src
+%config(noreplace) %{_datadir}/pinot/engines/WiseNut.src
+%config(noreplace) %{_datadir}/pinot/engines/Yahoo.src
+%config(noreplace) %{_datadir}/pinot/engines/YahooAPI.src
+%config(noreplace) %{_datadir}/pinot/engines/Wikipedia.src
+%config(noreplace) %{_datadir}/pinot/engines/KodersDescription.xml
+%config(noreplace) %{_datadir}/pinot/engines/MozDexDescription.xml
+%{_datadir}/locale/fr/LC_MESSAGES/pinot.mo
+%{_datadir}/locale/es/LC_MESSAGES/pinot.mo
+%{_datadir}/icons/hicolor/48x48/apps/pinot.png
+%{_datadir}/applications/Amra-%{name}.desktop
+
+%files text-docs 
+%defattr(-, root, root, -)
+%dir %{_datadir}/pinot/tokenizers/pdf_tokenizer.so
+%dir %{_datadir}/pinot/tokenizers/word_tokenizer.so
+%dir %{_datadir}/pinot/tokenizers/rtf_tokenizer.so
+
+%files omega
+%defattr(-, root, root, -)
+%config(noreplace) %{_datadir}/pinot/engines/OmegaDescription.xml
+
+%changelog

Added: trunk/po/Makefile.in
===================================================================
--- trunk/po/Makefile.in	2006-02-12 11:34:36 UTC (rev 103)
+++ trunk/po/Makefile.in	2006-02-12 12:22:56 UTC (rev 104)
@@ -0,0 +1,384 @@
+# Makefile for PO directory in any package using GNU gettext.
+# Copyright (C) 1995-1997, 2000-2005 by Ulrich Drepper <drepper at gnu.ai.mit.edu>
+#
+# This file can be copied and used freely without restrictions.  It can
+# be used in projects which are not available under the GNU General Public
+# License but which still want to provide support for the GNU gettext
+# functionality.
+# Please note that the actual code of GNU gettext is covered by the GNU
+# General Public License and is *not* in the public domain.
+#
+# Origin: gettext-0.14.3
+
+PACKAGE = @PACKAGE@
+VERSION = @VERSION@
+PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
+
+SHELL = /bin/sh
+ at SET_MAKE@
+
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+VPATH = @srcdir@
+
+prefix = @prefix@
+exec_prefix = @exec_prefix@
+datadir = @datadir@
+localedir = $(datadir)/locale
+gettextsrcdir = $(datadir)/gettext/po
+
+INSTALL = @INSTALL@
+INSTALL_DATA = @INSTALL_DATA@
+MKINSTALLDIRS = @MKINSTALLDIRS@
+mkinstalldirs = $(SHELL) $(MKINSTALLDIRS)
+
+GMSGFMT = @GMSGFMT@
+MSGFMT = @MSGFMT@
+XGETTEXT = @XGETTEXT@
+MSGMERGE = msgmerge
+MSGMERGE_UPDATE = @MSGMERGE@ --update
+MSGINIT = msginit
+MSGCONV = msgconv
+MSGFILTER = msgfilter
+
+POFILES = @POFILES@
+GMOFILES = @GMOFILES@
+UPDATEPOFILES = @UPDATEPOFILES@
+DUMMYPOFILES = @DUMMYPOFILES@
+DISTFILES.common = Makefile.in.in remove-potcdate.sin \
+$(DISTFILES.common.extra1) $(DISTFILES.common.extra2) $(DISTFILES.common.extra3)
+DISTFILES = $(DISTFILES.common) Makevars POTFILES.in \
+$(POFILES) $(GMOFILES) \
+$(DISTFILES.extra1) $(DISTFILES.extra2) $(DISTFILES.extra3)
+
+POTFILES = \
+
+CATALOGS = @CATALOGS@
+
+# Makevars gets inserted here. (Don't remove this line!)
+
+.SUFFIXES:
+.SUFFIXES: .po .gmo .mo .sed .sin .nop .po-create .po-update
+
+.po.mo:
+	@echo "$(MSGFMT) -c -o $@ $<"; \
+	$(MSGFMT) -c -o t-$@ $< && mv t-$@ $@
+
+.po.gmo:
+	@lang=`echo $* | sed -e 's,.*/,,'`; \
+	test "$(srcdir)" = . && cdcmd="" || cdcmd="cd $(srcdir) && "; \
+	echo "$${cdcmd}rm -f $${lang}.gmo && $(GMSGFMT) -c --statistics -o $${lang}.gmo $${lang}.po"; \
+	cd $(srcdir) && rm -f $${lang}.gmo && $(GMSGFMT) -c --statistics -o t-$${lang}.gmo $${lang}.po && mv t-$${lang}.gmo $${lang}.gmo
+
+.sin.sed:
+	sed -e '/^#/d' $< > t-$@
+	mv t-$@ $@
+
+
+all: all- at USE_NLS@
+
+all-yes: stamp-po
+all-no:
+
+# $(srcdir)/$(DOMAIN).pot is only created when needed. When xgettext finds no
+# internationalized messages, no $(srcdir)/$(DOMAIN).pot is created (because
+# we don't want to bother translators with empty POT files). We assume that
+# LINGUAS is empty in this case, i.e. $(POFILES) and $(GMOFILES) are empty.
+# In this case, stamp-po is a nop (i.e. a phony target).
+
+# stamp-po is a timestamp denoting the last time at which the CATALOGS have
+# been loosely updated. Its purpose is that when a developer or translator
+# checks out the package via CVS, and the $(DOMAIN).pot file is not in CVS,
+# "make" will update the $(DOMAIN).pot and the $(CATALOGS), but subsequent
+# invocations of "make" will do nothing. This timestamp would not be necessary
+# if updating the $(CATALOGS) would always touch them; however, the rule for
+# $(POFILES) has been designed to not touch files that don't need to be
+# changed.
+stamp-po: $(srcdir)/$(DOMAIN).pot
+	test ! -f $(srcdir)/$(DOMAIN).pot || \
+	  test -z "$(GMOFILES)" || $(MAKE) $(GMOFILES)
+	@test ! -f $(srcdir)/$(DOMAIN).pot || { \
+	  echo "touch stamp-po" && \
+	  echo timestamp > stamp-poT && \
+	  mv stamp-poT stamp-po; \
+	}
+
+# Note: Target 'all' must not depend on target '$(DOMAIN).pot-update',
+# otherwise packages like GCC can not be built if only parts of the source
+# have been downloaded.
+
+# This target rebuilds $(DOMAIN).pot; it is an expensive operation.
+# Note that $(DOMAIN).pot is not touched if it doesn't need to be changed.
+$(DOMAIN).pot-update: $(POTFILES) $(srcdir)/POTFILES.in remove-potcdate.sed
+	if test -n '$(MSGID_BUGS_ADDRESS)' || test '$(PACKAGE_BUGREPORT)' = '@'PACKAGE_BUGREPORT'@'; then \
+	  msgid_bugs_address='$(MSGID_BUGS_ADDRESS)'; \
+	else \
+	  msgid_bugs_address='$(PACKAGE_BUGREPORT)'; \
+	fi; \
+	$(XGETTEXT) --default-domain=$(DOMAIN) --directory=$(top_srcdir) \
+	  --add-comments=TRANSLATORS: $(XGETTEXT_OPTIONS) \
+	  --files-from=$(srcdir)/POTFILES.in \
+	  --copyright-holder='$(COPYRIGHT_HOLDER)' \
+	  --msgid-bugs-address="$$msgid_bugs_address"
+	test ! -f $(DOMAIN).po || { \
+	  if test -f $(srcdir)/$(DOMAIN).pot; then \
+	    sed -f remove-potcdate.sed < $(srcdir)/$(DOMAIN).pot > $(DOMAIN).1po && \
+	    sed -f remove-potcdate.sed < $(DOMAIN).po > $(DOMAIN).2po && \
+	    if cmp $(DOMAIN).1po $(DOMAIN).2po >/dev/null 2>&1; then \
+	      rm -f $(DOMAIN).1po $(DOMAIN).2po $(DOMAIN).po; \
+	    else \
+	      rm -f $(DOMAIN).1po $(DOMAIN).2po $(srcdir)/$(DOMAIN).pot && \
+	      mv $(DOMAIN).po $(srcdir)/$(DOMAIN).pot; \
+	    fi; \
+	  else \
+	    mv $(DOMAIN).po $(srcdir)/$(DOMAIN).pot; \
+	  fi; \
+	}
+
+# This rule has no dependencies: we don't need to update $(DOMAIN).pot at
+# every "make" invocation, only create it when it is missing.
+# Only "make $(DOMAIN).pot-update" or "make dist" will force an update.
+$(srcdir)/$(DOMAIN).pot:
+	$(MAKE) $(DOMAIN).pot-update
+
+# This target rebuilds a PO file if $(DOMAIN).pot has changed.
+# Note that a PO file is not touched if it doesn't need to be changed.
+$(POFILES): $(srcdir)/$(DOMAIN).pot
+	@lang=`echo $@ | sed -e 's,.*/,,' -e 's/\.po$$//'`; \
+	if test -f "$(srcdir)/$${lang}.po"; then \
+	  test "$(srcdir)" = . && cdcmd="" || cdcmd="cd $(srcdir) && "; \
+	  echo "$${cdcmd}$(MSGMERGE_UPDATE) $${lang}.po $(DOMAIN).pot"; \
+	  cd $(srcdir) && $(MSGMERGE_UPDATE) $${lang}.po $(DOMAIN).pot; \
+	else \
+	  $(MAKE) $${lang}.po-create; \
+	fi
+
+
+install: install-exec install-data
+install-exec:
+install-data: install-data- at USE_NLS@
+	if test "$(PACKAGE)" = "gettext-tools"; then \
+	  $(mkinstalldirs) $(DESTDIR)$(gettextsrcdir); \
+	  for file in $(DISTFILES.common) Makevars.template; do \
+	    $(INSTALL_DATA) $(srcdir)/$$file \
+			    $(DESTDIR)$(gettextsrcdir)/$$file; \
+	  done; \
+	  for file in Makevars; do \
+	    rm -f $(DESTDIR)$(gettextsrcdir)/$$file; \
+	  done; \
+	else \
+	  : ; \
+	fi
+install-data-no: all
+install-data-yes: all
+	$(mkinstalldirs) $(DESTDIR)$(datadir)
+	@catalogs='$(CATALOGS)'; \
+	for cat in $$catalogs; do \
+	  cat=`basename $$cat`; \
+	  lang=`echo $$cat | sed -e 's/\.gmo$$//'`; \
+	  dir=$(localedir)/$$lang/LC_MESSAGES; \
+	  $(mkinstalldirs) $(DESTDIR)$$dir; \
+	  if test -r $$cat; then realcat=$$cat; else realcat=$(srcdir)/$$cat; fi; \
+	  $(INSTALL_DATA) $$realcat $(DESTDIR)$$dir/$(DOMAIN).mo; \
+	  echo "installing $$realcat as $(DESTDIR)$$dir/$(DOMAIN).mo"; \
+	  for lc in '' $(EXTRA_LOCALE_CATEGORIES); do \
+	    if test -n "$$lc"; then \
+	      if (cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc 2>/dev/null) | grep ' -> ' >/dev/null; then \
+	        link=`cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc | sed -e 's/^.* -> //'`; \
+	        mv $(DESTDIR)$(localedir)/$$lang/$$lc $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
+	        mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
+	        (cd $(DESTDIR)$(localedir)/$$lang/$$lc.old && \
+	         for file in *; do \
+	           if test -f $$file; then \
+	             ln -s ../$$link/$$file $(DESTDIR)$(localedir)/$$lang/$$lc/$$file; \
+	           fi; \
+	         done); \
+	        rm -f $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
+	      else \
+	        if test -d $(DESTDIR)$(localedir)/$$lang/$$lc; then \
+	          :; \
+	        else \
+	          rm -f $(DESTDIR)$(localedir)/$$lang/$$lc; \
+	          mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
+	        fi; \
+	      fi; \
+	      rm -f $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo; \
+	      ln -s ../LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo 2>/dev/null || \
+	      ln $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo 2>/dev/null || \
+	      cp -p $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo; \
+	      echo "installing $$realcat link as $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo"; \
+	    fi; \
+	  done; \
+	done
+
+install-strip: install
+
+installdirs: installdirs-exec installdirs-data
+installdirs-exec:
+installdirs-data: installdirs-data- at USE_NLS@
+	if test "$(PACKAGE)" = "gettext-tools"; then \
+	  $(mkinstalldirs) $(DESTDIR)$(gettextsrcdir); \
+	else \
+	  : ; \
+	fi
+installdirs-data-no:
+installdirs-data-yes:
+	$(mkinstalldirs) $(DESTDIR)$(datadir)
+	@catalogs='$(CATALOGS)'; \
+	for cat in $$catalogs; do \
+	  cat=`basename $$cat`; \
+	  lang=`echo $$cat | sed -e 's/\.gmo$$//'`; \
+	  dir=$(localedir)/$$lang/LC_MESSAGES; \
+	  $(mkinstalldirs) $(DESTDIR)$$dir; \
+	  for lc in '' $(EXTRA_LOCALE_CATEGORIES); do \
+	    if test -n "$$lc"; then \
+	      if (cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc 2>/dev/null) | grep ' -> ' >/dev/null; then \
+	        link=`cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc | sed -e 's/^.* -> //'`; \
+	        mv $(DESTDIR)$(localedir)/$$lang/$$lc $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
+	        mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
+	        (cd $(DESTDIR)$(localedir)/$$lang/$$lc.old && \
+	         for file in *; do \
+	           if test -f $$file; then \
+	             ln -s ../$$link/$$file $(DESTDIR)$(localedir)/$$lang/$$lc/$$file; \
+	           fi; \
+	         done); \
+	        rm -f $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
+	      else \
+	        if test -d $(DESTDIR)$(localedir)/$$lang/$$lc; then \
+	          :; \
+	        else \
+	          rm -f $(DESTDIR)$(localedir)/$$lang/$$lc; \
+	          mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
+	        fi; \
+	      fi; \
+	    fi; \
+	  done; \
+	done
+
+# Define this as empty until I found a useful application.
+installcheck:
+
+uninstall: uninstall-exec uninstall-data
+uninstall-exec:
+uninstall-data: uninstall-data- at USE_NLS@
+	if test "$(PACKAGE)" = "gettext-tools"; then \
+	  for file in $(DISTFILES.common) Makevars.template; do \
+	    rm -f $(DESTDIR)$(gettextsrcdir)/$$file; \
+	  done; \
+	else \
+	  : ; \
+	fi
+uninstall-data-no:
+uninstall-data-yes:
+	catalogs='$(CATALOGS)'; \
+	for cat in $$catalogs; do \
+	  cat=`basename $$cat`; \
+	  lang=`echo $$cat | sed -e 's/\.gmo$$//'`; \
+	  for lc in LC_MESSAGES $(EXTRA_LOCALE_CATEGORIES); do \
+	    rm -f $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo; \
+	  done; \
+	done
+
+check: all
+
+info dvi ps pdf html tags TAGS ctags CTAGS ID:
+
+mostlyclean:
+	rm -f remove-potcdate.sed
+	rm -f stamp-poT
+	rm -f core core.* $(DOMAIN).po $(DOMAIN).1po $(DOMAIN).2po *.new.po
+	rm -fr *.o
+
+clean: mostlyclean
+
+distclean: clean
+	rm -f Makefile Makefile.in POTFILES *.mo
+
+maintainer-clean: distclean
+	@echo "This command is intended for maintainers to use;"
+	@echo "it deletes files that may require special tools to rebuild."
+	rm -f stamp-po $(GMOFILES)
+
+distdir = $(top_builddir)/$(PACKAGE)-$(VERSION)/$(subdir)
+dist distdir:
+	$(MAKE) update-po
+	@$(MAKE) dist2
+# This is a separate target because 'update-po' must be executed before.
+dist2: stamp-po $(DISTFILES)
+	dists="$(DISTFILES)"; \
+	if test "$(PACKAGE)" = "gettext-tools"; then \
+	  dists="$$dists Makevars.template"; \
+	fi; \
+	if test -f $(srcdir)/$(DOMAIN).pot; then \
+	  dists="$$dists $(DOMAIN).pot stamp-po"; \
+	fi; \
+	if test -f $(srcdir)/ChangeLog; then \
+	  dists="$$dists ChangeLog"; \
+	fi; \
+	for i in 0 1 2 3 4 5 6 7 8 9; do \
+	  if test -f $(srcdir)/ChangeLog.$$i; then \
+	    dists="$$dists ChangeLog.$$i"; \
+	  fi; \
+	done; \
+	if test -f $(srcdir)/LINGUAS; then dists="$$dists LINGUAS"; fi; \
+	for file in $$dists; do \
+	  if test -f $$file; then \
+	    cp -p $$file $(distdir) || exit 1; \
+	  else \
+	    cp -p $(srcdir)/$$file $(distdir) || exit 1; \
+	  fi; \
+	done
+
+update-po: Makefile
+	$(MAKE) $(DOMAIN).pot-update
+	test -z "$(UPDATEPOFILES)" || $(MAKE) $(UPDATEPOFILES)
+	$(MAKE) update-gmo
+
+# General rule for creating PO files.
+
+.nop.po-create:
+	@lang=`echo $@ | sed -e 's/\.po-create$$//'`; \
+	echo "File $$lang.po does not exist. If you are a translator, you can create it through 'msginit'." 1>&2; \
+	exit 1
+
+# General rule for updating PO files.
+
+.nop.po-update:
+	@lang=`echo $@ | sed -e 's/\.po-update$$//'`; \
+	if test "$(PACKAGE)" = "gettext-tools"; then PATH=`pwd`/../src:$$PATH; fi; \
+	tmpdir=`pwd`; \
+	echo "$$lang:"; \
+	test "$(srcdir)" = . && cdcmd="" || cdcmd="cd $(srcdir) && "; \
+	echo "$${cdcmd}$(MSGMERGE) $$lang.po $(DOMAIN).pot -o $$lang.new.po"; \
+	cd $(srcdir); \
+	if $(MSGMERGE) $$lang.po $(DOMAIN).pot -o $$tmpdir/$$lang.new.po; then \
+	  if cmp $$lang.po $$tmpdir/$$lang.new.po >/dev/null 2>&1; then \
+	    rm -f $$tmpdir/$$lang.new.po; \
+	  else \
+	    if mv -f $$tmpdir/$$lang.new.po $$lang.po; then \
+	      :; \
+	    else \
+	      echo "msgmerge for $$lang.po failed: cannot move $$tmpdir/$$lang.new.po to $$lang.po" 1>&2; \
+	      exit 1; \
+	    fi; \
+	  fi; \
+	else \
+	  echo "msgmerge for $$lang.po failed!" 1>&2; \
+	  rm -f $$tmpdir/$$lang.new.po; \
+	fi
+
+$(DUMMYPOFILES):
+
+update-gmo: Makefile $(GMOFILES)
+	@:
+
+Makefile: Makefile.in.in Makevars ../config.status POTFILES.in
+	cd $(top_builddir) \
+	  && CONFIG_FILES=$(subdir)/$@.in CONFIG_HEADERS= \
+	       $(SHELL) ./config.status
+
+force:
+
+# Tell versions [3.59,3.63) of GNU make not to export all variables.
+# Otherwise a system limit (for SysV at least) may be exceeded.
+.NOEXPORT:

Added: trunk/po/Makevars
===================================================================
--- trunk/po/Makevars	2006-02-12 11:34:36 UTC (rev 103)
+++ trunk/po/Makevars	2006-02-12 12:22:56 UTC (rev 104)
@@ -0,0 +1,41 @@
+# Makefile variables for PO directory in any package using GNU gettext.
+
+# Usually the message domain is the same as the package name.
+DOMAIN = $(PACKAGE)
+
+# These two variables depend on the location of this directory.
+subdir = po
+top_builddir = ..
+
+# These options get passed to xgettext.
+XGETTEXT_OPTIONS = --keyword=_ --keyword=N_
+
+# This is the copyright holder that gets inserted into the header of the
+# $(DOMAIN).pot file.  Set this to the copyright holder of the surrounding
+# package.  (Note that the msgstr strings, extracted from the package's
+# sources, belong to the copyright holder of the package.)  Translators are
+# expected to transfer the copyright for their translations to this person
+# or entity, or to disclaim their copyright.  The empty string stands for
+# the public domain; in this case the translators are expected to disclaim
+# their copyright.
+COPYRIGHT_HOLDER = Fabrice Colin
+
+# This is the email address or URL to which the translators shall report
+# bugs in the untranslated strings:
+# - Strings which are not entire sentences, see the maintainer guidelines
+#   in the GNU gettext documentation, section 'Preparing Strings'.
+# - Strings which use unclear terms or require additional context to be
+#   understood.
+# - Strings which make invalid assumptions about notation of date, time or
+#   money.
+# - Pluralisation problems.
+# - Incorrect English spelling.
+# - Incorrect formatting.
+# It can be your email address, or a mailing list address where translators
+# can write to without being subscribed, or the URL of a web page through
+# which the translators can contact you.
+MSGID_BUGS_ADDRESS =
+
+# This is the list of locale categories, beyond LC_MESSAGES, for which the
+# message catalogs shall be used.  It is usually empty.
+EXTRA_LOCALE_CATEGORIES =

Modified: trunk/po/POTFILES
===================================================================
--- trunk/po/POTFILES	2006-02-12 11:34:36 UTC (rev 103)
+++ trunk/po/POTFILES	2006-02-12 12:22:56 UTC (rev 104)
@@ -1,24 +0,0 @@
-UI/GTK2/src/EnginesTree.cpp
-UI/GTK2/src/HtmlView.cpp
-UI/GTK2/src/importDialog.cc
-UI/GTK2/src/importDialog_glade.cc
-UI/GTK2/src/indexDialog.cc
-UI/GTK2/src/indexDialog_glade.cc
-UI/GTK2/src/IndexTree.cpp
-UI/GTK2/src/IndexPage.cpp
-UI/GTK2/src/mainWindow.cc
-UI/GTK2/src/mainWindow_glade.cc
-UI/GTK2/src/ModelColumns.cpp
-UI/GTK2/src/MonitorHandler.cpp
-UI/GTK2/src/Notebook.cpp
-UI/GTK2/src/pinot.cc
-UI/GTK2/src/PinotSettings.cpp
-UI/GTK2/src/PinotUtils.cpp
-UI/GTK2/src/prefsDialog.cc
-UI/GTK2/src/prefsDialog_glade.cc
-UI/GTK2/src/propertiesDialog.cc
-UI/GTK2/src/propertiesDialog_glade.cc
-UI/GTK2/src/queryDialog.cc
-UI/GTK2/src/queryDialog_glade.cc
-UI/GTK2/src/ResultsTree.cpp
-UI/GTK2/src/WorkerThreads.cpp

Added: trunk/po/POTFILES.in
===================================================================
--- trunk/po/POTFILES.in	2006-02-12 11:34:36 UTC (rev 103)
+++ trunk/po/POTFILES.in	2006-02-12 12:22:56 UTC (rev 104)
@@ -0,0 +1,25 @@
+# List of source files containing translatable strings.
+UI/GTK2/src/EnginesTree.cpp
+UI/GTK2/src/HtmlView.cpp
+UI/GTK2/src/importDialog.cc
+UI/GTK2/src/importDialog_glade.cc
+UI/GTK2/src/indexDialog.cc
+UI/GTK2/src/indexDialog_glade.cc
+UI/GTK2/src/IndexTree.cpp
+UI/GTK2/src/IndexPage.cpp
+UI/GTK2/src/mainWindow.cc
+UI/GTK2/src/mainWindow_glade.cc
+UI/GTK2/src/ModelColumns.cpp
+UI/GTK2/src/MonitorHandler.cpp
+UI/GTK2/src/Notebook.cpp
+UI/GTK2/src/pinot.cc
+UI/GTK2/src/PinotSettings.cpp
+UI/GTK2/src/PinotUtils.cpp
+UI/GTK2/src/prefsDialog.cc
+UI/GTK2/src/prefsDialog_glade.cc
+UI/GTK2/src/propertiesDialog.cc
+UI/GTK2/src/propertiesDialog_glade.cc
+UI/GTK2/src/queryDialog.cc
+UI/GTK2/src/queryDialog_glade.cc
+UI/GTK2/src/ResultsTree.cpp
+UI/GTK2/src/WorkerThreads.cpp



From fabricecolin at berlios.de  Sun Feb 12 13:34:43 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sun, 12 Feb 2006 13:34:43 +0100
Subject: [Pinot-svn] r105 - trunk
Message-ID: <200602121234.k1CCYhqX015005@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-12 13:34:41 +0100 (Sun, 12 Feb 2006)
New Revision: 105

Added:
   trunk/AUTHORS
   trunk/NEWS
Modified:
   trunk/configure.in
Log:
More autotools stuff.


Added: trunk/AUTHORS
===================================================================
--- trunk/AUTHORS	2006-02-12 12:22:56 UTC (rev 104)
+++ trunk/AUTHORS	2006-02-12 12:34:41 UTC (rev 105)
@@ -0,0 +1,8 @@
+Pinot is written by :
+
+	Fabrice Colin <colinf at chez dot com>
+
+Translations provided by :
+
+	Spanish - Jes?s Tramullas <jesus at tramullas dot com>
+

Added: trunk/NEWS
===================================================================

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-12 12:22:56 UTC (rev 104)
+++ trunk/configure.in	2006-02-12 12:34:41 UTC (rev 105)
@@ -84,7 +84,7 @@
 AC_CHECK_FUNCS(lstat)
 AC_CHECK_FUNCS(mmap)
 
-AC_OUTPUT(Makefile pinot.spec Utils/Makefile Tokenize/Makefile SQL/Makefile \
+AC_OUTPUT( pinot.spec ./Makefile Utils/Makefile Tokenize/Makefile SQL/Makefile \
 	po/Makefile Collect/Makefile Search/Makefile Index/Makefile \
 	UI/RenderHTML/Makefile UI/GTK2/src/Makefile )
 



From fabricecolin at berlios.de  Sun Feb 12 13:44:59 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sun, 12 Feb 2006 13:44:59 +0100
Subject: [Pinot-svn] r106 - in trunk: . Utils
Message-ID: <200602121244.k1CCixUP018417@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-12 13:44:57 +0100 (Sun, 12 Feb 2006)
New Revision: 106

Modified:
   trunk/Utils/XapianDatabase.h
   trunk/configure.in
Log:
Build fixes.


Modified: trunk/Utils/XapianDatabase.h
===================================================================
--- trunk/Utils/XapianDatabase.h	2006-02-12 12:34:41 UTC (rev 105)
+++ trunk/Utils/XapianDatabase.h	2006-02-12 12:44:57 UTC (rev 106)
@@ -23,9 +23,6 @@
 
 #include <xapian.h>
 
-#include "DocumentInfo.h"
-#include "IndexInterface.h"
-
 class XapianDatabase
 {
 	public:

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-12 12:34:41 UTC (rev 105)
+++ trunk/configure.in	2006-02-12 12:44:57 UTC (rev 106)
@@ -70,7 +70,7 @@
 PKG_CHECK_MODULES(UI, mozilla-xpcom >= 1.4 mozilla-nss >= 1.4 mozilla-gtkmozembed >= 1.4 gtkmm-2.4 >= 2.6 )
 dnl Location of Mozilla's library directory
 MOZILLA_GTKEMBED=`find /usr/lib*/mozilla* -name libgtkembedmoz.so | head -1`
-if [ -z "$MOZILLA_GTKEMBED" ]; then
+if test "$MOZILLA_GTKEMBED" = "" ; then
   MOZILLA_LIB_DIR=/usr/lib/mozilla
 else
   MOZILLA_LIB_DIR=`dirname ${MOZILLA_GTKEMBED}`



From fabricecolin at berlios.de  Sun Feb 12 14:15:59 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sun, 12 Feb 2006 14:15:59 +0100
Subject: [Pinot-svn] r107 - in trunk: . Collect Index SQL Search Search/Google Search/ObjectsSearch Tokenize UI/GTK2/src UI/RenderHTML Utils po
Message-ID: <200602121315.k1CDFx7P027949@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-12 14:15:56 +0100 (Sun, 12 Feb 2006)
New Revision: 107

Removed:
   trunk/Collect/Makefile
   trunk/Index/Makefile
   trunk/Makefile
   trunk/SQL/Makefile
   trunk/Search/Google/Makefile
   trunk/Search/Makefile
   trunk/Search/ObjectsSearch/Makefile
   trunk/Tokenize/Makefile
   trunk/UI/GTK2/src/Makefile
   trunk/UI/RenderHTML/Makefile
   trunk/Utils/Makefile
   trunk/pinot.spec
   trunk/po/POTFILES
   trunk/variables.mk
Log:
Deleted files that are now automatically generated.


Deleted: trunk/Collect/Makefile
===================================================================
--- trunk/Collect/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/Collect/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,25 +0,0 @@
-
-ROOT_DIR = ..
-include ${ROOT_DIR}/variables.mk
-
-DL_SRCS = DownloaderInterface.cpp NeonDownloader.cpp XapianCollector.cpp \
-        FileCollector.cpp MboxCollector.cpp DownloaderFactory.cpp
-DL_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${DL_SRCS})
-DL_TEST = ${BIN_DIR}/dloadtest
-
-targets : dirs ${DL_LIB} ${DL_TEST}
-
-clean :
-	@rm -f ${OBJ_DIR}/* ${DL_LIB} ${DL_TEST}
-
-# Downloader tester
-
-${DL_TEST} : ${OBJ_DIR}/dloadtest.o ${DL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB}
-	@echo Building ${DL_TEST}
-	${LINK} -o $@ ${OBJ_DIR}/dloadtest.o ${DL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB} ${LIBS}
-
-# Library
-
-${DL_LIB} : ${DL_OBJS}
-	@echo Building ${DL_LIB}
-	${AR} cr ${DL_LIB} ${DL_OBJS}

Deleted: trunk/Index/Makefile
===================================================================
--- trunk/Index/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/Index/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,24 +0,0 @@
-
-ROOT_DIR = ..
-include ${ROOT_DIR}/variables.mk
-
-IDX_SRCS = Summarizer.cpp LanguageDetector.cpp XapianIndex.cpp
-IDX_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${IDX_SRCS})
-IDX_TEST = ${BIN_DIR}/indextest
-
-targets : dirs ${IDX_LIB} ${IDX_TEST} ${DISCKCAT_APP}
-
-clean :
-	@rm -f ${OBJ_DIR}/* ${IDX_LIB} ${IDX_TEST} ${DISCKCAT_APP}
-
-# Index tester
-
-${IDX_TEST} : ${OBJ_DIR}/indextest.o ${IDX_LIB} ${SQL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB}
-	@echo Building ${IDX_TEST}
-	${LINK} -o $@ ${OBJ_DIR}/indextest.o ${IDX_LIB} ${SQL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB} ${LIBS}
-
-# Library
-
-${IDX_LIB} : ${IDX_OBJS}
-	@echo Building ${IDX_LIB}
-	${AR} cr ${IDX_LIB} ${IDX_OBJS}

Deleted: trunk/Makefile
===================================================================
--- trunk/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,60 +0,0 @@
-
-ROOT_DIR = .
-include ${ROOT_DIR}/variables.mk
-
-INSTALL_TARGETS = install-pinot
-ifeq ($(HAS_GOOGLEAPI),yes)
-SOAP_PROJECTS = Search/Google
-endif
-ifeq ($(HAS_OSAPI),yes)
-SOAP_PROJECTS += Search/ObjectsSearch
-endif
-PROJECTS := Utils Tokenize SQL Collect ${SOAP_PROJECTS} Search Index \
-	UI/RenderHTML UI/GTK2/src
-TARGETS_ALL := $(patsubst %,%_all,${PROJECTS})
-TARGETS_CLEAN := $(patsubst %,%_clean,${PROJECTS})
-
-targets : ${TARGETS_ALL}
-
-clean : ${TARGETS_CLEAN}
-
-update :
-	@cvs update
-
-pinot_po :
-	@xgettext -d pinot -o po/pinot.po --force-po --keyword=_ -f po/POTFILES
- 
-pinot_mo :
-	@mkdir -p mo
-	@msgfmt -o mo/en_GB.mo po/en_GB.po
-	@msgfmt -o mo/fr_FR.mo po/fr_FR.po
-	@msgfmt -o mo/es_ES.mo po/es_ES.po
-
-%_clean :
-	@make -C $(patsubst %_clean, %, $@) clean
-	
-%_all :
-	@make -C $(patsubst %_all, %, $@) all
-
-install: ${INSTALL_TARGETS}
-
-install-pinot:
-	@mkdir -p $(PREFIX)/usr/bin/
-	install -m 755 ${BIN_DIR}/pinot $(PREFIX)/usr/bin/pinot
-	install -m 755 ${BIN_DIR}/senginetest $(PREFIX)/usr/bin/pinot_search
-	@mkdir -p $(PREFIX)/usr/share/pinot/engines/
-	@mkdir -p $(PREFIX)/usr/share/pinot/tokenizers/
-	install -m 644 index.html $(PREFIX)/usr/share/pinot/
-	install -m 644 Search/Plugins/* $(PREFIX)/usr/share/pinot/engines/
-	install -m 755 ${LIB_DIR}/*.so $(PREFIX)/usr/share/pinot/tokenizers/
-	install -m 644 UI/GTK2/xapian-powered.png $(PREFIX)/usr/share/pinot/
-	install -m 644 UI/GTK2/metase-gtk2.glade $(PREFIX)/usr/share/pinot/
-	install -m 644 UI/GTK2/metase-gtk2.gladep $(PREFIX)/usr/share/pinot/
-	install -m 644 textcat_conf.txt $(PREFIX)/usr/share/pinot/
-	@mkdir -p $(PREFIX)/usr/share/locale/fr/LC_MESSAGES/
-	install -m 644 mo/fr_FR.mo $(PREFIX)/usr/share/locale/fr/LC_MESSAGES/pinot.mo
-	@mkdir -p $(PREFIX)/usr/share/locale/es/LC_MESSAGES/
-	install -m 644 mo/es_ES.mo $(PREFIX)/usr/share/locale/es/LC_MESSAGES/pinot.mo
-	@mkdir -p $(PREFIX)/usr/share/icons/hicolor/48x48/apps/
-	install -m 644 UI/GTK2/pinot.png $(PREFIX)/usr/share/icons/hicolor/48x48/apps/
-

Deleted: trunk/SQL/Makefile
===================================================================
--- trunk/SQL/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/SQL/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,24 +0,0 @@
-
-ROOT_DIR = ..
-include ${ROOT_DIR}/variables.mk
-
-SQL_SRCS = SQLiteBase.cpp QueryHistory.cpp ViewHistory.cpp
-SQL_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${SQL_SRCS})
-SQL_TEST = ${BIN_DIR}/historytest
-
-targets : dirs ${SQL_LIB} ${SQL_TEST}
-
-clean :
-	@rm -f ${OBJ_DIR}/* ${SQL_LIB} ${SQL_TEST}
-
-# SQL tester
-
-${SQL_TEST} : ${OBJ_DIR}/historytest.o ${SQL_LIB} ${UTILS_LIB}
-	@echo Building ${SQL_TEST}
-	${LINK} -o $@ ${OBJ_DIR}/historytest.o ${SQL_LIB} ${UTILS_LIB} ${LIBS}
-
-# Library
-
-${SQL_LIB} : ${SQL_OBJS}
-	@echo Building ${SQL_LIB}
-	${AR} cr ${SQL_LIB} ${SQL_OBJS}

Deleted: trunk/Search/Google/Makefile
===================================================================
--- trunk/Search/Google/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/Search/Google/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,28 +0,0 @@
-
-ROOT_DIR = ../..
-include ${ROOT_DIR}/variables.mk
-
-GAPI_SRCS = GAPIClientLib.cpp GoogleAPIEngine.cpp
-GAPI_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${GAPI_SRCS})
-
-targets : dirs ${GAPI_LIB}
-
-clean : clean-stubs
-	@rm -f ${OBJ_DIR}/* ${GAPI_LIB}
-
-clean-stubs:
-	@rm -f GAPI* ${OBJ_DIR}/GAPI* *.xml
-
-# Google API stuff
-
-GoogleSearch.h : googleapi/GoogleSearch.wsdl
-	${WSDLC} -n gapi -o GoogleSearch.h googleapi/GoogleSearch.wsdl
-
-GAPIClientLib.cpp : GoogleSearch.h
-	${SOAPC} -n -pGAPI GoogleSearch.h
-
-# Library
-
-${GAPI_LIB} : ${GAPI_OBJS}
-	@echo Building ${GAPI_LIB}
-	${AR} cr ${GAPI_LIB} ${GAPI_OBJS}

Deleted: trunk/Search/Makefile
===================================================================
--- trunk/Search/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/Search/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,64 +0,0 @@
-
-ROOT_DIR = ..
-include ${ROOT_DIR}/variables.mk
-
-SE_SRCS = OpenSearchParser.cpp PluginWebEngine.cpp QueryProperties.cpp \
-	SherlockParser.cpp SearchEngineFactory.cpp SearchEngineInterface.cpp \
-	SearchPluginProperties.cpp WebEngine.cpp XapianEngine.cpp
-SE_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${SE_SRCS})
-ifeq (${NEEDS_SOAP},yes)
-SOAPENV_OBJS = ${OBJ_DIR}/stdsoap.o ${OBJ_DIR}/SOAPEnvNS.o ${OBJ_DIR}/SOAPEnvC.o
-else
-SOAPENV_OBJS = 
-endif
-PLUGIN_TEST = ${BIN_DIR}/plugintest
-SE_TEST = ${BIN_DIR}/senginetest
-
-targets : dirs ${SE_LIB} ${SOAPENV_LIB} ${PLUGIN_TEST} ${SE_TEST}
-
-clean :
-	@rm -f ${OBJ_DIR}/* ${SE_LIB} ${SOAPENV_LIB} ${PLUGIN_TEST} ${SE_TEST}
-
-# SOAP environment
-
-${OBJ_DIR}/stdsoap.o : ${GSOAP_HOME}/stdsoap2.cpp
-	${CXX} -o ${OBJ_DIR}/stdsoap.o -c ${GSOAP_HOME}/stdsoap2.cpp ${CXXFLAGS}
-
-${OBJ_DIR}/SOAPEnvNS.o : SOAPEnvNS.cpp
-	${CXX} -o ${OBJ_DIR}/SOAPEnvNS.o -c SOAPEnvNS.cpp ${CXXFLAGS}
-
-SOAPEnv.h :
-	# Create an empty file, we just want to get global functions
-	@touch SOAPEnv.h
-
-SOAPEnvC.cpp : SOAPEnv.h
-	${SOAPC} -pSOAPEnv SOAPEnv.h
-
-${OBJ_DIR}/SOAPEnvC.o : SOAPEnvC.cpp
-	${CXX} -o ${OBJ_DIR}/SOAPEnvC.o -c SOAPEnvC.cpp ${CXXFLAGS}
-
-# Parser tester
-
-${PLUGIN_TEST} : ${OBJ_DIR}/plugintest.o ${SE_LIBS} ${DL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB}
-	@echo Building ${PLUGIN_TEST}
-	${LINK} -o $@ ${OBJ_DIR}/plugintest.o ${SE_LIBS} ${DL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB} ${LIBS}
-
-# SearchEngine tester
-
-${SE_TEST} : ${OBJ_DIR}/senginetest.o ${SE_LIBS} ${DL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB}
-	@echo Building ${SE_TEST}
-	${LINK} -o $@ ${OBJ_DIR}/senginetest.o ${SE_LIBS} ${DL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB} ${LIBS}
-	
-# Libraries
-
-${SE_LIB} : ${SE_OBJS}
-	@echo Building ${SE_LIB}
-	${AR} cr ${SE_LIB} ${SE_OBJS}
-
-${SOAPENV_LIB} : ${SOAPENV_OBJS}
-ifeq (${NEEDS_SOAP},yes)
-	@echo Building ${SOAPENV_LIB}
-	${AR} cr ${SOAPENV_LIB} ${SOAPENV_OBJS}
-else
-	@echo Not building ${SOAPENV_LIB}
-endif

Deleted: trunk/Search/ObjectsSearch/Makefile
===================================================================
--- trunk/Search/ObjectsSearch/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/Search/ObjectsSearch/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,28 +0,0 @@
-
-ROOT_DIR = ../..
-include ${ROOT_DIR}/variables.mk
-
-OSAPI_SRCS = OSAPIClientLib.cpp ObjectsSearchAPIEngine.cpp
-OSAPI_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${OSAPI_SRCS})
-
-targets : dirs ${OSAPI_LIB}
-
-clean : clean-stubs
-	@rm -f ${OBJ_DIR}/* ${OSAPI_LIB}
-
-clean-stubs:
-	@rm -f OSAPI* ${OBJ_DIR}/OSAPI* *.xml
-
-# ObjectsSearch API stuff
-
-ObjectsSearch.h : ObjectsSearch.wsdl
-	${WSDLC} -n osapi -o ObjectsSearch.h ObjectsSearch.wsdl
-
-OSAPIClientLib.cpp : ObjectsSearch.h
-	${SOAPC} -n -pOSAPI ObjectsSearch.h
-
-# Library
-
-${OSAPI_LIB} : ${OSAPI_OBJS}
-	@echo Building ${OSAPI_LIB}
-	${AR} cr ${OSAPI_LIB} ${OSAPI_OBJS}

Deleted: trunk/Tokenize/Makefile
===================================================================
--- trunk/Tokenize/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/Tokenize/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,47 +0,0 @@
-
-ROOT_DIR = ..
-
-include ${ROOT_DIR}/variables.mk
-
-TOKENIZE_SRCS = Tokenizer.cpp HtmlTokenizer.cpp UnknownTypeTokenizer.cpp \
-	TokenizerFactory.cpp
-TOKENIZE_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${TOKENIZE_SRCS})
-
-TOKENIZER_TEST = ${BIN_DIR}/tokenizertest
-PDF_TOKENIZER_DL = ${LIB_DIR}/pdf_tokenizer.so
-WORD_TOKENIZER_DL = ${LIB_DIR}/word_tokenizer.so
-RTF_TOKENIZER_DL = ${LIB_DIR}/rtf_tokenizer.so
-
-targets : dirs ${TOKENIZE_LIB} ${TOKENIZER_TEST} \
-	${PDF_TOKENIZER_DL} ${WORD_TOKENIZER_DL} \
-	${RTF_TOKENIZER_DL}
-
-clean :
-	@rm -f ${OBJ_DIR}/* ${TOKENIZE_LIB} ${TOKENIZER_TEST} \
-	${PDF_TOKENIZER_DL} ${WORD_TOKENIZER_DL}
-
-# Tokenize tester
-
-${TOKENIZER_TEST} : ${OBJ_DIR}/tokenizertest.o ${TOKENIZE_LIB}
-	@echo Building ${TOKENIZER_TEST}
-	${LINK} -o ${TOKENIZER_TEST} ${OBJ_DIR}/tokenizertest.o ${TOKENIZE_LIB} ${UTILS_LIB} ${LIBS}
-
-# Library
-
-${TOKENIZE_LIB} : ${TOKENIZE_OBJS}
-	@echo Building ${TOKENIZE_LIB}
-	${AR} cr ${TOKENIZE_LIB} ${TOKENIZE_OBJS}
-
-# Tokenizer libraries
-
-${PDF_TOKENIZER_DL} : ${OBJ_DIR}/PdfTokenizer.o
-	@echo Building ${PDF_TOKENIZER_DL}
-	${LINK} -shared -o ${PDF_TOKENIZER_DL} ${OBJ_DIR}/PdfTokenizer.o ${TOKENIZE_LIB} ${UTILS_LIB} ${LIBS} -ldl
-
-${WORD_TOKENIZER_DL} : ${OBJ_DIR}/WordTokenizer.o
-	@echo Building ${WORD_TOKENIZER_DL}
-	${LINK} -shared -o ${WORD_TOKENIZER_DL} ${OBJ_DIR}/WordTokenizer.o ${TOKENIZE_LIB} ${UTILS_LIB} ${LIBS} -ldl
-
-${RTF_TOKENIZER_DL} : ${OBJ_DIR}/RtfTokenizer.o
-	@echo Building ${RTF_TOKENIZER_DL}
-	${LINK} -shared -o ${RTF_TOKENIZER_DL} ${OBJ_DIR}/RtfTokenizer.o ${TOKENIZE_LIB} ${UTILS_LIB} ${LIBS} -ldl

Deleted: trunk/UI/GTK2/src/Makefile
===================================================================
--- trunk/UI/GTK2/src/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/UI/GTK2/src/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,32 +0,0 @@
-
-ROOT_DIR = ../../..
-include ${ROOT_DIR}/variables.mk
-
-CXXFLAGS += -DHAVE_CONFIG_H -I. -I.. ${GTKMOZ_CXXFLAGS} ${GTKMM_CXXFLAGS}
-
-LIBS += ${MOZILLA_XPCOM_LIBS} ${GTKMOZ_LIBS} ${GTKMM_LIBS} -lgthread-2.0 -lfam
-
-UI_GTK2_SRCS = importDialog.cc importDialog_glade.cc \
-	indexDialog.cc indexDialog_glade.cc \
-	prefsDialog.cc prefsDialog_glade.cc \
-	propertiesDialog.cc propertiesDialog_glade.cc \
-	queryDialog.cc queryDialog_glade.cc \
-	mainWindow.cc mainWindow_glade.cc \
-	pinot.cc
-UI_SRCS = EnginesTree.cpp IndexPage.cpp IndexTree.cpp \
-	HtmlView.cpp ModelColumns.cpp MonitorHandler.cpp Notebook.cpp \
-	PinotSettings.cpp PinotUtils.cpp ResultsTree.cpp WorkerThreads.cpp
-UI_GTK2_OBJS := $(patsubst %.cc,${OBJ_DIR}/%.o,${UI_GTK2_SRCS})
-UI_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${UI_SRCS})
-UI_GTK2_BIN = ${BIN_DIR}/pinot
-
-targets : dirs ${UI_GTK2_BIN}
-
-clean :
-	@rm -f ${OBJ_DIR}/* ${UI_GTK2_BIN}
-
-# GTK+ user interface
-
-${UI_GTK2_BIN} : ${UI_GTK2_OBJS} ${UI_OBJS} ${HTML_LIB} ${IDX_LIB} ${SE_LIBS} ${DL_LIB} ${SQL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB}
-	@echo Building ${UI_GTK2_BIN}
-	${LINK} -o $@ ${UI_GTK2_OBJS} ${UI_OBJS} ${HTML_LIB} ${IDX_LIB} ${SE_LIBS} ${DL_LIB} ${SQL_LIB} ${TOKENIZE_LIB} ${UTILS_LIB} ${LIBS}

Deleted: trunk/UI/RenderHTML/Makefile
===================================================================
--- trunk/UI/RenderHTML/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/UI/RenderHTML/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,21 +0,0 @@
-
-ROOT_DIR = ../..
-include ${ROOT_DIR}/variables.mk
-
-CXXFLAGS += -DHAVE_CONFIG_H -I. -I.. ${GTKMOZ_CXXFLAGS} 
-
-LIBS += ${MOZILLA_XPCOM_LIBS} ${GTKMOZ_LIBS}
-
-HTML_SRCS = MozillaRenderer.cpp
-HTML_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${HTML_SRCS})
-
-targets : dirs ${HTML_LIB}
-
-clean :
-	@rm -f ${OBJ_DIR}/* ${HTML_LIB}
-
-# Library
- 
-${HTML_LIB} : ${HTML_OBJS}
-	@echo Building ${HTML_LIB}
-	${AR} cr ${HTML_LIB} ${HTML_OBJS}

Deleted: trunk/Utils/Makefile
===================================================================
--- trunk/Utils/Makefile	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/Utils/Makefile	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,22 +0,0 @@
-
-ROOT_DIR = ..
-
-include ${ROOT_DIR}/variables.mk
-
-UTILS_SRCS = DocumentInfo.cpp Document.cpp HtmlDocument.cpp \
-	IndexedDocument.cpp Languages.cpp MIMEScanner.cpp MboxParser.cpp \
-	Result.cpp StringManip.cpp TimeConverter.cpp Timer.cpp Url.cpp \
-	XapianDatabase.cpp XapianDatabaseFactory.cpp
-UTILS_OBJS := $(patsubst %.cpp,${OBJ_DIR}/%.o,${UTILS_SRCS})
-
-targets : dirs ${UTILS_LIB}
-
-clean :
-	@rm -f ${OBJ_DIR}/* ${UTILS_LIB}
-
-# Library
-
-${UTILS_LIB} : ${UTILS_OBJS}
-	@echo Building ${UTILS_LIB}
-	${AR} cr ${UTILS_LIB} ${UTILS_OBJS}
-

Deleted: trunk/pinot.spec
===================================================================
--- trunk/pinot.spec	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/pinot.spec	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,121 +0,0 @@
-# We need an explicit dependency on mozilla as the so files don't have a version number 
-%define mozilla_ver %(/usr/bin/mozilla-config --version)
-
-Summary: Metasearch tool
-Name: pinot
-Version: 0.42
-Release: 1
-License: GPL
-Group: Applications/Internet 
-Source: %{name}-%{version}.tar.gz
-URL: http://pinot.berlios.de/
-BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
-Requires: xapian-core-libs >= 0.9.2, neon >= 0.24, gtkmm24 >= 2.6, libxml++ >= 2.12, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
-BuildRequires: xapian-core-devel >= 0.9.2, neon-devel >= 0.24, gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
-
-%description
-Pinot is a metasearch tool for the Free Desktop. It enables one to query
-sources, display as well as analyze and locally index the returned results.
-It may also be used as a lightweight personal space search tool.
-
-%package text-docs 
-Summary: Tokenizers for Pinot that handle various text document formats
-Group: Applications/Internet
-Requires: %{name} = %{version}
-Requires: pdftohtml, antiword, unrtf
-Obsoletes: pinot-pdf, pinot-word
-
-%description text-docs 
-The included tokenizers add support for PDF, MS Word and RTF documents.
-
-%package omega 
-Summary: Xapian Omega plugin for Pinot
-Group: Applications/Internet
-Requires: %{name} = %{version}
-Requires: xapian-omega
-
-%description omega
-The included plugin enables Pinot to use Xapian Omega as a search engine.
-
-%prep
-%setup -q
-
-%build
-make DEBUG=yes
-make DEBUG=yes pinot_mo
-
-%install
-[ -n "$RPM_BUILD_ROOT" -a "$RPM_BUILD_ROOT" != / ] && rm -rf $RPM_BUILD_ROOT
-make install PREFIX=$RPM_BUILD_ROOT
-# This engine is not usable as it is
-mv $RPM_BUILD_ROOT/%{_datadir}/pinot/engines/AmazonAPI.src $RPM_BUILD_ROOT/%{_datadir}/pinot/
-# Desktop file
-cat >%{name}.desktop << EOF
-[Desktop Entry]
-Name=Pinot Metasearch Tool
-Comment=Search the Web and your documents
-Exec=%{_bindir}/pinot
-StartupNotify=true
-Icon=pinot.png
-Terminal=false
-Type=Application
-Categories=Application;Network;
-Encoding=UTF-8
-EOF
-mkdir -p $RPM_BUILD_ROOT/%{_datadir}/applications
-desktop-file-install --vendor Amra \
-	--dir $RPM_BUILD_ROOT/%{_datadir}/applications  \
-	%{name}.desktop
-
-%post
-gtk-update-icon-cache -q -f %{_datadir}/icons/hicolor || :
-
-%clean
-[ -n "$RPM_BUILD_ROOT" -a "$RPM_BUILD_ROOT" != / ] && rm -rf $RPM_BUILD_ROOT
-
-%files
-%defattr(-, root, root, -)
-%doc ChangeLog COPYING README TODO
-%{_bindir}/pinot
-%{_bindir}/pinot_search
-%{_datadir}/pinot/index.html
-%{_datadir}/pinot/xapian-powered.png
-%{_datadir}/pinot/metase-gtk2.glade
-%{_datadir}/pinot/metase-gtk2.gladep
-%{_datadir}/pinot/textcat_conf.txt
-%{_datadir}/pinot/*.src
-%dir %{_datadir}/pinot/engines/
-%config(noreplace) %{_datadir}/pinot/engines/A9.src
-%config(noreplace) %{_datadir}/pinot/engines/Acoona.src
-%config(noreplace) %{_datadir}/pinot/engines/Altavista.src
-%config(noreplace) %{_datadir}/pinot/engines/AskJeeves.src
-%config(noreplace) %{_datadir}/pinot/engines/BitTorrent.src
-%config(noreplace) %{_datadir}/pinot/engines/Clusty.src
-%config(noreplace) %{_datadir}/pinot/engines/Freshmeat.src
-%config(noreplace) %{_datadir}/pinot/engines/Google.src
-%config(noreplace) %{_datadir}/pinot/engines/Lycos.src
-%config(noreplace) %{_datadir}/pinot/engines/MSN.src
-%config(noreplace) %{_datadir}/pinot/engines/Teoma.src
-%config(noreplace) %{_datadir}/pinot/engines/Topix.src
-%config(noreplace) %{_datadir}/pinot/engines/WiseNut.src
-%config(noreplace) %{_datadir}/pinot/engines/Yahoo.src
-%config(noreplace) %{_datadir}/pinot/engines/YahooAPI.src
-%config(noreplace) %{_datadir}/pinot/engines/Wikipedia.src
-%config(noreplace) %{_datadir}/pinot/engines/KodersDescription.xml
-%config(noreplace) %{_datadir}/pinot/engines/MozDexDescription.xml
-%{_datadir}/locale/fr/LC_MESSAGES/pinot.mo
-%{_datadir}/locale/es/LC_MESSAGES/pinot.mo
-%{_datadir}/icons/hicolor/48x48/apps/pinot.png
-%{_datadir}/applications/Amra-%{name}.desktop
-
-%files text-docs 
-%defattr(-, root, root, -)
-%dir %{_datadir}/pinot/tokenizers/pdf_tokenizer.so
-%dir %{_datadir}/pinot/tokenizers/word_tokenizer.so
-%dir %{_datadir}/pinot/tokenizers/rtf_tokenizer.so
-
-%files omega
-%defattr(-, root, root, -)
-%config(noreplace) %{_datadir}/pinot/engines/OmegaDescription.xml
-
-%changelog

Deleted: trunk/po/POTFILES
===================================================================

Deleted: trunk/variables.mk
===================================================================
--- trunk/variables.mk	2006-02-12 12:44:57 UTC (rev 106)
+++ trunk/variables.mk	2006-02-12 13:15:56 UTC (rev 107)
@@ -1,113 +0,0 @@
-CXX := @g++
-LINK := @libtool --tag=CXX --mode=link g++ -fPIC
-AR := @ar
-WSDLC := @${GSOAP_HOME}/wsdl2h
-SOAPC := @${GSOAP_HOME}/soapcpp2 -I${GSOAP_HOME}
-
-HW_NAME := $(shell uname -i)
-OBJ_DIR := obj-${HW_NAME}
-LIB_DIR := ${ROOT_DIR}/lib-${HW_NAME}
-BIN_DIR := ${ROOT_DIR}/bin-${HW_NAME}
-
-# Libraries
-
-UTILS_LIB := ${LIB_DIR}/libutils.a
-TOKENIZE_LIB := ${LIB_DIR}/libtokenize.a
-SQL_LIB := ${LIB_DIR}/libsql.a
-DL_LIB := ${LIB_DIR}/libcollect.a
-GAPI_LIB := ${LIB_DIR}/libgoogleapi.a
-OSAPI_LIB := ${LIB_DIR}/libosapi.a
-SE_LIB := ${LIB_DIR}/libsearch.a
-SE_LIBS := ${SE_LIB}
-SOAPENV_LIB := ${LIB_DIR}/libsoapenv.a
-IDX_LIB := ${LIB_DIR}/libindex.a
-HTML_LIB := ${LIB_DIR}/libhtml.a
-
-# Flags
-
-PROJECT_CXXFLAGS := -I${ROOT_DIR}/Utils -I${ROOT_DIR}/Tokenize -I${ROOT_DIR}/SQL \
-	-I${ROOT_DIR}/Collect -I${ROOT_DIR}/Search -I${ROOT_DIR}/Index \
-	-I${ROOT_DIR}/UI/RenderHTML
-
-# SOAP
-NEEDS_SOAP := no
-# Google SOAP API is optional
-ifeq ($(HAS_GOOGLEAPI),yes)
-GOOGLEAPI_CXXFLAGS := -I${GSOAP_HOME} -I${ROOT_DIR}/Search/Google -DHAS_GOOGLEAPI
-SE_LIBS += ${GAPI_LIB}
-NEEDS_SOAP := yes
-else
-GOOGLEAPI_CXXFLAGS :=
-endif
-# ObjectsSearch SOAP API is also optional
-ifeq ($(HAS_OSAPI),yes)
-OSAPI_CXXFLAGS := -I${GSOAP_HOME} -I${ROOT_DIR}/Search/ObjectsSearch -DHAS_OSAPI
-SE_LIBS += ${OSAPI_LIB}
-NEEDS_SOAP := yes
-else
-OSAPI_CXXFLAGS :=
-endif
-ifeq ($(NEEDS_SOAP),yes)
-SE_LIBS += ${SOAPENV_LIB}
-endif
-
-# NEON
-NEON_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags neon)
-NEON_LIBS = $(shell /usr/bin/pkg-config --libs neon)
-# OTS
-OTS_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags libots-1)
-OTS_LIBS = $(shell /usr/bin/pkg-config --libs libots-1)
-# GMime
-GMIME_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags gmime-2.0)
-GMIME_LIBS = $(shell /usr/bin/pkg-config --libs gmime-2.0)
-# Libtextcat
-TEXTCAT_CXXFLAGS =
-TEXTCAT_LIBS = -ltextcat
-# Xapian
-XAPIAN_CXXFLAGS = $(shell xapian-config --cxxflags)
-XAPIAN_LIBS = $(shell xapian-config --libs)
-# SQLite
-SQLITE_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags sqlite3)
-SQLITE_LIBS = $(shell /usr/bin/pkg-config --libs sqlite3)
-# LibXML++
-LIBXML_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags libxml++-2.6)
-LIBXML_LIBS = $(shell /usr/bin/pkg-config --libs libxml++-2.6)
-# Mozilla
-MOZILLA_LIB_DIR = $(shell dirname `find /usr/lib*/mozilla* -name libgtkembedmoz.so | head -1`)
-ifeq ($(MOZILLA_LIB_DIR),)
-MOZILLA_LIB_DIR = /usr/lib/mozilla
-endif
-MOZILLA_INC_DIR = $(shell dirname `find /usr/include/mozilla* -name mozilla-config.h | head -1`)
-ifeq ($(MOZILLA_INC_DIR),)
-MOZILLA_INC_DIR = /usr/include/mozilla
-endif
-MOZILLA_XPCOM_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags mozilla-xpcom)
-MOZILLA_XPCOM_LIBS = -Xlinker -rpath -Xlinker ${MOZILLA_LIB_DIR} $(shell /usr/bin/pkg-config --libs mozilla-xpcom)
-GTKMOZ_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags mozilla-gtkmozembed gtk+-2.0)
-GTKMOZ_LIBS = -Xlinker -rpath -Xlinker ${MOZILLA_LIB_DIR} $(shell /usr/bin/pkg-config --libs mozilla-gtkmozembed gtk+-2.0 mozilla-nss)
-# GTKmm
-GTKMM_CXXFLAGS = $(shell /usr/bin/pkg-config --cflags gtkmm-2.4)
-GTKMM_LIBS = $(shell /usr/bin/pkg-config --libs gtkmm-2.4)
-
-CXXFLAGS = -DENABLE_NLS ${PROJECT_CXXFLAGS} ${GOOGLEAPI_CXXFLAGS} ${OSAPI_CXXFLAGS} \
-	${NEON_CXXFLAGS} ${OTS_CXXFLAGS} ${GMIME_CXXFLAGS} ${TEXTCAT_CXXFLAGS} \
-	${LIBXML_CXXFLAGS} ${XAPIAN_CXXFLAGS} ${SQLITE_CXXFLAGS}
-ifeq ($(DEBUG),yes)
-CXXFLAGS += -g -DDEBUG
-endif
-LIBS := -lmagic -lpthread -lcrypt ${NEON_LIBS} ${OTS_LIBS} ${GMIME_LIBS} ${TEXTCAT_LIBS} \
-	${LIBXML_LIBS} ${XAPIAN_LIBS} ${SQLITE_LIBS}
-
-# Common targets
-
-all : targets
-
-dirs :
-	@mkdir -p ${OBJ_DIR} ${LIB_DIR} ${BIN_DIR}
-
-${OBJ_DIR}/%.o : %.cpp
-	${CXX} -c $< -o $@ ${CXXFLAGS}
-
-${OBJ_DIR}/%.o : %.cc
-	${CXX} -c $< -o $@ ${CXXFLAGS}
-



From fabricecolin at berlios.de  Sun Feb 12 15:55:25 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sun, 12 Feb 2006 15:55:25 +0100
Subject: [Pinot-svn] r108 - in trunk: . Search UI/GTK2/src Utils po
Message-ID: <200602121455.k1CEtPUt010266@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-12 15:55:22 +0100 (Sun, 12 Feb 2006)
New Revision: 108

Modified:
   trunk/Makefile.am
   trunk/Search/Makefile.am
   trunk/UI/GTK2/src/Makefile.am
   trunk/Utils/Makefile.am
   trunk/configure.in
   trunk/pinot.spec.in
   trunk/po/Makefile.in
Log:
Build and distribution fixes.


Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-02-12 13:15:56 UTC (rev 107)
+++ trunk/Makefile.am	2006-02-12 14:55:22 UTC (rev 108)
@@ -3,7 +3,10 @@
 
 SUBDIRS = po Utils Tokenize SQL Collect Search Index UI/RenderHTML UI/GTK2/src
 
-EXTRA_DIST = config.rpath mkinstalldirs m4/ChangeLog TODO README configure 
+EXTRA_DIST = config.rpath mkinstalldirs m4/ChangeLog TODO README configure \
+	pinot.spec Search/Plugins/*src Search/Plugins/*.xml \
+	index.html UI/GTK2/src/pinot.png UI/GTK2/src/xapian-powered.png \
+	textcat_conf.txt UI/GTK2/metase-gtk2.glade UI/GTK2/metase-gtk2.gladep
 
 ACLOCAL_AMFLAGS = -I m4
 

Modified: trunk/Search/Makefile.am
===================================================================
--- trunk/Search/Makefile.am	2006-02-12 13:15:56 UTC (rev 107)
+++ trunk/Search/Makefile.am	2006-02-12 14:55:22 UTC (rev 108)
@@ -13,6 +13,8 @@
 
 noinst_LTLIBRARIES = libSearch.la
 
+bin_PROGRAMS = pinot_search
+
 libSearch_la_SOURCES = \
 	OpenSearchParser.cpp \
 	QueryProperties.cpp \
@@ -24,5 +26,13 @@
 	SearchEngineInterface.cpp \
 	SherlockParser.cpp
 
-AM_CXXFLAGS = -I../Utils -I../Tokenize -I../Collect @XML_CFLAGS@
+pinot_search_SOURCES = \
+	senginetest.cpp
 
+pinot_search_LDADD = -L../Utils -L../Tokenize -L../Collect \
+	-lSearch -lCollect -lTokenize -lUtils \
+	@INDEX_LIBS@ @XML_LIBS@ @MIME_LIBS@ @HTTP_LIBS@ @MISC_LIBS@
+
+AM_CXXFLAGS = -I../Utils -I../Tokenize -I../Collect \
+	@HTTP_CFLAGS@ @XML_CFLAGS@ @INDEX_CFLAGS@ @MIME_CFLAGS@
+

Modified: trunk/UI/GTK2/src/Makefile.am
===================================================================
--- trunk/UI/GTK2/src/Makefile.am	2006-02-12 13:15:56 UTC (rev 107)
+++ trunk/UI/GTK2/src/Makefile.am	2006-02-12 14:55:22 UTC (rev 108)
@@ -59,6 +59,6 @@
 
 pinot_LDADD = -L../../../Utils -L../../../Tokenize -L../../../SQL \
         -L../../../Collect -L../../../Search -L../../../Index -L../../RenderHTML \
-	@LIBS@ @UI_LIBS@ @INDEX_LIBS@ @XML_LIBS@ @MIME_LIBS@ @HTTP_LIBS@ @SQL_LIBS@ \
+	@LIBS@ @UI_LIBS@ @INDEX_LIBS@ @XML_LIBS@ @MIME_LIBS@ @HTTP_LIBS@ @SQL_LIBS@ @MISC_LIBS@ \
 	-lHTML -lIndex -lSearch -lCollect -lSQL -lTokenize -lUtils
 

Modified: trunk/Utils/Makefile.am
===================================================================
--- trunk/Utils/Makefile.am	2006-02-12 13:15:56 UTC (rev 107)
+++ trunk/Utils/Makefile.am	2006-02-12 14:55:22 UTC (rev 108)
@@ -34,5 +34,5 @@
 	Url.cpp \
 	XapianDatabaseFactory.cpp
 
-AM_CXXFLAGS = @INDEX_CFLAGS@ @MIME_CFLAGS@
+AM_CXXFLAGS = @HTTP_CFLAGS@ @INDEX_CFLAGS@ @MIME_CFLAGS@
 

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-12 13:15:56 UTC (rev 107)
+++ trunk/configure.in	2006-02-12 14:55:22 UTC (rev 108)
@@ -25,7 +25,7 @@
 		[the gettext domain])
 
 dnl Add the languages which your application supports here.
-ALL_LINGUAS="en_GB fr_FR es_ES"
+ALL_LINGUAS="fr_FR es_ES"
 AM_GNU_GETTEXT([external]) 
 AM_GLIB_GNU_GETTEXT
 
@@ -50,6 +50,8 @@
 XAPIAN_LIBS=`$XAPIAN_CONFIG --libs`
 
 dnl Other libraries
+MISC_LIBS="-lmagic -lcrypt"
+AC_SUBST(MISC_LIBS)
 PKG_CHECK_MODULES(SQL, sqlite3 >= 3.1 )
 AC_SUBST(SQL_CFLAGS)
 AC_SUBST(SQL_LIBS)
@@ -75,7 +77,7 @@
 else
   MOZILLA_LIB_DIR=`dirname ${MOZILLA_GTKEMBED}`
 fi
-UI_LIBS="-lmagic -lpthread -lcrypt -lfam -L${MOZILLA_LIB_DIR} -Xlinker -rpath -Xlinker ${MOZILLA_LIB_DIR} $UI_LIBS"
+UI_LIBS="-lpthread -lfam -L${MOZILLA_LIB_DIR} -Xlinker -rpath -Xlinker ${MOZILLA_LIB_DIR} $UI_LIBS"
 AC_SUBST(UI_CFLAGS)
 AC_SUBST(UI_LIBS)
 

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-02-12 13:15:56 UTC (rev 107)
+++ trunk/pinot.spec.in	2006-02-12 14:55:22 UTC (rev 108)
@@ -42,12 +42,12 @@
 %setup -q
 
 %build
-make DEBUG=yes
-make DEBUG=yes pinot_mo
+%configure
+make
 
 %install
 [ -n "$RPM_BUILD_ROOT" -a "$RPM_BUILD_ROOT" != / ] && rm -rf $RPM_BUILD_ROOT
-make install PREFIX=$RPM_BUILD_ROOT
+%makeinstall
 # This engine is not usable as it is
 mv $RPM_BUILD_ROOT/%{_datadir}/pinot/engines/AmazonAPI.src $RPM_BUILD_ROOT/%{_datadir}/pinot/
 # Desktop file

Modified: trunk/po/Makefile.in
===================================================================
--- trunk/po/Makefile.in	2006-02-12 13:15:56 UTC (rev 107)
+++ trunk/po/Makefile.in	2006-02-12 14:55:22 UTC (rev 108)
@@ -30,7 +30,7 @@
 INSTALL = @INSTALL@
 INSTALL_DATA = @INSTALL_DATA@
 MKINSTALLDIRS = @MKINSTALLDIRS@
-mkinstalldirs = $(SHELL) $(MKINSTALLDIRS)
+mkinstalldirs = $(SHELL) ../$(MKINSTALLDIRS)
 
 GMSGFMT = @GMSGFMT@
 MSGFMT = @MSGFMT@



From fabricecolin at berlios.de  Tue Feb 14 16:02:25 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Tue, 14 Feb 2006 16:02:25 +0100
Subject: [Pinot-svn] r109 - in trunk: . Tokenize
Message-ID: <200602141502.k1EF2PiU026702@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-14 16:02:24 +0100 (Tue, 14 Feb 2006)
New Revision: 109

Modified:
   trunk/Makefile.am
   trunk/Tokenize/Makefile.am
   trunk/configure.in
Log:
Build tokenizer libraries and (attempt to) install everything in the right
places :-)


Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-02-12 14:55:22 UTC (rev 108)
+++ trunk/Makefile.am	2006-02-14 15:02:24 UTC (rev 109)
@@ -5,8 +5,23 @@
 
 EXTRA_DIST = config.rpath mkinstalldirs m4/ChangeLog TODO README configure \
 	pinot.spec Search/Plugins/*src Search/Plugins/*.xml \
-	index.html UI/GTK2/src/pinot.png UI/GTK2/src/xapian-powered.png \
+	index.html UI/GTK2/xapian-powered.png UI/GTK2/pinot.png \
 	textcat_conf.txt UI/GTK2/metase-gtk2.glade UI/GTK2/metase-gtk2.gladep
 
+install-data-local:
+	$(mkinstalldirs) $(DESTDIR)$(datadir)/pinot
+	$(INSTALL_DATA) index.html $(DESTDIR)$(datadir)/pinot/index.html
+	$(INSTALL_DATA) UI/GTK2/xapian-powered.png $(DESTDIR)$(datadir)/pinot/xapian-powered.png
+	$(INSTALL_DATA) UI/GTK2/metase-gtk2.glade $(DESTDIR)$(datadir)/pinot/metase-gtk2.glade
+	$(INSTALL_DATA) UI/GTK2/metase-gtk2.gladep $(DESTDIR)$(datadir)/pinot/metase-gtk2.gladep
+	$(INSTALL_DATA) textcat_conf.txt $(DESTDIR)$(datadir)/pinot/textcat_conf.txt
+	$(mkinstalldirs) $(DESTDIR)$(datadir)/pinot/engines
+	$(INSTALL_DATA) Search/Plugins/*.src $(DESTDIR)$(datadir)/pinot/engines/
+	$(INSTALL_DATA) Search/Plugins/*.xml $(DESTDIR)$(datadir)/pinot/engines/
+	$(mkinstalldirs) $(DESTDIR)$(datadir)/pinot/tokenizers
+	$(INSTALL_DATA) Tokenize/.libs/*.so $(DESTDIR)$(datadir)/pinot/tokenizers/
+	$(mkinstalldirs) $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/
+	$(INSTALL_DATA) UI/GTK2/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/pinot.png
+
 ACLOCAL_AMFLAGS = -I m4
 

Modified: trunk/Tokenize/Makefile.am
===================================================================
--- trunk/Tokenize/Makefile.am	2006-02-12 14:55:22 UTC (rev 108)
+++ trunk/Tokenize/Makefile.am	2006-02-14 15:02:24 UTC (rev 109)
@@ -9,16 +9,36 @@
 	UnknownTypeTokenizer.h \
 	WordTokenizer.h
 
+lib_LTLIBRARIES = libpdftokenizer.la librtftokenizer.la libwordtokenizer.la
+
 noinst_LTLIBRARIES = libTokenize.la
 
+libpdftokenizer_la_SOURCES = \
+	PdfTokenizer.cpp
+
+libpdftokenizer_la_LDFLAGS = -L../Utils 
+
+libpdftokenizer_la_LIBADD = libTokenize.la ../Utils/libUtils.la
+
+librtftokenizer_la_SOURCES = \
+	RtfTokenizer.cpp
+
+librtftokenizer_la_LDFLAGS = -L../Utils
+
+librtftokenizer_la_LIBADD = libTokenize.la ../Utils/libUtils.la
+
+libwordtokenizer_la_SOURCES = \
+	WordTokenizer.cpp
+
+libwordtokenizer_la_LDFLAGS = -L../Utils
+
+libwordtokenizer_la_LIBADD = libTokenize.la ../Utils/libUtils.la
+
 libTokenize_la_SOURCES = \
 	HtmlTokenizer.cpp \
-	PdfTokenizer.cpp \
-	RtfTokenizer.cpp \
 	Tokenizer.cpp \
 	TokenizerFactory.cpp \
-	UnknownTypeTokenizer.cpp \
-	WordTokenizer.cpp
+	UnknownTypeTokenizer.cpp
 
 AM_CXXFLAGS = -I../Utils
 

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-12 14:55:22 UTC (rev 108)
+++ trunk/configure.in	2006-02-14 15:02:24 UTC (rev 109)
@@ -86,7 +86,7 @@
 AC_CHECK_FUNCS(lstat)
 AC_CHECK_FUNCS(mmap)
 
-AC_OUTPUT( pinot.spec ./Makefile Utils/Makefile Tokenize/Makefile SQL/Makefile \
+AC_OUTPUT( pinot.spec Makefile Utils/Makefile Tokenize/Makefile SQL/Makefile \
 	po/Makefile Collect/Makefile Search/Makefile Index/Makefile \
 	UI/RenderHTML/Makefile UI/GTK2/src/Makefile )
 



From fabricecolin at berlios.de  Wed Feb 15 14:07:39 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 15 Feb 2006 14:07:39 +0100
Subject: [Pinot-svn] r111 - trunk
Message-ID: <200602151307.k1FD7doW025897@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-15 14:07:28 +0100 (Wed, 15 Feb 2006)
New Revision: 111

Added:
   trunk/ABOUT-NLS
Log:
This file is required apparently.


Added: trunk/ABOUT-NLS
===================================================================
--- trunk/ABOUT-NLS	2006-02-15 12:55:04 UTC (rev 110)
+++ trunk/ABOUT-NLS	2006-02-15 13:07:28 UTC (rev 111)
@@ -0,0 +1 @@
+link /usr/share/gettext/ABOUT-NLS
\ No newline at end of file


Property changes on: trunk/ABOUT-NLS
___________________________________________________________________
Name: svn:special
   + *



From fabricecolin at berlios.de  Wed Feb 15 13:55:09 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 15 Feb 2006 13:55:09 +0100
Subject: [Pinot-svn] r110 - in trunk: . po
Message-ID: <200602151255.k1FCt9nf020215@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-15 13:55:04 +0100 (Wed, 15 Feb 2006)
New Revision: 110

Added:
   trunk/po/Makefile.in.in
Removed:
   trunk/po/Makefile.in
Modified:
   trunk/configure.in
   trunk/po/es_ES.po
   trunk/po/fr_FR.po
Log:
Dropped po/Makefile.in, replaced by more useful po/Makefile.in.in, imported
from alleyoop 0.9.0. Thanks ! :-)


Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-14 15:02:24 UTC (rev 109)
+++ trunk/configure.in	2006-02-15 12:55:04 UTC (rev 110)
@@ -2,7 +2,7 @@
 # using glademm V2.6.0
 
 AC_PREREQ(2.50)
-AC_INIT(pinot, 0.45,[colinf at chez.com])
+AC_INIT(pinot, 0.44,[colinf at chez.com])
 AM_INIT_AUTOMAKE
 AC_CONFIG_HEADERS(config.h)
 
@@ -87,6 +87,6 @@
 AC_CHECK_FUNCS(mmap)
 
 AC_OUTPUT( pinot.spec Makefile Utils/Makefile Tokenize/Makefile SQL/Makefile \
-	po/Makefile Collect/Makefile Search/Makefile Index/Makefile \
+	po/Makefile.in Collect/Makefile Search/Makefile Index/Makefile \
 	UI/RenderHTML/Makefile UI/GTK2/src/Makefile )
 

Deleted: trunk/po/Makefile.in
===================================================================
--- trunk/po/Makefile.in	2006-02-14 15:02:24 UTC (rev 109)
+++ trunk/po/Makefile.in	2006-02-15 12:55:04 UTC (rev 110)
@@ -1,384 +0,0 @@
-# Makefile for PO directory in any package using GNU gettext.
-# Copyright (C) 1995-1997, 2000-2005 by Ulrich Drepper <drepper at gnu.ai.mit.edu>
-#
-# This file can be copied and used freely without restrictions.  It can
-# be used in projects which are not available under the GNU General Public
-# License but which still want to provide support for the GNU gettext
-# functionality.
-# Please note that the actual code of GNU gettext is covered by the GNU
-# General Public License and is *not* in the public domain.
-#
-# Origin: gettext-0.14.3
-
-PACKAGE = @PACKAGE@
-VERSION = @VERSION@
-PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
-
-SHELL = /bin/sh
- at SET_MAKE@
-
-srcdir = @srcdir@
-top_srcdir = @top_srcdir@
-VPATH = @srcdir@
-
-prefix = @prefix@
-exec_prefix = @exec_prefix@
-datadir = @datadir@
-localedir = $(datadir)/locale
-gettextsrcdir = $(datadir)/gettext/po
-
-INSTALL = @INSTALL@
-INSTALL_DATA = @INSTALL_DATA@
-MKINSTALLDIRS = @MKINSTALLDIRS@
-mkinstalldirs = $(SHELL) ../$(MKINSTALLDIRS)
-
-GMSGFMT = @GMSGFMT@
-MSGFMT = @MSGFMT@
-XGETTEXT = @XGETTEXT@
-MSGMERGE = msgmerge
-MSGMERGE_UPDATE = @MSGMERGE@ --update
-MSGINIT = msginit
-MSGCONV = msgconv
-MSGFILTER = msgfilter
-
-POFILES = @POFILES@
-GMOFILES = @GMOFILES@
-UPDATEPOFILES = @UPDATEPOFILES@
-DUMMYPOFILES = @DUMMYPOFILES@
-DISTFILES.common = Makefile.in.in remove-potcdate.sin \
-$(DISTFILES.common.extra1) $(DISTFILES.common.extra2) $(DISTFILES.common.extra3)
-DISTFILES = $(DISTFILES.common) Makevars POTFILES.in \
-$(POFILES) $(GMOFILES) \
-$(DISTFILES.extra1) $(DISTFILES.extra2) $(DISTFILES.extra3)
-
-POTFILES = \
-
-CATALOGS = @CATALOGS@
-
-# Makevars gets inserted here. (Don't remove this line!)
-
-.SUFFIXES:
-.SUFFIXES: .po .gmo .mo .sed .sin .nop .po-create .po-update
-
-.po.mo:
-	@echo "$(MSGFMT) -c -o $@ $<"; \
-	$(MSGFMT) -c -o t-$@ $< && mv t-$@ $@
-
-.po.gmo:
-	@lang=`echo $* | sed -e 's,.*/,,'`; \
-	test "$(srcdir)" = . && cdcmd="" || cdcmd="cd $(srcdir) && "; \
-	echo "$${cdcmd}rm -f $${lang}.gmo && $(GMSGFMT) -c --statistics -o $${lang}.gmo $${lang}.po"; \
-	cd $(srcdir) && rm -f $${lang}.gmo && $(GMSGFMT) -c --statistics -o t-$${lang}.gmo $${lang}.po && mv t-$${lang}.gmo $${lang}.gmo
-
-.sin.sed:
-	sed -e '/^#/d' $< > t-$@
-	mv t-$@ $@
-
-
-all: all- at USE_NLS@
-
-all-yes: stamp-po
-all-no:
-
-# $(srcdir)/$(DOMAIN).pot is only created when needed. When xgettext finds no
-# internationalized messages, no $(srcdir)/$(DOMAIN).pot is created (because
-# we don't want to bother translators with empty POT files). We assume that
-# LINGUAS is empty in this case, i.e. $(POFILES) and $(GMOFILES) are empty.
-# In this case, stamp-po is a nop (i.e. a phony target).
-
-# stamp-po is a timestamp denoting the last time at which the CATALOGS have
-# been loosely updated. Its purpose is that when a developer or translator
-# checks out the package via CVS, and the $(DOMAIN).pot file is not in CVS,
-# "make" will update the $(DOMAIN).pot and the $(CATALOGS), but subsequent
-# invocations of "make" will do nothing. This timestamp would not be necessary
-# if updating the $(CATALOGS) would always touch them; however, the rule for
-# $(POFILES) has been designed to not touch files that don't need to be
-# changed.
-stamp-po: $(srcdir)/$(DOMAIN).pot
-	test ! -f $(srcdir)/$(DOMAIN).pot || \
-	  test -z "$(GMOFILES)" || $(MAKE) $(GMOFILES)
-	@test ! -f $(srcdir)/$(DOMAIN).pot || { \
-	  echo "touch stamp-po" && \
-	  echo timestamp > stamp-poT && \
-	  mv stamp-poT stamp-po; \
-	}
-
-# Note: Target 'all' must not depend on target '$(DOMAIN).pot-update',
-# otherwise packages like GCC can not be built if only parts of the source
-# have been downloaded.
-
-# This target rebuilds $(DOMAIN).pot; it is an expensive operation.
-# Note that $(DOMAIN).pot is not touched if it doesn't need to be changed.
-$(DOMAIN).pot-update: $(POTFILES) $(srcdir)/POTFILES.in remove-potcdate.sed
-	if test -n '$(MSGID_BUGS_ADDRESS)' || test '$(PACKAGE_BUGREPORT)' = '@'PACKAGE_BUGREPORT'@'; then \
-	  msgid_bugs_address='$(MSGID_BUGS_ADDRESS)'; \
-	else \
-	  msgid_bugs_address='$(PACKAGE_BUGREPORT)'; \
-	fi; \
-	$(XGETTEXT) --default-domain=$(DOMAIN) --directory=$(top_srcdir) \
-	  --add-comments=TRANSLATORS: $(XGETTEXT_OPTIONS) \
-	  --files-from=$(srcdir)/POTFILES.in \
-	  --copyright-holder='$(COPYRIGHT_HOLDER)' \
-	  --msgid-bugs-address="$$msgid_bugs_address"
-	test ! -f $(DOMAIN).po || { \
-	  if test -f $(srcdir)/$(DOMAIN).pot; then \
-	    sed -f remove-potcdate.sed < $(srcdir)/$(DOMAIN).pot > $(DOMAIN).1po && \
-	    sed -f remove-potcdate.sed < $(DOMAIN).po > $(DOMAIN).2po && \
-	    if cmp $(DOMAIN).1po $(DOMAIN).2po >/dev/null 2>&1; then \
-	      rm -f $(DOMAIN).1po $(DOMAIN).2po $(DOMAIN).po; \
-	    else \
-	      rm -f $(DOMAIN).1po $(DOMAIN).2po $(srcdir)/$(DOMAIN).pot && \
-	      mv $(DOMAIN).po $(srcdir)/$(DOMAIN).pot; \
-	    fi; \
-	  else \
-	    mv $(DOMAIN).po $(srcdir)/$(DOMAIN).pot; \
-	  fi; \
-	}
-
-# This rule has no dependencies: we don't need to update $(DOMAIN).pot at
-# every "make" invocation, only create it when it is missing.
-# Only "make $(DOMAIN).pot-update" or "make dist" will force an update.
-$(srcdir)/$(DOMAIN).pot:
-	$(MAKE) $(DOMAIN).pot-update
-
-# This target rebuilds a PO file if $(DOMAIN).pot has changed.
-# Note that a PO file is not touched if it doesn't need to be changed.
-$(POFILES): $(srcdir)/$(DOMAIN).pot
-	@lang=`echo $@ | sed -e 's,.*/,,' -e 's/\.po$$//'`; \
-	if test -f "$(srcdir)/$${lang}.po"; then \
-	  test "$(srcdir)" = . && cdcmd="" || cdcmd="cd $(srcdir) && "; \
-	  echo "$${cdcmd}$(MSGMERGE_UPDATE) $${lang}.po $(DOMAIN).pot"; \
-	  cd $(srcdir) && $(MSGMERGE_UPDATE) $${lang}.po $(DOMAIN).pot; \
-	else \
-	  $(MAKE) $${lang}.po-create; \
-	fi
-
-
-install: install-exec install-data
-install-exec:
-install-data: install-data- at USE_NLS@
-	if test "$(PACKAGE)" = "gettext-tools"; then \
-	  $(mkinstalldirs) $(DESTDIR)$(gettextsrcdir); \
-	  for file in $(DISTFILES.common) Makevars.template; do \
-	    $(INSTALL_DATA) $(srcdir)/$$file \
-			    $(DESTDIR)$(gettextsrcdir)/$$file; \
-	  done; \
-	  for file in Makevars; do \
-	    rm -f $(DESTDIR)$(gettextsrcdir)/$$file; \
-	  done; \
-	else \
-	  : ; \
-	fi
-install-data-no: all
-install-data-yes: all
-	$(mkinstalldirs) $(DESTDIR)$(datadir)
-	@catalogs='$(CATALOGS)'; \
-	for cat in $$catalogs; do \
-	  cat=`basename $$cat`; \
-	  lang=`echo $$cat | sed -e 's/\.gmo$$//'`; \
-	  dir=$(localedir)/$$lang/LC_MESSAGES; \
-	  $(mkinstalldirs) $(DESTDIR)$$dir; \
-	  if test -r $$cat; then realcat=$$cat; else realcat=$(srcdir)/$$cat; fi; \
-	  $(INSTALL_DATA) $$realcat $(DESTDIR)$$dir/$(DOMAIN).mo; \
-	  echo "installing $$realcat as $(DESTDIR)$$dir/$(DOMAIN).mo"; \
-	  for lc in '' $(EXTRA_LOCALE_CATEGORIES); do \
-	    if test -n "$$lc"; then \
-	      if (cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc 2>/dev/null) | grep ' -> ' >/dev/null; then \
-	        link=`cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc | sed -e 's/^.* -> //'`; \
-	        mv $(DESTDIR)$(localedir)/$$lang/$$lc $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
-	        mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
-	        (cd $(DESTDIR)$(localedir)/$$lang/$$lc.old && \
-	         for file in *; do \
-	           if test -f $$file; then \
-	             ln -s ../$$link/$$file $(DESTDIR)$(localedir)/$$lang/$$lc/$$file; \
-	           fi; \
-	         done); \
-	        rm -f $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
-	      else \
-	        if test -d $(DESTDIR)$(localedir)/$$lang/$$lc; then \
-	          :; \
-	        else \
-	          rm -f $(DESTDIR)$(localedir)/$$lang/$$lc; \
-	          mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
-	        fi; \
-	      fi; \
-	      rm -f $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo; \
-	      ln -s ../LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo 2>/dev/null || \
-	      ln $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo 2>/dev/null || \
-	      cp -p $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(DOMAIN).mo $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo; \
-	      echo "installing $$realcat link as $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo"; \
-	    fi; \
-	  done; \
-	done
-
-install-strip: install
-
-installdirs: installdirs-exec installdirs-data
-installdirs-exec:
-installdirs-data: installdirs-data- at USE_NLS@
-	if test "$(PACKAGE)" = "gettext-tools"; then \
-	  $(mkinstalldirs) $(DESTDIR)$(gettextsrcdir); \
-	else \
-	  : ; \
-	fi
-installdirs-data-no:
-installdirs-data-yes:
-	$(mkinstalldirs) $(DESTDIR)$(datadir)
-	@catalogs='$(CATALOGS)'; \
-	for cat in $$catalogs; do \
-	  cat=`basename $$cat`; \
-	  lang=`echo $$cat | sed -e 's/\.gmo$$//'`; \
-	  dir=$(localedir)/$$lang/LC_MESSAGES; \
-	  $(mkinstalldirs) $(DESTDIR)$$dir; \
-	  for lc in '' $(EXTRA_LOCALE_CATEGORIES); do \
-	    if test -n "$$lc"; then \
-	      if (cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc 2>/dev/null) | grep ' -> ' >/dev/null; then \
-	        link=`cd $(DESTDIR)$(localedir)/$$lang && LC_ALL=C ls -l -d $$lc | sed -e 's/^.* -> //'`; \
-	        mv $(DESTDIR)$(localedir)/$$lang/$$lc $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
-	        mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
-	        (cd $(DESTDIR)$(localedir)/$$lang/$$lc.old && \
-	         for file in *; do \
-	           if test -f $$file; then \
-	             ln -s ../$$link/$$file $(DESTDIR)$(localedir)/$$lang/$$lc/$$file; \
-	           fi; \
-	         done); \
-	        rm -f $(DESTDIR)$(localedir)/$$lang/$$lc.old; \
-	      else \
-	        if test -d $(DESTDIR)$(localedir)/$$lang/$$lc; then \
-	          :; \
-	        else \
-	          rm -f $(DESTDIR)$(localedir)/$$lang/$$lc; \
-	          mkdir $(DESTDIR)$(localedir)/$$lang/$$lc; \
-	        fi; \
-	      fi; \
-	    fi; \
-	  done; \
-	done
-
-# Define this as empty until I found a useful application.
-installcheck:
-
-uninstall: uninstall-exec uninstall-data
-uninstall-exec:
-uninstall-data: uninstall-data- at USE_NLS@
-	if test "$(PACKAGE)" = "gettext-tools"; then \
-	  for file in $(DISTFILES.common) Makevars.template; do \
-	    rm -f $(DESTDIR)$(gettextsrcdir)/$$file; \
-	  done; \
-	else \
-	  : ; \
-	fi
-uninstall-data-no:
-uninstall-data-yes:
-	catalogs='$(CATALOGS)'; \
-	for cat in $$catalogs; do \
-	  cat=`basename $$cat`; \
-	  lang=`echo $$cat | sed -e 's/\.gmo$$//'`; \
-	  for lc in LC_MESSAGES $(EXTRA_LOCALE_CATEGORIES); do \
-	    rm -f $(DESTDIR)$(localedir)/$$lang/$$lc/$(DOMAIN).mo; \
-	  done; \
-	done
-
-check: all
-
-info dvi ps pdf html tags TAGS ctags CTAGS ID:
-
-mostlyclean:
-	rm -f remove-potcdate.sed
-	rm -f stamp-poT
-	rm -f core core.* $(DOMAIN).po $(DOMAIN).1po $(DOMAIN).2po *.new.po
-	rm -fr *.o
-
-clean: mostlyclean
-
-distclean: clean
-	rm -f Makefile Makefile.in POTFILES *.mo
-
-maintainer-clean: distclean
-	@echo "This command is intended for maintainers to use;"
-	@echo "it deletes files that may require special tools to rebuild."
-	rm -f stamp-po $(GMOFILES)
-
-distdir = $(top_builddir)/$(PACKAGE)-$(VERSION)/$(subdir)
-dist distdir:
-	$(MAKE) update-po
-	@$(MAKE) dist2
-# This is a separate target because 'update-po' must be executed before.
-dist2: stamp-po $(DISTFILES)
-	dists="$(DISTFILES)"; \
-	if test "$(PACKAGE)" = "gettext-tools"; then \
-	  dists="$$dists Makevars.template"; \
-	fi; \
-	if test -f $(srcdir)/$(DOMAIN).pot; then \
-	  dists="$$dists $(DOMAIN).pot stamp-po"; \
-	fi; \
-	if test -f $(srcdir)/ChangeLog; then \
-	  dists="$$dists ChangeLog"; \
-	fi; \
-	for i in 0 1 2 3 4 5 6 7 8 9; do \
-	  if test -f $(srcdir)/ChangeLog.$$i; then \
-	    dists="$$dists ChangeLog.$$i"; \
-	  fi; \
-	done; \
-	if test -f $(srcdir)/LINGUAS; then dists="$$dists LINGUAS"; fi; \
-	for file in $$dists; do \
-	  if test -f $$file; then \
-	    cp -p $$file $(distdir) || exit 1; \
-	  else \
-	    cp -p $(srcdir)/$$file $(distdir) || exit 1; \
-	  fi; \
-	done
-
-update-po: Makefile
-	$(MAKE) $(DOMAIN).pot-update
-	test -z "$(UPDATEPOFILES)" || $(MAKE) $(UPDATEPOFILES)
-	$(MAKE) update-gmo
-
-# General rule for creating PO files.
-
-.nop.po-create:
-	@lang=`echo $@ | sed -e 's/\.po-create$$//'`; \
-	echo "File $$lang.po does not exist. If you are a translator, you can create it through 'msginit'." 1>&2; \
-	exit 1
-
-# General rule for updating PO files.
-
-.nop.po-update:
-	@lang=`echo $@ | sed -e 's/\.po-update$$//'`; \
-	if test "$(PACKAGE)" = "gettext-tools"; then PATH=`pwd`/../src:$$PATH; fi; \
-	tmpdir=`pwd`; \
-	echo "$$lang:"; \
-	test "$(srcdir)" = . && cdcmd="" || cdcmd="cd $(srcdir) && "; \
-	echo "$${cdcmd}$(MSGMERGE) $$lang.po $(DOMAIN).pot -o $$lang.new.po"; \
-	cd $(srcdir); \
-	if $(MSGMERGE) $$lang.po $(DOMAIN).pot -o $$tmpdir/$$lang.new.po; then \
-	  if cmp $$lang.po $$tmpdir/$$lang.new.po >/dev/null 2>&1; then \
-	    rm -f $$tmpdir/$$lang.new.po; \
-	  else \
-	    if mv -f $$tmpdir/$$lang.new.po $$lang.po; then \
-	      :; \
-	    else \
-	      echo "msgmerge for $$lang.po failed: cannot move $$tmpdir/$$lang.new.po to $$lang.po" 1>&2; \
-	      exit 1; \
-	    fi; \
-	  fi; \
-	else \
-	  echo "msgmerge for $$lang.po failed!" 1>&2; \
-	  rm -f $$tmpdir/$$lang.new.po; \
-	fi
-
-$(DUMMYPOFILES):
-
-update-gmo: Makefile $(GMOFILES)
-	@:
-
-Makefile: Makefile.in.in Makevars ../config.status POTFILES.in
-	cd $(top_builddir) \
-	  && CONFIG_FILES=$(subdir)/$@.in CONFIG_HEADERS= \
-	       $(SHELL) ./config.status
-
-force:
-
-# Tell versions [3.59,3.63) of GNU make not to export all variables.
-# Otherwise a system limit (for SysV at least) may be exceeded.
-.NOEXPORT:

Added: trunk/po/Makefile.in.in
===================================================================
--- trunk/po/Makefile.in.in	2006-02-14 15:02:24 UTC (rev 109)
+++ trunk/po/Makefile.in.in	2006-02-15 12:55:04 UTC (rev 110)
@@ -0,0 +1,254 @@
+# Makefile for program source directory in GNU NLS utilities package.
+# Copyright (C) 1995, 1996, 1997 by Ulrich Drepper <drepper at gnu.ai.mit.edu>
+#
+# This file file be copied and used freely without restrictions.  It can
+# be used in projects which are not available under the GNU Public License
+# but which still want to provide support for the GNU gettext functionality.
+# Please note that the actual code is *not* freely available.
+#
+# - Modified by Owen Taylor <otaylor at redhat.com> to use GETTEXT_PACKAGE
+#   instead of PACKAGE and to look for po2tbl in ./ not in intl/
+#
+# - Modified by jacob berkman <jacob at ximian.com> to install
+#   Makefile.in.in and po2tbl.sed.in for use with glib-gettextize
+
+GETTEXT_PACKAGE = @GETTEXT_PACKAGE@
+PACKAGE = @PACKAGE@
+VERSION = @VERSION@
+
+SHELL = /bin/sh
+ at SET_MAKE@
+
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+VPATH = @srcdir@
+
+prefix = @prefix@
+exec_prefix = @exec_prefix@
+datadir = @datadir@
+libdir = @libdir@
+localedir = $(libdir)/locale
+gnulocaledir = $(datadir)/locale
+gettextsrcdir = $(datadir)/glib-2.0/gettext/po
+subdir = po
+
+INSTALL = @INSTALL@
+INSTALL_DATA = @INSTALL_DATA@
+MKINSTALLDIRS = $(top_srcdir)/@MKINSTALLDIRS@
+
+CC = @CC@
+GENCAT = @GENCAT@
+GMSGFMT = @GMSGFMT@
+MSGFMT = @MSGFMT@
+XGETTEXT = @XGETTEXT@
+MSGMERGE = msgmerge
+
+DEFS = @DEFS@
+CFLAGS = @CFLAGS@
+CPPFLAGS = @CPPFLAGS@
+
+INCLUDES = -I.. -I$(top_srcdir)/intl
+
+COMPILE = $(CC) -c $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CFLAGS) $(XCFLAGS)
+
+SOURCES = 
+POFILES = @POFILES@
+GMOFILES = @GMOFILES@
+DISTFILES = ChangeLog Makefile.in.in POTFILES.in $(GETTEXT_PACKAGE).pot \
+$(POFILES) $(GMOFILES) $(SOURCES)
+
+POTFILES = \
+
+CATALOGS = @CATALOGS@
+CATOBJEXT = @CATOBJEXT@
+INSTOBJEXT = @INSTOBJEXT@
+
+.SUFFIXES:
+.SUFFIXES: .c .o .po .pox .gmo .mo .msg .cat
+
+.c.o:
+	$(COMPILE) $<
+
+.po.pox:
+	$(MAKE) $(GETTEXT_PACKAGE).pot
+	$(MSGMERGE) $< $(srcdir)/$(GETTEXT_PACKAGE).pot -o $*.pox
+
+.po.mo:
+	$(MSGFMT) -o $@ $<
+
+.po.gmo:
+	file=$(srcdir)/`echo $* | sed 's,.*/,,'`.gmo \
+	  && rm -f $$file && $(GMSGFMT) -o $$file $<
+
+.po.cat:
+	sed -f ../intl/po2msg.sed < $< > $*.msg \
+	  && rm -f $@ && $(GENCAT) $@ $*.msg
+
+
+all: all- at USE_NLS@
+
+all-yes: $(CATALOGS)
+all-no:
+
+$(srcdir)/$(GETTEXT_PACKAGE).pot: $(POTFILES)
+	$(XGETTEXT) --default-domain=$(GETTEXT_PACKAGE) --directory=$(top_srcdir) \
+	  --add-comments --keyword=_ --keyword=N_ \
+	  --files-from=$(srcdir)/POTFILES.in \
+	&& test ! -f $(GETTEXT_PACKAGE).po \
+	   || ( rm -f $(srcdir)/$(GETTEXT_PACKAGE).pot \
+		&& mv $(GETTEXT_PACKAGE).po $(srcdir)/$(GETTEXT_PACKAGE).pot )
+
+install: install-exec install-data
+install-exec:
+install-data: install-data- at USE_NLS@
+install-data-no: all
+install-data-yes: all
+	if test -r "$(MKINSTALLDIRS)"; then \
+	  $(MKINSTALLDIRS) $(DESTDIR)$(datadir); \
+	else \
+	  $(SHELL) $(top_srcdir)/mkinstalldirs $(DESTDIR)$(datadir); \
+	fi
+	@catalogs='$(CATALOGS)'; \
+	for cat in $$catalogs; do \
+	  cat=`basename $$cat`; \
+	  case "$$cat" in \
+	    *.gmo) destdir=$(gnulocaledir);; \
+	    *)     destdir=$(localedir);; \
+	  esac; \
+	  lang=`echo $$cat | sed 's/\$(CATOBJEXT)$$//'`; \
+	  dir=$(DESTDIR)$$destdir/$$lang/LC_MESSAGES; \
+	  if test -r "$(MKINSTALLDIRS)"; then \
+	    $(MKINSTALLDIRS) $$dir; \
+	  else \
+	    $(SHELL) $(top_srcdir)/mkinstalldirs $$dir; \
+	  fi; \
+	  if test -r $$cat; then \
+	    $(INSTALL_DATA) $$cat $$dir/$(GETTEXT_PACKAGE)$(INSTOBJEXT); \
+	    echo "installing $$cat as $$dir/$(GETTEXT_PACKAGE)$(INSTOBJEXT)"; \
+	  else \
+	    $(INSTALL_DATA) $(srcdir)/$$cat $$dir/$(GETTEXT_PACKAGE)$(INSTOBJEXT); \
+	    echo "installing $(srcdir)/$$cat as" \
+		 "$$dir/$(GETTEXT_PACKAGE)$(INSTOBJEXT)"; \
+	  fi; \
+	  if test -r $$cat.m; then \
+	    $(INSTALL_DATA) $$cat.m $$dir/$(GETTEXT_PACKAGE)$(INSTOBJEXT).m; \
+	    echo "installing $$cat.m as $$dir/$(GETTEXT_PACKAGE)$(INSTOBJEXT).m"; \
+	  else \
+	    if test -r $(srcdir)/$$cat.m ; then \
+	      $(INSTALL_DATA) $(srcdir)/$$cat.m \
+		$$dir/$(GETTEXT_PACKAGE)$(INSTOBJEXT).m; \
+	      echo "installing $(srcdir)/$$cat as" \
+		   "$$dir/$(GETTEXT_PACKAGE)$(INSTOBJEXT).m"; \
+	    else \
+	      true; \
+	    fi; \
+	  fi; \
+	done
+	if test "$(PACKAGE)" = "glib"; then \
+	  if test -r "$(MKINSTALLDIRS)"; then \
+	    $(MKINSTALLDIRS) $(DESTDIR)$(gettextsrcdir); \
+	  else \
+	    $(SHELL) $(top_srcdir)/mkinstalldirs $(DESTDIR)$(gettextsrcdir); \
+	  fi; \
+	  $(INSTALL_DATA) $(srcdir)/Makefile.in.in \
+			  $(DESTDIR)$(gettextsrcdir)/Makefile.in.in; \
+	else \
+	  : ; \
+	fi
+
+# Define this as empty until I found a useful application.
+installcheck:
+
+uninstall:
+	catalogs='$(CATALOGS)'; \
+	for cat in $$catalogs; do \
+	  cat=`basename $$cat`; \
+	  lang=`echo $$cat | sed 's/\$(CATOBJEXT)$$//'`; \
+	  rm -f $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(GETTEXT_PACKAGE)$(INSTOBJEXT); \
+	  rm -f $(DESTDIR)$(localedir)/$$lang/LC_MESSAGES/$(GETTEXT_PACKAGE)$(INSTOBJEXT).m; \
+	  rm -f $(DESTDIR)$(gnulocaledir)/$$lang/LC_MESSAGES/$(GETTEXT_PACKAGE)$(INSTOBJEXT); \
+	  rm -f $(DESTDIR)$(gnulocaledir)/$$lang/LC_MESSAGES/$(GETTEXT_PACKAGE)$(INSTOBJEXT).m; \
+	done
+	if test "$(PACKAGE)" = "glib"; then \
+	  rm -f $(DESTDIR)$(gettextsrcdir)/Makefile.in.in; \
+	fi
+
+check: all
+
+dvi info tags TAGS ID:
+
+mostlyclean:
+	rm -f core core.* *.pox $(GETTEXT_PACKAGE).po *.old.po cat-id-tbl.tmp
+	rm -fr *.o
+
+clean: mostlyclean
+
+distclean: clean
+	rm -f Makefile Makefile.in POTFILES *.mo *.msg *.cat *.cat.m
+
+maintainer-clean: distclean
+	@echo "This command is intended for maintainers to use;"
+	@echo "it deletes files that may require special tools to rebuild."
+	rm -f $(GMOFILES)
+
+distdir = ../$(GETTEXT_PACKAGE)-$(VERSION)/$(subdir)
+dist distdir: update-po $(DISTFILES)
+	dists="$(DISTFILES)"; \
+	for file in $$dists; do \
+	  ln $(srcdir)/$$file $(distdir) 2> /dev/null \
+	    || cp -p $(srcdir)/$$file $(distdir); \
+	done
+
+update-po: Makefile
+	$(MAKE) $(GETTEXT_PACKAGE).pot
+	tmpdir=`pwd`; \
+	cd $(srcdir); \
+	catalogs='$(CATALOGS)'; \
+	for cat in $$catalogs; do \
+	  cat=`basename $$cat`; \
+	  lang=`echo $$cat | sed 's/\$(CATOBJEXT)$$//'`; \
+	  echo "$$lang:"; \
+	  if $(MSGMERGE) $$lang.po $(GETTEXT_PACKAGE).pot -o $$tmpdir/$$lang.new.po; then \
+	    if cmp $$lang.po $$tmpdir/$$lang.new.po >/dev/null 2>&1; then \
+	      rm -f $$tmpdir/$$lang.new.po; \
+            else \
+	      if mv -f $$tmpdir/$$lang.new.po $$lang.po; then \
+	        :; \
+	      else \
+	        echo "msgmerge for $$lang.po failed: cannot move $$tmpdir/$$lang.new.po to $$lang.po" 1>&2; \
+	        rm -f $$tmpdir/$$lang.new.po; \
+	        exit 1; \
+	      fi; \
+	    fi; \
+	  else \
+	    echo "msgmerge for $$cat failed!"; \
+	    rm -f $$tmpdir/$$lang.new.po; \
+	  fi; \
+	done
+
+# POTFILES is created from POTFILES.in by stripping comments, empty lines
+# and Intltool tags (enclosed in square brackets), and appending a full
+# relative path to them
+POTFILES: POTFILES.in
+	( if test 'x$(srcdir)' != 'x.'; then \
+	    posrcprefix='$(top_srcdir)/'; \
+	  else \
+	    posrcprefix="../"; \
+	  fi; \
+	  rm -f $@-t $@ \
+	    && (sed -e '/^#/d' 						\
+		    -e "s/^\[.*\] +//" 					\
+		    -e '/^[ 	]*$$/d' 				\
+		    -e "s at .*@	$$posrcprefix& \\\\@" < $(srcdir)/$@.in	\
+		| sed -e '$$s/\\$$//') > $@-t \
+	    && chmod a-w $@-t \
+	    && mv $@-t $@ )
+
+Makefile: Makefile.in.in ../config.status POTFILES
+	cd .. \
+	  && CONFIG_FILES=$(subdir)/$@.in CONFIG_HEADERS= \
+	       $(SHELL) ./config.status
+
+# Tell versions [3.59,3.63) of GNU make not to export all variables.
+# Otherwise a system limit (for SysV at least) may be exceeded.
+.NOEXPORT:

Modified: trunk/po/es_ES.po
===================================================================
--- trunk/po/es_ES.po	2006-02-14 15:02:24 UTC (rev 109)
+++ trunk/po/es_ES.po	2006-02-15 12:55:04 UTC (rev 110)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.42\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-01-26 10:20+0800\n"
+"POT-Creation-Date: 2006-02-15 20:55+0800\n"
 "PO-Revision-Date: 2006-01-30 16:44+0800\n"
 "Last-Translator: Jes?s Tramullas <jesus at tramullas.com>\n"
 "Language-Team: es_ES <jesus at tramullas.com>\n"
@@ -24,17 +24,23 @@
 msgid "Current User"
 msgstr "Usuario"
 
-#: UI/GTK2/src/EnginesTree.cpp:303 UI/GTK2/src/mainWindow.cc:344
-#: UI/GTK2/src/mainWindow.cc:347 UI/GTK2/src/mainWindow.cc:520
-#: UI/GTK2/src/mainWindow.cc:1055 UI/GTK2/src/mainWindow.cc:1139
-#: UI/GTK2/src/mainWindow.cc:1174 UI/GTK2/src/mainWindow.cc:1787
+#. Populate the submenu
+#. Bind the callback's parameter to the index name
+#. Enable these menu items, unless the index is not the documents index
+#. Internal indices
+#: UI/GTK2/src/EnginesTree.cpp:303 UI/GTK2/src/mainWindow.cc:340
+#: UI/GTK2/src/mainWindow.cc:343 UI/GTK2/src/mainWindow.cc:516
+#: UI/GTK2/src/mainWindow.cc:1051 UI/GTK2/src/mainWindow.cc:1135
+#: UI/GTK2/src/mainWindow.cc:1170 UI/GTK2/src/mainWindow.cc:1783
 #: UI/GTK2/src/PinotSettings.cpp:199 UI/GTK2/src/PinotSettings.cpp:881
 #: UI/GTK2/src/PinotSettings.cpp:937
 msgid "My Documents"
 msgstr "Mis documentos"
 
-#: UI/GTK2/src/EnginesTree.cpp:307 UI/GTK2/src/mainWindow.cc:350
-#: UI/GTK2/src/mainWindow.cc:353 UI/GTK2/src/mainWindow.cc:524
+#. Bind the callback's parameter to the index name
+#. Signal
+#: UI/GTK2/src/EnginesTree.cpp:307 UI/GTK2/src/mainWindow.cc:346
+#: UI/GTK2/src/mainWindow.cc:349 UI/GTK2/src/mainWindow.cc:520
 #: UI/GTK2/src/MonitorHandler.cpp:173 UI/GTK2/src/PinotSettings.cpp:200
 #: UI/GTK2/src/PinotSettings.cpp:882 UI/GTK2/src/PinotSettings.cpp:938
 #: UI/GTK2/src/prefsDialog_glade.cc:116
@@ -57,6 +63,7 @@
 msgid "Directory"
 msgstr "Directorio"
 
+#. The last column is for the URL
 #: UI/GTK2/src/importDialog.cc:142 UI/GTK2/src/IndexTree.cpp:70
 #: UI/GTK2/src/ResultsTree.cpp:114
 msgid "URL"
@@ -129,6 +136,8 @@
 msgid "External index"
 msgstr "?ndice externo"
 
+#. The score column is used for status icons
+#. The title column is also used for status icons
 #: UI/GTK2/src/IndexTree.cpp:64 UI/GTK2/src/ResultsTree.cpp:96
 msgid "Title"
 msgstr "T?tulo"
@@ -145,236 +154,255 @@
 msgid "Show Next"
 msgstr "Mostrar siguientes"
 
-#: UI/GTK2/src/mainWindow.cc:148
+#: UI/GTK2/src/mainWindow.cc:144
 msgid "Query Name"
 msgstr "Nombre de la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:153
+#: UI/GTK2/src/mainWindow.cc:149
 msgid "Last Run"
 msgstr "?ltima ejecuci?n"
 
-#: UI/GTK2/src/mainWindow.cc:154
+#: UI/GTK2/src/mainWindow.cc:150
 msgid "Summary"
 msgstr "Sumario"
 
-#: UI/GTK2/src/mainWindow.cc:211
+#. Set tooltips
+#: UI/GTK2/src/mainWindow.cc:207
 msgid "Add index"
 msgstr "A?adir ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:212
+#: UI/GTK2/src/mainWindow.cc:208
 msgid "Remove index"
 msgstr "Borrar ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:235
+#. The handler object will be deleted when the thread terminates
+#. Now we are ready
+#: UI/GTK2/src/mainWindow.cc:231
 msgid "Ready"
 msgstr "Listo"
 
-#: UI/GTK2/src/mainWindow.cc:249 UI/GTK2/src/mainWindow.cc:1012
-#: UI/GTK2/src/mainWindow.cc:1384 UI/GTK2/src/mainWindow.cc:2956
+#. Stop in case we were loading a page
+#. Close the existing view page
+#: UI/GTK2/src/mainWindow.cc:245 UI/GTK2/src/mainWindow.cc:1008
+#: UI/GTK2/src/mainWindow.cc:1380 UI/GTK2/src/mainWindow.cc:2953
 #: UI/GTK2/src/mainWindow_glade.cc:207
 msgid "View"
 msgstr "Ver"
 
-#: UI/GTK2/src/mainWindow.cc:281
+#: UI/GTK2/src/mainWindow.cc:277
 msgid "N/A"
 msgstr "Desconocido"
 
-#: UI/GTK2/src/mainWindow.cc:291
+#: UI/GTK2/src/mainWindow.cc:287
 msgid "<undefined>"
 msgstr "<indefinido>"
 
-#: UI/GTK2/src/mainWindow.cc:482
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:478
 msgid "Result location is"
 msgstr "La localizaci?n del resultado es"
 
-#: UI/GTK2/src/mainWindow.cc:535
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:531
 msgid "Document location is"
 msgstr "La localizaci?n del documento es"
 
-#: UI/GTK2/src/mainWindow.cc:644
+#. User selected no label
+#: UI/GTK2/src/mainWindow.cc:640
 msgid "No label"
 msgstr "Sin etiqueta"
 
-#: UI/GTK2/src/mainWindow.cc:793
+#: UI/GTK2/src/mainWindow.cc:789
 msgid "Showing"
 msgstr "Mostrando"
 
-#: UI/GTK2/src/mainWindow.cc:798
+#: UI/GTK2/src/mainWindow.cc:794
 msgid "off"
 msgstr "desactivado"
 
-#: UI/GTK2/src/mainWindow.cc:803
+#: UI/GTK2/src/mainWindow.cc:799
 msgid "documents, starting at"
 msgstr "documentos comenzando en"
 
-#: UI/GTK2/src/mainWindow.cc:837
+#: UI/GTK2/src/mainWindow.cc:833
 msgid "Query"
 msgstr "B?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:841 UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:837 UI/GTK2/src/mainWindow.cc:2782
 msgid "on"
 msgstr "en"
 
-#: UI/GTK2/src/mainWindow.cc:845
+#: UI/GTK2/src/mainWindow.cc:841
 msgid "ended"
 msgstr "finalizado"
 
-#: UI/GTK2/src/mainWindow.cc:946 UI/GTK2/src/propertiesDialog.cc:40
+#: UI/GTK2/src/mainWindow.cc:942 UI/GTK2/src/propertiesDialog.cc:40
 msgid "Label"
 msgstr "Etiqueta"
 
-#: UI/GTK2/src/mainWindow.cc:950
+#: UI/GTK2/src/mainWindow.cc:946
 msgid "matches"
 msgstr "correspondencias"
 
-#: UI/GTK2/src/mainWindow.cc:955
+#: UI/GTK2/src/mainWindow.cc:951
 msgid "document(s)"
 msgstr "documento(s)"
 
-#: UI/GTK2/src/mainWindow.cc:987
+#: UI/GTK2/src/mainWindow.cc:983
 msgid "Updated label(s)"
 msgstr "Etiqueta(s) actualizada(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1065 UI/GTK2/src/mainWindow.cc:1185
+#. Yes, it did
+#: UI/GTK2/src/mainWindow.cc:1061 UI/GTK2/src/mainWindow.cc:1181
 msgid "Updated document"
 msgstr "Documento actualizado"
 
-#: UI/GTK2/src/mainWindow.cc:1078
+#: UI/GTK2/src/mainWindow.cc:1074
 msgid "Indexed"
 msgstr "Indizado"
 
-#: UI/GTK2/src/mainWindow.cc:1140
+#: UI/GTK2/src/mainWindow.cc:1136
 msgid "Unindexed document(s)"
 msgstr "Documento(s) no indizado(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1236
+#: UI/GTK2/src/mainWindow.cc:1232
 msgid "Couldn't rename index, name"
 msgstr "No se podu renombrar el ?ndice, nombre"
 
-#: UI/GTK2/src/mainWindow.cc:1240 UI/GTK2/src/mainWindow.cc:2141
-#: UI/GTK2/src/mainWindow.cc:2620
+#: UI/GTK2/src/mainWindow.cc:1236 UI/GTK2/src/mainWindow.cc:2137
+#: UI/GTK2/src/mainWindow.cc:2616
 msgid "is already in use"
 msgstr "ya est? en uso"
 
-#: UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1249
 msgid "Couldn't rename index"
 msgstr "No se pudo renombrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1266
+#: UI/GTK2/src/mainWindow.cc:1262
 msgid "Edited index"
 msgstr "?ndice editado"
 
-#: UI/GTK2/src/mainWindow.cc:1726 UI/GTK2/src/mainWindow.cc:1829
+#: UI/GTK2/src/mainWindow.cc:1722 UI/GTK2/src/mainWindow.cc:1825
 msgid "Please set a location for the index first"
 msgstr "Por favor, primero fije una localizaci?n para el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1753
+#: UI/GTK2/src/mainWindow.cc:1749
 msgid "Result location is unknown"
 msgstr "Se desconoce la localizaci?n del resultado"
 
-#: UI/GTK2/src/mainWindow.cc:1777
+#: UI/GTK2/src/mainWindow.cc:1773
 msgid "Import Document(s)"
 msgstr "Importar Documento(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1907 UI/GTK2/src/pinot.cc:148
-#: UI/GTK2/src/pinot.cc:153 UI/GTK2/src/WorkerThreads.cpp:371
-#: UI/GTK2/src/WorkerThreads.cpp:608 UI/GTK2/src/WorkerThreads.cpp:1221
+#: UI/GTK2/src/mainWindow.cc:1903 UI/GTK2/src/pinot.cc:149
+#: UI/GTK2/src/pinot.cc:154 UI/GTK2/src/WorkerThreads.cpp:393
+#: UI/GTK2/src/WorkerThreads.cpp:620 UI/GTK2/src/WorkerThreads.cpp:1208
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:1911 UI/GTK2/src/WorkerThreads.cpp:375
-#: UI/GTK2/src/WorkerThreads.cpp:612 UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/mainWindow.cc:1907 UI/GTK2/src/WorkerThreads.cpp:397
+#: UI/GTK2/src/WorkerThreads.cpp:624 UI/GTK2/src/WorkerThreads.cpp:1212
 msgid "doesn't exist"
 msgstr "no existe"
 
-#: UI/GTK2/src/mainWindow.cc:2021
+#: UI/GTK2/src/mainWindow.cc:2017
 msgid "Delete this document from the index ?"
 msgstr "Enlever ce document de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2040
+#: UI/GTK2/src/mainWindow.cc:2036
 msgid "Delete these documents from the index ?"
 msgstr "?Borrar este documento del ?ndice?"
 
-#: UI/GTK2/src/mainWindow.cc:2092
+#: UI/GTK2/src/mainWindow.cc:2088
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Una herramienta metabuscador para el escritorio libre"
 
-#: UI/GTK2/src/mainWindow.cc:2093
+#: UI/GTK2/src/mainWindow.cc:2089
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2137
+#: UI/GTK2/src/mainWindow.cc:2133
 msgid "Index name"
 msgstr "Nombre del ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2152
+#: UI/GTK2/src/mainWindow.cc:2148
 msgid "Couldn't add index"
 msgstr "No se pudo a?adir el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2166
+#: UI/GTK2/src/mainWindow.cc:2162
 msgid "Added new index"
 msgstr "A?adido un nuevo ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2201
+#: UI/GTK2/src/mainWindow.cc:2197
 msgid "Couldn't remove index"
 msgstr "No se pudo borrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2435
+#: UI/GTK2/src/mainWindow.cc:2278
+#, fuzzy
+msgid "Live query"
+msgstr "B?squeda editada"
+
+#: UI/GTK2/src/mainWindow.cc:2431
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Al menos una tarea no ha finalizado. ?Parar ahora?"
 
-#: UI/GTK2/src/mainWindow.cc:2616
+#: UI/GTK2/src/mainWindow.cc:2612
 msgid "Query name"
 msgstr "Nombre la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2643
+#: UI/GTK2/src/mainWindow.cc:2639
 msgid "Couldn't update query"
 msgstr "No se pudo actualizar la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2651
+#: UI/GTK2/src/mainWindow.cc:2647
 msgid "Edited query"
 msgstr "B?squeda editada"
 
-#: UI/GTK2/src/mainWindow.cc:2658
+#: UI/GTK2/src/mainWindow.cc:2654
 msgid "Couldn't add query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2666
+#: UI/GTK2/src/mainWindow.cc:2662
 msgid "Added new query"
 msgstr "A?adida una nueva b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2680
+#: UI/GTK2/src/mainWindow.cc:2676
 msgid "Query is not set"
 msgstr "B?squeda no definida"
 
-#: UI/GTK2/src/mainWindow.cc:2691
+#: UI/GTK2/src/mainWindow.cc:2687
 msgid "No search engine selected"
 msgstr "Motor de b?squeda no seleccionado"
 
-#: UI/GTK2/src/mainWindow.cc:2773
+#: UI/GTK2/src/mainWindow.cc:2769
 msgid "Please set the Google API key first"
 msgstr "Por favor, primero configure el API de Google"
 
-#: UI/GTK2/src/mainWindow.cc:2782
+#: UI/GTK2/src/mainWindow.cc:2778
 msgid "Running query"
 msgstr "Ejecutando la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2887
+#: UI/GTK2/src/mainWindow.cc:2884
 msgid "is already indexed or is being indexed"
 msgstr "ya ha sido indizado, o se est? indizando"
 
-#: UI/GTK2/src/mainWindow.cc:2914
+#: UI/GTK2/src/mainWindow.cc:2911
 msgid "No URL to browse"
 msgstr "No hay URL que mostrar"
 
-#: UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:2922
 msgid "No browser configured to view results"
 msgstr "NO ha configurado un navegador para ver los resultados"
 
-#: UI/GTK2/src/mainWindow.cc:2937
+#: UI/GTK2/src/mainWindow.cc:2934
 msgid "Couldn't browse URL:"
 msgstr "No se pudo mostrar el URL:"
 
+#: UI/GTK2/src/mainWindow.cc:2993
+#, fuzzy
+msgid "Viewing"
+msgstr "Ver"
+
 #: UI/GTK2/src/mainWindow_glade.cc:115
 msgid "Query:"
 msgstr "B?squeda:"
@@ -465,63 +493,64 @@
 msgid "Couldn't save configuration file"
 msgstr "No se pudo guardar el fichero de configuraci?n"
 
-#: UI/GTK2/src/pinot.cc:117
+#. Localize language names
+#: UI/GTK2/src/pinot.cc:118
 msgid "Danish"
 msgstr "Dan?s"
 
-#: UI/GTK2/src/pinot.cc:118
+#: UI/GTK2/src/pinot.cc:119
 msgid "Dutch"
 msgstr "Holand?s"
 
-#: UI/GTK2/src/pinot.cc:119
+#: UI/GTK2/src/pinot.cc:120
 msgid "English"
 msgstr "Ingl?s"
 
-#: UI/GTK2/src/pinot.cc:120
+#: UI/GTK2/src/pinot.cc:121
 msgid "Finnish"
 msgstr "Finland?s"
 
-#: UI/GTK2/src/pinot.cc:121
+#: UI/GTK2/src/pinot.cc:122
 msgid "French"
 msgstr "Franc?s"
 
-#: UI/GTK2/src/pinot.cc:122
+#: UI/GTK2/src/pinot.cc:123
 msgid "German"
 msgstr "Alem?n"
 
-#: UI/GTK2/src/pinot.cc:123
+#: UI/GTK2/src/pinot.cc:124
 msgid "Italian"
 msgstr "Italiano"
 
-#: UI/GTK2/src/pinot.cc:124
+#: UI/GTK2/src/pinot.cc:125
 msgid "Norwegian"
 msgstr "Noruego"
 
-#: UI/GTK2/src/pinot.cc:125
+#: UI/GTK2/src/pinot.cc:126
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:126
+#: UI/GTK2/src/pinot.cc:127
 msgid "Russian"
 msgstr "Ruso"
 
-#: UI/GTK2/src/pinot.cc:127
+#: UI/GTK2/src/pinot.cc:128
 msgid "Spanish"
 msgstr "Espa?ol"
 
-#: UI/GTK2/src/pinot.cc:128
+#: UI/GTK2/src/pinot.cc:129
 msgid "Swedish"
 msgstr "Sueco"
 
-#: UI/GTK2/src/pinot.cc:149 UI/GTK2/src/pinot.cc:154
+#: UI/GTK2/src/pinot.cc:150 UI/GTK2/src/pinot.cc:155
 msgid "is not valid, please check"
 msgstr "no es v?lido, por favor compru?belo"
 
-#: UI/GTK2/src/pinot.cc:162
+#: UI/GTK2/src/pinot.cc:163
 msgid "History database"
 msgstr "Base de datos del hist?rico"
 
-#: UI/GTK2/src/pinot.cc:163
+#: UI/GTK2/src/pinot.cc:164
 msgid "couldn't be created"
 msgstr "no se pudo crear"
 
@@ -605,6 +634,7 @@
 msgid "Colour"
 msgstr "Color"
 
+#. Let the user edit the location
 #: UI/GTK2/src/prefsDialog.cc:436 UI/GTK2/src/prefsDialog.cc:470
 msgid "Mbox File Location"
 msgstr "Localizaci?n del fichero mbox"
@@ -729,113 +759,114 @@
 msgid "Query properties"
 msgstr "Propriedades de la b?squeda"
 
-#: UI/GTK2/src/WorkerThreads.cpp:350
+#: UI/GTK2/src/WorkerThreads.cpp:372
 msgid "Stopped browsing"
 msgstr "Exploraci?n detenida"
 
-#: UI/GTK2/src/WorkerThreads.cpp:384 UI/GTK2/src/WorkerThreads.cpp:620
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:675
-#: UI/GTK2/src/WorkerThreads.cpp:891 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1234
+#: UI/GTK2/src/WorkerThreads.cpp:406 UI/GTK2/src/WorkerThreads.cpp:632
+#: UI/GTK2/src/WorkerThreads.cpp:672 UI/GTK2/src/WorkerThreads.cpp:682
+#: UI/GTK2/src/WorkerThreads.cpp:888 UI/GTK2/src/WorkerThreads.cpp:1098
+#: UI/GTK2/src/WorkerThreads.cpp:1221
 msgid "Index error on"
 msgstr "Error en el ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:490
+#: UI/GTK2/src/WorkerThreads.cpp:507
 msgid "Stopped querying"
 msgstr "B?squeda detenida"
 
-#: UI/GTK2/src/WorkerThreads.cpp:502
+#: UI/GTK2/src/WorkerThreads.cpp:519
 msgid "Couldn't create search engine"
 msgstr "No se pudo crear el motor de b?squeda"
 
-#: UI/GTK2/src/WorkerThreads.cpp:514
+#: UI/GTK2/src/WorkerThreads.cpp:531
 msgid "Couldn't run query on search engine"
 msgstr "No se pudo ejecutar la b?squeda contra el motor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:530
+#: UI/GTK2/src/WorkerThreads.cpp:547
 msgid "No title"
 msgstr "Sin t?tulo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:592 UI/GTK2/src/WorkerThreads.cpp:656
+#: UI/GTK2/src/WorkerThreads.cpp:604 UI/GTK2/src/WorkerThreads.cpp:663
 msgid "Stopped querying index labels"
 msgstr "Detenida la b?squeda de etiquetas de ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:746
+#: UI/GTK2/src/WorkerThreads.cpp:748
 msgid "Stopped retrieval of"
 msgstr "Detenida la recuperaci?n de"
 
-#: UI/GTK2/src/WorkerThreads.cpp:782
+#: UI/GTK2/src/WorkerThreads.cpp:784
 msgid "Couldn't obtain downloader for protocol"
 msgstr "No se pudo usar un recuperador para el protocolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:905
+#: UI/GTK2/src/WorkerThreads.cpp:798 UI/GTK2/src/WorkerThreads.cpp:902
 msgid "Couldn't retrieve"
 msgstr "No se pudo descargar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:876
+#: UI/GTK2/src/WorkerThreads.cpp:873
 msgid "Stopped indexing"
 msgstr "Detenida la indizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:929
+#: UI/GTK2/src/WorkerThreads.cpp:926
 msgid "Cannot index document type"
 msgstr "No se pudo indizar el tipo de documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:933
+#: UI/GTK2/src/WorkerThreads.cpp:930
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:958
+#: UI/GTK2/src/WorkerThreads.cpp:955
 msgid "Couldn't tokenize"
 msgstr "No se pudo parcourir"
 
-#: UI/GTK2/src/WorkerThreads.cpp:979
+#: UI/GTK2/src/WorkerThreads.cpp:976
 msgid "Robots META tag forbids indexing"
 msgstr "La etiqueta META Robots proh?be la indizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1029
+#: UI/GTK2/src/WorkerThreads.cpp:1026
 msgid "Couldn't index"
 msgstr "No se pudo indizar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1094
+#: UI/GTK2/src/WorkerThreads.cpp:1086
 msgid "Stopped unindexing document(s)"
 msgstr "Detenida la desindizaci?n de documento(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1114
+#. Be pessimistic and assume something will go wrong ;-)
+#: UI/GTK2/src/WorkerThreads.cpp:1106
 msgid "Couldn't unindex document(s)"
 msgstr "No se pudo desindizar lo(s) documento(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1206
+#: UI/GTK2/src/WorkerThreads.cpp:1193
 msgid "Stopped document update for "
 msgstr "Detenida la actualizaci?n del documento por "
 
-#: UI/GTK2/src/WorkerThreads.cpp:1243
+#: UI/GTK2/src/WorkerThreads.cpp:1230
 msgid "Couldn't update document"
 msgstr "No se pudo actualizar el documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1293
+#: UI/GTK2/src/WorkerThreads.cpp:1275
 msgid "Stopped listening on"
 msgstr "Detenida la escucha en"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1396
+#: UI/GTK2/src/WorkerThreads.cpp:1378
 msgid "Couldn't read FIFO at"
 msgstr "No se pudo leer FIFO en"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1446
+#: UI/GTK2/src/WorkerThreads.cpp:1423
 msgid "Stopped monitoring"
 msgstr "Detenida la monitorizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1467
+#: UI/GTK2/src/WorkerThreads.cpp:1444
 msgid "No monitoring handler"
 msgstr "No hay monitorizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1514
+#: UI/GTK2/src/WorkerThreads.cpp:1491
 msgid "Couldn't open FAM connection"
 msgstr "No se pudo abrir la conexi?n FAM"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1724
+#: UI/GTK2/src/WorkerThreads.cpp:1696
 msgid "Stopped scanning"
 msgstr "Detenida la exploraci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1882
+#: UI/GTK2/src/WorkerThreads.cpp:1854
 msgid "Couldn't open directory"
 msgstr "No se pudo abrir el directorio"

Modified: trunk/po/fr_FR.po
===================================================================
--- trunk/po/fr_FR.po	2006-02-14 15:02:24 UTC (rev 109)
+++ trunk/po/fr_FR.po	2006-02-15 12:55:04 UTC (rev 110)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.42\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2005-12-08 19:20+0800\n"
+"POT-Creation-Date: 2006-02-15 20:55+0800\n"
 "PO-Revision-Date: 2006-01-20 19:44+0800\n"
 "Last-Translator: Fabrice Colin <colinf at chez.com>\n"
 "Language-Team: en_GB <colinf at chez.com>\n"
@@ -24,17 +24,23 @@
 msgid "Current User"
 msgstr "Utilisateur"
 
-#: UI/GTK2/src/EnginesTree.cpp:303 UI/GTK2/src/mainWindow.cc:344
-#: UI/GTK2/src/mainWindow.cc:347 UI/GTK2/src/mainWindow.cc:520
-#: UI/GTK2/src/mainWindow.cc:1055 UI/GTK2/src/mainWindow.cc:1139
-#: UI/GTK2/src/mainWindow.cc:1174 UI/GTK2/src/mainWindow.cc:1787
+#. Populate the submenu
+#. Bind the callback's parameter to the index name
+#. Enable these menu items, unless the index is not the documents index
+#. Internal indices
+#: UI/GTK2/src/EnginesTree.cpp:303 UI/GTK2/src/mainWindow.cc:340
+#: UI/GTK2/src/mainWindow.cc:343 UI/GTK2/src/mainWindow.cc:516
+#: UI/GTK2/src/mainWindow.cc:1051 UI/GTK2/src/mainWindow.cc:1135
+#: UI/GTK2/src/mainWindow.cc:1170 UI/GTK2/src/mainWindow.cc:1783
 #: UI/GTK2/src/PinotSettings.cpp:199 UI/GTK2/src/PinotSettings.cpp:881
 #: UI/GTK2/src/PinotSettings.cpp:937
 msgid "My Documents"
 msgstr "Mes Documents"
 
-#: UI/GTK2/src/EnginesTree.cpp:307 UI/GTK2/src/mainWindow.cc:350
-#: UI/GTK2/src/mainWindow.cc:353 UI/GTK2/src/mainWindow.cc:524
+#. Bind the callback's parameter to the index name
+#. Signal
+#: UI/GTK2/src/EnginesTree.cpp:307 UI/GTK2/src/mainWindow.cc:346
+#: UI/GTK2/src/mainWindow.cc:349 UI/GTK2/src/mainWindow.cc:520
 #: UI/GTK2/src/MonitorHandler.cpp:173 UI/GTK2/src/PinotSettings.cpp:200
 #: UI/GTK2/src/PinotSettings.cpp:882 UI/GTK2/src/PinotSettings.cpp:938
 #: UI/GTK2/src/prefsDialog_glade.cc:116
@@ -57,6 +63,7 @@
 msgid "Directory"
 msgstr "Repertoire"
 
+#. The last column is for the URL
 #: UI/GTK2/src/importDialog.cc:142 UI/GTK2/src/IndexTree.cpp:70
 #: UI/GTK2/src/ResultsTree.cpp:114
 msgid "URL"
@@ -129,6 +136,8 @@
 msgid "External index"
 msgstr "Index externe"
 
+#. The score column is used for status icons
+#. The title column is also used for status icons
 #: UI/GTK2/src/IndexTree.cpp:64 UI/GTK2/src/ResultsTree.cpp:96
 msgid "Title"
 msgstr "Titre"
@@ -145,236 +154,255 @@
 msgid "Show Next"
 msgstr "Suivants"
 
-#: UI/GTK2/src/mainWindow.cc:148
+#: UI/GTK2/src/mainWindow.cc:144
 msgid "Query Name"
 msgstr "Nom de la Recherche"
 
-#: UI/GTK2/src/mainWindow.cc:153
+#: UI/GTK2/src/mainWindow.cc:149
 msgid "Last Run"
 msgstr "Derniere Utilisation"
 
-#: UI/GTK2/src/mainWindow.cc:154
+#: UI/GTK2/src/mainWindow.cc:150
 msgid "Summary"
 msgstr "Sommaire"
 
-#: UI/GTK2/src/mainWindow.cc:211
+#. Set tooltips
+#: UI/GTK2/src/mainWindow.cc:207
 msgid "Add index"
 msgstr "Ajouter un index"
 
-#: UI/GTK2/src/mainWindow.cc:212
+#: UI/GTK2/src/mainWindow.cc:208
 msgid "Remove index"
 msgstr "Enlever un index"
 
-#: UI/GTK2/src/mainWindow.cc:235
+#. The handler object will be deleted when the thread terminates
+#. Now we are ready
+#: UI/GTK2/src/mainWindow.cc:231
 msgid "Ready"
 msgstr "Pret"
 
-#: UI/GTK2/src/mainWindow.cc:249 UI/GTK2/src/mainWindow.cc:1012
-#: UI/GTK2/src/mainWindow.cc:1384 UI/GTK2/src/mainWindow.cc:2956
+#. Stop in case we were loading a page
+#. Close the existing view page
+#: UI/GTK2/src/mainWindow.cc:245 UI/GTK2/src/mainWindow.cc:1008
+#: UI/GTK2/src/mainWindow.cc:1380 UI/GTK2/src/mainWindow.cc:2953
 #: UI/GTK2/src/mainWindow_glade.cc:207
 msgid "View"
 msgstr "Voir"
 
-#: UI/GTK2/src/mainWindow.cc:281
+#: UI/GTK2/src/mainWindow.cc:277
 msgid "N/A"
 msgstr "Inconnue"
 
-#: UI/GTK2/src/mainWindow.cc:291
+#: UI/GTK2/src/mainWindow.cc:287
 msgid "<undefined>"
 msgstr "<inconnu>"
 
-#: UI/GTK2/src/mainWindow.cc:482
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:478
 msgid "Result location is"
 msgstr "La location du resultat est"
 
-#: UI/GTK2/src/mainWindow.cc:535
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:531
 msgid "Document location is"
 msgstr "La location du document is"
 
-#: UI/GTK2/src/mainWindow.cc:644
+#. User selected no label
+#: UI/GTK2/src/mainWindow.cc:640
 msgid "No label"
 msgstr "Pas d'etiquette"
 
-#: UI/GTK2/src/mainWindow.cc:793
+#: UI/GTK2/src/mainWindow.cc:789
 msgid "Showing"
 msgstr "Listant"
 
-#: UI/GTK2/src/mainWindow.cc:798
+#: UI/GTK2/src/mainWindow.cc:794
 msgid "off"
 msgstr "de"
 
-#: UI/GTK2/src/mainWindow.cc:803
+#: UI/GTK2/src/mainWindow.cc:799
 msgid "documents, starting at"
 msgstr "documents venant de"
 
-#: UI/GTK2/src/mainWindow.cc:837
+#: UI/GTK2/src/mainWindow.cc:833
 msgid "Query"
 msgstr "La recherche"
 
-#: UI/GTK2/src/mainWindow.cc:841 UI/GTK2/src/mainWindow.cc:2786
+#: UI/GTK2/src/mainWindow.cc:837 UI/GTK2/src/mainWindow.cc:2782
 msgid "on"
 msgstr "sur"
 
-#: UI/GTK2/src/mainWindow.cc:845
+#: UI/GTK2/src/mainWindow.cc:841
 msgid "ended"
 msgstr "est terminee"
 
-#: UI/GTK2/src/mainWindow.cc:946 UI/GTK2/src/propertiesDialog.cc:40
+#: UI/GTK2/src/mainWindow.cc:942 UI/GTK2/src/propertiesDialog.cc:40
 msgid "Label"
 msgstr "L'etiquette"
 
-#: UI/GTK2/src/mainWindow.cc:950
+#: UI/GTK2/src/mainWindow.cc:946
 msgid "matches"
 msgstr "correspond a"
 
-#: UI/GTK2/src/mainWindow.cc:955
+#: UI/GTK2/src/mainWindow.cc:951
 msgid "document(s)"
 msgstr "document(s)"
 
-#: UI/GTK2/src/mainWindow.cc:987
+#: UI/GTK2/src/mainWindow.cc:983
 msgid "Updated label(s)"
 msgstr "Mis a jour l(es) etiquette(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1065 UI/GTK2/src/mainWindow.cc:1185
+#. Yes, it did
+#: UI/GTK2/src/mainWindow.cc:1061 UI/GTK2/src/mainWindow.cc:1181
 msgid "Updated document"
 msgstr "Mis a jour le document"
 
-#: UI/GTK2/src/mainWindow.cc:1078
+#: UI/GTK2/src/mainWindow.cc:1074
 msgid "Indexed"
 msgstr "Indexe"
 
-#: UI/GTK2/src/mainWindow.cc:1140
+#: UI/GTK2/src/mainWindow.cc:1136
 msgid "Unindexed document(s)"
 msgstr "Desindexe le(s) document(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1236
+#: UI/GTK2/src/mainWindow.cc:1232
 msgid "Couldn't rename index, name"
 msgstr "N'a pas pu renommer l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1240 UI/GTK2/src/mainWindow.cc:2141
-#: UI/GTK2/src/mainWindow.cc:2620
+#: UI/GTK2/src/mainWindow.cc:1236 UI/GTK2/src/mainWindow.cc:2137
+#: UI/GTK2/src/mainWindow.cc:2616
 msgid "is already in use"
 msgstr "est deja utilise"
 
-#: UI/GTK2/src/mainWindow.cc:1253
+#: UI/GTK2/src/mainWindow.cc:1249
 msgid "Couldn't rename index"
 msgstr "N'a pas pu renommer l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1266
+#: UI/GTK2/src/mainWindow.cc:1262
 msgid "Edited index"
 msgstr "Edite l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1726 UI/GTK2/src/mainWindow.cc:1829
+#: UI/GTK2/src/mainWindow.cc:1722 UI/GTK2/src/mainWindow.cc:1825
 msgid "Please set a location for the index first"
 msgstr "Donnez une location a l'index"
 
-#: UI/GTK2/src/mainWindow.cc:1753
+#: UI/GTK2/src/mainWindow.cc:1749
 msgid "Result location is unknown"
 msgstr "La location du resultat est inconnue"
 
-#: UI/GTK2/src/mainWindow.cc:1777
+#: UI/GTK2/src/mainWindow.cc:1773
 msgid "Import Document(s)"
 msgstr "Import de Document(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1907 UI/GTK2/src/pinot.cc:148
-#: UI/GTK2/src/pinot.cc:153 UI/GTK2/src/WorkerThreads.cpp:371
-#: UI/GTK2/src/WorkerThreads.cpp:608 UI/GTK2/src/WorkerThreads.cpp:1221
+#: UI/GTK2/src/mainWindow.cc:1903 UI/GTK2/src/pinot.cc:149
+#: UI/GTK2/src/pinot.cc:154 UI/GTK2/src/WorkerThreads.cpp:393
+#: UI/GTK2/src/WorkerThreads.cpp:620 UI/GTK2/src/WorkerThreads.cpp:1208
 msgid "Index"
 msgstr "L'index"
 
-#: UI/GTK2/src/mainWindow.cc:1911 UI/GTK2/src/WorkerThreads.cpp:375
-#: UI/GTK2/src/WorkerThreads.cpp:612 UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/mainWindow.cc:1907 UI/GTK2/src/WorkerThreads.cpp:397
+#: UI/GTK2/src/WorkerThreads.cpp:624 UI/GTK2/src/WorkerThreads.cpp:1212
 msgid "doesn't exist"
 msgstr "n'existe pas"
 
-#: UI/GTK2/src/mainWindow.cc:2021
+#: UI/GTK2/src/mainWindow.cc:2017
 msgid "Delete this document from the index ?"
 msgstr "Enlever ce document de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2040
+#: UI/GTK2/src/mainWindow.cc:2036
 msgid "Delete these documents from the index ?"
 msgstr "Enlever ces documents de l'index ?"
 
-#: UI/GTK2/src/mainWindow.cc:2092
+#: UI/GTK2/src/mainWindow.cc:2088
 msgid "A metasearch tool for the Free Desktop"
 msgstr "Un outil de recherche pour le Bureau Libre"
 
-#: UI/GTK2/src/mainWindow.cc:2093
+#: UI/GTK2/src/mainWindow.cc:2089
 msgid "(C) 2005-2006 Fabrice Colin"
 msgstr "(C) 2005-2006 Fabrice Colin"
 
-#: UI/GTK2/src/mainWindow.cc:2137
+#: UI/GTK2/src/mainWindow.cc:2133
 msgid "Index name"
 msgstr "Nom de l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2152
+#: UI/GTK2/src/mainWindow.cc:2148
 msgid "Couldn't add index"
 msgstr "N'a pas pu ajouter l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2166
+#: UI/GTK2/src/mainWindow.cc:2162
 msgid "Added new index"
 msgstr "Ajouter un nouvel index"
 
-#: UI/GTK2/src/mainWindow.cc:2201
+#: UI/GTK2/src/mainWindow.cc:2197
 msgid "Couldn't remove index"
 msgstr "N'a pas pu enlever l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2435
+#: UI/GTK2/src/mainWindow.cc:2278
+#, fuzzy
+msgid "Live query"
+msgstr "Edite la recherche"
+
+#: UI/GTK2/src/mainWindow.cc:2431
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Au moins une tache n'est pas terminee. Quitter maintenant ?"
 
-#: UI/GTK2/src/mainWindow.cc:2616
+#: UI/GTK2/src/mainWindow.cc:2612
 msgid "Query name"
 msgstr "Nom de la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2643
+#: UI/GTK2/src/mainWindow.cc:2639
 msgid "Couldn't update query"
 msgstr "N'a pas pu mettre a jour la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2651
+#: UI/GTK2/src/mainWindow.cc:2647
 msgid "Edited query"
 msgstr "Edite la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2658
+#: UI/GTK2/src/mainWindow.cc:2654
 msgid "Couldn't add query"
 msgstr "N'a pas pu ajouter la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2666
+#: UI/GTK2/src/mainWindow.cc:2662
 msgid "Added new query"
 msgstr "Ajoute une nouvelle recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2680
+#: UI/GTK2/src/mainWindow.cc:2676
 msgid "Query is not set"
 msgstr "Recherche indefinie"
 
-#: UI/GTK2/src/mainWindow.cc:2691
+#: UI/GTK2/src/mainWindow.cc:2687
 msgid "No search engine selected"
 msgstr "Pas de moteur selectionne"
 
-#: UI/GTK2/src/mainWindow.cc:2773
+#: UI/GTK2/src/mainWindow.cc:2769
 msgid "Please set the Google API key first"
 msgstr "Configurez la clef de l'API Google "
 
-#: UI/GTK2/src/mainWindow.cc:2782
+#: UI/GTK2/src/mainWindow.cc:2778
 msgid "Running query"
 msgstr "Recherche en cours"
 
-#: UI/GTK2/src/mainWindow.cc:2887
+#: UI/GTK2/src/mainWindow.cc:2884
 msgid "is already indexed or is being indexed"
 msgstr "est deja indexe ou est en cours d'indexation"
 
-#: UI/GTK2/src/mainWindow.cc:2914
+#: UI/GTK2/src/mainWindow.cc:2911
 msgid "No URL to browse"
 msgstr "Pas d'URL a brouter"
 
-#: UI/GTK2/src/mainWindow.cc:2925
+#: UI/GTK2/src/mainWindow.cc:2922
 msgid "No browser configured to view results"
 msgstr "Pas de brouter configure"
 
-#: UI/GTK2/src/mainWindow.cc:2937
+#: UI/GTK2/src/mainWindow.cc:2934
 msgid "Couldn't browse URL:"
 msgstr "N'a pas pu brouter l'URL"
 
+#: UI/GTK2/src/mainWindow.cc:2993
+#, fuzzy
+msgid "Viewing"
+msgstr "Voir"
+
 #: UI/GTK2/src/mainWindow_glade.cc:115
 msgid "Query:"
 msgstr "Recherche:"
@@ -465,63 +493,64 @@
 msgid "Couldn't save configuration file"
 msgstr "N'a pas pu sauve le fichier de configuration"
 
-#: UI/GTK2/src/pinot.cc:117
+#. Localize language names
+#: UI/GTK2/src/pinot.cc:118
 msgid "Danish"
 msgstr "Danois"
 
-#: UI/GTK2/src/pinot.cc:118
+#: UI/GTK2/src/pinot.cc:119
 msgid "Dutch"
 msgstr "Hollandais"
 
-#: UI/GTK2/src/pinot.cc:119
+#: UI/GTK2/src/pinot.cc:120
 msgid "English"
 msgstr "Anglais"
 
-#: UI/GTK2/src/pinot.cc:120
+#: UI/GTK2/src/pinot.cc:121
 msgid "Finnish"
 msgstr "Finlandais"
 
-#: UI/GTK2/src/pinot.cc:121
+#: UI/GTK2/src/pinot.cc:122
 msgid "French"
 msgstr "Francais"
 
-#: UI/GTK2/src/pinot.cc:122
+#: UI/GTK2/src/pinot.cc:123
 msgid "German"
 msgstr "Allemand"
 
-#: UI/GTK2/src/pinot.cc:123
+#: UI/GTK2/src/pinot.cc:124
 msgid "Italian"
 msgstr "Italien"
 
-#: UI/GTK2/src/pinot.cc:124
+#: UI/GTK2/src/pinot.cc:125
 msgid "Norwegian"
 msgstr "Norvegien"
 
-#: UI/GTK2/src/pinot.cc:125
+#: UI/GTK2/src/pinot.cc:126
 msgid "Portuguese"
 msgstr "Portugais"
 
-#: UI/GTK2/src/pinot.cc:126
+#: UI/GTK2/src/pinot.cc:127
 msgid "Russian"
 msgstr "Russe"
 
-#: UI/GTK2/src/pinot.cc:127
+#: UI/GTK2/src/pinot.cc:128
 msgid "Spanish"
 msgstr "Espagnol"
 
-#: UI/GTK2/src/pinot.cc:128
+#: UI/GTK2/src/pinot.cc:129
 msgid "Swedish"
 msgstr "Suedois"
 
-#: UI/GTK2/src/pinot.cc:149 UI/GTK2/src/pinot.cc:154
+#: UI/GTK2/src/pinot.cc:150 UI/GTK2/src/pinot.cc:155
 msgid "is not valid, please check"
 msgstr "n'est pas valide, veuillez verifier"
 
-#: UI/GTK2/src/pinot.cc:162
+#: UI/GTK2/src/pinot.cc:163
 msgid "History database"
 msgstr "La base des historiques"
 
-#: UI/GTK2/src/pinot.cc:163
+#: UI/GTK2/src/pinot.cc:164
 msgid "couldn't be created"
 msgstr "n'a pas pu etre creee"
 
@@ -605,6 +634,7 @@
 msgid "Colour"
 msgstr "Couleur"
 
+#. Let the user edit the location
 #: UI/GTK2/src/prefsDialog.cc:436 UI/GTK2/src/prefsDialog.cc:470
 msgid "Mbox File Location"
 msgstr "Location du Fichier mbox"
@@ -729,113 +759,114 @@
 msgid "Query properties"
 msgstr "Proprietes de la recherche"
 
-#: UI/GTK2/src/WorkerThreads.cpp:350
+#: UI/GTK2/src/WorkerThreads.cpp:372
 msgid "Stopped browsing"
 msgstr "Arrete le brouteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:384 UI/GTK2/src/WorkerThreads.cpp:620
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:675
-#: UI/GTK2/src/WorkerThreads.cpp:891 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1234
+#: UI/GTK2/src/WorkerThreads.cpp:406 UI/GTK2/src/WorkerThreads.cpp:632
+#: UI/GTK2/src/WorkerThreads.cpp:672 UI/GTK2/src/WorkerThreads.cpp:682
+#: UI/GTK2/src/WorkerThreads.cpp:888 UI/GTK2/src/WorkerThreads.cpp:1098
+#: UI/GTK2/src/WorkerThreads.cpp:1221
 msgid "Index error on"
 msgstr "Erreur sur l'index"
 
-#: UI/GTK2/src/WorkerThreads.cpp:490
+#: UI/GTK2/src/WorkerThreads.cpp:507
 msgid "Stopped querying"
 msgstr "Arrete la recherche"
 
-#: UI/GTK2/src/WorkerThreads.cpp:502
+#: UI/GTK2/src/WorkerThreads.cpp:519
 msgid "Couldn't create search engine"
 msgstr "N'a pas pu creer le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:514
+#: UI/GTK2/src/WorkerThreads.cpp:531
 msgid "Couldn't run query on search engine"
 msgstr "N'a pas pu lancer la recherche sur le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:530
+#: UI/GTK2/src/WorkerThreads.cpp:547
 msgid "No title"
 msgstr "Pas de titre"
 
-#: UI/GTK2/src/WorkerThreads.cpp:592 UI/GTK2/src/WorkerThreads.cpp:656
+#: UI/GTK2/src/WorkerThreads.cpp:604 UI/GTK2/src/WorkerThreads.cpp:663
 msgid "Stopped querying index labels"
 msgstr "Arrete la recherche d'etiquettes"
 
-#: UI/GTK2/src/WorkerThreads.cpp:746
+#: UI/GTK2/src/WorkerThreads.cpp:748
 msgid "Stopped retrieval of"
 msgstr "Arrete le telechargement de"
 
-#: UI/GTK2/src/WorkerThreads.cpp:782
+#: UI/GTK2/src/WorkerThreads.cpp:784
 msgid "Couldn't obtain downloader for protocol"
 msgstr "N'a pas pu obtenir un brouteur pour"
 
-#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:905
+#: UI/GTK2/src/WorkerThreads.cpp:798 UI/GTK2/src/WorkerThreads.cpp:902
 msgid "Couldn't retrieve"
 msgstr "N'a pas pu telecharger"
 
-#: UI/GTK2/src/WorkerThreads.cpp:876
+#: UI/GTK2/src/WorkerThreads.cpp:873
 msgid "Stopped indexing"
 msgstr "Arrete l'indexation"
 
-#: UI/GTK2/src/WorkerThreads.cpp:929
+#: UI/GTK2/src/WorkerThreads.cpp:926
 msgid "Cannot index document type"
 msgstr "Impossible d'indexer de type de documents"
 
-#: UI/GTK2/src/WorkerThreads.cpp:933
+#: UI/GTK2/src/WorkerThreads.cpp:930
 msgid "at"
 msgstr "a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:958
+#: UI/GTK2/src/WorkerThreads.cpp:955
 msgid "Couldn't tokenize"
 msgstr "N'a pas pu parcourir"
 
-#: UI/GTK2/src/WorkerThreads.cpp:979
+#: UI/GTK2/src/WorkerThreads.cpp:976
 msgid "Robots META tag forbids indexing"
 msgstr "Le META tag Robots empeche d'indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1029
+#: UI/GTK2/src/WorkerThreads.cpp:1026
 msgid "Couldn't index"
 msgstr "N'a pas pu indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1094
+#: UI/GTK2/src/WorkerThreads.cpp:1086
 msgid "Stopped unindexing document(s)"
 msgstr "Arrete d'indexer les document(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1114
+#. Be pessimistic and assume something will go wrong ;-)
+#: UI/GTK2/src/WorkerThreads.cpp:1106
 msgid "Couldn't unindex document(s)"
 msgstr "N'a pas pu desindexer le(s) document(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1206
+#: UI/GTK2/src/WorkerThreads.cpp:1193
 msgid "Stopped document update for "
 msgstr "Arrete la mise a jour pour "
 
-#: UI/GTK2/src/WorkerThreads.cpp:1243
+#: UI/GTK2/src/WorkerThreads.cpp:1230
 msgid "Couldn't update document"
 msgstr "N'a pas pu mettre a jour le document"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1293
+#: UI/GTK2/src/WorkerThreads.cpp:1275
 msgid "Stopped listening on"
 msgstr "Arrete l'ecoute sur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1396
+#: UI/GTK2/src/WorkerThreads.cpp:1378
 msgid "Couldn't read FIFO at"
 msgstr "N'a pas pu lire la FIFO a"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1446
+#: UI/GTK2/src/WorkerThreads.cpp:1423
 msgid "Stopped monitoring"
 msgstr "Arrete la surveillance"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1467
+#: UI/GTK2/src/WorkerThreads.cpp:1444
 msgid "No monitoring handler"
 msgstr "Pas de moniteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1514
+#: UI/GTK2/src/WorkerThreads.cpp:1491
 msgid "Couldn't open FAM connection"
 msgstr "N'a pas pu ouvrir la connection FAM"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1724
+#: UI/GTK2/src/WorkerThreads.cpp:1696
 msgid "Stopped scanning"
 msgstr "Arrete de scanner"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1882
+#: UI/GTK2/src/WorkerThreads.cpp:1854
 msgid "Couldn't open directory"
 msgstr "N'a pas pu ovrir le repertoire"



From fabricecolin at berlios.de  Wed Feb 15 14:55:24 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 15 Feb 2006 14:55:24 +0100
Subject: [Pinot-svn] r112 - in trunk: . po
Message-ID: <200602151355.k1FDtOqv015790@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-15 14:55:23 +0100 (Wed, 15 Feb 2006)
New Revision: 112

Modified:
   trunk/Makefile.am
   trunk/po/Makefile.in.in
Log:
Tweaked DIST files.


Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-02-15 13:07:28 UTC (rev 111)
+++ trunk/Makefile.am	2006-02-15 13:55:23 UTC (rev 112)
@@ -3,8 +3,8 @@
 
 SUBDIRS = po Utils Tokenize SQL Collect Search Index UI/RenderHTML UI/GTK2/src
 
-EXTRA_DIST = config.rpath mkinstalldirs m4/ChangeLog TODO README configure \
-	pinot.spec Search/Plugins/*src Search/Plugins/*.xml \
+EXTRA_DIST = ChangeLog TODO README mkinstalldirs pinot.spec \
+	Search/Plugins/*src Search/Plugins/*.xml \
 	index.html UI/GTK2/xapian-powered.png UI/GTK2/pinot.png \
 	textcat_conf.txt UI/GTK2/metase-gtk2.glade UI/GTK2/metase-gtk2.gladep
 

Modified: trunk/po/Makefile.in.in
===================================================================
--- trunk/po/Makefile.in.in	2006-02-15 13:07:28 UTC (rev 111)
+++ trunk/po/Makefile.in.in	2006-02-15 13:55:23 UTC (rev 112)
@@ -54,7 +54,7 @@
 SOURCES = 
 POFILES = @POFILES@
 GMOFILES = @GMOFILES@
-DISTFILES = ChangeLog Makefile.in.in POTFILES.in $(GETTEXT_PACKAGE).pot \
+DISTFILES = Makefile.in.in POTFILES.in $(GETTEXT_PACKAGE).pot \
 $(POFILES) $(GMOFILES) $(SOURCES)
 
 POTFILES = \



From fabricecolin at berlios.de  Wed Feb 15 14:57:03 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 15 Feb 2006 14:57:03 +0100
Subject: [Pinot-svn] r113 - trunk
Message-ID: <200602151357.k1FDv3iW015984@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-15 14:56:42 +0100 (Wed, 15 Feb 2006)
New Revision: 113

Added:
   trunk/mkinstalldirs
Log:
This is not generated automagically it seems.


Added: trunk/mkinstalldirs
===================================================================
--- trunk/mkinstalldirs	2006-02-15 13:55:23 UTC (rev 112)
+++ trunk/mkinstalldirs	2006-02-15 13:56:42 UTC (rev 113)
@@ -0,0 +1 @@
+link /usr/share/gettext/mkinstalldirs
\ No newline at end of file


Property changes on: trunk/mkinstalldirs
___________________________________________________________________
Name: svn:special
   + *



From fabricecolin at berlios.de  Wed Feb 15 17:49:34 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 15 Feb 2006 17:49:34 +0100
Subject: [Pinot-svn] r114 - in trunk: . Index Search UI/GTK2 Utils
Message-ID: <200602151649.k1FGnY5K013163@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-15 17:49:34 +0100 (Wed, 15 Feb 2006)
New Revision: 114

Removed:
   trunk/UI/GTK2/config.h
Modified:
   trunk/Index/Makefile.am
   trunk/Makefile.am
   trunk/Search/Makefile.am
   trunk/Utils/Makefile.am
   trunk/configure.in
   trunk/pinot.spec.in
Log:
Fixes to get 'make dist' and 'make install' working.


Modified: trunk/Index/Makefile.am
===================================================================
--- trunk/Index/Makefile.am	2006-02-15 13:56:42 UTC (rev 113)
+++ trunk/Index/Makefile.am	2006-02-15 16:49:34 UTC (rev 114)
@@ -1,6 +1,7 @@
 # Process this file with automake to produce Makefile.in
 
 noinst_HEADERS = \
+	IndexInterface.h \
 	LanguageDetector.h \
 	Summarizer.h \
 	XapianIndex.h

Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-02-15 13:56:42 UTC (rev 113)
+++ trunk/Makefile.am	2006-02-15 16:49:34 UTC (rev 114)
@@ -19,6 +19,7 @@
 	$(INSTALL_DATA) Search/Plugins/*.src $(DESTDIR)$(datadir)/pinot/engines/
 	$(INSTALL_DATA) Search/Plugins/*.xml $(DESTDIR)$(datadir)/pinot/engines/
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/pinot/tokenizers
+	@rm -f $(DESTDIR)$(libdir)/lib*tokenizer.*
 	$(INSTALL_DATA) Tokenize/.libs/*.so $(DESTDIR)$(datadir)/pinot/tokenizers/
 	$(mkinstalldirs) $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/
 	$(INSTALL_DATA) UI/GTK2/pinot.png $(DESTDIR)$(datadir)/icons/hicolor/48x48/apps/pinot.png

Modified: trunk/Search/Makefile.am
===================================================================
--- trunk/Search/Makefile.am	2006-02-15 13:56:42 UTC (rev 113)
+++ trunk/Search/Makefile.am	2006-02-15 16:49:34 UTC (rev 114)
@@ -7,6 +7,7 @@
 	WebEngine.h \
 	SearchEngineFactory.h \
 	XapianEngine.h \
+	PluginParsers.h \
 	PluginWebEngine.h \
 	SearchEngineInterface.h \
 	SherlockParser.h

Deleted: trunk/UI/GTK2/config.h
===================================================================
--- trunk/UI/GTK2/config.h	2006-02-15 13:56:42 UTC (rev 113)
+++ trunk/UI/GTK2/config.h	2006-02-15 16:49:34 UTC (rev 114)
@@ -1,91 +0,0 @@
-/* config.h.  Generated by configure.  */
-/* config.h.in.  Generated from configure.in by autoheader.  */
-// generated 2003/5/18 21:15:37 BST by fabrice at amra.dyndns.org.(none)
-// using glademm V2.0.0
-
-/* acconfig.h
- * This file is in the public domain.
- *
- * Descriptive text for the C preprocessor macros that
- * the distributed Autoconf macros can define.
- * These entries are sometimes used by macros
- * which glade-- uses.
- */
-#define PACKAGE "pinot"
-#define ENABLE_NLS 1
-/* #undef HAVE_CATGETS */
-#define HAVE_GETTEXT 1
-#define HAVE_LC_MESSAGES 1
-/* #undef HAVE_STPCPY */
-/* #undef HAVE_LIBSM */
-#define PACKAGE_LOCALE_DIR "/usr/share/locale"
-#define GETTEXT_PACKAGE "pinot"
-
-/* always defined to indicate that i18n is enabled */
-#define ENABLE_NLS 1
-
-/* Define to 1 if you have the `bind_textdomain_codeset' function. */
-#define HAVE_BIND_TEXTDOMAIN_CODESET 1
-
-/* Define to 1 if you have the `dcgettext' function. */
-#define HAVE_DCGETTEXT 1
-
-/* Define to 1 if you have the <dlfcn.h> header file. */
-#define HAVE_DLFCN_H 1
-
-/* Define if the GNU gettext() function is already present or preinstalled. */
-#define HAVE_GETTEXT 1
-
-/* Define to 1 if you have the <inttypes.h> header file. */
-#define HAVE_INTTYPES_H 1
-
-/* Define if your <locale.h> file defines LC_MESSAGES. */
-#define HAVE_LC_MESSAGES 1
-
-/* Define to 1 if you have the <locale.h> header file. */
-#define HAVE_LOCALE_H 1
-
-/* Define to 1 if you have the <memory.h> header file. */
-#define HAVE_MEMORY_H 1
-
-/* Define to 1 if you have the <stdint.h> header file. */
-#define HAVE_STDINT_H 1
-
-/* Define to 1 if you have the <stdlib.h> header file. */
-#define HAVE_STDLIB_H 1
-
-/* Define to 1 if you have the <strings.h> header file. */
-#define HAVE_STRINGS_H 1
-
-/* Define to 1 if you have the <string.h> header file. */
-#define HAVE_STRING_H 1
-
-/* Define to 1 if you have the <sys/stat.h> header file. */
-#define HAVE_SYS_STAT_H 1
-
-/* Define to 1 if you have the <sys/types.h> header file. */
-#define HAVE_SYS_TYPES_H 1
-
-/* Define to 1 if you have the <unistd.h> header file. */
-#define HAVE_UNISTD_H 1
-
-/* Define to the address where bug reports for this package should be sent. */
-#define PACKAGE_BUGREPORT ""
-
-/* Define to the full name of this package. */
-#define PACKAGE_NAME "Pinot"
-
-/* Define to the full name and version of this package. */
-#define PACKAGE_STRING "Pinot v0.42"
-
-/* Define to the one symbol short name of this package. */
-#define PACKAGE_TARNAME "pinot-0.42.tar.gz"
-
-/* Define to the version of this package. */
-#define PACKAGE_VERSION "0.42"
-
-/* Define to 1 if you have the ANSI C header files. */
-#define STDC_HEADERS 1
-
-/* Version number of package */
-#define VERSION "0.42"

Modified: trunk/Utils/Makefile.am
===================================================================
--- trunk/Utils/Makefile.am	2006-02-15 13:56:42 UTC (rev 113)
+++ trunk/Utils/Makefile.am	2006-02-15 16:49:34 UTC (rev 114)
@@ -5,6 +5,7 @@
 	HtmlDocument.h \
 	Languages.h \
 	MIMEScanner.h \
+	NLS.h \
 	StringManip.h \
 	Timer.h \
 	XapianDatabase.h \

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-15 13:56:42 UTC (rev 113)
+++ trunk/configure.in	2006-02-15 16:49:34 UTC (rev 114)
@@ -2,7 +2,7 @@
 # using glademm V2.6.0
 
 AC_PREREQ(2.50)
-AC_INIT(pinot, 0.44,[colinf at chez.com])
+AC_INIT(pinot, 0.43,[colinf at chez.com])
 AM_INIT_AUTOMAKE
 AC_CONFIG_HEADERS(config.h)
 

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-02-15 13:56:42 UTC (rev 113)
+++ trunk/pinot.spec.in	2006-02-15 16:49:34 UTC (rev 114)
@@ -111,9 +111,9 @@
 
 %files text-docs 
 %defattr(-, root, root, -)
-%dir %{_datadir}/pinot/tokenizers/pdf_tokenizer.so
-%dir %{_datadir}/pinot/tokenizers/word_tokenizer.so
-%dir %{_datadir}/pinot/tokenizers/rtf_tokenizer.so
+%{_datadir}/pinot/tokenizers/libpdftokenizer.so
+%{_datadir}/pinot/tokenizers/librtftokenizer.so
+%{_datadir}/pinot/tokenizers/libwordtokenizer.so
 
 %files omega
 %defattr(-, root, root, -)



From fabricecolin at berlios.de  Thu Feb 16 14:55:25 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Thu, 16 Feb 2006 14:55:25 +0100
Subject: [Pinot-svn] r115 - in trunk: . Index Search UI/GTK2/src po
Message-ID: <200602161355.k1GDtPGa025106@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-16 14:54:50 +0100 (Thu, 16 Feb 2006)
New Revision: 115

Added:
   trunk/po/es.po
   trunk/po/fr.po
Removed:
   trunk/po/es_ES.po
   trunk/po/fr_FR.po
Modified:
   trunk/Index/LanguageDetector.cpp
   trunk/Index/XapianIndex.cpp
   trunk/Makefile.am
   trunk/Search/senginetest.cpp
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/WorkerThreads.h
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/pinot.cc
   trunk/configure.in
   trunk/pinot.spec.in
Log:
Renamed and updated language catalogs. Prefix is now set in config.h.
Worker threads are a bit more robust.


Modified: trunk/Index/LanguageDetector.cpp
===================================================================
--- trunk/Index/LanguageDetector.cpp	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/Index/LanguageDetector.cpp	2006-02-16 13:54:50 UTC (rev 115)
@@ -26,6 +26,7 @@
 #include "StringManip.h"
 #include "Timer.h"
 #include "LanguageDetector.h"
+#include "config.h"
 
 using std::cout;
 using std::cerr;
@@ -51,13 +52,15 @@
 void LanguageDetector::guessLanguage(const char *pData, unsigned int dataLength,
 			std::vector<std::string> &candidates)
 {
+	string confFile(PREFIX);
 #ifdef HAVE_TEXTCAT_CAT
 	const char *catResults[10];
 #endif
 
 	candidates.clear();
 
-	void *td = textcat_Init("/usr/share/pinot/textcat_conf.txt");
+	confFile += "/share/pinot/textcat_conf.txt";
+	void *td = textcat_Init(confFile.c_str());
 	if (td == NULL)
 	{
 		candidates.push_back("unknown");

Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/Index/XapianIndex.cpp	2006-02-16 13:54:50 UTC (rev 115)
@@ -550,6 +550,11 @@
 				for (termIter.skip_to("XLABEL:");
 					termIter != pIndex->termlist_end(docId); ++termIter)
 				{
+					if ((*termIter).length() < 7)
+					{
+						break;
+					}
+
 					// Is this a label ?
 					if (strncasecmp((*termIter).c_str(), "XLABEL:", min(7, (int)(*termIter).length())) == 0)
 					{

Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/Makefile.am	2006-02-16 13:54:50 UTC (rev 115)
@@ -26,3 +26,5 @@
 
 ACLOCAL_AMFLAGS = -I m4
 
+AM_CXXFLAGS = -fPIC
+

Modified: trunk/Search/senginetest.cpp
===================================================================
--- trunk/Search/senginetest.cpp	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/Search/senginetest.cpp	2006-02-16 13:54:50 UTC (rev 115)
@@ -24,6 +24,7 @@
 #include "DownloaderFactory.h"
 #include "Url.h"
 #include "HtmlTokenizer.h"
+#include "config.h"
 
 using namespace std;
 
@@ -36,7 +37,7 @@
 		set<string> engines;
 
 		cerr << "Usage: " << argv[0] << " <search engine type> <name>|<key> <query string> <max results count>" << endl;
-		cerr << "Example: " << argv[0] << " sherlock /usr/share/pinot/engines/Bozo.src \"clowns\" 10" << endl;
+		cerr << "Example: " << argv[0] << " sherlock " << PREFIX << "/share/pinot/engines/Bozo.src \"clowns\" 10" << endl;
 
 		SearchEngineFactory::getSupportedEngines(engines);
 		cerr << "Supported search engine types:";

Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-02-16 13:54:50 UTC (rev 115)
@@ -23,6 +23,7 @@
 #include <string.h>
 #include <signal.h>
 #include <fam.h>
+#include <exception>
 #include <iostream>
 #include <fstream>
 #include <sigc++/class_slot.h>
@@ -110,6 +111,11 @@
 	return m_id < other.m_id;
 }
 
+Glib::Thread *WorkerThread::start(void)
+{
+	return Thread::create(slot_class(*this, &WorkerThread::threadHandler), m_joinable);
+}
+
 bool WorkerThread::isDone(void) const
 {
 	return m_done;
@@ -125,6 +131,29 @@
 	return m_status;
 }
 
+void WorkerThread::threadHandler(void)
+{
+	try
+	{
+		doWork();
+	}
+	catch (exception &ex)
+	{
+#ifdef DEBUG
+		cout << "Exception in thread " << m_id << ", type " << getType()
+			<< ":" << ex.what() << endl;
+#endif
+	}
+	catch (...)
+	{
+#ifdef DEBUG
+		cout << "Unknown exception in thread " << m_id << ", type " << getType() << endl;
+#endif
+	}
+
+	emitSignal();
+}
+
 void WorkerThread::emitSignal(void)
 {
 #ifdef DEBUG
@@ -324,11 +353,6 @@
 {
 }
 
-Thread *IndexBrowserThread::start(void)
-{
-	return Thread::create(slot_class(*this, &IndexBrowserThread::do_browsing), m_joinable);
-}
-
 string IndexBrowserThread::getType(void) const
 {
 	return "IndexBrowserThread";
@@ -358,7 +382,7 @@
 	return m_signalUpdate;
 }
 
-void IndexBrowserThread::do_browsing()
+void IndexBrowserThread::doWork(void)
 {
 	set<unsigned int> docIDList;
 	set<string> docLabels;
@@ -373,7 +397,6 @@
 		m_status += m_indexName;
 		m_status += " ";
 		m_status += _("doesn't exist");
-		emitSignal();
 		return;
 	}
 
@@ -384,7 +407,6 @@
 		m_status = _("Index error on");
 		m_status += " ";
 		m_status += mapIter->second;
-		emitSignal();
 		return;
 	}
 
@@ -392,14 +414,13 @@
 	if (m_indexDocsCount == 0)
 	{
 #ifdef DEBUG
-		cout << "IndexBrowserThread::do_browsing: no documents" << endl;
+		cout << "IndexBrowserThread::doWork: no documents" << endl;
 #endif
-		emitSignal();
 		return;
 	}
 
 #ifdef DEBUG
-	cout << "IndexBrowserThread::do_browsing: " << m_maxDocsCount << " off " << m_indexDocsCount
+	cout << "IndexBrowserThread::doWork: " << m_maxDocsCount << " off " << m_indexDocsCount
 		<< " documents to browse, starting at " << m_startDoc << endl;
 #endif
 	index.listDocuments(docIDList, m_maxDocsCount, m_startDoc);
@@ -434,11 +455,9 @@
 			++numDocs;
 		}
 #ifdef DEBUG
-		else cout << "IndexBrowserThread::do_browsing: couldn't retrieve document " << docId << endl;
+		else cout << "IndexBrowserThread::doWork: couldn't retrieve document " << docId << endl;
 #endif
 	}
-
-	emitSignal();
 }
 
 QueryingThread::QueryingThread(const string &engineName, const string &engineDisplayableName,
@@ -454,11 +473,6 @@
 {
 }
 
-Thread  *QueryingThread::start(void)
-{
-	return Thread::create(slot_class(*this, &QueryingThread::do_querying), m_joinable);
-}
-
 string QueryingThread::getType(void) const
 {
 	return "QueryingThread";
@@ -493,7 +507,7 @@
 	return true;
 }
 
-void QueryingThread::do_querying()
+void QueryingThread::doWork(void)
 {
 	// Get the SearchEngine
 	SearchEngineInterface *engine = SearchEngineFactory::getSearchEngine(m_engineName, m_engineOption);
@@ -502,7 +516,6 @@
 		m_status = _("Couldn't create search engine");
 		m_status += " ";
 		m_status += m_engineDisplayableName;
-		emitSignal();
 		return;
 	}
 	// Set the maximum number of results
@@ -551,8 +564,6 @@
 		}
 	}
 	delete engine;
-
-	emitSignal();
 }
 
 LabelQueryThread::LabelQueryThread(const string &indexName, const string &labelName) :
@@ -566,11 +577,6 @@
 {
 }
 
-Thread *LabelQueryThread::start(void)
-{
-	return Thread::create(slot_class(*this, &LabelQueryThread::do_querying), m_joinable);
-}
-
 string LabelQueryThread::getType(void) const
 {
 	return "LabelQueryThread";
@@ -598,7 +604,7 @@
 	return m_documentsList;
 }
 
-void LabelQueryThread::do_querying()
+void LabelQueryThread::doWork(void)
 {
 	const map<string, string> &indexesMap = PinotSettings::getInstance().getIndexes();
 
@@ -610,7 +616,6 @@
 		m_status += m_indexName;
 		m_status += " ";
 		m_status += _("doesn't exist");
-		emitSignal();
 		return;
 	}
 
@@ -620,13 +625,10 @@
 		m_status = _("Index error on");
 		m_status += " ";
 		m_status += mapIter->second;
-		emitSignal();
 		return;
 	}
 
 	index.getDocumentsWithLabel(m_labelName, m_documentsList);
-
-	emitSignal();
 }
 
 LabelUpdateThread::LabelUpdateThread(const set<string> &labelsToDelete,
@@ -640,11 +642,6 @@
 {
 }
 
-Thread *LabelUpdateThread::start(void)
-{
-	return Thread::create(slot_class(*this, &LabelUpdateThread::do_update), m_joinable);
-}
-
 string LabelUpdateThread::getType(void) const
 {
 	return "LabelUpdateThread";
@@ -657,7 +654,7 @@
 	return true;
 }
 
-void LabelUpdateThread::do_update()
+void LabelUpdateThread::doWork(void)
 {
 	XapianIndex docsIndex(PinotSettings::getInstance().m_indexLocation);
 	if (docsIndex.isGood() == false)
@@ -665,7 +662,6 @@
 		m_status = _("Index error on");
 		m_status += " ";
 		m_status += PinotSettings::getInstance().m_indexLocation;
-		emitSignal();
 		return;
 	}
 
@@ -675,7 +671,6 @@
 		m_status = _("Index error on");
 		m_status += " ";
 		m_status += PinotSettings::getInstance().m_mailIndexLocation;
-		emitSignal();
 		return;
 	}
 
@@ -691,8 +686,6 @@
 		docsIndex.renameLabel(iter->first, iter->second);
 		mailIndex.renameLabel(iter->first, iter->second);
 	}
-
-	emitSignal();
 }
 
 DownloadingThread::DownloadingThread(const string url, bool fromCache) :
@@ -701,8 +694,6 @@
 	m_url = url;
 	m_fromCache = fromCache;
 	m_pDoc = NULL;
-	// This is for sub-classes that need to things after the document has been downloaded
-	m_signalAfterDownload = true;
 	m_downloader = NULL;
 }
 
@@ -718,11 +709,6 @@
 	}
 }
 
-Thread *DownloadingThread::start(void)
-{
-	return Thread::create(slot_class(*this, &DownloadingThread::do_downloading), m_joinable);
-}
-
 string DownloadingThread::getType(void) const
 {
 	return "DownloadingThread";
@@ -752,7 +738,7 @@
 	return false;
 }
 
-void DownloadingThread::do_downloading()
+void DownloadingThread::doWork(void)
 {
 	if (m_downloader != NULL)
 	{
@@ -770,7 +756,7 @@
 		m_pDoc = googleApiEngine.retrieveCachedUrl(m_url);
 #endif
 #ifdef DEBUG
-		cout << "DownloadingThread::do_downloading: got cached page" << endl;
+		cout << "DownloadingThread::doWork: got cached page" << endl;
 #endif
 	}
 	else
@@ -797,12 +783,6 @@
 		m_status += " ";
 		m_status += m_url;
 	}
-
-	// Signal ?
-	if (m_signalAfterDownload == true)
-	{
-		emitSignal();
-	}
 }
 
 IndexingThread::IndexingThread(const DocumentInfo &docInfo, const string &labelName,
@@ -825,19 +805,12 @@
 		// This is not an update
 		m_update = false;
 	}
-	// Don't trigger signal after the document has been downloaded
-	m_signalAfterDownload = false;
 }
 
 IndexingThread::~IndexingThread()
 {
 }
 
-Thread *IndexingThread::start(void)
-{
-	return Thread::create(slot_class(*this, &IndexingThread::do_indexing), m_joinable);
-}
-
 string IndexingThread::getType(void) const
 {
 	return "IndexingThread";
@@ -882,7 +855,7 @@
 	return false;
 }
 
-void IndexingThread::do_indexing()
+void IndexingThread::doWork(void)
 {
 	// First things first, get the index
 	XapianIndex index(m_indexLocation);
@@ -891,13 +864,12 @@
 		m_status = _("Index error on");
 		m_status += " ";
 		m_status += m_indexLocation;
-		emitSignal();
 		return;
 	}
 
-	do_downloading();
+	DownloadingThread::doWork();
 #ifdef DEBUG
-	cout << "IndexingThread::do_indexing: downloaded !" << endl;
+	cout << "IndexingThread::doWork: downloaded !" << endl;
 #endif
 
 	if (m_pDoc == NULL)
@@ -933,7 +905,6 @@
 			m_status += _("at");
 			m_status += " ";
 			m_status += m_url;
-			emitSignal();
 			return;
 		}
 
@@ -948,7 +919,7 @@
 			m_docInfo.setTitle(m_pDoc->getTitle());
 		}
 #ifdef DEBUG
-		cout << "IndexingThread::do_indexing: title is " << m_pDoc->getTitle() << endl;
+		cout << "IndexingThread::doWork: title is " << m_pDoc->getTitle() << endl;
 #endif
 
 		// Tokenize this document
@@ -958,7 +929,6 @@
 			m_status = _("Couldn't tokenize");
 			m_status += " ";
 			m_status += m_url;
-			emitSignal();
 			return;
 		}
 
@@ -979,7 +949,6 @@
 				m_status = _("Robots META tag forbids indexing");
 				m_status += " ";
 				m_status += m_url;
-				emitSignal();
 				return;
 			}
 		}
@@ -1042,8 +1011,6 @@
 
 		delete pTokens;
 	}
-
-	emitSignal();
 }
 
 UnindexingThread::UnindexingThread(const set<unsigned int> &docIdList) :
@@ -1073,11 +1040,6 @@
 {
 }
 
-Thread *UnindexingThread::start(void)
-{
-	return Thread::create(slot_class(*this, &UnindexingThread::do_unindexing), m_joinable);
-}
-
 string UnindexingThread::getType(void) const
 {
 	return "UnindexingThread";
@@ -1095,7 +1057,7 @@
 	return true;
 }
 
-void UnindexingThread::do_unindexing()
+void UnindexingThread::doWork(void)
 {
 	if (m_done == false)
 	{
@@ -1106,7 +1068,6 @@
 			m_status = _("Index error on");
 			m_status += " ";
 			m_status += m_indexLocation;
-			emitSignal();
 			return;
 		}
 
@@ -1146,11 +1107,11 @@
 					++m_docsCount;
 				}
 #ifdef DEBUG
-				else cout << "UnindexingThread::do_unindexing: couldn't remove " << docId << endl;
+				else cout << "UnindexingThread::doWork: couldn't remove " << docId << endl;
 #endif
 			}
 #ifdef DEBUG
-			cout << "UnindexingThread::do_unindexing: removed " << m_docsCount << " documents" << endl;
+			cout << "UnindexingThread::doWork: removed " << m_docsCount << " documents" << endl;
 #endif
 		}
 
@@ -1163,8 +1124,6 @@
 			m_status = "";
 		}
 	}
-
-	emitSignal();
 }
 
 UpdateDocumentThread::UpdateDocumentThread(const string &indexName,
@@ -1180,11 +1139,6 @@
 {
 }
 
-Thread *UpdateDocumentThread::start(void)
-{
-	return Thread::create(slot_class(*this, &UpdateDocumentThread::do_update), m_joinable);
-}
-
 string UpdateDocumentThread::getType(void) const
 {
 	return "UpdateDocumentThread";
@@ -1210,7 +1164,7 @@
 	return true;
 }
 
-void UpdateDocumentThread::do_update()
+void UpdateDocumentThread::doWork(void)
 {
 	if (m_done == false)
 	{
@@ -1223,7 +1177,6 @@
 			m_status += m_indexName;
 			m_status += " ";
 			m_status += _("doesn't exist");
-			emitSignal();
 			return;
 		}
 
@@ -1234,7 +1187,6 @@
 			m_status = _("Index error on");
 			m_status += " ";
 			m_status += mapIter->second;
-			emitSignal();
 			return;
 		}
 
@@ -1250,8 +1202,6 @@
 			index.getDocumentInfo(m_docId, m_docInfo);
 		}
 	}
-
-	emitSignal();
 }
 
 ListenerThread::ListenerThread(const string &fifoFileName) :
@@ -1276,11 +1226,6 @@
 	close(m_ctrlWritePipe);
 }
 
-Thread *ListenerThread::start(void)
-{
-	return Thread::create(slot_class(*this, &ListenerThread::do_listening), m_joinable);
-}
-
 string ListenerThread::getType(void) const
 {
 	return "ListenerThread";
@@ -1302,19 +1247,19 @@
 	return m_signalReception;
 }
 
-void ListenerThread::do_listening()
+void ListenerThread::doWork(void)
 {
 	if (unlink(m_fifoFileName.c_str()) != 0)
 	{
 #ifdef DEBUG
-		cout << "ListenerThread::do_listening: couldn't delete FIFO at " << m_fifoFileName << endl;
+		cout << "ListenerThread::doWork: couldn't delete FIFO at " << m_fifoFileName << endl;
 #endif
 	}
 
 	if (mkfifo(m_fifoFileName.c_str(), S_IRUSR|S_IWUSR) != 0)
 	{
 #ifdef DEBUG
-		cout << "ListenerThread::do_listening: couldn't create FIFO at " << m_fifoFileName << endl;
+		cout << "ListenerThread::doWork: couldn't create FIFO at " << m_fifoFileName << endl;
 #endif
 	}
 
@@ -1322,7 +1267,7 @@
 	if (sigset(SIGPIPE, SIG_IGN) == SIG_ERR)
 	{
 #ifdef DEBUG
-		cout << "ListenerThread::do_listening: couldn't ignore SIGPIPE" << endl;
+		cout << "ListenerThread::doWork: couldn't ignore SIGPIPE" << endl;
 #endif
 	}
 
@@ -1351,7 +1296,7 @@
 				(errno != EINTR))
 			{
 #ifdef DEBUG
-				cout << "ListenerThread::do_listening: select() failed" << endl;
+				cout << "ListenerThread::doWork: select() failed" << endl;
 #endif
 				break;
 			}
@@ -1361,14 +1306,14 @@
 				char buffer[1024];
 
 #ifdef DEBUG
-				cout << "ListenerThread::do_listening: reading..." << endl;
+				cout << "ListenerThread::doWork: reading..." << endl;
 #endif
 				ssize_t bytes = read(fd, buffer, 1024);
 				while (bytes > 0)
 				{
 					xmlMsg += string(buffer, bytes);
 #ifdef DEBUG
-					cout << "ListenerThread::do_listening: read " << bytes << " bytes" << endl;
+					cout << "ListenerThread::doWork: read " << bytes << " bytes" << endl;
 #endif
 					bytes = read(fd, buffer, 1024);
 				}
@@ -1381,7 +1326,7 @@
 				string labelName = StringManip::extractField(xmlMsg, "<label>", "</label>");
 				string content = StringManip::extractField(xmlMsg, "<content>", "</content>");
 #ifdef DEBUG
-				cout << "ListenerThread::do_listening: " << content.length() << " bytes of content" << endl;
+				cout << "ListenerThread::doWork: " << content.length() << " bytes of content" << endl;
 #endif
 
 				// Signal
@@ -1397,8 +1342,6 @@
 		m_status += " ";
 		m_status += m_fifoFileName;
 	}
-
-	emitSignal();
 }
 
 MonitorThread::MonitorThread(MonitorHandler *pHandler) :
@@ -1429,11 +1372,6 @@
 	close(m_ctrlWritePipe);
 }
 
-Thread *MonitorThread::start(void)
-{
-	return Thread::create(slot_class(*this, &MonitorThread::do_monitoring), m_joinable);
-}
-
 string MonitorThread::getType(void) const
 {
 	return "MonitorThread";
@@ -1445,13 +1383,13 @@
 	write(m_ctrlWritePipe, "Stop", 4);
 	m_status = _("Stopped monitoring");
 #ifdef DEBUG
-	cout << "MonitorThread::do_monitoring: stop called" << endl;
+	cout << "MonitorThread::doWork: stop called" << endl;
 #endif
 
 	return true;
 }
 
-void MonitorThread::do_monitoring()
+void MonitorThread::doWork(void)
 {
 	FAMConnection famConn;
 	FAMRequest famReq;
@@ -1465,7 +1403,6 @@
 	if (m_pHandler == NULL)
 	{
 		m_status = _("No monitoring handler");
-		emitSignal();
 		return;
 	}
 
@@ -1486,7 +1423,7 @@
 		}
 
 #ifdef DEBUG
-		cout << "MonitorThread::do_monitoring: checking locations" << endl;
+		cout << "MonitorThread::doWork: checking locations" << endl;
 #endif
 		if ((setLocationsToMonitor == true) &&
 			(m_pHandler->getFileSystemLocations(fsLocations) > 0) &&
@@ -1494,7 +1431,7 @@
 		{
 			// Tell FAM what we want to monitor
 #ifdef DEBUG
-			cout << "MonitorThread::do_monitoring: change detected" << endl;
+			cout << "MonitorThread::doWork: change detected" << endl;
 #endif
 			if (firstTime == false)
 			{
@@ -1512,7 +1449,6 @@
 			if (FAMOpen(&famConn) != 0)
 			{
 				m_status = _("Couldn't open FAM connection");
-				emitSignal();
 				return;
 			}
 
@@ -1542,7 +1478,7 @@
 					famStatus = FAMMonitorDirectory(&famConn, fsLocation.c_str(), &famReq, (void*)(fsIter->first + 1));
 				}
 #ifdef DEBUG
-				cout << "MonitorThread::do_monitoring: added " << fsLocation << ", " << famStatus << endl;
+				cout << "MonitorThread::doWork: added " << fsLocation << ", " << famStatus << endl;
 #endif
 			}
 
@@ -1552,14 +1488,14 @@
 		setLocationsToMonitor = false;
 
 #ifdef DEBUG
-		cout << "MonitorThread::do_monitoring: starting select()" << endl;
+		cout << "MonitorThread::doWork: starting select()" << endl;
 #endif
 		int fdCount = select(max(famFd, m_ctrlReadPipe) + 1, &listenSet, NULL, NULL, &selectTimeout);
 		if ((fdCount < 0) &&
 			(errno != EINTR))
 		{
 #ifdef DEBUG
-			cout << "MonitorThread::do_monitoring: select() failed" << endl;
+			cout << "MonitorThread::doWork: select() failed" << endl;
 #endif
 			break;
 		}
@@ -1571,7 +1507,7 @@
 			if (pendingEvents < 0)
 			{
 #ifdef DEBUG
-				cout << "MonitorThread::do_monitoring: FAMPending() failed" << endl;
+				cout << "MonitorThread::doWork: FAMPending() failed" << endl;
 #endif
 				break;
 			}
@@ -1588,7 +1524,7 @@
 					{
 						// Ignore pending events if the load has become too high
 #ifdef DEBUG
-						cout << "MonitorThread::do_monitoring: cancelling monitoring because of load (" << averageLoad[0] << ")" << endl;
+						cout << "MonitorThread::doWork: cancelling monitoring because of load (" << averageLoad[0] << ")" << endl;
 #endif
 						FAMCancelMonitor(&famConn, &famReq);
 						resumeMonitor = true;
@@ -1605,7 +1541,7 @@
 					bool updatedIndex = false;
 
 #ifdef DEBUG
-					cout << "MonitorThread::do_monitoring: event " << famEvent.code
+					cout << "MonitorThread::doWork: event " << famEvent.code
 						<< " on " << famEvent.filename << endl;
 #endif
 					if (famEvent.code == FAMEndExist)
@@ -1667,7 +1603,7 @@
 			{
 				// Resume
 #ifdef DEBUG
-				cout << "MonitorThread::do_monitoring: resuming monitoring" << endl;
+				cout << "MonitorThread::doWork: resuming monitoring" << endl;
 #endif
 				FAMResumeMonitor(&famConn, &famReq);
 				resumeMonitor = false;
@@ -1682,8 +1618,6 @@
 	// Stop monitoring and close the connection
 	FAMCancelMonitor(&famConn, &famReq);
 	FAMClose(&famConn);
-
-	emitSignal();
 }
 
 DirectoryScannerThread::DirectoryScannerThread(const string &dirName,
@@ -1708,11 +1642,6 @@
 {
 }
 
-Thread *DirectoryScannerThread::start(void)
-{
-	return Thread::create(slot_class(*this, &DirectoryScannerThread::do_scanning), m_joinable);
-}
-
 string DirectoryScannerThread::getType(void) const
 {
 	return "DirectoryScannerThread";
@@ -1733,7 +1662,7 @@
 	return m_signalFileFound;
 }
 
-void DirectoryScannerThread::found_file(const string &fileName)
+void DirectoryScannerThread::foundFile(const string &fileName)
 {
 	if (fileName.empty() == true)
 	{
@@ -1754,19 +1683,19 @@
 		else
 		{
 #ifdef DEBUG
-			cout << "DirectoryScannerThread::found_file: waiting" << endl;
+			cout << "DirectoryScannerThread::foundFile: waiting" << endl;
 #endif
 			// Don't resume until signaled
 			m_pCondVar->wait(*m_pMutex);
 			m_pMutex->unlock();
 #ifdef DEBUG
-			cout << "DirectoryScannerThread::found_file: signaled" << endl;
+			cout << "DirectoryScannerThread::foundFile: signaled" << endl;
 #endif
 		}
 	}
 }
 
-bool DirectoryScannerThread::scan_directory(const string &dirName)
+bool DirectoryScannerThread::scanDirectory(const string &dirName)
 {
 	struct stat fileStat;
 	int statSuccess = 0;
@@ -1800,7 +1729,7 @@
 	else if (S_ISREG(fileStat.st_mode))
 	{
 		// It's actually a file
-		found_file(dirName);
+		foundFile(dirName);
 	}
 	else if (S_ISDIR(fileStat.st_mode))
 	{
@@ -1811,7 +1740,7 @@
 			return false;
 		}
 #ifdef DEBUG
-		cout << "DirectoryScannerThread::scan_directory: entering " << dirName << endl;
+		cout << "DirectoryScannerThread::scanDirectory: entering " << dirName << endl;
 #endif
 
 		// Iterate through this directory's entries
@@ -1842,12 +1771,12 @@
 				}
 
 #ifdef DEBUG
-				cout << "DirectoryScannerThread::scan_directory: stat'ing " << entryName << endl;
+				cout << "DirectoryScannerThread::scanDirectory: stat'ing " << entryName << endl;
 #endif
 				// File or directory
 				if (S_ISREG(fileStat.st_mode))
 				{
-					found_file(entryName);
+					foundFile(entryName);
 				}
 				else if (S_ISDIR(fileStat.st_mode))
 				{
@@ -1856,9 +1785,9 @@
 						(m_currentLevel + 1 < m_maxLevel))
 					{
 						++m_currentLevel;
-						scan_directory(entryName);
+						scanDirectory(entryName);
 #ifdef DEBUG
-						cout << "DirectoryScannerThread::scan_directory: done at level "
+						cout << "DirectoryScannerThread::scanDirectory: done at level "
 							<< m_currentLevel << endl;
 #endif
 						--m_currentLevel;
@@ -1875,13 +1804,12 @@
 	return true;
 }
 
-void DirectoryScannerThread::do_scanning()
+void DirectoryScannerThread::doWork(void)
 {
-	if (scan_directory(m_dirName) == false)
+	if (scanDirectory(m_dirName) == false)
 	{
 		m_status = _("Couldn't open directory");
 		m_status += " ";
 		m_status += m_dirName;
 	}
-	emitSignal();
 }

Modified: trunk/UI/GTK2/src/WorkerThreads.h
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.h	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/UI/GTK2/src/WorkerThreads.h	2006-02-16 13:54:50 UTC (rev 115)
@@ -54,7 +54,7 @@
 
 		bool operator<(const WorkerThread &other) const;
 
-		virtual Glib::Thread *start(void) = 0;
+		Glib::Thread *start(void);
 
 		virtual std::string getType(void) const = 0;
 
@@ -75,6 +75,10 @@
 		bool m_done;
 		std::string m_status;
 
+		void threadHandler(void);
+
+		virtual void doWork(void) = 0;
+
 		void emitSignal(void);
 
 	private:
@@ -126,8 +130,6 @@
 			unsigned int maxDocsCount, unsigned int startDoc);
 		~IndexBrowserThread();
 
-		virtual Glib::Thread *start(void);
-
 		std::string getType(void) const;
 
 		std::string getIndexName(void) const;
@@ -145,7 +147,7 @@
 		unsigned int m_startDoc;
 		SigC::Signal3<void, IndexedDocument, unsigned int, std::string> m_signalUpdate;
 
-		void do_browsing();
+		virtual void doWork(void);
 
 	private:
 		IndexBrowserThread(const IndexBrowserThread &other);
@@ -160,8 +162,6 @@
 			const std::string &engineOption, const QueryProperties &queryProps);
 		virtual ~QueryingThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		std::string getEngineName(void) const;
@@ -180,7 +180,7 @@
 		std::vector<Result> m_resultsList;
 		std::string m_resultsCharset;
 
-		void do_querying();
+		virtual void doWork(void);
 
 	private:
 		QueryingThread(const QueryingThread &other);
@@ -194,8 +194,6 @@
 		LabelQueryThread(const std::string &indexName, const std::string &labelName);
 		virtual ~LabelQueryThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		std::string getIndexName(void) const;
@@ -211,7 +209,7 @@
 		std::string m_labelName;
 		std::set<unsigned int> m_documentsList;
 
-		void do_querying();
+		virtual void doWork(void);
 
 	private:
 		LabelQueryThread(const LabelQueryThread &other);
@@ -226,8 +224,6 @@
 			const std::map<std::string, std::string> &labelsToRename);
 		virtual ~LabelUpdateThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		virtual bool stop(void);
@@ -236,7 +232,7 @@
 		std::set<std::string> m_labelsToDelete;
 		std::map<std::string, std::string> m_labelsToRename;
 
-		void do_update();
+		virtual void doWork(void);
 
 	private:
 		LabelUpdateThread(const LabelUpdateThread &other);
@@ -250,8 +246,6 @@
 		DownloadingThread(const std::string url, bool fromCache);
 		virtual ~DownloadingThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		std::string getURL(void) const;
@@ -264,10 +258,9 @@
 		std::string m_url;
 		bool m_fromCache;
 		Document *m_pDoc;
-		bool m_signalAfterDownload;
 		DownloaderInterface *m_downloader;
 
-		void do_downloading();
+		virtual void doWork(void);
 
 	private:
 		DownloadingThread(const DownloadingThread &other);
@@ -282,8 +275,6 @@
 			unsigned int docId = 0);
 		virtual ~IndexingThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		const DocumentInfo &getDocumentInfo(void) const;
@@ -304,7 +295,7 @@
 		bool m_ignoreRobotsDirectives;
 		bool m_update;
 
-		void do_indexing();
+		virtual void doWork(void);
 
 	private:
 		IndexingThread(const IndexingThread &other);
@@ -321,8 +312,6 @@
 		UnindexingThread(const std::set<std::string> &labelNames, const std::string &indexLocation);
 		virtual ~UnindexingThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		unsigned int getDocumentsCount(void) const;
@@ -335,7 +324,7 @@
 		std::string m_indexLocation;
 		unsigned int m_docsCount;
 
-		void do_unindexing();
+		virtual void doWork(void);
 
 	private:
 		UnindexingThread(const UnindexingThread &other);
@@ -351,8 +340,6 @@
 			unsigned int docId, const DocumentInfo &docInfo);
 		virtual ~UpdateDocumentThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		unsigned int getDocumentID(void) const;
@@ -366,7 +353,7 @@
 		unsigned int m_docId;
 		DocumentInfo m_docInfo;
 
-		void do_update();
+		virtual void doWork(void);
 
 	private:
 		UpdateDocumentThread(const UpdateDocumentThread &other);
@@ -380,8 +367,6 @@
 		ListenerThread(const std::string &fifoFileName);
 		virtual ~ListenerThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		virtual bool stop(void);
@@ -394,7 +379,7 @@
 		std::string m_fifoFileName;
 		SigC::Signal2<void, DocumentInfo, std::string> m_signalReception;
 
-		void do_listening();
+		virtual void doWork(void);
 
 	private:
 		ListenerThread(const ListenerThread &other);
@@ -408,8 +393,6 @@
 		MonitorThread(MonitorHandler *pHandler);
 		virtual ~MonitorThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		virtual bool stop(void);
@@ -420,7 +403,7 @@
 		MonitorHandler *m_pHandler;
 		long m_numCPUs;
 
-		void do_monitoring();
+		virtual void doWork(void);
 
 	private:
 		MonitorThread(const MonitorThread &other);
@@ -436,8 +419,6 @@
 			Glib::Mutex *pMutex, Glib::Cond *pCondVar);
 		virtual ~DirectoryScannerThread();
 
-		virtual Glib::Thread *start(void);
-
 		virtual std::string getType(void) const;
 
 		virtual bool stop(void);
@@ -453,9 +434,9 @@
 		unsigned int m_currentLevel;
 		SigC::Signal1<bool, const std::string&> m_signalFileFound;
 
-		void found_file(const std::string &fileName);
-		bool scan_directory(const std::string &dirName);
-		void do_scanning();
+		void foundFile(const std::string &fileName);
+		bool scanDirectory(const std::string &dirName);
+		virtual void doWork(void);
 
 	private:
 		DirectoryScannerThread(const DirectoryScannerThread &other);

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-02-16 13:54:50 UTC (rev 115)
@@ -174,7 +174,10 @@
 	m_pHtmlView = new HtmlView(NULL);
 	if (m_settings.m_browseResults == false)
 	{
-		view_document("file:///usr/share/pinot/index.html", true);
+		string startPage("file://");
+		startPage += PREFIX;
+		startPage += "/share/pinot/index.html";
+		view_document(startPage, true);
 	}
 
 	// Gray out menu items
@@ -1381,8 +1384,12 @@
 		}
 		else
 		{
-			// Reopen the view page
-			view_document("file:///usr/share/pinot/index.html", true);
+			string startPage("file://");
+
+			// Reopen the start page
+			startPage += PREFIX;
+			startPage += "/share/pinot/index.html";
+			view_document(startPage, true);
 		}
 	}
 

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/UI/GTK2/src/pinot.cc	2006-02-16 13:54:50 UTC (rev 115)
@@ -86,6 +86,7 @@
 
 int main(int argc, char **argv)
 {
+	string prefixDir(PREFIX);
 	struct sigaction newAction;
 
 #if defined(ENABLE_NLS)
@@ -130,10 +131,10 @@
 
 	// Load the settings
 	settings.load();
-	settings.loadSearchEngines("/usr/share/pinot/engines");
+	settings.loadSearchEngines(prefixDir + string("/share/pinot/engines"));
 	settings.loadSearchEngines(confDirectory + string("/engines"));
 	// Load tokenizer libraries, if any
-	TokenizerFactory::loadTokenizers("/usr/share/pinot/tokenizers");
+	TokenizerFactory::loadTokenizers(prefixDir + string("/share/pinot/tokenizers"));
 	TokenizerFactory::loadTokenizers(confDirectory + string("/tokenizers"));
 
 	// Catch interrupts
@@ -169,7 +170,7 @@
 	try
 	{
 		// Set an icon for all windows
-		Gtk::Window::set_default_icon_from_file("/usr/share/icons/hicolor/48x48/apps/pinot.png");
+		Gtk::Window::set_default_icon_from_file(prefixDir + string("/share/icons/hicolor/48x48/apps/pinot.png"));
 
 		// Create and open the main dialog box
 		mainWindow mainBox;

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/configure.in	2006-02-16 13:54:50 UTC (rev 115)
@@ -25,18 +25,26 @@
 		[the gettext domain])
 
 dnl Add the languages which your application supports here.
-ALL_LINGUAS="fr_FR es_ES"
+ALL_LINGUAS="fr es"
 AM_GNU_GETTEXT([external]) 
 AM_GLIB_GNU_GETTEXT
 
 dnl Set PACKAGE_LOCALE_DIR in config.h.
 if test "x${prefix}" = "xNONE"; then
   AC_DEFINE_UNQUOTED(PACKAGE_LOCALE_DIR, "${ac_default_prefix}/${DATADIRNAME}/locale",
-		[the location of locale files])
+		[Define to the location of locale files.])
 else
   AC_DEFINE_UNQUOTED(PACKAGE_LOCALE_DIR, "${prefix}/${DATADIRNAME}/locale",
-		[the location of locale files])
+		[Define to the location of locale files.])
 fi
+dnl And set PREFIX in config.h.
+if test "x${prefix}" = "xNONE"; then
+  AC_DEFINE_UNQUOTED(PREFIX, "${ac_default_prefix}",
+		[Define to the package prefix.])
+else
+  AC_DEFINE_UNQUOTED(PREFIX, "${prefix}",
+		[Define to the package prefix.])
+fi
 
 AC_LANG_CPLUSPLUS
 

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/pinot.spec.in	2006-02-16 13:54:50 UTC (rev 115)
@@ -11,8 +11,8 @@
 Source: %{name}-%{version}.tar.gz
 URL: http://pinot.berlios.de/
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
-Requires: xapian-core-libs >= 0.9.2, neon >= 0.24, gtkmm24 >= 2.6, libxml++ >= 2.12, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
-BuildRequires: xapian-core-devel >= 0.9.2, neon-devel >= 0.24, gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
+Requires: xapian-core-libs >= 0.9.3, neon >= 0.24, gtkmm24 >= 2.6, libxml++ >= 2.12, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
+BuildRequires: xapian-core-devel >= 0.9.3, neon-devel >= 0.24, gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
 
 %description
 Pinot is a metasearch tool for the Free Desktop. It enables one to query

Copied: trunk/po/es.po (from rev 110, trunk/po/es_ES.po)
===================================================================
--- trunk/po/es_ES.po	2006-02-15 12:55:04 UTC (rev 110)
+++ trunk/po/es.po	2006-02-16 13:54:50 UTC (rev 115)
@@ -0,0 +1,872 @@
+# es PO file for pinot.
+# Copyright (C) 2006 Fabrice Colin, Jes?s Tramullas
+# This file is distributed under the same license as the pinot package.
+# Jes?s Tramullas <jesus at tramullas.com>, 2006.
+#
+#, fuzzy
+msgid ""
+msgstr ""
+"Project-Id-Version: pinot 0.43\n"
+"Report-Msgid-Bugs-To: \n"
+"POT-Creation-Date: 2006-02-16 21:57+0800\n"
+"PO-Revision-Date: 2006-01-30 16:44+0800\n"
+"Last-Translator: Jes?s Tramullas <jesus at tramullas.com>\n"
+"Language-Team: es <jesus at tramullas.com>\n"
+"MIME-Version: 1.0\n"
+"Content-Type: text/plain; charset=utf-8\n"
+"Content-Transfer-Encoding: 8bit\n"
+
+#: UI/GTK2/src/EnginesTree.cpp:67
+msgid "Search Engines"
+msgstr "Motores de b?squeda"
+
+#: UI/GTK2/src/EnginesTree.cpp:291
+msgid "Current User"
+msgstr "Usuario"
+
+#. Populate the submenu
+#. Bind the callback's parameter to the index name
+#. Enable these menu items, unless the index is not the documents index
+#. Internal indices
+#: UI/GTK2/src/EnginesTree.cpp:303 UI/GTK2/src/mainWindow.cc:343
+#: UI/GTK2/src/mainWindow.cc:346 UI/GTK2/src/mainWindow.cc:519
+#: UI/GTK2/src/mainWindow.cc:1054 UI/GTK2/src/mainWindow.cc:1138
+#: UI/GTK2/src/mainWindow.cc:1173 UI/GTK2/src/mainWindow.cc:1790
+#: UI/GTK2/src/PinotSettings.cpp:199 UI/GTK2/src/PinotSettings.cpp:881
+#: UI/GTK2/src/PinotSettings.cpp:937
+msgid "My Documents"
+msgstr "Mis documentos"
+
+#. Bind the callback's parameter to the index name
+#. Signal
+#: UI/GTK2/src/EnginesTree.cpp:307 UI/GTK2/src/mainWindow.cc:349
+#: UI/GTK2/src/mainWindow.cc:352 UI/GTK2/src/mainWindow.cc:523
+#: UI/GTK2/src/MonitorHandler.cpp:173 UI/GTK2/src/PinotSettings.cpp:200
+#: UI/GTK2/src/PinotSettings.cpp:882 UI/GTK2/src/PinotSettings.cpp:938
+#: UI/GTK2/src/prefsDialog_glade.cc:116
+msgid "My Email"
+msgstr "Mi email"
+
+#: UI/GTK2/src/importDialog.cc:108
+msgid "Enabled"
+msgstr "Activo"
+
+#: UI/GTK2/src/importDialog.cc:109 UI/GTK2/src/prefsDialog.cc:78
+msgid "MIME Type"
+msgstr "Tipo MIME"
+
+#: UI/GTK2/src/importDialog.cc:134
+msgid "File"
+msgstr "Fichero"
+
+#: UI/GTK2/src/importDialog.cc:137
+msgid "Directory"
+msgstr "Directorio"
+
+#. The last column is for the URL
+#: UI/GTK2/src/importDialog.cc:142 UI/GTK2/src/IndexTree.cpp:70
+#: UI/GTK2/src/ResultsTree.cpp:114
+msgid "URL"
+msgstr "URL"
+
+#: UI/GTK2/src/importDialog.cc:148 UI/GTK2/src/IndexPage.cpp:158
+#: UI/GTK2/src/IndexPage.cpp:204 UI/GTK2/src/queryDialog.cc:91
+msgid "None"
+msgstr "Ninguno"
+
+#: UI/GTK2/src/importDialog.cc:444
+msgid "Document To Import"
+msgstr "Documento a importar"
+
+#: UI/GTK2/src/importDialog_glade.cc:66 UI/GTK2/src/indexDialog_glade.cc:68
+msgid "Location:"
+msgstr "Localizaci?n:"
+
+#: UI/GTK2/src/importDialog_glade.cc:67
+#: UI/GTK2/src/propertiesDialog_glade.cc:64
+msgid "Title:"
+msgstr "T?tulo:"
+
+#: UI/GTK2/src/importDialog_glade.cc:70 UI/GTK2/src/indexDialog_glade.cc:67
+msgid "Type:"
+msgstr "Tipo:"
+
+#: UI/GTK2/src/importDialog_glade.cc:72 UI/GTK2/src/indexDialog_glade.cc:64
+#: UI/GTK2/src/prefsDialog_glade.cc:70
+msgid "..."
+msgstr "..."
+
+#: UI/GTK2/src/importDialog_glade.cc:78
+msgid "Depth:"
+msgstr "Profundidad:"
+
+#: UI/GTK2/src/importDialog_glade.cc:79
+msgid "Symlinks:"
+msgstr "Enlaces:"
+
+#: UI/GTK2/src/importDialog_glade.cc:80
+msgid "Follow symlinks"
+msgstr "Seguir los enlaces"
+
+#: UI/GTK2/src/importDialog_glade.cc:83
+msgid "Apply label:"
+msgstr "Etiqueta aplicada:"
+
+#: UI/GTK2/src/importDialog_glade.cc:91 UI/GTK2/src/mainWindow_glade.cc:201
+msgid "Import"
+msgstr "Importar"
+
+#: UI/GTK2/src/importDialog_glade.cc:211
+msgid "Import document"
+msgstr "Importar documento"
+
+#: UI/GTK2/src/indexDialog.cc:221
+msgid "Index location"
+msgstr "Localizaci?n del ?ndice"
+
+#: UI/GTK2/src/indexDialog_glade.cc:62 UI/GTK2/src/queryDialog_glade.cc:60
+msgid "Name:"
+msgstr "Nombre:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:69
+msgid "Port:"
+msgstr "Puerto:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:143
+msgid "External index"
+msgstr "?ndice externo"
+
+#. The score column is used for status icons
+#. The title column is also used for status icons
+#: UI/GTK2/src/IndexTree.cpp:64 UI/GTK2/src/ResultsTree.cpp:96
+msgid "Title"
+msgstr "T?tulo"
+
+#: UI/GTK2/src/IndexTree.cpp:75
+msgid "Timestamp"
+msgstr "Fecha"
+
+#: UI/GTK2/src/IndexPage.cpp:50
+msgid "Show Previous"
+msgstr "Mostrar previos"
+
+#: UI/GTK2/src/IndexPage.cpp:56
+msgid "Show Next"
+msgstr "Mostrar siguientes"
+
+#: UI/GTK2/src/mainWindow.cc:144
+msgid "Query Name"
+msgstr "Nombre de la b?squeda"
+
+#: UI/GTK2/src/mainWindow.cc:149
+msgid "Last Run"
+msgstr "?ltima ejecuci?n"
+
+#: UI/GTK2/src/mainWindow.cc:150
+msgid "Summary"
+msgstr "Sumario"
+
+#. Set tooltips
+#: UI/GTK2/src/mainWindow.cc:210
+msgid "Add index"
+msgstr "A?adir ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:211
+msgid "Remove index"
+msgstr "Borrar ?ndice"
+
+#. The handler object will be deleted when the thread terminates
+#. Now we are ready
+#: UI/GTK2/src/mainWindow.cc:234
+msgid "Ready"
+msgstr "Listo"
+
+#. Stop in case we were loading a page
+#. Close the existing view page
+#: UI/GTK2/src/mainWindow.cc:248 UI/GTK2/src/mainWindow.cc:1011
+#: UI/GTK2/src/mainWindow.cc:1383 UI/GTK2/src/mainWindow.cc:2960
+#: UI/GTK2/src/mainWindow_glade.cc:207
+msgid "View"
+msgstr "Ver"
+
+#: UI/GTK2/src/mainWindow.cc:280
+msgid "N/A"
+msgstr "Desconocido"
+
+#: UI/GTK2/src/mainWindow.cc:290
+msgid "<undefined>"
+msgstr "<indefinido>"
+
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:481
+msgid "Result location is"
+msgstr "La localizaci?n del resultado es"
+
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:534
+msgid "Document location is"
+msgstr "La localizaci?n del documento es"
+
+#. User selected no label
+#: UI/GTK2/src/mainWindow.cc:643
+msgid "No label"
+msgstr "Sin etiqueta"
+
+#: UI/GTK2/src/mainWindow.cc:792
+msgid "Showing"
+msgstr "Mostrando"
+
+#: UI/GTK2/src/mainWindow.cc:797
+msgid "off"
+msgstr "desactivado"
+
+#: UI/GTK2/src/mainWindow.cc:802
+msgid "documents, starting at"
+msgstr "documentos comenzando en"
+
+#: UI/GTK2/src/mainWindow.cc:836
+msgid "Query"
+msgstr "B?squeda"
+
+#: UI/GTK2/src/mainWindow.cc:840 UI/GTK2/src/mainWindow.cc:2789
+msgid "on"
+msgstr "en"
+
+#: UI/GTK2/src/mainWindow.cc:844
+msgid "ended"
+msgstr "finalizado"
+
+#: UI/GTK2/src/mainWindow.cc:945 UI/GTK2/src/propertiesDialog.cc:40
+msgid "Label"
+msgstr "Etiqueta"
+
+#: UI/GTK2/src/mainWindow.cc:949
+msgid "matches"
+msgstr "correspondencias"
+
+#: UI/GTK2/src/mainWindow.cc:954
+msgid "document(s)"
+msgstr "documento(s)"
+
+#: UI/GTK2/src/mainWindow.cc:986
+msgid "Updated label(s)"
+msgstr "Etiqueta(s) actualizada(s)"
+
+#. Yes, it did
+#: UI/GTK2/src/mainWindow.cc:1064 UI/GTK2/src/mainWindow.cc:1184
+msgid "Updated document"
+msgstr "Documento actualizado"
+
+#: UI/GTK2/src/mainWindow.cc:1077
+msgid "Indexed"
+msgstr "Indizado"
+
+#: UI/GTK2/src/mainWindow.cc:1139
+msgid "Unindexed document(s)"
+msgstr "Documento(s) no indizado(s)"
+
+#: UI/GTK2/src/mainWindow.cc:1235
+msgid "Couldn't rename index, name"
+msgstr "No se podu renombrar el ?ndice, nombre"
+
+#: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:2144
+#: UI/GTK2/src/mainWindow.cc:2623
+msgid "is already in use"
+msgstr "ya est? en uso"
+
+#: UI/GTK2/src/mainWindow.cc:1252
+msgid "Couldn't rename index"
+msgstr "No se pudo renombrar el ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:1265
+msgid "Edited index"
+msgstr "?ndice editado"
+
+#: UI/GTK2/src/mainWindow.cc:1729 UI/GTK2/src/mainWindow.cc:1832
+msgid "Please set a location for the index first"
+msgstr "Por favor, primero fije una localizaci?n para el ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:1756
+msgid "Result location is unknown"
+msgstr "Se desconoce la localizaci?n del resultado"
+
+#: UI/GTK2/src/mainWindow.cc:1780
+msgid "Import Document(s)"
+msgstr "Importar Documento(s)"
+
+#: UI/GTK2/src/mainWindow.cc:1910 UI/GTK2/src/pinot.cc:150
+#: UI/GTK2/src/pinot.cc:155 UI/GTK2/src/WorkerThreads.cpp:395
+#: UI/GTK2/src/WorkerThreads.cpp:614 UI/GTK2/src/WorkerThreads.cpp:1175
+msgid "Index"
+msgstr "?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:1914 UI/GTK2/src/WorkerThreads.cpp:399
+#: UI/GTK2/src/WorkerThreads.cpp:618 UI/GTK2/src/WorkerThreads.cpp:1179
+msgid "doesn't exist"
+msgstr "no existe"
+
+#: UI/GTK2/src/mainWindow.cc:2024
+msgid "Delete this document from the index ?"
+msgstr "Enlever ce document de l'index ?"
+
+#: UI/GTK2/src/mainWindow.cc:2043
+msgid "Delete these documents from the index ?"
+msgstr "?Borrar este documento del ?ndice?"
+
+#: UI/GTK2/src/mainWindow.cc:2095
+msgid "A metasearch tool for the Free Desktop"
+msgstr "Una herramienta metabuscador para el escritorio libre"
+
+#: UI/GTK2/src/mainWindow.cc:2096
+msgid "(C) 2005-2006 Fabrice Colin"
+msgstr "(C) 2005-2006 Fabrice Colin"
+
+#: UI/GTK2/src/mainWindow.cc:2140
+msgid "Index name"
+msgstr "Nombre del ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:2155
+msgid "Couldn't add index"
+msgstr "No se pudo a?adir el ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:2169
+msgid "Added new index"
+msgstr "A?adido un nuevo ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:2204
+msgid "Couldn't remove index"
+msgstr "No se pudo borrar el ?ndice"
+
+#: UI/GTK2/src/mainWindow.cc:2285
+#, fuzzy
+msgid "Live query"
+msgstr "B?squeda editada"
+
+#: UI/GTK2/src/mainWindow.cc:2438
+msgid "At least one task hasn't completed yet. Quit now ?"
+msgstr "Al menos una tarea no ha finalizado. ?Parar ahora?"
+
+#: UI/GTK2/src/mainWindow.cc:2619
+msgid "Query name"
+msgstr "Nombre la b?squeda"
+
+#: UI/GTK2/src/mainWindow.cc:2646
+msgid "Couldn't update query"
+msgstr "No se pudo actualizar la b?squeda"
+
+#: UI/GTK2/src/mainWindow.cc:2654
+msgid "Edited query"
+msgstr "B?squeda editada"
+
+#: UI/GTK2/src/mainWindow.cc:2661
+msgid "Couldn't add query"
+msgstr "No se pudo a?adir la b?squeda"
+
+#: UI/GTK2/src/mainWindow.cc:2669
+msgid "Added new query"
+msgstr "A?adida una nueva b?squeda"
+
+#: UI/GTK2/src/mainWindow.cc:2683
+msgid "Query is not set"
+msgstr "B?squeda no definida"
+
+#: UI/GTK2/src/mainWindow.cc:2694
+msgid "No search engine selected"
+msgstr "Motor de b?squeda no seleccionado"
+
+#: UI/GTK2/src/mainWindow.cc:2776
+msgid "Please set the Google API key first"
+msgstr "Por favor, primero configure el API de Google"
+
+#: UI/GTK2/src/mainWindow.cc:2785
+msgid "Running query"
+msgstr "Ejecutando la b?squeda"
+
+#: UI/GTK2/src/mainWindow.cc:2891
+msgid "is already indexed or is being indexed"
+msgstr "ya ha sido indizado, o se est? indizando"
+
+#: UI/GTK2/src/mainWindow.cc:2918
+msgid "No URL to browse"
+msgstr "No hay URL que mostrar"
+
+#: UI/GTK2/src/mainWindow.cc:2929
+msgid "No browser configured to view results"
+msgstr "NO ha configurado un navegador para ver los resultados"
+
+#: UI/GTK2/src/mainWindow.cc:2941
+msgid "Couldn't browse URL:"
+msgstr "No se pudo mostrar el URL:"
+
+#: UI/GTK2/src/mainWindow.cc:3000
+#, fuzzy
+msgid "Viewing"
+msgstr "Ver"
+
+#: UI/GTK2/src/mainWindow_glade.cc:115
+msgid "Query:"
+msgstr "B?squeda:"
+
+#: UI/GTK2/src/mainWindow_glade.cc:127 UI/GTK2/src/prefsDialog_glade.cc:86
+msgid "Edit"
+msgstr "Editar"
+
+#: UI/GTK2/src/mainWindow_glade.cc:136
+msgid "Stored queries"
+msgstr "B?squedas guardadas"
+
+#: UI/GTK2/src/mainWindow_glade.cc:171
+msgid "Search Engine"
+msgstr "Motores de b?squeda"
+
+#: UI/GTK2/src/mainWindow_glade.cc:174
+msgid "Host Name"
+msgstr "Nombre del servidor"
+
+#: UI/GTK2/src/mainWindow_glade.cc:177
+msgid "Clear List"
+msgstr "Limpiar la lista"
+
+#: UI/GTK2/src/mainWindow_glade.cc:180
+msgid "Show Extract"
+msgstr "Mostrar extra?dos"
+
+#: UI/GTK2/src/mainWindow_glade.cc:183
+msgid "Group By"
+msgstr "Agrupar por"
+
+#: UI/GTK2/src/mainWindow_glade.cc:189
+msgid "Vie_w"
+msgstr "Ver"
+
+#: UI/GTK2/src/mainWindow_glade.cc:192
+msgid "View Cache"
+msgstr "Ver la cache"
+
+#: UI/GTK2/src/mainWindow_glade.cc:195 UI/GTK2/src/mainWindow_glade.cc:231
+msgid "_Index"
+msgstr "?ndice"
+
+#: UI/GTK2/src/mainWindow_glade.cc:198
+msgid "List Contents Of"
+msgstr "Listar el contenido de"
+
+#: UI/GTK2/src/mainWindow_glade.cc:210
+msgid "Update"
+msgstr "Actualizar"
+
+#: UI/GTK2/src/mainWindow_glade.cc:213
+msgid "Unindex"
+msgstr "Desindizar"
+
+#: UI/GTK2/src/mainWindow_glade.cc:216
+#: UI/GTK2/src/propertiesDialog_glade.cc:171
+#: UI/GTK2/src/queryDialog_glade.cc:83
+msgid "Properties"
+msgstr "Propiedades"
+
+#: UI/GTK2/src/mainWindow_glade.cc:219
+msgid "_About"
+msgstr "Sobre"
+
+#: UI/GTK2/src/mainWindow_glade.cc:222
+msgid "_Session"
+msgstr "Sesi?n"
+
+#: UI/GTK2/src/mainWindow_glade.cc:225
+msgid "_Edit"
+msgstr "Editar"
+
+#: UI/GTK2/src/mainWindow_glade.cc:228
+msgid "_Results"
+msgstr "Resultados"
+
+#: UI/GTK2/src/mainWindow_glade.cc:234
+msgid "_Help"
+msgstr "Ayuda"
+
+#: UI/GTK2/src/mainWindow_glade.cc:356
+msgid "Pinot"
+msgstr "Pinot"
+
+#: UI/GTK2/src/pinot.cc:56
+msgid "Couldn't save configuration file"
+msgstr "No se pudo guardar el fichero de configuraci?n"
+
+#. Localize language names
+#: UI/GTK2/src/pinot.cc:119
+msgid "Danish"
+msgstr "Dan?s"
+
+#: UI/GTK2/src/pinot.cc:120
+msgid "Dutch"
+msgstr "Holand?s"
+
+#: UI/GTK2/src/pinot.cc:121
+msgid "English"
+msgstr "Ingl?s"
+
+#: UI/GTK2/src/pinot.cc:122
+msgid "Finnish"
+msgstr "Finland?s"
+
+#: UI/GTK2/src/pinot.cc:123
+msgid "French"
+msgstr "Franc?s"
+
+#: UI/GTK2/src/pinot.cc:124
+msgid "German"
+msgstr "Alem?n"
+
+#: UI/GTK2/src/pinot.cc:125
+msgid "Italian"
+msgstr "Italiano"
+
+#: UI/GTK2/src/pinot.cc:126
+msgid "Norwegian"
+msgstr "Noruego"
+
+#: UI/GTK2/src/pinot.cc:127
+msgid "Portuguese"
+msgstr "Portugu?s"
+
+#: UI/GTK2/src/pinot.cc:128
+msgid "Russian"
+msgstr "Ruso"
+
+#: UI/GTK2/src/pinot.cc:129
+msgid "Spanish"
+msgstr "Espa?ol"
+
+#: UI/GTK2/src/pinot.cc:130
+msgid "Swedish"
+msgstr "Sueco"
+
+#: UI/GTK2/src/pinot.cc:151 UI/GTK2/src/pinot.cc:156
+msgid "is not valid, please check"
+msgstr "no es v?lido, por favor compru?belo"
+
+#: UI/GTK2/src/pinot.cc:164
+msgid "History database"
+msgstr "Base de datos del hist?rico"
+
+#: UI/GTK2/src/pinot.cc:165
+msgid "couldn't be created"
+msgstr "no se pudo crear"
+
+#: UI/GTK2/src/PinotSettings.cpp:106
+msgid "Couldn't create pinot directory at"
+msgstr "No se pudo crear un directorio pinot en"
+
+#: UI/GTK2/src/PinotSettings.cpp:195
+msgid "Failed to parse configuration file"
+msgstr "Fallo en el fichero de configuraci?n"
+
+#: UI/GTK2/src/PinotSettings.cpp:204
+msgid "Red"
+msgstr "Rojo"
+
+#: UI/GTK2/src/PinotSettings.cpp:206
+msgid "Blue"
+msgstr "Azul"
+
+#: UI/GTK2/src/PinotSettings.cpp:208
+msgid "Green"
+msgstr "Verde"
+
+#: UI/GTK2/src/PinotSettings.cpp:289
+msgid "Couldn't load ui block"
+msgstr "No se pudo cargar el bloque ui"
+
+#: UI/GTK2/src/PinotSettings.cpp:296
+msgid "Couldn't load extraindex block"
+msgstr "No se pudo cargar el bloque extraindex"
+
+#: UI/GTK2/src/PinotSettings.cpp:303
+msgid "Couldn't load storedquery block"
+msgstr "No se pudo cargar el bloque storedquery"
+
+#: UI/GTK2/src/PinotSettings.cpp:310
+msgid "Couldn't load results block"
+msgstr "o se pudo cargar el bloque results"
+
+#: UI/GTK2/src/PinotSettings.cpp:317
+msgid "Couldn't load label block"
+msgstr "o se pudo cargar el bloque label"
+
+#: UI/GTK2/src/PinotSettings.cpp:335
+msgid "Couldn't load mailaccount block"
+msgstr "No se pudo cargar el bloque mailaccount"
+
+#: UI/GTK2/src/PinotSettings.cpp:343
+msgid "Couldn't parse configuration file"
+msgstr "No se pudo procesar el fichero de configuraci?n"
+
+#: UI/GTK2/src/PinotSettings.cpp:732
+msgid "Unclassified"
+msgstr "No clasificado"
+
+#: UI/GTK2/src/prefsDialog.cc:69
+msgid "Name"
+msgstr "Nombre"
+
+#: UI/GTK2/src/prefsDialog.cc:77
+msgid "Location"
+msgstr "Localizaci?n"
+
+#: UI/GTK2/src/prefsDialog.cc:114
+msgid "In internal viewer"
+msgstr "En el visor interno"
+
+#: UI/GTK2/src/prefsDialog.cc:117
+msgid "In browser"
+msgstr "En el navegador"
+
+#: UI/GTK2/src/prefsDialog.cc:332
+msgid "Browser location"
+msgstr "Mostrar la localizaci?n"
+
+#: UI/GTK2/src/prefsDialog.cc:343
+msgid "New Label"
+msgstr "Nueva etiqueta"
+
+#: UI/GTK2/src/prefsDialog.cc:365
+msgid "Colour"
+msgstr "Color"
+
+#. Let the user edit the location
+#: UI/GTK2/src/prefsDialog.cc:436 UI/GTK2/src/prefsDialog.cc:470
+msgid "Mbox File Location"
+msgstr "Localizaci?n del fichero mbox"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:62
+msgid "HTTP crawling:"
+msgstr "Navegador HTTP:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:63
+msgid "View documents:"
+msgstr "Ver los documentos"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:64
+msgid "Browser:"
+msgstr "Navegador:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:65
+msgid "Google API key:"
+msgstr "Clave del API de Google"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:68
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "Ignorar robots.txt y la etiqueta META Robots"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "General"
+msgstr "General"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:75
+msgid "Labels are used to classify indexed documents:"
+msgstr "Las etiquetas se usan para clasificar los documentos indizados:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80 UI/GTK2/src/prefsDialog_glade.cc:106
+msgid "Add"
+msgstr "A?adir"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:92
+msgid "Remove"
+msgstr "Borrar"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:100
+msgid "Labels"
+msgstr "Etiquetas"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:101
+msgid "Mail boxes of type mbox can be monitored and indexed:"
+msgstr "Lo sbuzones de correo de tipo mbox pueden ser controlados e indizados"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:332
+msgid "Preferences"
+msgstr "Preferencias"
+
+#: UI/GTK2/src/propertiesDialog.cc:51
+msgid "Unknown"
+msgstr "Desconocido"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:65
+msgid "Extract:"
+msgstr "Extraer:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:66
+msgid "Language:"
+msgstr "Idioma:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:68
+msgid "MIME type:"
+msgstr "Tipo MIME:"
+
+#: UI/GTK2/src/queryDialog.cc:96 UI/GTK2/src/queryDialog.cc:125
+msgid "Any"
+msgstr "Cualquiera"
+
+#: UI/GTK2/src/queryDialog_glade.cc:70
+msgid "Index all results with label"
+msgstr "Indizar todos los resultados con la etiqueta"
+
+#: UI/GTK2/src/queryDialog_glade.cc:72
+msgid "Any of the words:"
+msgstr "Cualquiera de las palabras:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:73
+msgid "File name:"
+msgstr "Nombre de fichero:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:74
+msgid "Number of results:"
+msgstr "N?mero de resultados:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:77
+msgid "Host name:"
+msgstr "Nombre del servidor:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:78
+msgid "None of the words:"
+msgstr "Ninguna de las palabras:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:84
+msgid "Limit to documents that match"
+msgstr "Limitar a los documentos que coincidan"
+
+#: UI/GTK2/src/queryDialog_glade.cc:87
+msgid "the exact phrase:"
+msgstr "la frase exacta"
+
+#: UI/GTK2/src/queryDialog_glade.cc:88
+msgid "the language:"
+msgstr "el idioma"
+
+#: UI/GTK2/src/queryDialog_glade.cc:92
+msgid "all the words:"
+msgstr "todas las palabras:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:93
+msgid "the label:"
+msgstr "la etiqueta"
+
+#: UI/GTK2/src/queryDialog_glade.cc:98
+msgid "Advanced"
+msgstr "Avanzado"
+
+#: UI/GTK2/src/queryDialog_glade.cc:283
+msgid "Query properties"
+msgstr "Propriedades de la b?squeda"
+
+#: UI/GTK2/src/WorkerThreads.cpp:374
+msgid "Stopped browsing"
+msgstr "Exploraci?n detenida"
+
+#: UI/GTK2/src/WorkerThreads.cpp:407 UI/GTK2/src/WorkerThreads.cpp:625
+#: UI/GTK2/src/WorkerThreads.cpp:662 UI/GTK2/src/WorkerThreads.cpp:671
+#: UI/GTK2/src/WorkerThreads.cpp:864 UI/GTK2/src/WorkerThreads.cpp:1068
+#: UI/GTK2/src/WorkerThreads.cpp:1187
+msgid "Index error on"
+msgstr "Error en el ?ndice"
+
+#: UI/GTK2/src/WorkerThreads.cpp:504
+msgid "Stopped querying"
+msgstr "B?squeda detenida"
+
+#: UI/GTK2/src/WorkerThreads.cpp:516
+msgid "Couldn't create search engine"
+msgstr "No se pudo crear el motor de b?squeda"
+
+#: UI/GTK2/src/WorkerThreads.cpp:527
+msgid "Couldn't run query on search engine"
+msgstr "No se pudo ejecutar la b?squeda contra el motor"
+
+#: UI/GTK2/src/WorkerThreads.cpp:543
+msgid "No title"
+msgstr "Sin t?tulo"
+
+#: UI/GTK2/src/WorkerThreads.cpp:598 UI/GTK2/src/WorkerThreads.cpp:653
+msgid "Stopped querying index labels"
+msgstr "Detenida la b?squeda de etiquetas de ?ndice"
+
+#: UI/GTK2/src/WorkerThreads.cpp:732
+msgid "Stopped retrieval of"
+msgstr "Detenida la recuperaci?n de"
+
+#: UI/GTK2/src/WorkerThreads.cpp:768
+msgid "Couldn't obtain downloader for protocol"
+msgstr "No se pudo usar un recuperador para el protocolo"
+
+#: UI/GTK2/src/WorkerThreads.cpp:782 UI/GTK2/src/WorkerThreads.cpp:877
+msgid "Couldn't retrieve"
+msgstr "No se pudo descargar"
+
+#: UI/GTK2/src/WorkerThreads.cpp:849
+msgid "Stopped indexing"
+msgstr "Detenida la indizaci?n"
+
+#: UI/GTK2/src/WorkerThreads.cpp:901
+msgid "Cannot index document type"
+msgstr "No se pudo indizar el tipo de documento"
+
+#: UI/GTK2/src/WorkerThreads.cpp:905
+msgid "at"
+msgstr "a"
+
+#: UI/GTK2/src/WorkerThreads.cpp:929
+msgid "Couldn't tokenize"
+msgstr "No se pudo parcourir"
+
+#: UI/GTK2/src/WorkerThreads.cpp:949
+msgid "Robots META tag forbids indexing"
+msgstr "La etiqueta META Robots proh?be la indizaci?n"
+
+#: UI/GTK2/src/WorkerThreads.cpp:998
+msgid "Couldn't index"
+msgstr "No se pudo indizar"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1056
+msgid "Stopped unindexing document(s)"
+msgstr "Detenida la desindizaci?n de documento(s)"
+
+#. Be pessimistic and assume something will go wrong ;-)
+#: UI/GTK2/src/WorkerThreads.cpp:1075
+msgid "Couldn't unindex document(s)"
+msgstr "No se pudo desindizar lo(s) documento(s)"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1160
+msgid "Stopped document update for "
+msgstr "Detenida la actualizaci?n del documento por "
+
+#: UI/GTK2/src/WorkerThreads.cpp:1195
+msgid "Couldn't update document"
+msgstr "No se pudo actualizar el documento"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1238
+msgid "Stopped listening on"
+msgstr "Detenida la escucha en"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1341
+msgid "Couldn't read FIFO at"
+msgstr "No se pudo leer FIFO en"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1384
+msgid "Stopped monitoring"
+msgstr "Detenida la monitorizaci?n"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1405
+msgid "No monitoring handler"
+msgstr "No hay monitorizaci?n"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1451
+msgid "Couldn't open FAM connection"
+msgstr "No se pudo abrir la conexi?n FAM"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1653
+msgid "Stopped scanning"
+msgstr "Detenida la exploraci?n"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1811
+msgid "Couldn't open directory"
+msgstr "No se pudo abrir el directorio"

Deleted: trunk/po/es_ES.po
===================================================================
--- trunk/po/es_ES.po	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/po/es_ES.po	2006-02-16 13:54:50 UTC (rev 115)
@@ -1,872 +0,0 @@
-# es_ES PO file for pinot.
-# Copyright (C) 2006 Fabrice Colin, Jes?s Tramullas
-# This file is distributed under the same license as the pinot package.
-# Jes?s Tramullas <jesus at tramullas.com>, 2006.
-#
-#, fuzzy
-msgid ""
-msgstr ""
-"Project-Id-Version: pinot 0.42\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-02-15 20:55+0800\n"
-"PO-Revision-Date: 2006-01-30 16:44+0800\n"
-"Last-Translator: Jes?s Tramullas <jesus at tramullas.com>\n"
-"Language-Team: es_ES <jesus at tramullas.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=utf-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: UI/GTK2/src/EnginesTree.cpp:67
-msgid "Search Engines"
-msgstr "Motores de b?squeda"
-
-#: UI/GTK2/src/EnginesTree.cpp:291
-msgid "Current User"
-msgstr "Usuario"
-
-#. Populate the submenu
-#. Bind the callback's parameter to the index name
-#. Enable these menu items, unless the index is not the documents index
-#. Internal indices
-#: UI/GTK2/src/EnginesTree.cpp:303 UI/GTK2/src/mainWindow.cc:340
-#: UI/GTK2/src/mainWindow.cc:343 UI/GTK2/src/mainWindow.cc:516
-#: UI/GTK2/src/mainWindow.cc:1051 UI/GTK2/src/mainWindow.cc:1135
-#: UI/GTK2/src/mainWindow.cc:1170 UI/GTK2/src/mainWindow.cc:1783
-#: UI/GTK2/src/PinotSettings.cpp:199 UI/GTK2/src/PinotSettings.cpp:881
-#: UI/GTK2/src/PinotSettings.cpp:937
-msgid "My Documents"
-msgstr "Mis documentos"
-
-#. Bind the callback's parameter to the index name
-#. Signal
-#: UI/GTK2/src/EnginesTree.cpp:307 UI/GTK2/src/mainWindow.cc:346
-#: UI/GTK2/src/mainWindow.cc:349 UI/GTK2/src/mainWindow.cc:520
-#: UI/GTK2/src/MonitorHandler.cpp:173 UI/GTK2/src/PinotSettings.cpp:200
-#: UI/GTK2/src/PinotSettings.cpp:882 UI/GTK2/src/PinotSettings.cpp:938
-#: UI/GTK2/src/prefsDialog_glade.cc:116
-msgid "My Email"
-msgstr "Mi email"
-
-#: UI/GTK2/src/importDialog.cc:108
-msgid "Enabled"
-msgstr "Activo"
-
-#: UI/GTK2/src/importDialog.cc:109 UI/GTK2/src/prefsDialog.cc:78
-msgid "MIME Type"
-msgstr "Tipo MIME"
-
-#: UI/GTK2/src/importDialog.cc:134
-msgid "File"
-msgstr "Fichero"
-
-#: UI/GTK2/src/importDialog.cc:137
-msgid "Directory"
-msgstr "Directorio"
-
-#. The last column is for the URL
-#: UI/GTK2/src/importDialog.cc:142 UI/GTK2/src/IndexTree.cpp:70
-#: UI/GTK2/src/ResultsTree.cpp:114
-msgid "URL"
-msgstr "URL"
-
-#: UI/GTK2/src/importDialog.cc:148 UI/GTK2/src/IndexPage.cpp:158
-#: UI/GTK2/src/IndexPage.cpp:204 UI/GTK2/src/queryDialog.cc:91
-msgid "None"
-msgstr "Ninguno"
-
-#: UI/GTK2/src/importDialog.cc:444
-msgid "Document To Import"
-msgstr "Documento a importar"
-
-#: UI/GTK2/src/importDialog_glade.cc:66 UI/GTK2/src/indexDialog_glade.cc:68
-msgid "Location:"
-msgstr "Localizaci?n:"
-
-#: UI/GTK2/src/importDialog_glade.cc:67
-#: UI/GTK2/src/propertiesDialog_glade.cc:64
-msgid "Title:"
-msgstr "T?tulo:"
-
-#: UI/GTK2/src/importDialog_glade.cc:70 UI/GTK2/src/indexDialog_glade.cc:67
-msgid "Type:"
-msgstr "Tipo:"
-
-#: UI/GTK2/src/importDialog_glade.cc:72 UI/GTK2/src/indexDialog_glade.cc:64
-#: UI/GTK2/src/prefsDialog_glade.cc:70
-msgid "..."
-msgstr "..."
-
-#: UI/GTK2/src/importDialog_glade.cc:78
-msgid "Depth:"
-msgstr "Profundidad:"
-
-#: UI/GTK2/src/importDialog_glade.cc:79
-msgid "Symlinks:"
-msgstr "Enlaces:"
-
-#: UI/GTK2/src/importDialog_glade.cc:80
-msgid "Follow symlinks"
-msgstr "Seguir los enlaces"
-
-#: UI/GTK2/src/importDialog_glade.cc:83
-msgid "Apply label:"
-msgstr "Etiqueta aplicada:"
-
-#: UI/GTK2/src/importDialog_glade.cc:91 UI/GTK2/src/mainWindow_glade.cc:201
-msgid "Import"
-msgstr "Importar"
-
-#: UI/GTK2/src/importDialog_glade.cc:211
-msgid "Import document"
-msgstr "Importar documento"
-
-#: UI/GTK2/src/indexDialog.cc:221
-msgid "Index location"
-msgstr "Localizaci?n del ?ndice"
-
-#: UI/GTK2/src/indexDialog_glade.cc:62 UI/GTK2/src/queryDialog_glade.cc:60
-msgid "Name:"
-msgstr "Nombre:"
-
-#: UI/GTK2/src/indexDialog_glade.cc:69
-msgid "Port:"
-msgstr "Puerto:"
-
-#: UI/GTK2/src/indexDialog_glade.cc:143
-msgid "External index"
-msgstr "?ndice externo"
-
-#. The score column is used for status icons
-#. The title column is also used for status icons
-#: UI/GTK2/src/IndexTree.cpp:64 UI/GTK2/src/ResultsTree.cpp:96
-msgid "Title"
-msgstr "T?tulo"
-
-#: UI/GTK2/src/IndexTree.cpp:75
-msgid "Timestamp"
-msgstr "Fecha"
-
-#: UI/GTK2/src/IndexPage.cpp:50
-msgid "Show Previous"
-msgstr "Mostrar previos"
-
-#: UI/GTK2/src/IndexPage.cpp:56
-msgid "Show Next"
-msgstr "Mostrar siguientes"
-
-#: UI/GTK2/src/mainWindow.cc:144
-msgid "Query Name"
-msgstr "Nombre de la b?squeda"
-
-#: UI/GTK2/src/mainWindow.cc:149
-msgid "Last Run"
-msgstr "?ltima ejecuci?n"
-
-#: UI/GTK2/src/mainWindow.cc:150
-msgid "Summary"
-msgstr "Sumario"
-
-#. Set tooltips
-#: UI/GTK2/src/mainWindow.cc:207
-msgid "Add index"
-msgstr "A?adir ?ndice"
-
-#: UI/GTK2/src/mainWindow.cc:208
-msgid "Remove index"
-msgstr "Borrar ?ndice"
-
-#. The handler object will be deleted when the thread terminates
-#. Now we are ready
-#: UI/GTK2/src/mainWindow.cc:231
-msgid "Ready"
-msgstr "Listo"
-
-#. Stop in case we were loading a page
-#. Close the existing view page
-#: UI/GTK2/src/mainWindow.cc:245 UI/GTK2/src/mainWindow.cc:1008
-#: UI/GTK2/src/mainWindow.cc:1380 UI/GTK2/src/mainWindow.cc:2953
-#: UI/GTK2/src/mainWindow_glade.cc:207
-msgid "View"
-msgstr "Ver"
-
-#: UI/GTK2/src/mainWindow.cc:277
-msgid "N/A"
-msgstr "Desconocido"
-
-#: UI/GTK2/src/mainWindow.cc:287
-msgid "<undefined>"
-msgstr "<indefinido>"
-
-#. Show the URL in the status bar
-#: UI/GTK2/src/mainWindow.cc:478
-msgid "Result location is"
-msgstr "La localizaci?n del resultado es"
-
-#. Show the URL in the status bar
-#: UI/GTK2/src/mainWindow.cc:531
-msgid "Document location is"
-msgstr "La localizaci?n del documento es"
-
-#. User selected no label
-#: UI/GTK2/src/mainWindow.cc:640
-msgid "No label"
-msgstr "Sin etiqueta"
-
-#: UI/GTK2/src/mainWindow.cc:789
-msgid "Showing"
-msgstr "Mostrando"
-
-#: UI/GTK2/src/mainWindow.cc:794
-msgid "off"
-msgstr "desactivado"
-
-#: UI/GTK2/src/mainWindow.cc:799
-msgid "documents, starting at"
-msgstr "documentos comenzando en"
-
-#: UI/GTK2/src/mainWindow.cc:833
-msgid "Query"
-msgstr "B?squeda"
-
-#: UI/GTK2/src/mainWindow.cc:837 UI/GTK2/src/mainWindow.cc:2782
-msgid "on"
-msgstr "en"
-
-#: UI/GTK2/src/mainWindow.cc:841
-msgid "ended"
-msgstr "finalizado"
-
-#: UI/GTK2/src/mainWindow.cc:942 UI/GTK2/src/propertiesDialog.cc:40
-msgid "Label"
-msgstr "Etiqueta"
-
-#: UI/GTK2/src/mainWindow.cc:946
-msgid "matches"
-msgstr "correspondencias"
-
-#: UI/GTK2/src/mainWindow.cc:951
-msgid "document(s)"
-msgstr "documento(s)"
-
-#: UI/GTK2/src/mainWindow.cc:983
-msgid "Updated label(s)"
-msgstr "Etiqueta(s) actualizada(s)"
-
-#. Yes, it did
-#: UI/GTK2/src/mainWindow.cc:1061 UI/GTK2/src/mainWindow.cc:1181
-msgid "Updated document"
-msgstr "Documento actualizado"
-
-#: UI/GTK2/src/mainWindow.cc:1074
-msgid "Indexed"
-msgstr "Indizado"
-
-#: UI/GTK2/src/mainWindow.cc:1136
-msgid "Unindexed document(s)"
-msgstr "Documento(s) no indizado(s)"
-
-#: UI/GTK2/src/mainWindow.cc:1232
-msgid "Couldn't rename index, name"
-msgstr "No se podu renombrar el ?ndice, nombre"
-
-#: UI/GTK2/src/mainWindow.cc:1236 UI/GTK2/src/mainWindow.cc:2137
-#: UI/GTK2/src/mainWindow.cc:2616
-msgid "is already in use"
-msgstr "ya est? en uso"
-
-#: UI/GTK2/src/mainWindow.cc:1249
-msgid "Couldn't rename index"
-msgstr "No se pudo renombrar el ?ndice"
-
-#: UI/GTK2/src/mainWindow.cc:1262
-msgid "Edited index"
-msgstr "?ndice editado"
-
-#: UI/GTK2/src/mainWindow.cc:1722 UI/GTK2/src/mainWindow.cc:1825
-msgid "Please set a location for the index first"
-msgstr "Por favor, primero fije una localizaci?n para el ?ndice"
-
-#: UI/GTK2/src/mainWindow.cc:1749
-msgid "Result location is unknown"
-msgstr "Se desconoce la localizaci?n del resultado"
-
-#: UI/GTK2/src/mainWindow.cc:1773
-msgid "Import Document(s)"
-msgstr "Importar Documento(s)"
-
-#: UI/GTK2/src/mainWindow.cc:1903 UI/GTK2/src/pinot.cc:149
-#: UI/GTK2/src/pinot.cc:154 UI/GTK2/src/WorkerThreads.cpp:393
-#: UI/GTK2/src/WorkerThreads.cpp:620 UI/GTK2/src/WorkerThreads.cpp:1208
-msgid "Index"
-msgstr "?ndice"
-
-#: UI/GTK2/src/mainWindow.cc:1907 UI/GTK2/src/WorkerThreads.cpp:397
-#: UI/GTK2/src/WorkerThreads.cpp:624 UI/GTK2/src/WorkerThreads.cpp:1212
-msgid "doesn't exist"
-msgstr "no existe"
-
-#: UI/GTK2/src/mainWindow.cc:2017
-msgid "Delete this document from the index ?"
-msgstr "Enlever ce document de l'index ?"
-
-#: UI/GTK2/src/mainWindow.cc:2036
-msgid "Delete these documents from the index ?"
-msgstr "?Borrar este documento del ?ndice?"
-
-#: UI/GTK2/src/mainWindow.cc:2088
-msgid "A metasearch tool for the Free Desktop"
-msgstr "Una herramienta metabuscador para el escritorio libre"
-
-#: UI/GTK2/src/mainWindow.cc:2089
-msgid "(C) 2005-2006 Fabrice Colin"
-msgstr "(C) 2005-2006 Fabrice Colin"
-
-#: UI/GTK2/src/mainWindow.cc:2133
-msgid "Index name"
-msgstr "Nombre del ?ndice"
-
-#: UI/GTK2/src/mainWindow.cc:2148
-msgid "Couldn't add index"
-msgstr "No se pudo a?adir el ?ndice"
-
-#: UI/GTK2/src/mainWindow.cc:2162
-msgid "Added new index"
-msgstr "A?adido un nuevo ?ndice"
-
-#: UI/GTK2/src/mainWindow.cc:2197
-msgid "Couldn't remove index"
-msgstr "No se pudo borrar el ?ndice"
-
-#: UI/GTK2/src/mainWindow.cc:2278
-#, fuzzy
-msgid "Live query"
-msgstr "B?squeda editada"
-
-#: UI/GTK2/src/mainWindow.cc:2431
-msgid "At least one task hasn't completed yet. Quit now ?"
-msgstr "Al menos una tarea no ha finalizado. ?Parar ahora?"
-
-#: UI/GTK2/src/mainWindow.cc:2612
-msgid "Query name"
-msgstr "Nombre la b?squeda"
-
-#: UI/GTK2/src/mainWindow.cc:2639
-msgid "Couldn't update query"
-msgstr "No se pudo actualizar la b?squeda"
-
-#: UI/GTK2/src/mainWindow.cc:2647
-msgid "Edited query"
-msgstr "B?squeda editada"
-
-#: UI/GTK2/src/mainWindow.cc:2654
-msgid "Couldn't add query"
-msgstr "No se pudo a?adir la b?squeda"
-
-#: UI/GTK2/src/mainWindow.cc:2662
-msgid "Added new query"
-msgstr "A?adida una nueva b?squeda"
-
-#: UI/GTK2/src/mainWindow.cc:2676
-msgid "Query is not set"
-msgstr "B?squeda no definida"
-
-#: UI/GTK2/src/mainWindow.cc:2687
-msgid "No search engine selected"
-msgstr "Motor de b?squeda no seleccionado"
-
-#: UI/GTK2/src/mainWindow.cc:2769
-msgid "Please set the Google API key first"
-msgstr "Por favor, primero configure el API de Google"
-
-#: UI/GTK2/src/mainWindow.cc:2778
-msgid "Running query"
-msgstr "Ejecutando la b?squeda"
-
-#: UI/GTK2/src/mainWindow.cc:2884
-msgid "is already indexed or is being indexed"
-msgstr "ya ha sido indizado, o se est? indizando"
-
-#: UI/GTK2/src/mainWindow.cc:2911
-msgid "No URL to browse"
-msgstr "No hay URL que mostrar"
-
-#: UI/GTK2/src/mainWindow.cc:2922
-msgid "No browser configured to view results"
-msgstr "NO ha configurado un navegador para ver los resultados"
-
-#: UI/GTK2/src/mainWindow.cc:2934
-msgid "Couldn't browse URL:"
-msgstr "No se pudo mostrar el URL:"
-
-#: UI/GTK2/src/mainWindow.cc:2993
-#, fuzzy
-msgid "Viewing"
-msgstr "Ver"
-
-#: UI/GTK2/src/mainWindow_glade.cc:115
-msgid "Query:"
-msgstr "B?squeda:"
-
-#: UI/GTK2/src/mainWindow_glade.cc:127 UI/GTK2/src/prefsDialog_glade.cc:86
-msgid "Edit"
-msgstr "Editar"
-
-#: UI/GTK2/src/mainWindow_glade.cc:136
-msgid "Stored queries"
-msgstr "B?squedas guardadas"
-
-#: UI/GTK2/src/mainWindow_glade.cc:171
-msgid "Search Engine"
-msgstr "Motores de b?squeda"
-
-#: UI/GTK2/src/mainWindow_glade.cc:174
-msgid "Host Name"
-msgstr "Nombre del servidor"
-
-#: UI/GTK2/src/mainWindow_glade.cc:177
-msgid "Clear List"
-msgstr "Limpiar la lista"
-
-#: UI/GTK2/src/mainWindow_glade.cc:180
-msgid "Show Extract"
-msgstr "Mostrar extra?dos"
-
-#: UI/GTK2/src/mainWindow_glade.cc:183
-msgid "Group By"
-msgstr "Agrupar por"
-
-#: UI/GTK2/src/mainWindow_glade.cc:189
-msgid "Vie_w"
-msgstr "Ver"
-
-#: UI/GTK2/src/mainWindow_glade.cc:192
-msgid "View Cache"
-msgstr "Ver la cache"
-
-#: UI/GTK2/src/mainWindow_glade.cc:195 UI/GTK2/src/mainWindow_glade.cc:231
-msgid "_Index"
-msgstr "?ndice"
-
-#: UI/GTK2/src/mainWindow_glade.cc:198
-msgid "List Contents Of"
-msgstr "Listar el contenido de"
-
-#: UI/GTK2/src/mainWindow_glade.cc:210
-msgid "Update"
-msgstr "Actualizar"
-
-#: UI/GTK2/src/mainWindow_glade.cc:213
-msgid "Unindex"
-msgstr "Desindizar"
-
-#: UI/GTK2/src/mainWindow_glade.cc:216
-#: UI/GTK2/src/propertiesDialog_glade.cc:171
-#: UI/GTK2/src/queryDialog_glade.cc:83
-msgid "Properties"
-msgstr "Propiedades"
-
-#: UI/GTK2/src/mainWindow_glade.cc:219
-msgid "_About"
-msgstr "Sobre"
-
-#: UI/GTK2/src/mainWindow_glade.cc:222
-msgid "_Session"
-msgstr "Sesi?n"
-
-#: UI/GTK2/src/mainWindow_glade.cc:225
-msgid "_Edit"
-msgstr "Editar"
-
-#: UI/GTK2/src/mainWindow_glade.cc:228
-msgid "_Results"
-msgstr "Resultados"
-
-#: UI/GTK2/src/mainWindow_glade.cc:234
-msgid "_Help"
-msgstr "Ayuda"
-
-#: UI/GTK2/src/mainWindow_glade.cc:356
-msgid "Pinot"
-msgstr "Pinot"
-
-#: UI/GTK2/src/pinot.cc:56
-msgid "Couldn't save configuration file"
-msgstr "No se pudo guardar el fichero de configuraci?n"
-
-#. Localize language names
-#: UI/GTK2/src/pinot.cc:118
-msgid "Danish"
-msgstr "Dan?s"
-
-#: UI/GTK2/src/pinot.cc:119
-msgid "Dutch"
-msgstr "Holand?s"
-
-#: UI/GTK2/src/pinot.cc:120
-msgid "English"
-msgstr "Ingl?s"
-
-#: UI/GTK2/src/pinot.cc:121
-msgid "Finnish"
-msgstr "Finland?s"
-
-#: UI/GTK2/src/pinot.cc:122
-msgid "French"
-msgstr "Franc?s"
-
-#: UI/GTK2/src/pinot.cc:123
-msgid "German"
-msgstr "Alem?n"
-
-#: UI/GTK2/src/pinot.cc:124
-msgid "Italian"
-msgstr "Italiano"
-
-#: UI/GTK2/src/pinot.cc:125
-msgid "Norwegian"
-msgstr "Noruego"
-
-#: UI/GTK2/src/pinot.cc:126
-msgid "Portuguese"
-msgstr "Portugu?s"
-
-#: UI/GTK2/src/pinot.cc:127
-msgid "Russian"
-msgstr "Ruso"
-
-#: UI/GTK2/src/pinot.cc:128
-msgid "Spanish"
-msgstr "Espa?ol"
-
-#: UI/GTK2/src/pinot.cc:129
-msgid "Swedish"
-msgstr "Sueco"
-
-#: UI/GTK2/src/pinot.cc:150 UI/GTK2/src/pinot.cc:155
-msgid "is not valid, please check"
-msgstr "no es v?lido, por favor compru?belo"
-
-#: UI/GTK2/src/pinot.cc:163
-msgid "History database"
-msgstr "Base de datos del hist?rico"
-
-#: UI/GTK2/src/pinot.cc:164
-msgid "couldn't be created"
-msgstr "no se pudo crear"
-
-#: UI/GTK2/src/PinotSettings.cpp:106
-msgid "Couldn't create pinot directory at"
-msgstr "No se pudo crear un directorio pinot en"
-
-#: UI/GTK2/src/PinotSettings.cpp:195
-msgid "Failed to parse configuration file"
-msgstr "Fallo en el fichero de configuraci?n"
-
-#: UI/GTK2/src/PinotSettings.cpp:204
-msgid "Red"
-msgstr "Rojo"
-
-#: UI/GTK2/src/PinotSettings.cpp:206
-msgid "Blue"
-msgstr "Azul"
-
-#: UI/GTK2/src/PinotSettings.cpp:208
-msgid "Green"
-msgstr "Verde"
-
-#: UI/GTK2/src/PinotSettings.cpp:289
-msgid "Couldn't load ui block"
-msgstr "No se pudo cargar el bloque ui"
-
-#: UI/GTK2/src/PinotSettings.cpp:296
-msgid "Couldn't load extraindex block"
-msgstr "No se pudo cargar el bloque extraindex"
-
-#: UI/GTK2/src/PinotSettings.cpp:303
-msgid "Couldn't load storedquery block"
-msgstr "No se pudo cargar el bloque storedquery"
-
-#: UI/GTK2/src/PinotSettings.cpp:310
-msgid "Couldn't load results block"
-msgstr "o se pudo cargar el bloque results"
-
-#: UI/GTK2/src/PinotSettings.cpp:317
-msgid "Couldn't load label block"
-msgstr "o se pudo cargar el bloque label"
-
-#: UI/GTK2/src/PinotSettings.cpp:335
-msgid "Couldn't load mailaccount block"
-msgstr "No se pudo cargar el bloque mailaccount"
-
-#: UI/GTK2/src/PinotSettings.cpp:343
-msgid "Couldn't parse configuration file"
-msgstr "No se pudo procesar el fichero de configuraci?n"
-
-#: UI/GTK2/src/PinotSettings.cpp:732
-msgid "Unclassified"
-msgstr "No clasificado"
-
-#: UI/GTK2/src/prefsDialog.cc:69
-msgid "Name"
-msgstr "Nombre"
-
-#: UI/GTK2/src/prefsDialog.cc:77
-msgid "Location"
-msgstr "Localizaci?n"
-
-#: UI/GTK2/src/prefsDialog.cc:114
-msgid "In internal viewer"
-msgstr "En el visor interno"
-
-#: UI/GTK2/src/prefsDialog.cc:117
-msgid "In browser"
-msgstr "En el navegador"
-
-#: UI/GTK2/src/prefsDialog.cc:332
-msgid "Browser location"
-msgstr "Mostrar la localizaci?n"
-
-#: UI/GTK2/src/prefsDialog.cc:343
-msgid "New Label"
-msgstr "Nueva etiqueta"
-
-#: UI/GTK2/src/prefsDialog.cc:365
-msgid "Colour"
-msgstr "Color"
-
-#. Let the user edit the location
-#: UI/GTK2/src/prefsDialog.cc:436 UI/GTK2/src/prefsDialog.cc:470
-msgid "Mbox File Location"
-msgstr "Localizaci?n del fichero mbox"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:62
-msgid "HTTP crawling:"
-msgstr "Navegador HTTP:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:63
-msgid "View documents:"
-msgstr "Ver los documentos"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:64
-msgid "Browser:"
-msgstr "Navegador:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:65
-msgid "Google API key:"
-msgstr "Clave del API de Google"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:68
-msgid "Ignore robots.txt and Robots META tag"
-msgstr "Ignorar robots.txt y la etiqueta META Robots"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:74
-msgid "General"
-msgstr "General"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:75
-msgid "Labels are used to classify indexed documents:"
-msgstr "Las etiquetas se usan para clasificar los documentos indizados:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:80 UI/GTK2/src/prefsDialog_glade.cc:106
-msgid "Add"
-msgstr "A?adir"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:92
-msgid "Remove"
-msgstr "Borrar"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:100
-msgid "Labels"
-msgstr "Etiquetas"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:101
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr "Lo sbuzones de correo de tipo mbox pueden ser controlados e indizados"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:332
-msgid "Preferences"
-msgstr "Preferencias"
-
-#: UI/GTK2/src/propertiesDialog.cc:51
-msgid "Unknown"
-msgstr "Desconocido"
-
-#: UI/GTK2/src/propertiesDialog_glade.cc:65
-msgid "Extract:"
-msgstr "Extraer:"
-
-#: UI/GTK2/src/propertiesDialog_glade.cc:66
-msgid "Language:"
-msgstr "Idioma:"
-
-#: UI/GTK2/src/propertiesDialog_glade.cc:68
-msgid "MIME type:"
-msgstr "Tipo MIME:"
-
-#: UI/GTK2/src/queryDialog.cc:96 UI/GTK2/src/queryDialog.cc:125
-msgid "Any"
-msgstr "Cualquiera"
-
-#: UI/GTK2/src/queryDialog_glade.cc:70
-msgid "Index all results with label"
-msgstr "Indizar todos los resultados con la etiqueta"
-
-#: UI/GTK2/src/queryDialog_glade.cc:72
-msgid "Any of the words:"
-msgstr "Cualquiera de las palabras:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:73
-msgid "File name:"
-msgstr "Nombre de fichero:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:74
-msgid "Number of results:"
-msgstr "N?mero de resultados:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:77
-msgid "Host name:"
-msgstr "Nombre del servidor:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:78
-msgid "None of the words:"
-msgstr "Ninguna de las palabras:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:84
-msgid "Limit to documents that match"
-msgstr "Limitar a los documentos que coincidan"
-
-#: UI/GTK2/src/queryDialog_glade.cc:87
-msgid "the exact phrase:"
-msgstr "la frase exacta"
-
-#: UI/GTK2/src/queryDialog_glade.cc:88
-msgid "the language:"
-msgstr "el idioma"
-
-#: UI/GTK2/src/queryDialog_glade.cc:92
-msgid "all the words:"
-msgstr "todas las palabras:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:93
-msgid "the label:"
-msgstr "la etiqueta"
-
-#: UI/GTK2/src/queryDialog_glade.cc:98
-msgid "Advanced"
-msgstr "Avanzado"
-
-#: UI/GTK2/src/queryDialog_glade.cc:283
-msgid "Query properties"
-msgstr "Propriedades de la b?squeda"
-
-#: UI/GTK2/src/WorkerThreads.cpp:372
-msgid "Stopped browsing"
-msgstr "Exploraci?n detenida"
-
-#: UI/GTK2/src/WorkerThreads.cpp:406 UI/GTK2/src/WorkerThreads.cpp:632
-#: UI/GTK2/src/WorkerThreads.cpp:672 UI/GTK2/src/WorkerThreads.cpp:682
-#: UI/GTK2/src/WorkerThreads.cpp:888 UI/GTK2/src/WorkerThreads.cpp:1098
-#: UI/GTK2/src/WorkerThreads.cpp:1221
-msgid "Index error on"
-msgstr "Error en el ?ndice"
-
-#: UI/GTK2/src/WorkerThreads.cpp:507
-msgid "Stopped querying"
-msgstr "B?squeda detenida"
-
-#: UI/GTK2/src/WorkerThreads.cpp:519
-msgid "Couldn't create search engine"
-msgstr "No se pudo crear el motor de b?squeda"
-
-#: UI/GTK2/src/WorkerThreads.cpp:531
-msgid "Couldn't run query on search engine"
-msgstr "No se pudo ejecutar la b?squeda contra el motor"
-
-#: UI/GTK2/src/WorkerThreads.cpp:547
-msgid "No title"
-msgstr "Sin t?tulo"
-
-#: UI/GTK2/src/WorkerThreads.cpp:604 UI/GTK2/src/WorkerThreads.cpp:663
-msgid "Stopped querying index labels"
-msgstr "Detenida la b?squeda de etiquetas de ?ndice"
-
-#: UI/GTK2/src/WorkerThreads.cpp:748
-msgid "Stopped retrieval of"
-msgstr "Detenida la recuperaci?n de"
-
-#: UI/GTK2/src/WorkerThreads.cpp:784
-msgid "Couldn't obtain downloader for protocol"
-msgstr "No se pudo usar un recuperador para el protocolo"
-
-#: UI/GTK2/src/WorkerThreads.cpp:798 UI/GTK2/src/WorkerThreads.cpp:902
-msgid "Couldn't retrieve"
-msgstr "No se pudo descargar"
-
-#: UI/GTK2/src/WorkerThreads.cpp:873
-msgid "Stopped indexing"
-msgstr "Detenida la indizaci?n"
-
-#: UI/GTK2/src/WorkerThreads.cpp:926
-msgid "Cannot index document type"
-msgstr "No se pudo indizar el tipo de documento"
-
-#: UI/GTK2/src/WorkerThreads.cpp:930
-msgid "at"
-msgstr "a"
-
-#: UI/GTK2/src/WorkerThreads.cpp:955
-msgid "Couldn't tokenize"
-msgstr "No se pudo parcourir"
-
-#: UI/GTK2/src/WorkerThreads.cpp:976
-msgid "Robots META tag forbids indexing"
-msgstr "La etiqueta META Robots proh?be la indizaci?n"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1026
-msgid "Couldn't index"
-msgstr "No se pudo indizar"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1086
-msgid "Stopped unindexing document(s)"
-msgstr "Detenida la desindizaci?n de documento(s)"
-
-#. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1106
-msgid "Couldn't unindex document(s)"
-msgstr "No se pudo desindizar lo(s) documento(s)"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1193
-msgid "Stopped document update for "
-msgstr "Detenida la actualizaci?n del documento por "
-
-#: UI/GTK2/src/WorkerThreads.cpp:1230
-msgid "Couldn't update document"
-msgstr "No se pudo actualizar el documento"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1275
-msgid "Stopped listening on"
-msgstr "Detenida la escucha en"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1378
-msgid "Couldn't read FIFO at"
-msgstr "No se pudo leer FIFO en"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1423
-msgid "Stopped monitoring"
-msgstr "Detenida la monitorizaci?n"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1444
-msgid "No monitoring handler"
-msgstr "No hay monitorizaci?n"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1491
-msgid "Couldn't open FAM connection"
-msgstr "No se pudo abrir la conexi?n FAM"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1696
-msgid "Stopped scanning"
-msgstr "Detenida la exploraci?n"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1854
-msgid "Couldn't open directory"
-msgstr "No se pudo abrir el directorio"

Copied: trunk/po/fr.po (from rev 110, trunk/po/fr_FR.po)
===================================================================
--- trunk/po/fr_FR.po	2006-02-15 12:55:04 UTC (rev 110)
+++ trunk/po/fr.po	2006-02-16 13:54:50 UTC (rev 115)
@@ -0,0 +1,872 @@
+# fr PO file for pinot.
+# Copyright (C) 2005 Fabrice Colin
+# This file is distributed under the same license as the pinot package.
+# Fabrice Colin <colinf at chez.com>, 2005.
+#
+#, fuzzy
+msgid ""
+msgstr ""
+"Project-Id-Version: pinot 0.43\n"
+"Report-Msgid-Bugs-To: \n"
+"POT-Creation-Date: 2006-02-16 21:57+0800\n"
+"PO-Revision-Date: 2006-01-20 19:44+0800\n"
+"Last-Translator: Fabrice Colin <colinf at chez.com>\n"
+"Language-Team: fr <colinf at chez.com>\n"
+"MIME-Version: 1.0\n"
+"Content-Type: text/plain; charset=utf-8\n"
+"Content-Transfer-Encoding: 8bit\n"
+
+#: UI/GTK2/src/EnginesTree.cpp:67
+msgid "Search Engines"
+msgstr "Moteurs"
+
+#: UI/GTK2/src/EnginesTree.cpp:291
+msgid "Current User"
+msgstr "Utilisateur"
+
+#. Populate the submenu
+#. Bind the callback's parameter to the index name
+#. Enable these menu items, unless the index is not the documents index
+#. Internal indices
+#: UI/GTK2/src/EnginesTree.cpp:303 UI/GTK2/src/mainWindow.cc:343
+#: UI/GTK2/src/mainWindow.cc:346 UI/GTK2/src/mainWindow.cc:519
+#: UI/GTK2/src/mainWindow.cc:1054 UI/GTK2/src/mainWindow.cc:1138
+#: UI/GTK2/src/mainWindow.cc:1173 UI/GTK2/src/mainWindow.cc:1790
+#: UI/GTK2/src/PinotSettings.cpp:199 UI/GTK2/src/PinotSettings.cpp:881
+#: UI/GTK2/src/PinotSettings.cpp:937
+msgid "My Documents"
+msgstr "Mes Documents"
+
+#. Bind the callback's parameter to the index name
+#. Signal
+#: UI/GTK2/src/EnginesTree.cpp:307 UI/GTK2/src/mainWindow.cc:349
+#: UI/GTK2/src/mainWindow.cc:352 UI/GTK2/src/mainWindow.cc:523
+#: UI/GTK2/src/MonitorHandler.cpp:173 UI/GTK2/src/PinotSettings.cpp:200
+#: UI/GTK2/src/PinotSettings.cpp:882 UI/GTK2/src/PinotSettings.cpp:938
+#: UI/GTK2/src/prefsDialog_glade.cc:116
+msgid "My Email"
+msgstr "Mon Courrier"
+
+#: UI/GTK2/src/importDialog.cc:108
+msgid "Enabled"
+msgstr "Active"
+
+#: UI/GTK2/src/importDialog.cc:109 UI/GTK2/src/prefsDialog.cc:78
+msgid "MIME Type"
+msgstr "Type MIME"
+
+#: UI/GTK2/src/importDialog.cc:134
+msgid "File"
+msgstr "Fichier"
+
+#: UI/GTK2/src/importDialog.cc:137
+msgid "Directory"
+msgstr "Repertoire"
+
+#. The last column is for the URL
+#: UI/GTK2/src/importDialog.cc:142 UI/GTK2/src/IndexTree.cpp:70
+#: UI/GTK2/src/ResultsTree.cpp:114
+msgid "URL"
+msgstr "URL"
+
+#: UI/GTK2/src/importDialog.cc:148 UI/GTK2/src/IndexPage.cpp:158
+#: UI/GTK2/src/IndexPage.cpp:204 UI/GTK2/src/queryDialog.cc:91
+msgid "None"
+msgstr ""
+
+#: UI/GTK2/src/importDialog.cc:444
+msgid "Document To Import"
+msgstr "Document A Importer"
+
+#: UI/GTK2/src/importDialog_glade.cc:66 UI/GTK2/src/indexDialog_glade.cc:68
+msgid "Location:"
+msgstr "Location:"
+
+#: UI/GTK2/src/importDialog_glade.cc:67
+#: UI/GTK2/src/propertiesDialog_glade.cc:64
+msgid "Title:"
+msgstr "Titre:"
+
+#: UI/GTK2/src/importDialog_glade.cc:70 UI/GTK2/src/indexDialog_glade.cc:67
+msgid "Type:"
+msgstr "Type:"
+
+#: UI/GTK2/src/importDialog_glade.cc:72 UI/GTK2/src/indexDialog_glade.cc:64
+#: UI/GTK2/src/prefsDialog_glade.cc:70
+msgid "..."
+msgstr "..."
+
+#: UI/GTK2/src/importDialog_glade.cc:78
+msgid "Depth:"
+msgstr "Profondeur:"
+
+#: UI/GTK2/src/importDialog_glade.cc:79
+msgid "Symlinks:"
+msgstr "Liens:"
+
+#: UI/GTK2/src/importDialog_glade.cc:80
+msgid "Follow symlinks"
+msgstr "Suivre les liens symboliques"
+
+#: UI/GTK2/src/importDialog_glade.cc:83
+msgid "Apply label:"
+msgstr ""
+
+#: UI/GTK2/src/importDialog_glade.cc:91 UI/GTK2/src/mainWindow_glade.cc:201
+msgid "Import"
+msgstr "Importer"
+
+#: UI/GTK2/src/importDialog_glade.cc:211
+msgid "Import document"
+msgstr "Import de document"
+
+#: UI/GTK2/src/indexDialog.cc:221
+msgid "Index location"
+msgstr "Location de l'index"
+
+#: UI/GTK2/src/indexDialog_glade.cc:62 UI/GTK2/src/queryDialog_glade.cc:60
+msgid "Name:"
+msgstr "Nom:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:69
+msgid "Port:"
+msgstr "Port:"
+
+#: UI/GTK2/src/indexDialog_glade.cc:143
+msgid "External index"
+msgstr "Index externe"
+
+#. The score column is used for status icons
+#. The title column is also used for status icons
+#: UI/GTK2/src/IndexTree.cpp:64 UI/GTK2/src/ResultsTree.cpp:96
+msgid "Title"
+msgstr "Titre"
+
+#: UI/GTK2/src/IndexTree.cpp:75
+msgid "Timestamp"
+msgstr "Date"
+
+#: UI/GTK2/src/IndexPage.cpp:50
+msgid "Show Previous"
+msgstr "Precedents"
+
+#: UI/GTK2/src/IndexPage.cpp:56
+msgid "Show Next"
+msgstr "Suivants"
+
+#: UI/GTK2/src/mainWindow.cc:144
+msgid "Query Name"
+msgstr "Nom de la Recherche"
+
+#: UI/GTK2/src/mainWindow.cc:149
+msgid "Last Run"
+msgstr "Derniere Utilisation"
+
+#: UI/GTK2/src/mainWindow.cc:150
+msgid "Summary"
+msgstr "Sommaire"
+
+#. Set tooltips
+#: UI/GTK2/src/mainWindow.cc:210
+msgid "Add index"
+msgstr "Ajouter un index"
+
+#: UI/GTK2/src/mainWindow.cc:211
+msgid "Remove index"
+msgstr "Enlever un index"
+
+#. The handler object will be deleted when the thread terminates
+#. Now we are ready
+#: UI/GTK2/src/mainWindow.cc:234
+msgid "Ready"
+msgstr "Pret"
+
+#. Stop in case we were loading a page
+#. Close the existing view page
+#: UI/GTK2/src/mainWindow.cc:248 UI/GTK2/src/mainWindow.cc:1011
+#: UI/GTK2/src/mainWindow.cc:1383 UI/GTK2/src/mainWindow.cc:2960
+#: UI/GTK2/src/mainWindow_glade.cc:207
+msgid "View"
+msgstr "Voir"
+
+#: UI/GTK2/src/mainWindow.cc:280
+msgid "N/A"
+msgstr "Inconnue"
+
+#: UI/GTK2/src/mainWindow.cc:290
+msgid "<undefined>"
+msgstr "<inconnu>"
+
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:481
+msgid "Result location is"
+msgstr "La location du resultat est"
+
+#. Show the URL in the status bar
+#: UI/GTK2/src/mainWindow.cc:534
+msgid "Document location is"
+msgstr "La location du document is"
+
+#. User selected no label
+#: UI/GTK2/src/mainWindow.cc:643
+msgid "No label"
+msgstr "Pas d'etiquette"
+
+#: UI/GTK2/src/mainWindow.cc:792
+msgid "Showing"
+msgstr "Listant"
+
+#: UI/GTK2/src/mainWindow.cc:797
+msgid "off"
+msgstr "de"
+
+#: UI/GTK2/src/mainWindow.cc:802
+msgid "documents, starting at"
+msgstr "documents venant de"
+
+#: UI/GTK2/src/mainWindow.cc:836
+msgid "Query"
+msgstr "La recherche"
+
+#: UI/GTK2/src/mainWindow.cc:840 UI/GTK2/src/mainWindow.cc:2789
+msgid "on"
+msgstr "sur"
+
+#: UI/GTK2/src/mainWindow.cc:844
+msgid "ended"
+msgstr "est terminee"
+
+#: UI/GTK2/src/mainWindow.cc:945 UI/GTK2/src/propertiesDialog.cc:40
+msgid "Label"
+msgstr "L'etiquette"
+
+#: UI/GTK2/src/mainWindow.cc:949
+msgid "matches"
+msgstr "correspond a"
+
+#: UI/GTK2/src/mainWindow.cc:954
+msgid "document(s)"
+msgstr "document(s)"
+
+#: UI/GTK2/src/mainWindow.cc:986
+msgid "Updated label(s)"
+msgstr "Mis a jour l(es) etiquette(s)"
+
+#. Yes, it did
+#: UI/GTK2/src/mainWindow.cc:1064 UI/GTK2/src/mainWindow.cc:1184
+msgid "Updated document"
+msgstr "Mis a jour le document"
+
+#: UI/GTK2/src/mainWindow.cc:1077
+msgid "Indexed"
+msgstr "Indexe"
+
+#: UI/GTK2/src/mainWindow.cc:1139
+msgid "Unindexed document(s)"
+msgstr "Desindexe le(s) document(s)"
+
+#: UI/GTK2/src/mainWindow.cc:1235
+msgid "Couldn't rename index, name"
+msgstr "N'a pas pu renommer l'index"
+
+#: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:2144
+#: UI/GTK2/src/mainWindow.cc:2623
+msgid "is already in use"
+msgstr "est deja utilise"
+
+#: UI/GTK2/src/mainWindow.cc:1252
+msgid "Couldn't rename index"
+msgstr "N'a pas pu renommer l'index"
+
+#: UI/GTK2/src/mainWindow.cc:1265
+msgid "Edited index"
+msgstr "Edite l'index"
+
+#: UI/GTK2/src/mainWindow.cc:1729 UI/GTK2/src/mainWindow.cc:1832
+msgid "Please set a location for the index first"
+msgstr "Donnez une location a l'index"
+
+#: UI/GTK2/src/mainWindow.cc:1756
+msgid "Result location is unknown"
+msgstr "La location du resultat est inconnue"
+
+#: UI/GTK2/src/mainWindow.cc:1780
+msgid "Import Document(s)"
+msgstr "Import de Document(s)"
+
+#: UI/GTK2/src/mainWindow.cc:1910 UI/GTK2/src/pinot.cc:150
+#: UI/GTK2/src/pinot.cc:155 UI/GTK2/src/WorkerThreads.cpp:395
+#: UI/GTK2/src/WorkerThreads.cpp:614 UI/GTK2/src/WorkerThreads.cpp:1175
+msgid "Index"
+msgstr "L'index"
+
+#: UI/GTK2/src/mainWindow.cc:1914 UI/GTK2/src/WorkerThreads.cpp:399
+#: UI/GTK2/src/WorkerThreads.cpp:618 UI/GTK2/src/WorkerThreads.cpp:1179
+msgid "doesn't exist"
+msgstr "n'existe pas"
+
+#: UI/GTK2/src/mainWindow.cc:2024
+msgid "Delete this document from the index ?"
+msgstr "Enlever ce document de l'index ?"
+
+#: UI/GTK2/src/mainWindow.cc:2043
+msgid "Delete these documents from the index ?"
+msgstr "Enlever ces documents de l'index ?"
+
+#: UI/GTK2/src/mainWindow.cc:2095
+msgid "A metasearch tool for the Free Desktop"
+msgstr "Un outil de recherche pour le Bureau Libre"
+
+#: UI/GTK2/src/mainWindow.cc:2096
+msgid "(C) 2005-2006 Fabrice Colin"
+msgstr "(C) 2005-2006 Fabrice Colin"
+
+#: UI/GTK2/src/mainWindow.cc:2140
+msgid "Index name"
+msgstr "Nom de l'index"
+
+#: UI/GTK2/src/mainWindow.cc:2155
+msgid "Couldn't add index"
+msgstr "N'a pas pu ajouter l'index"
+
+#: UI/GTK2/src/mainWindow.cc:2169
+msgid "Added new index"
+msgstr "Ajouter un nouvel index"
+
+#: UI/GTK2/src/mainWindow.cc:2204
+msgid "Couldn't remove index"
+msgstr "N'a pas pu enlever l'index"
+
+#: UI/GTK2/src/mainWindow.cc:2285
+#, fuzzy
+msgid "Live query"
+msgstr "Edite la recherche"
+
+#: UI/GTK2/src/mainWindow.cc:2438
+msgid "At least one task hasn't completed yet. Quit now ?"
+msgstr "Au moins une tache n'est pas terminee. Quitter maintenant ?"
+
+#: UI/GTK2/src/mainWindow.cc:2619
+msgid "Query name"
+msgstr "Nom de la recherche"
+
+#: UI/GTK2/src/mainWindow.cc:2646
+msgid "Couldn't update query"
+msgstr "N'a pas pu mettre a jour la recherche"
+
+#: UI/GTK2/src/mainWindow.cc:2654
+msgid "Edited query"
+msgstr "Edite la recherche"
+
+#: UI/GTK2/src/mainWindow.cc:2661
+msgid "Couldn't add query"
+msgstr "N'a pas pu ajouter la recherche"
+
+#: UI/GTK2/src/mainWindow.cc:2669
+msgid "Added new query"
+msgstr "Ajoute une nouvelle recherche"
+
+#: UI/GTK2/src/mainWindow.cc:2683
+msgid "Query is not set"
+msgstr "Recherche indefinie"
+
+#: UI/GTK2/src/mainWindow.cc:2694
+msgid "No search engine selected"
+msgstr "Pas de moteur selectionne"
+
+#: UI/GTK2/src/mainWindow.cc:2776
+msgid "Please set the Google API key first"
+msgstr "Configurez la clef de l'API Google "
+
+#: UI/GTK2/src/mainWindow.cc:2785
+msgid "Running query"
+msgstr "Recherche en cours"
+
+#: UI/GTK2/src/mainWindow.cc:2891
+msgid "is already indexed or is being indexed"
+msgstr "est deja indexe ou est en cours d'indexation"
+
+#: UI/GTK2/src/mainWindow.cc:2918
+msgid "No URL to browse"
+msgstr "Pas d'URL a brouter"
+
+#: UI/GTK2/src/mainWindow.cc:2929
+msgid "No browser configured to view results"
+msgstr "Pas de brouter configure"
+
+#: UI/GTK2/src/mainWindow.cc:2941
+msgid "Couldn't browse URL:"
+msgstr "N'a pas pu brouter l'URL"
+
+#: UI/GTK2/src/mainWindow.cc:3000
+#, fuzzy
+msgid "Viewing"
+msgstr "Voir"
+
+#: UI/GTK2/src/mainWindow_glade.cc:115
+msgid "Query:"
+msgstr "Recherche:"
+
+#: UI/GTK2/src/mainWindow_glade.cc:127 UI/GTK2/src/prefsDialog_glade.cc:86
+msgid "Edit"
+msgstr "Editer"
+
+#: UI/GTK2/src/mainWindow_glade.cc:136
+msgid "Stored queries"
+msgstr "Recherches sauvegardees"
+
+#: UI/GTK2/src/mainWindow_glade.cc:171
+msgid "Search Engine"
+msgstr "Moteurs"
+
+#: UI/GTK2/src/mainWindow_glade.cc:174
+msgid "Host Name"
+msgstr "Nom de machine"
+
+#: UI/GTK2/src/mainWindow_glade.cc:177
+msgid "Clear List"
+msgstr "Nettoyer la Liste"
+
+#: UI/GTK2/src/mainWindow_glade.cc:180
+msgid "Show Extract"
+msgstr "Montrer l'Extrait"
+
+#: UI/GTK2/src/mainWindow_glade.cc:183
+msgid "Group By"
+msgstr "Grouper Par"
+
+#: UI/GTK2/src/mainWindow_glade.cc:189
+msgid "Vie_w"
+msgstr "Voir"
+
+#: UI/GTK2/src/mainWindow_glade.cc:192
+msgid "View Cache"
+msgstr "Voir le Cache"
+
+#: UI/GTK2/src/mainWindow_glade.cc:195 UI/GTK2/src/mainWindow_glade.cc:231
+msgid "_Index"
+msgstr "Index"
+
+#: UI/GTK2/src/mainWindow_glade.cc:198
+msgid "List Contents Of"
+msgstr "Lister le Contenu de"
+
+#: UI/GTK2/src/mainWindow_glade.cc:210
+msgid "Update"
+msgstr "Mettre a Jour"
+
+#: UI/GTK2/src/mainWindow_glade.cc:213
+msgid "Unindex"
+msgstr "Desindexer"
+
+#: UI/GTK2/src/mainWindow_glade.cc:216
+#: UI/GTK2/src/propertiesDialog_glade.cc:171
+#: UI/GTK2/src/queryDialog_glade.cc:83
+msgid "Properties"
+msgstr "Proprietes"
+
+#: UI/GTK2/src/mainWindow_glade.cc:219
+msgid "_About"
+msgstr "A Propos"
+
+#: UI/GTK2/src/mainWindow_glade.cc:222
+msgid "_Session"
+msgstr "Session"
+
+#: UI/GTK2/src/mainWindow_glade.cc:225
+msgid "_Edit"
+msgstr "Editer"
+
+#: UI/GTK2/src/mainWindow_glade.cc:228
+msgid "_Results"
+msgstr "Resultats"
+
+#: UI/GTK2/src/mainWindow_glade.cc:234
+msgid "_Help"
+msgstr "Aide"
+
+#: UI/GTK2/src/mainWindow_glade.cc:356
+msgid "Pinot"
+msgstr "Pinot"
+
+#: UI/GTK2/src/pinot.cc:56
+msgid "Couldn't save configuration file"
+msgstr "N'a pas pu sauve le fichier de configuration"
+
+#. Localize language names
+#: UI/GTK2/src/pinot.cc:119
+msgid "Danish"
+msgstr "Danois"
+
+#: UI/GTK2/src/pinot.cc:120
+msgid "Dutch"
+msgstr "Hollandais"
+
+#: UI/GTK2/src/pinot.cc:121
+msgid "English"
+msgstr "Anglais"
+
+#: UI/GTK2/src/pinot.cc:122
+msgid "Finnish"
+msgstr "Finlandais"
+
+#: UI/GTK2/src/pinot.cc:123
+msgid "French"
+msgstr "Francais"
+
+#: UI/GTK2/src/pinot.cc:124
+msgid "German"
+msgstr "Allemand"
+
+#: UI/GTK2/src/pinot.cc:125
+msgid "Italian"
+msgstr "Italien"
+
+#: UI/GTK2/src/pinot.cc:126
+msgid "Norwegian"
+msgstr "Norvegien"
+
+#: UI/GTK2/src/pinot.cc:127
+msgid "Portuguese"
+msgstr "Portugais"
+
+#: UI/GTK2/src/pinot.cc:128
+msgid "Russian"
+msgstr "Russe"
+
+#: UI/GTK2/src/pinot.cc:129
+msgid "Spanish"
+msgstr "Espagnol"
+
+#: UI/GTK2/src/pinot.cc:130
+msgid "Swedish"
+msgstr "Suedois"
+
+#: UI/GTK2/src/pinot.cc:151 UI/GTK2/src/pinot.cc:156
+msgid "is not valid, please check"
+msgstr "n'est pas valide, veuillez verifier"
+
+#: UI/GTK2/src/pinot.cc:164
+msgid "History database"
+msgstr "La base des historiques"
+
+#: UI/GTK2/src/pinot.cc:165
+msgid "couldn't be created"
+msgstr "n'a pas pu etre creee"
+
+#: UI/GTK2/src/PinotSettings.cpp:106
+msgid "Couldn't create pinot directory at"
+msgstr "N'a pas pu creer le repertoire a"
+
+#: UI/GTK2/src/PinotSettings.cpp:195
+msgid "Failed to parse configuration file"
+msgstr "N'a pas pu lire le fichier de configuration"
+
+#: UI/GTK2/src/PinotSettings.cpp:204
+msgid "Red"
+msgstr "Rouge"
+
+#: UI/GTK2/src/PinotSettings.cpp:206
+msgid "Blue"
+msgstr "Bleu"
+
+#: UI/GTK2/src/PinotSettings.cpp:208
+msgid "Green"
+msgstr "Vert"
+
+#: UI/GTK2/src/PinotSettings.cpp:289
+msgid "Couldn't load ui block"
+msgstr "N'a pas pu charger le bloc ui"
+
+#: UI/GTK2/src/PinotSettings.cpp:296
+msgid "Couldn't load extraindex block"
+msgstr "N'a pas pu charger le bloc extraindex"
+
+#: UI/GTK2/src/PinotSettings.cpp:303
+msgid "Couldn't load storedquery block"
+msgstr "N'a pas pu charger le bloc storedquery"
+
+#: UI/GTK2/src/PinotSettings.cpp:310
+msgid "Couldn't load results block"
+msgstr "N'a pas pu charger le bloc results"
+
+#: UI/GTK2/src/PinotSettings.cpp:317
+msgid "Couldn't load label block"
+msgstr "N'a pas pu charger le bloc label"
+
+#: UI/GTK2/src/PinotSettings.cpp:335
+msgid "Couldn't load mailaccount block"
+msgstr "N'a pas pu charger le bloc mailaccount"
+
+#: UI/GTK2/src/PinotSettings.cpp:343
+msgid "Couldn't parse configuration file"
+msgstr ""
+
+#: UI/GTK2/src/PinotSettings.cpp:732
+msgid "Unclassified"
+msgstr "Non classifie"
+
+#: UI/GTK2/src/prefsDialog.cc:69
+msgid "Name"
+msgstr "Nom"
+
+#: UI/GTK2/src/prefsDialog.cc:77
+msgid "Location"
+msgstr "Location"
+
+#: UI/GTK2/src/prefsDialog.cc:114
+msgid "In internal viewer"
+msgstr "Dans le brouteur interne"
+
+#: UI/GTK2/src/prefsDialog.cc:117
+msgid "In browser"
+msgstr "Dans le brouteur"
+
+#: UI/GTK2/src/prefsDialog.cc:332
+msgid "Browser location"
+msgstr "Brouter la location"
+
+#: UI/GTK2/src/prefsDialog.cc:343
+msgid "New Label"
+msgstr "Nouvelle Etiquette"
+
+#: UI/GTK2/src/prefsDialog.cc:365
+msgid "Colour"
+msgstr "Couleur"
+
+#. Let the user edit the location
+#: UI/GTK2/src/prefsDialog.cc:436 UI/GTK2/src/prefsDialog.cc:470
+msgid "Mbox File Location"
+msgstr "Location du Fichier mbox"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:62
+msgid "HTTP crawling:"
+msgstr "Brouteur HTTP:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:63
+msgid "View documents:"
+msgstr "Voir les documents"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:64
+msgid "Browser:"
+msgstr "Brouteur:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:65
+msgid "Google API key:"
+msgstr "Clef de l'API Google"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:68
+msgid "Ignore robots.txt and Robots META tag"
+msgstr "Ignorer robots.txt et le META tag Robots"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:74
+msgid "General"
+msgstr "General"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:75
+msgid "Labels are used to classify indexed documents:"
+msgstr "Les etiquettes servent a classer les documents:"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:80 UI/GTK2/src/prefsDialog_glade.cc:106
+msgid "Add"
+msgstr "Ajouter"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:92
+msgid "Remove"
+msgstr "Enlever"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:100
+msgid "Labels"
+msgstr "Etiquettes"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:101
+msgid "Mail boxes of type mbox can be monitored and indexed:"
+msgstr "Les boites de type mbox peuvent etre indexees"
+
+#: UI/GTK2/src/prefsDialog_glade.cc:332
+msgid "Preferences"
+msgstr "Preferences"
+
+#: UI/GTK2/src/propertiesDialog.cc:51
+msgid "Unknown"
+msgstr "Inconnu"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:65
+msgid "Extract:"
+msgstr "Extrait:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:66
+msgid "Language:"
+msgstr "Langue:"
+
+#: UI/GTK2/src/propertiesDialog_glade.cc:68
+msgid "MIME type:"
+msgstr "Type MIME:"
+
+#: UI/GTK2/src/queryDialog.cc:96 UI/GTK2/src/queryDialog.cc:125
+msgid "Any"
+msgstr "N'importe"
+
+#: UI/GTK2/src/queryDialog_glade.cc:70
+msgid "Index all results with label"
+msgstr "Indexer tous les resultats avec l'etiquette"
+
+#: UI/GTK2/src/queryDialog_glade.cc:72
+msgid "Any of the words:"
+msgstr "N'importe lequel des mots:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:73
+msgid "File name:"
+msgstr "Nom de ficher:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:74
+msgid "Number of results:"
+msgstr "Nombre de resultats:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:77
+msgid "Host name:"
+msgstr "Nom de machine:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:78
+msgid "None of the words:"
+msgstr "Aucun des mots:"
+
+#: UI/GTK2/src/queryDialog_glade.cc:84
+msgid "Limit to documents that match"
+msgstr "Limiter aux documents qui ont"
+
+#: UI/GTK2/src/queryDialog_glade.cc:87
+msgid "the exact phrase:"
+msgstr "la phrase"
+
+#: UI/GTK2/src/queryDialog_glade.cc:88
+msgid "the language:"
+msgstr "la langue"
+
+#: UI/GTK2/src/queryDialog_glade.cc:92
+msgid "all the words:"
+msgstr "tous les mots"
+
+#: UI/GTK2/src/queryDialog_glade.cc:93
+msgid "the label:"
+msgstr "l'etiquette"
+
+#: UI/GTK2/src/queryDialog_glade.cc:98
+msgid "Advanced"
+msgstr "Avance"
+
+#: UI/GTK2/src/queryDialog_glade.cc:283
+msgid "Query properties"
+msgstr "Proprietes de la recherche"
+
+#: UI/GTK2/src/WorkerThreads.cpp:374
+msgid "Stopped browsing"
+msgstr "Arrete le brouteur"
+
+#: UI/GTK2/src/WorkerThreads.cpp:407 UI/GTK2/src/WorkerThreads.cpp:625
+#: UI/GTK2/src/WorkerThreads.cpp:662 UI/GTK2/src/WorkerThreads.cpp:671
+#: UI/GTK2/src/WorkerThreads.cpp:864 UI/GTK2/src/WorkerThreads.cpp:1068
+#: UI/GTK2/src/WorkerThreads.cpp:1187
+msgid "Index error on"
+msgstr "Erreur sur l'index"
+
+#: UI/GTK2/src/WorkerThreads.cpp:504
+msgid "Stopped querying"
+msgstr "Arrete la recherche"
+
+#: UI/GTK2/src/WorkerThreads.cpp:516
+msgid "Couldn't create search engine"
+msgstr "N'a pas pu creer le moteur"
+
+#: UI/GTK2/src/WorkerThreads.cpp:527
+msgid "Couldn't run query on search engine"
+msgstr "N'a pas pu lancer la recherche sur le moteur"
+
+#: UI/GTK2/src/WorkerThreads.cpp:543
+msgid "No title"
+msgstr "Pas de titre"
+
+#: UI/GTK2/src/WorkerThreads.cpp:598 UI/GTK2/src/WorkerThreads.cpp:653
+msgid "Stopped querying index labels"
+msgstr "Arrete la recherche d'etiquettes"
+
+#: UI/GTK2/src/WorkerThreads.cpp:732
+msgid "Stopped retrieval of"
+msgstr "Arrete le telechargement de"
+
+#: UI/GTK2/src/WorkerThreads.cpp:768
+msgid "Couldn't obtain downloader for protocol"
+msgstr "N'a pas pu obtenir un brouteur pour"
+
+#: UI/GTK2/src/WorkerThreads.cpp:782 UI/GTK2/src/WorkerThreads.cpp:877
+msgid "Couldn't retrieve"
+msgstr "N'a pas pu telecharger"
+
+#: UI/GTK2/src/WorkerThreads.cpp:849
+msgid "Stopped indexing"
+msgstr "Arrete l'indexation"
+
+#: UI/GTK2/src/WorkerThreads.cpp:901
+msgid "Cannot index document type"
+msgstr "Impossible d'indexer de type de documents"
+
+#: UI/GTK2/src/WorkerThreads.cpp:905
+msgid "at"
+msgstr "a"
+
+#: UI/GTK2/src/WorkerThreads.cpp:929
+msgid "Couldn't tokenize"
+msgstr "N'a pas pu parcourir"
+
+#: UI/GTK2/src/WorkerThreads.cpp:949
+msgid "Robots META tag forbids indexing"
+msgstr "Le META tag Robots empeche d'indexer"
+
+#: UI/GTK2/src/WorkerThreads.cpp:998
+msgid "Couldn't index"
+msgstr "N'a pas pu indexer"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1056
+msgid "Stopped unindexing document(s)"
+msgstr "Arrete d'indexer les document(s)"
+
+#. Be pessimistic and assume something will go wrong ;-)
+#: UI/GTK2/src/WorkerThreads.cpp:1075
+msgid "Couldn't unindex document(s)"
+msgstr "N'a pas pu desindexer le(s) document(s)"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1160
+msgid "Stopped document update for "
+msgstr "Arrete la mise a jour pour "
+
+#: UI/GTK2/src/WorkerThreads.cpp:1195
+msgid "Couldn't update document"
+msgstr "N'a pas pu mettre a jour le document"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1238
+msgid "Stopped listening on"
+msgstr "Arrete l'ecoute sur"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1341
+msgid "Couldn't read FIFO at"
+msgstr "N'a pas pu lire la FIFO a"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1384
+msgid "Stopped monitoring"
+msgstr "Arrete la surveillance"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1405
+msgid "No monitoring handler"
+msgstr "Pas de moniteur"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1451
+msgid "Couldn't open FAM connection"
+msgstr "N'a pas pu ouvrir la connection FAM"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1653
+msgid "Stopped scanning"
+msgstr "Arrete de scanner"
+
+#: UI/GTK2/src/WorkerThreads.cpp:1811
+msgid "Couldn't open directory"
+msgstr "N'a pas pu ovrir le repertoire"

Deleted: trunk/po/fr_FR.po
===================================================================
--- trunk/po/fr_FR.po	2006-02-15 16:49:34 UTC (rev 114)
+++ trunk/po/fr_FR.po	2006-02-16 13:54:50 UTC (rev 115)
@@ -1,872 +0,0 @@
-# fr_FR PO file for pinot.
-# Copyright (C) 2005 Fabrice Colin
-# This file is distributed under the same license as the pinot package.
-# Fabrice Colin <colinf at chez.com>, 2005.
-#
-#, fuzzy
-msgid ""
-msgstr ""
-"Project-Id-Version: pinot 0.42\n"
-"Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-02-15 20:55+0800\n"
-"PO-Revision-Date: 2006-01-20 19:44+0800\n"
-"Last-Translator: Fabrice Colin <colinf at chez.com>\n"
-"Language-Team: en_GB <colinf at chez.com>\n"
-"MIME-Version: 1.0\n"
-"Content-Type: text/plain; charset=utf-8\n"
-"Content-Transfer-Encoding: 8bit\n"
-
-#: UI/GTK2/src/EnginesTree.cpp:67
-msgid "Search Engines"
-msgstr "Moteurs"
-
-#: UI/GTK2/src/EnginesTree.cpp:291
-msgid "Current User"
-msgstr "Utilisateur"
-
-#. Populate the submenu
-#. Bind the callback's parameter to the index name
-#. Enable these menu items, unless the index is not the documents index
-#. Internal indices
-#: UI/GTK2/src/EnginesTree.cpp:303 UI/GTK2/src/mainWindow.cc:340
-#: UI/GTK2/src/mainWindow.cc:343 UI/GTK2/src/mainWindow.cc:516
-#: UI/GTK2/src/mainWindow.cc:1051 UI/GTK2/src/mainWindow.cc:1135
-#: UI/GTK2/src/mainWindow.cc:1170 UI/GTK2/src/mainWindow.cc:1783
-#: UI/GTK2/src/PinotSettings.cpp:199 UI/GTK2/src/PinotSettings.cpp:881
-#: UI/GTK2/src/PinotSettings.cpp:937
-msgid "My Documents"
-msgstr "Mes Documents"
-
-#. Bind the callback's parameter to the index name
-#. Signal
-#: UI/GTK2/src/EnginesTree.cpp:307 UI/GTK2/src/mainWindow.cc:346
-#: UI/GTK2/src/mainWindow.cc:349 UI/GTK2/src/mainWindow.cc:520
-#: UI/GTK2/src/MonitorHandler.cpp:173 UI/GTK2/src/PinotSettings.cpp:200
-#: UI/GTK2/src/PinotSettings.cpp:882 UI/GTK2/src/PinotSettings.cpp:938
-#: UI/GTK2/src/prefsDialog_glade.cc:116
-msgid "My Email"
-msgstr "Mon Courrier"
-
-#: UI/GTK2/src/importDialog.cc:108
-msgid "Enabled"
-msgstr "Active"
-
-#: UI/GTK2/src/importDialog.cc:109 UI/GTK2/src/prefsDialog.cc:78
-msgid "MIME Type"
-msgstr "Type MIME"
-
-#: UI/GTK2/src/importDialog.cc:134
-msgid "File"
-msgstr "Fichier"
-
-#: UI/GTK2/src/importDialog.cc:137
-msgid "Directory"
-msgstr "Repertoire"
-
-#. The last column is for the URL
-#: UI/GTK2/src/importDialog.cc:142 UI/GTK2/src/IndexTree.cpp:70
-#: UI/GTK2/src/ResultsTree.cpp:114
-msgid "URL"
-msgstr "URL"
-
-#: UI/GTK2/src/importDialog.cc:148 UI/GTK2/src/IndexPage.cpp:158
-#: UI/GTK2/src/IndexPage.cpp:204 UI/GTK2/src/queryDialog.cc:91
-msgid "None"
-msgstr ""
-
-#: UI/GTK2/src/importDialog.cc:444
-msgid "Document To Import"
-msgstr "Document A Importer"
-
-#: UI/GTK2/src/importDialog_glade.cc:66 UI/GTK2/src/indexDialog_glade.cc:68
-msgid "Location:"
-msgstr "Location:"
-
-#: UI/GTK2/src/importDialog_glade.cc:67
-#: UI/GTK2/src/propertiesDialog_glade.cc:64
-msgid "Title:"
-msgstr "Titre:"
-
-#: UI/GTK2/src/importDialog_glade.cc:70 UI/GTK2/src/indexDialog_glade.cc:67
-msgid "Type:"
-msgstr "Type:"
-
-#: UI/GTK2/src/importDialog_glade.cc:72 UI/GTK2/src/indexDialog_glade.cc:64
-#: UI/GTK2/src/prefsDialog_glade.cc:70
-msgid "..."
-msgstr "..."
-
-#: UI/GTK2/src/importDialog_glade.cc:78
-msgid "Depth:"
-msgstr "Profondeur:"
-
-#: UI/GTK2/src/importDialog_glade.cc:79
-msgid "Symlinks:"
-msgstr "Liens:"
-
-#: UI/GTK2/src/importDialog_glade.cc:80
-msgid "Follow symlinks"
-msgstr "Suivre les liens symboliques"
-
-#: UI/GTK2/src/importDialog_glade.cc:83
-msgid "Apply label:"
-msgstr ""
-
-#: UI/GTK2/src/importDialog_glade.cc:91 UI/GTK2/src/mainWindow_glade.cc:201
-msgid "Import"
-msgstr "Importer"
-
-#: UI/GTK2/src/importDialog_glade.cc:211
-msgid "Import document"
-msgstr "Import de document"
-
-#: UI/GTK2/src/indexDialog.cc:221
-msgid "Index location"
-msgstr "Location de l'index"
-
-#: UI/GTK2/src/indexDialog_glade.cc:62 UI/GTK2/src/queryDialog_glade.cc:60
-msgid "Name:"
-msgstr "Nom:"
-
-#: UI/GTK2/src/indexDialog_glade.cc:69
-msgid "Port:"
-msgstr "Port:"
-
-#: UI/GTK2/src/indexDialog_glade.cc:143
-msgid "External index"
-msgstr "Index externe"
-
-#. The score column is used for status icons
-#. The title column is also used for status icons
-#: UI/GTK2/src/IndexTree.cpp:64 UI/GTK2/src/ResultsTree.cpp:96
-msgid "Title"
-msgstr "Titre"
-
-#: UI/GTK2/src/IndexTree.cpp:75
-msgid "Timestamp"
-msgstr "Date"
-
-#: UI/GTK2/src/IndexPage.cpp:50
-msgid "Show Previous"
-msgstr "Precedents"
-
-#: UI/GTK2/src/IndexPage.cpp:56
-msgid "Show Next"
-msgstr "Suivants"
-
-#: UI/GTK2/src/mainWindow.cc:144
-msgid "Query Name"
-msgstr "Nom de la Recherche"
-
-#: UI/GTK2/src/mainWindow.cc:149
-msgid "Last Run"
-msgstr "Derniere Utilisation"
-
-#: UI/GTK2/src/mainWindow.cc:150
-msgid "Summary"
-msgstr "Sommaire"
-
-#. Set tooltips
-#: UI/GTK2/src/mainWindow.cc:207
-msgid "Add index"
-msgstr "Ajouter un index"
-
-#: UI/GTK2/src/mainWindow.cc:208
-msgid "Remove index"
-msgstr "Enlever un index"
-
-#. The handler object will be deleted when the thread terminates
-#. Now we are ready
-#: UI/GTK2/src/mainWindow.cc:231
-msgid "Ready"
-msgstr "Pret"
-
-#. Stop in case we were loading a page
-#. Close the existing view page
-#: UI/GTK2/src/mainWindow.cc:245 UI/GTK2/src/mainWindow.cc:1008
-#: UI/GTK2/src/mainWindow.cc:1380 UI/GTK2/src/mainWindow.cc:2953
-#: UI/GTK2/src/mainWindow_glade.cc:207
-msgid "View"
-msgstr "Voir"
-
-#: UI/GTK2/src/mainWindow.cc:277
-msgid "N/A"
-msgstr "Inconnue"
-
-#: UI/GTK2/src/mainWindow.cc:287
-msgid "<undefined>"
-msgstr "<inconnu>"
-
-#. Show the URL in the status bar
-#: UI/GTK2/src/mainWindow.cc:478
-msgid "Result location is"
-msgstr "La location du resultat est"
-
-#. Show the URL in the status bar
-#: UI/GTK2/src/mainWindow.cc:531
-msgid "Document location is"
-msgstr "La location du document is"
-
-#. User selected no label
-#: UI/GTK2/src/mainWindow.cc:640
-msgid "No label"
-msgstr "Pas d'etiquette"
-
-#: UI/GTK2/src/mainWindow.cc:789
-msgid "Showing"
-msgstr "Listant"
-
-#: UI/GTK2/src/mainWindow.cc:794
-msgid "off"
-msgstr "de"
-
-#: UI/GTK2/src/mainWindow.cc:799
-msgid "documents, starting at"
-msgstr "documents venant de"
-
-#: UI/GTK2/src/mainWindow.cc:833
-msgid "Query"
-msgstr "La recherche"
-
-#: UI/GTK2/src/mainWindow.cc:837 UI/GTK2/src/mainWindow.cc:2782
-msgid "on"
-msgstr "sur"
-
-#: UI/GTK2/src/mainWindow.cc:841
-msgid "ended"
-msgstr "est terminee"
-
-#: UI/GTK2/src/mainWindow.cc:942 UI/GTK2/src/propertiesDialog.cc:40
-msgid "Label"
-msgstr "L'etiquette"
-
-#: UI/GTK2/src/mainWindow.cc:946
-msgid "matches"
-msgstr "correspond a"
-
-#: UI/GTK2/src/mainWindow.cc:951
-msgid "document(s)"
-msgstr "document(s)"
-
-#: UI/GTK2/src/mainWindow.cc:983
-msgid "Updated label(s)"
-msgstr "Mis a jour l(es) etiquette(s)"
-
-#. Yes, it did
-#: UI/GTK2/src/mainWindow.cc:1061 UI/GTK2/src/mainWindow.cc:1181
-msgid "Updated document"
-msgstr "Mis a jour le document"
-
-#: UI/GTK2/src/mainWindow.cc:1074
-msgid "Indexed"
-msgstr "Indexe"
-
-#: UI/GTK2/src/mainWindow.cc:1136
-msgid "Unindexed document(s)"
-msgstr "Desindexe le(s) document(s)"
-
-#: UI/GTK2/src/mainWindow.cc:1232
-msgid "Couldn't rename index, name"
-msgstr "N'a pas pu renommer l'index"
-
-#: UI/GTK2/src/mainWindow.cc:1236 UI/GTK2/src/mainWindow.cc:2137
-#: UI/GTK2/src/mainWindow.cc:2616
-msgid "is already in use"
-msgstr "est deja utilise"
-
-#: UI/GTK2/src/mainWindow.cc:1249
-msgid "Couldn't rename index"
-msgstr "N'a pas pu renommer l'index"
-
-#: UI/GTK2/src/mainWindow.cc:1262
-msgid "Edited index"
-msgstr "Edite l'index"
-
-#: UI/GTK2/src/mainWindow.cc:1722 UI/GTK2/src/mainWindow.cc:1825
-msgid "Please set a location for the index first"
-msgstr "Donnez une location a l'index"
-
-#: UI/GTK2/src/mainWindow.cc:1749
-msgid "Result location is unknown"
-msgstr "La location du resultat est inconnue"
-
-#: UI/GTK2/src/mainWindow.cc:1773
-msgid "Import Document(s)"
-msgstr "Import de Document(s)"
-
-#: UI/GTK2/src/mainWindow.cc:1903 UI/GTK2/src/pinot.cc:149
-#: UI/GTK2/src/pinot.cc:154 UI/GTK2/src/WorkerThreads.cpp:393
-#: UI/GTK2/src/WorkerThreads.cpp:620 UI/GTK2/src/WorkerThreads.cpp:1208
-msgid "Index"
-msgstr "L'index"
-
-#: UI/GTK2/src/mainWindow.cc:1907 UI/GTK2/src/WorkerThreads.cpp:397
-#: UI/GTK2/src/WorkerThreads.cpp:624 UI/GTK2/src/WorkerThreads.cpp:1212
-msgid "doesn't exist"
-msgstr "n'existe pas"
-
-#: UI/GTK2/src/mainWindow.cc:2017
-msgid "Delete this document from the index ?"
-msgstr "Enlever ce document de l'index ?"
-
-#: UI/GTK2/src/mainWindow.cc:2036
-msgid "Delete these documents from the index ?"
-msgstr "Enlever ces documents de l'index ?"
-
-#: UI/GTK2/src/mainWindow.cc:2088
-msgid "A metasearch tool for the Free Desktop"
-msgstr "Un outil de recherche pour le Bureau Libre"
-
-#: UI/GTK2/src/mainWindow.cc:2089
-msgid "(C) 2005-2006 Fabrice Colin"
-msgstr "(C) 2005-2006 Fabrice Colin"
-
-#: UI/GTK2/src/mainWindow.cc:2133
-msgid "Index name"
-msgstr "Nom de l'index"
-
-#: UI/GTK2/src/mainWindow.cc:2148
-msgid "Couldn't add index"
-msgstr "N'a pas pu ajouter l'index"
-
-#: UI/GTK2/src/mainWindow.cc:2162
-msgid "Added new index"
-msgstr "Ajouter un nouvel index"
-
-#: UI/GTK2/src/mainWindow.cc:2197
-msgid "Couldn't remove index"
-msgstr "N'a pas pu enlever l'index"
-
-#: UI/GTK2/src/mainWindow.cc:2278
-#, fuzzy
-msgid "Live query"
-msgstr "Edite la recherche"
-
-#: UI/GTK2/src/mainWindow.cc:2431
-msgid "At least one task hasn't completed yet. Quit now ?"
-msgstr "Au moins une tache n'est pas terminee. Quitter maintenant ?"
-
-#: UI/GTK2/src/mainWindow.cc:2612
-msgid "Query name"
-msgstr "Nom de la recherche"
-
-#: UI/GTK2/src/mainWindow.cc:2639
-msgid "Couldn't update query"
-msgstr "N'a pas pu mettre a jour la recherche"
-
-#: UI/GTK2/src/mainWindow.cc:2647
-msgid "Edited query"
-msgstr "Edite la recherche"
-
-#: UI/GTK2/src/mainWindow.cc:2654
-msgid "Couldn't add query"
-msgstr "N'a pas pu ajouter la recherche"
-
-#: UI/GTK2/src/mainWindow.cc:2662
-msgid "Added new query"
-msgstr "Ajoute une nouvelle recherche"
-
-#: UI/GTK2/src/mainWindow.cc:2676
-msgid "Query is not set"
-msgstr "Recherche indefinie"
-
-#: UI/GTK2/src/mainWindow.cc:2687
-msgid "No search engine selected"
-msgstr "Pas de moteur selectionne"
-
-#: UI/GTK2/src/mainWindow.cc:2769
-msgid "Please set the Google API key first"
-msgstr "Configurez la clef de l'API Google "
-
-#: UI/GTK2/src/mainWindow.cc:2778
-msgid "Running query"
-msgstr "Recherche en cours"
-
-#: UI/GTK2/src/mainWindow.cc:2884
-msgid "is already indexed or is being indexed"
-msgstr "est deja indexe ou est en cours d'indexation"
-
-#: UI/GTK2/src/mainWindow.cc:2911
-msgid "No URL to browse"
-msgstr "Pas d'URL a brouter"
-
-#: UI/GTK2/src/mainWindow.cc:2922
-msgid "No browser configured to view results"
-msgstr "Pas de brouter configure"
-
-#: UI/GTK2/src/mainWindow.cc:2934
-msgid "Couldn't browse URL:"
-msgstr "N'a pas pu brouter l'URL"
-
-#: UI/GTK2/src/mainWindow.cc:2993
-#, fuzzy
-msgid "Viewing"
-msgstr "Voir"
-
-#: UI/GTK2/src/mainWindow_glade.cc:115
-msgid "Query:"
-msgstr "Recherche:"
-
-#: UI/GTK2/src/mainWindow_glade.cc:127 UI/GTK2/src/prefsDialog_glade.cc:86
-msgid "Edit"
-msgstr "Editer"
-
-#: UI/GTK2/src/mainWindow_glade.cc:136
-msgid "Stored queries"
-msgstr "Recherches sauvegardees"
-
-#: UI/GTK2/src/mainWindow_glade.cc:171
-msgid "Search Engine"
-msgstr "Moteurs"
-
-#: UI/GTK2/src/mainWindow_glade.cc:174
-msgid "Host Name"
-msgstr "Nom de machine"
-
-#: UI/GTK2/src/mainWindow_glade.cc:177
-msgid "Clear List"
-msgstr "Nettoyer la Liste"
-
-#: UI/GTK2/src/mainWindow_glade.cc:180
-msgid "Show Extract"
-msgstr "Montrer l'Extrait"
-
-#: UI/GTK2/src/mainWindow_glade.cc:183
-msgid "Group By"
-msgstr "Grouper Par"
-
-#: UI/GTK2/src/mainWindow_glade.cc:189
-msgid "Vie_w"
-msgstr "Voir"
-
-#: UI/GTK2/src/mainWindow_glade.cc:192
-msgid "View Cache"
-msgstr "Voir le Cache"
-
-#: UI/GTK2/src/mainWindow_glade.cc:195 UI/GTK2/src/mainWindow_glade.cc:231
-msgid "_Index"
-msgstr "Index"
-
-#: UI/GTK2/src/mainWindow_glade.cc:198
-msgid "List Contents Of"
-msgstr "Lister le Contenu de"
-
-#: UI/GTK2/src/mainWindow_glade.cc:210
-msgid "Update"
-msgstr "Mettre a Jour"
-
-#: UI/GTK2/src/mainWindow_glade.cc:213
-msgid "Unindex"
-msgstr "Desindexer"
-
-#: UI/GTK2/src/mainWindow_glade.cc:216
-#: UI/GTK2/src/propertiesDialog_glade.cc:171
-#: UI/GTK2/src/queryDialog_glade.cc:83
-msgid "Properties"
-msgstr "Proprietes"
-
-#: UI/GTK2/src/mainWindow_glade.cc:219
-msgid "_About"
-msgstr "A Propos"
-
-#: UI/GTK2/src/mainWindow_glade.cc:222
-msgid "_Session"
-msgstr "Session"
-
-#: UI/GTK2/src/mainWindow_glade.cc:225
-msgid "_Edit"
-msgstr "Editer"
-
-#: UI/GTK2/src/mainWindow_glade.cc:228
-msgid "_Results"
-msgstr "Resultats"
-
-#: UI/GTK2/src/mainWindow_glade.cc:234
-msgid "_Help"
-msgstr "Aide"
-
-#: UI/GTK2/src/mainWindow_glade.cc:356
-msgid "Pinot"
-msgstr "Pinot"
-
-#: UI/GTK2/src/pinot.cc:56
-msgid "Couldn't save configuration file"
-msgstr "N'a pas pu sauve le fichier de configuration"
-
-#. Localize language names
-#: UI/GTK2/src/pinot.cc:118
-msgid "Danish"
-msgstr "Danois"
-
-#: UI/GTK2/src/pinot.cc:119
-msgid "Dutch"
-msgstr "Hollandais"
-
-#: UI/GTK2/src/pinot.cc:120
-msgid "English"
-msgstr "Anglais"
-
-#: UI/GTK2/src/pinot.cc:121
-msgid "Finnish"
-msgstr "Finlandais"
-
-#: UI/GTK2/src/pinot.cc:122
-msgid "French"
-msgstr "Francais"
-
-#: UI/GTK2/src/pinot.cc:123
-msgid "German"
-msgstr "Allemand"
-
-#: UI/GTK2/src/pinot.cc:124
-msgid "Italian"
-msgstr "Italien"
-
-#: UI/GTK2/src/pinot.cc:125
-msgid "Norwegian"
-msgstr "Norvegien"
-
-#: UI/GTK2/src/pinot.cc:126
-msgid "Portuguese"
-msgstr "Portugais"
-
-#: UI/GTK2/src/pinot.cc:127
-msgid "Russian"
-msgstr "Russe"
-
-#: UI/GTK2/src/pinot.cc:128
-msgid "Spanish"
-msgstr "Espagnol"
-
-#: UI/GTK2/src/pinot.cc:129
-msgid "Swedish"
-msgstr "Suedois"
-
-#: UI/GTK2/src/pinot.cc:150 UI/GTK2/src/pinot.cc:155
-msgid "is not valid, please check"
-msgstr "n'est pas valide, veuillez verifier"
-
-#: UI/GTK2/src/pinot.cc:163
-msgid "History database"
-msgstr "La base des historiques"
-
-#: UI/GTK2/src/pinot.cc:164
-msgid "couldn't be created"
-msgstr "n'a pas pu etre creee"
-
-#: UI/GTK2/src/PinotSettings.cpp:106
-msgid "Couldn't create pinot directory at"
-msgstr "N'a pas pu creer le repertoire a"
-
-#: UI/GTK2/src/PinotSettings.cpp:195
-msgid "Failed to parse configuration file"
-msgstr "N'a pas pu lire le fichier de configuration"
-
-#: UI/GTK2/src/PinotSettings.cpp:204
-msgid "Red"
-msgstr "Rouge"
-
-#: UI/GTK2/src/PinotSettings.cpp:206
-msgid "Blue"
-msgstr "Bleu"
-
-#: UI/GTK2/src/PinotSettings.cpp:208
-msgid "Green"
-msgstr "Vert"
-
-#: UI/GTK2/src/PinotSettings.cpp:289
-msgid "Couldn't load ui block"
-msgstr "N'a pas pu charger le bloc ui"
-
-#: UI/GTK2/src/PinotSettings.cpp:296
-msgid "Couldn't load extraindex block"
-msgstr "N'a pas pu charger le bloc extraindex"
-
-#: UI/GTK2/src/PinotSettings.cpp:303
-msgid "Couldn't load storedquery block"
-msgstr "N'a pas pu charger le bloc storedquery"
-
-#: UI/GTK2/src/PinotSettings.cpp:310
-msgid "Couldn't load results block"
-msgstr "N'a pas pu charger le bloc results"
-
-#: UI/GTK2/src/PinotSettings.cpp:317
-msgid "Couldn't load label block"
-msgstr "N'a pas pu charger le bloc label"
-
-#: UI/GTK2/src/PinotSettings.cpp:335
-msgid "Couldn't load mailaccount block"
-msgstr "N'a pas pu charger le bloc mailaccount"
-
-#: UI/GTK2/src/PinotSettings.cpp:343
-msgid "Couldn't parse configuration file"
-msgstr ""
-
-#: UI/GTK2/src/PinotSettings.cpp:732
-msgid "Unclassified"
-msgstr "Non classifie"
-
-#: UI/GTK2/src/prefsDialog.cc:69
-msgid "Name"
-msgstr "Nom"
-
-#: UI/GTK2/src/prefsDialog.cc:77
-msgid "Location"
-msgstr "Location"
-
-#: UI/GTK2/src/prefsDialog.cc:114
-msgid "In internal viewer"
-msgstr "Dans le brouteur interne"
-
-#: UI/GTK2/src/prefsDialog.cc:117
-msgid "In browser"
-msgstr "Dans le brouteur"
-
-#: UI/GTK2/src/prefsDialog.cc:332
-msgid "Browser location"
-msgstr "Brouter la location"
-
-#: UI/GTK2/src/prefsDialog.cc:343
-msgid "New Label"
-msgstr "Nouvelle Etiquette"
-
-#: UI/GTK2/src/prefsDialog.cc:365
-msgid "Colour"
-msgstr "Couleur"
-
-#. Let the user edit the location
-#: UI/GTK2/src/prefsDialog.cc:436 UI/GTK2/src/prefsDialog.cc:470
-msgid "Mbox File Location"
-msgstr "Location du Fichier mbox"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:62
-msgid "HTTP crawling:"
-msgstr "Brouteur HTTP:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:63
-msgid "View documents:"
-msgstr "Voir les documents"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:64
-msgid "Browser:"
-msgstr "Brouteur:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:65
-msgid "Google API key:"
-msgstr "Clef de l'API Google"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:68
-msgid "Ignore robots.txt and Robots META tag"
-msgstr "Ignorer robots.txt et le META tag Robots"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:74
-msgid "General"
-msgstr "General"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:75
-msgid "Labels are used to classify indexed documents:"
-msgstr "Les etiquettes servent a classer les documents:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:80 UI/GTK2/src/prefsDialog_glade.cc:106
-msgid "Add"
-msgstr "Ajouter"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:92
-msgid "Remove"
-msgstr "Enlever"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:100
-msgid "Labels"
-msgstr "Etiquettes"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:101
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr "Les boites de type mbox peuvent etre indexees"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:332
-msgid "Preferences"
-msgstr "Preferences"
-
-#: UI/GTK2/src/propertiesDialog.cc:51
-msgid "Unknown"
-msgstr "Inconnu"
-
-#: UI/GTK2/src/propertiesDialog_glade.cc:65
-msgid "Extract:"
-msgstr "Extrait:"
-
-#: UI/GTK2/src/propertiesDialog_glade.cc:66
-msgid "Language:"
-msgstr "Langue:"
-
-#: UI/GTK2/src/propertiesDialog_glade.cc:68
-msgid "MIME type:"
-msgstr "Type MIME:"
-
-#: UI/GTK2/src/queryDialog.cc:96 UI/GTK2/src/queryDialog.cc:125
-msgid "Any"
-msgstr "N'importe"
-
-#: UI/GTK2/src/queryDialog_glade.cc:70
-msgid "Index all results with label"
-msgstr "Indexer tous les resultats avec l'etiquette"
-
-#: UI/GTK2/src/queryDialog_glade.cc:72
-msgid "Any of the words:"
-msgstr "N'importe lequel des mots:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:73
-msgid "File name:"
-msgstr "Nom de ficher:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:74
-msgid "Number of results:"
-msgstr "Nombre de resultats:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:77
-msgid "Host name:"
-msgstr "Nom de machine:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:78
-msgid "None of the words:"
-msgstr "Aucun des mots:"
-
-#: UI/GTK2/src/queryDialog_glade.cc:84
-msgid "Limit to documents that match"
-msgstr "Limiter aux documents qui ont"
-
-#: UI/GTK2/src/queryDialog_glade.cc:87
-msgid "the exact phrase:"
-msgstr "la phrase"
-
-#: UI/GTK2/src/queryDialog_glade.cc:88
-msgid "the language:"
-msgstr "la langue"
-
-#: UI/GTK2/src/queryDialog_glade.cc:92
-msgid "all the words:"
-msgstr "tous les mots"
-
-#: UI/GTK2/src/queryDialog_glade.cc:93
-msgid "the label:"
-msgstr "l'etiquette"
-
-#: UI/GTK2/src/queryDialog_glade.cc:98
-msgid "Advanced"
-msgstr "Avance"
-
-#: UI/GTK2/src/queryDialog_glade.cc:283
-msgid "Query properties"
-msgstr "Proprietes de la recherche"
-
-#: UI/GTK2/src/WorkerThreads.cpp:372
-msgid "Stopped browsing"
-msgstr "Arrete le brouteur"
-
-#: UI/GTK2/src/WorkerThreads.cpp:406 UI/GTK2/src/WorkerThreads.cpp:632
-#: UI/GTK2/src/WorkerThreads.cpp:672 UI/GTK2/src/WorkerThreads.cpp:682
-#: UI/GTK2/src/WorkerThreads.cpp:888 UI/GTK2/src/WorkerThreads.cpp:1098
-#: UI/GTK2/src/WorkerThreads.cpp:1221
-msgid "Index error on"
-msgstr "Erreur sur l'index"
-
-#: UI/GTK2/src/WorkerThreads.cpp:507
-msgid "Stopped querying"
-msgstr "Arrete la recherche"
-
-#: UI/GTK2/src/WorkerThreads.cpp:519
-msgid "Couldn't create search engine"
-msgstr "N'a pas pu creer le moteur"
-
-#: UI/GTK2/src/WorkerThreads.cpp:531
-msgid "Couldn't run query on search engine"
-msgstr "N'a pas pu lancer la recherche sur le moteur"
-
-#: UI/GTK2/src/WorkerThreads.cpp:547
-msgid "No title"
-msgstr "Pas de titre"
-
-#: UI/GTK2/src/WorkerThreads.cpp:604 UI/GTK2/src/WorkerThreads.cpp:663
-msgid "Stopped querying index labels"
-msgstr "Arrete la recherche d'etiquettes"
-
-#: UI/GTK2/src/WorkerThreads.cpp:748
-msgid "Stopped retrieval of"
-msgstr "Arrete le telechargement de"
-
-#: UI/GTK2/src/WorkerThreads.cpp:784
-msgid "Couldn't obtain downloader for protocol"
-msgstr "N'a pas pu obtenir un brouteur pour"
-
-#: UI/GTK2/src/WorkerThreads.cpp:798 UI/GTK2/src/WorkerThreads.cpp:902
-msgid "Couldn't retrieve"
-msgstr "N'a pas pu telecharger"
-
-#: UI/GTK2/src/WorkerThreads.cpp:873
-msgid "Stopped indexing"
-msgstr "Arrete l'indexation"
-
-#: UI/GTK2/src/WorkerThreads.cpp:926
-msgid "Cannot index document type"
-msgstr "Impossible d'indexer de type de documents"
-
-#: UI/GTK2/src/WorkerThreads.cpp:930
-msgid "at"
-msgstr "a"
-
-#: UI/GTK2/src/WorkerThreads.cpp:955
-msgid "Couldn't tokenize"
-msgstr "N'a pas pu parcourir"
-
-#: UI/GTK2/src/WorkerThreads.cpp:976
-msgid "Robots META tag forbids indexing"
-msgstr "Le META tag Robots empeche d'indexer"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1026
-msgid "Couldn't index"
-msgstr "N'a pas pu indexer"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1086
-msgid "Stopped unindexing document(s)"
-msgstr "Arrete d'indexer les document(s)"
-
-#. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1106
-msgid "Couldn't unindex document(s)"
-msgstr "N'a pas pu desindexer le(s) document(s)"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1193
-msgid "Stopped document update for "
-msgstr "Arrete la mise a jour pour "
-
-#: UI/GTK2/src/WorkerThreads.cpp:1230
-msgid "Couldn't update document"
-msgstr "N'a pas pu mettre a jour le document"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1275
-msgid "Stopped listening on"
-msgstr "Arrete l'ecoute sur"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1378
-msgid "Couldn't read FIFO at"
-msgstr "N'a pas pu lire la FIFO a"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1423
-msgid "Stopped monitoring"
-msgstr "Arrete la surveillance"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1444
-msgid "No monitoring handler"
-msgstr "Pas de moniteur"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1491
-msgid "Couldn't open FAM connection"
-msgstr "N'a pas pu ouvrir la connection FAM"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1696
-msgid "Stopped scanning"
-msgstr "Arrete de scanner"
-
-#: UI/GTK2/src/WorkerThreads.cpp:1854
-msgid "Couldn't open directory"
-msgstr "N'a pas pu ovrir le repertoire"



From fabricecolin at berlios.de  Thu Feb 16 16:08:08 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Thu, 16 Feb 2006 16:08:08 +0100
Subject: [Pinot-svn] r116 - in trunk: . Tokenize
Message-ID: <200602161508.k1GF8829022581@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-16 16:08:03 +0100 (Thu, 16 Feb 2006)
New Revision: 116

Modified:
   trunk/Makefile.am
   trunk/Tokenize/Makefile.am
Log:
Sorted out tokenizer libraries.


Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2006-02-16 13:54:50 UTC (rev 115)
+++ trunk/Makefile.am	2006-02-16 15:08:03 UTC (rev 116)
@@ -26,5 +26,3 @@
 
 ACLOCAL_AMFLAGS = -I m4
 
-AM_CXXFLAGS = -fPIC
-

Modified: trunk/Tokenize/Makefile.am
===================================================================
--- trunk/Tokenize/Makefile.am	2006-02-16 13:54:50 UTC (rev 115)
+++ trunk/Tokenize/Makefile.am	2006-02-16 15:08:03 UTC (rev 116)
@@ -18,21 +18,21 @@
 
 libpdftokenizer_la_LDFLAGS = -L../Utils 
 
-libpdftokenizer_la_LIBADD = libTokenize.la ../Utils/libUtils.la
+libpdftokenizer_la_LIBADD = ../Utils/libUtils.la HtmlTokenizer.o Tokenizer.o
 
 librtftokenizer_la_SOURCES = \
 	RtfTokenizer.cpp
 
 librtftokenizer_la_LDFLAGS = -L../Utils
 
-librtftokenizer_la_LIBADD = libTokenize.la ../Utils/libUtils.la
+librtftokenizer_la_LIBADD = ../Utils/libUtils.la HtmlTokenizer.o Tokenizer.o
 
 libwordtokenizer_la_SOURCES = \
 	WordTokenizer.cpp
 
 libwordtokenizer_la_LDFLAGS = -L../Utils
 
-libwordtokenizer_la_LIBADD = libTokenize.la ../Utils/libUtils.la
+libwordtokenizer_la_LIBADD = ../Utils/libUtils.la Tokenizer.o
 
 libTokenize_la_SOURCES = \
 	HtmlTokenizer.cpp \



From fabricecolin at berlios.de  Fri Feb 17 13:29:31 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Fri, 17 Feb 2006 13:29:31 +0100
Subject: [Pinot-svn] r117 - trunk/UI/GTK2/src
Message-ID: <200602171229.k1HCTVbV013321@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-17 13:29:29 +0100 (Fri, 17 Feb 2006)
New Revision: 117

Modified:
   trunk/UI/GTK2/src/mainWindow.hh
   trunk/UI/GTK2/src/pinot.cc
Log:
If an index couldn't be opened, or the history database not created, show
an error message in the main window's status bar.


Modified: trunk/UI/GTK2/src/mainWindow.hh
===================================================================
--- trunk/UI/GTK2/src/mainWindow.hh	2006-02-16 15:08:03 UTC (rev 116)
+++ trunk/UI/GTK2/src/mainWindow.hh	2006-02-17 12:29:29 UTC (rev 117)
@@ -52,6 +52,8 @@
 	mainWindow();
 	virtual ~mainWindow();
 
+	void set_status(const Glib::ustring &text, bool canBeSkipped = false);
+
 protected:
 	// Utility methods
 	void populate_queryTreeview();
@@ -132,7 +134,6 @@
 
 	// Status methods
 	bool on_activity_timeout(void);
-	void set_status(const Glib::ustring &text, bool canBeSkipped = false);
 
 private:
 	// Global settings

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2006-02-16 15:08:03 UTC (rev 116)
+++ trunk/UI/GTK2/src/pinot.cc	2006-02-17 12:29:29 UTC (rev 117)
@@ -87,6 +87,7 @@
 int main(int argc, char **argv)
 {
 	string prefixDir(PREFIX);
+	Glib::ustring errorMsg;
 	struct sigaction newAction;
 
 #if defined(ENABLE_NLS)
@@ -145,15 +146,21 @@
 	sigaction(SIGQUIT, &newAction, NULL);
 
 	// Ensure Xapian will be able to deal with internal indices
-	if (XapianDatabaseFactory::getDatabase(settings.m_indexLocation, false) == NULL)
+	XapianDatabase *pDb = XapianDatabaseFactory::getDatabase(settings.m_indexLocation, false);
+	if ((pDb == NULL) ||
+		(pDb->isOpen() == false))
 	{
-		cerr << _("Index") << " " << settings.m_indexLocation << " "
-			<< _("is not valid, please check") << endl;
+		errorMsg = _("Couldn't open index");
+		errorMsg += " ";
+		errorMsg += settings.m_indexLocation;
 	}
-	if (XapianDatabaseFactory::getDatabase(settings.m_mailIndexLocation, false) == NULL)
+	pDb = XapianDatabaseFactory::getDatabase(settings.m_mailIndexLocation, false);
+	if ((pDb == NULL) ||
+		(pDb->isOpen() == false))
 	{
-		cerr << _("Index") << " " << settings.m_mailIndexLocation << " "
-			<< _("is not valid, please check") << endl;
+		errorMsg = _("Couldn't open index");
+		errorMsg += " ";
+		errorMsg += settings.m_mailIndexLocation;
 	}
 
 	// Do the same for the history database
@@ -161,8 +168,9 @@
 		(QueryHistory::create(settings.m_historyDatabase) == false) ||
 		(ViewHistory::create(settings.m_historyDatabase) == false))
 	{
-		cerr << _("History database") << " " << settings.m_historyDatabase << " "
-			<< _("couldn't be created") << endl;
+		errorMsg = _("Couldn't create history database");
+		errorMsg += " ";
+		errorMsg += settings.m_historyDatabase;
 	}
 
 	atexit(closeAll);
@@ -174,6 +182,10 @@
 
 		// Create and open the main dialog box
 		mainWindow mainBox;
+		if (errorMsg.empty() == false)
+		{
+			mainBox.set_status(errorMsg);
+		}
 		m.run(mainBox);
 	}
 	catch (const Glib::Exception &e)



From fabricecolin at berlios.de  Fri Feb 17 15:56:26 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Fri, 17 Feb 2006 15:56:26 +0100
Subject: [Pinot-svn] r118 - trunk/po
Message-ID: <200602171456.k1HEuQtt005477@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-17 15:56:25 +0100 (Fri, 17 Feb 2006)
New Revision: 118

Modified:
   trunk/po/es.po
   trunk/po/fr.po
Log:
Synced catalogs with current source.


Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2006-02-17 12:29:29 UTC (rev 117)
+++ trunk/po/es.po	2006-02-17 14:56:25 UTC (rev 118)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.43\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-02-16 21:57+0800\n"
+"POT-Creation-Date: 2006-02-17 20:03+0800\n"
 "PO-Revision-Date: 2006-01-30 16:44+0800\n"
 "Last-Translator: Jes?s Tramullas <jesus at tramullas.com>\n"
 "Language-Team: es <jesus at tramullas.com>\n"
@@ -294,8 +294,7 @@
 msgid "Import Document(s)"
 msgstr "Importar Documento(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1910 UI/GTK2/src/pinot.cc:150
-#: UI/GTK2/src/pinot.cc:155 UI/GTK2/src/WorkerThreads.cpp:395
+#: UI/GTK2/src/mainWindow.cc:1910 UI/GTK2/src/WorkerThreads.cpp:395
 #: UI/GTK2/src/WorkerThreads.cpp:614 UI/GTK2/src/WorkerThreads.cpp:1175
 msgid "Index"
 msgstr "?ndice"
@@ -494,66 +493,64 @@
 msgstr "No se pudo guardar el fichero de configuraci?n"
 
 #. Localize language names
-#: UI/GTK2/src/pinot.cc:119
+#: UI/GTK2/src/pinot.cc:120
 msgid "Danish"
 msgstr "Dan?s"
 
-#: UI/GTK2/src/pinot.cc:120
+#: UI/GTK2/src/pinot.cc:121
 msgid "Dutch"
 msgstr "Holand?s"
 
-#: UI/GTK2/src/pinot.cc:121
+#: UI/GTK2/src/pinot.cc:122
 msgid "English"
 msgstr "Ingl?s"
 
-#: UI/GTK2/src/pinot.cc:122
+#: UI/GTK2/src/pinot.cc:123
 msgid "Finnish"
 msgstr "Finland?s"
 
-#: UI/GTK2/src/pinot.cc:123
+#: UI/GTK2/src/pinot.cc:124
 msgid "French"
 msgstr "Franc?s"
 
-#: UI/GTK2/src/pinot.cc:124
+#: UI/GTK2/src/pinot.cc:125
 msgid "German"
 msgstr "Alem?n"
 
-#: UI/GTK2/src/pinot.cc:125
+#: UI/GTK2/src/pinot.cc:126
 msgid "Italian"
 msgstr "Italiano"
 
-#: UI/GTK2/src/pinot.cc:126
+#: UI/GTK2/src/pinot.cc:127
 msgid "Norwegian"
 msgstr "Noruego"
 
-#: UI/GTK2/src/pinot.cc:127
+#: UI/GTK2/src/pinot.cc:128
 msgid "Portuguese"
 msgstr "Portugu?s"
 
-#: UI/GTK2/src/pinot.cc:128
+#: UI/GTK2/src/pinot.cc:129
 msgid "Russian"
 msgstr "Ruso"
 
-#: UI/GTK2/src/pinot.cc:129
+#: UI/GTK2/src/pinot.cc:130
 msgid "Spanish"
 msgstr "Espa?ol"
 
-#: UI/GTK2/src/pinot.cc:130
+#: UI/GTK2/src/pinot.cc:131
 msgid "Swedish"
 msgstr "Sueco"
 
-#: UI/GTK2/src/pinot.cc:151 UI/GTK2/src/pinot.cc:156
-msgid "is not valid, please check"
-msgstr "no es v?lido, por favor compru?belo"
+#: UI/GTK2/src/pinot.cc:153 UI/GTK2/src/pinot.cc:161
+#, fuzzy
+msgid "Couldn't open index"
+msgstr "No se pudo borrar el ?ndice"
 
-#: UI/GTK2/src/pinot.cc:164
-msgid "History database"
-msgstr "Base de datos del hist?rico"
+#: UI/GTK2/src/pinot.cc:171
+#, fuzzy
+msgid "Couldn't create history database"
+msgstr "No se pudo crear un directorio pinot en"
 
-#: UI/GTK2/src/pinot.cc:165
-msgid "couldn't be created"
-msgstr "no se pudo crear"
-
 #: UI/GTK2/src/PinotSettings.cpp:106
 msgid "Couldn't create pinot directory at"
 msgstr "No se pudo crear un directorio pinot en"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2006-02-17 12:29:29 UTC (rev 117)
+++ trunk/po/fr.po	2006-02-17 14:56:25 UTC (rev 118)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.43\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-02-16 21:57+0800\n"
+"POT-Creation-Date: 2006-02-17 20:03+0800\n"
 "PO-Revision-Date: 2006-01-20 19:44+0800\n"
 "Last-Translator: Fabrice Colin <colinf at chez.com>\n"
 "Language-Team: fr <colinf at chez.com>\n"
@@ -72,7 +72,7 @@
 #: UI/GTK2/src/importDialog.cc:148 UI/GTK2/src/IndexPage.cpp:158
 #: UI/GTK2/src/IndexPage.cpp:204 UI/GTK2/src/queryDialog.cc:91
 msgid "None"
-msgstr ""
+msgstr "Aucune"
 
 #: UI/GTK2/src/importDialog.cc:444
 msgid "Document To Import"
@@ -110,7 +110,7 @@
 
 #: UI/GTK2/src/importDialog_glade.cc:83
 msgid "Apply label:"
-msgstr ""
+msgstr "Appliquer l'etiquette:"
 
 #: UI/GTK2/src/importDialog_glade.cc:91 UI/GTK2/src/mainWindow_glade.cc:201
 msgid "Import"
@@ -294,8 +294,7 @@
 msgid "Import Document(s)"
 msgstr "Import de Document(s)"
 
-#: UI/GTK2/src/mainWindow.cc:1910 UI/GTK2/src/pinot.cc:150
-#: UI/GTK2/src/pinot.cc:155 UI/GTK2/src/WorkerThreads.cpp:395
+#: UI/GTK2/src/mainWindow.cc:1910 UI/GTK2/src/WorkerThreads.cpp:395
 #: UI/GTK2/src/WorkerThreads.cpp:614 UI/GTK2/src/WorkerThreads.cpp:1175
 msgid "Index"
 msgstr "L'index"
@@ -494,66 +493,64 @@
 msgstr "N'a pas pu sauve le fichier de configuration"
 
 #. Localize language names
-#: UI/GTK2/src/pinot.cc:119
+#: UI/GTK2/src/pinot.cc:120
 msgid "Danish"
 msgstr "Danois"
 
-#: UI/GTK2/src/pinot.cc:120
+#: UI/GTK2/src/pinot.cc:121
 msgid "Dutch"
 msgstr "Hollandais"
 
-#: UI/GTK2/src/pinot.cc:121
+#: UI/GTK2/src/pinot.cc:122
 msgid "English"
 msgstr "Anglais"
 
-#: UI/GTK2/src/pinot.cc:122
+#: UI/GTK2/src/pinot.cc:123
 msgid "Finnish"
 msgstr "Finlandais"
 
-#: UI/GTK2/src/pinot.cc:123
+#: UI/GTK2/src/pinot.cc:124
 msgid "French"
 msgstr "Francais"
 
-#: UI/GTK2/src/pinot.cc:124
+#: UI/GTK2/src/pinot.cc:125
 msgid "German"
 msgstr "Allemand"
 
-#: UI/GTK2/src/pinot.cc:125
+#: UI/GTK2/src/pinot.cc:126
 msgid "Italian"
 msgstr "Italien"
 
-#: UI/GTK2/src/pinot.cc:126
+#: UI/GTK2/src/pinot.cc:127
 msgid "Norwegian"
 msgstr "Norvegien"
 
-#: UI/GTK2/src/pinot.cc:127
+#: UI/GTK2/src/pinot.cc:128
 msgid "Portuguese"
 msgstr "Portugais"
 
-#: UI/GTK2/src/pinot.cc:128
+#: UI/GTK2/src/pinot.cc:129
 msgid "Russian"
 msgstr "Russe"
 
-#: UI/GTK2/src/pinot.cc:129
+#: UI/GTK2/src/pinot.cc:130
 msgid "Spanish"
 msgstr "Espagnol"
 
-#: UI/GTK2/src/pinot.cc:130
+#: UI/GTK2/src/pinot.cc:131
 msgid "Swedish"
 msgstr "Suedois"
 
-#: UI/GTK2/src/pinot.cc:151 UI/GTK2/src/pinot.cc:156
-msgid "is not valid, please check"
-msgstr "n'est pas valide, veuillez verifier"
+#: UI/GTK2/src/pinot.cc:153 UI/GTK2/src/pinot.cc:161
+#, fuzzy
+msgid "Couldn't open index"
+msgstr "N'a pas pu enlever l'index"
 
-#: UI/GTK2/src/pinot.cc:164
-msgid "History database"
-msgstr "La base des historiques"
+#: UI/GTK2/src/pinot.cc:171
+#, fuzzy
+msgid "Couldn't create history database"
+msgstr "N'a pas pu creer le repertoire a"
 
-#: UI/GTK2/src/pinot.cc:165
-msgid "couldn't be created"
-msgstr "n'a pas pu etre creee"
-
 #: UI/GTK2/src/PinotSettings.cpp:106
 msgid "Couldn't create pinot directory at"
 msgstr "N'a pas pu creer le repertoire a"
@@ -600,7 +597,7 @@
 
 #: UI/GTK2/src/PinotSettings.cpp:343
 msgid "Couldn't parse configuration file"
-msgstr ""
+msgstr "N'a pas pu lire le fichier de configuration"
 
 #: UI/GTK2/src/PinotSettings.cpp:732
 msgid "Unclassified"



From fabricecolin at berlios.de  Sat Feb 18 08:19:33 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sat, 18 Feb 2006 08:19:33 +0100
Subject: [Pinot-svn] r119 - in trunk: . Tokenize
Message-ID: <200602180719.k1I7JXES021920@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-18 08:19:26 +0100 (Sat, 18 Feb 2006)
New Revision: 119

Modified:
   trunk/Tokenize/Makefile.am
   trunk/configure.in
   trunk/pinot.spec.in
Log:
Build fix for tokenizers. Neon requires OpenSSL, so check for it explicitely
(useful on Slackware, reported by Bernhard "I wanna play headball !" Fruhmesser).
Reverted to Xapian v0.9.2 in spec file, as it works well enough.


Modified: trunk/Tokenize/Makefile.am
===================================================================
--- trunk/Tokenize/Makefile.am	2006-02-17 14:56:25 UTC (rev 118)
+++ trunk/Tokenize/Makefile.am	2006-02-18 07:19:26 UTC (rev 119)
@@ -14,25 +14,32 @@
 noinst_LTLIBRARIES = libTokenize.la
 
 libpdftokenizer_la_SOURCES = \
-	PdfTokenizer.cpp
+	../Utils/StringManip.cpp \
+	PdfTokenizer.cpp \
+	HtmlTokenizer.cpp \
+	Tokenizer.cpp
 
-libpdftokenizer_la_LDFLAGS = -L../Utils 
+libpdftokenizer_la_LDFLAGS =
 
-libpdftokenizer_la_LIBADD = ../Utils/libUtils.la HtmlTokenizer.o Tokenizer.o
+libpdftokenizer_la_LIBADD =
 
 librtftokenizer_la_SOURCES = \
-	RtfTokenizer.cpp
+	../Utils/StringManip.cpp \
+	RtfTokenizer.cpp \
+	HtmlTokenizer.cpp \
+	Tokenizer.cpp
 
-librtftokenizer_la_LDFLAGS = -L../Utils
+librtftokenizer_la_LDFLAGS =
 
-librtftokenizer_la_LIBADD = ../Utils/libUtils.la HtmlTokenizer.o Tokenizer.o
+librtftokenizer_la_LIBADD =
 
 libwordtokenizer_la_SOURCES = \
-	WordTokenizer.cpp
+	WordTokenizer.cpp \
+	Tokenizer.cpp
 
-libwordtokenizer_la_LDFLAGS = -L../Utils
+libwordtokenizer_la_LDFLAGS =
 
-libwordtokenizer_la_LIBADD = ../Utils/libUtils.la Tokenizer.o
+libwordtokenizer_la_LIBADD =
 
 libTokenize_la_SOURCES = \
 	HtmlTokenizer.cpp \

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2006-02-17 14:56:25 UTC (rev 118)
+++ trunk/configure.in	2006-02-18 07:19:26 UTC (rev 119)
@@ -63,7 +63,10 @@
 PKG_CHECK_MODULES(SQL, sqlite3 >= 3.1 )
 AC_SUBST(SQL_CFLAGS)
 AC_SUBST(SQL_LIBS)
-PKG_CHECK_MODULES(HTTP, neon >= 0.24 )
+PKG_CHECK_MODULES(NEON, neon >= 0.24 )
+PKG_CHECK_MODULES(SSL, openssl >= 0.9.7 )
+HTTP_CFLAGS="$NEON_CFLAGS $SSL_CFLAGS"
+HTTP_LIBS="$NEON_LIBS $SSL_LIBS"
 AC_SUBST(HTTP_CFLAGS)
 AC_SUBST(HTTP_LIBS)
 PKG_CHECK_MODULES(MIME, gmime-2.0 >= 2.0 )

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-02-17 14:56:25 UTC (rev 118)
+++ trunk/pinot.spec.in	2006-02-18 07:19:26 UTC (rev 119)
@@ -11,8 +11,8 @@
 Source: %{name}-%{version}.tar.gz
 URL: http://pinot.berlios.de/
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
-Requires: xapian-core-libs >= 0.9.3, neon >= 0.24, gtkmm24 >= 2.6, libxml++ >= 2.12, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
-BuildRequires: xapian-core-devel >= 0.9.3, neon-devel >= 0.24, gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
+Requires: xapian-core-libs >= 0.9.2, neon >= 0.24, gtkmm24 >= 2.6, libxml++ >= 2.12, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
+BuildRequires: xapian-core-devel >= 0.9.2, neon-devel >= 0.24, gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
 
 %description
 Pinot is a metasearch tool for the Free Desktop. It enables one to query



From fabricecolin at berlios.de  Sat Feb 18 10:47:43 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sat, 18 Feb 2006 10:47:43 +0100
Subject: [Pinot-svn] r120 - in trunk: UI/GTK2/src po
Message-ID: <200602180947.k1I9lhI8005270@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-18 10:47:34 +0100 (Sat, 18 Feb 2006)
New Revision: 120

Modified:
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/po/es.po
   trunk/po/fr.po
Log:
Minor changes to catalogs, some correction sto fr.po.


Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-02-18 07:19:26 UTC (rev 119)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-02-18 09:47:34 UTC (rev 120)
@@ -1157,7 +1157,7 @@
 bool UpdateDocumentThread::stop(void)
 {
 	m_done = true;
-	m_status = _("Stopped document update for ");
+	m_status = _("Stopped document update for");
 	m_status += " ";
 	m_status += m_docId;
 

Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2006-02-18 07:19:26 UTC (rev 119)
+++ trunk/po/es.po	2006-02-18 09:47:34 UTC (rev 120)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.43\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-02-17 20:03+0800\n"
+"POT-Creation-Date: 2006-02-18 17:52+0800\n"
 "PO-Revision-Date: 2006-01-30 16:44+0800\n"
 "Last-Translator: Jes?s Tramullas <jesus at tramullas.com>\n"
 "Language-Team: es <jesus at tramullas.com>\n"
@@ -833,8 +833,8 @@
 msgstr "No se pudo desindizar lo(s) documento(s)"
 
 #: UI/GTK2/src/WorkerThreads.cpp:1160
-msgid "Stopped document update for "
-msgstr "Detenida la actualizaci?n del documento por "
+msgid "Stopped document update for"
+msgstr "Detenida la actualizaci?n del documento por"
 
 #: UI/GTK2/src/WorkerThreads.cpp:1195
 msgid "Couldn't update document"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2006-02-18 07:19:26 UTC (rev 119)
+++ trunk/po/fr.po	2006-02-18 09:47:34 UTC (rev 120)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.43\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-02-17 20:03+0800\n"
+"POT-Creation-Date: 2006-02-18 17:52+0800\n"
 "PO-Revision-Date: 2006-01-20 19:44+0800\n"
 "Last-Translator: Fabrice Colin <colinf at chez.com>\n"
 "Language-Team: fr <colinf at chez.com>\n"
@@ -218,11 +218,11 @@
 
 #: UI/GTK2/src/mainWindow.cc:797
 msgid "off"
-msgstr "de"
+msgstr "documents,"
 
 #: UI/GTK2/src/mainWindow.cc:802
 msgid "documents, starting at"
-msgstr "documents venant de"
+msgstr "au total, a partir de"
 
 #: UI/GTK2/src/mainWindow.cc:836
 msgid "Query"
@@ -267,7 +267,7 @@
 
 #: UI/GTK2/src/mainWindow.cc:1235
 msgid "Couldn't rename index, name"
-msgstr "N'a pas pu renommer l'index"
+msgstr "N'a pas pu renommer l'index, le nom"
 
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:2144
 #: UI/GTK2/src/mainWindow.cc:2623
@@ -330,7 +330,7 @@
 
 #: UI/GTK2/src/mainWindow.cc:2169
 msgid "Added new index"
-msgstr "Ajouter un nouvel index"
+msgstr "Ajoute un nouvel index"
 
 #: UI/GTK2/src/mainWindow.cc:2204
 msgid "Couldn't remove index"
@@ -339,7 +339,7 @@
 #: UI/GTK2/src/mainWindow.cc:2285
 #, fuzzy
 msgid "Live query"
-msgstr "Edite la recherche"
+msgstr "Recherche"
 
 #: UI/GTK2/src/mainWindow.cc:2438
 msgid "At least one task hasn't completed yet. Quit now ?"
@@ -544,12 +544,12 @@
 #: UI/GTK2/src/pinot.cc:153 UI/GTK2/src/pinot.cc:161
 #, fuzzy
 msgid "Couldn't open index"
-msgstr "N'a pas pu enlever l'index"
+msgstr "N'a pas pu ouvrir l'index"
 
 #: UI/GTK2/src/pinot.cc:171
 #, fuzzy
 msgid "Couldn't create history database"
-msgstr "N'a pas pu creer le repertoire a"
+msgstr "N'a pas pu creer la base d'historiques"
 
 #: UI/GTK2/src/PinotSettings.cpp:106
 msgid "Couldn't create pinot directory at"
@@ -601,7 +601,7 @@
 
 #: UI/GTK2/src/PinotSettings.cpp:732
 msgid "Unclassified"
-msgstr "Non classifie"
+msgstr "Sans classification"
 
 #: UI/GTK2/src/prefsDialog.cc:69
 msgid "Name"
@@ -621,7 +621,7 @@
 
 #: UI/GTK2/src/prefsDialog.cc:332
 msgid "Browser location"
-msgstr "Brouter la location"
+msgstr "Location du brouteur"
 
 #: UI/GTK2/src/prefsDialog.cc:343
 msgid "New Label"
@@ -638,7 +638,7 @@
 
 #: UI/GTK2/src/prefsDialog_glade.cc:62
 msgid "HTTP crawling:"
-msgstr "Brouteur HTTP:"
+msgstr "Broutage HTTP:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:63
 msgid "View documents:"
@@ -758,7 +758,7 @@
 
 #: UI/GTK2/src/WorkerThreads.cpp:374
 msgid "Stopped browsing"
-msgstr "Arrete le brouteur"
+msgstr "Arrete de parcourir l'index"
 
 #: UI/GTK2/src/WorkerThreads.cpp:407 UI/GTK2/src/WorkerThreads.cpp:625
 #: UI/GTK2/src/WorkerThreads.cpp:662 UI/GTK2/src/WorkerThreads.cpp:671
@@ -805,7 +805,7 @@
 
 #: UI/GTK2/src/WorkerThreads.cpp:901
 msgid "Cannot index document type"
-msgstr "Impossible d'indexer de type de documents"
+msgstr "Impossible d'indexer ce type de documents"
 
 #: UI/GTK2/src/WorkerThreads.cpp:905
 msgid "at"
@@ -833,8 +833,8 @@
 msgstr "N'a pas pu desindexer le(s) document(s)"
 
 #: UI/GTK2/src/WorkerThreads.cpp:1160
-msgid "Stopped document update for "
-msgstr "Arrete la mise a jour pour "
+msgid "Stopped document update for"
+msgstr "Arrete la mise a jour pour"
 
 #: UI/GTK2/src/WorkerThreads.cpp:1195
 msgid "Couldn't update document"



From fabricecolin at berlios.de  Mon Feb 20 15:38:29 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Mon, 20 Feb 2006 15:38:29 +0100
Subject: [Pinot-svn] r121 - in trunk/UI/GTK2: . src
Message-ID: <200602201438.k1KEcTYb018336@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-20 15:38:28 +0100 (Mon, 20 Feb 2006)
New Revision: 121

Modified:
   trunk/UI/GTK2/metase-gtk2.glade
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/mainWindow.hh
   trunk/UI/GTK2/src/mainWindow_glade.cc
   trunk/UI/GTK2/src/mainWindow_glade.hh
Log:
Pressing return in the live query field runs the search.


Modified: trunk/UI/GTK2/metase-gtk2.glade
===================================================================
--- trunk/UI/GTK2/metase-gtk2.glade	2006-02-18 09:47:34 UTC (rev 120)
+++ trunk/UI/GTK2/metase-gtk2.glade	2006-02-20 14:38:28 UTC (rev 121)
@@ -562,6 +562,7 @@
 		      <property name="invisible_char">*</property>
 		      <property name="activates_default">False</property>
 		      <signal name="changed" handler="on_liveQueryEntry_changed" last_modification_time="Sun, 01 Jan 2006 00:46:09 GMT"/>
+		      <signal name="activate" handler="on_liveQueryEntry_activate" last_modification_time="Mon, 20 Feb 2006 12:36:22 GMT"/>
 		    </widget>
 		    <packing>
 		      <property name="padding">4</property>

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-02-18 09:47:34 UTC (rev 120)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-02-20 14:38:28 UTC (rev 121)
@@ -2276,6 +2276,14 @@
 }
 
 //
+// Return key pressed in live query entry field
+//
+void mainWindow::on_liveQueryEntry_activate()
+{
+	on_findButton_clicked();
+}
+
+//
 // Find button click
 //
 void mainWindow::on_findButton_clicked()

Modified: trunk/UI/GTK2/src/mainWindow.hh
===================================================================
--- trunk/UI/GTK2/src/mainWindow.hh	2006-02-18 09:47:34 UTC (rev 120)
+++ trunk/UI/GTK2/src/mainWindow.hh	2006-02-20 14:38:28 UTC (rev 121)
@@ -103,6 +103,7 @@
 	virtual void on_removeIndexButton_clicked();
 
 	virtual void on_liveQueryEntry_changed();
+	virtual void on_liveQueryEntry_activate();
 	virtual void on_findButton_clicked();
 	virtual void on_addQueryButton_clicked();
 	virtual void on_editQueryButton_clicked();

Modified: trunk/UI/GTK2/src/mainWindow_glade.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow_glade.cc	2006-02-18 09:47:34 UTC (rev 120)
+++ trunk/UI/GTK2/src/mainWindow_glade.cc	2006-02-20 14:38:28 UTC (rev 121)
@@ -1,4 +1,4 @@
-// generated 2006/1/2 11:20:25 SGT by fabrice at thorgrim.dyndns.org.(none)
+// generated 2006/2/20 22:15:34 SGT by fabrice at amra.dyndns.org.(none)
 // using glademm V2.6.0
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -71,7 +71,7 @@
    delete1 = NULL;
    Gtk::Menu *editMenuitem_menu = Gtk::manage(new class Gtk::Menu());
    editMenuitem = NULL;
-   Gtk::Image *image546 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-clear"), Gtk::IconSize(1)));
+   Gtk::Image *image569 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-clear"), Gtk::IconSize(1)));
    clearresults1 = NULL;
    showextract1 = NULL;
    searchenginegroup1 = NULL;
@@ -86,15 +86,15 @@
    Gtk::Menu *resultsMenuitem_menu = Gtk::manage(new class Gtk::Menu());
    resultsMenuitem = NULL;
    list1 = NULL;
-   Gtk::Image *image547 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-open"), Gtk::IconSize(1)));
+   Gtk::Image *image570 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-open"), Gtk::IconSize(1)));
    import1 = NULL;
    Gtk::MenuItem *separator3 = NULL;
    viewfromindex1 = NULL;
-   Gtk::Image *image548 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-refresh"), Gtk::IconSize(1)));
+   Gtk::Image *image571 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-refresh"), Gtk::IconSize(1)));
    refreshindex1 = NULL;
-   Gtk::Image *image549 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-delete"), Gtk::IconSize(1)));
+   Gtk::Image *image572 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-delete"), Gtk::IconSize(1)));
    unindex1 = NULL;
-   Gtk::Image *image550 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-properties"), Gtk::IconSize(1)));
+   Gtk::Image *image573 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-properties"), Gtk::IconSize(1)));
    showfromindex1 = NULL;
    Gtk::Menu *indexMenuitem_menu = Gtk::manage(new class Gtk::Menu());
    indexMenuitem = NULL;
@@ -174,7 +174,7 @@
    groupresults1_menu->items().push_back(Gtk::Menu_Helpers::RadioMenuElem(_RadioMIGroup_searchenginegroup1, _("Host Name")));
    hostnamegroup1 = (Gtk::RadioMenuItem *)&groupresults1_menu->items().back();
    
-   resultsMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Clear List"), *image546));
+   resultsMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Clear List"), *image569));
    clearresults1 = (Gtk::ImageMenuItem *)&resultsMenuitem_menu->items().back();
    
    resultsMenuitem_menu->items().push_back(Gtk::Menu_Helpers::CheckMenuElem(_("Show Extract")));
@@ -198,7 +198,7 @@
    indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::MenuElem(_("List Contents Of")));
    list1 = (Gtk::MenuItem *)&indexMenuitem_menu->items().back();
    
-   indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Import"), *image547));
+   indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Import"), *image570));
    import1 = (Gtk::ImageMenuItem *)&indexMenuitem_menu->items().back();
    
    indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::SeparatorElem());
@@ -207,13 +207,13 @@
    indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::MenuElem(_("View")));
    viewfromindex1 = (Gtk::MenuItem *)&indexMenuitem_menu->items().back();
    
-   indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Update"), *image548));
+   indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Update"), *image571));
    refreshindex1 = (Gtk::ImageMenuItem *)&indexMenuitem_menu->items().back();
    
-   indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Unindex"), *image549));
+   indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Unindex"), *image572));
    unindex1 = (Gtk::ImageMenuItem *)&indexMenuitem_menu->items().back();
    
-   indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Properties"), *image550));
+   indexMenuitem_menu->items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_("Properties"), *image573));
    showfromindex1 = (Gtk::ImageMenuItem *)&indexMenuitem_menu->items().back();
    
    helpMenuitem_menu->items().push_back(Gtk::Menu_Helpers::MenuElem(_("_About")));
@@ -233,19 +233,19 @@
    
    mainMenubar->items().push_back(Gtk::Menu_Helpers::MenuElem(_("_Help"), *helpMenuitem_menu));
    helpMenuitem = (Gtk::MenuItem *)&mainMenubar->items().back();
-   image546->set_alignment(0.5,0.5);
-   image546->set_padding(0,0);
+   image569->set_alignment(0.5,0.5);
+   image569->set_padding(0,0);
    showextract1->set_active(true);
    searchenginegroup1->set_active(true);
    hostnamegroup1->set_active(false);
-   image547->set_alignment(0.5,0.5);
-   image547->set_padding(0,0);
-   image548->set_alignment(0.5,0.5);
-   image548->set_padding(0,0);
-   image549->set_alignment(0.5,0.5);
-   image549->set_padding(0,0);
-   image550->set_alignment(0.5,0.5);
-   image550->set_padding(0,0);
+   image570->set_alignment(0.5,0.5);
+   image570->set_padding(0,0);
+   image571->set_alignment(0.5,0.5);
+   image571->set_padding(0,0);
+   image572->set_alignment(0.5,0.5);
+   image572->set_padding(0,0);
+   image573->set_alignment(0.5,0.5);
+   image573->set_padding(0,0);
    image439->set_alignment(0.5,0.5);
    image439->set_padding(0,0);
    addIndexButton->set_flags(Gtk::CAN_FOCUS);
@@ -369,7 +369,7 @@
    paste1->show();
    delete1->show();
    editMenuitem->show();
-   image546->show();
+   image569->show();
    clearresults1->show();
    showextract1->show();
    searchenginegroup1->show();
@@ -381,15 +381,15 @@
    indexresults1->show();
    resultsMenuitem->show();
    list1->show();
-   image547->show();
+   image570->show();
    import1->show();
    separator3->show();
    viewfromindex1->show();
-   image548->show();
+   image571->show();
    refreshindex1->show();
-   image549->show();
+   image572->show();
    unindex1->show();
-   image550->show();
+   image573->show();
    showfromindex1->show();
    indexMenuitem->show();
    about1->show();
@@ -448,6 +448,7 @@
    addIndexButton->signal_clicked().connect(SigC::slot(*this, &mainWindow_glade::on_addIndexButton_clicked), false);
    removeIndexButton->signal_clicked().connect(SigC::slot(*this, &mainWindow_glade::on_removeIndexButton_clicked), false);
    liveQueryEntry->signal_changed().connect(SigC::slot(*this, &mainWindow_glade::on_liveQueryEntry_changed), false);
+   liveQueryEntry->signal_activate().connect(SigC::slot(*this, &mainWindow_glade::on_liveQueryEntry_activate), false);
    findButton->signal_clicked().connect(SigC::slot(*this, &mainWindow_glade::on_findButton_clicked), false);
    queryTreeview->signal_button_press_event().connect(SigC::slot(*this, &mainWindow_glade::on_queryTreeview_button_press_event), false);
    addQueryButton->signal_clicked().connect(SigC::slot(*this, &mainWindow_glade::on_addQueryButton_clicked), false);

Modified: trunk/UI/GTK2/src/mainWindow_glade.hh
===================================================================
--- trunk/UI/GTK2/src/mainWindow_glade.hh	2006-02-18 09:47:34 UTC (rev 120)
+++ trunk/UI/GTK2/src/mainWindow_glade.hh	2006-02-20 14:38:28 UTC (rev 121)
@@ -1,4 +1,4 @@
-// generated 2006/1/1 8:46:21 SGT by fabrice at thorgrim.dyndns.org.(none)
+// generated 2006/2/20 22:15:34 SGT by fabrice at amra.dyndns.org.(none)
 // using glademm V2.6.0
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -128,6 +128,7 @@
         virtual void on_addIndexButton_clicked() = 0;
         virtual void on_removeIndexButton_clicked() = 0;
         virtual void on_liveQueryEntry_changed() = 0;
+        virtual void on_liveQueryEntry_activate() = 0;
         virtual void on_findButton_clicked() = 0;
         virtual bool on_queryTreeview_button_press_event(GdkEventButton *ev) = 0;
         virtual void on_addQueryButton_clicked() = 0;



From fabricecolin at berlios.de  Mon Feb 20 15:59:04 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Mon, 20 Feb 2006 15:59:04 +0100
Subject: [Pinot-svn] r122 - trunk/UI/GTK2/src
Message-ID: <200602201459.k1KEx4bB021629@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-20 15:59:03 +0100 (Mon, 20 Feb 2006)
New Revision: 122

Modified:
   trunk/UI/GTK2/src/Makefile.am
Log:
Fixed order of libraries.


Modified: trunk/UI/GTK2/src/Makefile.am
===================================================================
--- trunk/UI/GTK2/src/Makefile.am	2006-02-20 14:38:28 UTC (rev 121)
+++ trunk/UI/GTK2/src/Makefile.am	2006-02-20 14:59:03 UTC (rev 122)
@@ -59,6 +59,6 @@
 
 pinot_LDADD = -L../../../Utils -L../../../Tokenize -L../../../SQL \
         -L../../../Collect -L../../../Search -L../../../Index -L../../RenderHTML \
-	@LIBS@ @UI_LIBS@ @INDEX_LIBS@ @XML_LIBS@ @MIME_LIBS@ @HTTP_LIBS@ @SQL_LIBS@ @MISC_LIBS@ \
-	-lHTML -lIndex -lSearch -lCollect -lSQL -lTokenize -lUtils
+	-lHTML -lIndex -lSearch -lCollect -lSQL -lTokenize -lUtils \
+	@LIBS@ @UI_LIBS@ @INDEX_LIBS@ @XML_LIBS@ @MIME_LIBS@ @HTTP_LIBS@ @SQL_LIBS@ @MISC_LIBS@
 



From fabricecolin at berlios.de  Tue Feb 21 12:55:15 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Tue, 21 Feb 2006 12:55:15 +0100
Subject: [Pinot-svn] r123 - trunk/Search/Plugins
Message-ID: <200602211155.k1LBtEAE006364@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-21 12:55:12 +0100 (Tue, 21 Feb 2006)
New Revision: 123

Modified:
   trunk/Search/Plugins/Topix.src
Log:
Topix changed.


Modified: trunk/Search/Plugins/Topix.src
===================================================================
--- trunk/Search/Plugins/Topix.src	2006-02-20 14:59:03 UTC (rev 122)
+++ trunk/Search/Plugins/Topix.src	2006-02-21 11:55:12 UTC (rev 123)
@@ -5,14 +5,13 @@
 	name="Topix"
 	description="Topix.net"
 	method="GET"
-	action="http://www.topix.net/search/advanced"
+	action="http://www.topix.net/search/"
 	routeType="News"
 >
 
 <INPUT NAME="q" USER>
-<INPUT NAME="n" VALUE="search">
 <INPUT NAME="list" VALUE="1">
-<INPUTNEXT NAME="start" FACTOR="1" VALUE="0">
+<INPUTNEXT NAME="start" FACTOR="1" VALUE="1">
 
 <INTERPRET
 resultListStart=""



From fabricecolin at berlios.de  Tue Feb 21 15:12:54 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Tue, 21 Feb 2006 15:12:54 +0100
Subject: [Pinot-svn] r124 - trunk/UI/GTK2/src
Message-ID: <200602211412.k1LECsqw004056@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-21 15:12:50 +0100 (Tue, 21 Feb 2006)
New Revision: 124

Modified:
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/WorkerThreads.h
Log:
Protected downloading with a mutex until I figure out why multiple searches
cause a crash.


Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-02-21 11:55:12 UTC (rev 123)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-02-21 14:12:50 UTC (rev 124)
@@ -688,6 +688,8 @@
 	}
 }
 
+pthread_mutex_t DownloadingThread::m_dlLock = PTHREAD_MUTEX_INITIALIZER;
+
 DownloadingThread::DownloadingThread(const string url, bool fromCache) :
 	WorkerThread()
 {
@@ -761,6 +763,8 @@
 	}
 	else
 	{
+		pthread_mutex_lock(&m_dlLock);
+
 		// Get a Downloader, the default one will do
 		m_downloader = DownloaderFactory::getDownloader(thisUrl.getProtocol(), "");
 		if (m_downloader == NULL)
@@ -775,6 +779,8 @@
 
 			m_pDoc = m_downloader->retrieveUrl(docInfo);
 		}
+
+		pthread_mutex_unlock(&m_dlLock);
 	}
 
 	if (m_pDoc == NULL)

Modified: trunk/UI/GTK2/src/WorkerThreads.h
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.h	2006-02-21 11:55:12 UTC (rev 123)
+++ trunk/UI/GTK2/src/WorkerThreads.h	2006-02-21 14:12:50 UTC (rev 124)
@@ -255,6 +255,7 @@
 		virtual bool stop(void);
 
 	protected:
+		static pthread_mutex_t m_dlLock;
 		std::string m_url;
 		bool m_fromCache;
 		Document *m_pDoc;



From fabricecolin at berlios.de  Wed Feb 22 15:32:12 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Wed, 22 Feb 2006 15:32:12 +0100
Subject: [Pinot-svn] r125 - in trunk: Collect UI/GTK2/src
Message-ID: <200602221432.k1MEWC4b021218@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-22 15:32:06 +0100 (Wed, 22 Feb 2006)
New Revision: 125

Modified:
   trunk/Collect/NeonDownloader.cpp
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/WorkerThreads.h
Log:
Lock Neon session and request creation instead.


Modified: trunk/Collect/NeonDownloader.cpp
===================================================================
--- trunk/Collect/NeonDownloader.cpp	2006-02-21 14:12:50 UTC (rev 124)
+++ trunk/Collect/NeonDownloader.cpp	2006-02-22 14:32:06 UTC (rev 125)
@@ -64,6 +64,7 @@
 	}
 }
 
+static pthread_mutex_t accessLock = PTHREAD_MUTEX_INITIALIZER;
 #ifdef NE_SSL_H
 // OpenSSL multi-thread support, required by Neon
 static pthread_mutex_t locksTable[CRYPTO_NUM_LOCKS];
@@ -240,6 +241,11 @@
 	string file = urlObj.getFile();
 	string parameters = urlObj.getParameters();
 
+	if (pthread_mutex_lock(&accessLock) != 0)
+	{
+		return NULL;
+	}
+
 	// Create a session
 	m_pSession = ne_session_create(protocol.c_str(), hostName.c_str(), 80); // urlObj.getPort());
 	if (m_pSession == NULL)
@@ -247,6 +253,7 @@
 #ifdef DEBUG
 		cerr << "NeonDownloader::retrieveUrl: couldn't create session !" << endl;
 #endif
+		pthread_mutex_unlock(&accessLock);
 		return NULL;
 	}
 	// Set the user agent
@@ -275,6 +282,7 @@
 
 	// Create a request for this URL
 	m_pRequest = ne_request_create(m_pSession, "GET", fullLocation.c_str());
+	pthread_mutex_unlock(&accessLock);
 	if (m_pRequest == NULL)
 	{
 #ifdef DEBUG

Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-02-21 14:12:50 UTC (rev 124)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-02-22 14:32:06 UTC (rev 125)
@@ -688,8 +688,6 @@
 	}
 }
 
-pthread_mutex_t DownloadingThread::m_dlLock = PTHREAD_MUTEX_INITIALIZER;
-
 DownloadingThread::DownloadingThread(const string url, bool fromCache) :
 	WorkerThread()
 {
@@ -763,8 +761,6 @@
 	}
 	else
 	{
-		pthread_mutex_lock(&m_dlLock);
-
 		// Get a Downloader, the default one will do
 		m_downloader = DownloaderFactory::getDownloader(thisUrl.getProtocol(), "");
 		if (m_downloader == NULL)
@@ -779,8 +775,6 @@
 
 			m_pDoc = m_downloader->retrieveUrl(docInfo);
 		}
-
-		pthread_mutex_unlock(&m_dlLock);
 	}
 
 	if (m_pDoc == NULL)

Modified: trunk/UI/GTK2/src/WorkerThreads.h
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.h	2006-02-21 14:12:50 UTC (rev 124)
+++ trunk/UI/GTK2/src/WorkerThreads.h	2006-02-22 14:32:06 UTC (rev 125)
@@ -255,7 +255,6 @@
 		virtual bool stop(void);
 
 	protected:
-		static pthread_mutex_t m_dlLock;
 		std::string m_url;
 		bool m_fromCache;
 		Document *m_pDoc;



From fabricecolin at berlios.de  Thu Feb 23 14:20:38 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Thu, 23 Feb 2006 14:20:38 +0100
Subject: [Pinot-svn] r126 - trunk
Message-ID: <200602231320.k1NDKckc003593@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-23 14:20:22 +0100 (Thu, 23 Feb 2006)
New Revision: 126

Modified:
   trunk/ChangeLog
   trunk/TODO
   trunk/pinot.spec.in
Log:
Updated ChangeLog and TODO based on changes made since last release.
In Xapian v0.9.4, libxapian.so is version 10. Since I will use this version
to build RPMs, I have set the dependencies accordingly.


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2006-02-22 14:32:06 UTC (rev 125)
+++ trunk/ChangeLog	2006-02-23 13:20:22 UTC (rev 126)
@@ -1,16 +1,19 @@
-??? version_0_4_5
+??? version_0_4_3
 Build :
  - dropped patch for libxml++ v0.26 support
+ - use autotools
 Search :
  - include pinot_search to query search engines from the command-line
  - better parsing of Sherlock plugins with foreign tags
+ - URLs of results returned by Sherlock engines were incorrectly lower-cased
 Index :
- - URLs of results returned by Sherlock engines were incorrectly lower-cased
  - Changed term prefixes to conform to conventions used by Omega and other
   Xapian-based tools. Unfortunately, users will have to update documents and
   reapply labels !
 UI :
- - UTF-8 fixes on stored queries dates, results extracts and locale catalogs
+ - UTF-8 fixes on stored queries dates, results extracts and locale catalogs;
+   the Spanish and French catalogs are usable now !
+ - Better error handling in worker threads and at startup
 
 2006/01/31 version_0_4_2
 Search :

Modified: trunk/TODO
===================================================================
--- trunk/TODO	2006-02-22 14:32:06 UTC (rev 125)
+++ trunk/TODO	2006-02-23 13:20:22 UTC (rev 126)
@@ -1,9 +1,7 @@
 General
-- Fix dependencies in build system, use autoconf and friends
 - Fix the FIXMEs
 - Get rid of dead code/classes/methods...
 - Advertise service via Rendezvous with Howl (http://www.porchdogsoft.com/products/howl/)
-- Remove hardcoded paths
 - Man page, see help2man (http://www.gnu.org/software/help2man/)
 - Logging should not be all (DEBUG) or nothing (release)
 - Check for leaks with valgrind (eg --tool=memcheck -v --leak-check=yes --show-reachable=yes ...)
@@ -23,6 +21,7 @@
 - Add http://www.patentcommons.org/commons/patentsearch.php
 - Add http://www.podzinger.com/
 - Implement AutoDiscovery of OpenSearch Description files (http://opensearch.a9.com/spec/1.1/description/)
+- Support for Google Buttons
 
 Collect
 - Comply with robot stuff defined at http://www.robotstxt.org/
@@ -48,6 +47,7 @@
 - Flush the index before searching not after modification
 - Hash document data to determine on updates whether documents have changed
 - Allow to monitor imported documents for changes
+- Allow to skip pages whose domain match the search engine's
 
 Browser plugin
 - Write Firefox extension that searches Pinot indexes and indexes the cache

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2006-02-22 14:32:06 UTC (rev 125)
+++ trunk/pinot.spec.in	2006-02-23 13:20:22 UTC (rev 126)
@@ -11,8 +11,8 @@
 Source: %{name}-%{version}.tar.gz
 URL: http://pinot.berlios.de/
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
-Requires: xapian-core-libs >= 0.9.2, neon >= 0.24, gtkmm24 >= 2.6, libxml++ >= 2.12, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
-BuildRequires: xapian-core-devel >= 0.9.2, neon-devel >= 0.24, gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
+Requires: xapian-core-libs >= 0.9.4, neon >= 0.24, gtkmm24 >= 2.6, libxml++ >= 2.12, mozilla >= %{mozilla_ver}, sqlite >= 3.1.2, ots >= 0.4.2, libtextcat >= 2.2, fam >= 2.6.10, gmime >= 2.1, file
+BuildRequires: xapian-core-devel >= 0.9.4, neon-devel >= 0.24, gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, mozilla-devel >= %{mozilla_ver}, sqlite-devel >= 3.1.2, ots-devel >= 0.4.2, libtextcat-devel >= 2.2, fam-devel >= 2.6.10, gmime-devel >= 2.1, file, boost-devel >= 1.32, desktop-file-utils
 
 %description
 Pinot is a metasearch tool for the Free Desktop. It enables one to query



From fabricecolin at berlios.de  Fri Feb 24 15:44:25 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Fri, 24 Feb 2006 15:44:25 +0100
Subject: [Pinot-svn] r127 - trunk/Tokenize
Message-ID: <200602241444.k1OEiPrq002061@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-24 15:44:19 +0100 (Fri, 24 Feb 2006)
New Revision: 127

Modified:
   trunk/Tokenize/WordTokenizer.cpp
Log:
Fixed buffer overrun.


Modified: trunk/Tokenize/WordTokenizer.cpp
===================================================================
--- trunk/Tokenize/WordTokenizer.cpp	2006-02-23 13:20:22 UTC (rev 126)
+++ trunk/Tokenize/WordTokenizer.cpp	2006-02-24 14:44:19 UTC (rev 127)
@@ -27,7 +27,7 @@
 {
 	if (typeNum == 0)
 	{
-		char *pType = new char[16];
+		char *pType = new char[19];
 		strncpy(pType, "application/msword", 18);
 		pType[18] = '\0';
 		return pType;



From fabricecolin at berlios.de  Fri Feb 24 15:51:07 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Fri, 24 Feb 2006 15:51:07 +0100
Subject: [Pinot-svn] r128 - in trunk: Collect Search
Message-ID: <200602241451.k1OEp7ST021290@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-24 15:51:06 +0100 (Fri, 24 Feb 2006)
New Revision: 128

Modified:
   trunk/Collect/NeonDownloader.cpp
   trunk/Search/PluginWebEngine.h
Log:
Cosmetic changes.


Modified: trunk/Collect/NeonDownloader.cpp
===================================================================
--- trunk/Collect/NeonDownloader.cpp	2006-02-24 14:44:19 UTC (rev 127)
+++ trunk/Collect/NeonDownloader.cpp	2006-02-24 14:51:06 UTC (rev 128)
@@ -96,7 +96,7 @@
 	}
 }
 
-unsigned long idCallback(void)
+static unsigned long idCallback(void)
 {
 	return (unsigned long)pthread_self();
 }

Modified: trunk/Search/PluginWebEngine.h
===================================================================
--- trunk/Search/PluginWebEngine.h	2006-02-24 14:44:19 UTC (rev 127)
+++ trunk/Search/PluginWebEngine.h	2006-02-24 14:51:06 UTC (rev 128)
@@ -23,11 +23,7 @@
 #include "SearchPluginProperties.h"
 #include "WebEngine.h"
 
-/**
-  * A class that implements the Sherlock search plugin standard.
-  * See http://developer.apple.com/technotes/tn/tn1141.html
-  * and http://mycroft.mozdev.org/deepdocs/deepdocs.html
-  */
+/// A plugin-based search engine.
 class PluginWebEngine : public WebEngine
 {
 	public:



From fabricecolin at berlios.de  Fri Feb 24 16:06:47 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Fri, 24 Feb 2006 16:06:47 +0100
Subject: [Pinot-svn] r129 - trunk/po
Message-ID: <200602241506.k1OF6lVb027787@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-24 16:06:46 +0100 (Fri, 24 Feb 2006)
New Revision: 129

Modified:
   trunk/po/es.po
   trunk/po/fr.po
Log:
Caught up with recent changes.


Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2006-02-24 14:51:06 UTC (rev 128)
+++ trunk/po/es.po	2006-02-24 15:06:46 UTC (rev 129)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.43\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-02-18 17:52+0800\n"
+"POT-Creation-Date: 2006-02-23 21:47+0800\n"
 "PO-Revision-Date: 2006-01-30 16:44+0800\n"
 "Last-Translator: Jes?s Tramullas <jesus at tramullas.com>\n"
 "Language-Team: es <jesus at tramullas.com>\n"
@@ -184,7 +184,7 @@
 #. Stop in case we were loading a page
 #. Close the existing view page
 #: UI/GTK2/src/mainWindow.cc:248 UI/GTK2/src/mainWindow.cc:1011
-#: UI/GTK2/src/mainWindow.cc:1383 UI/GTK2/src/mainWindow.cc:2960
+#: UI/GTK2/src/mainWindow.cc:1383 UI/GTK2/src/mainWindow.cc:2968
 #: UI/GTK2/src/mainWindow_glade.cc:207
 msgid "View"
 msgstr "Ver"
@@ -228,7 +228,7 @@
 msgid "Query"
 msgstr "B?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:840 UI/GTK2/src/mainWindow.cc:2789
+#: UI/GTK2/src/mainWindow.cc:840 UI/GTK2/src/mainWindow.cc:2797
 msgid "on"
 msgstr "en"
 
@@ -270,7 +270,7 @@
 msgstr "No se podu renombrar el ?ndice, nombre"
 
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:2144
-#: UI/GTK2/src/mainWindow.cc:2623
+#: UI/GTK2/src/mainWindow.cc:2631
 msgid "is already in use"
 msgstr "ya est? en uso"
 
@@ -336,68 +336,68 @@
 msgid "Couldn't remove index"
 msgstr "No se pudo borrar el ?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2285
+#: UI/GTK2/src/mainWindow.cc:2293
 #, fuzzy
 msgid "Live query"
 msgstr "B?squeda editada"
 
-#: UI/GTK2/src/mainWindow.cc:2438
+#: UI/GTK2/src/mainWindow.cc:2446
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Al menos una tarea no ha finalizado. ?Parar ahora?"
 
-#: UI/GTK2/src/mainWindow.cc:2619
+#: UI/GTK2/src/mainWindow.cc:2627
 msgid "Query name"
 msgstr "Nombre la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2646
+#: UI/GTK2/src/mainWindow.cc:2654
 msgid "Couldn't update query"
 msgstr "No se pudo actualizar la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2654
+#: UI/GTK2/src/mainWindow.cc:2662
 msgid "Edited query"
 msgstr "B?squeda editada"
 
-#: UI/GTK2/src/mainWindow.cc:2661
+#: UI/GTK2/src/mainWindow.cc:2669
 msgid "Couldn't add query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2669
+#: UI/GTK2/src/mainWindow.cc:2677
 msgid "Added new query"
 msgstr "A?adida una nueva b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2683
+#: UI/GTK2/src/mainWindow.cc:2691
 msgid "Query is not set"
 msgstr "B?squeda no definida"
 
-#: UI/GTK2/src/mainWindow.cc:2694
+#: UI/GTK2/src/mainWindow.cc:2702
 msgid "No search engine selected"
 msgstr "Motor de b?squeda no seleccionado"
 
-#: UI/GTK2/src/mainWindow.cc:2776
+#: UI/GTK2/src/mainWindow.cc:2784
 msgid "Please set the Google API key first"
 msgstr "Por favor, primero configure el API de Google"
 
-#: UI/GTK2/src/mainWindow.cc:2785
+#: UI/GTK2/src/mainWindow.cc:2793
 msgid "Running query"
 msgstr "Ejecutando la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2891
+#: UI/GTK2/src/mainWindow.cc:2899
 msgid "is already indexed or is being indexed"
 msgstr "ya ha sido indizado, o se est? indizando"
 
-#: UI/GTK2/src/mainWindow.cc:2918
+#: UI/GTK2/src/mainWindow.cc:2926
 msgid "No URL to browse"
 msgstr "No hay URL que mostrar"
 
-#: UI/GTK2/src/mainWindow.cc:2929
+#: UI/GTK2/src/mainWindow.cc:2937
 msgid "No browser configured to view results"
 msgstr "NO ha configurado un navegador para ver los resultados"
 
-#: UI/GTK2/src/mainWindow.cc:2941
+#: UI/GTK2/src/mainWindow.cc:2949
 msgid "Couldn't browse URL:"
 msgstr "No se pudo mostrar el URL:"
 
-#: UI/GTK2/src/mainWindow.cc:3000
+#: UI/GTK2/src/mainWindow.cc:3008
 #, fuzzy
 msgid "Viewing"
 msgstr "Ver"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2006-02-24 14:51:06 UTC (rev 128)
+++ trunk/po/fr.po	2006-02-24 15:06:46 UTC (rev 129)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.43\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-02-18 17:52+0800\n"
+"POT-Creation-Date: 2006-02-23 21:47+0800\n"
 "PO-Revision-Date: 2006-01-20 19:44+0800\n"
 "Last-Translator: Fabrice Colin <colinf at chez.com>\n"
 "Language-Team: fr <colinf at chez.com>\n"
@@ -184,7 +184,7 @@
 #. Stop in case we were loading a page
 #. Close the existing view page
 #: UI/GTK2/src/mainWindow.cc:248 UI/GTK2/src/mainWindow.cc:1011
-#: UI/GTK2/src/mainWindow.cc:1383 UI/GTK2/src/mainWindow.cc:2960
+#: UI/GTK2/src/mainWindow.cc:1383 UI/GTK2/src/mainWindow.cc:2968
 #: UI/GTK2/src/mainWindow_glade.cc:207
 msgid "View"
 msgstr "Voir"
@@ -228,7 +228,7 @@
 msgid "Query"
 msgstr "La recherche"
 
-#: UI/GTK2/src/mainWindow.cc:840 UI/GTK2/src/mainWindow.cc:2789
+#: UI/GTK2/src/mainWindow.cc:840 UI/GTK2/src/mainWindow.cc:2797
 msgid "on"
 msgstr "sur"
 
@@ -270,7 +270,7 @@
 msgstr "N'a pas pu renommer l'index, le nom"
 
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:2144
-#: UI/GTK2/src/mainWindow.cc:2623
+#: UI/GTK2/src/mainWindow.cc:2631
 msgid "is already in use"
 msgstr "est deja utilise"
 
@@ -336,68 +336,68 @@
 msgid "Couldn't remove index"
 msgstr "N'a pas pu enlever l'index"
 
-#: UI/GTK2/src/mainWindow.cc:2285
+#: UI/GTK2/src/mainWindow.cc:2293
 #, fuzzy
 msgid "Live query"
 msgstr "Recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2438
+#: UI/GTK2/src/mainWindow.cc:2446
 msgid "At least one task hasn't completed yet. Quit now ?"
 msgstr "Au moins une tache n'est pas terminee. Quitter maintenant ?"
 
-#: UI/GTK2/src/mainWindow.cc:2619
+#: UI/GTK2/src/mainWindow.cc:2627
 msgid "Query name"
 msgstr "Nom de la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2646
+#: UI/GTK2/src/mainWindow.cc:2654
 msgid "Couldn't update query"
 msgstr "N'a pas pu mettre a jour la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2654
+#: UI/GTK2/src/mainWindow.cc:2662
 msgid "Edited query"
 msgstr "Edite la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2661
+#: UI/GTK2/src/mainWindow.cc:2669
 msgid "Couldn't add query"
 msgstr "N'a pas pu ajouter la recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2669
+#: UI/GTK2/src/mainWindow.cc:2677
 msgid "Added new query"
 msgstr "Ajoute une nouvelle recherche"
 
-#: UI/GTK2/src/mainWindow.cc:2683
+#: UI/GTK2/src/mainWindow.cc:2691
 msgid "Query is not set"
 msgstr "Recherche indefinie"
 
-#: UI/GTK2/src/mainWindow.cc:2694
+#: UI/GTK2/src/mainWindow.cc:2702
 msgid "No search engine selected"
 msgstr "Pas de moteur selectionne"
 
-#: UI/GTK2/src/mainWindow.cc:2776
+#: UI/GTK2/src/mainWindow.cc:2784
 msgid "Please set the Google API key first"
 msgstr "Configurez la clef de l'API Google "
 
-#: UI/GTK2/src/mainWindow.cc:2785
+#: UI/GTK2/src/mainWindow.cc:2793
 msgid "Running query"
 msgstr "Recherche en cours"
 
-#: UI/GTK2/src/mainWindow.cc:2891
+#: UI/GTK2/src/mainWindow.cc:2899
 msgid "is already indexed or is being indexed"
 msgstr "est deja indexe ou est en cours d'indexation"
 
-#: UI/GTK2/src/mainWindow.cc:2918
+#: UI/GTK2/src/mainWindow.cc:2926
 msgid "No URL to browse"
 msgstr "Pas d'URL a brouter"
 
-#: UI/GTK2/src/mainWindow.cc:2929
+#: UI/GTK2/src/mainWindow.cc:2937
 msgid "No browser configured to view results"
 msgstr "Pas de brouter configure"
 
-#: UI/GTK2/src/mainWindow.cc:2941
+#: UI/GTK2/src/mainWindow.cc:2949
 msgid "Couldn't browse URL:"
 msgstr "N'a pas pu brouter l'URL"
 
-#: UI/GTK2/src/mainWindow.cc:3000
+#: UI/GTK2/src/mainWindow.cc:3008
 #, fuzzy
 msgid "Viewing"
 msgstr "Voir"



From fabricecolin at berlios.de  Sat Feb 25 03:13:04 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sat, 25 Feb 2006 03:13:04 +0100
Subject: [Pinot-svn] r130 - trunk/Search/Plugins
Message-ID: <200602250213.k1P2D4WI028602@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-25 03:12:55 +0100 (Sat, 25 Feb 2006)
New Revision: 130

Modified:
   trunk/Search/Plugins/Acoona.src
Log:
Fixed results parsing.


Modified: trunk/Search/Plugins/Acoona.src
===================================================================
--- trunk/Search/Plugins/Acoona.src	2006-02-24 15:06:46 UTC (rev 129)
+++ trunk/Search/Plugins/Acoona.src	2006-02-25 02:12:55 UTC (rev 130)
@@ -18,7 +18,7 @@
 resultListStart=""
 resultListEnd=""
 resultItemStart='<td class="webtitle" valign="top">'
-resultItemEnd='</span> </td></tr>'
+resultItemEnd='</span></td></tr>'
 >
 
 </SEARCH>



From fabricecolin at berlios.de  Sat Feb 25 06:55:50 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sat, 25 Feb 2006 06:55:50 +0100
Subject: [Pinot-svn] r131 - trunk
Message-ID: <200602250555.k1P5toa7024142@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-25 06:55:38 +0100 (Sat, 25 Feb 2006)
New Revision: 131

Modified:
   trunk/ChangeLog
Log:
Releasing v0.43 today.


Modified: trunk/ChangeLog
===================================================================
--- trunk/ChangeLog	2006-02-25 02:12:55 UTC (rev 130)
+++ trunk/ChangeLog	2006-02-25 05:55:38 UTC (rev 131)
@@ -1,4 +1,4 @@
-??? version_0_4_3
+2006/02/25 version_0_4_3
 Build :
  - dropped patch for libxml++ v0.26 support
  - use autotools
@@ -6,6 +6,7 @@
  - include pinot_search to query search engines from the command-line
  - better parsing of Sherlock plugins with foreign tags
  - URLs of results returned by Sherlock engines were incorrectly lower-cased
+ - fix for Topix and Acoona
 Index :
  - Changed term prefixes to conform to conventions used by Omega and other
   Xapian-based tools. Unfortunately, users will have to update documents and



From fabricecolin at berlios.de  Sat Feb 25 06:59:10 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Sat, 25 Feb 2006 06:59:10 +0100
Subject: [Pinot-svn] r132 - tags
Message-ID: <200602250559.k1P5xAJh025508@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-25 06:59:08 +0100 (Sat, 25 Feb 2006)
New Revision: 132

Added:
   tags/version_0_4_3/
Log:
Releasing v0.43 today...


Copied: tags/version_0_4_3 (from rev 131, trunk)



From fabricecolin at berlios.de  Mon Feb 27 16:30:24 2006
From: fabricecolin at berlios.de (fabricecolin at BerliOS)
Date: Mon, 27 Feb 2006 16:30:24 +0100
Subject: [Pinot-svn] r133 - trunk/Search
Message-ID: <200602271530.k1RFUO05025891@sheep.berlios.de>

Author: fabricecolin
Date: 2006-02-27 16:30:23 +0100 (Mon, 27 Feb 2006)
New Revision: 133

Added:
   trunk/Search/AbstractGenerator.cpp
   trunk/Search/AbstractGenerator.h
Modified:
   trunk/Search/Makefile.am
Log:
AbstractGenerator attempts to produce a summary of a document based on the
positions of a query's terms.
Abstract "windows" are anchored on both side of the query's top term positions
and weighted by the presence of terms. The window that has the most terms
is chosen.


Added: trunk/Search/AbstractGenerator.cpp
===================================================================
--- trunk/Search/AbstractGenerator.cpp	2006-02-25 05:59:08 UTC (rev 132)
+++ trunk/Search/AbstractGenerator.cpp	2006-02-27 15:30:23 UTC (rev 133)
@@ -0,0 +1,182 @@
+/*
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU Library General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ */
+
+#include <string.h>
+#include <sys/time.h>
+#include <map>
+#include <iostream>
+#include <utility>
+
+#include <ots/libots.h>
+
+#include "Timer.h"
+#include "AbstractGenerator.h"
+
+using std::cout;
+using std::cerr;
+using std::endl;
+using std::string;
+using std::vector;
+using std::map;
+
+unsigned int AbstractGenerator::m_minTermPositions = 10;
+
+AbstractGenerator::PositionWindow::PositionWindow() :
+	m_backWeight(0),
+	m_forwardWeight(0)
+{
+}
+
+AbstractGenerator::PositionWindow::~PositionWindow()
+{
+}
+
+AbstractGenerator::AbstractGenerator(const Xapian::Database *pIndex,
+	unsigned int wordsCount) :
+	m_pIndex(pIndex),
+	m_wordsCount(wordsCount)
+{
+}
+
+AbstractGenerator::~AbstractGenerator()
+{
+}
+
+/// Attempts to generate an abstract of wordsCount words.
+string AbstractGenerator::generateAbstract(const vector<string> &queryTerms,
+	Xapian::docid docId)
+{
+	map<Xapian::termpos, PositionWindow> abstractWindows;
+	map<Xapian::termpos, string> wordsBuffer;
+	string summary;
+	Xapian::termpos bestPosition = 0, startPosition =0;
+	unsigned int topTermCount = 0, bestWeight = 0;
+	bool topTerm = true;
+
+	if ((m_pIndex == NULL) ||
+		(queryTerms.empty() == true))
+	{
+		return "";
+	}
+
+#ifdef DEBUG
+	Timer timer;
+	timer.start();
+#endif
+	for (vector<string>::const_iterator termIter = queryTerms.begin();
+		termIter != queryTerms.end(); ++termIter)
+	{
+		string termName(*termIter);
+
+#ifdef DEBUG
+		cout << "AbstractGenerator::generateAbstract: term " << termName << endl;
+#endif
+		// Go through that term's position list in the document
+		for (Xapian::PositionIterator positionIter = m_pIndex->positionlist_begin(docId, termName);
+			positionIter != m_pIndex->positionlist_end(docId, termName); ++positionIter)
+		{
+			Xapian::termpos termPos = *positionIter;
+
+			// Take all the top term's positions into account, and some of 
+			// the other terms' too if the minimum number is not reached
+			if ((topTermCount < m_minTermPositions) ||
+				(topTerm == true))
+			{
+				abstractWindows[termPos] = PositionWindow();
+			}
+
+			// Look for other terms close to that position
+			for (map<Xapian::termpos, PositionWindow>::iterator winIter = abstractWindows.begin();
+				winIter != abstractWindows.end(); ++winIter)
+			{
+				// Is this within the number of words we are interested in ?
+				if (winIter->first > termPos)
+				{
+					if (winIter->first - termPos <= m_wordsCount)
+					{
+						++winIter->second.m_backWeight;
+					}
+				}
+				else
+				{
+					if (termPos - winIter->first <= m_wordsCount)
+					{
+						++winIter->second.m_forwardWeight;
+					}
+				}
+			}
+		}
+
+		topTerm = false;
+		++topTermCount;
+#ifdef DEBUG
+		cout << "AbstractGenerator::generateAbstract: " << abstractWindows.size()
+			<< " positions, " << topTermCount << " terms" << endl;
+#endif
+	}
+
+	// Go through positions and find out which one has the largest
+	// number of terms nearby
+	for (map<Xapian::termpos, PositionWindow>::iterator winIter = abstractWindows.begin();
+		winIter != abstractWindows.end(); ++winIter)
+	{
+		if (bestWeight < winIter->second.m_backWeight)
+		{
+			bestPosition = winIter->first;
+			startPosition = bestPosition - m_wordsCount;
+			bestWeight = winIter->second.m_backWeight;
+		}
+		if (bestWeight < winIter->second.m_forwardWeight)
+		{
+			bestPosition = startPosition = winIter->first;
+			bestWeight = winIter->second.m_forwardWeight;
+		}
+	}
+#ifdef DEBUG
+	cout << "AbstractGenerator::generateAbstract: best position is "
+		<< bestPosition << ":" << startPosition << " with weight " << bestWeight << endl;
+#endif
+
+	// Go through the position list of each term
+	for (Xapian::TermIterator termIter = m_pIndex->termlist_begin(docId);
+		termIter != m_pIndex->termlist_end(docId); ++termIter)
+	{
+		for (Xapian::PositionIterator positionIter = m_pIndex->positionlist_begin(docId, *termIter);
+			positionIter != m_pIndex->positionlist_end(docId, *termIter); ++positionIter)
+		{
+			Xapian::termpos termPos = *positionIter;
+
+			// ...and get those that fall in the abstract window
+			if ((startPosition <= termPos) &&
+				(termPos <= startPosition + m_wordsCount))
+			{
+				wordsBuffer[termPos] = *termIter;
+			}
+		}
+	}
+
+	for (map<Xapian::termpos, string>::iterator wordIter = wordsBuffer.begin();
+		wordIter != wordsBuffer.end(); ++wordIter)
+	{
+		summary += " ";
+		summary += wordIter->second;
+	}
+#ifdef DEBUG
+	cout << "AbstractGenerator: done in " << timer.stop()/1000 << " ms" << endl;
+#endif
+
+	return summary;
+}

Added: trunk/Search/AbstractGenerator.h
===================================================================
--- trunk/Search/AbstractGenerator.h	2006-02-25 05:59:08 UTC (rev 132)
+++ trunk/Search/AbstractGenerator.h	2006-02-27 15:30:23 UTC (rev 133)
@@ -0,0 +1,57 @@
+/*
+ *  This program is free software; you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation; either version 2 of the License, or
+ *  (at your option) any later version.
+ *
+ *  This program is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU Library General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with this program; if not, write to the Free Software
+ *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+ */
+
+#ifndef _ABSTRACT_GENERATOR_H
+#define _ABSTRACT_GENERATOR_H
+
+#include <string>
+#include <vector>
+
+#include <xapian.h>
+
+class AbstractGenerator
+{
+	public:
+		AbstractGenerator(const Xapian::Database *pIndex, unsigned int wordsCount);
+		virtual ~AbstractGenerator();
+
+		/// Attempts to generate an abstract of wordsCount words.
+		std::string generateAbstract(const std::vector<std::string> &queryTerms,
+			Xapian::docid docId);
+
+	protected:
+		static unsigned int m_minTermPositions;
+		const Xapian::Database *m_pIndex;
+		unsigned int m_wordsCount;
+
+		class PositionWindow
+		{
+			public:
+				PositionWindow();
+				~PositionWindow();
+
+				unsigned int m_backWeight;
+				unsigned int m_forwardWeight;
+
+		};
+
+	private:
+		AbstractGenerator(const AbstractGenerator &other);
+		AbstractGenerator &operator=(const AbstractGenerator &other);
+
+};
+
+#endif // _ABSTRACT_GENERATOR_H

Modified: trunk/Search/Makefile.am
===================================================================
--- trunk/Search/Makefile.am	2006-02-25 05:59:08 UTC (rev 132)
+++ trunk/Search/Makefile.am	2006-02-27 15:30:23 UTC (rev 133)
@@ -1,6 +1,7 @@
 # Process this file with automake to produce Makefile.in
 
 noinst_HEADERS = \
+	AbstractGenerator.h \
 	OpenSearchParser.h \
 	QueryProperties.h \
 	SearchPluginProperties.h \
@@ -17,6 +18,7 @@
 bin_PROGRAMS = pinot_search
 
 libSearch_la_SOURCES = \
+	AbstractGenerator.cpp \
 	OpenSearchParser.cpp \
 	QueryProperties.cpp \
 	SearchPluginProperties.cpp \



