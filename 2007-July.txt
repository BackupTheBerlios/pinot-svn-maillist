From fabricecolin at mail.berlios.de  Fri Jul 20 18:56:02 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 20 Jul 2007 18:56:02 +0200
Subject: [Pinot-svn] r871 - trunk/Utils
Message-ID: <200707201656.l6KGu2Fn023150@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-20 18:55:50 +0200 (Fri, 20 Jul 2007)
New Revision: 871

Modified:
   trunk/Utils/Timer.cpp
   trunk/Utils/Timer.h
Log:
Return milliseconds.


Modified: trunk/Utils/Timer.cpp
===================================================================
--- trunk/Utils/Timer.cpp	2007-06-24 07:14:24 UTC (rev 870)
+++ trunk/Utils/Timer.cpp	2007-07-20 16:55:50 UTC (rev 871)
@@ -52,12 +52,12 @@
 	gettimeofday(&m_start, NULL);
 }
 
-/// Stops the timer and returns the number of microseconds elapsed.
-long Timer::stop(void)
+/// Stops the timer and returns the number of milliseconds elapsed.
+suseconds_t Timer::stop(void)
 {
 	gettimeofday(&m_stop, NULL);
 
-	long timeDiff = (((m_stop.tv_sec - m_start.tv_sec) * 1000000) + m_stop.tv_usec) - m_start.tv_usec;
+	suseconds_t timeDiff = (((m_stop.tv_sec - m_start.tv_sec) * 1000) + ((m_stop.tv_usec - m_start.tv_usec) / 1000));
 
 	return timeDiff;
 }

Modified: trunk/Utils/Timer.h
===================================================================
--- trunk/Utils/Timer.h	2007-06-24 07:14:24 UTC (rev 870)
+++ trunk/Utils/Timer.h	2007-07-20 16:55:50 UTC (rev 871)
@@ -35,8 +35,8 @@
 		/// Starts the timer.
 		void start(void);
 
-		/// Stops the timer and returns the number of microseconds elapsed.
-		long stop(void);
+		/// Stops the timer and returns the number of milliseconds elapsed.
+		suseconds_t stop(void);
 
 	protected:
 		struct timeval m_start;



From fabricecolin at mail.berlios.de  Sat Jul 21 06:06:18 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 21 Jul 2007 06:06:18 +0200
Subject: [Pinot-svn] r872 - trunk/Index
Message-ID: <200707210406.l6L46Ibu023518@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-21 06:06:17 +0200 (Sat, 21 Jul 2007)
New Revision: 872

Modified:
   trunk/Index/DBusXapianIndex.cpp
   trunk/Index/DBusXapianIndex.h
   trunk/Index/FilterWrapper.cpp
   trunk/Index/FilterWrapper.h
   trunk/Index/IndexInterface.h
   trunk/Index/LanguageDetector.cpp
   trunk/Index/XapianIndex.cpp
   trunk/Index/XapianIndex.h
   trunk/Index/pinot-index.cpp
Log:
A XFILE-prefixed term is added to local documents that are sub-documents of
another. FilterWrapper unindexes them whenever the top document is updated or
unindexed. IndexInterface's unindexDocuments() was extended accordingly.
Some other minor changes.


Modified: trunk/Index/DBusXapianIndex.cpp
===================================================================
--- trunk/Index/DBusXapianIndex.cpp	2007-07-20 16:55:50 UTC (rev 871)
+++ trunk/Index/DBusXapianIndex.cpp	2007-07-21 04:06:17 UTC (rev 872)
@@ -689,8 +689,8 @@
 	return false;
 }
 
-/// Unindexes documents with the given label or under the given directory.
-bool DBusXapianIndex::unindexDocuments(const string &name, bool isDirectory)
+/// Unindexes documents.
+bool DBusXapianIndex::unindexDocuments(const string &name, NameType type)
 {
 	cerr << "DBusXapianIndex::unindexDocuments: not allowed" << endl;
 	return false;

Modified: trunk/Index/DBusXapianIndex.h
===================================================================
--- trunk/Index/DBusXapianIndex.h	2007-07-20 16:55:50 UTC (rev 871)
+++ trunk/Index/DBusXapianIndex.h	2007-07-21 04:06:17 UTC (rev 872)
@@ -109,8 +109,8 @@
 		/// Unindexes the given document.
 		virtual bool unindexDocument(unsigned int docId);
 
-		/// Unindexes documents with the given label or under the given directory.
-		virtual bool unindexDocuments(const std::string &name, bool isDirectory);
+		/// Unindexes documents.
+		virtual bool unindexDocuments(const std::string &name, NameType type);
 
 		/// Unindexes all documents.
 		virtual bool unindexAllDocuments(void);

Modified: trunk/Index/FilterWrapper.cpp
===================================================================
--- trunk/Index/FilterWrapper.cpp	2007-07-20 16:55:50 UTC (rev 871)
+++ trunk/Index/FilterWrapper.cpp	2007-07-21 04:06:17 UTC (rev 872)
@@ -16,6 +16,7 @@
  *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
  */
 
+#include <time.h>
 #include <iostream>
 
 #include "Url.h"
@@ -30,7 +31,8 @@
 using std::set;
 using namespace Dijon;
 
-FilterWrapper::FilterWrapper()
+FilterWrapper::FilterWrapper(IndexInterface *pIndex) :
+	m_pIndex(pIndex)
 {
 }
 
@@ -38,26 +40,50 @@
 {
 }
 
-bool FilterWrapper::indexDocument(IndexInterface &index, const Document &doc,
-	const set<string> &labels, unsigned int &docId)
+bool FilterWrapper::indexDocument(const Document &doc, const set<string> &labels, unsigned int &docId)
 {
 	string originalType(doc.getType());
 
-	return filterDocument(index, doc, originalType, labels, docId, false);
+	if (m_pIndex == NULL)
+	{
+		return false;
+	}
+
+	unindexNestedDocuments(doc.getLocation());
+
+	return filterDocument(doc, originalType, labels, docId, false);
 }
 
-bool FilterWrapper::updateDocument(unsigned int docId, IndexInterface &index, const Document &doc)
+bool FilterWrapper::updateDocument(const Document &doc, unsigned int docId)
 {
 	set<string> labels;
 	string originalType(doc.getType());
 
-	return filterDocument(index, doc, originalType, labels, docId, true);
+	if (m_pIndex == NULL)
+	{
+		return false;
+	}
+
+	unindexNestedDocuments(doc.getLocation());
+
+	return filterDocument(doc, originalType, labels, docId, true);
 }
 
-bool FilterWrapper::filterDocument(IndexInterface &index, const Document &doc,
-	const string &originalType, const set<string> &labels,
-	unsigned int &docId, bool doUpdate)
+bool FilterWrapper::unindexDocument(const string &location)
 {
+	if (m_pIndex == NULL)
+	{
+		return false;
+	}
+
+	unindexNestedDocuments(location);
+
+	return m_pIndex->unindexDocument(location);
+}
+
+bool FilterWrapper::filterDocument(const Document &doc, const string &originalType,
+	const set<string> &labels, unsigned int &docId, bool doUpdate)
+{
 	Filter *pFilter = FilterFactory::getFilter(doc.getType());
 	bool fedFilter = false, success = false;
 
@@ -92,6 +118,7 @@
 	while (pFilter->has_documents() == true)
 	{
 		string actualType(originalType);
+		bool isNested = false;
 
 		if (pFilter->next_document() == false)
 		{
@@ -115,6 +142,7 @@
 #ifdef DEBUG
 			cout << "FilterWrapper::filterDocument: nested document of type " << actualType << endl;
 #endif
+			isNested = true;
 		}
 
 		// Pass it down to another filter ?
@@ -125,18 +153,29 @@
 			filteredDoc.setType(actualType);
 
 			Tokenizer tokens(&filteredDoc);
-			if (doUpdate == false)
+
+			// Nested documents can't be updated because they are unindexed
+			// and the ID is that of the base document anyway
+			if ((doUpdate == true) &&
+				(isNested == false))
 			{
-				success = index.indexDocument(tokens, labels, docId);
+				success = m_pIndex->updateDocument(docId, tokens);
 			}
 			else
 			{
-				success = index.updateDocument(docId, tokens);
+				unsigned int newDocId = docId;
+
+				success = m_pIndex->indexDocument(tokens, labels, newDocId);
+				// Make sure we return the base document's ID, not the last nested document's ID
+				if (isNested == false)
+				{
+					docId = newDocId;
+				}
 			}
 		}
 		else
 		{
-			success = filterDocument(index, filteredDoc, originalType, labels, docId, doUpdate);
+			success = filterDocument(filteredDoc, originalType, labels, docId, doUpdate);
 			delete pFilter;
 
 			return success;
@@ -154,3 +193,9 @@
 
 	return success;
 }
+
+bool FilterWrapper::unindexNestedDocuments(const string &url)
+{
+	// Unindex all documents that stem from this file
+	return m_pIndex->unindexDocuments(url, IndexInterface::BY_FILE);
+}

Modified: trunk/Index/FilterWrapper.h
===================================================================
--- trunk/Index/FilterWrapper.h	2007-07-20 16:55:50 UTC (rev 871)
+++ trunk/Index/FilterWrapper.h	2007-07-21 04:06:17 UTC (rev 872)
@@ -30,23 +30,29 @@
 class FilterWrapper
 {
 	public:
+		/// Builds a FilterWrapper object.
+		FilterWrapper(IndexInterface *pIndex);
 		virtual ~FilterWrapper();
 
 		/// Indexes the given data.
-		static bool indexDocument(IndexInterface &index, const Document &doc,
-			const std::set<std::string> &labels, unsigned int &docId);
+		bool indexDocument(const Document &doc, const std::set<std::string> &labels,
+			unsigned int &docId);
 
 		/// Updates the given document.
-		static bool updateDocument(unsigned int docId, IndexInterface &index,
-			const Document &doc);
+		bool updateDocument(const Document &doc, unsigned int docId);
 
+		/// Unindexes document(s) at the given location.
+		bool unindexDocument(const std::string &location);
+
 	protected:
-		FilterWrapper();
+		IndexInterface *m_pIndex;
 
-		static bool filterDocument(IndexInterface &index, const Document &doc,
-			const std::string &originalType, const std::set<std::string> &labels,
-			unsigned int &docId, bool doUpdate);
+		bool filterDocument(const Document &doc, const std::string &originalType,
+			const std::set<std::string> &labels, unsigned int &docId,
+			bool doUpdate);
 
+		bool unindexNestedDocuments(const std::string &url);
+
 	private:
 		FilterWrapper(const FilterWrapper &other);
 		FilterWrapper &operator=(const FilterWrapper &other);

Modified: trunk/Index/IndexInterface.h
===================================================================
--- trunk/Index/IndexInterface.h	2007-07-20 16:55:50 UTC (rev 871)
+++ trunk/Index/IndexInterface.h	2007-07-21 04:06:17 UTC (rev 872)
@@ -116,9 +116,11 @@
 		/// Unindexes the given document.
 		virtual bool unindexDocument(const std::string &location) = 0;
 
-		/// Unindexes documents with the given label or under the given directory.
-		virtual bool unindexDocuments(const std::string &name, bool isDirectory) = 0;
+		typedef enum { BY_LABEL = 0, BY_DIRECTORY, BY_FILE } NameType;
 
+		/// Unindexes documents.
+		virtual bool unindexDocuments(const std::string &name, NameType type) = 0;
+
 		/// Unindexes all documents.
 		virtual bool unindexAllDocuments(void) = 0;
 

Modified: trunk/Index/LanguageDetector.cpp
===================================================================
--- trunk/Index/LanguageDetector.cpp	2007-07-20 16:55:50 UTC (rev 871)
+++ trunk/Index/LanguageDetector.cpp	2007-07-21 04:06:17 UTC (rev 872)
@@ -165,7 +165,7 @@
 #endif
 #ifdef DEBUG
 	cout << "LanguageDetector::guessLanguage: language guessing took "
-		<< timer.stop()/1000 << " ms" << endl;
+		<< timer.stop() << " ms" << endl;
 #endif
 
 	// Close the descriptor

Modified: trunk/Index/XapianIndex.cpp
===================================================================
--- trunk/Index/XapianIndex.cpp	2007-07-20 16:55:50 UTC (rev 871)
+++ trunk/Index/XapianIndex.cpp	2007-07-21 04:06:17 UTC (rev 872)
@@ -347,6 +347,13 @@
 
 	// Index the full URL with prefix U
 	doc.add_term(string("U") + XapianDatabase::limitTermLength(Url::escapeUrl(location), true));
+	// ...the base file with XFILE:
+	string::size_type qmPos = location.find("?");
+	if ((urlObj.isLocal() == true) &&
+		(qmPos != string::npos))
+	{
+		doc.add_term(string("XFILE:") + XapianDatabase::limitTermLength(Url::escapeUrl(location.substr(0, qmPos)), true));
+	}
 	// ...the host name and included domains with prefix H
 	string hostName(StringManip::toLowerCase(urlObj.getHost()));
 	if (hostName.empty() == false)
@@ -465,7 +472,15 @@
 	}
 
 	// Location 
-	commonTerms.insert(string("U") + XapianDatabase::limitTermLength(Url::escapeUrl(docInfo.getLocation()), true));
+	string location(docInfo.getLocation());
+	commonTerms.insert(string("U") + XapianDatabase::limitTermLength(Url::escapeUrl(location), true));
+	// Base file
+	string::size_type qmPos = location.find("?");
+	if ((urlObj.isLocal() == true) &&
+		(qmPos != string::npos))
+	{
+		commonTerms.insert(string("XFILE:") + XapianDatabase::limitTermLength(Url::escapeUrl(location.substr(0, qmPos)), true));
+	}
 	// Host name
 	string hostName(StringManip::toLowerCase(urlObj.getHost()));
 	if (hostName.empty() == false)
@@ -1444,18 +1459,22 @@
 	return deleteDocuments(term);
 }
 
-/// Unindexes documents with the given label or under the given directory.
-bool XapianIndex::unindexDocuments(const string &name, bool isDirectory)
+/// Unindexes documents.
+bool XapianIndex::unindexDocuments(const string &name, NameType type)
 {
-	string term("XLABEL:");
+	string term;
 
-	if (isDirectory == true)
+	if (type == BY_LABEL)
 	{
+		term = string("XLABEL:") + XapianDatabase::limitTermLength(Url::escapeUrl(name));
+	}
+	else if (type == BY_DIRECTORY)
+	{
 		term = string("XDIR:") + XapianDatabase::limitTermLength(Url::escapeUrl(name), true);
 	}
-	else
+	else if (type == BY_FILE)
 	{
-		term += XapianDatabase::limitTermLength(Url::escapeUrl(name));
+		term = string("XFILE:") + XapianDatabase::limitTermLength(Url::escapeUrl(name), true);
 	}
 
 	return deleteDocuments(term);

Modified: trunk/Index/XapianIndex.h
===================================================================
--- trunk/Index/XapianIndex.h	2007-07-20 16:55:50 UTC (rev 871)
+++ trunk/Index/XapianIndex.h	2007-07-21 04:06:17 UTC (rev 872)
@@ -107,8 +107,8 @@
 		/// Unindexes the given document.
 		virtual bool unindexDocument(const std::string &location);
 
-		/// Unindexes documents with the given label or under the given directory.
-		virtual bool unindexDocuments(const std::string &name, bool isDirectory);
+		/// Unindexes documents.
+		virtual bool unindexDocuments(const std::string &name, NameType type);
 
 		/// Unindexes all documents.
 		virtual bool unindexAllDocuments(void);

Modified: trunk/Index/pinot-index.cpp
===================================================================
--- trunk/Index/pinot-index.cpp	2007-07-20 16:55:50 UTC (rev 871)
+++ trunk/Index/pinot-index.cpp	2007-07-21 04:06:17 UTC (rev 872)
@@ -241,6 +241,7 @@
 		}
 		else
 		{
+			FilterWrapper wrapFilter(pIndex);
 			set<string> labels;
 
 			pIndex->setStemmingMode(IndexInterface::STORE_BOTH);
@@ -250,7 +251,7 @@
 			if (docId > 0)
 			{
 				// Update the document
-				if (FilterWrapper::updateDocument(docId, *pIndex, *pDoc) == true)
+				if (wrapFilter.updateDocument(*pDoc, docId) == true)
 				{
 					success = true;
 				}
@@ -258,7 +259,7 @@
 			else
 			{
 				// Index the document
-				success = FilterWrapper::indexDocument(*pIndex, *pDoc, labels, docId);
+				success = wrapFilter.indexDocument(*pDoc, labels, docId);
 			}
 
 			if (success == true)



From fabricecolin at mail.berlios.de  Sat Jul 21 06:09:31 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 21 Jul 2007 06:09:31 +0200
Subject: [Pinot-svn] r873 - in trunk/Search: . Google
Message-ID: <200707210409.l6L49Vlp023626@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-21 06:09:30 +0200 (Sat, 21 Jul 2007)
New Revision: 873

Modified:
   trunk/Search/AbstractGenerator.cpp
   trunk/Search/Google/Makefile.am
   trunk/Search/pinot-search.cpp
Log:
Pinot-search ouputs type and language too.
Some other minor changes.


Modified: trunk/Search/AbstractGenerator.cpp
===================================================================
--- trunk/Search/AbstractGenerator.cpp	2007-07-21 04:06:17 UTC (rev 872)
+++ trunk/Search/AbstractGenerator.cpp	2007-07-21 04:09:30 UTC (rev 873)
@@ -249,7 +249,7 @@
 	}
 #ifdef DEBUG
 	cout << "AbstractGenerator::generateAbstract: summarized document "
-		<< docId << " in " << timer.stop()/1000 << " ms" << endl;
+		<< docId << " in " << timer.stop() << " ms" << endl;
 #endif
 
 	return summary;

Modified: trunk/Search/Google/Makefile.am
===================================================================
--- trunk/Search/Google/Makefile.am	2007-07-21 04:06:17 UTC (rev 872)
+++ trunk/Search/Google/Makefile.am	2007-07-21 04:09:30 UTC (rev 873)
@@ -23,6 +23,7 @@
 	soapcpp2 -n -pGAPI -I /usr/include/gsoap/import GoogleSearch.h
 
 AM_CXXFLAGS = -I$(srcdir)/../../Utils -I$(srcdir)/../../Tokenize \
-	-I$(srcdir)/../../Tokenize/filters -I../../Collect -I../../Index -I.. \
+	-I$(srcdir)/../../Tokenize/filters -I$(srcdir)/../../Collect \
+	-I$(srcdir)/../../Index -I$(srcdir)/.. \
 	@HTTP_CFLAGS@ @XML_CFLAGS@ @SOAP_CFLAGS@ @INDEX_CFLAGS@ @GMIME_CFLAGS@
 

Modified: trunk/Search/pinot-search.cpp
===================================================================
--- trunk/Search/pinot-search.cpp	2007-07-21 04:06:17 UTC (rev 872)
+++ trunk/Search/pinot-search.cpp	2007-07-21 04:09:30 UTC (rev 873)
@@ -26,14 +26,12 @@
 #include "MIMEScanner.h"
 #include "Url.h"
 #include "XapianDatabaseFactory.h"
-#include "FilterUtils.h"
 #include "SearchEngineFactory.h"
 #include "ResultsExporter.h"
 #include "DownloaderFactory.h"
 #include "config.h"
 
 using namespace std;
-using namespace Dijon;
 
 static struct option g_longOptions[] = {
 	{"help", 0, 0, 'h'},
@@ -280,7 +278,9 @@
 					cout << count << " Host     : " << thisUrl.getHost() << endl;
 					cout << count << " Location : " << thisUrl.getLocation() << "/" << thisUrl.getFile() << endl;
 					cout << count << " Title    : " << resultIter->getTitle() << endl;
-					cout << count << " Extract  : " << FilterUtils::stripMarkup(resultIter->getExtract()) << endl;
+					cout << count << " Type     : " << resultIter->getType() << endl;
+					cout << count << " Language : " << resultIter->getLanguage() << endl;
+					cout << count << " Extract  : " << resultIter->getExtract() << endl;
 					cout << count << " Score    : " << resultIter->getScore() << endl;
 					count++;
 



From fabricecolin at mail.berlios.de  Sat Jul 21 06:26:58 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 21 Jul 2007 06:26:58 +0200
Subject: [Pinot-svn] r875 - trunk
Message-ID: <200707210426.l6L4Qw2a024269@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-21 06:26:57 +0200 (Sat, 21 Jul 2007)
New Revision: 875

Modified:
   trunk/README
Log:
Talk about mbox files are handled now, file types and external-filters.xml
as well as the new patterns list.


Modified: trunk/README
===================================================================
--- trunk/README	2007-07-21 04:17:51 UTC (rev 874)
+++ trunk/README	2007-07-21 04:26:57 UTC (rev 875)
@@ -138,28 +138,30 @@
 5. Indexing and monitoring
 
 
-  Pinot can automatically index :
-    * mbox mail accounts. Monitoring for changes is always enabled.
-    * directories. Their contents are crawled. Monitoring is optional.
-  Both are configured under the Indexing tab of the Preferences box and are
-  handled by the D-Bus service.
+  Pinot can index any directory configured under the Indexing tab of the
+  Preferences box. Monitoring is optional and should be disabled for the
+  directories whose contents seldom change, eg /usr/share/doc.
+  Indexing and monitoring of directories is handled by the D-Bus service.
 
-  All files and directories with a name that starts with a dot, eg ".gaim",
-  are skipped and their content is not indexed. If you want to exclude any
-  other specific files or directories from indexing, use patterns as described
-  in section "9. File patterns".
-
-  Mbox files held in a dot-directory should be added to the mail boxes list
-  in Preferences. Others found during a directory crawl will be fully indexed
-  but not monitored for changes.
-
   While Pinot is not currently able to get to and index application-specific
   data held in dot-directories, it can index common file formats as listed
   in section "8. File formats".
-  If you would like to index your GAIM chat logs, which are plain HTML files,
-  symlink ~/.gaim/logs to one of the directories configured in Preferences.
 
+  All files and directories with a name that starts with a dot, eg ".gaim",
+  are skipped and their content is not indexed. If you wish to include the
+  contents of some dot-directories, create a symlink to a directory that is
+  configured in Preferences. For instance, if your home directory is
+  configured for indexing, create a symlink from "~/.gaim/logs" to
+  "~/Documents/Logs" to index your GAIM log files.
+  Do the same for mbox files held in dot-directories, eg ".thunderbird". Pinot
+  0.74 and older required mbox files to be configured separately. Newer
+  versions are able to fully index (and monitor, if necessary) all mbox files
+  found during a directory crawl, just like any other file type.
 
+  If you want to exclude any specific files or directories from indexing, use
+  patterns as described in section "9. File patterns".
+
+
 6. Search strategy
 
 
@@ -209,7 +211,7 @@
   result's MIME type and/or protocol scheme.
   In addition, Pinot allows to view the page as cached by Google and the Wayback
   Machine. Cache providers are actually configured in globalconfig.xml, located
-  in $PREFIX/share/pinot/. For instance :
+  in /etc/pinot/. For instance :
   <cache>
     <name>Google</name>
     <location>http://www.google.com/search?q=cache:%url0</location>
@@ -228,35 +230,38 @@
 8. File formats
 
 
-  The following document types are supported and will be fully indexed
-  * plain text
-  * HTML
-  * PDF (pdftotext is required)
-  * RTF (unrtf is required)
-  * MS Word (antiword is required)
-  * XML
-  * OpenDocument/StarOffice files
-  * mbox
-  * MP3 and Ogg Vorbis (TagLib required)
-  More formats will be supported as the project matures.
+  The following document types are supported and will be fully indexed :
+    * plain text
+    * HTML
+    * PDF (pdftotext is required)
+    * RTF (unrtf is required)
+    * MS Word (antiword is required)
+    * XML
+    * OpenDocument/StarOffice files
+    * mbox
+    * MP3 and Ogg Vorbis (TagLib required)
+    * RPM (rpm required)
+    * DEB (dpkg required)
 
   For other document types, Pinot will only index metadata such as name,
   location etc...
 
+  If you wish to add support for another document type, and know of a
+  command-line program that can convert that type to plain text, XML or HTML,
+  you should be able to add it to external-filters.xml, located in /etc/pinot/.
 
+
 9. File patterns
 
 
   Starting with version 0.62, it is possible to skip indexing of files with
   glob(3) patterns. These patterns are configured in the Indexing tab of the
-  Preferences box.
+  Preferences box, and can be used as a blacklist or a whitelist (as of 0.75).
 
-  For example, "*.mp3" will skip all files with the extension "mp3", even
-  though that particular document type is supported by Pinot.
-  Patterns also apply to directory; for instance "*/Desktop*" will skip
+  Patterns also to files and directories. For instance "*/Desktop*" will skip
   "~/Desktop" and not crawl nor monitor this directory's contents.
-  If you have never run Pinot before, it will initialize the patterns list
-  to common picture and video types such as JPG, GIF, ZIP and MPG.
+  If you have never run Pinot before, the list will be pre-configured to skip
+  common picture and video types such as JPG, GIF, ZIP and MPG.
 
 
 10. More Like This



From fabricecolin at mail.berlios.de  Sat Jul 21 06:28:21 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 21 Jul 2007 06:28:21 +0200
Subject: [Pinot-svn] r876 - trunk/po
Message-ID: <200707210428.l6L4SLlN024339@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-21 06:28:21 +0200 (Sat, 21 Jul 2007)
New Revision: 876

Modified:
   trunk/po/POTFILES.in
Log:
MboxHandler was removed.


Modified: trunk/po/POTFILES.in
===================================================================
--- trunk/po/POTFILES.in	2007-07-21 04:26:57 UTC (rev 875)
+++ trunk/po/POTFILES.in	2007-07-21 04:28:21 UTC (rev 876)
@@ -15,7 +15,6 @@
 UI/GTK2/src/mainWindow.cc
 UI/GTK2/src/mainWindow_glade.cc
 UI/GTK2/src/ModelColumns.cpp
-UI/GTK2/src/MboxHandler.cpp
 UI/GTK2/src/Notebook.cpp
 UI/GTK2/src/OnDiskHandler.cpp
 UI/GTK2/src/pinot.cc



From fabricecolin at mail.berlios.de  Sat Jul 21 06:17:56 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 21 Jul 2007 06:17:56 +0200
Subject: [Pinot-svn] r874 - in trunk/UI/GTK2: . src
Message-ID: <200707210417.l6L4HuN5023875@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-21 06:17:51 +0200 (Sat, 21 Jul 2007)
New Revision: 874

Removed:
   trunk/UI/GTK2/src/MboxHandler.cpp
   trunk/UI/GTK2/src/MboxHandler.h
Modified:
   trunk/UI/GTK2/metase-gtk2.glade
   trunk/UI/GTK2/src/DaemonState.cpp
   trunk/UI/GTK2/src/DaemonState.h
   trunk/UI/GTK2/src/Makefile.am
   trunk/UI/GTK2/src/OnDiskHandler.cpp
   trunk/UI/GTK2/src/PinotSettings.cpp
   trunk/UI/GTK2/src/PinotSettings.h
   trunk/UI/GTK2/src/ServerThreads.cpp
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/prefsDialog.cc
   trunk/UI/GTK2/src/prefsDialog.hh
   trunk/UI/GTK2/src/prefsDialog_glade.cc
   trunk/UI/GTK2/src/prefsDialog_glade.hh
Log:
Mbox files are no longer a special case, they don't need to be configured
separately. Any mbox file found during a crawl should be handled correctly;
same for any other file type that has sub-documents.
The file patterns list may be used as a blacklist or a whitelist, depending
on preferences.
Some other minor changes.


Modified: trunk/UI/GTK2/metase-gtk2.glade
===================================================================
--- trunk/UI/GTK2/metase-gtk2.glade	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/metase-gtk2.glade	2007-07-21 04:17:51 UTC (rev 874)
@@ -1993,9 +1993,9 @@
 	      </child>
 
 	      <child>
-		<widget class="GtkLabel" id="mailAccountsLabel">
+		<widget class="GtkLabel" id="patternsLabel">
 		  <property name="visible">True</property>
-		  <property name="label" translatable="yes">Mail boxes of type mbox can be monitored and indexed:</property>
+		  <property name="label" translatable="yes">File patterns:</property>
 		  <property name="use_underline">False</property>
 		  <property name="use_markup">False</property>
 		  <property name="justify">GTK_JUSTIFY_LEFT</property>
@@ -2018,213 +2018,67 @@
 	      </child>
 
 	      <child>
-		<widget class="GtkHBox" id="mailHbox">
+		<widget class="GtkHBox" id="patternsHbox">
 		  <property name="visible">True</property>
 		  <property name="homogeneous">False</property>
 		  <property name="spacing">0</property>
 
 		  <child>
-		    <widget class="GtkScrolledWindow" id="mailScrolledwindow">
-		      <property name="border_width">4</property>
+		    <widget class="GtkVBox" id="patternsVbox">
 		      <property name="visible">True</property>
-		      <property name="can_focus">True</property>
-		      <property name="hscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
-		      <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
-		      <property name="shadow_type">GTK_SHADOW_NONE</property>
-		      <property name="window_placement">GTK_CORNER_TOP_LEFT</property>
-
-		      <child>
-			<widget class="GtkTreeView" id="mailTreeview">
-			  <property agent="glademm" name="cxx_visibility">protected</property>
-			  <property name="visible">True</property>
-			  <property name="can_focus">True</property>
-			  <property name="headers_visible">True</property>
-			  <property name="rules_hint">False</property>
-			  <property name="reorderable">False</property>
-			  <property name="enable_search">True</property>
-			  <property name="fixed_height_mode">True</property>
-			  <property name="hover_selection">False</property>
-			  <property name="hover_expand">False</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
-		      <property name="expand">True</property>
-		      <property name="fill">True</property>
-		    </packing>
-		  </child>
-
-		  <child>
-		    <widget class="GtkVButtonBox" id="mailVbuttonbox">
-		      <property name="visible">True</property>
-		      <property name="layout_style">GTK_BUTTONBOX_START</property>
+		      <property name="homogeneous">False</property>
 		      <property name="spacing">0</property>
 
 		      <child>
-			<widget class="GtkButton" id="addAccountButton">
+			<widget class="GtkScrolledWindow" id="patternsScrolledwindow">
 			  <property name="border_width">4</property>
-			  <property agent="glademm" name="cxx_visibility">protected</property>
 			  <property name="visible">True</property>
-			  <property name="can_default">True</property>
 			  <property name="can_focus">True</property>
-			  <property name="relief">GTK_RELIEF_NORMAL</property>
-			  <property name="focus_on_click">True</property>
-			  <signal name="clicked" handler="on_addAccountButton_clicked" last_modification_time="Tue, 20 Sep 2005 13:19:44 GMT"/>
+			  <property name="hscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
+			  <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
+			  <property name="shadow_type">GTK_SHADOW_NONE</property>
+			  <property name="window_placement">GTK_CORNER_TOP_LEFT</property>
 
 			  <child>
-			    <widget class="GtkAlignment" id="alignment28">
+			    <widget class="GtkTreeView" id="patternsTreeview">
+			      <property agent="glademm" name="cxx_visibility">protected</property>
 			      <property name="visible">True</property>
-			      <property name="xalign">0.5</property>
-			      <property name="yalign">0.5</property>
-			      <property name="xscale">0</property>
-			      <property name="yscale">0</property>
-			      <property name="top_padding">0</property>
-			      <property name="bottom_padding">0</property>
-			      <property name="left_padding">0</property>
-			      <property name="right_padding">0</property>
-
-			      <child>
-				<widget class="GtkHBox" id="hbox42">
-				  <property name="visible">True</property>
-				  <property name="homogeneous">False</property>
-				  <property name="spacing">2</property>
-
-				  <child>
-				    <widget class="GtkImage" id="image497">
-				      <property name="visible">True</property>
-				      <property name="stock">gtk-add</property>
-				      <property name="icon_size">4</property>
-				      <property name="xalign">0.5</property>
-				      <property name="yalign">0.5</property>
-				      <property name="xpad">0</property>
-				      <property name="ypad">0</property>
-				    </widget>
-				    <packing>
-				      <property name="padding">0</property>
-				      <property name="expand">False</property>
-				      <property name="fill">False</property>
-				    </packing>
-				  </child>
-
-				  <child>
-				    <widget class="GtkLabel" id="label49">
-				      <property name="visible">True</property>
-				      <property name="label" translatable="yes">Add</property>
-				      <property name="use_underline">True</property>
-				      <property name="use_markup">False</property>
-				      <property name="justify">GTK_JUSTIFY_LEFT</property>
-				      <property name="wrap">False</property>
-				      <property name="selectable">False</property>
-				      <property name="xalign">0.5</property>
-				      <property name="yalign">0.5</property>
-				      <property name="xpad">0</property>
-				      <property name="ypad">0</property>
-				      <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-				      <property name="width_chars">-1</property>
-				      <property name="single_line_mode">False</property>
-				      <property name="angle">0</property>
-				    </widget>
-				    <packing>
-				      <property name="padding">0</property>
-				      <property name="expand">False</property>
-				      <property name="fill">False</property>
-				    </packing>
-				  </child>
-				</widget>
-			      </child>
+			      <property name="can_focus">True</property>
+			      <property name="headers_visible">True</property>
+			      <property name="rules_hint">False</property>
+			      <property name="reorderable">False</property>
+			      <property name="enable_search">True</property>
+			      <property name="fixed_height_mode">True</property>
+			      <property name="hover_selection">False</property>
+			      <property name="hover_expand">False</property>
 			    </widget>
 			  </child>
 			</widget>
+			<packing>
+			  <property name="padding">0</property>
+			  <property name="expand">True</property>
+			  <property name="fill">True</property>
+			</packing>
 		      </child>
 
 		      <child>
-			<widget class="GtkButton" id="removeAccountButton">
-			  <property name="border_width">4</property>
+			<widget class="GtkComboBox" id="patternsCombobox">
 			  <property agent="glademm" name="cxx_visibility">protected</property>
 			  <property name="visible">True</property>
-			  <property name="can_default">True</property>
-			  <property name="can_focus">True</property>
-			  <property name="label">gtk-remove</property>
-			  <property name="use_stock">True</property>
-			  <property name="relief">GTK_RELIEF_NORMAL</property>
+			  <property name="items" translatable="yes"></property>
+			  <property name="add_tearoffs">False</property>
 			  <property name="focus_on_click">True</property>
-			  <signal name="clicked" handler="on_removeAccountButton_clicked" last_modification_time="Fri, 02 Sep 2005 21:58:06 GMT"/>
+			  <signal name="changed" handler="on_patternsCombobox_changed" last_modification_time="Tue, 03 Jul 2007 13:02:19 GMT"/>
 			</widget>
+			<packing>
+			  <property name="padding">4</property>
+			  <property name="expand">True</property>
+			  <property name="fill">True</property>
+			</packing>
 		      </child>
 		    </widget>
 		    <packing>
 		      <property name="padding">0</property>
-		      <property name="expand">False</property>
-		      <property name="fill">True</property>
-		    </packing>
-		  </child>
-		</widget>
-		<packing>
-		  <property name="padding">4</property>
-		  <property name="expand">True</property>
-		  <property name="fill">True</property>
-		</packing>
-	      </child>
-
-	      <child>
-		<widget class="GtkLabel" id="patternsLabel">
-		  <property name="visible">True</property>
-		  <property name="label" translatable="yes">Specify any file pattern you wish to exclude from indexing:</property>
-		  <property name="use_underline">False</property>
-		  <property name="use_markup">False</property>
-		  <property name="justify">GTK_JUSTIFY_LEFT</property>
-		  <property name="wrap">True</property>
-		  <property name="selectable">False</property>
-		  <property name="xalign">0</property>
-		  <property name="yalign">0.5</property>
-		  <property name="xpad">4</property>
-		  <property name="ypad">4</property>
-		  <property name="ellipsize">PANGO_ELLIPSIZE_NONE</property>
-		  <property name="width_chars">-1</property>
-		  <property name="single_line_mode">False</property>
-		  <property name="angle">0</property>
-		</widget>
-		<packing>
-		  <property name="padding">4</property>
-		  <property name="expand">False</property>
-		  <property name="fill">False</property>
-		</packing>
-	      </child>
-
-	      <child>
-		<widget class="GtkHBox" id="patternsHbox">
-		  <property name="visible">True</property>
-		  <property name="homogeneous">False</property>
-		  <property name="spacing">0</property>
-
-		  <child>
-		    <widget class="GtkScrolledWindow" id="patternsScrolledwindow">
-		      <property name="border_width">4</property>
-		      <property name="visible">True</property>
-		      <property name="can_focus">True</property>
-		      <property name="hscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
-		      <property name="vscrollbar_policy">GTK_POLICY_AUTOMATIC</property>
-		      <property name="shadow_type">GTK_SHADOW_NONE</property>
-		      <property name="window_placement">GTK_CORNER_TOP_LEFT</property>
-
-		      <child>
-			<widget class="GtkTreeView" id="patternsTreeview">
-			  <property agent="glademm" name="cxx_visibility">protected</property>
-			  <property name="visible">True</property>
-			  <property name="can_focus">True</property>
-			  <property name="headers_visible">True</property>
-			  <property name="rules_hint">False</property>
-			  <property name="reorderable">False</property>
-			  <property name="enable_search">True</property>
-			  <property name="fixed_height_mode">True</property>
-			  <property name="hover_selection">False</property>
-			  <property name="hover_expand">False</property>
-			</widget>
-		      </child>
-		    </widget>
-		    <packing>
-		      <property name="padding">0</property>
 		      <property name="expand">True</property>
 		      <property name="fill">True</property>
 		    </packing>
@@ -2336,7 +2190,7 @@
 		  </child>
 		</widget>
 		<packing>
-		  <property name="padding">0</property>
+		  <property name="padding">4</property>
 		  <property name="expand">True</property>
 		  <property name="fill">True</property>
 		</packing>

Modified: trunk/UI/GTK2/src/DaemonState.cpp
===================================================================
--- trunk/UI/GTK2/src/DaemonState.cpp	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/DaemonState.cpp	2007-07-21 04:17:51 UTC (rev 874)
@@ -31,7 +31,6 @@
 #include "MonitorFactory.h"
 #include "XapianIndex.h"
 #include "DaemonState.h"
-#include "MboxHandler.h"
 #include "OnDiskHandler.h"
 #include "PinotSettings.h"
 #include "PinotUtils.h"
@@ -43,9 +42,7 @@
 DaemonState::DaemonState() :
 	ThreadsManager(PinotSettings::getInstance().m_daemonIndexLocation, 20),
 	m_fullScan(false),
-	m_pMailMonitor(MonitorFactory::getMonitor()),
 	m_pDiskMonitor(MonitorFactory::getMonitor()),
-	m_pMailHandler(NULL),
 	m_pDiskHandler(NULL)
 {
 	m_onThreadEndSignal.connect(SigC::slot(*this, &DaemonState::on_thread_end));
@@ -57,11 +54,7 @@
 	{
 		delete m_pDiskMonitor;
 	}
-	if (m_pMailMonitor != NULL)
-	{
-		delete m_pMailMonitor;
-	}
-	// Don't delete m_pDiskHandler and m_pMailHandler, threads may need them
+	// Don't delete m_pDiskHandler, threads may need it
 	// Since DaemonState is destroyed when the program exits, it's okay
 }
 
@@ -124,13 +117,7 @@
 #endif
 	}
 
-	// Fire up the mail monitor thread now
-	m_pMailHandler = new MboxHandler();
-	MonitorThread *pMailMonitorThread = new MonitorThread(m_pMailMonitor, m_pMailHandler);
-	pMailMonitorThread->getDirectoryFoundSignal().connect(SigC::slot(*this, &DaemonState::on_message_filefound));
-	start_thread(pMailMonitorThread, true);
-
-	// Same for the disk monitor thread
+	// Fire up the disk monitor thread
 	m_pDiskHandler = new OnDiskHandler();
 	MonitorThread *pDiskMonitorThread = new MonitorThread(m_pDiskMonitor, m_pDiskHandler);
 	pDiskMonitorThread->getDirectoryFoundSignal().connect(SigC::slot(*this, &DaemonState::on_message_filefound));

Modified: trunk/UI/GTK2/src/DaemonState.h
===================================================================
--- trunk/UI/GTK2/src/DaemonState.h	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/DaemonState.h	2007-07-21 04:17:51 UTC (rev 874)
@@ -46,9 +46,7 @@
 
 	protected:
 		bool m_fullScan;
-		MonitorInterface *m_pMailMonitor;
 		MonitorInterface *m_pDiskMonitor;
-		MonitorHandler *m_pMailHandler;
 		MonitorHandler *m_pDiskHandler;
 		std::string m_locationBeingCrawled;
 		SigC::Signal1<void, int> m_signalQuit;

Modified: trunk/UI/GTK2/src/Makefile.am
===================================================================
--- trunk/UI/GTK2/src/Makefile.am	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/Makefile.am	2007-07-21 04:17:51 UTC (rev 874)
@@ -22,7 +22,6 @@
 	DaemonState.h \
 	EnginesTree.h \
 	IndexPage.h \
-	MboxHandler.h \
 	ModelColumns.h \
 	Notebook.h \
 	OnDiskHandler.h \
@@ -54,7 +53,6 @@
 	statisticsDialog.cc \
 	EnginesTree.cpp \
 	IndexPage.cpp \
-	MboxHandler.cpp \
 	ModelColumns.cpp \
 	Notebook.cpp \
 	PinotSettings.cpp \
@@ -65,7 +63,6 @@
 pinot_dbus_daemon_SOURCES = \
 	pinot-dbus-daemon.cc \
 	DaemonState.cpp \
-	MboxHandler.cpp \
 	OnDiskHandler.cpp \
 	PinotSettings.cpp \
 	ServerThreads.cpp \

Deleted: trunk/UI/GTK2/src/MboxHandler.cpp
===================================================================
--- trunk/UI/GTK2/src/MboxHandler.cpp	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/MboxHandler.cpp	2007-07-21 04:17:51 UTC (rev 874)
@@ -1,386 +0,0 @@
-/*
- *  Copyright 2005,2006 Fabrice Colin
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
- */
-
-#include <sys/types.h>
-#include <sys/stat.h>
-#include <fcntl.h>
-#include <unistd.h>
-#include <iostream>
-#include <fstream>
-
-#include "config.h"
-#include "NLS.h"
-#include "StringManip.h"
-#include "Timer.h"
-#include "TimeConverter.h"
-#include "Url.h"
-#include "FilterFactory.h"
-#include "FilterUtils.h"
-#include "FilterWrapper.h"
-#include "XapianDatabase.h"
-#include "MboxHandler.h"
-
-using namespace std;
-using namespace SigC;
-
-MboxHandler::MboxHandler() :
-	MonitorHandler(),
-	m_history(PinotSettings::getInstance().getHistoryDatabaseName()),
-	m_index(PinotSettings::getInstance().m_daemonIndexLocation),
-	m_sourceId(0)
-{
-	// Does the email source exist ?
-	if (m_history.hasSource("My Email", m_sourceId) == false)
-	{
-		// Create it
-		m_sourceId = m_history.insertSource("My Email");
-	}
-#ifdef DEBUG
-	cout << "MboxHandler: My Email source ID is " << m_sourceId << endl;
-#endif
-}
-
-MboxHandler::~MboxHandler()
-{
-}
-
-bool MboxHandler::checkMailAccount(const string &fileName, PinotSettings::TimestampedItem &mailAccount)
-{
-	struct stat fileStat;
-	CrawlHistory::CrawlStatus status;
-	time_t lastModDate = 0;
-	mailAccount.m_name = fileName;
-
-	// Ensure it's one of our mail accounts
-	set<PinotSettings::TimestampedItem> &mailAccounts = PinotSettings::getInstance().m_mailAccounts;
-	set<PinotSettings::TimestampedItem>::iterator mailIter = mailAccounts.find(mailAccount);
-	if (mailIter == mailAccounts.end())
-	{
-		// It doesn't seem to be
-#ifdef DEBUG
-		cout << "MboxHandler::checkMailAccount: not one of " << mailAccounts.size() << " accounts" << endl;
-#endif
-		return false;
-	}
-
-	// Find out when it was last modified
-	if ((stat(fileName.c_str(), &fileStat) == 0) &&
-		(!S_ISREG(fileStat.st_mode)))
-	{
-		// This is not a file !
-		return false;
-	}
-
-	// Is there a record for this mail account ?
-	if (m_history.hasItem("file://" + fileName, status, lastModDate) == true)
-	{
-		if (fileStat.st_mtime <= lastModDate)
-		{
-			// No change since last time...
-#ifdef DEBUG
-			cout << "MboxHandler::checkMailAccount: not modified since last time ("
-				<< lastModDate << ">" << fileStat.st_mtime << ")" << endl;
-#endif
-			return false;
-		}
-	}
-	else
-	{
-		m_history.insertItem("file://" + fileName, CrawlHistory::CRAWLING, m_sourceId, time(NULL));
-	}
-
-	// Update this mail account's properties
-	mailAccount = (*mailIter);
-	mailAccount.m_modTime = fileStat.st_mtime;
-
-	return true;
-}
-
-bool MboxHandler::indexMessages(const string &fileName, PinotSettings::TimestampedItem &mailAccount,
-	off_t mboxOffset)
-{
-	string sourceLabel("mailbox://");
-
-	// Come up with a label for this mbox file's messages
-	sourceLabel += fileName;
-
-	if (m_index.isGood() == false)
-	{
-		cerr << "MboxHandler::indexMessages: couldn't get mail index" << endl;
-		return false;
-	}
-
-	// Get the mbox filter
-	Dijon::Filter *pFilter = Dijon::FilterFactory::getFilter("application/mbox");
-	if (pFilter == NULL)
-	{
-		return false;
-	}
-
-	Document emptyDoc;
-	emptyDoc.setLocation(string("file://") + fileName);
-	if (FilterUtils::feedFilter(emptyDoc, pFilter) == false)
-	{
-		delete pFilter;
-		return false;
-	}
-
-	bool indexedFile = parseMailAccount(pFilter, sourceLabel);
-
-	delete pFilter;
-
-	// Flush the index
-	m_index.flush();
-
-	// Update this mail account's record
-	m_history.updateItem("file://" + fileName, CrawlHistory::CRAWLED, mailAccount.m_modTime);
-
-	return indexedFile;
-}
-
-bool MboxHandler::parseMailAccount(Dijon::Filter *pFilter, const string &sourceLabel)
-{
-	set<unsigned int> docIdList;
-	set<string> labels;
-	char sourceStr[64];
-	unsigned int docNum = 0;
-	bool indexedFile = false;
-#ifdef DEBUG
-	Timer timer;
-	timer.start();
-#endif
-
-	// Get a list of documents labeled with this source label
-	m_index.listDocumentsWithLabel(sourceLabel, docIdList); 
-
-	// This is the labels we'll apply to new documents
-	snprintf(sourceStr, 64, "SOURCE%u", m_sourceId);
-	labels.insert(sourceStr);
-	labels.insert(sourceLabel);
-
-	// Parse the mbox file
-	while (pFilter->next_document() == true)
-	{
-		Document currentMessage;
-
-		FilterUtils::populateDocument(currentMessage, pFilter);
-
-		// Has this message already been indexed ?
-		unsigned int docId = m_index.hasDocument(currentMessage.getLocation());
-		if (docId == 0)
-		{
-			m_index.setStemmingMode(IndexInterface::STORE_BOTH);
-
-			unsigned int docId = 0;
-			indexedFile = FilterWrapper::indexDocument(m_index, currentMessage, labels, docId);
-#ifdef DEBUG
-			if (indexedFile == false)
-			{
-				cout << "MboxHandler::parseMailAccount: couldn't index message " << docNum << endl;
-			}
-#endif
-		}
-		else
-		{
-#ifdef DEBUG
-			cout << "MboxHandler::parseMailAccount: already indexed message "
-				<< docNum << ", document ID " << docId << endl;
-#endif
-			set<unsigned int>::iterator docIter = docIdList.find(docId);
-			if (docIter != docIdList.end())
-			{
-				// Remove this document from the list
-				docIdList.erase(docIter);
-			}
-		}
-
-		++docNum;
-	}
-#ifdef DEBUG
-	cout << "MboxHandler::parseMailAccount: parsed " << docNum << " documents in "
-		<< timer.stop()/1000 << " ms" << endl;
-#endif
-
-	// Any document still in the list wasn't found this time around
-	// and should be unindexed
-	deleteMessages(docIdList);
-
-	return indexedFile;
-}
-
-bool MboxHandler::deleteMessages(set<unsigned int> &docIdList)
-{
-	bool unindexedMsgs = false;
-
-#ifdef DEBUG
-	cout << "MboxHandler::deleteMessages: " << docIdList.size() << " message(s) to unindex" << endl;
-#endif
-	for (set<unsigned int>::iterator docIter = docIdList.begin();
-		docIter != docIdList.end(); ++docIter)
-	{
-#ifdef DEBUG
-		cout << "MboxHandler::deleteMessages: unindexing document ID " << *docIter << endl;
-#endif
-		if (m_index.unindexDocument(*docIter) == true)
-		{
-			unindexedMsgs = true;
-		}
-	}
-
-	return unindexedMsgs;
-}
-
-void MboxHandler::initialize(void)
-{
-	set<string> mailboxes;
-
-	// Get the mail accounts map
-	set<PinotSettings::TimestampedItem> &mailAccounts = PinotSettings::getInstance().m_mailAccounts;
-	for (set<PinotSettings::TimestampedItem>::iterator mailIter = mailAccounts.begin();
-		mailIter != mailAccounts.end(); ++mailIter)
-	{
-		m_fileNames.insert(mailIter->m_name);
-	}
-
-	// Unindex messages that belong to mailboxes that no longer exist
-	if (m_history.getSourceItems(m_sourceId, CrawlHistory::CRAWLED, mailboxes) > 0)
-	{
-		for(set<string>::const_iterator mailIter = mailboxes.begin();
-			mailIter != mailboxes.end(); ++mailIter)
-		{
-			Url urlObj(*mailIter);
-
-			// Is this a file and does it still exist ?
-			if ((urlObj.getProtocol() == "file") &&
-				(m_fileNames.find(mailIter->substr(7)) == m_fileNames.end()))
-			{
-				string sourceLabel("mailbox://");
-
-				sourceLabel += urlObj.getLocation();
-				sourceLabel += "/";
-				sourceLabel += urlObj.getFile();
-
-#ifdef DEBUG
-				cout << "MboxHandler::initialize: removing messages with label "
-					<< sourceLabel << endl;
-#endif
-				// All documents with this label will be unindexed
-				m_index.unindexDocuments(sourceLabel, false);
-
-				// Delete this item
-				m_history.deleteItem(*mailIter);
-			}
-#ifdef DEBUG
-			else cout << "MboxHandler::initialize: " << *mailIter
-				<< " still configured for monitoring" << endl;
-#endif
-		}
-	}
-#ifdef DEBUG
-	cout << "MboxHandler::initialize: " << m_fileNames.size() << " mail accounts" << endl;
-#endif
-}
-
-void MboxHandler::flushIndex(void)
-{
-	// The index is flushed after indexing a mailbox
-}
-
-bool MboxHandler::fileExists(const string &fileName)
-{
-	PinotSettings::TimestampedItem mailAccount;
-
-#ifdef DEBUG
-	cout << "MboxHandler::fileExists: " << fileName << endl;
-#endif
-	if (checkMailAccount(fileName, mailAccount) == false)
-	{
-		return false;
-	}
-
-	return indexMessages(fileName, mailAccount, 0);
-}
-
-bool MboxHandler::fileCreated(const string &fileName)
-{
-	// Nothing to do here
-	return true;
-}
-
-bool MboxHandler::fileModified(const string &fileName)
-{
-	PinotSettings::TimestampedItem mailAccount;
-
-#ifdef DEBUG
-	cout << "MboxHandler::fileModified: " << fileName << " changed" << endl;
-#endif
-	if (checkMailAccount(fileName, mailAccount) == false)
-	{
-		return false;
-	}
-
-	// Parse the file in whole
-	return indexMessages(fileName, mailAccount, 0);
-}
-
-bool MboxHandler::fileMoved(const string &fileName, const string &previousFileName)
-{
-	// Nothing to do here
-	return true;
-}
-
-bool MboxHandler::directoryMoved(const string &dirName,
-	const string &previousDirName)
-{
-	// Nothing to do here
-	return true;
-}
-
-bool MboxHandler::fileDeleted(const string &fileName)
-{
-	set<unsigned int> docIdList;
-	string sourceLabel("mailbox://");
-
-	sourceLabel += fileName;
-
-	if (m_index.isGood() == false)
-	{
-		cerr << "MboxHandler::fileDeleted: couldn't get mail index" << endl;
-		return false;
-	}
-
-	// Get a list of documents labeled with this source label
-	if (m_index.listDocumentsWithLabel(sourceLabel, docIdList) == true)
-	{
-		// Unindex all documents labeled with this source label
-		deleteMessages(docIdList); 
-		// Delete the label
-		m_index.deleteLabel(sourceLabel);
-
-		return true;
-	}
-
-	return false;
-}
-
-bool MboxHandler::directoryDeleted(const string &dirName)
-{
-	// Nothing to do here
-	return true;
-}
-

Deleted: trunk/UI/GTK2/src/MboxHandler.h
===================================================================
--- trunk/UI/GTK2/src/MboxHandler.h	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/MboxHandler.h	2007-07-21 04:17:51 UTC (rev 874)
@@ -1,88 +0,0 @@
-/*
- *  Copyright 2005,2006 Fabrice Colin
- *
- *  This program is free software; you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation; either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  This program is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU Library General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with this program; if not, write to the Free Software
- *  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
- */
- 
-#ifndef _MBOXHANDLER_HH
-#define _MBOXHANDLER_HH
-
-#include <time.h>
-#include <string>
-#include <set>
-#include <sigc++/slot.h>
-
-#include "Filter.h"
-#include "CrawlHistory.h"
-#include "MonitorHandler.h"
-#include "XapianIndex.h"
-#include "PinotSettings.h"
-
-class MboxHandler : public MonitorHandler
-{
-	public:
-		MboxHandler();
-		virtual ~MboxHandler();
-
-		/// Initializes things before starting monitoring.
-		virtual void initialize(void);
-
-		/// Handles flushing the index.
-		virtual void flushIndex(void);
-
-		/// Handles file existence events.
-		virtual bool fileExists(const std::string &fileName);
-
-		/// Handles file creation events.
-		virtual bool fileCreated(const std::string &fileName);
-
-		/// Handles file modified events.
-		virtual bool fileModified(const std::string &fileName);
-
-		/// Handles file moved events.
-		virtual bool fileMoved(const std::string &fileName,
-			const std::string &previousFileName);
-
-		/// Handles directory moved events.
-		virtual bool directoryMoved(const std::string &dirName,
-			const std::string &previousDirName);
-
-		/// Handles file deleted events.
-		virtual bool fileDeleted(const std::string &fileName);
-
-		/// Handles directory deleted events.
-		virtual bool directoryDeleted(const std::string &dirName);
-
-	protected:
-		CrawlHistory m_history;
-		XapianIndex m_index;
-		unsigned int m_sourceId;
-
-		bool checkMailAccount(const std::string &fileName, PinotSettings::TimestampedItem &mailAccount);
-
-		bool indexMessages(const std::string &fileName, PinotSettings::TimestampedItem &mailAccount,
-			off_t mboxOffset);
-
-		bool parseMailAccount(Dijon::Filter *pFilter, const std::string &sourceLabel);
-
-		bool deleteMessages(std::set<unsigned int> &docIdList);
-
-	private:
-		MboxHandler(const MboxHandler &other);
-		MboxHandler &operator=(const MboxHandler &other);
-
-};
-
-#endif // _MBOXHANDLER_HH

Modified: trunk/UI/GTK2/src/OnDiskHandler.cpp
===================================================================
--- trunk/UI/GTK2/src/OnDiskHandler.cpp	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/OnDiskHandler.cpp	2007-07-21 04:17:51 UTC (rev 874)
@@ -116,15 +116,17 @@
 		pDoc = new Document(docInfo);
 	}
 
+	FilterWrapper wrapFilter(&m_index);
+
 	// Get an ad hoc tokenizer for the message
 	// Index or update ?
 	if (docId == 0)
 	{
-		indexedFile = FilterWrapper::indexDocument(m_index, *pDoc, labels, docId);
+		indexedFile = wrapFilter.indexDocument(*pDoc, labels, docId);
 	}
 	else
 	{
-		indexedFile = FilterWrapper::updateDocument(docId, m_index, *pDoc);
+		indexedFile = wrapFilter.updateDocument(*pDoc, docId);
 	}
 
 #ifdef DEBUG
@@ -141,8 +143,10 @@
 
 bool OnDiskHandler::replaceFile(unsigned int docId, DocumentInfo &docInfo)
 {
+	FilterWrapper wrapFilter(&m_index);
+
 	// Unindex the destination file
-	m_index.unindexDocument(docInfo.getLocation());
+	wrapFilter.unindexDocument(docInfo.getLocation());
 
 	// Update the document info
 	return m_index.updateDocumentInfo(docId, docInfo);
@@ -186,7 +190,7 @@
 					<< ", source " << sourceId << " was removed" << endl;
 #endif
 				// All documents with this label will be unindexed
-				if (m_index.unindexDocuments(sourceStr, false) == true)
+				if (m_index.unindexDocuments(sourceStr, IndexInterface::BY_LABEL) == true)
 				{
 					// Delete the source itself and all its items
 					m_history.deleteSource(sourceId);
@@ -326,20 +330,23 @@
 
 bool OnDiskHandler::fileDeleted(const string &fileName)
 {
+	FilterWrapper wrapFilter(&m_index);
+	string location("file://");
 	bool handledEvent = true;
 
 #ifdef DEBUG
 	cout << "OnDiskHandler::fileDeleted: " << fileName << endl;
 #endif
+	location += fileName;
 	pthread_mutex_lock(&m_mutex);
-	unsigned int docId = m_index.hasDocument(string("file://") + fileName);
+	unsigned int docId = m_index.hasDocument(location);
 	if (docId > 0)
 	{
 		// Unindex the file
-		handledEvent = m_index.unindexDocument(docId);
+		handledEvent = wrapFilter.unindexDocument(location);
 		if (handledEvent == true)
 		{
-			m_history.deleteItem(string("file://") + fileName);
+			m_history.deleteItem(location);
 		}
 	}
 	pthread_mutex_unlock(&m_mutex);
@@ -356,7 +363,7 @@
 	cout << "OnDiskHandler::directoryDeleted: " << dirName << endl;
 #endif
 	pthread_mutex_lock(&m_mutex);
-	if (m_index.unindexDocuments(dirName, true) == true)
+	if (m_index.unindexDocuments(dirName, IndexInterface::BY_DIRECTORY) == true)
 	{
 		m_history.deleteItems(string("file://") + dirName);
 		handledEvent = true;

Modified: trunk/UI/GTK2/src/PinotSettings.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.cpp	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/PinotSettings.cpp	2007-07-21 04:17:51 UTC (rev 874)
@@ -104,6 +104,7 @@
 	m_newResultsColourBlue(0),
 	m_proxyPort(8080),
 	m_proxyEnabled(false),
+	m_isBlackList(true),
 	m_firstRun(false)
 {
 	string directoryName(getConfigurationDirectory());
@@ -252,9 +253,8 @@
 	m_engineIds.clear();
 	m_queries.clear();
 	m_labels.clear();
-	m_mailAccounts.clear();
 	m_indexableLocations.clear();
-	m_filePatternsBlackList.clear();
+	m_filePatternsList.clear();
 	m_cacheProviders.clear();
 }
 
@@ -289,25 +289,25 @@
 		m_labels.insert(_("New"));
 		m_labels.insert(_("Personal"));
 		// Skip common image, video and archive types
-		m_filePatternsBlackList.insert("*.Z");
-		m_filePatternsBlackList.insert("*.avi");
-		m_filePatternsBlackList.insert("*.asf");
-		m_filePatternsBlackList.insert("*.gif");
-		m_filePatternsBlackList.insert("*.iso");
-		m_filePatternsBlackList.insert("*.jpeg");
-		m_filePatternsBlackList.insert("*.jpg");
-		m_filePatternsBlackList.insert("*.lha");
-		m_filePatternsBlackList.insert("*.mov");
-		m_filePatternsBlackList.insert("*.msf");
-		m_filePatternsBlackList.insert("*.mpeg");
-		m_filePatternsBlackList.insert("*.mpg");
-		m_filePatternsBlackList.insert("*.png");
-		m_filePatternsBlackList.insert("*.rar");
-		m_filePatternsBlackList.insert("*.sh");
-		m_filePatternsBlackList.insert("*.tiff");
-		m_filePatternsBlackList.insert("*.wmv");
-		m_filePatternsBlackList.insert("*.xbm");
-		m_filePatternsBlackList.insert("*.xpm");
+		m_filePatternsList.insert("*.Z");
+		m_filePatternsList.insert("*.avi");
+		m_filePatternsList.insert("*.asf");
+		m_filePatternsList.insert("*.gif");
+		m_filePatternsList.insert("*.iso");
+		m_filePatternsList.insert("*.jpeg");
+		m_filePatternsList.insert("*.jpg");
+		m_filePatternsList.insert("*.lha");
+		m_filePatternsList.insert("*.mov");
+		m_filePatternsList.insert("*.msf");
+		m_filePatternsList.insert("*.mpeg");
+		m_filePatternsList.insert("*.mpg");
+		m_filePatternsList.insert("*.png");
+		m_filePatternsList.insert("*.rar");
+		m_filePatternsList.insert("*.sh");
+		m_filePatternsList.insert("*.tiff");
+		m_filePatternsList.insert("*.wmv");
+		m_filePatternsList.insert("*.xbm");
+		m_filePatternsList.insert("*.xpm");
 	}
 
 	// Some search engines are hardcoded
@@ -446,15 +446,12 @@
 				{
 					loadProxy(pElem);
 				}
-				else if (nodeName == "mailaccount")
-				{
-					loadMailAccounts(pElem);
-				}
 				else if (nodeName == "indexable")
 				{
 					loadIndexableLocations(pElem);
 				}
-				else if (nodeName == "blacklist")
+				else if ((nodeName == "blacklist") ||
+					(nodeName == "patterns"))
 				{
 					loadFilePatterns(pElem);
 				}
@@ -941,52 +938,6 @@
 	return true;
 }
 
-bool PinotSettings::loadMailAccounts(const Element *pElem)
-{
-	if (pElem == NULL)
-	{
-		return false;
-	}
-
-	Node::NodeList childNodes = pElem->get_children();
-	if (childNodes.empty() == true)
-	{
-		return false;
-	}
-
-	TimestampedItem mailAccount;
-
-	// Load the mail account's properties
-	for (Node::NodeList::iterator iter = childNodes.begin(); iter != childNodes.end(); ++iter)
-	{
-		Node *pNode = (*iter);
-		Element *pElem = dynamic_cast<Element*>(pNode);
-		if (pElem == NULL)
-		{
-			continue;
-		}
-
-		string nodeName = pElem->get_name();
-		string nodeContent = getElementContent(pElem);
-
-		if (nodeName == "name")
-		{
-			mailAccount.m_name = nodeContent;
-		}
-		else if (nodeName == "mtime")
-		{
-			mailAccount.m_modTime = (time_t)atoi(nodeContent.c_str());
-		}
-	}
-
-	if (mailAccount.m_name.empty() == false)
-	{
-		m_mailAccounts.insert(mailAccount);
-	}
-
-	return true;
-}
-
 bool PinotSettings::loadIndexableLocations(const Element *pElem)
 {
 	if (pElem == NULL)
@@ -1068,8 +1019,19 @@
 
 		if (nodeName == "pattern")
 		{
-			m_filePatternsBlackList.insert(nodeContent);
+			m_filePatternsList.insert(nodeContent);
 		}
+		else if (nodeName == "forbid")
+		{
+			if (nodeContent == "YES")
+			{
+				m_isBlackList = true;
+			}
+			else
+			{
+				m_isBlackList = false;
+			}
+		}
 	}
 
 	return true;
@@ -1336,18 +1298,6 @@
 	addChildElement(pElem, "port", numStr);
 	addChildElement(pElem, "type", m_proxyType);
 	addChildElement(pElem, "enable", (m_proxyEnabled ? "YES" : "NO"));
-	// Mail accounts
-	for (set<TimestampedItem>::iterator mailIter = m_mailAccounts.begin(); mailIter != m_mailAccounts.end(); ++mailIter)
-	{
-		pElem = pRootElem->add_child("mailaccount");
-		if (pElem == NULL)
-		{
-			return false;
-		}
-		addChildElement(pElem, "name", mailIter->m_name);
-		sprintf(numStr, "%ld", mailIter->m_modTime);
-		addChildElement(pElem, "mtime", numStr);
-	}
 	// Locations to index 
 	for (set<IndexableLocation>::iterator locationIter = m_indexableLocations.begin(); locationIter != m_indexableLocations.end(); ++locationIter)
 	{
@@ -1359,16 +1309,17 @@
 		addChildElement(pElem, "name", locationIter->m_name);
 		addChildElement(pElem, "monitor", (locationIter->m_monitor ? "YES" : "NO"));
 	}
-	// File patterns that are blacklisted
-	pElem = pRootElem->add_child("blacklist");
+	// File patterns
+	pElem = pRootElem->add_child("patterns");
 	if (pElem == NULL)
 	{
 		return false;
 	}
-	for (set<ustring>::iterator patternIter = m_filePatternsBlackList.begin(); patternIter != m_filePatternsBlackList.end() ; ++patternIter)
+	for (set<ustring>::iterator patternIter = m_filePatternsList.begin(); patternIter != m_filePatternsList.end() ; ++patternIter)
 	{
 		addChildElement(pElem, "pattern", *patternIter);
 	}
+	addChildElement(pElem, "forbid", (m_isBlackList ? "YES" : "NO"));
 
 	// Save to file
 	doc.write_to_file_formatted(getConfigurationFileName());
@@ -1661,24 +1612,32 @@
 /// Determines if a file matches the blacklist.
 bool PinotSettings::isBlackListed(const string &fileName)
 {
-	if (m_filePatternsBlackList.empty() == true)
+	if (m_filePatternsList.empty() == true)
 	{
-		return false;
+		if (m_isBlackList == true)
+		{
+			// There is no black-list
+			return false;
+		}
+
+		// The file is not in the (empty) whitelist
+		return true;
 	}
 
 	// Any pattern matches this file name ?
-	for (set<ustring>::iterator patternIter = m_filePatternsBlackList.begin(); patternIter != m_filePatternsBlackList.end() ; ++patternIter)
+	for (set<ustring>::iterator patternIter = m_filePatternsList.begin(); patternIter != m_filePatternsList.end() ; ++patternIter)
 	{
 		if (fnmatch(patternIter->c_str(), fileName.c_str(), FNM_NOESCAPE) == 0)
 		{
 #ifdef DEBUG
 			cout << "PinotSettings::isBlackListed: " << fileName << " matches " << *patternIter << endl;
 #endif
-			return true;
+			// Fail if it's in the blacklist, let the file through otherwise
+			return m_isBlackList;
 		}
 	}
 
-	return false;
+	return !m_isBlackList;
 }
 
 PinotSettings::Engine::Engine()

Modified: trunk/UI/GTK2/src/PinotSettings.h
===================================================================
--- trunk/UI/GTK2/src/PinotSettings.h	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/PinotSettings.h	2007-07-21 04:17:51 UTC (rev 874)
@@ -210,9 +210,9 @@
 		unsigned int m_proxyPort;
 		Glib::ustring  m_proxyType;
 		bool m_proxyEnabled;
-		std::set<TimestampedItem> m_mailAccounts;
 		std::set<IndexableLocation> m_indexableLocations;
-		std::set<Glib::ustring> m_filePatternsBlackList;
+		std::set<Glib::ustring> m_filePatternsList;
+		bool m_isBlackList;
 		std::vector<CacheProvider> m_cacheProviders;
 		std::set<Glib::ustring> m_cacheProtocols;
 
@@ -237,7 +237,6 @@
 		bool loadLabels(const xmlpp::Element *pElem);
 		bool loadColour(const xmlpp::Element *pElem);
 		bool loadProxy(const xmlpp::Element *pElem);
-		bool loadMailAccounts(const xmlpp::Element *pElem);
 		bool loadIndexableLocations(const xmlpp::Element *pElem);
 		bool loadFilePatterns(const xmlpp::Element *pElem);
 		bool loadCacheProviders(const xmlpp::Element *pElem);

Modified: trunk/UI/GTK2/src/ServerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/ServerThreads.cpp	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/ServerThreads.cpp	2007-07-21 04:17:51 UTC (rev 874)
@@ -34,6 +34,7 @@
 #include <glibmm/miscutils.h>
 
 #include "Languages.h"
+#include "MIMEScanner.h"
 #include "TimeConverter.h"
 #include "Timer.h"
 #include "Url.h"
@@ -681,6 +682,11 @@
 			{
 				docInfo.setType("x-directory/normal");
 			}
+			else
+			{
+				// We might as well scan the file for its type now
+				docInfo.setType(MIMEScanner::scanFile(entryName));
+			}
 			docInfo.setTimestamp(TimeConverter::toTimestamp(fileStat.st_mtime));
 			docInfo.setSize(fileStat.st_size);
 
@@ -751,7 +757,7 @@
 			}
 		}
 	}
-	cout << "Scanned " << m_dirName << " in " << scanTimer.stop()/1000 << " ms" << endl;
+	cout << "Scanned " << m_dirName << " in " << scanTimer.stop() << " ms" << endl;
 }
 
 DBusServletThread::DBusServletThread(DaemonState *pServer, DBusConnection *pConnection, DBusMessage *pRequest) :

Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2007-07-21 04:17:51 UTC (rev 874)
@@ -18,6 +18,7 @@
 
 #include <unistd.h>
 #include <stdlib.h>
+#include <stdio.h>
 #include <fcntl.h>
 #include <string.h>
 #include <signal.h>
@@ -41,6 +42,7 @@
 #include "DBusXapianIndex.h"
 #include "XapianDatabase.h"
 #include "ActionQueue.h"
+#include "CrawlHistory.h"
 #include "QueryHistory.h"
 #include "DownloaderFactory.h"
 #include "SearchEngineFactory.h"
@@ -1448,13 +1450,16 @@
 
 		if (m_done == false)
 		{
+			FilterWrapper wrapFilter(pIndex);
+			const set<string> &labels = m_docInfo.getLabels();
+
 			pIndex->setStemmingMode(IndexInterface::STORE_BOTH);
 
 			// Update an existing document or add to the index ?
 			if (m_update == true)
 			{
 				// Update the document
-				if (FilterWrapper::updateDocument(m_docId, *pIndex, *m_pDoc) == true)
+				if (wrapFilter.updateDocument(*m_pDoc, m_docId) == true)
 				{
 #ifdef DEBUG
 					cout << "IndexingThread::doWork: updated " << m_pDoc->getLocation()
@@ -1468,11 +1473,10 @@
 			}
 			else
 			{
-				const set<string> &labels = m_docInfo.getLabels();
 				unsigned int docId = 0;
 
 				// Index the document
-				success = FilterWrapper::indexDocument(*pIndex, *m_pDoc, labels, docId);
+				success = wrapFilter.indexDocument(*m_pDoc, labels, docId);
 				if (success == true)
 				{
 					m_docId = docId;
@@ -1583,7 +1587,7 @@
 
 			// By unindexing all documents that match the label,
 			// we effectively delete the label from the index
-			if (pIndex->unindexDocuments(labelName, false) == true)
+			if (pIndex->unindexDocuments(labelName, IndexInterface::BY_LABEL) == true)
 			{
 #ifdef DEBUG
 				cout << "UnindexingThread::doWork: removed label " << labelName << endl;

Modified: trunk/UI/GTK2/src/prefsDialog.cc
===================================================================
--- trunk/UI/GTK2/src/prefsDialog.cc	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/prefsDialog.cc	2007-07-21 04:17:51 UTC (rev 874)
@@ -92,14 +92,6 @@
 	directoriesTreeview->get_selection()->set_mode(SELECTION_SINGLE);
 	populate_directoriesTreeview();
 
-	// Associate the columns model to the mail accounts tree
-	m_refMailTree = ListStore::create(m_mailColumns);
-	mailTreeview->set_model(m_refMailTree);
-	mailTreeview->append_column(_("Location"), m_mailColumns.m_location);
-	// Allow only single selection
-	mailTreeview->get_selection()->set_mode(SELECTION_SINGLE);
-	populate_mailTreeview();
-
 	// Associate the columns model to the file patterns tree
 	m_refPatternsTree = ListStore::create(m_patternsColumns);
 	patternsTreeview->set_model(m_refPatternsTree);
@@ -107,6 +99,14 @@
 	// Allow only single selection
 	patternsTreeview->get_selection()->set_mode(SELECTION_SINGLE);
 	populate_patternsTreeview();
+	if (m_settings.m_isBlackList == true)
+	{
+		patternsCombobox->set_active(0);
+	}
+	else
+	{
+		patternsCombobox->set_active(1);
+	}
 
 	// Hide the Google API entry field ?
 	if (SearchEngineFactory::isSupported("googleapi") == false)
@@ -289,84 +289,12 @@
 	return startService;
 }
 
-void prefsDialog::populate_mailTreeview()
-{
-	TreeModel::iterator iter;
-	TreeModel::Row row;
-
-	if (m_settings.m_mailAccounts.empty() == true)
-	{
-		// This button will stay disabled until mail is added to the list
-		removeAccountButton->set_sensitive(false);
-		return;
-	}
-
-	// Populate the tree
-	for (set<PinotSettings::TimestampedItem>::iterator mailIter = m_settings.m_mailAccounts.begin();
-		mailIter != m_settings.m_mailAccounts.end();
-		++mailIter)
-	{
-		// Create a new row
-		iter = m_refMailTree->append();
-		row = *iter;
-		// Set its name, type and minium date
-		row[m_mailColumns.m_location] = mailIter->m_name;
-		row[m_mailColumns.m_mTime] = mailIter->m_modTime;
-	}
-
-	removeAccountButton->set_sensitive(true);
-}
-
-bool prefsDialog::save_mailTreeview()
-{
-	bool startService = false;
-
-	// Clear the current settings
-	m_settings.m_mailAccounts.clear();
-
-	// Go through the mail accounts tree
-	TreeModel::Children children = m_refMailTree->children();
-	if (children.empty() == false)
-	{
-		TreeModel::Children::iterator iter = children.begin();
-		for (; iter != children.end(); ++iter)
-		{
-			TreeModel::Row row = *iter;
-			PinotSettings::TimestampedItem mailAccount;
-
-			// FIXME: unlike libmagic, shared-mime-info fails to identify most mbox files
-			// as being of type text/x-mail
-			// Add this new mail account to the settings
-			mailAccount.m_name = row[m_mailColumns.m_location];
-			mailAccount.m_modTime = row[m_mailColumns.m_mTime];
-
-			string mailLabel("mailbox://");
-			mailLabel += from_utf8(mailAccount.m_name);
-
-			// Check user didn't recreate this mail account after having deleted it
-			set<string>::iterator mailIter = m_deletedMail.find(mailLabel);
-			if (mailIter != m_deletedMail.end())
-			{
-				m_deletedMail.erase(mailIter);
-			}
-
-#ifdef DEBUG
-			cout << "prefsDialog::save_mailTreeview: " << mailAccount.m_name << endl;
-#endif
-			m_settings.m_mailAccounts.insert(mailAccount);
-			startService = true;
-		}
-	}
-
-	return startService;
-}
-
 void prefsDialog::populate_patternsTreeview()
 {
 	TreeModel::iterator iter;
 	TreeModel::Row row;
 
-	if (m_settings.m_filePatternsBlackList.empty() == true)
+	if (m_settings.m_filePatternsList.empty() == true)
 	{
 		// This button will stay disabled until a ppatern is added to the list
 		removePatternButton->set_sensitive(false);
@@ -374,8 +302,8 @@
 	}
 
 	// Populate the tree
-	for (set<ustring>::iterator patternIter = m_settings.m_filePatternsBlackList.begin();
-		patternIter != m_settings.m_filePatternsBlackList.end();
+	for (set<ustring>::iterator patternIter = m_settings.m_filePatternsList.begin();
+		patternIter != m_settings.m_filePatternsList.end();
 		++patternIter)
 	{
 		// Create a new row
@@ -384,6 +312,8 @@
 		// Set its name
 		row[m_patternsColumns.m_location] = *patternIter;
 	}
+	patternsCombobox->append_text(_("Exclude these patterns from indexing"));
+	patternsCombobox->append_text(_("Only index these patterns"));
 
 	removePatternButton->set_sensitive(true);
 }
@@ -391,7 +321,7 @@
 void prefsDialog::save_patternsTreeview()
 {
 	// Clear the current settings
-	m_settings.m_filePatternsBlackList.clear();
+	m_settings.m_filePatternsList.clear();
 
 	// Go through the file patterns tree
 	TreeModel::Children children = m_refPatternsTree->children();
@@ -405,10 +335,18 @@
 
 			if (pattern.empty() == false)
 			{
-				m_settings.m_filePatternsBlackList.insert(pattern);
+				m_settings.m_filePatternsList.insert(pattern);
 			}
 		}
 	}
+	if (patternsCombobox->get_active_row_number() == 0)
+	{
+		m_settings.m_isBlackList = true;
+	}
+	else
+	{
+		m_settings.m_isBlackList = false;
+	}
 }
 
 void prefsDialog::on_prefsOkbutton_clicked()
@@ -442,10 +380,8 @@
 	// Validate the current lists
 	save_labelsTreeview();
 	bool startForDirectories = save_directoriesTreeview();
-	bool startForMail = save_mailTreeview();
 	save_patternsTreeview();
-	if ((startForDirectories == true) ||
-		(startForMail == true))
+	if (startForDirectories == true)
 	{
 		// Save the settings
 		m_settings.save();
@@ -559,63 +495,21 @@
 	}
 }
 
-void prefsDialog::on_addAccountButton_clicked()
+void prefsDialog::on_patternsCombobox_changed ()
 {
-	ustring fileName;
+	int activeRow = patternsCombobox->get_active_row_number();
 
-	TreeModel::Children children = m_refMailTree->children();
-	bool wasEmpty = children.empty();
-
-	if (select_file_name(_("Mbox File Location"), fileName, true) == true)
+	if (((activeRow == 0) && (m_settings.m_isBlackList == true)) ||
+		((activeRow > 0) && (m_settings.m_isBlackList == false)))
 	{
-#ifdef DEBUG
-		cout << "prefsDialog::on_addAccountButton_clicked: " << fileName << endl;
-#endif
-		// FIXME: unlike libmagic, shared-mime-info fails to identify most mbox files
-		// as being of type text/x-mail
-		// Create a new entry in the mail accounts list
-		TreeModel::iterator iter = m_refMailTree->append();
-		TreeModel::Row row = *iter;
-	
-		row[m_mailColumns.m_location] = to_utf8(fileName);
-		row[m_mailColumns.m_mTime] = time(NULL);
-
-		if (wasEmpty == true)
-		{
-			// Enable this button
-			removeAccountButton->set_sensitive(true);
-		}
+		// No change
+		return;
 	}
-}
 
-void prefsDialog::on_removeAccountButton_clicked()
-{
-	// Get the selected mail account in the list
-	TreeModel::iterator iter = mailTreeview->get_selection()->get_selected();
-	if (iter)
-	{
-		string mailLabel("mailbox://");
-
-		// Unselect
-		mailTreeview->get_selection()->unselect(iter);
-		// Select another row
-		TreeModel::Path path = m_refMailTree->get_path(iter);
-		path.next();
-		mailTreeview->get_selection()->select(path);
-
-		// Erase
-		TreeModel::Row row = *iter;
-		mailLabel += from_utf8(row[m_mailColumns.m_location]);
-		m_deletedMail.insert(mailLabel);
-		m_refMailTree->erase(row);
-
-		TreeModel::Children children = m_refMailTree->children();
-		if (children.empty() == true)
-		{
-			// Disable this button
-			removeAccountButton->set_sensitive(false);
-		}
-	}
+	// Unselect results
+	patternsTreeview->get_selection()->unselect_all();
+	// Remove all patterns in order to make sure the user enters a new bunch
+	m_refPatternsTree->clear();
 }
 
 void prefsDialog::on_addPatternButton_clicked()

Modified: trunk/UI/GTK2/src/prefsDialog.hh
===================================================================
--- trunk/UI/GTK2/src/prefsDialog.hh	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/prefsDialog.hh	2007-07-21 04:17:51 UTC (rev 874)
@@ -49,8 +49,7 @@
 	virtual void on_removeLabelButton_clicked();
 	virtual void on_addDirectoryButton_clicked();
 	virtual void on_removeDirectoryButton_clicked();
-	virtual void on_addAccountButton_clicked();
-	virtual void on_removeAccountButton_clicked();
+	virtual void on_patternsCombobox_changed();
 	virtual void on_addPatternButton_clicked();
 	virtual void on_removePatternButton_clicked();
 
@@ -59,8 +58,6 @@
 	void save_labelsTreeview();
 	void populate_directoriesTreeview();
 	bool save_directoriesTreeview();
-	void populate_mailTreeview();
-	bool save_mailTreeview();
 	void populate_patternsTreeview();
 	void save_patternsTreeview();
 
@@ -72,13 +69,11 @@
 	IndexableModelColumns m_directoriesColumns;
 	Glib::RefPtr<Gtk::ListStore> m_refDirectoriesTree;
 	TimestampedModelColumns m_mailColumns;
-	Glib::RefPtr<Gtk::ListStore> m_refMailTree;
 	TimestampedModelColumns m_patternsColumns;
 	Glib::RefPtr<Gtk::ListStore> m_refPatternsTree;
 	std::set<std::string> m_deletedLabels;
 	std::map<std::string, std::string> m_renamedLabels;
 	std::set<std::string> m_deletedDirectories;
-	std::set<std::string> m_deletedMail;
 	bool m_startDaemon;
 
 };

Modified: trunk/UI/GTK2/src/prefsDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/prefsDialog_glade.cc	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/prefsDialog_glade.cc	2007-07-21 04:17:51 UTC (rev 874)
@@ -1,9 +1,9 @@
-// generated 2007/3/23 21:55:56 SGT by fabrice at amra.dyndns.org.(none)
+// generated 2007/7/10 19:55:24 SGT by fabrice at amra.dyndns.org.(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
 // glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
-// for gtk 2.10.8 and gtkmm 2.10.7
+// for gtk 2.10.13 and gtkmm 2.10.9
 //
 // Please modify the corresponding derived classes in ./src/prefsDialog.cc
 
@@ -124,23 +124,13 @@
    
    Gtk::VButtonBox *directoriesVbuttonbox = Gtk::manage(new class Gtk::VButtonBox(Gtk::BUTTONBOX_START, 0));
    Gtk::HBox *directoriesHbox = Gtk::manage(new class Gtk::HBox(false, 0));
-   Gtk::Label *mailAccountsLabel = Gtk::manage(new class Gtk::Label(_("Mail boxes of type mbox can be monitored and indexed:")));
-   mailTreeview = Gtk::manage(new class Gtk::TreeView());
-   
-   Gtk::ScrolledWindow *mailScrolledwindow = Gtk::manage(new class Gtk::ScrolledWindow());
-   Gtk::Image *image497 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-add"), Gtk::IconSize(4)));
-   Gtk::Label *label49 = Gtk::manage(new class Gtk::Label(_("Add")));
-   Gtk::HBox *hbox42 = Gtk::manage(new class Gtk::HBox(false, 2));
-   Gtk::Alignment *alignment28 = Gtk::manage(new class Gtk::Alignment(0.5, 0.5, 0, 0));
-   addAccountButton = Gtk::manage(new class Gtk::Button());
-   removeAccountButton = Gtk::manage(new class Gtk::Button(Gtk::StockID("gtk-remove")));
-   
-   Gtk::VButtonBox *mailVbuttonbox = Gtk::manage(new class Gtk::VButtonBox(Gtk::BUTTONBOX_START, 0));
-   Gtk::HBox *mailHbox = Gtk::manage(new class Gtk::HBox(false, 0));
-   Gtk::Label *patternsLabel = Gtk::manage(new class Gtk::Label(_("Specify any file pattern you wish to exclude from indexing:")));
+   Gtk::Label *patternsLabel = Gtk::manage(new class Gtk::Label(_("File patterns:")));
    patternsTreeview = Gtk::manage(new class Gtk::TreeView());
    
    Gtk::ScrolledWindow *patternsScrolledwindow = Gtk::manage(new class Gtk::ScrolledWindow());
+   patternsCombobox = Gtk::manage(new class Gtk::ComboBoxText());
+   
+   Gtk::VBox *patternsVbox = Gtk::manage(new class Gtk::VBox(false, 0));
    Gtk::Image *image624 = Gtk::manage(new class Gtk::Image(Gtk::StockID("gtk-add"), Gtk::IconSize(4)));
    Gtk::Label *label60 = Gtk::manage(new class Gtk::Label(_("Add")));
    Gtk::HBox *hbox56 = Gtk::manage(new class Gtk::HBox(false, 2));
@@ -433,55 +423,6 @@
    directoriesVbuttonbox->pack_start(*removeDirectoryButton);
    directoriesHbox->pack_start(*directoriesScrolledwindow);
    directoriesHbox->pack_start(*directoriesVbuttonbox, Gtk::PACK_SHRINK, 0);
-   mailAccountsLabel->set_alignment(0,0.5);
-   mailAccountsLabel->set_padding(4,4);
-   mailAccountsLabel->set_justify(Gtk::JUSTIFY_LEFT);
-   mailAccountsLabel->set_line_wrap(true);
-   mailAccountsLabel->set_use_markup(false);
-   mailAccountsLabel->set_selectable(false);
-   mailAccountsLabel->set_ellipsize(Pango::ELLIPSIZE_NONE);
-   mailAccountsLabel->set_width_chars(-1);
-   mailAccountsLabel->set_angle(0);
-   mailAccountsLabel->set_single_line_mode(false);
-   mailTreeview->set_flags(Gtk::CAN_FOCUS);
-   mailTreeview->set_headers_visible(true);
-   mailTreeview->set_rules_hint(false);
-   mailTreeview->set_reorderable(false);
-   mailTreeview->set_enable_search(true);
-   mailScrolledwindow->set_flags(Gtk::CAN_FOCUS);
-   mailScrolledwindow->set_border_width(4);
-   mailScrolledwindow->set_shadow_type(Gtk::SHADOW_NONE);
-   mailScrolledwindow->set_policy(Gtk::POLICY_AUTOMATIC, Gtk::POLICY_AUTOMATIC);
-   mailScrolledwindow->property_window_placement().set_value(Gtk::CORNER_TOP_LEFT);
-   mailScrolledwindow->add(*mailTreeview);
-   image497->set_alignment(0.5,0.5);
-   image497->set_padding(0,0);
-   label49->set_alignment(0.5,0.5);
-   label49->set_padding(0,0);
-   label49->set_justify(Gtk::JUSTIFY_LEFT);
-   label49->set_line_wrap(false);
-   label49->set_use_markup(false);
-   label49->set_selectable(false);
-   label49->set_ellipsize(Pango::ELLIPSIZE_NONE);
-   label49->set_width_chars(-1);
-   label49->set_angle(0);
-   label49->set_single_line_mode(false);
-   hbox42->pack_start(*image497, Gtk::PACK_SHRINK, 0);
-   hbox42->pack_start(*label49, Gtk::PACK_SHRINK, 0);
-   alignment28->add(*hbox42);
-   addAccountButton->set_flags(Gtk::CAN_FOCUS);
-   addAccountButton->set_flags(Gtk::CAN_DEFAULT);
-   addAccountButton->set_border_width(4);
-   addAccountButton->set_relief(Gtk::RELIEF_NORMAL);
-   addAccountButton->add(*alignment28);
-   removeAccountButton->set_flags(Gtk::CAN_FOCUS);
-   removeAccountButton->set_flags(Gtk::CAN_DEFAULT);
-   removeAccountButton->set_border_width(4);
-   removeAccountButton->set_relief(Gtk::RELIEF_NORMAL);
-   mailVbuttonbox->pack_start(*addAccountButton);
-   mailVbuttonbox->pack_start(*removeAccountButton);
-   mailHbox->pack_start(*mailScrolledwindow);
-   mailHbox->pack_start(*mailVbuttonbox, Gtk::PACK_SHRINK, 0);
    patternsLabel->set_alignment(0,0.5);
    patternsLabel->set_padding(4,4);
    patternsLabel->set_justify(Gtk::JUSTIFY_LEFT);
@@ -503,6 +444,8 @@
    patternsScrolledwindow->set_policy(Gtk::POLICY_AUTOMATIC, Gtk::POLICY_AUTOMATIC);
    patternsScrolledwindow->property_window_placement().set_value(Gtk::CORNER_TOP_LEFT);
    patternsScrolledwindow->add(*patternsTreeview);
+   patternsVbox->pack_start(*patternsScrolledwindow);
+   patternsVbox->pack_start(*patternsCombobox, Gtk::PACK_EXPAND_WIDGET, 4);
    image624->set_alignment(0.5,0.5);
    image624->set_padding(0,0);
    label60->set_alignment(0.5,0.5);
@@ -529,14 +472,12 @@
    removePatternButton->set_relief(Gtk::RELIEF_NORMAL);
    patternsVbuttonbox->pack_start(*addPatternButton);
    patternsVbuttonbox->pack_start(*removePatternButton);
-   patternsHbox->pack_start(*patternsScrolledwindow);
+   patternsHbox->pack_start(*patternsVbox);
    patternsHbox->pack_start(*patternsVbuttonbox, Gtk::PACK_SHRINK, 0);
    indexingVbox->pack_start(*directoriesLabel, Gtk::PACK_SHRINK, 4);
    indexingVbox->pack_start(*directoriesHbox, Gtk::PACK_EXPAND_WIDGET, 4);
-   indexingVbox->pack_start(*mailAccountsLabel, Gtk::PACK_SHRINK, 4);
-   indexingVbox->pack_start(*mailHbox, Gtk::PACK_EXPAND_WIDGET, 4);
    indexingVbox->pack_start(*patternsLabel, Gtk::PACK_SHRINK, 4);
-   indexingVbox->pack_start(*patternsHbox);
+   indexingVbox->pack_start(*patternsHbox, Gtk::PACK_EXPAND_WIDGET, 4);
    indexingLabel->set_alignment(0.5,0.5);
    indexingLabel->set_padding(0,0);
    indexingLabel->set_justify(Gtk::JUSTIFY_LEFT);
@@ -622,20 +563,11 @@
    removeDirectoryButton->show();
    directoriesVbuttonbox->show();
    directoriesHbox->show();
-   mailAccountsLabel->show();
-   mailTreeview->show();
-   mailScrolledwindow->show();
-   image497->show();
-   label49->show();
-   hbox42->show();
-   alignment28->show();
-   addAccountButton->show();
-   removeAccountButton->show();
-   mailVbuttonbox->show();
-   mailHbox->show();
    patternsLabel->show();
    patternsTreeview->show();
    patternsScrolledwindow->show();
+   patternsCombobox->show();
+   patternsVbox->show();
    image624->show();
    label60->show();
    hbox56->show();
@@ -654,8 +586,7 @@
    removeLabelButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_removeLabelButton_clicked), false);
    addDirectoryButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_addDirectoryButton_clicked), false);
    removeDirectoryButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_removeDirectoryButton_clicked), false);
-   addAccountButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_addAccountButton_clicked), false);
-   removeAccountButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_removeAccountButton_clicked), false);
+   patternsCombobox->signal_changed().connect(SigC::slot(*this, &prefsDialog_glade::on_patternsCombobox_changed), false);
    addPatternButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_addPatternButton_clicked), false);
    removePatternButton->signal_clicked().connect(SigC::slot(*this, &prefsDialog_glade::on_removePatternButton_clicked), false);
 }

Modified: trunk/UI/GTK2/src/prefsDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/prefsDialog_glade.hh	2007-07-21 04:09:30 UTC (rev 873)
+++ trunk/UI/GTK2/src/prefsDialog_glade.hh	2007-07-21 04:17:51 UTC (rev 874)
@@ -1,9 +1,9 @@
-// generated 2007/3/23 21:55:56 SGT by fabrice at amra.dyndns.org.(none)
+// generated 2007/7/10 19:55:24 SGT by fabrice at amra.dyndns.org.(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
 // glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
-// for gtk 2.10.8 and gtkmm 2.10.7
+// for gtk 2.10.13 and gtkmm 2.10.9
 //
 // Please modify the corresponding derived classes in ./src/prefsDialog.hh and./src/prefsDialog.cc
 
@@ -69,10 +69,8 @@
         class Gtk::TreeView * directoriesTreeview;
         class Gtk::Button * addDirectoryButton;
         class Gtk::Button * removeDirectoryButton;
-        class Gtk::TreeView * mailTreeview;
-        class Gtk::Button * addAccountButton;
-        class Gtk::Button * removeAccountButton;
         class Gtk::TreeView * patternsTreeview;
+        class Gtk::ComboBoxText * patternsCombobox;
         class Gtk::Button * addPatternButton;
         class Gtk::Button * removePatternButton;
         class Gtk::Notebook * prefsNotebook;
@@ -87,8 +85,7 @@
         virtual void on_removeLabelButton_clicked() = 0;
         virtual void on_addDirectoryButton_clicked() = 0;
         virtual void on_removeDirectoryButton_clicked() = 0;
-        virtual void on_addAccountButton_clicked() = 0;
-        virtual void on_removeAccountButton_clicked() = 0;
+        virtual void on_patternsCombobox_changed() = 0;
         virtual void on_addPatternButton_clicked() = 0;
         virtual void on_removePatternButton_clicked() = 0;
 };



From fabricecolin at mail.berlios.de  Mon Jul 23 16:30:00 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Mon, 23 Jul 2007 16:30:00 +0200
Subject: [Pinot-svn] r877 - trunk
Message-ID: <200707231430.l6NEU0TS021556@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-23 16:29:59 +0200 (Mon, 23 Jul 2007)
New Revision: 877

Modified:
   trunk/README
   trunk/pinot.spec.in
Log:
Upped requirements on Xapian and SQLite.


Modified: trunk/README
===================================================================
--- trunk/README	2007-07-21 04:28:21 UTC (rev 876)
+++ trunk/README	2007-07-23 14:29:59 UTC (rev 877)
@@ -378,10 +378,10 @@
 ---------------------------------------------------------------
 Name							Version
 ---------------------------------------------------------------
-SQLite							3.1.2
+SQLite							3.3.1
 http://www.sqlite.org/
 
-xapian-core						0.9.9
+xapian-core						1.0.2
 http://www.xapian.org/
 
 curl (1)						7.13.1

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2007-07-21 04:28:21 UTC (rev 876)
+++ trunk/pinot.spec.in	2007-07-23 14:29:59 UTC (rev 877)
@@ -24,10 +24,10 @@
 Source: %{name}-%{version}.tar.gz
 URL: http://pinot.berlios.de/
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
-Requires: xapian-core-libs >= 0.9.7, libtextcat >= 2.2, sqlite >= 3.1.2, curl >= 7.13, gmime >= 2.1
+Requires: xapian-core-libs >= 1.0.2, libtextcat >= 2.2, sqlite >= 3.3.1, curl >= 7.13, gmime >= 2.1
 Requires: gtkmm24 >= 2.6, libxml++ >= 2.12, %{dbus_pkg} >= 0.60, shared-mime-info
 Requires: unzip, antiword, unrtf, %{pftotext_pkg}
-BuildRequires: xapian-core-devel >= 0.9.7, libtextcat-devel >= 2.2, sqlite-devel >= 3.1.2, curl-devel >= 7.13, gmime-devel >= 2.1, boost-devel >= 1.32
+BuildRequires: xapian-core-devel >= 1.0.2, libtextcat-devel >= 2.2, sqlite-devel >= 3.3.1, curl-devel >= 7.13, gmime-devel >= 2.1, boost-devel >= 1.32
 BuildRequires: gtkmm24-devel >= 2.6, libxml++-devel >= 2.12, %{dbus_dev_pkg} >= 0.60, gettext-devel, desktop-file-utils
 BuildRequires: taglib-devel >= 1.4
 BuildRequires: gcc-c++



From fabricecolin at mail.berlios.de  Tue Jul 24 14:01:29 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 24 Jul 2007 14:01:29 +0200
Subject: [Pinot-svn] r878 - trunk/Search
Message-ID: <200707241201.l6OC1TEE001791@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-24 14:01:29 +0200 (Tue, 24 Jul 2007)
New Revision: 878

Modified:
   trunk/Search/XapianEngine.cpp
Log:
Provide a field mapping to XapianQueryBuilder.


Modified: trunk/Search/XapianEngine.cpp
===================================================================
--- trunk/Search/XapianEngine.cpp	2007-07-23 14:29:59 UTC (rev 877)
+++ trunk/Search/XapianEngine.cpp	2007-07-24 12:01:29 UTC (rev 878)
@@ -246,7 +246,12 @@
 	QueryProperties::QueryType type = queryProps.getType();
 	if (type != QueryProperties::XAPIAN_QP)
 	{
-		XapianQueryBuilder builder(parser);
+		map<string, string> fieldMapping;
+
+		// Bare minimum mapping between Xesam fields and our prefixes 
+		fieldMapping["dc:title"] = "S";
+
+		XapianQueryBuilder builder(parser, fieldMapping);
 		XesamParser *pParser = NULL;
 
 		// Get a Xesam parser



From fabricecolin at mail.berlios.de  Tue Jul 24 14:21:43 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 24 Jul 2007 14:21:43 +0200
Subject: [Pinot-svn] r879 - in trunk: . Index Search UI/GTK2/src
Message-ID: <200707241221.l6OCLhhO004033@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-24 14:21:42 +0200 (Tue, 24 Jul 2007)
New Revision: 879

Modified:
   trunk/COPYING
   trunk/Index/pinot-index.cpp
   trunk/Search/pinot-search.cpp
   trunk/UI/GTK2/src/pinot-dbus-daemon.cc
   trunk/UI/GTK2/src/pinot.cc
Log:
Clarify that the license is GPL v2 and update the FSF's address in COPYING ! ;-)


Modified: trunk/COPYING
===================================================================
--- trunk/COPYING	2007-07-24 12:01:29 UTC (rev 878)
+++ trunk/COPYING	2007-07-24 12:21:42 UTC (rev 879)
@@ -2,7 +2,7 @@
 		       Version 2, June 1991
 
  Copyright (C) 1989, 1991 Free Software Foundation, Inc.
-     59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+	51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  Everyone is permitted to copy and distribute verbatim copies
  of this license document, but changing it is not allowed.
 
@@ -305,7 +305,7 @@
 
     You should have received a copy of the GNU General Public License
     along with this program; if not, write to the Free Software
-    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
 
 
 Also add information on how to contact you by electronic and paper mail.

Modified: trunk/Index/pinot-index.cpp
===================================================================
--- trunk/Index/pinot-index.cpp	2007-07-24 12:01:29 UTC (rev 878)
+++ trunk/Index/pinot-index.cpp	2007-07-24 12:21:42 UTC (rev 879)
@@ -125,7 +125,7 @@
 			case 'v':
 				cout << "pinot-index - " << PACKAGE_STRING << "\n\n"
 					<< "This is free software.  You may redistribute copies of it under the terms of\n"
-					<< "the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.\n"
+					<< "the GNU General Public License <http://www.gnu.org/licenses/old-licenses/gpl-2.0.html>.\n"
 					<< "There is NO WARRANTY, to the extent permitted by law." << endl;
 				return EXIT_SUCCESS;
 			default:

Modified: trunk/Search/pinot-search.cpp
===================================================================
--- trunk/Search/pinot-search.cpp	2007-07-24 12:01:29 UTC (rev 878)
+++ trunk/Search/pinot-search.cpp	2007-07-24 12:21:42 UTC (rev 879)
@@ -167,7 +167,7 @@
 			case 'v':
 				cout << "pinot-search - " << PACKAGE_STRING << "\n\n"
 					<< "This is free software.  You may redistribute copies of it under the terms of\n"
-					<< "the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.\n"
+					<< "the GNU General Public License <http://www.gnu.org/licenses/old-licenses/gpl-2.0.html>.\n"
 					<< "There is NO WARRANTY, to the extent permitted by law." << endl;
 				return EXIT_SUCCESS;
 			case 'x':

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.cc
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2007-07-24 12:01:29 UTC (rev 878)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.cc	2007-07-24 12:21:42 UTC (rev 879)
@@ -210,7 +210,7 @@
 			case 'v':
 				cout << "pinot-dbus-daemon - " << PACKAGE_STRING << "\n\n" 
 					<< "This is free software.  You may redistribute copies of it under the terms of\n"
-					<< "the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.\n"
+					<< "the GNU General Public License <http://www.gnu.org/licenses/old-licenses/gpl-2.0.html>.\n"
 					<< "There is NO WARRANTY, to the extent permitted by law." << endl;
 				return EXIT_SUCCESS;
 			default:

Modified: trunk/UI/GTK2/src/pinot.cc
===================================================================
--- trunk/UI/GTK2/src/pinot.cc	2007-07-24 12:01:29 UTC (rev 878)
+++ trunk/UI/GTK2/src/pinot.cc	2007-07-24 12:21:42 UTC (rev 879)
@@ -132,7 +132,7 @@
 			case 'v':
 				cout << "pinot - " << PACKAGE_STRING << "\n\n" 
 					<< "This is free software.  You may redistribute copies of it under the terms of\n"
-					<< "the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.\n"
+					<< "the GNU General Public License <http://www.gnu.org/licenses/old-licenses/gpl-2.0.html>.\n"
 					<< "There is NO WARRANTY, to the extent permitted by law." << endl;
 				return EXIT_SUCCESS;
 			default:



From fabricecolin at mail.berlios.de  Tue Jul 24 15:00:35 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 24 Jul 2007 15:00:35 +0200
Subject: [Pinot-svn] r880 - trunk/UI/GTK2/src
Message-ID: <200707241300.l6OD0ZfM008639@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-24 15:00:35 +0200 (Tue, 24 Jul 2007)
New Revision: 880

Modified:
   trunk/UI/GTK2/src/mainWindow.cc
Log:
No point translating the copyright string.


Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2007-07-24 12:21:42 UTC (rev 879)
+++ trunk/UI/GTK2/src/mainWindow.cc	2007-07-24 13:00:35 UTC (rev 880)
@@ -1,5 +1,5 @@
 /*
- *  Copyright 2005,2006 Fabrice Colin
+ *  Copyright 2005,2007 Fabrice Colin
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -2241,7 +2241,7 @@
 
 	aboutBox.set_comments(_("A metasearch tool for the Free Desktop") + string(".\n") +
 		_("Search the Web and your documents !"));
-	aboutBox.set_copyright(_("(C) 2005 Fabrice Colin"));
+	aboutBox.set_copyright("(C) 2005-2007 Fabrice Colin");
 	aboutBox.set_name("Pinot");
 	aboutBox.set_version(VERSION);
 	aboutBox.set_website("http://pinot.berlios.de/");



From fabricecolin at mail.berlios.de  Tue Jul 24 15:34:38 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Tue, 24 Jul 2007 15:34:38 +0200
Subject: [Pinot-svn] r881 - in trunk: . po
Message-ID: <200707241334.l6ODYcQd011378@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-24 15:34:36 +0200 (Tue, 24 Jul 2007)
New Revision: 881

Modified:
   trunk/AUTHORS
   trunk/po/de.po
   trunk/po/es.po
   trunk/po/fr.po
   trunk/po/it.po
   trunk/po/nl.po
   trunk/po/pt.po
   trunk/po/pt_BR.po
   trunk/po/ru.po
   trunk/po/sv.po
Log:
Current translations, including updates from Balaam's Miracle (Dutch) and
_PN_boy (Portuguese).


Modified: trunk/AUTHORS
===================================================================
--- trunk/AUTHORS	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/AUTHORS	2007-07-24 13:34:36 UTC (rev 881)
@@ -29,7 +29,8 @@
 Translations provided by :
 
 	Dutch - Tikkel <???>
-		& JW <jw00000 at gmail.com>
+		& JW <jw00000 at gmail dot com>
+		& Balaam's Miracle <balaam at balaamsmiracle dot com>
 	French - Nicolas Velin <nsv at fr dot st>
 	German - Christian Dywan <christian at twotoasts dot de>
 	Italian - Michele Angrisano <darksun1988 at gmail dot com>

Modified: trunk/po/de.po
===================================================================
--- trunk/po/de.po	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/po/de.po	2007-07-24 13:34:36 UTC (rev 881)
@@ -5,9 +5,9 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.74\n"
+"Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-19 19:02+0800\n"
+"POT-Creation-Date: 2007-07-24 20:39+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Christian Dywan <christian at twotoasts.de>\n"
 "Language-Team: German <de at li.org>\n"
@@ -32,9 +32,9 @@
 #: UI/GTK2/src/mainWindow.cc:1026 UI/GTK2/src/mainWindow.cc:1197
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:1261
 #: UI/GTK2/src/mainWindow.cc:1292 UI/GTK2/src/mainWindow.cc:1903
-#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1388
-#: UI/GTK2/src/PinotSettings.cpp:1444 UI/GTK2/src/statisticsDialog.cc:77
-#: UI/GTK2/src/WorkerThreads.cpp:794 UI/GTK2/src/WorkerThreads.cpp:853
+#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1339
+#: UI/GTK2/src/PinotSettings.cpp:1395 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:855
 msgid "My Web Pages"
 msgstr "Meine Webseiten"
 
@@ -42,9 +42,9 @@
 #. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:338 UI/GTK2/src/mainWindow.cc:318
 #: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:1033
-#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1389
-#: UI/GTK2/src/PinotSettings.cpp:1445 UI/GTK2/src/statisticsDialog.cc:82
-#: UI/GTK2/src/WorkerThreads.cpp:799 UI/GTK2/src/WorkerThreads.cpp:863
+#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1340
+#: UI/GTK2/src/PinotSettings.cpp:1396 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:801 UI/GTK2/src/WorkerThreads.cpp:865
 msgid "My Documents"
 msgstr "Meine Dokumente"
 
@@ -271,13 +271,13 @@
 msgid "Couldn't find query"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:1682
+#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:654
+#: UI/GTK2/src/WorkerThreads.cpp:1686
 msgid "Index"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:656
-#: UI/GTK2/src/WorkerThreads.cpp:1686
+#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:658
+#: UI/GTK2/src/WorkerThreads.cpp:1690
 msgid "doesn't exist"
 msgstr ""
 
@@ -297,10 +297,6 @@
 msgid "Search the Web and your documents !"
 msgstr "Durchsuchen Sie das Internet und Ihre Dokumente !"
 
-#: UI/GTK2/src/mainWindow.cc:2244
-msgid "(C) 2005 Fabrice Colin"
-msgstr "(C) 2005 Fabrice Colin"
-
 #: UI/GTK2/src/mainWindow.cc:2288
 msgid "Index name"
 msgstr ""
@@ -550,7 +546,7 @@
 msgid "Personal"
 msgstr "Pers?nlich"
 
-#: UI/GTK2/src/PinotSettings.cpp:1184
+#: UI/GTK2/src/PinotSettings.cpp:1146
 msgid "Unclassified"
 msgstr ""
 
@@ -562,26 +558,30 @@
 msgid "Monitor"
 msgstr "?berwachen"
 
-#: UI/GTK2/src/prefsDialog.cc:90 UI/GTK2/src/prefsDialog.cc:98
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Location"
 msgstr "Ort"
 
-#: UI/GTK2/src/prefsDialog.cc:106
+#: UI/GTK2/src/prefsDialog.cc:98
 msgid "Pattern"
 msgstr ""
 
-#: UI/GTK2/src/prefsDialog.cc:470
+#: UI/GTK2/src/prefsDialog.cc:315
+msgid "Exclude these patterns from indexing"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:316
+msgid "Only index these patterns"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:406
 msgid "New Label"
 msgstr ""
 
-#: UI/GTK2/src/prefsDialog.cc:511
+#: UI/GTK2/src/prefsDialog.cc:447
 msgid "Directory to index"
 msgstr "Zu indizierendes Verzeichnis"
 
-#: UI/GTK2/src/prefsDialog.cc:569
-msgid "Mbox File Location"
-msgstr "Ort der Mbox-Datei"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Google API-Schl?ssel:"
@@ -627,7 +627,7 @@
 msgstr ""
 
 #: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
-#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+#: UI/GTK2/src/prefsDialog_glade.cc:135
 msgid "Add"
 msgstr "Hinzuf?gen"
 
@@ -645,20 +645,15 @@
 "Diese Verzeichnisse werden indiziert und optional auf ?nderungen ?berwacht:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:127
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr "Postf?cher des Typs mbox k?nnen ?berwacht und indiziert werden:"
+#, fuzzy
+msgid "File patterns:"
+msgstr "Dateiendung"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:140
-msgid "Specify any file pattern you wish to exclude from indexing:"
-msgstr ""
-"Geben Sie beliebige Dateimuster an, die Sie vom Indizieren ausschlie?en "
-"m?chten:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:154
+#: UI/GTK2/src/prefsDialog_glade.cc:144
 msgid "Indexing"
 msgstr "Indizieren"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:566
+#: UI/GTK2/src/prefsDialog_glade.cc:507
 msgid "Preferences"
 msgstr "Einstellungen"
 
@@ -819,67 +814,67 @@
 msgid "Errors"
 msgstr "Fehler"
 
-#: UI/GTK2/src/WorkerThreads.cpp:301
+#: UI/GTK2/src/WorkerThreads.cpp:303
 msgid "Can't index mail here"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:322 UI/GTK2/src/WorkerThreads.cpp:555
+#: UI/GTK2/src/WorkerThreads.cpp:324 UI/GTK2/src/WorkerThreads.cpp:557
 msgid "is already being indexed"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:332
+#: UI/GTK2/src/WorkerThreads.cpp:334
 msgid "is blacklisted"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:1014
-#: UI/GTK2/src/WorkerThreads.cpp:1097 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1292 UI/GTK2/src/WorkerThreads.cpp:1562
-#: UI/GTK2/src/WorkerThreads.cpp:1695
+#: UI/GTK2/src/WorkerThreads.cpp:667 UI/GTK2/src/WorkerThreads.cpp:1016
+#: UI/GTK2/src/WorkerThreads.cpp:1099 UI/GTK2/src/WorkerThreads.cpp:1108
+#: UI/GTK2/src/WorkerThreads.cpp:1294 UI/GTK2/src/WorkerThreads.cpp:1566
+#: UI/GTK2/src/WorkerThreads.cpp:1699
 msgid "Index error on"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:816
+#: UI/GTK2/src/WorkerThreads.cpp:818
 msgid "No title"
 msgstr "Kein Titel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:918 UI/GTK2/src/WorkerThreads.cpp:1035
+#: UI/GTK2/src/WorkerThreads.cpp:920 UI/GTK2/src/WorkerThreads.cpp:1037
 msgid "Couldn't create search engine"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:941 UI/GTK2/src/WorkerThreads.cpp:1047
+#: UI/GTK2/src/WorkerThreads.cpp:943 UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't run query on search engine"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:1200
+#: UI/GTK2/src/WorkerThreads.cpp:1202
 msgid "Couldn't obtain downloader for protocol"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/WorkerThreads.cpp:1227
 msgid "Couldn't retrieve"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:1322 UI/GTK2/src/WorkerThreads.cpp:1401
+#: UI/GTK2/src/WorkerThreads.cpp:1324 UI/GTK2/src/WorkerThreads.cpp:1403
 msgid "Cannot index document type"
 msgstr "Kann Dokumenttyp nicht indizieren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1326 UI/GTK2/src/WorkerThreads.cpp:1405
+#: UI/GTK2/src/WorkerThreads.cpp:1328 UI/GTK2/src/WorkerThreads.cpp:1407
 msgid "at"
 msgstr ""
 
 #. No, it isn't
-#: UI/GTK2/src/WorkerThreads.cpp:1437
+#: UI/GTK2/src/WorkerThreads.cpp:1439
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META-Tag verbietet das Indizieren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1491
+#: UI/GTK2/src/WorkerThreads.cpp:1495
 msgid "Couldn't index"
 msgstr ""
 
 #. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1573
+#: UI/GTK2/src/WorkerThreads.cpp:1577
 msgid "Couldn't unindex document(s)"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:1707
+#: UI/GTK2/src/WorkerThreads.cpp:1711
 msgid "Couldn't update document"
 msgstr "Dokument konnte nicht aktualisiert werden"

Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/po/es.po	2007-07-24 13:34:36 UTC (rev 881)
@@ -6,10 +6,10 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.74\n"
+"Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-19 19:02+0800\n"
-"PO-Revision-Date: 2007-06-21 19:51+0800\n"
+"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"PO-Revision-Date: 2007-07-21 12:37+0800\n"
 "Last-Translator: Gar Bage <garbage at openfutura.com>\n"
 "Language-Team: es <fabricecolin at users.berlios.de>\n"
 "MIME-Version: 1.0\n"
@@ -33,9 +33,9 @@
 #: UI/GTK2/src/mainWindow.cc:1026 UI/GTK2/src/mainWindow.cc:1197
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:1261
 #: UI/GTK2/src/mainWindow.cc:1292 UI/GTK2/src/mainWindow.cc:1903
-#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1388
-#: UI/GTK2/src/PinotSettings.cpp:1444 UI/GTK2/src/statisticsDialog.cc:77
-#: UI/GTK2/src/WorkerThreads.cpp:794 UI/GTK2/src/WorkerThreads.cpp:853
+#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1339
+#: UI/GTK2/src/PinotSettings.cpp:1395 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:855
 msgid "My Web Pages"
 msgstr "Mis Paginas Web"
 
@@ -43,9 +43,9 @@
 #. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:338 UI/GTK2/src/mainWindow.cc:318
 #: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:1033
-#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1389
-#: UI/GTK2/src/PinotSettings.cpp:1445 UI/GTK2/src/statisticsDialog.cc:82
-#: UI/GTK2/src/WorkerThreads.cpp:799 UI/GTK2/src/WorkerThreads.cpp:863
+#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1340
+#: UI/GTK2/src/PinotSettings.cpp:1396 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:801 UI/GTK2/src/WorkerThreads.cpp:865
 msgid "My Documents"
 msgstr "Mis documentos"
 
@@ -268,13 +268,13 @@
 msgid "Couldn't find query"
 msgstr "No se pudo a?adir la b?squeda"
 
-#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:1682
+#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:654
+#: UI/GTK2/src/WorkerThreads.cpp:1686
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:656
-#: UI/GTK2/src/WorkerThreads.cpp:1686
+#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:658
+#: UI/GTK2/src/WorkerThreads.cpp:1690
 msgid "doesn't exist"
 msgstr "no existe"
 
@@ -294,10 +294,6 @@
 msgid "Search the Web and your documents !"
 msgstr "Busca en el web y en sus documentos"
 
-#: UI/GTK2/src/mainWindow.cc:2244
-msgid "(C) 2005 Fabrice Colin"
-msgstr "(C) 2005 Fabrice Colin"
-
 #: UI/GTK2/src/mainWindow.cc:2288
 msgid "Index name"
 msgstr "Nombre del ?ndice"
@@ -547,7 +543,7 @@
 msgid "Personal"
 msgstr "Personal"
 
-#: UI/GTK2/src/PinotSettings.cpp:1184
+#: UI/GTK2/src/PinotSettings.cpp:1146
 msgid "Unclassified"
 msgstr "No clasificado"
 
@@ -559,26 +555,30 @@
 msgid "Monitor"
 msgstr "Supervisar"
 
-#: UI/GTK2/src/prefsDialog.cc:90 UI/GTK2/src/prefsDialog.cc:98
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Location"
 msgstr "Localizaci?n"
 
-#: UI/GTK2/src/prefsDialog.cc:106
+#: UI/GTK2/src/prefsDialog.cc:98
 msgid "Pattern"
 msgstr "Patron"
 
-#: UI/GTK2/src/prefsDialog.cc:470
+#: UI/GTK2/src/prefsDialog.cc:315
+msgid "Exclude these patterns from indexing"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:316
+msgid "Only index these patterns"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:406
 msgid "New Label"
 msgstr "Nueva etiqueta"
 
-#: UI/GTK2/src/prefsDialog.cc:511
+#: UI/GTK2/src/prefsDialog.cc:447
 msgid "Directory to index"
 msgstr "Carpeta a indexar"
 
-#: UI/GTK2/src/prefsDialog.cc:569
-msgid "Mbox File Location"
-msgstr "Localizaci?n del fichero mbox"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Clave del API de Google"
@@ -624,7 +624,7 @@
 msgstr "Las etiquetas se usan para clasificar los documentos indizados:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
-#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+#: UI/GTK2/src/prefsDialog_glade.cc:135
 msgid "Add"
 msgstr "A?adir"
 
@@ -641,18 +641,15 @@
 msgstr "Estas carpetas van a estar indexar autom?ticamente"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:127
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr "Los buzones de correo de tipo mbox pueden ser controlados e indizados"
+#, fuzzy
+msgid "File patterns:"
+msgstr "Extensi?n del archivo"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:140
-msgid "Specify any file pattern you wish to exclude from indexing:"
-msgstr "Especifique patrones que desea excluir del ?ndice:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:154
+#: UI/GTK2/src/prefsDialog_glade.cc:144
 msgid "Indexing"
 msgstr "?ndices"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:566
+#: UI/GTK2/src/prefsDialog_glade.cc:507
 msgid "Preferences"
 msgstr "Preferencias"
 
@@ -812,67 +809,67 @@
 msgid "Errors"
 msgstr "Errores"
 
-#: UI/GTK2/src/WorkerThreads.cpp:301
+#: UI/GTK2/src/WorkerThreads.cpp:303
 msgid "Can't index mail here"
 msgstr "No se pudo indizar el buzon de correo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322 UI/GTK2/src/WorkerThreads.cpp:555
+#: UI/GTK2/src/WorkerThreads.cpp:324 UI/GTK2/src/WorkerThreads.cpp:557
 msgid "is already being indexed"
 msgstr "ya est? indizado"
 
-#: UI/GTK2/src/WorkerThreads.cpp:332
+#: UI/GTK2/src/WorkerThreads.cpp:334
 msgid "is blacklisted"
 msgstr "ya excluido"
 
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:1014
-#: UI/GTK2/src/WorkerThreads.cpp:1097 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1292 UI/GTK2/src/WorkerThreads.cpp:1562
-#: UI/GTK2/src/WorkerThreads.cpp:1695
+#: UI/GTK2/src/WorkerThreads.cpp:667 UI/GTK2/src/WorkerThreads.cpp:1016
+#: UI/GTK2/src/WorkerThreads.cpp:1099 UI/GTK2/src/WorkerThreads.cpp:1108
+#: UI/GTK2/src/WorkerThreads.cpp:1294 UI/GTK2/src/WorkerThreads.cpp:1566
+#: UI/GTK2/src/WorkerThreads.cpp:1699
 msgid "Index error on"
 msgstr "Error en el ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816
+#: UI/GTK2/src/WorkerThreads.cpp:818
 msgid "No title"
 msgstr "Sin t?tulo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:918 UI/GTK2/src/WorkerThreads.cpp:1035
+#: UI/GTK2/src/WorkerThreads.cpp:920 UI/GTK2/src/WorkerThreads.cpp:1037
 msgid "Couldn't create search engine"
 msgstr "No se pudo crear el motor de b?squeda"
 
-#: UI/GTK2/src/WorkerThreads.cpp:941 UI/GTK2/src/WorkerThreads.cpp:1047
+#: UI/GTK2/src/WorkerThreads.cpp:943 UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't run query on search engine"
 msgstr "No se pudo ejecutar la b?squeda contra el motor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1200
+#: UI/GTK2/src/WorkerThreads.cpp:1202
 msgid "Couldn't obtain downloader for protocol"
 msgstr "No se pudo usar un recuperador para el protocolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/WorkerThreads.cpp:1227
 msgid "Couldn't retrieve"
 msgstr "No se pudo descargar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1322 UI/GTK2/src/WorkerThreads.cpp:1401
+#: UI/GTK2/src/WorkerThreads.cpp:1324 UI/GTK2/src/WorkerThreads.cpp:1403
 msgid "Cannot index document type"
 msgstr "No se pudo indizar el tipo de documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1326 UI/GTK2/src/WorkerThreads.cpp:1405
+#: UI/GTK2/src/WorkerThreads.cpp:1328 UI/GTK2/src/WorkerThreads.cpp:1407
 msgid "at"
 msgstr "a"
 
 #. No, it isn't
-#: UI/GTK2/src/WorkerThreads.cpp:1437
+#: UI/GTK2/src/WorkerThreads.cpp:1439
 msgid "Robots META tag forbids indexing"
 msgstr "La etiqueta META Robots proh?be la indizaci?n"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1491
+#: UI/GTK2/src/WorkerThreads.cpp:1495
 msgid "Couldn't index"
 msgstr "No se pudo indizar"
 
 #. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1573
+#: UI/GTK2/src/WorkerThreads.cpp:1577
 msgid "Couldn't unindex document(s)"
 msgstr "No se pudo des-indizar lo(s) documento(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1707
+#: UI/GTK2/src/WorkerThreads.cpp:1711
 msgid "Couldn't update document"
 msgstr "No se pudo actualizar el documento"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/po/fr.po	2007-07-24 13:34:36 UTC (rev 881)
@@ -6,9 +6,9 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.74\n"
+"Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-19 19:02+0800\n"
+"POT-Creation-Date: 2007-07-24 20:39+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: fr <fabricecolin at users.berlios.de>\n"
@@ -33,9 +33,9 @@
 #: UI/GTK2/src/mainWindow.cc:1026 UI/GTK2/src/mainWindow.cc:1197
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:1261
 #: UI/GTK2/src/mainWindow.cc:1292 UI/GTK2/src/mainWindow.cc:1903
-#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1388
-#: UI/GTK2/src/PinotSettings.cpp:1444 UI/GTK2/src/statisticsDialog.cc:77
-#: UI/GTK2/src/WorkerThreads.cpp:794 UI/GTK2/src/WorkerThreads.cpp:853
+#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1339
+#: UI/GTK2/src/PinotSettings.cpp:1395 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:855
 msgid "My Web Pages"
 msgstr "Mes Pages Web"
 
@@ -43,9 +43,9 @@
 #. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:338 UI/GTK2/src/mainWindow.cc:318
 #: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:1033
-#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1389
-#: UI/GTK2/src/PinotSettings.cpp:1445 UI/GTK2/src/statisticsDialog.cc:82
-#: UI/GTK2/src/WorkerThreads.cpp:799 UI/GTK2/src/WorkerThreads.cpp:863
+#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1340
+#: UI/GTK2/src/PinotSettings.cpp:1396 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:801 UI/GTK2/src/WorkerThreads.cpp:865
 msgid "My Documents"
 msgstr "Mes Documents"
 
@@ -190,9 +190,8 @@
 msgstr "Le chemin du document is"
 
 #: UI/GTK2/src/mainWindow.cc:883
-#, fuzzy
 msgid "Showing"
-msgstr "Montrant"
+msgstr ""
 
 #: UI/GTK2/src/mainWindow.cc:888
 msgid "of"
@@ -269,13 +268,13 @@
 msgid "Couldn't find query"
 msgstr "N'a pas pu trouver"
 
-#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:1682
+#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:654
+#: UI/GTK2/src/WorkerThreads.cpp:1686
 msgid "Index"
 msgstr "L'index"
 
-#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:656
-#: UI/GTK2/src/WorkerThreads.cpp:1686
+#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:658
+#: UI/GTK2/src/WorkerThreads.cpp:1690
 msgid "doesn't exist"
 msgstr "n'existe pas"
 
@@ -295,10 +294,6 @@
 msgid "Search the Web and your documents !"
 msgstr "Cherche le Web et vos documents"
 
-#: UI/GTK2/src/mainWindow.cc:2244
-msgid "(C) 2005 Fabrice Colin"
-msgstr "(C) 2005 Fabrice Colin"
-
 #: UI/GTK2/src/mainWindow.cc:2288
 msgid "Index name"
 msgstr "Nom de l'index"
@@ -548,7 +543,7 @@
 msgid "Personal"
 msgstr "Personnel"
 
-#: UI/GTK2/src/PinotSettings.cpp:1184
+#: UI/GTK2/src/PinotSettings.cpp:1146
 msgid "Unclassified"
 msgstr "Sans classification"
 
@@ -560,26 +555,30 @@
 msgid "Monitor"
 msgstr "Surveiller"
 
-#: UI/GTK2/src/prefsDialog.cc:90 UI/GTK2/src/prefsDialog.cc:98
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Location"
 msgstr "Chemin"
 
-#: UI/GTK2/src/prefsDialog.cc:106
+#: UI/GTK2/src/prefsDialog.cc:98
 msgid "Pattern"
 msgstr "Motif"
 
-#: UI/GTK2/src/prefsDialog.cc:470
+#: UI/GTK2/src/prefsDialog.cc:315
+msgid "Exclude these patterns from indexing"
+msgstr "Ne pas indexer ces motifs"
+
+#: UI/GTK2/src/prefsDialog.cc:316
+msgid "Only index these patterns"
+msgstr "Indexer uniquement ces motifs"
+
+#: UI/GTK2/src/prefsDialog.cc:406
 msgid "New Label"
 msgstr "Nouvelle Etiquette"
 
-#: UI/GTK2/src/prefsDialog.cc:511
+#: UI/GTK2/src/prefsDialog.cc:447
 msgid "Directory to index"
 msgstr "Repertoire a indexer"
 
-#: UI/GTK2/src/prefsDialog.cc:569
-msgid "Mbox File Location"
-msgstr "Chemin du Fichier mbox"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Clef de l'API Google"
@@ -625,7 +624,7 @@
 msgstr "Les etiquettes servent a classer les documents:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
-#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+#: UI/GTK2/src/prefsDialog_glade.cc:135
 msgid "Add"
 msgstr "Ajouter"
 
@@ -642,18 +641,14 @@
 msgstr "Ces repertoires seront indexes automatiquement:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:127
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr "Les boites de type mbox peuvent etre indexees"
+msgid "File patterns:"
+msgstr "Motifs de fichier:"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:140
-msgid "Specify any file pattern you wish to exclude from indexing:"
-msgstr "Specifiez tous les motifs de fichiers a ne pas indexer:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:154
+#: UI/GTK2/src/prefsDialog_glade.cc:144
 msgid "Indexing"
 msgstr "Indexes"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:566
+#: UI/GTK2/src/prefsDialog_glade.cc:507
 msgid "Preferences"
 msgstr "Preferences"
 
@@ -778,9 +773,8 @@
 msgstr "documents"
 
 #: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
-#, fuzzy
 msgid "Unknown error"
-msgstr "Inconnu"
+msgstr "Erreur inconnue"
 
 #: UI/GTK2/src/statisticsDialog.cc:154
 msgid "Viewed"
@@ -811,67 +805,67 @@
 msgid "Errors"
 msgstr "Erreurs"
 
-#: UI/GTK2/src/WorkerThreads.cpp:301
+#: UI/GTK2/src/WorkerThreads.cpp:303
 msgid "Can't index mail here"
 msgstr "Ne peut pas indexer le courrier ici"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322 UI/GTK2/src/WorkerThreads.cpp:555
+#: UI/GTK2/src/WorkerThreads.cpp:324 UI/GTK2/src/WorkerThreads.cpp:557
 msgid "is already being indexed"
 msgstr "est deja indexe"
 
-#: UI/GTK2/src/WorkerThreads.cpp:332
+#: UI/GTK2/src/WorkerThreads.cpp:334
 msgid "is blacklisted"
 msgstr "est exclus"
 
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:1014
-#: UI/GTK2/src/WorkerThreads.cpp:1097 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1292 UI/GTK2/src/WorkerThreads.cpp:1562
-#: UI/GTK2/src/WorkerThreads.cpp:1695
+#: UI/GTK2/src/WorkerThreads.cpp:667 UI/GTK2/src/WorkerThreads.cpp:1016
+#: UI/GTK2/src/WorkerThreads.cpp:1099 UI/GTK2/src/WorkerThreads.cpp:1108
+#: UI/GTK2/src/WorkerThreads.cpp:1294 UI/GTK2/src/WorkerThreads.cpp:1566
+#: UI/GTK2/src/WorkerThreads.cpp:1699
 msgid "Index error on"
 msgstr "Erreur sur l'index"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816
+#: UI/GTK2/src/WorkerThreads.cpp:818
 msgid "No title"
 msgstr "Pas de titre"
 
-#: UI/GTK2/src/WorkerThreads.cpp:918 UI/GTK2/src/WorkerThreads.cpp:1035
+#: UI/GTK2/src/WorkerThreads.cpp:920 UI/GTK2/src/WorkerThreads.cpp:1037
 msgid "Couldn't create search engine"
 msgstr "N'a pas pu creer le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:941 UI/GTK2/src/WorkerThreads.cpp:1047
+#: UI/GTK2/src/WorkerThreads.cpp:943 UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't run query on search engine"
 msgstr "N'a pas pu lancer la recherche sur le moteur"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1200
+#: UI/GTK2/src/WorkerThreads.cpp:1202
 msgid "Couldn't obtain downloader for protocol"
 msgstr "N'a pas pu obtenir un brouteur pour"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/WorkerThreads.cpp:1227
 msgid "Couldn't retrieve"
 msgstr "N'a pas pu telecharger"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1322 UI/GTK2/src/WorkerThreads.cpp:1401
+#: UI/GTK2/src/WorkerThreads.cpp:1324 UI/GTK2/src/WorkerThreads.cpp:1403
 msgid "Cannot index document type"
 msgstr "Impossible d'indexer ce type de documents"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1326 UI/GTK2/src/WorkerThreads.cpp:1405
+#: UI/GTK2/src/WorkerThreads.cpp:1328 UI/GTK2/src/WorkerThreads.cpp:1407
 msgid "at"
 msgstr "a"
 
 #. No, it isn't
-#: UI/GTK2/src/WorkerThreads.cpp:1437
+#: UI/GTK2/src/WorkerThreads.cpp:1439
 msgid "Robots META tag forbids indexing"
 msgstr "Le META tag Robots interdit d'indexer"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1491
+#: UI/GTK2/src/WorkerThreads.cpp:1495
 msgid "Couldn't index"
 msgstr "N'a pas pu indexer"
 
 #. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1573
+#: UI/GTK2/src/WorkerThreads.cpp:1577
 msgid "Couldn't unindex document(s)"
 msgstr "N'a pas pu desindexer le(s) document(s)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1707
+#: UI/GTK2/src/WorkerThreads.cpp:1711
 msgid "Couldn't update document"
 msgstr "N'a pas pu mettre a jour le document"

Modified: trunk/po/it.po
===================================================================
--- trunk/po/it.po	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/po/it.po	2007-07-24 13:34:36 UTC (rev 881)
@@ -5,9 +5,9 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.74\n"
+"Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-19 19:02+0800\n"
+"POT-Creation-Date: 2007-07-24 20:39+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Marco Bazzani <visitors at libero.it>\n"
 "Language-Team: Italian <it at li.org>\n"
@@ -32,9 +32,9 @@
 #: UI/GTK2/src/mainWindow.cc:1026 UI/GTK2/src/mainWindow.cc:1197
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:1261
 #: UI/GTK2/src/mainWindow.cc:1292 UI/GTK2/src/mainWindow.cc:1903
-#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1388
-#: UI/GTK2/src/PinotSettings.cpp:1444 UI/GTK2/src/statisticsDialog.cc:77
-#: UI/GTK2/src/WorkerThreads.cpp:794 UI/GTK2/src/WorkerThreads.cpp:853
+#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1339
+#: UI/GTK2/src/PinotSettings.cpp:1395 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:855
 msgid "My Web Pages"
 msgstr "Pagine web personali"
 
@@ -42,9 +42,9 @@
 #. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:338 UI/GTK2/src/mainWindow.cc:318
 #: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:1033
-#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1389
-#: UI/GTK2/src/PinotSettings.cpp:1445 UI/GTK2/src/statisticsDialog.cc:82
-#: UI/GTK2/src/WorkerThreads.cpp:799 UI/GTK2/src/WorkerThreads.cpp:863
+#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1340
+#: UI/GTK2/src/PinotSettings.cpp:1396 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:801 UI/GTK2/src/WorkerThreads.cpp:865
 msgid "My Documents"
 msgstr "Documenti personali"
 
@@ -268,13 +268,13 @@
 msgid "Couldn't find query"
 msgstr "Impossibile trovare la query"
 
-#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:1682
+#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:654
+#: UI/GTK2/src/WorkerThreads.cpp:1686
 msgid "Index"
 msgstr "Indice"
 
-#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:656
-#: UI/GTK2/src/WorkerThreads.cpp:1686
+#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:658
+#: UI/GTK2/src/WorkerThreads.cpp:1690
 msgid "doesn't exist"
 msgstr "non esiste"
 
@@ -294,10 +294,6 @@
 msgid "Search the Web and your documents !"
 msgstr "Cerca nel Web e nei documenti !"
 
-#: UI/GTK2/src/mainWindow.cc:2244
-msgid "(C) 2005 Fabrice Colin"
-msgstr "(C) 2005 Fabrice Colin"
-
 #: UI/GTK2/src/mainWindow.cc:2288
 msgid "Index name"
 msgstr "Nome indice"
@@ -547,7 +543,7 @@
 msgid "Personal"
 msgstr "Personale"
 
-#: UI/GTK2/src/PinotSettings.cpp:1184
+#: UI/GTK2/src/PinotSettings.cpp:1146
 msgid "Unclassified"
 msgstr "Non classificato"
 
@@ -559,26 +555,30 @@
 msgid "Monitor"
 msgstr "Monitor"
 
-#: UI/GTK2/src/prefsDialog.cc:90 UI/GTK2/src/prefsDialog.cc:98
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Location"
 msgstr "Posizione"
 
-#: UI/GTK2/src/prefsDialog.cc:106
+#: UI/GTK2/src/prefsDialog.cc:98
 msgid "Pattern"
 msgstr "Espressione"
 
-#: UI/GTK2/src/prefsDialog.cc:470
+#: UI/GTK2/src/prefsDialog.cc:315
+msgid "Exclude these patterns from indexing"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:316
+msgid "Only index these patterns"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:406
 msgid "New Label"
 msgstr "Nuova descrizione"
 
-#: UI/GTK2/src/prefsDialog.cc:511
+#: UI/GTK2/src/prefsDialog.cc:447
 msgid "Directory to index"
 msgstr "Directory da indicizzare"
 
-#: UI/GTK2/src/prefsDialog.cc:569
-msgid "Mbox File Location"
-msgstr "Posizione dei File Mbox"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Chiave Google API:"
@@ -624,7 +624,7 @@
 msgstr "Le descrizioni sono usate per classificare l'indice dei documenti:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
-#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+#: UI/GTK2/src/prefsDialog_glade.cc:135
 msgid "Add"
 msgstr "aggiungi"
 
@@ -643,19 +643,15 @@
 "cambiamenti:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:127
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr ""
-"Le caselle postali di tipo mbox possono essere monitorate e indicizzate:"
+#, fuzzy
+msgid "File patterns:"
+msgstr "Estensione file"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:140
-msgid "Specify any file pattern you wish to exclude from indexing:"
-msgstr "Specifica una espressione che escluda file dall'indicizzazione"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:154
+#: UI/GTK2/src/prefsDialog_glade.cc:144
 msgid "Indexing"
 msgstr "Indicizzando"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:566
+#: UI/GTK2/src/prefsDialog_glade.cc:507
 msgid "Preferences"
 msgstr "Preferenze"
 
@@ -812,67 +808,67 @@
 msgid "Errors"
 msgstr "Errori"
 
-#: UI/GTK2/src/WorkerThreads.cpp:301
+#: UI/GTK2/src/WorkerThreads.cpp:303
 msgid "Can't index mail here"
 msgstr "Impossibile indicizzare la mail qui"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322 UI/GTK2/src/WorkerThreads.cpp:555
+#: UI/GTK2/src/WorkerThreads.cpp:324 UI/GTK2/src/WorkerThreads.cpp:557
 msgid "is already being indexed"
 msgstr "? gia' stato indicizzato"
 
-#: UI/GTK2/src/WorkerThreads.cpp:332
+#: UI/GTK2/src/WorkerThreads.cpp:334
 msgid "is blacklisted"
 msgstr "e' blacklistato"
 
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:1014
-#: UI/GTK2/src/WorkerThreads.cpp:1097 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1292 UI/GTK2/src/WorkerThreads.cpp:1562
-#: UI/GTK2/src/WorkerThreads.cpp:1695
+#: UI/GTK2/src/WorkerThreads.cpp:667 UI/GTK2/src/WorkerThreads.cpp:1016
+#: UI/GTK2/src/WorkerThreads.cpp:1099 UI/GTK2/src/WorkerThreads.cpp:1108
+#: UI/GTK2/src/WorkerThreads.cpp:1294 UI/GTK2/src/WorkerThreads.cpp:1566
+#: UI/GTK2/src/WorkerThreads.cpp:1699
 msgid "Index error on"
 msgstr "Errori indice su"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816
+#: UI/GTK2/src/WorkerThreads.cpp:818
 msgid "No title"
 msgstr "Nessun titolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:918 UI/GTK2/src/WorkerThreads.cpp:1035
+#: UI/GTK2/src/WorkerThreads.cpp:920 UI/GTK2/src/WorkerThreads.cpp:1037
 msgid "Couldn't create search engine"
 msgstr "Impossibile creare un motore di ricerca"
 
-#: UI/GTK2/src/WorkerThreads.cpp:941 UI/GTK2/src/WorkerThreads.cpp:1047
+#: UI/GTK2/src/WorkerThreads.cpp:943 UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't run query on search engine"
 msgstr "Impossibile avviare un query sul motore di ricerca"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1200
+#: UI/GTK2/src/WorkerThreads.cpp:1202
 msgid "Couldn't obtain downloader for protocol"
 msgstr "Impossibile ottenere un downloader per il protocollo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/WorkerThreads.cpp:1227
 msgid "Couldn't retrieve"
 msgstr "Impossibile recuperare"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1322 UI/GTK2/src/WorkerThreads.cpp:1401
+#: UI/GTK2/src/WorkerThreads.cpp:1324 UI/GTK2/src/WorkerThreads.cpp:1403
 msgid "Cannot index document type"
 msgstr "Impossibile indicizzare tipo di documento"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1326 UI/GTK2/src/WorkerThreads.cpp:1405
+#: UI/GTK2/src/WorkerThreads.cpp:1328 UI/GTK2/src/WorkerThreads.cpp:1407
 msgid "at"
 msgstr "a"
 
 #. No, it isn't
-#: UI/GTK2/src/WorkerThreads.cpp:1437
+#: UI/GTK2/src/WorkerThreads.cpp:1439
 msgid "Robots META tag forbids indexing"
 msgstr "il Robots META tag vieta l'indicizzazione"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1491
+#: UI/GTK2/src/WorkerThreads.cpp:1495
 msgid "Couldn't index"
 msgstr "Impossibile indicizzare"
 
 #. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1573
+#: UI/GTK2/src/WorkerThreads.cpp:1577
 msgid "Couldn't unindex document(s)"
 msgstr "Impossiible rimuovere i(l) documento/i dall'indice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1707
+#: UI/GTK2/src/WorkerThreads.cpp:1711
 msgid "Couldn't update document"
 msgstr "Impossibile aggiornare il documento"

Modified: trunk/po/nl.po
===================================================================
--- trunk/po/nl.po	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/po/nl.po	2007-07-24 13:34:36 UTC (rev 881)
@@ -5,16 +5,16 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.74\n"
+"Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-19 19:02+0800\n"
-"PO-Revision-Date: 2007-06-21 19:51+0800\n"
-"Last-Translator: JW <jw00000 at gmail.com>\n"
+"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"PO-Revision-Date: 2007-07-18 16:03+0000\n"
+"Last-Translator: Balaam's Miracle <balaam at balaamsmiracle.com>\n"
 "Language-Team: Dutch <nl at li.org>\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
-"X-Rosetta-Export-Date: 2007-05-06 00:38:08+0000\n"
+"X-Rosetta-Export-Date: 2007-07-21 04:18:16+0000\n"
 
 #: UI/GTK2/src/EnginesTree.cpp:68
 msgid "Search Engines"
@@ -32,9 +32,9 @@
 #: UI/GTK2/src/mainWindow.cc:1026 UI/GTK2/src/mainWindow.cc:1197
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:1261
 #: UI/GTK2/src/mainWindow.cc:1292 UI/GTK2/src/mainWindow.cc:1903
-#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1388
-#: UI/GTK2/src/PinotSettings.cpp:1444 UI/GTK2/src/statisticsDialog.cc:77
-#: UI/GTK2/src/WorkerThreads.cpp:794 UI/GTK2/src/WorkerThreads.cpp:853
+#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1339
+#: UI/GTK2/src/PinotSettings.cpp:1395 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:855
 msgid "My Web Pages"
 msgstr "Mijn webpagina's"
 
@@ -42,9 +42,9 @@
 #. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:338 UI/GTK2/src/mainWindow.cc:318
 #: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:1033
-#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1389
-#: UI/GTK2/src/PinotSettings.cpp:1445 UI/GTK2/src/statisticsDialog.cc:82
-#: UI/GTK2/src/WorkerThreads.cpp:799 UI/GTK2/src/WorkerThreads.cpp:863
+#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1340
+#: UI/GTK2/src/PinotSettings.cpp:1396 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:801 UI/GTK2/src/WorkerThreads.cpp:865
 msgid "My Documents"
 msgstr "Mijn documenten"
 
@@ -53,7 +53,7 @@
 #: UI/GTK2/src/queryDialog_glade.cc:92 UI/GTK2/src/ResultsTree.cpp:151
 #, fuzzy
 msgid "Date"
-msgstr "bij"
+msgstr "Datum"
 
 #: UI/GTK2/src/indexDialog.cc:122
 msgid "Served by"
@@ -270,13 +270,13 @@
 msgid "Couldn't find query"
 msgstr "Kon query niet vinden"
 
-#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:1682
+#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:654
+#: UI/GTK2/src/WorkerThreads.cpp:1686
 msgid "Index"
 msgstr "Inhoudsopgave"
 
-#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:656
-#: UI/GTK2/src/WorkerThreads.cpp:1686
+#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:658
+#: UI/GTK2/src/WorkerThreads.cpp:1690
 msgid "doesn't exist"
 msgstr "bestaat niet"
 
@@ -296,11 +296,6 @@
 msgid "Search the Web and your documents !"
 msgstr "Zoek het web en uw documenten!"
 
-#: UI/GTK2/src/mainWindow.cc:2244
-#, fuzzy
-msgid "(C) 2005 Fabrice Colin"
-msgstr "(C) 2005-2006 Fabrice Colin"
-
 #: UI/GTK2/src/mainWindow.cc:2288
 msgid "Index name"
 msgstr "Naam inhoudsopgave"
@@ -552,7 +547,7 @@
 msgid "Personal"
 msgstr "Persoonlijk"
 
-#: UI/GTK2/src/PinotSettings.cpp:1184
+#: UI/GTK2/src/PinotSettings.cpp:1146
 msgid "Unclassified"
 msgstr "Niet geclassificeerd"
 
@@ -565,26 +560,30 @@
 msgid "Monitor"
 msgstr "Abonneren"
 
-#: UI/GTK2/src/prefsDialog.cc:90 UI/GTK2/src/prefsDialog.cc:98
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Location"
 msgstr "Locatie"
 
-#: UI/GTK2/src/prefsDialog.cc:106
+#: UI/GTK2/src/prefsDialog.cc:98
 msgid "Pattern"
 msgstr "Patroon"
 
-#: UI/GTK2/src/prefsDialog.cc:470
+#: UI/GTK2/src/prefsDialog.cc:315
+msgid "Exclude these patterns from indexing"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:316
+msgid "Only index these patterns"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:406
 msgid "New Label"
 msgstr "Nieuwe naam"
 
-#: UI/GTK2/src/prefsDialog.cc:511
+#: UI/GTK2/src/prefsDialog.cc:447
 msgid "Directory to index"
 msgstr "Directory naar inhoudsopgave"
 
-#: UI/GTK2/src/prefsDialog.cc:569
-msgid "Mbox File Location"
-msgstr "Mbox bestandslocatie"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Google API sleutel:"
@@ -631,7 +630,7 @@
 "Bijschriften worden gebruikt om geindexeerde documenten te klassificeren:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
-#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+#: UI/GTK2/src/prefsDialog_glade.cc:135
 msgid "Add"
 msgstr "Toevoegen"
 
@@ -650,18 +649,15 @@
 "bij veranderingen:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:127
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr "Mailboxen van het type mbox kunnen worden bijgewerkt en geindexeerd:"
+#, fuzzy
+msgid "File patterns:"
+msgstr "Bestandssuffix"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:140
-msgid "Specify any file pattern you wish to exclude from indexing:"
-msgstr "Geef het bestandspatroon aan dat u van indexeren wilt uitsluiten:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:154
+#: UI/GTK2/src/prefsDialog_glade.cc:144
 msgid "Indexing"
 msgstr "Aan het indexeren"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:566
+#: UI/GTK2/src/prefsDialog_glade.cc:507
 msgid "Preferences"
 msgstr "Voorkeuren"
 
@@ -826,67 +822,67 @@
 msgid "Errors"
 msgstr "Fouten"
 
-#: UI/GTK2/src/WorkerThreads.cpp:301
+#: UI/GTK2/src/WorkerThreads.cpp:303
 msgid "Can't index mail here"
 msgstr "Kan mail hier niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322 UI/GTK2/src/WorkerThreads.cpp:555
+#: UI/GTK2/src/WorkerThreads.cpp:324 UI/GTK2/src/WorkerThreads.cpp:557
 msgid "is already being indexed"
 msgstr "wordt al geindexeerd"
 
-#: UI/GTK2/src/WorkerThreads.cpp:332
+#: UI/GTK2/src/WorkerThreads.cpp:334
 msgid "is blacklisted"
 msgstr "staat op blacklist"
 
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:1014
-#: UI/GTK2/src/WorkerThreads.cpp:1097 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1292 UI/GTK2/src/WorkerThreads.cpp:1562
-#: UI/GTK2/src/WorkerThreads.cpp:1695
+#: UI/GTK2/src/WorkerThreads.cpp:667 UI/GTK2/src/WorkerThreads.cpp:1016
+#: UI/GTK2/src/WorkerThreads.cpp:1099 UI/GTK2/src/WorkerThreads.cpp:1108
+#: UI/GTK2/src/WorkerThreads.cpp:1294 UI/GTK2/src/WorkerThreads.cpp:1566
+#: UI/GTK2/src/WorkerThreads.cpp:1699
 msgid "Index error on"
 msgstr "Indexeringsfout op"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816
+#: UI/GTK2/src/WorkerThreads.cpp:818
 msgid "No title"
 msgstr "Geen titel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:918 UI/GTK2/src/WorkerThreads.cpp:1035
+#: UI/GTK2/src/WorkerThreads.cpp:920 UI/GTK2/src/WorkerThreads.cpp:1037
 msgid "Couldn't create search engine"
 msgstr "Kon zoekmachine niet maken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:941 UI/GTK2/src/WorkerThreads.cpp:1047
+#: UI/GTK2/src/WorkerThreads.cpp:943 UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't run query on search engine"
 msgstr "Kon query niet uitvoeren op zoekmachine"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1200
+#: UI/GTK2/src/WorkerThreads.cpp:1202
 msgid "Couldn't obtain downloader for protocol"
 msgstr "Kon geen downloader verkrijgen voor protocol"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/WorkerThreads.cpp:1227
 msgid "Couldn't retrieve"
 msgstr "Kon niet opzoeken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1322 UI/GTK2/src/WorkerThreads.cpp:1401
+#: UI/GTK2/src/WorkerThreads.cpp:1324 UI/GTK2/src/WorkerThreads.cpp:1403
 msgid "Cannot index document type"
 msgstr "Kan documenttype niet indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1326 UI/GTK2/src/WorkerThreads.cpp:1405
+#: UI/GTK2/src/WorkerThreads.cpp:1328 UI/GTK2/src/WorkerThreads.cpp:1407
 msgid "at"
 msgstr "bij"
 
 #. No, it isn't
-#: UI/GTK2/src/WorkerThreads.cpp:1437
+#: UI/GTK2/src/WorkerThreads.cpp:1439
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META taf verbiedt indexeren"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1491
+#: UI/GTK2/src/WorkerThreads.cpp:1495
 msgid "Couldn't index"
 msgstr "Kon niet indexeren"
 
 #. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1573
+#: UI/GTK2/src/WorkerThreads.cpp:1577
 msgid "Couldn't unindex document(s)"
 msgstr "Kan indexering van bestand(en) niet ongedaan maken"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1707
+#: UI/GTK2/src/WorkerThreads.cpp:1711
 msgid "Couldn't update document"
 msgstr "Kan document niet actualiseren"

Modified: trunk/po/pt.po
===================================================================
--- trunk/po/pt.po	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/po/pt.po	2007-07-24 13:34:36 UTC (rev 881)
@@ -5,16 +5,16 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.74\n"
+"Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-19 19:02+0800\n"
-"PO-Revision-Date: 2007-06-21 19:51+0800\n"
+"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"PO-Revision-Date: 2007-07-21 22:12+0000\n"
 "Last-Translator: _PN_boy <pedro_nuno_pn at iol.pt>\n"
 "Language-Team: Portuguese <pt at li.org>\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
-"X-Rosetta-Export-Date: 2007-05-22 11:38:06+0000\n"
+"X-Rosetta-Export-Date: 2007-07-23 14:28:09+0000\n"
 
 #: UI/GTK2/src/EnginesTree.cpp:68
 msgid "Search Engines"
@@ -33,9 +33,9 @@
 #: UI/GTK2/src/mainWindow.cc:1026 UI/GTK2/src/mainWindow.cc:1197
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:1261
 #: UI/GTK2/src/mainWindow.cc:1292 UI/GTK2/src/mainWindow.cc:1903
-#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1388
-#: UI/GTK2/src/PinotSettings.cpp:1444 UI/GTK2/src/statisticsDialog.cc:77
-#: UI/GTK2/src/WorkerThreads.cpp:794 UI/GTK2/src/WorkerThreads.cpp:853
+#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1339
+#: UI/GTK2/src/PinotSettings.cpp:1395 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:855
 msgid "My Web Pages"
 msgstr "As minhas p?ginas Web"
 
@@ -43,9 +43,9 @@
 #. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:338 UI/GTK2/src/mainWindow.cc:318
 #: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:1033
-#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1389
-#: UI/GTK2/src/PinotSettings.cpp:1445 UI/GTK2/src/statisticsDialog.cc:82
-#: UI/GTK2/src/WorkerThreads.cpp:799 UI/GTK2/src/WorkerThreads.cpp:863
+#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1340
+#: UI/GTK2/src/PinotSettings.cpp:1396 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:801 UI/GTK2/src/WorkerThreads.cpp:865
 msgid "My Documents"
 msgstr "Os Meus Documentos"
 
@@ -89,7 +89,7 @@
 
 #: UI/GTK2/src/indexDialog_glade.cc:79 UI/GTK2/src/prefsDialog_glade.cc:82
 msgid "Address:"
-msgstr ""
+msgstr "Endere?o:"
 
 #: UI/GTK2/src/indexDialog_glade.cc:183
 msgid "External index"
@@ -107,7 +107,7 @@
 
 #: UI/GTK2/src/importDialog_glade.cc:71
 msgid "Apply label:"
-msgstr ""
+msgstr "Aplicar t?tulo:"
 
 #: UI/GTK2/src/importDialog_glade.cc:77
 msgid "Import"
@@ -141,11 +141,11 @@
 
 #: UI/GTK2/src/mainWindow.cc:140
 msgid "Query Name"
-msgstr ""
+msgstr "Nome da Consulta"
 
 #: UI/GTK2/src/mainWindow.cc:145
 msgid "Last Run"
-msgstr ""
+msgstr "?ltima execu??o"
 
 #: UI/GTK2/src/mainWindow.cc:150
 msgid "Summary"
@@ -213,16 +213,16 @@
 
 #: UI/GTK2/src/mainWindow.cc:1062
 msgid "More Like"
-msgstr ""
+msgstr "Mais identico"
 
 #: UI/GTK2/src/mainWindow.cc:1123
 msgid "Updated label(s)"
-msgstr ""
+msgstr "T?tulo(s) atualizado(s)"
 
 #. Yes, it did
 #: UI/GTK2/src/mainWindow.cc:1207
 msgid "Updated document"
-msgstr ""
+msgstr "Documento actualizado"
 
 #: UI/GTK2/src/mainWindow.cc:1220
 msgid "Indexed"
@@ -230,15 +230,15 @@
 
 #: UI/GTK2/src/mainWindow.cc:1262
 msgid "Unindexed document(s)"
-msgstr ""
+msgstr "Documento(s) n?o indexado(s)"
 
 #: UI/GTK2/src/mainWindow.cc:1302
 msgid "Updated document properties"
-msgstr ""
+msgstr "Propriedades do documento actualizado"
 
 #: UI/GTK2/src/mainWindow.cc:1355
 msgid "Couldn't rename index, name"
-msgstr ""
+msgstr "N?o foi poss?vel renomear o ?ndice, nome"
 
 #: UI/GTK2/src/mainWindow.cc:1359 UI/GTK2/src/mainWindow.cc:2292
 #: UI/GTK2/src/mainWindow.cc:2829
@@ -247,11 +247,11 @@
 
 #: UI/GTK2/src/mainWindow.cc:1372
 msgid "Couldn't rename index"
-msgstr ""
+msgstr "N?o foi poss?vel renomear o ?ndice"
 
 #: UI/GTK2/src/mainWindow.cc:1385
 msgid "Edited index"
-msgstr ""
+msgstr "?ndice editado"
 
 #: UI/GTK2/src/mainWindow.cc:1711
 #, fuzzy
@@ -261,19 +261,19 @@
 #. Find this query
 #: UI/GTK2/src/mainWindow.cc:1800 UI/GTK2/src/mainWindow.cc:2462
 msgid "Live query"
-msgstr ""
+msgstr "Consulta activa"
 
 #: UI/GTK2/src/mainWindow.cc:1826
 msgid "Couldn't find query"
-msgstr ""
+msgstr "N?o foi poss?vel encontrar a consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:1682
+#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:654
+#: UI/GTK2/src/WorkerThreads.cpp:1686
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:656
-#: UI/GTK2/src/WorkerThreads.cpp:1686
+#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:658
+#: UI/GTK2/src/WorkerThreads.cpp:1690
 msgid "doesn't exist"
 msgstr "n?o existe"
 
@@ -287,23 +287,19 @@
 
 #: UI/GTK2/src/mainWindow.cc:2242
 msgid "A metasearch tool for the Free Desktop"
-msgstr ""
+msgstr "Um mecanismo de metabusca para o Free Desktop"
 
 #: UI/GTK2/src/mainWindow.cc:2243
 msgid "Search the Web and your documents !"
 msgstr "Pesquise a Web e os seus documentos"
 
-#: UI/GTK2/src/mainWindow.cc:2244
-msgid "(C) 2005 Fabrice Colin"
-msgstr "(C) 2005 Fabrice Colin"
-
 #: UI/GTK2/src/mainWindow.cc:2288
 msgid "Index name"
 msgstr "Nome do ?ndice"
 
 #: UI/GTK2/src/mainWindow.cc:2303
 msgid "Couldn't add index"
-msgstr ""
+msgstr "N?o foi poss?vel adicionar ?ndice"
 
 #: UI/GTK2/src/mainWindow.cc:2317
 msgid "Added new index"
@@ -319,43 +315,43 @@
 
 #: UI/GTK2/src/mainWindow.cc:2825
 msgid "Query name"
-msgstr ""
+msgstr "Nome da consulta"
 
 #: UI/GTK2/src/mainWindow.cc:2852
 msgid "Couldn't update query"
-msgstr ""
+msgstr "N?o foi poss?vel actualizar a consulta"
 
 #: UI/GTK2/src/mainWindow.cc:2860
 msgid "Edited query"
-msgstr ""
+msgstr "Consulta editada"
 
 #: UI/GTK2/src/mainWindow.cc:2867
 msgid "Couldn't add query"
-msgstr ""
+msgstr "N?o foi poss?vel adicionar consulta"
 
 #: UI/GTK2/src/mainWindow.cc:2875
 msgid "Added new query"
-msgstr ""
+msgstr "Adicionar nova consulta"
 
 #: UI/GTK2/src/mainWindow.cc:2913
 msgid "Query is not set"
-msgstr ""
+msgstr "Consulta n?o foi actualizada"
 
 #: UI/GTK2/src/mainWindow.cc:2924
 msgid "No search engine selected"
-msgstr ""
+msgstr "Nenhum mecanismo de pesquisa seleccionado"
 
 #: UI/GTK2/src/mainWindow.cc:3011
 msgid "Please set the Google API key first"
-msgstr ""
+msgstr "Primeiro escolha a tecla para a API Google"
 
 #: UI/GTK2/src/mainWindow.cc:3020
 msgid "Running query"
-msgstr ""
+msgstr "A executar consulta"
 
 #: UI/GTK2/src/mainWindow.cc:3233
 msgid "No default application defined for type"
-msgstr ""
+msgstr "Nenhuma aplica??o associada ao tipo"
 
 #: UI/GTK2/src/mainWindow_glade.cc:126
 msgid "Query:"
@@ -367,7 +363,7 @@
 
 #: UI/GTK2/src/mainWindow_glade.cc:147
 msgid "Stored queries"
-msgstr ""
+msgstr "Consultas armazenadas"
 
 #: UI/GTK2/src/mainWindow_glade.cc:164 UI/GTK2/src/statisticsDialog.cc:50
 #: UI/GTK2/src/statisticsDialog_glade.cc:87
@@ -384,7 +380,7 @@
 
 #: UI/GTK2/src/mainWindow_glade.cc:191
 msgid "Show Extract"
-msgstr ""
+msgstr "Mostrar extracto"
 
 #: UI/GTK2/src/mainWindow_glade.cc:194
 msgid "Group By"
@@ -412,7 +408,7 @@
 
 #: UI/GTK2/src/mainWindow_glade.cc:218
 msgid "List Contents Of"
-msgstr ""
+msgstr "Mostrar conte?do(s) de"
 
 #: UI/GTK2/src/mainWindow_glade.cc:227
 msgid "View"
@@ -424,7 +420,7 @@
 
 #: UI/GTK2/src/mainWindow_glade.cc:233
 msgid "Unindex"
-msgstr ""
+msgstr "Retirar do ?ndice"
 
 #: UI/GTK2/src/mainWindow_glade.cc:236
 #: UI/GTK2/src/propertiesDialog_glade.cc:177
@@ -523,15 +519,15 @@
 
 #: UI/GTK2/src/pinot.cc:267
 msgid "Couldn't open index"
-msgstr ""
+msgstr "N?o foi poss?vel abrir o ?ndice"
 
 #: UI/GTK2/src/pinot.cc:288
 msgid "Couldn't create history database"
-msgstr ""
+msgstr "N?o foi poss?vel criar base de dados do hist?rico"
 
 #: UI/GTK2/src/pinot.cc:329
 msgid "Updating all documents in My Web Pages is recommended"
-msgstr ""
+msgstr "A actualizar todos os documentos nas Minhas P?ginas Web ? recomendado"
 
 #. Add default labels
 #: UI/GTK2/src/PinotSettings.cpp:288
@@ -546,7 +542,7 @@
 msgid "Personal"
 msgstr "Pessoal"
 
-#: UI/GTK2/src/PinotSettings.cpp:1184
+#: UI/GTK2/src/PinotSettings.cpp:1146
 msgid "Unclassified"
 msgstr "N?o classificado"
 
@@ -558,29 +554,33 @@
 msgid "Monitor"
 msgstr "Supervisar"
 
-#: UI/GTK2/src/prefsDialog.cc:90 UI/GTK2/src/prefsDialog.cc:98
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Location"
 msgstr "Localiza??o"
 
-#: UI/GTK2/src/prefsDialog.cc:106
+#: UI/GTK2/src/prefsDialog.cc:98
 msgid "Pattern"
 msgstr "Padr?o:"
 
-#: UI/GTK2/src/prefsDialog.cc:470
-msgid "New Label"
+#: UI/GTK2/src/prefsDialog.cc:315
+msgid "Exclude these patterns from indexing"
 msgstr ""
 
-#: UI/GTK2/src/prefsDialog.cc:511
-msgid "Directory to index"
+#: UI/GTK2/src/prefsDialog.cc:316
+msgid "Only index these patterns"
 msgstr ""
 
-#: UI/GTK2/src/prefsDialog.cc:569
-msgid "Mbox File Location"
-msgstr ""
+#: UI/GTK2/src/prefsDialog.cc:406
+msgid "New Label"
+msgstr "Novo t?tulo"
 
+#: UI/GTK2/src/prefsDialog.cc:447
+msgid "Directory to index"
+msgstr "Direct?rio a indexar"
+
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
-msgstr ""
+msgstr "Tecla para a API Google:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:69
 msgid "New results:"
@@ -592,15 +592,15 @@
 
 #: UI/GTK2/src/prefsDialog_glade.cc:71
 msgid "Enable search terms suggestion"
-msgstr ""
+msgstr "Habilitar sugest?o de termos"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:73
 msgid "Ignore robots.txt and Robots META tag"
-msgstr ""
+msgstr "Ignorar robots.txt e Robots META tag"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:74
 msgid "HTTP crawling:"
-msgstr ""
+msgstr "HTTP crawling:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:77
 msgid "General"
@@ -608,22 +608,22 @@
 
 #: UI/GTK2/src/prefsDialog_glade.cc:79
 msgid "Direct connection to the Internet"
-msgstr ""
+msgstr "Conex?o directa ? Internet"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:80
 msgid "Manual proxy configuration:"
-msgstr ""
+msgstr "Configura??o manual do proxy:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:93
 msgid "Network"
-msgstr ""
+msgstr "Rede"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:94
 msgid "Labels are used to classify indexed documents:"
-msgstr ""
+msgstr "T?tulos utilizados para classificar os documentos indexados:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
-#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+#: UI/GTK2/src/prefsDialog_glade.cc:135
 msgid "Add"
 msgstr "Adicionar"
 
@@ -638,20 +638,19 @@
 #: UI/GTK2/src/prefsDialog_glade.cc:114
 msgid "These directories will be indexed and optionally monitored for changes:"
 msgstr ""
+"Direct?rios que ser?o indexados e opcionalmente ser?o monitorizadas as "
+"altera??es:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:127
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr ""
+#, fuzzy
+msgid "File patterns:"
+msgstr "Extens?o do ficheiro"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:140
-msgid "Specify any file pattern you wish to exclude from indexing:"
-msgstr ""
-
-#: UI/GTK2/src/prefsDialog_glade.cc:154
+#: UI/GTK2/src/prefsDialog_glade.cc:144
 msgid "Indexing"
 msgstr "Indexando"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:566
+#: UI/GTK2/src/prefsDialog_glade.cc:507
 msgid "Preferences"
 msgstr "Prefer?ncias"
 
@@ -728,15 +727,15 @@
 
 #: UI/GTK2/src/queryDialog_glade.cc:81
 msgid "Query Text"
-msgstr ""
+msgstr "Texto da consulta"
 
 #: UI/GTK2/src/queryDialog_glade.cc:83
 msgid "Index results with label"
-msgstr ""
+msgstr "Indexar todos resultados com t?tulo"
 
 #: UI/GTK2/src/queryDialog_glade.cc:86
 msgid "Number of results:"
-msgstr ""
+msgstr "N?mero de resultados:"
 
 #: UI/GTK2/src/queryDialog_glade.cc:89
 msgid "Start date:"
@@ -748,12 +747,12 @@
 
 #: UI/GTK2/src/queryDialog_glade.cc:201
 msgid "Query parameters"
-msgstr ""
+msgstr "Par?metros da consulta"
 
 #. This is the score column
 #: UI/GTK2/src/ResultsTree.cpp:122
 msgid "Score"
-msgstr ""
+msgstr "Pontua??o"
 
 #: UI/GTK2/src/ResultsTree.cpp:180
 msgid "Extract"
@@ -769,7 +768,7 @@
 
 #: UI/GTK2/src/statisticsDialog.cc:92
 msgid "Daemon"
-msgstr ""
+msgstr "Daemon"
 
 #: UI/GTK2/src/statisticsDialog.cc:128 UI/GTK2/src/statisticsDialog.cc:143
 msgid "documents"
@@ -777,11 +776,11 @@
 
 #: UI/GTK2/src/statisticsDialog.cc:132 UI/GTK2/src/statisticsDialog.cc:147
 msgid "Unknown error"
-msgstr ""
+msgstr "Erro desconhecido"
 
 #: UI/GTK2/src/statisticsDialog.cc:154
 msgid "Viewed"
-msgstr ""
+msgstr "Visualizado"
 
 #: UI/GTK2/src/statisticsDialog.cc:154
 msgid "results"
@@ -794,7 +793,7 @@
 
 #: UI/GTK2/src/statisticsDialog.cc:175
 msgid "Currently not running"
-msgstr ""
+msgstr "Presentemente n?o est? a correr"
 
 #: UI/GTK2/src/statisticsDialog.cc:182
 msgid "Crawled"
@@ -808,67 +807,67 @@
 msgid "Errors"
 msgstr "Erros"
 
-#: UI/GTK2/src/WorkerThreads.cpp:301
+#: UI/GTK2/src/WorkerThreads.cpp:303
 msgid "Can't index mail here"
-msgstr ""
+msgstr "N?o foi poss?vel indexar o mail aqui"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322 UI/GTK2/src/WorkerThreads.cpp:555
+#: UI/GTK2/src/WorkerThreads.cpp:324 UI/GTK2/src/WorkerThreads.cpp:557
 msgid "is already being indexed"
-msgstr ""
+msgstr "j? est? a ser indexado"
 
-#: UI/GTK2/src/WorkerThreads.cpp:332
+#: UI/GTK2/src/WorkerThreads.cpp:334
 msgid "is blacklisted"
-msgstr ""
+msgstr "est? na lista negra"
 
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:1014
-#: UI/GTK2/src/WorkerThreads.cpp:1097 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1292 UI/GTK2/src/WorkerThreads.cpp:1562
-#: UI/GTK2/src/WorkerThreads.cpp:1695
+#: UI/GTK2/src/WorkerThreads.cpp:667 UI/GTK2/src/WorkerThreads.cpp:1016
+#: UI/GTK2/src/WorkerThreads.cpp:1099 UI/GTK2/src/WorkerThreads.cpp:1108
+#: UI/GTK2/src/WorkerThreads.cpp:1294 UI/GTK2/src/WorkerThreads.cpp:1566
+#: UI/GTK2/src/WorkerThreads.cpp:1699
 msgid "Index error on"
-msgstr ""
+msgstr "Erro na indexa??o em"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816
+#: UI/GTK2/src/WorkerThreads.cpp:818
 msgid "No title"
 msgstr "Sem t?tulo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:918 UI/GTK2/src/WorkerThreads.cpp:1035
+#: UI/GTK2/src/WorkerThreads.cpp:920 UI/GTK2/src/WorkerThreads.cpp:1037
 msgid "Couldn't create search engine"
-msgstr ""
+msgstr "N?o foi poss?vel criar mecanismo de pesquisa"
 
-#: UI/GTK2/src/WorkerThreads.cpp:941 UI/GTK2/src/WorkerThreads.cpp:1047
+#: UI/GTK2/src/WorkerThreads.cpp:943 UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't run query on search engine"
-msgstr ""
+msgstr "N?o foi poss?vel efectuar consulta no mecanismo de pesquisa"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1200
+#: UI/GTK2/src/WorkerThreads.cpp:1202
 msgid "Couldn't obtain downloader for protocol"
-msgstr ""
+msgstr "N?o foi poss?vel obter fonte de transfer?ncia para o protocolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/WorkerThreads.cpp:1227
 msgid "Couldn't retrieve"
-msgstr ""
+msgstr "N?o foi poss?vel carregar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1322 UI/GTK2/src/WorkerThreads.cpp:1401
+#: UI/GTK2/src/WorkerThreads.cpp:1324 UI/GTK2/src/WorkerThreads.cpp:1403
 msgid "Cannot index document type"
-msgstr ""
+msgstr "Imposs?vel indexar tipo de ficheiro"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1326 UI/GTK2/src/WorkerThreads.cpp:1405
+#: UI/GTK2/src/WorkerThreads.cpp:1328 UI/GTK2/src/WorkerThreads.cpp:1407
 msgid "at"
-msgstr ""
+msgstr "no"
 
 #. No, it isn't
-#: UI/GTK2/src/WorkerThreads.cpp:1437
+#: UI/GTK2/src/WorkerThreads.cpp:1439
 msgid "Robots META tag forbids indexing"
-msgstr ""
+msgstr "Robots META tag n?o s?o permitidos no ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1491
+#: UI/GTK2/src/WorkerThreads.cpp:1495
 msgid "Couldn't index"
-msgstr ""
+msgstr "N?o foi poss?vel indexar"
 
 #. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1573
+#: UI/GTK2/src/WorkerThreads.cpp:1577
 msgid "Couldn't unindex document(s)"
-msgstr ""
+msgstr "N?o foi poss?vel remover documento(s) do ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1707
+#: UI/GTK2/src/WorkerThreads.cpp:1711
 msgid "Couldn't update document"
-msgstr ""
+msgstr "N?o foi poss?vel actualizar o documento"

Modified: trunk/po/pt_BR.po
===================================================================
--- trunk/po/pt_BR.po	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/po/pt_BR.po	2007-07-24 13:34:36 UTC (rev 881)
@@ -5,10 +5,10 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.74\n"
+"Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-19 19:02+0800\n"
-"PO-Revision-Date: 2007-06-21 19:51+0800\n"
+"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"PO-Revision-Date: 2007-07-21 12:37+0800\n"
 "Last-Translator: Leonardo Melo <leonardovazmelo at gmail.com>\n"
 "Language-Team: Portuguese (Brazil) <pt_BR at li.org>\n"
 "MIME-Version: 1.0\n"
@@ -32,9 +32,9 @@
 #: UI/GTK2/src/mainWindow.cc:1026 UI/GTK2/src/mainWindow.cc:1197
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:1261
 #: UI/GTK2/src/mainWindow.cc:1292 UI/GTK2/src/mainWindow.cc:1903
-#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1388
-#: UI/GTK2/src/PinotSettings.cpp:1444 UI/GTK2/src/statisticsDialog.cc:77
-#: UI/GTK2/src/WorkerThreads.cpp:794 UI/GTK2/src/WorkerThreads.cpp:853
+#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1339
+#: UI/GTK2/src/PinotSettings.cpp:1395 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:855
 msgid "My Web Pages"
 msgstr "Minhas P?ginas Web"
 
@@ -42,9 +42,9 @@
 #. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:338 UI/GTK2/src/mainWindow.cc:318
 #: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:1033
-#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1389
-#: UI/GTK2/src/PinotSettings.cpp:1445 UI/GTK2/src/statisticsDialog.cc:82
-#: UI/GTK2/src/WorkerThreads.cpp:799 UI/GTK2/src/WorkerThreads.cpp:863
+#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1340
+#: UI/GTK2/src/PinotSettings.cpp:1396 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:801 UI/GTK2/src/WorkerThreads.cpp:865
 msgid "My Documents"
 msgstr "Meus Documentos"
 
@@ -269,13 +269,13 @@
 msgid "Couldn't find query"
 msgstr "N?o foi poss?vel encontrar consulta"
 
-#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:1682
+#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:654
+#: UI/GTK2/src/WorkerThreads.cpp:1686
 msgid "Index"
 msgstr "?ndice"
 
-#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:656
-#: UI/GTK2/src/WorkerThreads.cpp:1686
+#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:658
+#: UI/GTK2/src/WorkerThreads.cpp:1690
 msgid "doesn't exist"
 msgstr "n?o existe"
 
@@ -295,10 +295,6 @@
 msgid "Search the Web and your documents !"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2244
-msgid "(C) 2005 Fabrice Colin"
-msgstr "(C) 2005 Fabrice Colin"
-
 #: UI/GTK2/src/mainWindow.cc:2288
 msgid "Index name"
 msgstr "Nome do ?ndice"
@@ -548,7 +544,7 @@
 msgid "Personal"
 msgstr "Pessoal"
 
-#: UI/GTK2/src/PinotSettings.cpp:1184
+#: UI/GTK2/src/PinotSettings.cpp:1146
 msgid "Unclassified"
 msgstr "N?o classificado"
 
@@ -560,26 +556,30 @@
 msgid "Monitor"
 msgstr "Monitor"
 
-#: UI/GTK2/src/prefsDialog.cc:90 UI/GTK2/src/prefsDialog.cc:98
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Location"
 msgstr "Localiza??o"
 
-#: UI/GTK2/src/prefsDialog.cc:106
+#: UI/GTK2/src/prefsDialog.cc:98
 msgid "Pattern"
 msgstr "Conjunto"
 
-#: UI/GTK2/src/prefsDialog.cc:470
+#: UI/GTK2/src/prefsDialog.cc:315
+msgid "Exclude these patterns from indexing"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:316
+msgid "Only index these patterns"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:406
 msgid "New Label"
 msgstr "Novo t?tulo"
 
-#: UI/GTK2/src/prefsDialog.cc:511
+#: UI/GTK2/src/prefsDialog.cc:447
 msgid "Directory to index"
 msgstr "Diret?rio do ?ndice"
 
-#: UI/GTK2/src/prefsDialog.cc:569
-msgid "Mbox File Location"
-msgstr "Mbox localiza??o do arquivo"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Tecla para Google API:"
@@ -627,7 +627,7 @@
 msgstr "T?tulos utilizados para classificar documentos indexados:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
-#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+#: UI/GTK2/src/prefsDialog_glade.cc:135
 msgid "Add"
 msgstr "Adicionar"
 
@@ -648,20 +648,14 @@
 
 #: UI/GTK2/src/prefsDialog_glade.cc:127
 #, fuzzy
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr "Caixas de entrada do tipo mbox podem ser monitoradas e indexadas:"
+msgid "File patterns:"
+msgstr "Extens?o do arquivo"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:140
-msgid "Specify any file pattern you wish to exclude from indexing:"
-msgstr ""
-"Especifique qualquer conjunto de arquivos que voc? deseja excluir da "
-"indexa??o:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:154
+#: UI/GTK2/src/prefsDialog_glade.cc:144
 msgid "Indexing"
 msgstr "Indexando"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:566
+#: UI/GTK2/src/prefsDialog_glade.cc:507
 msgid "Preferences"
 msgstr "Prefer?ncias"
 
@@ -825,67 +819,67 @@
 msgid "Errors"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:301
+#: UI/GTK2/src/WorkerThreads.cpp:303
 msgid "Can't index mail here"
 msgstr "N?o foi poss?vel indexar mail aqui"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322 UI/GTK2/src/WorkerThreads.cpp:555
+#: UI/GTK2/src/WorkerThreads.cpp:324 UI/GTK2/src/WorkerThreads.cpp:557
 msgid "is already being indexed"
 msgstr "j? est? sendo indexado"
 
-#: UI/GTK2/src/WorkerThreads.cpp:332
+#: UI/GTK2/src/WorkerThreads.cpp:334
 msgid "is blacklisted"
 msgstr "est? na lista negra"
 
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:1014
-#: UI/GTK2/src/WorkerThreads.cpp:1097 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1292 UI/GTK2/src/WorkerThreads.cpp:1562
-#: UI/GTK2/src/WorkerThreads.cpp:1695
+#: UI/GTK2/src/WorkerThreads.cpp:667 UI/GTK2/src/WorkerThreads.cpp:1016
+#: UI/GTK2/src/WorkerThreads.cpp:1099 UI/GTK2/src/WorkerThreads.cpp:1108
+#: UI/GTK2/src/WorkerThreads.cpp:1294 UI/GTK2/src/WorkerThreads.cpp:1566
+#: UI/GTK2/src/WorkerThreads.cpp:1699
 msgid "Index error on"
 msgstr "Erro no ?ndice no"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816
+#: UI/GTK2/src/WorkerThreads.cpp:818
 msgid "No title"
 msgstr "Sem t?tulo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:918 UI/GTK2/src/WorkerThreads.cpp:1035
+#: UI/GTK2/src/WorkerThreads.cpp:920 UI/GTK2/src/WorkerThreads.cpp:1037
 msgid "Couldn't create search engine"
 msgstr "N?o foi poss?vel criar mecanismo de pesquisa"
 
-#: UI/GTK2/src/WorkerThreads.cpp:941 UI/GTK2/src/WorkerThreads.cpp:1047
+#: UI/GTK2/src/WorkerThreads.cpp:943 UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't run query on search engine"
 msgstr "N?o foi poss?vel executar consulta no mecanismo de pesquisa"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1200
+#: UI/GTK2/src/WorkerThreads.cpp:1202
 msgid "Couldn't obtain downloader for protocol"
 msgstr "N?o foi poss?vel obter fonte de download para o protocolo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/WorkerThreads.cpp:1227
 msgid "Couldn't retrieve"
 msgstr "N?o foi poss?vel carregar"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1322 UI/GTK2/src/WorkerThreads.cpp:1401
+#: UI/GTK2/src/WorkerThreads.cpp:1324 UI/GTK2/src/WorkerThreads.cpp:1403
 msgid "Cannot index document type"
 msgstr "Imposs?vel indexar tipo de arquivo"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1326 UI/GTK2/src/WorkerThreads.cpp:1405
+#: UI/GTK2/src/WorkerThreads.cpp:1328 UI/GTK2/src/WorkerThreads.cpp:1407
 msgid "at"
 msgstr "no"
 
 #. No, it isn't
-#: UI/GTK2/src/WorkerThreads.cpp:1437
+#: UI/GTK2/src/WorkerThreads.cpp:1439
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META tag n?o s?o permitidos no ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1491
+#: UI/GTK2/src/WorkerThreads.cpp:1495
 msgid "Couldn't index"
 msgstr "N?o foi poss?vel indexar"
 
 #. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1573
+#: UI/GTK2/src/WorkerThreads.cpp:1577
 msgid "Couldn't unindex document(s)"
 msgstr "N?o foi poss?vel remover documento(s) do ?ndice"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1707
+#: UI/GTK2/src/WorkerThreads.cpp:1711
 msgid "Couldn't update document"
 msgstr "N?o foi poss?vel atualizar documento"

Modified: trunk/po/ru.po
===================================================================
--- trunk/po/ru.po	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/po/ru.po	2007-07-24 13:34:36 UTC (rev 881)
@@ -5,10 +5,10 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.74\n"
+"Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-19 19:02+0800\n"
-"PO-Revision-Date: 2007-06-21 19:51+0800\n"
+"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"PO-Revision-Date: 2007-07-21 12:37+0800\n"
 "Last-Translator: Sergey Vostrikov <s.vostrikov at gmail.com>\n"
 "Language-Team: Russian <ru at li.org>\n"
 "MIME-Version: 1.0\n"
@@ -32,9 +32,9 @@
 #: UI/GTK2/src/mainWindow.cc:1026 UI/GTK2/src/mainWindow.cc:1197
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:1261
 #: UI/GTK2/src/mainWindow.cc:1292 UI/GTK2/src/mainWindow.cc:1903
-#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1388
-#: UI/GTK2/src/PinotSettings.cpp:1444 UI/GTK2/src/statisticsDialog.cc:77
-#: UI/GTK2/src/WorkerThreads.cpp:794 UI/GTK2/src/WorkerThreads.cpp:853
+#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1339
+#: UI/GTK2/src/PinotSettings.cpp:1395 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:855
 msgid "My Web Pages"
 msgstr "??? web-????????"
 
@@ -42,9 +42,9 @@
 #. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:338 UI/GTK2/src/mainWindow.cc:318
 #: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:1033
-#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1389
-#: UI/GTK2/src/PinotSettings.cpp:1445 UI/GTK2/src/statisticsDialog.cc:82
-#: UI/GTK2/src/WorkerThreads.cpp:799 UI/GTK2/src/WorkerThreads.cpp:863
+#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1340
+#: UI/GTK2/src/PinotSettings.cpp:1396 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:801 UI/GTK2/src/WorkerThreads.cpp:865
 msgid "My Documents"
 msgstr "??? ?????????"
 
@@ -269,13 +269,13 @@
 msgid "Couldn't find query"
 msgstr "?????????? ????? ??????"
 
-#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:1682
+#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:654
+#: UI/GTK2/src/WorkerThreads.cpp:1686
 msgid "Index"
 msgstr "??????"
 
-#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:656
-#: UI/GTK2/src/WorkerThreads.cpp:1686
+#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:658
+#: UI/GTK2/src/WorkerThreads.cpp:1690
 msgid "doesn't exist"
 msgstr "???"
 
@@ -295,10 +295,6 @@
 msgid "Search the Web and your documents !"
 msgstr ""
 
-#: UI/GTK2/src/mainWindow.cc:2244
-msgid "(C) 2005 Fabrice Colin"
-msgstr "(C) 2005 Fabrice Colin"
-
 #: UI/GTK2/src/mainWindow.cc:2288
 msgid "Index name"
 msgstr "???????? ???????"
@@ -548,7 +544,7 @@
 msgid "Personal"
 msgstr "??????"
 
-#: UI/GTK2/src/PinotSettings.cpp:1184
+#: UI/GTK2/src/PinotSettings.cpp:1146
 msgid "Unclassified"
 msgstr "??????????????"
 
@@ -560,26 +556,30 @@
 msgid "Monitor"
 msgstr "???????"
 
-#: UI/GTK2/src/prefsDialog.cc:90 UI/GTK2/src/prefsDialog.cc:98
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Location"
 msgstr "?????????????????"
 
-#: UI/GTK2/src/prefsDialog.cc:106
+#: UI/GTK2/src/prefsDialog.cc:98
 msgid "Pattern"
 msgstr "???????"
 
-#: UI/GTK2/src/prefsDialog.cc:470
+#: UI/GTK2/src/prefsDialog.cc:315
+msgid "Exclude these patterns from indexing"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:316
+msgid "Only index these patterns"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:406
 msgid "New Label"
 msgstr "????? ?????"
 
-#: UI/GTK2/src/prefsDialog.cc:511
+#: UI/GTK2/src/prefsDialog.cc:447
 msgid "Directory to index"
 msgstr "????? ??? ??????????????"
 
-#: UI/GTK2/src/prefsDialog.cc:569
-msgid "Mbox File Location"
-msgstr "?????????????? ????? Mbox"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "???? Google API:"
@@ -625,7 +625,7 @@
 msgstr "?????, ???????????? ??? ????????????? ??????????, ????????????? :"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
-#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+#: UI/GTK2/src/prefsDialog_glade.cc:135
 msgid "Add"
 msgstr "????????"
 
@@ -643,18 +643,15 @@
 "??? ???????? ????? ??????????????? ? ????????????? ??? ???????? ?????????:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:127
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr "???????? ????? ???? mbox ????? ?????????????? ? ?????????????:"
+#, fuzzy
+msgid "File patterns:"
+msgstr "?????????? ?????"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:140
-msgid "Specify any file pattern you wish to exclude from indexing:"
-msgstr "??????? ????? ???? ?? ?????, ??????? ????? ????????? ?? ???????:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:154
+#: UI/GTK2/src/prefsDialog_glade.cc:144
 msgid "Indexing"
 msgstr "??????????????"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:566
+#: UI/GTK2/src/prefsDialog_glade.cc:507
 msgid "Preferences"
 msgstr "?????????"
 
@@ -818,67 +815,67 @@
 msgid "Errors"
 msgstr ""
 
-#: UI/GTK2/src/WorkerThreads.cpp:301
+#: UI/GTK2/src/WorkerThreads.cpp:303
 msgid "Can't index mail here"
 msgstr "?????? ????????????? ????? ?????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322 UI/GTK2/src/WorkerThreads.cpp:555
+#: UI/GTK2/src/WorkerThreads.cpp:324 UI/GTK2/src/WorkerThreads.cpp:557
 msgid "is already being indexed"
 msgstr "??? ??????????????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:332
+#: UI/GTK2/src/WorkerThreads.cpp:334
 msgid "is blacklisted"
 msgstr "??????????? ? ?????? ??????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:1014
-#: UI/GTK2/src/WorkerThreads.cpp:1097 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1292 UI/GTK2/src/WorkerThreads.cpp:1562
-#: UI/GTK2/src/WorkerThreads.cpp:1695
+#: UI/GTK2/src/WorkerThreads.cpp:667 UI/GTK2/src/WorkerThreads.cpp:1016
+#: UI/GTK2/src/WorkerThreads.cpp:1099 UI/GTK2/src/WorkerThreads.cpp:1108
+#: UI/GTK2/src/WorkerThreads.cpp:1294 UI/GTK2/src/WorkerThreads.cpp:1566
+#: UI/GTK2/src/WorkerThreads.cpp:1699
 msgid "Index error on"
 msgstr "?????? ??????? ??"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816
+#: UI/GTK2/src/WorkerThreads.cpp:818
 msgid "No title"
 msgstr "??? ????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:918 UI/GTK2/src/WorkerThreads.cpp:1035
+#: UI/GTK2/src/WorkerThreads.cpp:920 UI/GTK2/src/WorkerThreads.cpp:1037
 msgid "Couldn't create search engine"
 msgstr "?? ??????? ??????? ????????? ???????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:941 UI/GTK2/src/WorkerThreads.cpp:1047
+#: UI/GTK2/src/WorkerThreads.cpp:943 UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't run query on search engine"
 msgstr "?? ??????? ????????? ?????? ? ????????? ???????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1200
+#: UI/GTK2/src/WorkerThreads.cpp:1202
 msgid "Couldn't obtain downloader for protocol"
 msgstr "?? ??????? ???????? ????????? ??? ?????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/WorkerThreads.cpp:1227
 msgid "Couldn't retrieve"
 msgstr "?? ??????? ???????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1322 UI/GTK2/src/WorkerThreads.cpp:1401
+#: UI/GTK2/src/WorkerThreads.cpp:1324 UI/GTK2/src/WorkerThreads.cpp:1403
 msgid "Cannot index document type"
 msgstr "?????????? ????????????? ?????? ??? ??????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1326 UI/GTK2/src/WorkerThreads.cpp:1405
+#: UI/GTK2/src/WorkerThreads.cpp:1328 UI/GTK2/src/WorkerThreads.cpp:1407
 msgid "at"
 msgstr "?"
 
 #. No, it isn't
-#: UI/GTK2/src/WorkerThreads.cpp:1437
+#: UI/GTK2/src/WorkerThreads.cpp:1439
 msgid "Robots META tag forbids indexing"
 msgstr "META-???? ??????? ????????? ??????????????"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1491
+#: UI/GTK2/src/WorkerThreads.cpp:1495
 msgid "Couldn't index"
 msgstr "?????????? ????????? ??????"
 
 #. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1573
+#: UI/GTK2/src/WorkerThreads.cpp:1577
 msgid "Couldn't unindex document(s)"
 msgstr "?????????? ??????????????? ????????(?)"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1707
+#: UI/GTK2/src/WorkerThreads.cpp:1711
 msgid "Couldn't update document"
 msgstr "?????????? ???????? ????????"

Modified: trunk/po/sv.po
===================================================================
--- trunk/po/sv.po	2007-07-24 13:00:35 UTC (rev 880)
+++ trunk/po/sv.po	2007-07-24 13:34:36 UTC (rev 881)
@@ -5,9 +5,9 @@
 #, fuzzy
 msgid ""
 msgstr ""
-"Project-Id-Version: pinot 0.74\n"
+"Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-05-19 19:02+0800\n"
+"POT-Creation-Date: 2007-07-24 20:39+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Daniel Nylander <yeager at ubuntu.com>\n"
 "Language-Team: Swedish <sv at li.org>\n"
@@ -32,9 +32,9 @@
 #: UI/GTK2/src/mainWindow.cc:1026 UI/GTK2/src/mainWindow.cc:1197
 #: UI/GTK2/src/mainWindow.cc:1239 UI/GTK2/src/mainWindow.cc:1261
 #: UI/GTK2/src/mainWindow.cc:1292 UI/GTK2/src/mainWindow.cc:1903
-#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1388
-#: UI/GTK2/src/PinotSettings.cpp:1444 UI/GTK2/src/statisticsDialog.cc:77
-#: UI/GTK2/src/WorkerThreads.cpp:794 UI/GTK2/src/WorkerThreads.cpp:853
+#: UI/GTK2/src/PinotSettings.cpp:282 UI/GTK2/src/PinotSettings.cpp:1339
+#: UI/GTK2/src/PinotSettings.cpp:1395 UI/GTK2/src/statisticsDialog.cc:77
+#: UI/GTK2/src/WorkerThreads.cpp:796 UI/GTK2/src/WorkerThreads.cpp:855
 msgid "My Web Pages"
 msgstr "Mina webbsidor"
 
@@ -42,9 +42,9 @@
 #. Bind the callback's parameter to the index name
 #: UI/GTK2/src/EnginesTree.cpp:338 UI/GTK2/src/mainWindow.cc:318
 #: UI/GTK2/src/mainWindow.cc:321 UI/GTK2/src/mainWindow.cc:1033
-#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1389
-#: UI/GTK2/src/PinotSettings.cpp:1445 UI/GTK2/src/statisticsDialog.cc:82
-#: UI/GTK2/src/WorkerThreads.cpp:799 UI/GTK2/src/WorkerThreads.cpp:863
+#: UI/GTK2/src/PinotSettings.cpp:283 UI/GTK2/src/PinotSettings.cpp:1340
+#: UI/GTK2/src/PinotSettings.cpp:1396 UI/GTK2/src/statisticsDialog.cc:82
+#: UI/GTK2/src/WorkerThreads.cpp:801 UI/GTK2/src/WorkerThreads.cpp:865
 msgid "My Documents"
 msgstr "Mina dokument"
 
@@ -268,13 +268,13 @@
 msgid "Couldn't find query"
 msgstr "Kunde inte hitta fr?ga"
 
-#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:652
-#: UI/GTK2/src/WorkerThreads.cpp:1682
+#: UI/GTK2/src/mainWindow.cc:2018 UI/GTK2/src/WorkerThreads.cpp:654
+#: UI/GTK2/src/WorkerThreads.cpp:1686
 msgid "Index"
 msgstr "Index"
 
-#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:656
-#: UI/GTK2/src/WorkerThreads.cpp:1686
+#: UI/GTK2/src/mainWindow.cc:2022 UI/GTK2/src/WorkerThreads.cpp:658
+#: UI/GTK2/src/WorkerThreads.cpp:1690
 msgid "doesn't exist"
 msgstr "finns inte"
 
@@ -294,10 +294,6 @@
 msgid "Search the Web and your documents !"
 msgstr "S?k p? webben och i dina dokument!"
 
-#: UI/GTK2/src/mainWindow.cc:2244
-msgid "(C) 2005 Fabrice Colin"
-msgstr "? 2005 Fabrice Colin"
-
 #: UI/GTK2/src/mainWindow.cc:2288
 msgid "Index name"
 msgstr "Indexnamn"
@@ -548,7 +544,7 @@
 msgid "Personal"
 msgstr "Personlig"
 
-#: UI/GTK2/src/PinotSettings.cpp:1184
+#: UI/GTK2/src/PinotSettings.cpp:1146
 msgid "Unclassified"
 msgstr "Oklassificerad"
 
@@ -560,26 +556,30 @@
 msgid "Monitor"
 msgstr "?vervaka"
 
-#: UI/GTK2/src/prefsDialog.cc:90 UI/GTK2/src/prefsDialog.cc:98
+#: UI/GTK2/src/prefsDialog.cc:90
 msgid "Location"
 msgstr "Plats"
 
-#: UI/GTK2/src/prefsDialog.cc:106
+#: UI/GTK2/src/prefsDialog.cc:98
 msgid "Pattern"
 msgstr "M?nster"
 
-#: UI/GTK2/src/prefsDialog.cc:470
+#: UI/GTK2/src/prefsDialog.cc:315
+msgid "Exclude these patterns from indexing"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:316
+msgid "Only index these patterns"
+msgstr ""
+
+#: UI/GTK2/src/prefsDialog.cc:406
 msgid "New Label"
 msgstr "Ny etikett"
 
-#: UI/GTK2/src/prefsDialog.cc:511
+#: UI/GTK2/src/prefsDialog.cc:447
 msgid "Directory to index"
 msgstr "Katalog f?r index"
 
-#: UI/GTK2/src/prefsDialog.cc:569
-msgid "Mbox File Location"
-msgstr "Plats f?r mbox-fil"
-
 #: UI/GTK2/src/prefsDialog_glade.cc:66
 msgid "Google API key:"
 msgstr "Google API-nyckel:"
@@ -625,7 +625,7 @@
 msgstr "Etiketter som anv?nds f?r att klassificera indexerade dokument:"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:99 UI/GTK2/src/prefsDialog_glade.cc:119
-#: UI/GTK2/src/prefsDialog_glade.cc:132 UI/GTK2/src/prefsDialog_glade.cc:145
+#: UI/GTK2/src/prefsDialog_glade.cc:135
 msgid "Add"
 msgstr "L?gg till"
 
@@ -644,18 +644,15 @@
 "(valfritt):"
 
 #: UI/GTK2/src/prefsDialog_glade.cc:127
-msgid "Mail boxes of type mbox can be monitored and indexed:"
-msgstr "Postl?dor av typen mbox kan ?vervakas och indexeras:"
+#, fuzzy
+msgid "File patterns:"
+msgstr "Fil?ndelse"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:140
-msgid "Specify any file pattern you wish to exclude from indexing:"
-msgstr "Ange de film?nster som du ?nskar undanta fr?n indexering:"
-
-#: UI/GTK2/src/prefsDialog_glade.cc:154
+#: UI/GTK2/src/prefsDialog_glade.cc:144
 msgid "Indexing"
 msgstr "Indexerar"
 
-#: UI/GTK2/src/prefsDialog_glade.cc:566
+#: UI/GTK2/src/prefsDialog_glade.cc:507
 msgid "Preferences"
 msgstr "Inst?llningar"
 
@@ -818,67 +815,67 @@
 msgid "Errors"
 msgstr "Fel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:301
+#: UI/GTK2/src/WorkerThreads.cpp:303
 msgid "Can't index mail here"
 msgstr "Kan inte indexera post h?r"
 
-#: UI/GTK2/src/WorkerThreads.cpp:322 UI/GTK2/src/WorkerThreads.cpp:555
+#: UI/GTK2/src/WorkerThreads.cpp:324 UI/GTK2/src/WorkerThreads.cpp:557
 msgid "is already being indexed"
 msgstr "h?ller redan p? att bli indexerad"
 
-#: UI/GTK2/src/WorkerThreads.cpp:332
+#: UI/GTK2/src/WorkerThreads.cpp:334
 msgid "is blacklisted"
 msgstr "?r svartlistad"
 
-#: UI/GTK2/src/WorkerThreads.cpp:665 UI/GTK2/src/WorkerThreads.cpp:1014
-#: UI/GTK2/src/WorkerThreads.cpp:1097 UI/GTK2/src/WorkerThreads.cpp:1106
-#: UI/GTK2/src/WorkerThreads.cpp:1292 UI/GTK2/src/WorkerThreads.cpp:1562
-#: UI/GTK2/src/WorkerThreads.cpp:1695
+#: UI/GTK2/src/WorkerThreads.cpp:667 UI/GTK2/src/WorkerThreads.cpp:1016
+#: UI/GTK2/src/WorkerThreads.cpp:1099 UI/GTK2/src/WorkerThreads.cpp:1108
+#: UI/GTK2/src/WorkerThreads.cpp:1294 UI/GTK2/src/WorkerThreads.cpp:1566
+#: UI/GTK2/src/WorkerThreads.cpp:1699
 msgid "Index error on"
 msgstr "Indexfel p?"
 
-#: UI/GTK2/src/WorkerThreads.cpp:816
+#: UI/GTK2/src/WorkerThreads.cpp:818
 msgid "No title"
 msgstr "Ingen titel"
 
-#: UI/GTK2/src/WorkerThreads.cpp:918 UI/GTK2/src/WorkerThreads.cpp:1035
+#: UI/GTK2/src/WorkerThreads.cpp:920 UI/GTK2/src/WorkerThreads.cpp:1037
 msgid "Couldn't create search engine"
 msgstr "Kunde inte skapa s?kmotor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:941 UI/GTK2/src/WorkerThreads.cpp:1047
+#: UI/GTK2/src/WorkerThreads.cpp:943 UI/GTK2/src/WorkerThreads.cpp:1049
 msgid "Couldn't run query on search engine"
 msgstr "Kunde inte k?ra fr?ga p? s?kmotor"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1200
+#: UI/GTK2/src/WorkerThreads.cpp:1202
 msgid "Couldn't obtain downloader for protocol"
 msgstr "Kunde inte f? protokollh?mtare"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1225
+#: UI/GTK2/src/WorkerThreads.cpp:1227
 msgid "Couldn't retrieve"
 msgstr "Kunde inte h?mta"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1322 UI/GTK2/src/WorkerThreads.cpp:1401
+#: UI/GTK2/src/WorkerThreads.cpp:1324 UI/GTK2/src/WorkerThreads.cpp:1403
 msgid "Cannot index document type"
 msgstr "Kan inte indexera dokumenttyp"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1326 UI/GTK2/src/WorkerThreads.cpp:1405
+#: UI/GTK2/src/WorkerThreads.cpp:1328 UI/GTK2/src/WorkerThreads.cpp:1407
 msgid "at"
 msgstr "p?"
 
 #. No, it isn't
-#: UI/GTK2/src/WorkerThreads.cpp:1437
+#: UI/GTK2/src/WorkerThreads.cpp:1439
 msgid "Robots META tag forbids indexing"
 msgstr "Robots META-tagg f?rbjuder indexering"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1491
+#: UI/GTK2/src/WorkerThreads.cpp:1495
 msgid "Couldn't index"
 msgstr "Kunde inte indexera"
 
 #. Be pessimistic and assume something will go wrong ;-)
-#: UI/GTK2/src/WorkerThreads.cpp:1573
+#: UI/GTK2/src/WorkerThreads.cpp:1577
 msgid "Couldn't unindex document(s)"
 msgstr "Kunde inte avindexera dokument"
 
-#: UI/GTK2/src/WorkerThreads.cpp:1707
+#: UI/GTK2/src/WorkerThreads.cpp:1711
 msgid "Couldn't update document"
 msgstr "Kunde inte uppdatera dokument"



From fabricecolin at mail.berlios.de  Wed Jul 25 15:37:18 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 25 Jul 2007 15:37:18 +0200
Subject: [Pinot-svn] r882 - trunk/UI/GTK2/src
Message-ID: <200707251337.l6PDbIQK006304@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-25 15:37:17 +0200 (Wed, 25 Jul 2007)
New Revision: 882

Modified:
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/mainWindow.cc
Log:
If a ListerThread fails, reset the m_browsingIndex flag.
Cosmetic mods to WorkerThreads.


Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2007-07-24 13:34:36 UTC (rev 881)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2007-07-25 13:37:17 UTC (rev 882)
@@ -827,7 +827,7 @@
 		}
 		current.setTitle(title);
 #ifdef DEBUG
-		cout << "QueryingThread::doWork: title is " << title << endl;
+		cout << "QueryingThread::processResults: title is " << title << endl;
 #endif
 
 		// Use the query's language if the result's is unknown
@@ -870,11 +870,11 @@
 		{
 			current.setIsIndexed(indexId, docId);
 #ifdef DEBUG
-			cout << "QueryingThread::doWork: found in index " << indexId << endl;
+			cout << "QueryingThread::processResults: found in index " << indexId << endl;
 #endif
 		}
 #ifdef DEBUG
-		else cout << "QueryingThread::doWork: not found in any index" << endl;
+		else cout << "QueryingThread::processResults: not found in any index" << endl;
 #endif
 
 		m_documentsList.push_back(current);

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2007-07-24 13:34:36 UTC (rev 881)
+++ trunk/UI/GTK2/src/mainWindow.cc	2007-07-25 13:37:17 UTC (rev 882)
@@ -843,7 +843,7 @@
 		// Yep, it did
 		set_status(to_utf8(threadStatus));
 		// Better reset that flag if an error occured while browsing an index
-		if (type == "IndexBrowserThread")
+		if (type == "ListerThread")
 		{
 			m_state.m_browsingIndex = false;
 		}



From fabricecolin at mail.berlios.de  Wed Jul 25 15:40:02 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 25 Jul 2007 15:40:02 +0200
Subject: [Pinot-svn] r883 - trunk/Search/Plugins
Message-ID: <200707251340.l6PDe21p006561@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-25 15:40:02 +0200 (Wed, 25 Jul 2007)
New Revision: 883

Removed:
   trunk/Search/Plugins/Ask.src
Modified:
   trunk/Search/Plugins/Exalead.src
Log:
Updated Exalead, removed Ask.


Deleted: trunk/Search/Plugins/Ask.src
===================================================================
--- trunk/Search/Plugins/Ask.src	2007-07-25 13:37:17 UTC (rev 882)
+++ trunk/Search/Plugins/Ask.src	2007-07-25 13:40:02 UTC (rev 883)
@@ -1,24 +0,0 @@
-# Ask Jeeves Search Plugin
-
-<SEARCH
-	version="1.0"
-	name="Ask"
-	description="Ask.com Ask Jeeves"
-	method="GET"
-	action="http://www.ask.com/web"
-	routeType="The Web"
->
-
-<INPUT NAME="q" USER>
-<INPUT NAME="qsrc" VALUE="0">
-<INPUT NAME="o" VALUE="0">
-<INPUTNEXT NAME="page" FACTOR="1" VALUE="1">
-
-<INTERPRET
-resultListStart=""
-resultListEnd=""
-resultItemStart='<div class="m10_0_16">'
-resultItemEnd='_u" class="'
->
-
-</SEARCH>

Modified: trunk/Search/Plugins/Exalead.src
===================================================================
--- trunk/Search/Plugins/Exalead.src	2007-07-25 13:37:17 UTC (rev 882)
+++ trunk/Search/Plugins/Exalead.src	2007-07-25 13:40:02 UTC (rev 883)
@@ -21,8 +21,8 @@
 <INTERPRET
 resultListStart=''
 resultListEnd=''
-resultItemStart='alt="Preview" />'
-resultItemEnd='</span></span>'
+resultItemStart='<a class="c'
+resultItemEnd='</div>'
 >
 
 </SEARCH>



From fabricecolin at mail.berlios.de  Wed Jul 25 15:42:03 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 25 Jul 2007 15:42:03 +0200
Subject: [Pinot-svn] r884 - trunk/Search
Message-ID: <200707251342.l6PDg3nC006668@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-25 15:42:03 +0200 (Wed, 25 Jul 2007)
New Revision: 884

Modified:
   trunk/Search/QueryProperties.cpp
   trunk/Search/QueryProperties.h
   trunk/Search/XapianEngine.cpp
Log:
XapianEngine::runQuery() checks whether the query is empty.


Modified: trunk/Search/QueryProperties.cpp
===================================================================
--- trunk/Search/QueryProperties.cpp	2007-07-25 13:40:02 UTC (rev 883)
+++ trunk/Search/QueryProperties.cpp	2007-07-25 13:42:03 UTC (rev 884)
@@ -349,3 +349,15 @@
 	}
 }
 
+/// Returns whether the query is empty.
+bool QueryProperties::isEmpty() const
+{
+	if ((m_freeQuery.empty() == true) &&
+		(m_enableMinDate == false) &&
+		(m_enableMaxDate == false))
+	{
+		return true;
+	}
+
+	return false;
+}

Modified: trunk/Search/QueryProperties.h
===================================================================
--- trunk/Search/QueryProperties.h	2007-07-25 13:40:02 UTC (rev 883)
+++ trunk/Search/QueryProperties.h	2007-07-25 13:42:03 UTC (rev 884)
@@ -92,6 +92,9 @@
 		/// Returns the query's terms.
 		void getTerms(set<string> &terms) const;
 
+		/// Returns whether the query is empty.
+		bool isEmpty() const;
+
 	protected:
 		string m_name;
 		QueryType m_type;

Modified: trunk/Search/XapianEngine.cpp
===================================================================
--- trunk/Search/XapianEngine.cpp	2007-07-25 13:40:02 UTC (rev 883)
+++ trunk/Search/XapianEngine.cpp	2007-07-25 13:42:03 UTC (rev 884)
@@ -570,6 +570,14 @@
 	m_resultsList.clear();
 	m_resultsCountEstimate = 0;
 
+	if (queryProps.isEmpty() == true)
+	{
+#ifdef DEBUG
+		cout << "XapianEngine::runQuery: query is empty" << endl;
+#endif
+		return false;
+	}
+
 	XapianDatabase *pDatabase = XapianDatabaseFactory::getDatabase(m_databaseName, true);
 	if (pDatabase == NULL)
 	{



From fabricecolin at mail.berlios.de  Wed Jul 25 15:51:02 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 25 Jul 2007 15:51:02 +0200
Subject: [Pinot-svn] r885 - trunk/UI/GTK2/src
Message-ID: <200707251351.l6PDp2V1007366@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-25 15:50:56 +0200 (Wed, 25 Jul 2007)
New Revision: 885

Modified:
   trunk/UI/GTK2/src/IndexPage.cpp
Log:
Modified label for default query filter.


Modified: trunk/UI/GTK2/src/IndexPage.cpp
===================================================================
--- trunk/UI/GTK2/src/IndexPage.cpp	2007-07-25 13:42:03 UTC (rev 884)
+++ trunk/UI/GTK2/src/IndexPage.cpp	2007-07-25 13:50:56 UTC (rev 885)
@@ -144,10 +144,7 @@
 void IndexPage::onQueryChanged(void)
 {
 	m_queryName = m_pQueryCombobox->get_active_text();
-#ifdef DEBUG
-	cout << "IndexPage::onQueryChanged: current query now " << m_queryName << endl;
-#endif
-	if (m_queryName == _("None"))
+	if (m_pQueryCombobox->get_active_row_number() == 0)
 	{
 		m_queryName.clear();
 	}
@@ -189,7 +186,7 @@
 
 	m_pQueryCombobox->clear_items();
 
-	m_pQueryCombobox->append_text(_("None"));
+	m_pQueryCombobox->append_text(_("All"));
 
 	const std::map<string, QueryProperties> &queries = m_settings.getQueries();
 	for (std::map<string, QueryProperties>::const_iterator queryIter = queries.begin();



From fabricecolin at mail.berlios.de  Wed Jul 25 16:43:24 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Wed, 25 Jul 2007 16:43:24 +0200
Subject: [Pinot-svn] r886 - in trunk: . Index Search UI/GTK2/src
Message-ID: <200707251443.l6PEhORL010672@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-25 16:43:23 +0200 (Wed, 25 Jul 2007)
New Revision: 886

Modified:
   trunk/Index/pinot-index.1
   trunk/Makefile.am
   trunk/Search/pinot-search.1
   trunk/UI/GTK2/src/pinot-dbus-daemon.1
   trunk/UI/GTK2/src/pinot.1
   trunk/configure.in
   trunk/pinot.spec.in
Log:
Set version number to 0.75. Indexes built with older versions will be upgraded.
New file ChangeLog-dijon is installed, Ask.src isn't any more.
Updated manual pages.


Modified: trunk/Index/pinot-index.1
===================================================================
--- trunk/Index/pinot-index.1	2007-07-25 13:50:56 UTC (rev 885)
+++ trunk/Index/pinot-index.1	2007-07-25 14:43:23 UTC (rev 886)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-INDEX "1" "June 2007" "pinot-index - pinot 0.74" "User Commands"
+.TH PINOT-INDEX "1" "July 2007" "pinot-index - pinot 0.75" "User Commands"
 .SH NAME
 pinot-index \- Index documents from the command-line
 .SH SYNOPSIS
@@ -43,5 +43,5 @@
 Report bugs to fabricecolin at users.berlios.de
 .PP
 This is free software.  You may redistribute copies of it under the terms of
-the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.
+the GNU General Public License <http://www.gnu.org/licenses/old\-licenses/gpl\-2.0.html>.
 There is NO WARRANTY, to the extent permitted by law.

Modified: trunk/Makefile.am
===================================================================
--- trunk/Makefile.am	2007-07-25 13:50:56 UTC (rev 885)
+++ trunk/Makefile.am	2007-07-25 14:43:23 UTC (rev 886)
@@ -1,7 +1,7 @@
 
 SUBDIRS = po Utils Tokenize SQL Collect Index @SOAP_SUBDIRS@ Search Monitor UI/GTK2/src
 
-EXTRA_DIST = AUTHORS ChangeLog NEWS README TODO mkinstalldirs \
+EXTRA_DIST = AUTHORS ChangeLog ChangeLog-dijon NEWS README TODO mkinstalldirs \
 	Tokenize/filters/external-filters.xml globalconfig.xml \
 	textcat_conf.txt textcat3_conf.txt \
 	pinot.desktop pinot-dbus-daemon.desktop pinot.spec \

Modified: trunk/Search/pinot-search.1
===================================================================
--- trunk/Search/pinot-search.1	2007-07-25 13:50:56 UTC (rev 885)
+++ trunk/Search/pinot-search.1	2007-07-25 14:43:23 UTC (rev 886)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-SEARCH "1" "June 2007" "pinot-search - pinot 0.74" "User Commands"
+.TH PINOT-SEARCH "1" "July 2007" "pinot-search - pinot 0.75" "User Commands"
 .SH NAME
 pinot-search \- Query search engines from the command-line
 .SH SYNOPSIS
@@ -54,5 +54,5 @@
 Report bugs to fabricecolin at users.berlios.de
 .PP
 This is free software.  You may redistribute copies of it under the terms of
-the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.
+the GNU General Public License <http://www.gnu.org/licenses/old\-licenses/gpl\-2.0.html>.
 There is NO WARRANTY, to the extent permitted by law.

Modified: trunk/UI/GTK2/src/pinot-dbus-daemon.1
===================================================================
--- trunk/UI/GTK2/src/pinot-dbus-daemon.1	2007-07-25 13:50:56 UTC (rev 885)
+++ trunk/UI/GTK2/src/pinot-dbus-daemon.1	2007-07-25 14:43:23 UTC (rev 886)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT-DBUS-DAEMON "1" "June 2007" "pinot-dbus-daemon - pinot 0.74" "User Commands"
+.TH PINOT-DBUS-DAEMON "1" "July 2007" "pinot-dbus-daemon - pinot 0.75" "User Commands"
 .SH NAME
 pinot-dbus-daemon \- D-Bus search and index daemon
 .SH SYNOPSIS
@@ -24,5 +24,5 @@
 Report bugs to fabricecolin at users.berlios.de
 .PP
 This is free software.  You may redistribute copies of it under the terms of
-the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.
+the GNU General Public License <http://www.gnu.org/licenses/old\-licenses/gpl\-2.0.html>.
 There is NO WARRANTY, to the extent permitted by law.

Modified: trunk/UI/GTK2/src/pinot.1
===================================================================
--- trunk/UI/GTK2/src/pinot.1	2007-07-25 13:50:56 UTC (rev 885)
+++ trunk/UI/GTK2/src/pinot.1	2007-07-25 14:43:23 UTC (rev 886)
@@ -1,5 +1,5 @@
 .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
-.TH PINOT "1" "June 2007" "pinot - pinot 0.74" "User Commands"
+.TH PINOT "1" "July 2007" "pinot - pinot 0.75" "User Commands"
 .SH NAME
 pinot \- A metasearch tool for the Free Desktop
 .SH SYNOPSIS
@@ -18,5 +18,5 @@
 Report bugs to fabricecolin at users.berlios.de
 .PP
 This is free software.  You may redistribute copies of it under the terms of
-the GNU General Public License <http://www.gnu.org/licenses/gpl.html>.
+the GNU General Public License <http://www.gnu.org/licenses/old\-licenses/gpl\-2.0.html>.
 There is NO WARRANTY, to the extent permitted by law.

Modified: trunk/configure.in
===================================================================
--- trunk/configure.in	2007-07-25 13:50:56 UTC (rev 885)
+++ trunk/configure.in	2007-07-25 14:43:23 UTC (rev 886)
@@ -2,7 +2,7 @@
 # using glademm V2.6.0
 
 AC_PREREQ(2.50)
-AC_INIT(pinot, 0.74,[fabricecolin at users.berlios.de])
+AC_INIT(pinot, 0.75,[fabricecolin at users.berlios.de])
 AM_INIT_AUTOMAKE
 AC_CONFIG_HEADERS(config.h)
 
@@ -16,7 +16,7 @@
 AM_PROG_LIBTOOL
 
 dnl An index with a version older than this should be upgraded
-AC_DEFINE_UNQUOTED(PINOT_INDEX_MIN_VERSION,0.74,
+AC_DEFINE_UNQUOTED(PINOT_INDEX_MIN_VERSION,0.75,
     [Minimum index version])
 
 dnl gettext support

Modified: trunk/pinot.spec.in
===================================================================
--- trunk/pinot.spec.in	2007-07-25 13:50:56 UTC (rev 885)
+++ trunk/pinot.spec.in	2007-07-25 14:43:23 UTC (rev 886)
@@ -87,7 +87,7 @@
 
 %files
 %defattr(-, root, root, -)
-%doc AUTHORS ChangeLog COPYING NEWS README TODO
+%doc AUTHORS ChangeLog ChangeLog-dijon COPYING NEWS README TODO
 %config(noreplace) %{_sysconfdir}/pinot/external-filters.xml
 %config(noreplace) %{_sysconfdir}/pinot/globalconfig.xml
 %config(noreplace) %{_sysconfdir}/pinot/textcat_conf.txt
@@ -107,7 +107,6 @@
 %dir %{_datadir}/pinot/engines/
 %{_datadir}/pinot/engines/A9.src
 %{_datadir}/pinot/engines/Accoona.src
-%{_datadir}/pinot/engines/Ask.src
 %{_datadir}/pinot/engines/BitTorrent.src
 %{_datadir}/pinot/engines/Clusty.src
 %{_datadir}/pinot/engines/CreativeCommons.src



From fabricecolin at mail.berlios.de  Thu Jul 26 13:53:00 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 26 Jul 2007 13:53:00 +0200
Subject: [Pinot-svn] r887 - trunk
Message-ID: <200707261153.l6QBr0IA006488@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-26 13:52:56 +0200 (Thu, 26 Jul 2007)
New Revision: 887

Modified:
   trunk/README
Log:
Removed reference to mbox configuration.


Modified: trunk/README
===================================================================
--- trunk/README	2007-07-25 14:43:23 UTC (rev 886)
+++ trunk/README	2007-07-26 11:52:56 UTC (rev 887)
@@ -295,8 +295,7 @@
 
 
    D-Bus activation makes sure the service is running whenever one of its
-   methods is invoked by any consumer application. For instance, when
-   directories or mbox files are configured for indexing in the UI, clicking
+   methods is invoked by any consumer application. For instance, clicking
    OK on the Preferences box will call the service's GetStatistics method,
    thus ensuring the service is running.
 
@@ -308,8 +307,8 @@
 
    A few things to keep in mind :
      * the service doesn't reload its configuration while running, so any
-       change (adding or removing a directory or mbox file) will take effect
-       when the service is restarted.
+       change (for instance, adding or removing an indexable directory) will
+       take effect when the service is restarted.
      * when starting, the service will first crawl all configured locations
        and (re)index new and modified files. Starting with 0.64, the daemon's
        scheduling priority is set very low (15, can be adjusted with --priority)



From fabricecolin at mail.berlios.de  Thu Jul 26 15:31:24 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 26 Jul 2007 15:31:24 +0200
Subject: [Pinot-svn] r888 - trunk/UI/GTK2/src
Message-ID: <200707261331.l6QDVOTT016736@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-26 15:31:23 +0200 (Thu, 26 Jul 2007)
New Revision: 888

Modified:
   trunk/UI/GTK2/src/WorkerThreads.h
Log:
Minor fix to get rid of compilation warning.


Modified: trunk/UI/GTK2/src/WorkerThreads.h
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.h	2007-07-26 11:52:56 UTC (rev 887)
+++ trunk/UI/GTK2/src/WorkerThreads.h	2007-07-26 13:31:23 UTC (rev 888)
@@ -221,9 +221,9 @@
 		std::string m_engineName;
 		std::string m_engineDisplayableName;
 		std::string m_engineOption;
-		bool m_listingIndex;
 		QueryProperties m_queryProps;
 		std::string m_resultsCharset;
+		bool m_listingIndex;
 
 		virtual void processResults(const std::vector<DocumentInfo> &resultsList);
 



From fabricecolin at mail.berlios.de  Thu Jul 26 16:24:35 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 26 Jul 2007 16:24:35 +0200
Subject: [Pinot-svn] r889 - trunk/UI/GTK2/src
Message-ID: <200707261424.l6QEOZqd019982@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-26 16:24:35 +0200 (Thu, 26 Jul 2007)
New Revision: 889

Modified:
   trunk/UI/GTK2/src/ResultsTree.cpp
Log:
Another very minor mod.


Modified: trunk/UI/GTK2/src/ResultsTree.cpp
===================================================================
--- trunk/UI/GTK2/src/ResultsTree.cpp	2007-07-26 13:31:23 UTC (rev 888)
+++ trunk/UI/GTK2/src/ResultsTree.cpp	2007-07-26 14:24:35 UTC (rev 889)
@@ -1474,11 +1474,15 @@
 	}
 	catch (Error &error)
 	{
-		cerr << "ResultsTree::updateRow: " << error.what() << endl;
+#ifdef DEBUG
+		cout << "ResultsTree::updateRow: " << error.what() << endl;
+#endif
 	}
 	catch (...)
 	{
-		cerr << "ResultsTree::updateRow: caught unknown exception" << endl;
+#ifdef DEBUG
+		cout << "ResultsTree::updateRow: caught unknown exception" << endl;
+#endif
 	}
 }
 



From fabricecolin at mail.berlios.de  Thu Jul 26 16:28:56 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Thu, 26 Jul 2007 16:28:56 +0200
Subject: [Pinot-svn] r890 - in trunk: . po
Message-ID: <200707261428.l6QESuqk020130@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-26 16:28:55 +0200 (Thu, 26 Jul 2007)
New Revision: 890

Modified:
   trunk/NEWS
   trunk/TODO
   trunk/po/de.po
   trunk/po/es.po
   trunk/po/fr.po
   trunk/po/it.po
   trunk/po/nl.po
   trunk/po/pt.po
   trunk/po/pt_BR.po
   trunk/po/ru.po
   trunk/po/sv.po
Log:
Final touch to 0.75.


Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/NEWS	2007-07-26 14:28:55 UTC (rev 890)
@@ -1,3 +1,19 @@
+2007/07/26 version_0_7_5
+General :
+ - install Dijon's ChangeLog
+Search :
+ - updated Xesam Query Language parser to reflect current spec
+ - updated Sherlock plugin for Exalead, removed Ask
+Daemon :
+ - mbox files are no longer configured separately : those found during
+  a crawl are indexed and monitored automatically
+ - patterns list can be used as a blacklist (default) or whitelist
+UI :
+ - fixed a bug where filtering a documents list with an empty query would
+  prevent from viewing the list without or without a filter query
+ - updated Dutch translation by Balaam's Miracle
+ - updated Portuguese translation by _PN_boy
+
 2007/06/24 version_0_7_4
 General :
  - make uninstall actually uninstalls all files

Modified: trunk/TODO
===================================================================
--- trunk/TODO	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/TODO	2007-07-26 14:28:55 UTC (rev 890)
@@ -27,7 +27,6 @@
 - HtmlFilter to look for META tags Author, Creator, Publisher and CreationDate
 - Filters should have a version number so that new versions force reindexing documents of the
  given type
-- Distribute filters' ChangeLog
 - XmLFilter is slow, rewrite file parsing with the TextReader interface
 
 Monitor
@@ -66,7 +65,8 @@
 - Use Xapian >= 1.0 TermGenerator class
 - Xapian >= 1.0's QueryParser makes different assumptions about terms (http://www.xapian.org/docs/termgenerator.html)
 - Xapian > 1.0 has a version of Xapian::Database::allterms_begin() that takes a prefix
-- With Xapian > 1.0.1, use QueryParser::add_valuerangeprocessor for date ranges
+- With Xapian > 1.0.2, for date ranges, use QueryParser::add_valuerangeprocessor()
+ NumberValueRangeProcessor and sortable_serialise()
 - Automatically categorize documents based on MIME type and source into picture, video, etc...
 - Does updateDocumentInfo sometimes fail to remove terms from the old title ?
 - DBusXapianIndex to use D-Bus method Index

Modified: trunk/po/de.po
===================================================================
--- trunk/po/de.po	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/po/de.po	2007-07-26 14:28:55 UTC (rev 890)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"POT-Creation-Date: 2007-07-26 22:33+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Christian Dywan <christian at twotoasts.de>\n"
 "Language-Team: German <de at li.org>\n"
@@ -94,8 +94,7 @@
 msgid "External index"
 msgstr "Externer Index"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/IndexPage.cpp:150
-#: UI/GTK2/src/IndexPage.cpp:192 UI/GTK2/src/queryDialog.cc:101
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr ""
 
@@ -124,6 +123,10 @@
 msgid "Show Next"
 msgstr "N?chste anzeigen"
 
+#: UI/GTK2/src/IndexPage.cpp:189
+msgid "All"
+msgstr ""
+
 #: UI/GTK2/src/launcherDialog_glade.cc:64
 msgid ""
 "There is no helper application defined for this document's type.\n"

Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/po/es.po	2007-07-26 14:28:55 UTC (rev 890)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"POT-Creation-Date: 2007-07-26 22:33+0800\n"
 "PO-Revision-Date: 2007-07-21 12:37+0800\n"
 "Last-Translator: Gar Bage <garbage at openfutura.com>\n"
 "Language-Team: es <fabricecolin at users.berlios.de>\n"
@@ -96,8 +96,7 @@
 msgid "External index"
 msgstr "?ndice externo"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/IndexPage.cpp:150
-#: UI/GTK2/src/IndexPage.cpp:192 UI/GTK2/src/queryDialog.cc:101
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Ninguno"
 
@@ -126,6 +125,10 @@
 msgid "Show Next"
 msgstr "Mostrar siguientes"
 
+#: UI/GTK2/src/IndexPage.cpp:189
+msgid "All"
+msgstr ""
+
 #: UI/GTK2/src/launcherDialog_glade.cc:64
 msgid ""
 "There is no helper application defined for this document's type.\n"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/po/fr.po	2007-07-26 14:28:55 UTC (rev 890)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"POT-Creation-Date: 2007-07-26 22:33+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: fr <fabricecolin at users.berlios.de>\n"
@@ -95,8 +95,7 @@
 msgid "External index"
 msgstr "Index externe"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/IndexPage.cpp:150
-#: UI/GTK2/src/IndexPage.cpp:192 UI/GTK2/src/queryDialog.cc:101
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Aucune"
 
@@ -125,6 +124,10 @@
 msgid "Show Next"
 msgstr "Suivants"
 
+#: UI/GTK2/src/IndexPage.cpp:189
+msgid "All"
+msgstr "Tout"
+
 #: UI/GTK2/src/launcherDialog_glade.cc:64
 msgid ""
 "There is no helper application defined for this document's type.\n"

Modified: trunk/po/it.po
===================================================================
--- trunk/po/it.po	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/po/it.po	2007-07-26 14:28:55 UTC (rev 890)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"POT-Creation-Date: 2007-07-26 22:33+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Marco Bazzani <visitors at libero.it>\n"
 "Language-Team: Italian <it at li.org>\n"
@@ -94,8 +94,7 @@
 msgid "External index"
 msgstr "Indice esterno"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/IndexPage.cpp:150
-#: UI/GTK2/src/IndexPage.cpp:192 UI/GTK2/src/queryDialog.cc:101
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Nessuno"
 
@@ -124,6 +123,10 @@
 msgid "Show Next"
 msgstr "Mostra Seguente"
 
+#: UI/GTK2/src/IndexPage.cpp:189
+msgid "All"
+msgstr ""
+
 #: UI/GTK2/src/launcherDialog_glade.cc:64
 msgid ""
 "There is no helper application defined for this document's type.\n"

Modified: trunk/po/nl.po
===================================================================
--- trunk/po/nl.po	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/po/nl.po	2007-07-26 14:28:55 UTC (rev 890)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"POT-Creation-Date: 2007-07-26 22:33+0800\n"
 "PO-Revision-Date: 2007-07-18 16:03+0000\n"
 "Last-Translator: Balaam's Miracle <balaam at balaamsmiracle.com>\n"
 "Language-Team: Dutch <nl at li.org>\n"
@@ -96,8 +96,7 @@
 msgid "External index"
 msgstr "Externe index"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/IndexPage.cpp:150
-#: UI/GTK2/src/IndexPage.cpp:192 UI/GTK2/src/queryDialog.cc:101
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Geen"
 
@@ -126,6 +125,10 @@
 msgid "Show Next"
 msgstr "Toon volgende"
 
+#: UI/GTK2/src/IndexPage.cpp:189
+msgid "All"
+msgstr ""
+
 #: UI/GTK2/src/launcherDialog_glade.cc:64
 msgid ""
 "There is no helper application defined for this document's type.\n"

Modified: trunk/po/pt.po
===================================================================
--- trunk/po/pt.po	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/po/pt.po	2007-07-26 14:28:55 UTC (rev 890)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"POT-Creation-Date: 2007-07-26 22:33+0800\n"
 "PO-Revision-Date: 2007-07-21 22:12+0000\n"
 "Last-Translator: _PN_boy <pedro_nuno_pn at iol.pt>\n"
 "Language-Team: Portuguese <pt at li.org>\n"
@@ -95,8 +95,7 @@
 msgid "External index"
 msgstr "Index externo"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/IndexPage.cpp:150
-#: UI/GTK2/src/IndexPage.cpp:192 UI/GTK2/src/queryDialog.cc:101
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Nenhum"
 
@@ -125,6 +124,10 @@
 msgid "Show Next"
 msgstr "Mostrar pr?ximo"
 
+#: UI/GTK2/src/IndexPage.cpp:189
+msgid "All"
+msgstr ""
+
 #: UI/GTK2/src/launcherDialog_glade.cc:64
 msgid ""
 "There is no helper application defined for this document's type.\n"

Modified: trunk/po/pt_BR.po
===================================================================
--- trunk/po/pt_BR.po	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/po/pt_BR.po	2007-07-26 14:28:55 UTC (rev 890)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"POT-Creation-Date: 2007-07-26 22:33+0800\n"
 "PO-Revision-Date: 2007-07-21 12:37+0800\n"
 "Last-Translator: Leonardo Melo <leonardovazmelo at gmail.com>\n"
 "Language-Team: Portuguese (Brazil) <pt_BR at li.org>\n"
@@ -96,8 +96,7 @@
 msgid "External index"
 msgstr "?ndice externo"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/IndexPage.cpp:150
-#: UI/GTK2/src/IndexPage.cpp:192 UI/GTK2/src/queryDialog.cc:101
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Nenhum"
 
@@ -126,6 +125,10 @@
 msgid "Show Next"
 msgstr "Mostrar pr?ximo"
 
+#: UI/GTK2/src/IndexPage.cpp:189
+msgid "All"
+msgstr ""
+
 #: UI/GTK2/src/launcherDialog_glade.cc:64
 msgid ""
 "There is no helper application defined for this document's type.\n"

Modified: trunk/po/ru.po
===================================================================
--- trunk/po/ru.po	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/po/ru.po	2007-07-26 14:28:55 UTC (rev 890)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"POT-Creation-Date: 2007-07-26 22:33+0800\n"
 "PO-Revision-Date: 2007-07-21 12:37+0800\n"
 "Last-Translator: Sergey Vostrikov <s.vostrikov at gmail.com>\n"
 "Language-Team: Russian <ru at li.org>\n"
@@ -96,8 +96,7 @@
 msgid "External index"
 msgstr "??????? ??????"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/IndexPage.cpp:150
-#: UI/GTK2/src/IndexPage.cpp:192 UI/GTK2/src/queryDialog.cc:101
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "???"
 
@@ -126,6 +125,10 @@
 msgid "Show Next"
 msgstr "???????? ?????????"
 
+#: UI/GTK2/src/IndexPage.cpp:189
+msgid "All"
+msgstr ""
+
 #: UI/GTK2/src/launcherDialog_glade.cc:64
 msgid ""
 "There is no helper application defined for this document's type.\n"

Modified: trunk/po/sv.po
===================================================================
--- trunk/po/sv.po	2007-07-26 14:24:35 UTC (rev 889)
+++ trunk/po/sv.po	2007-07-26 14:28:55 UTC (rev 890)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-24 20:39+0800\n"
+"POT-Creation-Date: 2007-07-26 22:33+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Daniel Nylander <yeager at ubuntu.com>\n"
 "Language-Team: Swedish <sv at li.org>\n"
@@ -95,8 +95,7 @@
 msgid "External index"
 msgstr "Externt index"
 
-#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/IndexPage.cpp:150
-#: UI/GTK2/src/IndexPage.cpp:192 UI/GTK2/src/queryDialog.cc:101
+#: UI/GTK2/src/importDialog.cc:76 UI/GTK2/src/queryDialog.cc:101
 msgid "None"
 msgstr "Ingen"
 
@@ -125,6 +124,10 @@
 msgid "Show Next"
 msgstr "Visa n?sta"
 
+#: UI/GTK2/src/IndexPage.cpp:189
+msgid "All"
+msgstr ""
+
 #: UI/GTK2/src/launcherDialog_glade.cc:64
 msgid ""
 "There is no helper application defined for this document's type.\n"



From fabricecolin at mail.berlios.de  Fri Jul 27 16:36:32 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 27 Jul 2007 16:36:32 +0200
Subject: [Pinot-svn] r891 - trunk/UI/GTK2/src
Message-ID: <200707271436.l6REaWe3010592@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-27 16:36:32 +0200 (Fri, 27 Jul 2007)
New Revision: 891

Modified:
   trunk/UI/GTK2/src/PinotUtils.cpp
   trunk/UI/GTK2/src/propertiesDialog.cc
Log:
Modified get_column_height() hack to do without the font's height.


Modified: trunk/UI/GTK2/src/PinotUtils.cpp
===================================================================
--- trunk/UI/GTK2/src/PinotUtils.cpp	2007-07-26 14:28:55 UTC (rev 890)
+++ trunk/UI/GTK2/src/PinotUtils.cpp	2007-07-27 14:36:32 UTC (rev 891)
@@ -17,8 +17,6 @@
  */
 
 #include <iostream>
-#include <pangomm/font.h>
-#include <gtkmm/rc.h>
 #include <gtkmm/stock.h>
 
 #include "config.h"
@@ -133,23 +131,13 @@
 /// Get a column height.
 int get_column_height(TreeView *pTree)
 {
+	int height = 0;
+
 	if (pTree == NULL)
 	{
 		return 0;
 	}
 
-	RefPtr<Style> refRCStyle = RC::get_style(*pTree);
-	if (!refRCStyle)
-	{
-		return 0;
-	}
-
-	int fontSize = refRCStyle->get_font().get_size();
-	int height = fontSize / Pango::SCALE;
-#ifdef DEBUG
-	cout << "get_column_height: font " << height << ", " << fontSize << endl;
-#endif
-
 	TreeViewColumn *pColumn = pTree->get_column(1);
 	if (pColumn != NULL)
 	{

Modified: trunk/UI/GTK2/src/propertiesDialog.cc
===================================================================
--- trunk/UI/GTK2/src/propertiesDialog.cc	2007-07-26 14:28:55 UTC (rev 890)
+++ trunk/UI/GTK2/src/propertiesDialog.cc	2007-07-27 14:36:32 UTC (rev 891)
@@ -190,7 +190,7 @@
 		// What's the current size ?
 		get_size(width, height);
 		// Add enough room for the rows we need to show
-		height += get_column_height(labelsTreeview) * (rowsCount - 2);
+		height += get_column_height(labelsTreeview) * (rowsCount - 1);
 		// Resize
 		resize(width, min(maxHeight, height));
 	}



From fabricecolin at mail.berlios.de  Fri Jul 27 17:07:53 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 27 Jul 2007 17:07:53 +0200
Subject: [Pinot-svn] r892 - trunk
Message-ID: <200707271507.l6RF7rZq011982@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-27 17:07:52 +0200 (Fri, 27 Jul 2007)
New Revision: 892

Modified:
   trunk/README
Log:
When resetting the history, it's ~/.pinot/history-daemon that matters.


Modified: trunk/README
===================================================================
--- trunk/README	2007-07-27 14:36:32 UTC (rev 891)
+++ trunk/README	2007-07-27 15:07:52 UTC (rev 892)
@@ -364,7 +364,7 @@
   daemon is stopped, then delete the index with
   $ rm ~/.pinot/daemon/*
   and remove historical data as follows
-  $ sqlite3 ~/.pinot/history "delete from CrawlHistory; \
+  $ sqlite3 ~/.pinot/history-daemon "delete from CrawlHistory; \
     delete from CrawlSources;"
 
 



From fabricecolin at mail.berlios.de  Fri Jul 27 18:29:15 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 27 Jul 2007 18:29:15 +0200
Subject: [Pinot-svn] r893 - trunk/Index
Message-ID: <200707271629.l6RGTFxB016569@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-27 18:29:15 +0200 (Fri, 27 Jul 2007)
New Revision: 893

Modified:
   trunk/Index/FilterWrapper.cpp
Log:
Don't stop going through nested documents just before the current one needs to
be passed to another filter, and assign it the right MIME type.


Modified: trunk/Index/FilterWrapper.cpp
===================================================================
--- trunk/Index/FilterWrapper.cpp	2007-07-27 15:07:52 UTC (rev 892)
+++ trunk/Index/FilterWrapper.cpp	2007-07-27 16:29:15 UTC (rev 893)
@@ -85,7 +85,7 @@
 	const set<string> &labels, unsigned int &docId, bool doUpdate)
 {
 	Filter *pFilter = FilterFactory::getFilter(doc.getType());
-	bool fedFilter = false, success = false;
+	bool fedFilter = false, docSuccess = false, finalSuccess = false;
 
 	if (pFilter != NULL)
 	{
@@ -122,6 +122,9 @@
 
 		if (pFilter->next_document() == false)
 		{
+#ifdef DEBUG
+			cout << "FilterWrapper::filterDocument: no more documents in " << doc.getLocation() << endl;
+#endif
 			break;
 		}
 
@@ -129,6 +132,7 @@
 
 		filteredDoc.setTimestamp(doc.getTimestamp());
 		filteredDoc.setSize(doc.getSize());
+		docSuccess = false;
 
 		if (FilterUtils::populateDocument(filteredDoc, pFilter) == false)
 		{
@@ -159,13 +163,13 @@
 			if ((doUpdate == true) &&
 				(isNested == false))
 			{
-				success = m_pIndex->updateDocument(docId, tokens);
+				docSuccess = m_pIndex->updateDocument(docId, tokens);
 			}
 			else
 			{
 				unsigned int newDocId = docId;
 
-				success = m_pIndex->indexDocument(tokens, labels, newDocId);
+				docSuccess = m_pIndex->indexDocument(tokens, labels, newDocId);
 				// Make sure we return the base document's ID, not the last nested document's ID
 				if (isNested == false)
 				{
@@ -175,23 +179,23 @@
 		}
 		else
 		{
-			success = filterDocument(filteredDoc, originalType, labels, docId, doUpdate);
-			delete pFilter;
+			docSuccess = filterDocument(filteredDoc, actualType, labels, docId, doUpdate);
+		}
 
-			return success;
+		// Consider indexing anything a success
+		if (docSuccess == true)
+		{
+			finalSuccess = true;
 		}
 	}
 
 	delete pFilter;
 
 #ifdef DEBUG
-	if (success == false)
-	{
-		cout << "FilterWrapper::filterDocument: didn't index " << doc.getLocation() << endl;
-	}
+	cout << "FilterWrapper::filterDocument: done with " << doc.getLocation() << " status " << finalSuccess << endl;
 #endif
 
-	return success;
+	return finalSuccess;
 }
 
 bool FilterWrapper::unindexNestedDocuments(const string &url)



From fabricecolin at mail.berlios.de  Fri Jul 27 18:43:44 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Fri, 27 Jul 2007 18:43:44 +0200
Subject: [Pinot-svn] r894 - in trunk: . po
Message-ID: <200707271643.l6RGhi45005104@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-27 18:43:37 +0200 (Fri, 27 Jul 2007)
New Revision: 894

Modified:
   trunk/NEWS
   trunk/po/de.po
   trunk/po/es.po
   trunk/po/fr.po
   trunk/po/it.po
   trunk/po/nl.po
   trunk/po/pt.po
   trunk/po/pt_BR.po
   trunk/po/ru.po
   trunk/po/sv.po
Log:
Updated with latest changes.


Modified: trunk/NEWS
===================================================================
--- trunk/NEWS	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/NEWS	2007-07-27 16:43:37 UTC (rev 894)
@@ -1,6 +1,9 @@
-2007/07/26 version_0_7_5
+2007/07/28 version_0_7_5
 General :
  - install Dijon's ChangeLog
+Index :
+ - files with nested documents (eg mbox) could sometimes not be fully indexed
+  and/or and the wrong MIME type was reported
 Search :
  - updated Xesam Query Language parser to reflect current spec
  - updated Sherlock plugin for Exalead, removed Ask
@@ -11,6 +14,8 @@
 UI :
  - fixed a bug where filtering a documents list with an empty query would
   prevent from viewing the list without or without a filter query
+ - avoid a crash when viewing the properties of several documents one after
+  the other
  - updated Dutch translation by Balaam's Miracle
  - updated Portuguese translation by _PN_boy
 

Modified: trunk/po/de.po
===================================================================
--- trunk/po/de.po	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/po/de.po	2007-07-27 16:43:37 UTC (rev 894)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-26 22:33+0800\n"
+"POT-Creation-Date: 2007-07-27 23:00+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Christian Dywan <christian at twotoasts.de>\n"
 "Language-Team: German <de at li.org>\n"

Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/po/es.po	2007-07-27 16:43:37 UTC (rev 894)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-26 22:33+0800\n"
+"POT-Creation-Date: 2007-07-27 23:00+0800\n"
 "PO-Revision-Date: 2007-07-21 12:37+0800\n"
 "Last-Translator: Gar Bage <garbage at openfutura.com>\n"
 "Language-Team: es <fabricecolin at users.berlios.de>\n"

Modified: trunk/po/fr.po
===================================================================
--- trunk/po/fr.po	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/po/fr.po	2007-07-27 16:43:37 UTC (rev 894)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-26 22:33+0800\n"
+"POT-Creation-Date: 2007-07-27 23:00+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Fabrice Colin <fabricecolin at users.berlios.de>\n"
 "Language-Team: fr <fabricecolin at users.berlios.de>\n"

Modified: trunk/po/it.po
===================================================================
--- trunk/po/it.po	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/po/it.po	2007-07-27 16:43:37 UTC (rev 894)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-26 22:33+0800\n"
+"POT-Creation-Date: 2007-07-27 23:00+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Marco Bazzani <visitors at libero.it>\n"
 "Language-Team: Italian <it at li.org>\n"

Modified: trunk/po/nl.po
===================================================================
--- trunk/po/nl.po	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/po/nl.po	2007-07-27 16:43:37 UTC (rev 894)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-26 22:33+0800\n"
+"POT-Creation-Date: 2007-07-27 23:00+0800\n"
 "PO-Revision-Date: 2007-07-18 16:03+0000\n"
 "Last-Translator: Balaam's Miracle <balaam at balaamsmiracle.com>\n"
 "Language-Team: Dutch <nl at li.org>\n"

Modified: trunk/po/pt.po
===================================================================
--- trunk/po/pt.po	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/po/pt.po	2007-07-27 16:43:37 UTC (rev 894)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-26 22:33+0800\n"
+"POT-Creation-Date: 2007-07-27 23:00+0800\n"
 "PO-Revision-Date: 2007-07-21 22:12+0000\n"
 "Last-Translator: _PN_boy <pedro_nuno_pn at iol.pt>\n"
 "Language-Team: Portuguese <pt at li.org>\n"

Modified: trunk/po/pt_BR.po
===================================================================
--- trunk/po/pt_BR.po	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/po/pt_BR.po	2007-07-27 16:43:37 UTC (rev 894)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-26 22:33+0800\n"
+"POT-Creation-Date: 2007-07-27 23:00+0800\n"
 "PO-Revision-Date: 2007-07-21 12:37+0800\n"
 "Last-Translator: Leonardo Melo <leonardovazmelo at gmail.com>\n"
 "Language-Team: Portuguese (Brazil) <pt_BR at li.org>\n"

Modified: trunk/po/ru.po
===================================================================
--- trunk/po/ru.po	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/po/ru.po	2007-07-27 16:43:37 UTC (rev 894)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-26 22:33+0800\n"
+"POT-Creation-Date: 2007-07-27 23:00+0800\n"
 "PO-Revision-Date: 2007-07-21 12:37+0800\n"
 "Last-Translator: Sergey Vostrikov <s.vostrikov at gmail.com>\n"
 "Language-Team: Russian <ru at li.org>\n"

Modified: trunk/po/sv.po
===================================================================
--- trunk/po/sv.po	2007-07-27 16:29:15 UTC (rev 893)
+++ trunk/po/sv.po	2007-07-27 16:43:37 UTC (rev 894)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: pinot 0.75\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2007-07-26 22:33+0800\n"
+"POT-Creation-Date: 2007-07-27 23:00+0800\n"
 "PO-Revision-Date: 2007-06-21 19:51+0800\n"
 "Last-Translator: Daniel Nylander <yeager at ubuntu.com>\n"
 "Language-Team: Swedish <sv at li.org>\n"



From fabricecolin at mail.berlios.de  Sat Jul 28 05:30:36 2007
From: fabricecolin at mail.berlios.de (fabricecolin at BerliOS)
Date: Sat, 28 Jul 2007 05:30:36 +0200
Subject: [Pinot-svn] r895 - tags
Message-ID: <200707280330.l6S3Ua7l016165@sheep.berlios.de>

Author: fabricecolin
Date: 2007-07-28 05:30:36 +0200 (Sat, 28 Jul 2007)
New Revision: 895

Added:
   tags/version_0_7_5/
Log:
Releasing 0.75.


Copied: tags/version_0_7_5 (from rev 894, trunk)



