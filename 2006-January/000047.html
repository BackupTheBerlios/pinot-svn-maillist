<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Pinot-svn] r47 - in trunk/UI/GTK2: . src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/pinot-svn/2006-January/index.html" >
   <LINK REL="made" HREF="mailto:pinot-svn%40lists.berlios.de?Subject=Re%3A%20%5BPinot-svn%5D%20r47%20-%20in%20trunk/UI/GTK2%3A%20.%20src&In-Reply-To=%3C200601021934.k02JYTI8029990%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000045.html">
   <LINK REL="Next"  HREF="000046.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Pinot-svn] r47 - in trunk/UI/GTK2: . src</H1>
    <B>fabricecolin at BerliOS</B> 
    <A HREF="mailto:pinot-svn%40lists.berlios.de?Subject=Re%3A%20%5BPinot-svn%5D%20r47%20-%20in%20trunk/UI/GTK2%3A%20.%20src&In-Reply-To=%3C200601021934.k02JYTI8029990%40sheep.berlios.de%3E"
       TITLE="[Pinot-svn] r47 - in trunk/UI/GTK2: . src">fabricecolin at berlios.de
       </A><BR>
    <I>Mon Jan  2 20:34:29 CET 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000045.html">[Pinot-svn] r46 - trunk/Index
</A></li>
        <LI>Next message: <A HREF="000046.html">[Pinot-svn] r48 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47">[ date ]</a>
              <a href="thread.html#47">[ thread ]</a>
              <a href="subject.html#47">[ subject ]</a>
              <a href="author.html#47">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: fabricecolin
Date: 2006-01-02 20:34:26 +0100 (Mon, 02 Jan 2006)
New Revision: 47

Modified:
   trunk/UI/GTK2/metase-gtk2.glade
   trunk/UI/GTK2/src/IndexTree.cpp
   trunk/UI/GTK2/src/IndexTree.h
   trunk/UI/GTK2/src/WorkerThreads.cpp
   trunk/UI/GTK2/src/importDialog.cc
   trunk/UI/GTK2/src/importDialog.hh
   trunk/UI/GTK2/src/importDialog_glade.cc
   trunk/UI/GTK2/src/importDialog_glade.hh
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/mainWindow.hh
   trunk/UI/GTK2/src/mainWindow_glade.cc
Log:
Update all properties after a document update. Don't attempt completion when
characters are deleted off the live query field. Started reworking importDialog.


Modified: trunk/UI/GTK2/metase-gtk2.glade
===================================================================
--- trunk/UI/GTK2/metase-gtk2.glade	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/metase-gtk2.glade	2006-01-02 19:34:26 UTC (rev 47)
@@ -5,7 +5,6 @@
 
 &lt;widget class=&quot;GtkWindow&quot; id=&quot;mainWindow&quot;&gt;
   &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;public&lt;/property&gt;
-  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
   &lt;property name=&quot;events&quot;&gt;GDK_BUTTON_PRESS_MASK&lt;/property&gt;
   &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Pinot&lt;/property&gt;
   &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
@@ -2610,390 +2609,6 @@
   &lt;/child&gt;
 &lt;/widget&gt;
 
-&lt;widget class=&quot;GtkDialog&quot; id=&quot;importDialog&quot;&gt;
-  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;public&lt;/property&gt;
-  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Import document&lt;/property&gt;
-  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
-  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
-  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
-  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
-  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
-  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
-  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
-  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
-  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_NORMAL&lt;/property&gt;
-  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
-  &lt;property name=&quot;focus_on_map&quot;&gt;True&lt;/property&gt;
-  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
-
-  &lt;child internal-child=&quot;vbox&quot;&gt;
-    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox4&quot;&gt;
-      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
-
-      &lt;child internal-child=&quot;action_area&quot;&gt;
-	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area4&quot;&gt;
-	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkButton&quot; id=&quot;cancelbutton1&quot;&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
-	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
-	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
-	    &lt;/widget&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkButton&quot; id=&quot;importOkButton&quot;&gt;
-	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
-	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
-	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
-	      &lt;signal name=&quot;clicked&quot; handler=&quot;on_importOkButton_clicked&quot; last_modification_time=&quot;Sun, 18 Sep 2005 05:13:29 GMT&quot;/&gt;
-	    &lt;/widget&gt;
-	  &lt;/child&gt;
-	&lt;/widget&gt;
-	&lt;packing&gt;
-	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
-	&lt;/packing&gt;
-      &lt;/child&gt;
-
-      &lt;child&gt;
-	&lt;widget class=&quot;GtkTable&quot; id=&quot;docTable&quot;&gt;
-	  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	  &lt;property name=&quot;n_rows&quot;&gt;4&lt;/property&gt;
-	  &lt;property name=&quot;n_columns&quot;&gt;3&lt;/property&gt;
-	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-	  &lt;property name=&quot;row_spacing&quot;&gt;0&lt;/property&gt;
-	  &lt;property name=&quot;column_spacing&quot;&gt;0&lt;/property&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;hbuttonbox3&quot;&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_DEFAULT_STYLE&lt;/property&gt;
-	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
-
-	      &lt;child&gt;
-		&lt;widget class=&quot;GtkButton&quot; id=&quot;selectButton&quot;&gt;
-		  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
-		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-		  &lt;signal name=&quot;clicked&quot; handler=&quot;on_selectButton_clicked&quot; last_modification_time=&quot;Tue, 09 Mar 2004 19:27:45 GMT&quot;/&gt;
-
-		  &lt;child&gt;
-		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment9&quot;&gt;
-		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-		      &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
-		      &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
-
-		      &lt;child&gt;
-			&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox14&quot;&gt;
-			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-			  &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
-
-			  &lt;child&gt;
-			    &lt;widget class=&quot;GtkImage&quot; id=&quot;image180&quot;&gt;
-			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;stock&quot;&gt;gtk-open&lt;/property&gt;
-			      &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
-			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-			    &lt;/widget&gt;
-			    &lt;packing&gt;
-			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
-			    &lt;/packing&gt;
-			  &lt;/child&gt;
-
-			  &lt;child&gt;
-			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label17&quot;&gt;
-			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Select&lt;/property&gt;
-			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
-			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-			    &lt;/widget&gt;
-			    &lt;packing&gt;
-			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
-			    &lt;/packing&gt;
-			  &lt;/child&gt;
-			&lt;/widget&gt;
-		      &lt;/child&gt;
-		    &lt;/widget&gt;
-		  &lt;/child&gt;
-		&lt;/widget&gt;
-	      &lt;/child&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;left_attach&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;right_attach&quot;&gt;3&lt;/property&gt;
-	      &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
-	      &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkEntry&quot; id=&quot;locationEntry&quot;&gt;
-	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
-	      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
-	      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
-	      &lt;signal name=&quot;changed&quot; handler=&quot;on_locationEntry_changed&quot; last_modification_time=&quot;Sun, 18 Sep 2005 03:55:37 GMT&quot;/&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
-	      &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkEntry&quot; id=&quot;titleEntry&quot;&gt;
-	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
-	      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
-	      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;locationLabel&quot;&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Location:&lt;/property&gt;
-	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-	      &lt;property name=&quot;xpad&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;ypad&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
-	      &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;titleLabel&quot;&gt;
-	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Title:&lt;/property&gt;
-	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-	      &lt;property name=&quot;xpad&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;ypad&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;depthLabel&quot;&gt;
-	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Maximum depth:&lt;/property&gt;
-	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-	      &lt;property name=&quot;xpad&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;ypad&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
-	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-	      &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;depthSpinbutton&quot;&gt;
-	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
-	      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;adjustment&quot;&gt;0 0 100 1 5 5&lt;/property&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
-	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;typeCombobox&quot;&gt;
-	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
-	      &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
-	      &lt;signal name=&quot;changed&quot; handler=&quot;on_typeCombobox_changed&quot; last_modification_time=&quot;Sun, 18 Sep 2005 04:09:29 GMT&quot;/&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
-	      &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-
-	  &lt;child&gt;
-	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;typeLabel&quot;&gt;
-	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Type:&lt;/property&gt;
-	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
-	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
-	      &lt;property name=&quot;xpad&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;ypad&quot;&gt;4&lt;/property&gt;
-	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
-	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
-	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
-	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
-	    &lt;/widget&gt;
-	    &lt;packing&gt;
-	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
-	      &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
-	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
-	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
-	    &lt;/packing&gt;
-	  &lt;/child&gt;
-	&lt;/widget&gt;
-	&lt;packing&gt;
-	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
-	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
-	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
-	&lt;/packing&gt;
-      &lt;/child&gt;
-    &lt;/widget&gt;
-  &lt;/child&gt;
-&lt;/widget&gt;
-
 &lt;widget class=&quot;GtkDialog&quot; id=&quot;propertiesDialog&quot;&gt;
   &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;public&lt;/property&gt;
   &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
@@ -3682,4 +3297,387 @@
   &lt;/child&gt;
 &lt;/widget&gt;
 
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;importDialog&quot;&gt;
+  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Import document&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_NONE&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;focus_on_map&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox7&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area7&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;importButton&quot;&gt;
+	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Import&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;0&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;on_importButton_clicked&quot; last_modification_time=&quot;Mon, 02 Jan 2006 02:49:48 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;closeButton&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-close&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-7&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkTable&quot; id=&quot;docTable&quot;&gt;
+	  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;n_rows&quot;&gt;4&lt;/property&gt;
+	  &lt;property name=&quot;n_columns&quot;&gt;3&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;row_spacing&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;column_spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;hbuttonbox4&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_DEFAULT_STYLE&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkButton&quot; id=&quot;selectButton&quot;&gt;
+		  &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;on_selectButton_clicked&quot; last_modification_time=&quot;Tue, 09 Mar 2004 19:27:45 GMT&quot;/&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment29&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox43&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkImage&quot; id=&quot;image551&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;stock&quot;&gt;gtk-open&lt;/property&gt;
+			      &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label50&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Select&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+			      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+			      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;3&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkEntry&quot; id=&quot;locationEntry&quot;&gt;
+	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+	      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+	      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+	      &lt;signal name=&quot;changed&quot; handler=&quot;on_locationEntry_changed&quot; last_modification_time=&quot;Sun, 18 Sep 2005 03:55:37 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkEntry&quot; id=&quot;titleEntry&quot;&gt;
+	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+	      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+	      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;locationLabel&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Location:&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;3&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;titleLabel&quot;&gt;
+	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Title:&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;depthLabel&quot;&gt;
+	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Maximum depth:&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
+	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;depthSpinbutton&quot;&gt;
+	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+	      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;adjustment&quot;&gt;0 0 100 1 5 5&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;3&lt;/property&gt;
+	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;typeCombobox&quot;&gt;
+	      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+	      &lt;property name=&quot;add_tearoffs&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;signal name=&quot;changed&quot; handler=&quot;on_typeCombobox_changed&quot; last_modification_time=&quot;Sun, 18 Sep 2005 04:09:29 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;x_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_padding&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;typeLabel&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Type:&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;4&lt;/property&gt;
+	      &lt;property name=&quot;ellipsize&quot;&gt;PANGO_ELLIPSIZE_NONE&lt;/property&gt;
+	      &lt;property name=&quot;width_chars&quot;&gt;-1&lt;/property&gt;
+	      &lt;property name=&quot;single_line_mode&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;angle&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+	      &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
 &lt;/glade-interface&gt;

Modified: trunk/UI/GTK2/src/IndexTree.cpp
===================================================================
--- trunk/UI/GTK2/src/IndexTree.cpp	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/IndexTree.cpp	2006-01-02 19:34:26 UTC (rev 47)
@@ -374,9 +374,9 @@
 }
 
 //
-// Sets a document's title.
+// Updates a document's properties.
 //
-void IndexTree::setDocumentTitle(unsigned int docId, const string &amp;text)
+void IndexTree::updateDocumentInfo(unsigned int docId, const DocumentInfo &amp;docInfo)
 {
 	if (docId == 0)
 	{
@@ -391,10 +391,10 @@
 
 		if (docId == row[m_indexColumns.m_id])
 		{
-#ifdef DEBUG
-			cout &lt;&lt; &quot;IndexTree::setLabel: updating title of document &quot; &lt;&lt; docId &lt;&lt; endl;
-#endif
-			row[m_indexColumns.m_text] = to_utf8(text);
+			row[m_indexColumns.m_text] = to_utf8(docInfo.getTitle());
+			row[m_indexColumns.m_type] = to_utf8(docInfo.getType());
+			row[m_indexColumns.m_language] = to_utf8(docInfo.getLanguage());
+			row[m_indexColumns.m_timestamp] = to_utf8(docInfo.getTimestamp());
 			break;
 		}
 	}

Modified: trunk/UI/GTK2/src/IndexTree.h
===================================================================
--- trunk/UI/GTK2/src/IndexTree.h	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/IndexTree.h	2006-01-02 19:34:26 UTC (rev 47)
@@ -67,8 +67,8 @@
 		/// Sets the documents that match the current label.
 		void setLabel(const std::set&lt;unsigned int&gt; &amp;documentsList);
 
-		/// Sets a document's title.
-		void setDocumentTitle(unsigned int docId, const std::string &amp;text);
+		/// Updates a document's properties.
+		void updateDocumentInfo(unsigned int docId, const DocumentInfo &amp;docInfo);
 
 		/// Marks a document as labeled.
 		void setDocumentLabeledState(unsigned int docId, bool labeled);

Modified: trunk/UI/GTK2/src/WorkerThreads.cpp
===================================================================
--- trunk/UI/GTK2/src/WorkerThreads.cpp	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/WorkerThreads.cpp	2006-01-02 19:34:26 UTC (rev 47)
@@ -852,6 +852,9 @@
 			{
 				// Flush the index
 				index.flush();
+
+				// The document properties may have changed
+				index.getDocumentInfo(m_docId, m_docInfo);
 			}
 		}
 

Modified: trunk/UI/GTK2/src/importDialog.cc
===================================================================
--- trunk/UI/GTK2/src/importDialog.cc	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/importDialog.cc	2006-01-02 19:34:26 UTC (rev 47)
@@ -24,7 +24,6 @@
 using namespace std;
 using namespace SigC;
 using namespace Glib;
-using namespace Gdk;
 using namespace Gtk;
 
 string importDialog::m_directory = &quot;&quot;;
@@ -74,9 +73,9 @@
 		depthSpinbutton-&gt;set_value(m_maxDirLevel);
 	}
 
-	// Disable the OK button as long the location entry field is empty
+	// Disable this button as long the location entry field is empty
 	// The title field may remain empty
-	importOkButton-&gt;set_sensitive(false);
+	importButton-&gt;set_sensitive(false);
 }
 
 importDialog::~importDialog()
@@ -149,7 +148,10 @@
 			if (pEntryName != NULL)
 			{
 				string location = fileName;
-				location += &quot;/&quot;;
+				if (fileName[fileName.length() - 1] != '/')
+				{
+					location += &quot;/&quot;;
+				}
 				location += pEntryName;
 
 				// Scan this entry
@@ -170,10 +172,8 @@
 		}
 		closedir(pDir);
 	}
-	else	if (S_ISREG(fileStat.st_mode))
+	else if (S_ISREG(fileStat.st_mode))
 	{
-		// Get the MIME type
-		string mimeType = MIMEScanner::scanFile(fileName);
 		// Build a valid URL
 		string location = &quot;<A HREF="file://">file://</A>&quot;;
 		location += fileName;
@@ -185,12 +185,21 @@
 			title += urlObj.getFile();
 		}
 
-		// Fire up the signal
-		m_signalImportFile(DocumentInfo(title, location, mimeType, &quot;&quot;));
-		++m_docsCount;
+		DocumentInfo docInfo(title, location,
+			MIMEScanner::scanFile(fileName), &quot;&quot;);
+
+		import_file(urlObj.getFile(), docInfo);
 	}
 }
 
+void importDialog::import_file(const string &amp;fileName,
+	const DocumentInfo &amp;docInfo)
+{
+	// Fire up the signal
+	m_signalImportFile(docInfo);
+	++m_docsCount;
+}
+
 ustring importDialog::getDocumentTitle(void)
 {
 	return m_title;
@@ -206,11 +215,13 @@
 	return m_signalImportFile;
 }
 
-void importDialog::on_importOkButton_clicked()
+void importDialog::on_importButton_clicked()
 {
 	string location = locale_from_utf8(locationEntry-&gt;get_text());
 	unsigned int level = 0;
 
+	importButton-&gt;set_sensitive(false);
+
 	// Title
 	m_title = titleEntry-&gt;get_text();
 	// Type
@@ -222,7 +233,7 @@
 			// Update m_directory
 			m_directory = location.substr(0, pos + 1);
 #ifdef DEBUG
-			cout &lt;&lt; &quot;importDialog::on_importOkButton_clicked: directory now &quot; &lt;&lt; m_directory &lt;&lt; endl;
+			cout &lt;&lt; &quot;importDialog::on_importButton_clicked: directory now &quot; &lt;&lt; m_directory &lt;&lt; endl;
 #endif
 		}
 
@@ -234,11 +245,10 @@
 	else
 	{
 		Url urlObj(location);
+		DocumentInfo docInfo(locale_from_utf8(m_title), location,
+			MIMEScanner::scanUrl(urlObj), &quot;&quot;);
 
-		// Signal now
-		m_signalImportFile(DocumentInfo(locale_from_utf8(m_title), location,
-			MIMEScanner::scanUrl(urlObj), &quot;&quot;));
-		++m_docsCount;
+		import_file(urlObj.getFile(), docInfo);
 	}
 }
 
@@ -299,7 +309,7 @@
 		enableOk = false;
 	}
 
-	importOkButton-&gt;set_sensitive(enableOk);
+	importButton-&gt;set_sensitive(enableOk);
 }
 
 void importDialog::on_typeCombobox_changed()

Modified: trunk/UI/GTK2/src/importDialog.hh
===================================================================
--- trunk/UI/GTK2/src/importDialog.hh	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/importDialog.hh	2006-01-02 19:34:26 UTC (rev 47)
@@ -17,6 +17,7 @@
 #include &lt;sigc++/slot.h&gt;
 #include &lt;glibmm/refptr.h&gt;
 #include &lt;glibmm/ustring.h&gt;
+#include &lt;gtkmm/button.h&gt;
 #include &lt;gtkmm/liststore.h&gt;
 
 #include &quot;DocumentInfo.h&quot;
@@ -42,6 +43,8 @@
 protected:
 	void populate_combobox(bool allowLocalOnly);
 	void scan_file(const std::string &amp;fileName, unsigned int &amp;level);
+	void import_file(const std::string &amp;fileName,
+		const DocumentInfo &amp;docInfo);
 
 private:
 	ComboModelColumns m_typeColumns;
@@ -53,7 +56,7 @@
 	SigC::Signal1&lt;void, DocumentInfo&gt; m_signalImportFile;
 	static std::string m_directory;
 
-	virtual void on_importOkButton_clicked();
+	virtual void on_importButton_clicked();
 	virtual void on_selectButton_clicked();
 	virtual void on_locationEntry_changed();
 	virtual void on_typeCombobox_changed();

Modified: trunk/UI/GTK2/src/importDialog_glade.cc
===================================================================
--- trunk/UI/GTK2/src/importDialog_glade.cc	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/importDialog_glade.cc	2006-01-02 19:34:26 UTC (rev 47)
@@ -1,8 +1,8 @@
-// generated 2005/11/6 16:43:41 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
+// generated 2006/1/2 11:20:27 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at thorgrim.dyndns.org.</A>(none)
 // using glademm V2.6.0
 //
 // DO NOT EDIT THIS FILE ! It was created using
-// glade-- /home/fabrice/Projects/MetaSE/metase/UI/GTK2/metase-gtk2.glade
+// glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
 // for gtk 2.6.10 and gtkmm 2.6.2
 //
 // Please modify the corresponding derived classes in ./src/importDialog.cc
@@ -54,19 +54,20 @@
 
 importDialog_glade::importDialog_glade(
 )
-{  importDialog = this;
+{  
+   
+   Gtk::Dialog *importDialog = this;
    gmm_data = new GlademmData(get_accel_group());
+   importButton = Gtk::manage(new class Gtk::Button(_(&quot;Import&quot;)));
    
-   Gtk::Button *cancelbutton1 = Gtk::manage(new class Gtk::Button(Gtk::StockID(&quot;gtk-cancel&quot;)));
-   importOkButton = Gtk::manage(new class Gtk::Button(Gtk::StockID(&quot;gtk-ok&quot;)));
-   
-   Gtk::Image *image180 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-open&quot;), Gtk::IconSize(4)));
-   Gtk::Label *label17 = Gtk::manage(new class Gtk::Label(_(&quot;Select&quot;)));
-   Gtk::HBox *hbox14 = Gtk::manage(new class Gtk::HBox(false, 2));
-   Gtk::Alignment *alignment9 = Gtk::manage(new class Gtk::Alignment(0.5, 0.5, 0, 0));
+   Gtk::Button *closeButton = Gtk::manage(new class Gtk::Button(Gtk::StockID(&quot;gtk-close&quot;)));
+   Gtk::Image *image551 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-open&quot;), Gtk::IconSize(4)));
+   Gtk::Label *label50 = Gtk::manage(new class Gtk::Label(_(&quot;Select&quot;)));
+   Gtk::HBox *hbox43 = Gtk::manage(new class Gtk::HBox(false, 2));
+   Gtk::Alignment *alignment29 = Gtk::manage(new class Gtk::Alignment(0.5, 0.5, 0, 0));
    selectButton = Gtk::manage(new class Gtk::Button());
    
-   Gtk::HButtonBox *hbuttonbox3 = Gtk::manage(new class Gtk::HButtonBox(Gtk::BUTTONBOX_DEFAULT_STYLE, 0));
+   Gtk::HButtonBox *hbuttonbox4 = Gtk::manage(new class Gtk::HButtonBox(Gtk::BUTTONBOX_DEFAULT_STYLE, 0));
    locationEntry = Gtk::manage(new class Gtk::Entry());
    titleEntry = Gtk::manage(new class Gtk::Entry());
    
@@ -80,39 +81,41 @@
    
    Gtk::Label *typeLabel = Gtk::manage(new class Gtk::Label(_(&quot;Type:&quot;)));
    docTable = Gtk::manage(new class Gtk::Table(2, 2, false));
-   cancelbutton1-&gt;set_flags(Gtk::CAN_FOCUS);
-   cancelbutton1-&gt;set_flags(Gtk::CAN_DEFAULT);
-   cancelbutton1-&gt;set_relief(Gtk::RELIEF_NORMAL);
-   importOkButton-&gt;set_flags(Gtk::CAN_FOCUS);
-   importOkButton-&gt;set_flags(Gtk::CAN_DEFAULT);
-   importOkButton-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   importButton-&gt;set_flags(Gtk::CAN_FOCUS);
+   importButton-&gt;set_flags(Gtk::CAN_DEFAULT);
+   importButton-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   closeButton-&gt;set_flags(Gtk::CAN_FOCUS);
+   closeButton-&gt;set_flags(Gtk::CAN_DEFAULT);
+   closeButton-&gt;set_relief(Gtk::RELIEF_NORMAL);
    importDialog-&gt;get_action_area()-&gt;property_layout_style().set_value(Gtk::BUTTONBOX_END);
-   image180-&gt;set_alignment(0.5,0.5);
-   image180-&gt;set_padding(0,0);
-   label17-&gt;set_alignment(0.5,0.5);
-   label17-&gt;set_padding(0,0);
-   label17-&gt;set_justify(Gtk::JUSTIFY_LEFT);
-   label17-&gt;set_line_wrap(false);
-   label17-&gt;set_use_markup(false);
-   label17-&gt;set_selectable(false);
-   hbox14-&gt;pack_start(*image180, Gtk::PACK_SHRINK, 0);
-   hbox14-&gt;pack_start(*label17, Gtk::PACK_SHRINK, 0);
-   alignment9-&gt;add(*hbox14);
+   image551-&gt;set_alignment(0.5,0.5);
+   image551-&gt;set_padding(0,0);
+   label50-&gt;set_alignment(0.5,0.5);
+   label50-&gt;set_padding(0,0);
+   label50-&gt;set_justify(Gtk::JUSTIFY_LEFT);
+   label50-&gt;set_line_wrap(false);
+   label50-&gt;set_use_markup(false);
+   label50-&gt;set_selectable(false);
+   hbox43-&gt;pack_start(*image551, Gtk::PACK_SHRINK, 0);
+   hbox43-&gt;pack_start(*label50, Gtk::PACK_SHRINK, 0);
+   alignment29-&gt;add(*hbox43);
    selectButton-&gt;set_flags(Gtk::CAN_FOCUS);
    selectButton-&gt;set_flags(Gtk::CAN_DEFAULT);
    selectButton-&gt;set_relief(Gtk::RELIEF_NORMAL);
-   selectButton-&gt;add(*alignment9);
-   hbuttonbox3-&gt;pack_start(*selectButton);
+   selectButton-&gt;add(*alignment29);
+   hbuttonbox4-&gt;pack_start(*selectButton);
    locationEntry-&gt;set_flags(Gtk::CAN_FOCUS);
    locationEntry-&gt;set_visibility(true);
    locationEntry-&gt;set_editable(true);
    locationEntry-&gt;set_max_length(0);
+   locationEntry-&gt;set_text(_(&quot;&quot;));
    locationEntry-&gt;set_has_frame(true);
    locationEntry-&gt;set_activates_default(false);
    titleEntry-&gt;set_flags(Gtk::CAN_FOCUS);
    titleEntry-&gt;set_visibility(true);
    titleEntry-&gt;set_editable(true);
    titleEntry-&gt;set_max_length(0);
+   titleEntry-&gt;set_text(_(&quot;&quot;));
    titleEntry-&gt;set_has_frame(true);
    titleEntry-&gt;set_activates_default(false);
    locationLabel-&gt;set_alignment(0,0.5);
@@ -146,7 +149,7 @@
    typeLabel-&gt;set_selectable(false);
    docTable-&gt;set_row_spacings(0);
    docTable-&gt;set_col_spacings(0);
-   docTable-&gt;attach(*hbuttonbox3, 2, 3, 3, 4, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
+   docTable-&gt;attach(*hbuttonbox4, 2, 3, 3, 4, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
    docTable-&gt;attach(*locationEntry, 1, 2, 3, 4, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
    docTable-&gt;attach(*titleEntry, 1, 2, 1, 2, Gtk::EXPAND|Gtk::FILL, Gtk::FILL, 4, 4);
    docTable-&gt;attach(*locationLabel, 0, 1, 3, 4, Gtk::FILL, Gtk::FILL, 0, 0);
@@ -164,16 +167,16 @@
    importDialog-&gt;set_resizable(true);
    importDialog-&gt;property_destroy_with_parent().set_value(false);
    importDialog-&gt;set_has_separator(true);
-   importDialog-&gt;add_action_widget(*cancelbutton1, -6);
-   importDialog-&gt;add_action_widget(*importOkButton, -5);
-   cancelbutton1-&gt;show();
-   importOkButton-&gt;show();
-   image180-&gt;show();
-   label17-&gt;show();
-   hbox14-&gt;show();
-   alignment9-&gt;show();
+   importDialog-&gt;add_action_widget(*importButton, 0);
+   importDialog-&gt;add_action_widget(*closeButton, -7);
+   importButton-&gt;show();
+   closeButton-&gt;show();
+   image551-&gt;show();
+   label50-&gt;show();
+   hbox43-&gt;show();
+   alignment29-&gt;show();
    selectButton-&gt;show();
-   hbuttonbox3-&gt;show();
+   hbuttonbox4-&gt;show();
    locationEntry-&gt;show();
    titleEntry-&gt;show();
    locationLabel-&gt;show();
@@ -184,7 +187,7 @@
    typeLabel-&gt;show();
    docTable-&gt;show();
    importDialog-&gt;show();
-   importOkButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;importDialog_glade::on_importOkButton_clicked), false);
+   importButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;importDialog_glade::on_importButton_clicked), false);
    selectButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;importDialog_glade::on_selectButton_clicked), false);
    locationEntry-&gt;signal_changed().connect(SigC::slot(*this, &amp;importDialog_glade::on_locationEntry_changed), false);
    typeCombobox-&gt;signal_changed().connect(SigC::slot(*this, &amp;importDialog_glade::on_typeCombobox_changed), false);

Modified: trunk/UI/GTK2/src/importDialog_glade.hh
===================================================================
--- trunk/UI/GTK2/src/importDialog_glade.hh	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/importDialog_glade.hh	2006-01-02 19:34:26 UTC (rev 47)
@@ -1,8 +1,8 @@
-// generated 2005/11/6 16:25:47 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
+// generated 2006/1/2 11:20:27 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at thorgrim.dyndns.org.</A>(none)
 // using glademm V2.6.0
 //
 // DO NOT EDIT THIS FILE ! It was created using
-// glade-- /home/fabrice/Projects/MetaSE/metase/UI/GTK2/metase-gtk2.glade
+// glade-- /home/fabrice/Projects/MetaSE/pinot/UI/GTK2/metase-gtk2.glade
 // for gtk 2.6.10 and gtkmm 2.6.2
 //
 // Please modify the corresponding derived classes in ./src/importDialog.hh and./src/importDialog.cc
@@ -43,10 +43,8 @@
 {  
         
         GlademmData *gmm_data;
-public:
-        class Gtk::Dialog * importDialog;
 protected:
-        class Gtk::Button * importOkButton;
+        class Gtk::Button * importButton;
         class Gtk::Button * selectButton;
         class Gtk::Entry * locationEntry;
         class Gtk::Entry * titleEntry;
@@ -60,7 +58,7 @@
         
         ~importDialog_glade();
 private:
-        virtual void on_importOkButton_clicked() = 0;
+        virtual void on_importButton_clicked() = 0;
         virtual void on_selectButton_clicked() = 0;
         virtual void on_locationEntry_changed() = 0;
         virtual void on_typeCombobox_changed() = 0;

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/mainWindow.cc	2006-01-02 19:34:26 UTC (rev 47)
@@ -74,6 +74,7 @@
 unsigned int mainWindow::m_maxThreads = 2;
 
 mainWindow::InternalState::InternalState() :
+	m_liveQueryLength(0),
 	m_currentPage(0),
 	m_backgroundThreads(0),
 	m_browsingIndex(false)
@@ -1125,7 +1126,7 @@
 			if (pIndexTree != NULL)
 			{
 				// Update the index tree
-				pIndexTree-&gt;setDocumentTitle(docId, docInfo.getTitle());
+				pIndexTree-&gt;updateDocumentInfo(docId, docInfo);
 			}
 		}
 		else
@@ -1209,8 +1210,8 @@
 			IndexTree *pIndexTree = pIndexPage-&gt;getTree();
 			if (pIndexTree != NULL)
 			{
-				pIndexTree-&gt;setDocumentTitle(pUpdateThread-&gt;getDocumentID(),
-					pUpdateThread-&gt;getDocumentInfo().getTitle());
+				pIndexTree-&gt;updateDocumentInfo(pUpdateThread-&gt;getDocumentID(),
+					pUpdateThread-&gt;getDocumentInfo());
 			}
 		}
 
@@ -2260,7 +2261,6 @@
 			m_pEnginesTree-&gt;populate();
 		}
 	}
-
 }
 
 //
@@ -2269,17 +2269,20 @@
 void mainWindow::on_liveQueryEntry_changed()
 {
 	ustring liveQuery = liveQueryEntry-&gt;get_text();
+	unsigned int liveQueryLength = liveQuery.length();
 
 	// Reset the list
 	m_refLiveQueryList-&gt;clear();
 
-	if (m_refLiveQueryCompletion-&gt;get_minimum_key_length() &gt; liveQuery.length())
+	// If characters are being deleted or if the string is too short, don't
+	// attempt to offer suggestions
+	if ((m_state.m_liveQueryLength &gt; liveQueryLength) ||
+		(m_refLiveQueryCompletion-&gt;get_minimum_key_length() &gt; liveQueryLength))
 	{
-#ifdef DEBUG
-		cout &lt;&lt; &quot;mainWindow::on_liveQueryEntry_changed: too short&quot; &lt;&lt; endl;
-#endif
+		m_state.m_liveQueryLength = liveQueryLength;
 		return;
 	}
+	m_state.m_liveQueryLength = liveQueryLength;
 
 	// FIXME: relying on other indices may also be useful
 	XapianIndex docsIndex(m_settings.m_indexLocation);

Modified: trunk/UI/GTK2/src/mainWindow.hh
===================================================================
--- trunk/UI/GTK2/src/mainWindow.hh	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/mainWindow.hh	2006-01-02 19:34:26 UTC (rev 47)
@@ -176,6 +176,8 @@
 			bool writeLock(unsigned int where);
 			void unlock(void);
 
+			// Query
+			unsigned int m_liveQueryLength;
 			// Notebook pages
 			int m_currentPage;
 			// Worker threads

Modified: trunk/UI/GTK2/src/mainWindow_glade.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow_glade.cc	2006-01-02 19:30:57 UTC (rev 46)
+++ trunk/UI/GTK2/src/mainWindow_glade.cc	2006-01-02 19:34:26 UTC (rev 47)
@@ -1,4 +1,4 @@
-// generated 2006/1/1 8:46:21 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at thorgrim.dyndns.org.</A>(none)
+// generated 2006/1/2 11:20:25 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at thorgrim.dyndns.org.</A>(none)
 // using glademm V2.6.0
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -427,7 +427,6 @@
    mainStatusbar-&gt;show();
    mainHbox-&gt;show();
    vbox1-&gt;show();
-   mainWindow-&gt;show();
    configure1-&gt;signal_activate().connect(SigC::slot(*this, &amp;mainWindow_glade::on_configure_activate), false);
    quit1-&gt;signal_activate().connect(SigC::slot(*this, &amp;mainWindow_glade::on_quit_activate), false);
    cut1-&gt;signal_activate().connect(SigC::slot(*this, &amp;mainWindow_glade::on_cut_activate), false);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000045.html">[Pinot-svn] r46 - trunk/Index
</A></li>
	<LI>Next message: <A HREF="000046.html">[Pinot-svn] r48 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47">[ date ]</a>
              <a href="thread.html#47">[ thread ]</a>
              <a href="subject.html#47">[ subject ]</a>
              <a href="author.html#47">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/pinot-svn">More information about the Pinot-svn
mailing list</a><br>
</body></html>
