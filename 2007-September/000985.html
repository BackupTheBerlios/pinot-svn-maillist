<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Pinot-svn] r991 - in trunk/UI/GTK2: . src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/pinot-svn/2007-September/index.html" >
   <LINK REL="made" HREF="mailto:pinot-svn%40lists.berlios.de?Subject=Re%3A%20%5BPinot-svn%5D%20r991%20-%20in%20trunk/UI/GTK2%3A%20.%20src&In-Reply-To=%3C200709251340.l8PDe1kV015021%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000984.html">
   <LINK REL="Next"  HREF="000986.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Pinot-svn] r991 - in trunk/UI/GTK2: . src</H1>
    <B>fabricecolin at BerliOS</B> 
    <A HREF="mailto:pinot-svn%40lists.berlios.de?Subject=Re%3A%20%5BPinot-svn%5D%20r991%20-%20in%20trunk/UI/GTK2%3A%20.%20src&In-Reply-To=%3C200709251340.l8PDe1kV015021%40sheep.berlios.de%3E"
       TITLE="[Pinot-svn] r991 - in trunk/UI/GTK2: . src">fabricecolin at mail.berlios.de
       </A><BR>
    <I>Tue Sep 25 15:40:01 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000984.html">[Pinot-svn] r990 - trunk/UI/GTK2/src
</A></li>
        <LI>Next message: <A HREF="000986.html">[Pinot-svn] r992 - in trunk: Index Search Search/Google
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#985">[ date ]</a>
              <a href="thread.html#985">[ thread ]</a>
              <a href="subject.html#985">[ subject ]</a>
              <a href="author.html#985">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: fabricecolin
Date: 2007-09-25 15:40:00 +0200 (Tue, 25 Sep 2007)
New Revision: 991

Modified:
   trunk/UI/GTK2/metase-gtk2.glade
   trunk/UI/GTK2/src/mainWindow.cc
   trunk/UI/GTK2/src/mainWindow.hh
   trunk/UI/GTK2/src/mainWindow_glade.cc
   trunk/UI/GTK2/src/mainWindow_glade.hh
Log:
Backtracked previous UI changes. I realized that combining queries is not that
useful. Users can do that manually with copy-and-paste already.
Now there's a Search Again For menuitem that runs a specific query against
currently selected (indexed) results.
Removed the Edit query button, edits are done on a double-click. Added tooltips.


Modified: trunk/UI/GTK2/metase-gtk2.glade
===================================================================
--- trunk/UI/GTK2/metase-gtk2.glade	2007-09-25 13:32:14 UTC (rev 990)
+++ trunk/UI/GTK2/metase-gtk2.glade	2007-09-25 13:40:00 UTC (rev 991)
@@ -176,7 +176,7 @@
 			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Search Engine&lt;/property&gt;
 			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;active&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
 			      &lt;signal name=&quot;activate&quot; handler=&quot;on_groupresults_activate&quot; last_modification_time=&quot;Sat, 28 Feb 2004 17:56:26 GMT&quot;/&gt;
 			    &lt;/widget&gt;
 			  &lt;/child&gt;
@@ -187,7 +187,7 @@
 			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Host Name&lt;/property&gt;
 			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;active&quot;&gt;True&lt;/property&gt;
 			      &lt;property name=&quot;group&quot;&gt;searchenginegroup1&lt;/property&gt;
 			    &lt;/widget&gt;
 			  &lt;/child&gt;
@@ -215,7 +215,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_clearresults_activate&quot; last_modification_time=&quot;Wed, 03 Mar 2004 19:51:48 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image701&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image718&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-clear&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -262,8 +262,29 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_morelikethis_activate&quot; last_modification_time=&quot;Sun, 18 Jun 2006 10:50:56 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image702&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image719&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;stock&quot;&gt;gtk-add&lt;/property&gt;
+			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkImageMenuItem&quot; id=&quot;searchagain1&quot;&gt;
+		      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Search This For&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+
+		      &lt;child internal-child=&quot;image&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image720&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-find&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
 			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
@@ -317,7 +338,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_import_activate&quot; last_modification_time=&quot;Tue, 02 Mar 2004 22:13:44 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image703&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image721&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-open&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -355,7 +376,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_refreshindex_activate&quot; last_modification_time=&quot;Fri, 20 Feb 2004 18:57:09 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image704&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image722&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-refresh&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -377,7 +398,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_unindex_activate&quot; last_modification_time=&quot;Thu, 28 Jul 2005 12:42:23 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image705&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image723&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-delete&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -399,7 +420,7 @@
 		      &lt;signal name=&quot;activate&quot; handler=&quot;on_showfromindex_activate&quot; last_modification_time=&quot;Sun, 06 Nov 2005 08:43:05 GMT&quot;/&gt;
 
 		      &lt;child internal-child=&quot;image&quot;&gt;
-			&lt;widget class=&quot;GtkImage&quot; id=&quot;image706&quot;&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image724&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
 			  &lt;property name=&quot;stock&quot;&gt;gtk-properties&lt;/property&gt;
 			  &lt;property name=&quot;icon_size&quot;&gt;1&lt;/property&gt;
@@ -728,76 +749,55 @@
 		      &lt;/child&gt;
 
 		      &lt;child&gt;
-			&lt;widget class=&quot;GtkToolbar&quot; id=&quot;queryToolbar&quot;&gt;
+			&lt;widget class=&quot;GtkVButtonBox&quot; id=&quot;queryVbuttonbox&quot;&gt;
 			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;orientation&quot;&gt;GTK_ORIENTATION_VERTICAL&lt;/property&gt;
-			  &lt;property name=&quot;toolbar_style&quot;&gt;GTK_TOOLBAR_ICONS&lt;/property&gt;
-			  &lt;property name=&quot;tooltips&quot;&gt;True&lt;/property&gt;
-			  &lt;property name=&quot;show_arrow&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_START&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
 
 			  &lt;child&gt;
-			    &lt;widget class=&quot;GtkToolButton&quot; id=&quot;addQueryButton&quot;&gt;
+			    &lt;widget class=&quot;GtkButton&quot; id=&quot;addQueryButton&quot;&gt;
+			      &lt;property name=&quot;border_width&quot;&gt;4&lt;/property&gt;
 			      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
 			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;stock_id&quot;&gt;gtk-add&lt;/property&gt;
-			      &lt;property name=&quot;visible_horizontal&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;visible_vertical&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;is_important&quot;&gt;False&lt;/property&gt;
-			      &lt;signal name=&quot;clicked&quot; handler=&quot;on_addQueryButton_clicked&quot; last_modification_time=&quot;Mon, 24 Sep 2007 03:03:29 GMT&quot;/&gt;
+			      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot;&gt;gtk-add&lt;/property&gt;
+			      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			      &lt;signal name=&quot;clicked&quot; handler=&quot;on_addQueryButton_clicked&quot; last_modification_time=&quot;Fri, 25 Feb 2005 23:22:27 GMT&quot;/&gt;
 			    &lt;/widget&gt;
-			    &lt;packing&gt;
-			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-			    &lt;/packing&gt;
 			  &lt;/child&gt;
 
 			  &lt;child&gt;
-			    &lt;widget class=&quot;GtkToolButton&quot; id=&quot;editQueryButton&quot;&gt;
+			    &lt;widget class=&quot;GtkButton&quot; id=&quot;removeQueryButton&quot;&gt;
+			      &lt;property name=&quot;border_width&quot;&gt;4&lt;/property&gt;
 			      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
 			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;stock_id&quot;&gt;gtk-edit&lt;/property&gt;
-			      &lt;property name=&quot;visible_horizontal&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;visible_vertical&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;is_important&quot;&gt;False&lt;/property&gt;
-			      &lt;signal name=&quot;clicked&quot; handler=&quot;on_editQueryButton_clicked&quot; last_modification_time=&quot;Mon, 24 Sep 2007 03:04:25 GMT&quot;/&gt;
+			      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot;&gt;gtk-remove&lt;/property&gt;
+			      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			      &lt;signal name=&quot;clicked&quot; handler=&quot;on_removeQueryButton_clicked&quot; last_modification_time=&quot;Fri, 25 Feb 2005 23:38:42 GMT&quot;/&gt;
 			    &lt;/widget&gt;
-			    &lt;packing&gt;
-			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-			    &lt;/packing&gt;
 			  &lt;/child&gt;
 
 			  &lt;child&gt;
-			    &lt;widget class=&quot;GtkToolButton&quot; id=&quot;removeQueryButton&quot;&gt;
+			    &lt;widget class=&quot;GtkButton&quot; id=&quot;findQueryButton&quot;&gt;
+			      &lt;property name=&quot;border_width&quot;&gt;4&lt;/property&gt;
 			      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
 			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;stock_id&quot;&gt;gtk-remove&lt;/property&gt;
-			      &lt;property name=&quot;visible_horizontal&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;visible_vertical&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;is_important&quot;&gt;False&lt;/property&gt;
-			      &lt;signal name=&quot;clicked&quot; handler=&quot;on_removeQueryButton_clicked&quot; last_modification_time=&quot;Mon, 24 Sep 2007 03:07:13 GMT&quot;/&gt;
+			      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot;&gt;gtk-find&lt;/property&gt;
+			      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			      &lt;signal name=&quot;clicked&quot; handler=&quot;on_findQueryButton_clicked&quot; last_modification_time=&quot;Sat, 26 Feb 2005 13:31:59 GMT&quot;/&gt;
 			    &lt;/widget&gt;
-			    &lt;packing&gt;
-			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-			    &lt;/packing&gt;
 			  &lt;/child&gt;
-
-			  &lt;child&gt;
-			    &lt;widget class=&quot;GtkToolButton&quot; id=&quot;findQueryButton&quot;&gt;
-			      &lt;property agent=&quot;glademm&quot; name=&quot;cxx_visibility&quot;&gt;protected&lt;/property&gt;
-			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;stock_id&quot;&gt;gtk-find&lt;/property&gt;
-			      &lt;property name=&quot;visible_horizontal&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;visible_vertical&quot;&gt;True&lt;/property&gt;
-			      &lt;property name=&quot;is_important&quot;&gt;False&lt;/property&gt;
-			      &lt;signal name=&quot;clicked&quot; handler=&quot;on_findQueryButton_clicked&quot; last_modification_time=&quot;Mon, 24 Sep 2007 03:07:43 GMT&quot;/&gt;
-			    &lt;/widget&gt;
-			    &lt;packing&gt;
-			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
-			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
-			    &lt;/packing&gt;
-			  &lt;/child&gt;
 			&lt;/widget&gt;
 			&lt;packing&gt;
 			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;

Modified: trunk/UI/GTK2/src/mainWindow.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow.cc	2007-09-25 13:32:14 UTC (rev 990)
+++ trunk/UI/GTK2/src/mainWindow.cc	2007-09-25 13:40:00 UTC (rev 991)
@@ -225,9 +225,6 @@
 	// Connect to the &quot;changed&quot; signal
 	queryTreeview-&gt;get_selection()-&gt;signal_changed().connect(
 		SigC::slot(*this, &amp;mainWindow::on_queryTreeviewSelection_changed));
-	// Connect to the find button's &quot;show menu&quot; signal
-	findQueryButton-&gt;signal_show_menu().connect(
-		SigC::slot(*this, &amp;mainWindow::populate_findMenu));
 	// Populate
 	populate_queryTreeview(&quot;&quot;);
 
@@ -243,7 +240,6 @@
 		SigC::slot(*this, &amp;mainWindow::on_switch_page), false);
 
 	// Gray out menu items
-	editQueryButton-&gt;set_sensitive(false);
 	removeQueryButton-&gt;set_sensitive(false);
 	findQueryButton-&gt;set_sensitive(false);
 	show_global_menuitems(false);
@@ -253,8 +249,12 @@
 
 	// Set tooltips
 	m_tooltips.set_tip(*enginesTogglebutton, _(&quot;Show all search engines&quot;));
-	m_tooltips.set_tip(*addIndexButton, _(&quot;Add index&quot;));
-	m_tooltips.set_tip(*removeIndexButton, _(&quot;Remove index&quot;));
+	m_tooltips.set_tip(*findButton, _(&quot;Find documents that match the query string&quot;));
+	m_tooltips.set_tip(*addIndexButton, _(&quot;Add an index&quot;));
+	m_tooltips.set_tip(*removeIndexButton, _(&quot;Remove an index&quot;));
+	m_tooltips.set_tip(*addQueryButton, _(&quot;Add a query&quot;));
+	m_tooltips.set_tip(*removeQueryButton, _(&quot;Remove a query&quot;));
+	m_tooltips.set_tip(*findQueryButton, _(&quot;Find documents that match the query&quot;));
 
 	// Connect to threads' finished signal
 	m_state.connect();
@@ -481,7 +481,7 @@
 	if (m_pFindMenu == NULL)
 	{
 		m_pFindMenu = manage(new Menu());
-		findQueryButton-&gt;set_menu(*m_pFindMenu);
+		searchagain1-&gt;set_submenu(*m_pFindMenu);
 	}
 	else
 	{
@@ -489,28 +489,20 @@
 		m_pFindMenu-&gt;items().clear();
 	}
 
-	// Regular find, as if the button was clicked
-	m_pFindMenu-&gt;items().push_back(Menu_Helpers::MenuElem(_(&quot;In all documents&quot;)));
-	MenuItem &amp;menuItem0 = m_pFindMenu-&gt;items().back();
-	menuItem0.signal_activate().connect(SigC::slot(*this, &amp;mainWindow::on_findQueryButton_clicked));
+	SigC::Slot1&lt;void, ustring&gt; findSlot = SigC::slot(*this, &amp;mainWindow::on_searchagain_changed);
 
-	// Is a results page being shown right now ?
-	NotebookPageBox *pNotebookPage = get_current_page();
-	if (pNotebookPage != NULL)
+	TreeModel::Children children = m_refQueryTree-&gt;children();
+	for (TreeModel::Children::iterator iter = children.begin();
+		iter != children.end(); ++iter)
 	{
-		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
-		if (pResultsPage != NULL)
-		{
-			ustring findMenuItem(_(&quot;In all results of&quot;));
+		TreeModel::Row row = *iter;
+		ustring queryName(row[m_queryColumns.m_name]);
 
-			findMenuItem += &quot; &quot;;
-			findMenuItem += pResultsPage-&gt;getTitle();
-
-			// Find and combine with the query whose results are being shown
-			m_pFindMenu-&gt;items().push_back(Menu_Helpers::MenuElem(findMenuItem));
-			MenuItem &amp;menuItem = m_pFindMenu-&gt;items().back();
-			menuItem.signal_activate().connect(SigC::slot(*this, &amp;mainWindow::on_find_changed));
-		}
+		m_pFindMenu-&gt;items().push_back(Menu_Helpers::MenuElem(queryName));
+		MenuItem &amp;menuItem = m_pFindMenu-&gt;items().back();
+		// Bind the callback's parameter to the query name
+		SigC::Slot0&lt;void&gt; menuItemSlot = sigc::bind(findSlot, queryName);
+		menuItem.signal_activate().connect(menuItemSlot);
 	}
 }
 
@@ -550,44 +542,49 @@
 	{
 		populate_queryTreeview(queryName);
 		queryExpander-&gt;set_expanded(true);
+		populate_findMenu();
 	}	
 }
 
 //
 // Get selected results in the current results tab
 //
-bool mainWindow::get_results_page_details(QueryProperties &amp;queryProps, set&lt;string&gt; &amp;locations)
+bool mainWindow::get_results_page_details(const ustring &amp;queryName,
+	QueryProperties &amp;queryProps, set&lt;string&gt; &amp;locations)
 {
 	vector&lt;DocumentInfo&gt; resultsList;
-	ustring queryName;
+	ustring currentQueryName(queryName);
 
 	locations.clear();
 
-	NotebookPageBox *pNotebookPage = get_current_page();
-	if (pNotebookPage != NULL)
+	if (currentQueryName.empty() == true)
 	{
-		ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
-		if (pResultsPage != NULL)
+		NotebookPageBox *pNotebookPage = get_current_page();
+		if (pNotebookPage != NULL)
 		{
-			ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
-			if (pResultsTree != NULL)
+			ResultsPage *pResultsPage = dynamic_cast&lt;ResultsPage*&gt;(pNotebookPage);
+			if (pResultsPage != NULL)
 			{
-				pResultsTree-&gt;getSelection(resultsList);
+				ResultsTree *pResultsTree = pResultsPage-&gt;getTree();
+				if (pResultsTree != NULL)
+				{
+					pResultsTree-&gt;getSelection(resultsList);
+				}
+
+				currentQueryName = pResultsPage-&gt;getTitle();
 			}
+		}
 
-			queryName = pResultsPage-&gt;getTitle();
+		if (currentQueryName.empty() == true)
+		{
+			return false;
 		}
 	}
 
-	if (queryName.empty() == true)
-	{
-		return false;
-	}
-
 	// Find this query
-	if (queryName == _(&quot;Live query&quot;))
+	if (currentQueryName == _(&quot;Live query&quot;))
 	{
-		queryProps.setName(queryName);
+		queryProps.setName(currentQueryName);
 		queryProps.setFreeQuery(liveQueryEntry-&gt;get_text());
 	}
 	else
@@ -600,7 +597,7 @@
 		{
 			TreeModel::Row row = *iter;
 
-			if (queryName == from_utf8(row[m_queryColumns.m_name]))
+			if (currentQueryName == from_utf8(row[m_queryColumns.m_name]))
 			{
 				queryProps = row[m_queryColumns.m_properties];
 				foundQuery = true;
@@ -641,7 +638,6 @@
 		enableButtons = true;
 	}
 
-	editQueryButton-&gt;set_sensitive(enableButtons);
 	removeQueryButton-&gt;set_sensitive(enableButtons);
 	findQueryButton-&gt;set_sensitive(enableButtons);
 }
@@ -753,6 +749,7 @@
 		viewresults1-&gt;set_sensitive(isViewable);
 		viewcache1-&gt;set_sensitive(isCached);
 		morelikethis1-&gt;set_sensitive(isIndexed);
+		searchagain1-&gt;set_sensitive(isIndexed);
 		indexresults1-&gt;set_sensitive(isIndexable);
 	}
 	else
@@ -761,6 +758,7 @@
 		viewresults1-&gt;set_sensitive(false);
 		viewcache1-&gt;set_sensitive(false);
 		morelikethis1-&gt;set_sensitive(false);
+		searchagain1-&gt;set_sensitive(false);
 		indexresults1-&gt;set_sensitive(false);
 
 		// Reset
@@ -972,42 +970,71 @@
 }
 
 //
-// Stored queries' Find menu selected
+// Results &gt; Search This For menu selected
 //
-void mainWindow::on_find_changed()
+void mainWindow::on_searchagain_changed(ustring queryName)
 {
+	QueryProperties queryProps;
 	QueryProperties currentQueryProps;
 	set&lt;string&gt; locations;
 
-	if (get_results_page_details(currentQueryProps, locations) == false)
+	// Get the properties of the given query and
+	// selected results on the current results page
+	if ((get_results_page_details(queryName, queryProps, locations) == false) ||
+		(get_results_page_details(&quot;&quot;, currentQueryProps, locations) == false))
 	{
-		// No query and/or results found, run the search as per normal
-		on_findQueryButton_clicked();
+		// Maybe the query was deleted
+		if (queryProps.getName().empty() == false)
+		{
+			ustring status(_(&quot;Couldn't find query&quot;));
+			status += &quot; &quot;;
+			status += queryName;
+			set_status(status);
+		}
+
 		return;
 	}
 
-	TreeModel::iterator queryIter = queryTreeview-&gt;get_selection()-&gt;get_selected();
-	// Anything selected ?
-	if (queryIter)
+	if (locations.empty() == false)
 	{
-		TreeModel::Row queryRow = *queryIter;
-		QueryProperties queryProps = queryRow[m_queryColumns.m_properties];
+		std::map&lt;std::string, std::string&gt; indexes = m_settings.getIndexes();
 		ustring queryName(queryProps.getName());
-		string queryStr(queryProps.getFreeQuery());
-		time_t lastRunTime = time(NULL);
+		ustring queryStr(queryProps.getFreeQuery());
+		bool firstLocation = true;
 
-		// Combine both queries
-		queryProps.setName(queryName + &quot; &quot; + _(&quot;in&quot;) + &quot; &quot; + currentQueryProps.getName());
-		queryProps.setFreeQuery(&quot;(&quot; + currentQueryProps.getFreeQuery() + &quot;) + (&quot; + queryStr + &quot;)&quot;);
+		queryProps.setName(queryName + &quot; &quot; + _(&quot;in results&quot;));
+		queryStr += &quot; +(&quot;;
+		for (set&lt;string&gt;::const_iterator locationIter = locations.begin();
+			locationIter != locations.end(); ++locationIter)
+		{
+			if (firstLocation == false)
+			{
+				queryStr += &quot; or &quot;;
+			}
+			queryStr += &quot;url:\&quot;&quot;;
+			queryStr += *locationIter;
+			queryStr += &quot;\&quot;&quot;;
+			firstLocation = false;
+		}
+		queryStr += &quot;)&quot;;
 #ifdef DEBUG
-		cout &lt;&lt; &quot;mainWindow::on_find_changed: combined into &quot; &lt;&lt; queryProps.getFreeQuery() &lt;&lt; endl;
+		cout &lt;&lt; &quot;mainWindow::on_searchagain_changed: &quot; &lt;&lt; queryStr &lt;&lt; endl;
 #endif
+		queryProps.setFreeQuery(queryStr);
 
-		run_search(queryProps);
-
-		// Update the Last Run column
-		queryRow[m_queryColumns.m_lastRun] = to_utf8(TimeConverter::toTimestamp(lastRunTime));
-		queryRow[m_queryColumns.m_lastRunTime] = lastRunTime;
+		// Spawn new threads
+		std::map&lt;std::string, std::string&gt;::const_iterator indexIter = indexes.find(_(&quot;My Documents&quot;));
+		if (indexIter != indexes.end())
+		{
+			start_thread(new QueryingThread(&quot;xapian&quot;, indexIter-&gt;first,
+				indexIter-&gt;second, queryProps));
+		}
+		indexIter = indexes.find(_(&quot;My Web Pages&quot;));
+		if (indexIter != indexes.end())
+		{
+			start_thread(new QueryingThread(&quot;xapian&quot;, indexIter-&gt;first,
+				indexIter-&gt;second, queryProps));
+		}
 	}
 }
 
@@ -2076,7 +2103,8 @@
 	QueryProperties queryProps;
 	set&lt;string&gt; locations;
 
-	if (get_results_page_details(queryProps, locations) == false)
+	// Get the current page's details
+	if (get_results_page_details(&quot;&quot;, queryProps, locations) == false)
 	{
 		// Maybe the query was deleted
 		if (queryProps.getName().empty() == false)
@@ -2737,26 +2765,6 @@
 }
 
 //
-// Edit query button click
-//
-void mainWindow::on_editQueryButton_clicked()
-{
-	TreeModel::iterator iter = queryTreeview-&gt;get_selection()-&gt;get_selected();
-	// Anything selected ?
-	if (iter)
-	{
-		TreeModel::Row row = *iter;
-#ifdef DEBUG
-		cout &lt;&lt; &quot;mainWindow::on_editQueryButton_clicked: selected &quot; &lt;&lt; row[m_queryColumns.m_name] &lt;&lt; endl;
-#endif
-
-		// Edit this query's properties
-		QueryProperties queryProps = row[m_queryColumns.m_properties];
-		edit_query(queryProps, false);
-	}
-}
-
-//
 // Remove query button click
 //
 void mainWindow::on_removeQueryButton_clicked()
@@ -2783,6 +2791,8 @@
 			m_refQueryTree-&gt;erase(row);
 
 			queryTreeview-&gt;columns_autosize();
+
+			populate_findMenu();
 		}
 
 		if (m_state.read_lock_lists() == true)
@@ -2818,7 +2828,7 @@
 void mainWindow::on_findQueryButton_clicked()
 {
 	TreeModel::iterator queryIter = queryTreeview-&gt;get_selection()-&gt;get_selected();
-	// Anything selected ?
+	// Any query selected ?
 	if (queryIter)
 	{
 		TreeModel::Row queryRow = *queryIter;
@@ -2885,7 +2895,19 @@
 	// Check for double clicks
 	if (ev-&gt;type == GDK_2BUTTON_PRESS)
 	{
-		on_editQueryButton_clicked();
+		TreeModel::iterator iter = queryTreeview-&gt;get_selection()-&gt;get_selected();
+		// Anything selected ?
+		if (iter)
+		{
+			TreeModel::Row row = *iter;
+#ifdef DEBUG
+			cout &lt;&lt; &quot;mainWindow::on_queryTreeview_button_press_event: selected &quot; &lt;&lt; row[m_queryColumns.m_name] &lt;&lt; endl;
+#endif
+
+			// Edit this query's properties
+			QueryProperties queryProps = row[m_queryColumns.m_properties];
+			edit_query(queryProps, false);
+		}
 	}
 
 	return false;
@@ -2953,6 +2975,7 @@
 	viewresults1-&gt;set_sensitive(showItems);
 	viewcache1-&gt;set_sensitive(showItems);
 	morelikethis1-&gt;set_sensitive(showItems);
+	searchagain1-&gt;set_sensitive(showItems);
 	indexresults1-&gt;set_sensitive(showItems);
 
 	// Index menuitems that depend on selection
@@ -3136,6 +3159,7 @@
 	}
 
 	populate_queryTreeview(queryProps.getName());
+	populate_findMenu();
 
 	if (m_state.read_lock_lists() == true)
 	{

Modified: trunk/UI/GTK2/src/mainWindow.hh
===================================================================
--- trunk/UI/GTK2/src/mainWindow.hh	2007-09-25 13:32:14 UTC (rev 990)
+++ trunk/UI/GTK2/src/mainWindow.hh	2007-09-25 13:40:00 UTC (rev 991)
@@ -64,7 +64,8 @@
 	void populate_indexMenu();
 	void populate_findMenu();
 	void add_query(QueryProperties &amp;queryProps, bool mergeQueries);
-	bool get_results_page_details(QueryProperties &amp;queryProps, std::set&lt;std::string&gt; &amp;locations);
+	bool get_results_page_details(const Glib::ustring &amp;queryName,
+		QueryProperties &amp;queryProps, std::set&lt;std::string&gt; &amp;locations);
 
 	// Handlers
 	void on_enginesTreeviewSelection_changed();
@@ -73,7 +74,7 @@
 	void on_indexTreeviewSelection_changed(Glib::ustring indexName);
 	void on_index_changed(Glib::ustring indexName);
 	void on_cache_changed(PinotSettings::CacheProvider cacheProvider);
-	void on_find_changed();
+	void on_searchagain_changed(Glib::ustring queryName);
 	void on_query_changed(Glib::ustring indexName, Glib::ustring queryName);
 	void on_switch_page(GtkNotebookPage *p0, guint p1);
 	void on_close_page(Glib::ustring title, NotebookPageBox::PageType type);
@@ -115,7 +116,6 @@
 	virtual void on_liveQueryEntry_activate();
 	virtual void on_findButton_clicked();
 	virtual void on_addQueryButton_clicked();
-	virtual void on_editQueryButton_clicked();
 	virtual void on_removeQueryButton_clicked();
 	virtual void on_findQueryButton_clicked();
 

Modified: trunk/UI/GTK2/src/mainWindow_glade.cc
===================================================================
--- trunk/UI/GTK2/src/mainWindow_glade.cc	2007-09-25 13:32:14 UTC (rev 990)
+++ trunk/UI/GTK2/src/mainWindow_glade.cc	2007-09-25 13:40:00 UTC (rev 991)
@@ -1,4 +1,4 @@
-// generated 2007/9/24 20:22:15 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
+// generated 2007/9/24 22:21:22 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -41,13 +41,12 @@
 #include &lt;gtkmm/menuitem.h&gt;
 #include &lt;gtkmm/menu.h&gt;
 #include &lt;gtkmm/image.h&gt;
+#include &lt;gtkmm/imagemenuitem.h&gt;
 #include &lt;gtkmm/menubar.h&gt;
 #include &lt;gtkmm/box.h&gt;
 #include &lt;gtkmm/label.h&gt;
 #include &lt;gtkmm/buttonbox.h&gt;
 #include &lt;gtkmm/scrolledwindow.h&gt;
-#include &lt;gtkmm/stockid.h&gt;
-#include &lt;gtkmm/toolbar.h&gt;
 #ifndef ENABLE_NLS
 #  define textdomain(String) (String)
 #  define gettext(String) (String)
@@ -83,26 +82,28 @@
    Gtk::Menu *groupresults1_menu = Gtk::manage(new class Gtk::Menu());
    groupresults1 = NULL;
    exportresults1 = NULL;
-   Gtk::Image *image701 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-clear&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image718 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-clear&quot;), Gtk::IconSize(1)));
    clearresults1 = NULL;
    Gtk::MenuItem *separator1 = NULL;
    viewresults1 = NULL;
    viewcache1 = NULL;
-   Gtk::Image *image702 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-find&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image719 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-add&quot;), Gtk::IconSize(1)));
    morelikethis1 = NULL;
+   searchagain1 = NULL;
+   Gtk::Image *image720 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-find&quot;), Gtk::IconSize(1)));
    indexresults1 = NULL;
    Gtk::Menu *resultsMenuitem_menu = Gtk::manage(new class Gtk::Menu());
    resultsMenuitem = NULL;
    list1 = NULL;
-   Gtk::Image *image703 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-open&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image721 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-open&quot;), Gtk::IconSize(1)));
    import1 = NULL;
    Gtk::MenuItem *separator3 = NULL;
    viewfromindex1 = NULL;
-   Gtk::Image *image704 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-refresh&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image722 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-refresh&quot;), Gtk::IconSize(1)));
    refreshindex1 = NULL;
-   Gtk::Image *image705 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-delete&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image723 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-delete&quot;), Gtk::IconSize(1)));
    unindex1 = NULL;
-   Gtk::Image *image706 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-properties&quot;), Gtk::IconSize(1)));
+   Gtk::Image *image724 = Gtk::manage(new class Gtk::Image(Gtk::StockID(&quot;gtk-properties&quot;), Gtk::IconSize(1)));
    showfromindex1 = NULL;
    Gtk::Menu *indexMenuitem_menu = Gtk::manage(new class Gtk::Menu());
    indexMenuitem = NULL;
@@ -133,12 +134,11 @@
    queryTreeview = Gtk::manage(new class Gtk::TreeView());
    
    Gtk::ScrolledWindow *queryScrolledwindow = Gtk::manage(new class Gtk::ScrolledWindow());
-   addQueryButton = Gtk::manage(new class Gtk::ToolButton(Gtk::StockID(&quot;gtk-add&quot;)));
-   editQueryButton = Gtk::manage(new class Gtk::ToolButton(Gtk::StockID(&quot;gtk-edit&quot;)));
-   removeQueryButton = Gtk::manage(new class Gtk::ToolButton(Gtk::StockID(&quot;gtk-remove&quot;)));
-   findQueryButton = Gtk::manage(new class Gtk::MenuToolButton(Gtk::StockID(&quot;gtk-find&quot;)));
+   addQueryButton = Gtk::manage(new class Gtk::Button(Gtk::StockID(&quot;gtk-add&quot;)));
+   removeQueryButton = Gtk::manage(new class Gtk::Button(Gtk::StockID(&quot;gtk-remove&quot;)));
+   findQueryButton = Gtk::manage(new class Gtk::Button(Gtk::StockID(&quot;gtk-find&quot;)));
    
-   Gtk::Toolbar *queryToolbar = Gtk::manage(new class Gtk::Toolbar());
+   Gtk::VButtonBox *queryVbuttonbox = Gtk::manage(new class Gtk::VButtonBox(Gtk::BUTTONBOX_START, 0));
    Gtk::HBox *queryHbox = Gtk::manage(new class Gtk::HBox(false, 0));
    Gtk::Label *queryLabel = Gtk::manage(new class Gtk::Label(_(&quot;Stored queries&quot;)));
    queryExpander = Gtk::manage(new class Gtk::Expander());
@@ -189,7 +189,7 @@
    resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::StockMenuElem(Gtk::StockID(&quot;gtk-save-as&quot;)));
    exportresults1 = (Gtk::ImageMenuItem *)&amp;resultsMenuitem_menu-&gt;items().back();
    
-   resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Clear List&quot;), *image701));
+   resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Clear List&quot;), *image718));
    clearresults1 = (Gtk::ImageMenuItem *)&amp;resultsMenuitem_menu-&gt;items().back();
    
    resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::SeparatorElem());
@@ -201,16 +201,19 @@
    resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;View Cache&quot;)));
    viewcache1 = (Gtk::MenuItem *)&amp;resultsMenuitem_menu-&gt;items().back();
    
-   resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;More Like This&quot;), *image702));
+   resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;More Like This&quot;), *image719));
    morelikethis1 = (Gtk::ImageMenuItem *)&amp;resultsMenuitem_menu-&gt;items().back();
    
+   resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Search This For&quot;), *image720));
+   searchagain1 = (Gtk::ImageMenuItem *)&amp;resultsMenuitem_menu-&gt;items().back();
+   
    resultsMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;_Index&quot;)));
    indexresults1 = (Gtk::MenuItem *)&amp;resultsMenuitem_menu-&gt;items().back();
    
    indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;List Contents Of&quot;)));
    list1 = (Gtk::MenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
-   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Import URL&quot;), *image703));
+   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Import URL&quot;), *image721));
    import1 = (Gtk::ImageMenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
    indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::SeparatorElem());
@@ -219,13 +222,13 @@
    indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;View&quot;)));
    viewfromindex1 = (Gtk::MenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
-   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Update&quot;), *image704));
+   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Update&quot;), *image722));
    refreshindex1 = (Gtk::ImageMenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
-   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Unindex&quot;), *image705));
+   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Unindex&quot;), *image723));
    unindex1 = (Gtk::ImageMenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
-   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Properties&quot;), *image706));
+   indexMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::ImageMenuElem(_(&quot;Properties&quot;), *image724));
    showfromindex1 = (Gtk::ImageMenuItem *)&amp;indexMenuitem_menu-&gt;items().back();
    
    helpMenuitem_menu-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;_About&quot;)));
@@ -245,25 +248,23 @@
    
    mainMenubar-&gt;items().push_back(Gtk::Menu_Helpers::MenuElem(_(&quot;_Help&quot;), *helpMenuitem_menu));
    helpMenuitem = (Gtk::MenuItem *)&amp;mainMenubar-&gt;items().back();
-   queryToolbar-&gt;append(*addQueryButton);
-   queryToolbar-&gt;append(*editQueryButton);
-   queryToolbar-&gt;append(*removeQueryButton);
-   queryToolbar-&gt;append(*findQueryButton);
    showextract1-&gt;set_active(true);
    searchenginegroup1-&gt;set_active(true);
    hostnamegroup1-&gt;set_active(false);
-   image701-&gt;set_alignment(0.5,0.5);
-   image701-&gt;set_padding(0,0);
-   image702-&gt;set_alignment(0.5,0.5);
-   image702-&gt;set_padding(0,0);
-   image703-&gt;set_alignment(0.5,0.5);
-   image703-&gt;set_padding(0,0);
-   image704-&gt;set_alignment(0.5,0.5);
-   image704-&gt;set_padding(0,0);
-   image705-&gt;set_alignment(0.5,0.5);
-   image705-&gt;set_padding(0,0);
-   image706-&gt;set_alignment(0.5,0.5);
-   image706-&gt;set_padding(0,0);
+   image718-&gt;set_alignment(0.5,0.5);
+   image718-&gt;set_padding(0,0);
+   image719-&gt;set_alignment(0.5,0.5);
+   image719-&gt;set_padding(0,0);
+   image720-&gt;set_alignment(0.5,0.5);
+   image720-&gt;set_padding(0,0);
+   image721-&gt;set_alignment(0.5,0.5);
+   image721-&gt;set_padding(0,0);
+   image722-&gt;set_alignment(0.5,0.5);
+   image722-&gt;set_padding(0,0);
+   image723-&gt;set_alignment(0.5,0.5);
+   image723-&gt;set_padding(0,0);
+   image724-&gt;set_alignment(0.5,0.5);
+   image724-&gt;set_padding(0,0);
    image439-&gt;set_alignment(0.5,0.5);
    image439-&gt;set_padding(0,0);
    addIndexButton-&gt;set_flags(Gtk::CAN_FOCUS);
@@ -317,52 +318,31 @@
    queryTreeview-&gt;set_rules_hint(false);
    queryTreeview-&gt;set_reorderable(false);
    queryTreeview-&gt;set_enable_search(false);
-#if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;=5
    queryTreeview-&gt;set_fixed_height_mode(false);
    queryTreeview-&gt;set_hover_selection(false);
    queryTreeview-&gt;set_hover_expand(false);
-#endif //
    queryScrolledwindow-&gt;set_flags(Gtk::CAN_FOCUS);
    queryScrolledwindow-&gt;set_shadow_type(Gtk::SHADOW_NONE);
    queryScrolledwindow-&gt;set_policy(Gtk::POLICY_AUTOMATIC, Gtk::POLICY_AUTOMATIC);
    queryScrolledwindow-&gt;property_window_placement().set_value(Gtk::CORNER_TOP_LEFT);
    queryScrolledwindow-&gt;add(*queryTreeview);
-#if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;=3
-   addQueryButton-&gt;set_visible_horizontal(true);
-   addQueryButton-&gt;set_visible_vertical(true);
-   addQueryButton-&gt;set_is_important(false);
-   addQueryButton-&gt;set_homogeneous(false);
-   addQueryButton-&gt;set_expand(false);
-#endif //
-#if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;=3
-   editQueryButton-&gt;set_visible_horizontal(true);
-   editQueryButton-&gt;set_visible_vertical(true);
-   editQueryButton-&gt;set_is_important(false);
-   editQueryButton-&gt;set_homogeneous(false);
-   editQueryButton-&gt;set_expand(false);
-#endif //
-#if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;=3
-   removeQueryButton-&gt;set_visible_horizontal(true);
-   removeQueryButton-&gt;set_visible_vertical(true);
-   removeQueryButton-&gt;set_is_important(false);
-   removeQueryButton-&gt;set_homogeneous(false);
-   removeQueryButton-&gt;set_expand(false);
-#endif //
-#if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;=3
-   findQueryButton-&gt;set_visible_horizontal(true);
-   findQueryButton-&gt;set_visible_vertical(true);
-   findQueryButton-&gt;set_is_important(false);
-   findQueryButton-&gt;set_homogeneous(false);
-   findQueryButton-&gt;set_expand(false);
-#endif //
-   queryToolbar-&gt;set_tooltips(true);
-   queryToolbar-&gt;set_toolbar_style(Gtk::TOOLBAR_ICONS);
-   queryToolbar-&gt;set_orientation(Gtk::ORIENTATION_VERTICAL);
-#if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;=3
-   queryToolbar-&gt;set_show_arrow(false);
-#endif //
+   addQueryButton-&gt;set_flags(Gtk::CAN_FOCUS);
+   addQueryButton-&gt;set_flags(Gtk::CAN_DEFAULT);
+   addQueryButton-&gt;set_border_width(4);
+   addQueryButton-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   removeQueryButton-&gt;set_flags(Gtk::CAN_FOCUS);
+   removeQueryButton-&gt;set_flags(Gtk::CAN_DEFAULT);
+   removeQueryButton-&gt;set_border_width(4);
+   removeQueryButton-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   findQueryButton-&gt;set_flags(Gtk::CAN_FOCUS);
+   findQueryButton-&gt;set_flags(Gtk::CAN_DEFAULT);
+   findQueryButton-&gt;set_border_width(4);
+   findQueryButton-&gt;set_relief(Gtk::RELIEF_NORMAL);
+   queryVbuttonbox-&gt;pack_start(*addQueryButton);
+   queryVbuttonbox-&gt;pack_start(*removeQueryButton);
+   queryVbuttonbox-&gt;pack_start(*findQueryButton);
    queryHbox-&gt;pack_start(*queryScrolledwindow);
-   queryHbox-&gt;pack_start(*queryToolbar, Gtk::PACK_SHRINK, 0);
+   queryHbox-&gt;pack_start(*queryVbuttonbox, Gtk::PACK_SHRINK, 0);
    queryLabel-&gt;set_alignment(0.5,0.5);
    queryLabel-&gt;set_padding(0,0);
    queryLabel-&gt;set_justify(Gtk::JUSTIFY_LEFT);
@@ -374,14 +354,10 @@
    queryLabel-&gt;set_angle(0);
    queryLabel-&gt;set_single_line_mode(false);
    queryExpander-&gt;set_flags(Gtk::CAN_FOCUS);
-#if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;=3
-   queryExpander-&gt;set_expanded(true);
+   queryExpander-&gt;set_expanded(false);
    queryExpander-&gt;set_spacing(0);
-#endif //
    queryExpander-&gt;add(*queryHbox);
-#if GTKMM_MAJOR_VERSION==2 &amp;&amp; GTKMM_MINOR_VERSION&gt;=3
    queryExpander-&gt;set_label_widget(*queryLabel);
-#endif //
    rightVbox-&gt;pack_start(*liveQueryHbox, Gtk::PACK_SHRINK, 0);
    rightVbox-&gt;pack_start(*queryExpander, Gtk::PACK_SHRINK, 0);
    mainHpaned-&gt;set_flags(Gtk::CAN_FOCUS);
@@ -416,25 +392,27 @@
    hostnamegroup1-&gt;show();
    groupresults1-&gt;show();
    exportresults1-&gt;show();
-   image701-&gt;show();
+   image718-&gt;show();
    clearresults1-&gt;show();
    separator1-&gt;show();
    viewresults1-&gt;show();
    viewcache1-&gt;show();
-   image702-&gt;show();
+   image719-&gt;show();
    morelikethis1-&gt;show();
+   image720-&gt;show();
+   searchagain1-&gt;show();
    indexresults1-&gt;show();
    resultsMenuitem-&gt;show();
    list1-&gt;show();
-   image703-&gt;show();
+   image721-&gt;show();
    import1-&gt;show();
    separator3-&gt;show();
    viewfromindex1-&gt;show();
-   image704-&gt;show();
+   image722-&gt;show();
    refreshindex1-&gt;show();
-   image705-&gt;show();
+   image723-&gt;show();
    unindex1-&gt;show();
-   image706-&gt;show();
+   image724-&gt;show();
    showfromindex1-&gt;show();
    indexMenuitem-&gt;show();
    about1-&gt;show();
@@ -456,10 +434,9 @@
    queryTreeview-&gt;show();
    queryScrolledwindow-&gt;show();
    addQueryButton-&gt;show();
-   editQueryButton-&gt;show();
    removeQueryButton-&gt;show();
    findQueryButton-&gt;show();
-   queryToolbar-&gt;show();
+   queryVbuttonbox-&gt;show();
    queryHbox-&gt;show();
    queryLabel-&gt;show();
    queryExpander-&gt;show();
@@ -497,7 +474,6 @@
    findButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;mainWindow_glade::on_findButton_clicked), false);
    queryTreeview-&gt;signal_button_press_event().connect(SigC::slot(*this, &amp;mainWindow_glade::on_queryTreeview_button_press_event), false);
    addQueryButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;mainWindow_glade::on_addQueryButton_clicked), false);
-   editQueryButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;mainWindow_glade::on_editQueryButton_clicked), false);
    removeQueryButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;mainWindow_glade::on_removeQueryButton_clicked), false);
    findQueryButton-&gt;signal_clicked().connect(SigC::slot(*this, &amp;mainWindow_glade::on_findQueryButton_clicked), false);
    mainWindow-&gt;signal_delete_event().connect(SigC::slot(*this, &amp;mainWindow_glade::on_mainWindow_delete_event), false);

Modified: trunk/UI/GTK2/src/mainWindow_glade.hh
===================================================================
--- trunk/UI/GTK2/src/mainWindow_glade.hh	2007-09-25 13:32:14 UTC (rev 990)
+++ trunk/UI/GTK2/src/mainWindow_glade.hh	2007-09-25 13:40:00 UTC (rev 991)
@@ -1,4 +1,4 @@
-// generated 2007/9/24 20:22:15 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
+// generated 2007/9/24 22:21:22 SGT by <A HREF="https://lists.berlios.de/mailman/listinfo/pinot-svn">fabrice at amra.dyndns.org.</A>(none)
 // using glademm V2.12.1
 //
 // DO NOT EDIT THIS FILE ! It was created using
@@ -41,8 +41,6 @@
 #include &lt;gtkmm/togglebutton.h&gt;
 #include &lt;gtkmm/entry.h&gt;
 #include &lt;gtkmm/treeview.h&gt;
-#include &lt;gtkmm/toolbutton.h&gt;
-#include &lt;gtkmm/menutoolbutton.h&gt;
 #include &lt;gtkmm/handlebox.h&gt;
 #include &lt;gtkmm/expander.h&gt;
 #include &lt;gtkmm/paned.h&gt;
@@ -74,6 +72,7 @@
         class Gtk::MenuItem * viewresults1;
         class Gtk::MenuItem * viewcache1;
         class Gtk::ImageMenuItem * morelikethis1;
+        class Gtk::ImageMenuItem * searchagain1;
         class Gtk::MenuItem * indexresults1;
         class Gtk::MenuItem * resultsMenuitem;
         class Gtk::MenuItem * list1;
@@ -93,10 +92,9 @@
         class Gtk::Entry * liveQueryEntry;
         class Gtk::Button * findButton;
         class Gtk::TreeView * queryTreeview;
-        class Gtk::ToolButton * addQueryButton;
-        class Gtk::ToolButton * editQueryButton;
-        class Gtk::ToolButton * removeQueryButton;
-        class Gtk::MenuToolButton * findQueryButton;
+        class Gtk::Button * addQueryButton;
+        class Gtk::Button * removeQueryButton;
+        class Gtk::Button * findQueryButton;
         class Gtk::Expander * queryExpander;
         class Gtk::VBox * rightVbox;
         class Gtk::HPaned * mainHpaned;
@@ -135,7 +133,6 @@
         virtual void on_findButton_clicked() = 0;
         virtual bool on_queryTreeview_button_press_event(GdkEventButton *ev) = 0;
         virtual void on_addQueryButton_clicked() = 0;
-        virtual void on_editQueryButton_clicked() = 0;
         virtual void on_removeQueryButton_clicked() = 0;
         virtual void on_findQueryButton_clicked() = 0;
         virtual bool on_mainWindow_delete_event(GdkEventAny *ev) = 0;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000984.html">[Pinot-svn] r990 - trunk/UI/GTK2/src
</A></li>
	<LI>Next message: <A HREF="000986.html">[Pinot-svn] r992 - in trunk: Index Search Search/Google
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#985">[ date ]</a>
              <a href="thread.html#985">[ thread ]</a>
              <a href="subject.html#985">[ subject ]</a>
              <a href="author.html#985">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/pinot-svn">More information about the Pinot-svn
mailing list</a><br>
</body></html>
